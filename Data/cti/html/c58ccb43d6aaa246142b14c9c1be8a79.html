<!DOCTYPE html><!--[if IE 7]>
<html class="ie ie7" lang="en-US" prefix="og: http://ogp.me/ns#">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US" prefix="og: http://ogp.me/ns#">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<!--<![endif]-->
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Kerberos, Active Directory’s Secret Decoder Ring &#8211; Active Directory Security</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Feed" href="https://adsecurity.org/?feed=rss2" />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Comments Feed" href="https://adsecurity.org/?feed=comments-rss2" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/adsecurity.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='https://adsecurity.org/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css'  href='https://adsecurity.org/wp-content/themes/graphene/bootstrap/css/bootstrap.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://adsecurity.org/wp-content/themes/graphene/fonts/font-awesome/css/font-awesome.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='graphene-css'  href='https://adsecurity.org/wp-content/themes/graphene/style.css?ver=2.8.4' type='text/css' media='screen' />
<link rel='stylesheet' id='graphene-responsive-css'  href='https://adsecurity.org/wp-content/themes/graphene/responsive.css?ver=2.8.4' type='text/css' media='all' />
<link rel='stylesheet' id='graphene-blocks-css'  href='https://adsecurity.org/wp-content/themes/graphene/blocks.css?ver=2.8.4' type='text/css' media='all' />
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/bootstrap/js/bootstrap.min.js?ver=2.8.4' id='bootstrap-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js?ver=2.8.4' id='bootstrap-hover-dropdown-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/bootstrap-submenu/bootstrap-submenu.min.js?ver=2.8.4' id='bootstrap-submenu-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/jquery.infinitescroll.min.js?ver=2.8.4' id='infinite-scroll-js'></script>
<script type='text/javascript' id='graphene-js-extra'>
/* <![CDATA[ */
var grapheneJS = {"siteurl":"https:\/\/adsecurity.org","ajaxurl":"https:\/\/adsecurity.org\/wp-admin\/admin-ajax.php","templateUrl":"https:\/\/adsecurity.org\/wp-content\/themes\/graphene","isSingular":"1","enableStickyMenu":"","shouldShowComments":"1","commentsOrder":"newest","sliderDisable":"","sliderInterval":"7000","infScrollBtnLbl":"Load more","infScrollOn":"","infScrollCommentsOn":"","totalPosts":"1","postsPerPage":"10","isPageNavi":"","infScrollMsgText":"Fetching window.grapheneInfScrollItemsPerPage of window.grapheneInfScrollItemsLeft items left ...","infScrollMsgTextPlural":"Fetching window.grapheneInfScrollItemsPerPage of window.grapheneInfScrollItemsLeft items left ...","infScrollFinishedText":"All loaded!","commentsPerPage":"50","totalComments":"0","infScrollCommentsMsg":"Fetching window.grapheneInfScrollCommentsPerPage of window.grapheneInfScrollCommentsLeft comments left ...","infScrollCommentsMsgPlural":"Fetching window.grapheneInfScrollCommentsPerPage of window.grapheneInfScrollCommentsLeft comments left ...","infScrollCommentsFinishedMsg":"All comments loaded!","disableLiveSearch":"1","txtNoResult":"No result found.","isMasonry":""};
/* ]]> */
</script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/graphene.js?ver=2.8.4' id='graphene-js'></script>
<link rel="https://api.w.org/" href="https://adsecurity.org/index.php?rest_route=/" /><link rel="alternate" type="application/json" href="https://adsecurity.org/index.php?rest_route=/wp/v2/posts/227" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://adsecurity.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://adsecurity.org/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="https://adsecurity.org/?p=227" />
<link rel='shortlink' href='https://adsecurity.org/?p=227' />
<link rel="alternate" type="application/json+oembed" href="https://adsecurity.org/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2Fadsecurity.org%2F%3Fp%3D227" />
<link rel="alternate" type="text/xml+oembed" href="https://adsecurity.org/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2Fadsecurity.org%2F%3Fp%3D227&#038;format=xml" />
		<script type="text/javascript">
			var _statcounter = _statcounter || [];
			_statcounter.push({"tags": {"author": "SeanMetcalf"}});
		</script>
				<script>
		   WebFontConfig = {
		      google: { 
		      	families: ["Lato:400,400i,700,700i&display=swap"]		      }
		   };

		   (function(d) {
		      var wf = d.createElement('script'), s = d.scripts[0];
		      wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
		      wf.async = true;
		      s.parentNode.insertBefore(wf, s);
		   })(document);
		</script>
	<style type="text/css">
.header_title, .header_title a, .header_title a:visited, .header_title a:hover, .header_desc {color:#000000}.carousel, .carousel .item{height:400px}@media (max-width: 991px) {.carousel, .carousel .item{height:250px}}#header{max-height:198px}@media (min-width: 1200px) {.container {width:1280px}}
</style>
		<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":"https:\/\/adsecurity.org\/?p=227","publisher":{"@type":"Organization","name":"Active Directory Security"},"headline":"Kerberos, Active Directory\u2019s Secret Decoder Ring","datePublished":"2014-09-12T15:17:07+00:00","dateModified":"2018-04-06T21:52:25+00:00","description":"Kerberos Overview Kerberos is a protocol with roots in MIT named after the three-headed dog, Cerberus. Named because there are 3 parties: the client, the resource server, and a 3rd party (the Key Distribution Center, KDC). Kerberos can be a difficult authentication protocol to describe, so I will attempt to simplify it as best as ...","author":{"@type":"Person","name":"Sean Metcalf"}}</script>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><meta property="og:type" content="article" />
<meta property="og:title" content="Kerberos, Active Directory’s Secret Decoder Ring" />
<meta property="og:url" content="https://adsecurity.org/?p=227" />
<meta property="og:site_name" content="Active Directory Security" />
<meta property="og:description" content="Kerberos Overview Kerberos is a protocol with roots in MIT named after the three-headed dog, Cerberus. Named because there are 3 parties: the client, the resource server, and a 3rd party (the Key Distribution Center, KDC). Kerberos can be a difficult authentication protocol to describe, so I will attempt to simplify it as best as ..." />
<meta property="og:updated_time" content="2018-04-06T21:52:25+00:00" />
<meta property="article:modified_time" content="2018-04-06T21:52:25+00:00" />
<meta property="article:published_time" content="2014-09-12T15:17:07+00:00" />
    </head>
    <body class="post-template-default single single-post postid-227 single-format-standard custom-background wp-embed-responsive layout-boxed two_col_left two-columns singular">
        
        <div class="container boxed-wrapper">
            
                            <div id="top-bar" class="row clearfix top-bar ">
                    
                                                    
                            <div class="col-md-12 top-bar-items">
                                
                                                                                                    	<ul class="social-profiles">
							
			            <li class="social-profile social-profile-rss">
			            	<a href="https://adsecurity.org/?feed=rss2" title="Subscribe to Tech, News, and Other Ideations&#039;s RSS feed" id="social-id-1" class="mysocial social-rss">
			            				                            <i class="fa fa-rss"></i>
		                        			            	</a>
			            </li>
		            
		    	    </ul>
                                    
                                                                    <button type="button" class="search-toggle navbar-toggle collapsed" data-toggle="collapse" data-target="#top_search">
                                        <span class="sr-only">Toggle search form</span>
                                        <i class="fa fa-search-plus"></i>
                                    </button>

                                    <div id="top_search" class="top-search-form">
                                        <form class="searchform" method="get" action="https://adsecurity.org">
	<div class="input-group">
		<div class="form-group live-search-input">
			<label for="s" class="screen-reader-text">Search for:</label>
		    <input type="text" id="s" name="s" class="form-control" placeholder="Search">
		    		</div>
	    <span class="input-group-btn">
	    	<button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button>
	    </span>
    </div>
    </form>                                                                            </div>
                                
                                                            </div>

                        
                                    </div>
            

            <div id="header" class="row">

                <img src="https://adsecurity.org/wp-content/themes/graphene/images/headers/fluid.jpg" alt="Active Directory Security" title="Active Directory Security" width="960" height="198" />                
                                                                </div>


                        <nav class="navbar row navbar-inverse">

                <div class="navbar-header align-center">
                		                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu-wrap, #secondary-menu-wrap">
	                        <span class="sr-only">Toggle navigation</span>
	                        <span class="icon-bar"></span>
	                        <span class="icon-bar"></span>
	                        <span class="icon-bar"></span>
	                    </button>
                	                    
                    
                                            <p class="header_title">
                            <a href="https://adsecurity.org" title="Go back to the front page">                                Active Directory Security                            </a>                        </p>
                    
                                                    <p class="header_desc">Active Directory &amp; Enterprise Security, Methods to Secure Active Directory, Attack Methods &amp; Effective Defenses, PowerShell, Tech Notes, &amp; Geek Trivia&#8230;</p>
                                            
                                    </div>

                                    <div class="collapse navbar-collapse" id="header-menu-wrap">

            			<ul class="nav navbar-nav flip"><li ><a href="https://adsecurity.org/">Home</a></li><li class="menu-item menu-item-8"><a href="https://adsecurity.org/?page_id=8" >About</a></li><li class="menu-item menu-item-41"><a href="https://adsecurity.org/?page_id=41" >AD Resources</a></li><li class="menu-item menu-item-4031"><a href="https://adsecurity.org/?page_id=4031" >Attack Defense &#038; Detection</a></li><li class="menu-item menu-item-293"><a href="https://adsecurity.org/?page_id=293" >Contact</a></li><li class="menu-item menu-item-1821"><a href="https://adsecurity.org/?page_id=1821" >Mimikatz</a></li><li class="menu-item menu-item-1352"><a href="https://adsecurity.org/?page_id=1352" >Presentations</a></li><li class="menu-item menu-item-195"><a href="https://adsecurity.org/?page_id=195" >Schema Versions</a></li><li class="menu-item menu-item-399"><a href="https://adsecurity.org/?page_id=399" >Security Resources</a></li><li class="menu-item menu-item-183"><a href="https://adsecurity.org/?page_id=183" >SPNs</a></li><li class="menu-item menu-item-2532"><a href="https://adsecurity.org/?page_id=2532" >Top Posts</a></li></ul>                        
            			                        
                                            </div>
                
                                    
                            </nav>

            
            <div id="content" class="clearfix hfeed row">
                
                    
                                        
                    <div id="content-main" class="clearfix content-main col-md-8">
                    
	
		<div class="post-nav post-nav-top clearfix">
			<p class="previous col-sm-6"><i class="fa fa-arrow-circle-left"></i> <a href="https://adsecurity.org/?p=214" rel="prev">PowerShell v5 Preview</a></p>			<p class="next-post col-sm-6"><a href="https://adsecurity.org/?p=230" rel="next">Active Directory Pentest Recon Part 1: SPN Scanning aka Mining Kerberos Service Principal Names</a> <i class="fa fa-arrow-circle-right"></i></p>					</div>
		        
<div id="post-227" class="clearfix post post-227 type-post status-publish format-standard hentry category-continuing-education category-microsoft-security category-technical-reference tag-active-directory tag-as-rep tag-as-req tag-configuration tag-domain-controller tag-kdc tag-kerberos tag-kerberosexplained tag-kerberosoverview tag-krbtgt tag-windows-server item-wrap">
		
	<div class="entry clearfix">
    	
                    	<div class="post-date date alpha with-year">
            <p class="default_date">
            	<span class="month">Sep</span>
                <span class="day">12</span>
                	                <span class="year">2014</span>
                            </p>
                    </div>
            
		        <h1 class="post-title entry-title">
			Kerberos, Active Directory’s Secret Decoder Ring			        </h1>
		
			    <ul class="post-meta entry-meta clearfix">
	    		        <li class="byline">
	        	By <span class="author"><a href="https://adsecurity.org/?author=2" rel="author">Sean Metcalf</a></span><span class="entry-cat"> in <span class="terms"><a class="term term-category term-17" href="https://adsecurity.org/?cat=17">Continuing Education</a>, <a class="term term-category term-11" href="https://adsecurity.org/?cat=11">Microsoft Security</a>, <a class="term term-category term-2" href="https://adsecurity.org/?cat=2">Technical Reference</a></span></span>	        </li>
	        	    </ul>
    
				
				<div class="entry-content clearfix">
							
										
						<p><strong>Kerberos Overview</strong></p>
<p><a href="http://technet.microsoft.com/en-us/library/bb742516.aspx">Kerberos </a>is a protocol with roots in <a href="http://web.mit.edu/kerberos/">MIT</a> named after the three-headed dog, <a href="http://en.wikipedia.org/wiki/Cerberus">Cerberus</a>. Named because there are 3 parties: the client, the resource server, and a 3rd party (the Key Distribution Center, KDC).</p>
<p>Kerberos can be a difficult authentication protocol to describe, so I will attempt to simplify it as best as possible.</p>
<p>Kerberos authentication leverages long-term asymmetric keys (public key) and short-term symmetric keys (session keys).</p>
<p>Asymmetric key cryptography uses two mathematically connected keys where one key is used to encrypt and the other is used to decrypt data. This is most commonly used in Public Key encryption (PKI) where one of the keys is kept secret by the user or service (Private Key) and the other key is available to anyone who wants it (Public Key). In this manner a user can sign (encrypt a hash with the private key) data to ensure it originated from that user without modification (the receiver decrypts the hash with the public key). Also a person can use the user’s public key to encrypt data so that only the user can decrypt it with the user’s private key.</p>
<p>Symmetric key cryptography uses one key to encrypt and the same to decrypt the data. This is also referred to as a shared secret.</p>
<p>Since asymmetric key cryptography is more processor intensive, it is typically only used to encrypt session keys which use symmetric keys (shared secret).</p>
<p>Active Directory implements Kerberos version 5 in two components: the Authentication service and the Ticket-granting service.</p>
<p>The Authentication Service (AS) is the first contact the client has with Kerberos and is used to lookup the user’s password and create the Ticket Granting Ticket (TGT). The AS also creates the session key the user will use for future communication with Kerberos.</p>
<p>The Ticket Granting Ticket (TGT) is the Kerberos ticket for the Ticket Granting Service (runs on the KDC) and is encrypted using the KDC key (<a href="https://adsecurity.org/?p=483">KRBTGT domain Kerberos account</a>), meaning that only a KDC can decrypt and read the ticket. While the user’s ticket ,the TGT, is set to expire after 10 hours (AD default), it can be renewed as often as needed during the TGT renewable lifetime which is 7 days (AD default). Once the authenticating user has a TGT, it presents the TGT to the KDC to get a Service Ticket for the Ticket Granting Service (TGS) on the KDC. Most key Kerberos communication occurs over UDP port 88, though starting with Windows Vista &amp; Windows Server 2008 now default to using TCP for Kerberos ticket requests.</p>
<p><em>There is a myth in the Windows Kerberos world that if a workstation&#8217;s clock is skewed more than 5 minutes from that of the Domain Controller, Kerberos authentication wouldn&#8217;t work.</em><br />
Technically, all clocks in the Kerberos world must be kept closely in-sync to prevent replay attacks. By default, Microsoft Active Directory has a tolerance of 5 minutes. <strong>Though in most cases, this doesn&#8217;t mater. When a client sends a Kerberos request to a DC, the DC will reply with a &#8220;KRB_ERROR &#8211; KRB_AP_ERR_SKEW (37)&#8221; and the Windows client will update its time for the Kerberos session with the DC and resend the request.</strong> Provided the clock skew between the client and DC is not more than the ticket lifetime (10 hours by default), the second request will be successful.</p>
<p><a href="http://www.ietf.org/rfc/rfc4430.txt">Kerberized Internet Negotiation of Keys (KINK) RFC 4430</a> details how this works:</p>
<blockquote><p>If the server clock and the client clock are off by more than the policy-determined clock skew limit (usually 5 minutes), the server MUST return a KRB_AP_ERR_SKEW.  The optional client&#8217;s time in the KRB-ERROR SHOULD be filled out.  <strong>If the server protects the error by adding the Cksum field and returning the correct client&#8217;s time, the client SHOULD compute the difference (in seconds) between the two clocks based upon the client and server time contained in the KRB-ERROR message.  The client SHOULD store this clock difference and use it to adjust its clock in subsequent messages. </strong> If the error is not protected, the client MUST NOT use the difference to adjust subsequent messages, because doing so would allow an attacker to construct authenticators that can be used to mount replay attacks.</p></blockquote>
<p><a href="http://support.microsoft.com/kb/956627/en-us">KB956627 also describes this behavior</a>.<br />
Confused yet?<br />
Keep reading, it gets easier…</p>
<p>Every service that is Kerberos enabled has an entry point called a Service Principal Name (SPN) and each Kerberos user has a User Principal Name (UPN). For example, a user named Joe User in the ADSECURITY.ORG Kerberos realm aka AD domain (the Kerberos realm is always all Caps) has a UPN of JoeUser@ADSecurity.org. If Joe User initiates a connection to the share path \\server1.ADSecurity.org\Shared then Joe’s workstation will lookup the computer server1.ADSecurity.org in Active Directory and read its SPN attribute (cifs/server1.ADSecurity.org). The computer SPN is used to identify the application server in the Kerberos TGS ticket request. Furthermore, when Joe opens Outlook, his workstation performs similar actions looking up the Exchange server’s SPN.<br />
Exchange 2010 has a number of registered SPNs; here are a few of them used as part of a client connection (using Outlook 2010):</p>
<ul>
<li>exchangeMDB</li>
<li>exchangeRFR</li>
<li>exchangeAB</li>
<li>HTTP</li>
</ul>
<p><strong>KERBEROS METAPHOR<br />
</strong></p>
<p>As mentioned earlier, Kerberos has 3 components, the client, the server, and the KDC (trusted 3rd party). The process is similar to when you travel to a foreign country.</p>
<ol>
<li>You visit the local passport office with a birth certificate<br />
(get the Ticket Granting Ticket ticket from the KDC)</li>
<li>You request an entrance Visa for your passport in order to enter the country<br />
(get the Ticket Granting Service ticket from the KDC – ok, so you would get the Visa from the country’s embassy, but you still need the passport and something authoritative the country’s immigration guard will accept).</li>
<li>You travel to the country with the passport and the country’s entrance Visa<br />
(present authoritative documentation to gain access to the resource server).</li>
</ol>
<p><strong>KERBEROS TICKET PROCESS OVERVIEW</strong></p>
<p><span style="text-decoration: underline;">Ticket Granting Ticket (aka logon ticket)</span></p>
<p>1. Joe User logs on with his Active Directory user name and password to a domain-joined computer (usually a workstation). The computer takes the user’s password and runs a one way function (OWF) creating a hash of the password (typically the NTLM hash). Hashing the password is like taking a steak and running it through a meat grinder. The ground beef that is the result can never be reassembled back into the same steak we started with.<br />
This is used to  handle all Kerberos requests for the user (as well as other authentication methods such as NTLM).</p>
<p>2. Kerberos authentication is initiated by sending a timestamp (PREAUTH data) encrypted with the user’s password-based encryption key (password NTLM hash).</p>
<p>3. The user account (JoeUser@adsecurity.org) requests a Kerberos service ticket (TGT) with PREAUTH data (Kerberos Authentication Service Request or AS-REQ).</p>
<p>4. The Domain Controller’s Kerberos service (KDC) receives the authentication request, validates the data, and replies with a TGT (Kerberos AS-REP). The TGT has a Privileged Attribute Certificate (PAC) which contains all the security groups in which the user is a member. The TGT is encrypted and signed by the KDC service account (<a title="Kerberos &amp; KRBTGT: Active Directory’s Domain Kerberos Account" href="https://adsecurity.org/?p=483">KRBTGT</a>) and only the domain <a title="Kerberos &amp; KRBTGT: Active Directory’s Domain Kerberos Account" href="https://adsecurity.org/?p=483">KRBTGT</a> account can read the data in the TGT.</p>
<p>At this point, the user has a valid TGT which contains the users group membership and is used to prove the user is who they claim to be in further conversations with a Domain Controller (KDC). The TGT is sent to the Domain Controller every time a resource ticket is requested.</p>
<p><span style="text-decoration: underline;">Ticket Granting Service ticket (aka resource access ticket)</span></p>
<p>5. When the user wants to access an AD resource (a file share for example), the user’s TGT from step 4 is presented to a Domain Controller (KDC) as proof of identity with a request for a resource ticket to a specific resource (Service Principal Name). The DC determines if the TGT is valid by checking the TGT’s signature and if valid, generates a resource access ticket (TGS) signed/encrypted with the <a title="Kerberos &amp; KRBTGT: Active Directory’s Domain Kerberos Account" href="https://adsecurity.org/?p=483">KRBTGT</a> account and a part encrypted with the Kerberos service account’s session key which the destination service uses to validate the TGS.<br />
Note: The DC doesn’t validate the user has the appropriate access to the service, it only validates the TGT and builds a TGS based on the TGT information.</p>
<p>6. The resource service ticket (TGS) is sent to the user by the Domain Controller and is used for authentication to the resource. At this point, all communication has been between the user’s computer and the Domain Controller (KDC).</p>
<p>7. The user’s computer sends the user’s resource service ticket (TGS) to the service on the resource computer. If the destination service is a file share, the TGS is presented to the CIFS service for access.</p>
<p>8. The destination service (CIFS in this example) validates the TGS by ensuring it can decrypt the TGS component encrypted with the service’s session key. The service may send the TGS to a DC (KDC) to validate the PAC to ensure the user’s group membership presented is accurate. The service reviews the user’s group membership to determine what level of access, if any, the user has to the resource.</p>
<p><strong>THE DETAILED PROCESS</strong></p>
<p>Here’s my example scenario to explain what occurs when a user logs on and opens Outlook to view his Exchange email. The bold text is the simple overview version while the detail follows.</p>
<ol>
<li><strong><strong>A user logs onto the domain ADSecurity.org on the workstation ADSecurityPC.</strong></strong></li>
<li><strong>The user requests authentication by sending a timestamp encrypted with the users password encryption key.</strong><br />
The workstation creates an encryption key derived from the user’s password (the user’s password is hashed using a one way function such as MD5 = <strong> (A) </strong>key) to encrypt a timestamp (date/time) as an authenticator (pre-authentication is required by AD in its default configuration, so the client must send an authenticator) . The authenticator is simply a method the client uses to prove to the KDC that the user is who he claims to be (since only the user &amp; the KDC knows his password) and protects against replay attacks. This information is sent to the KDC in an AS-REQ (Authentication Service Request) packet. This request includes the client supported encryption algorithms.Keys used:<br />
<strong>(A)</strong>User’s password derived key<a href="http://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/Capture-KRB5-AS-REQ.png"><img loading="lazy" class="aligncenter size-full wp-image-1057" title="Capture-KRB5-AS-REQ" src="https://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/Capture-KRB5-AS-REQ.png" alt="" width="991" height="374" /></a>Packet Data:<strong><br />
User account (user@ADSecurity.org) requests <a href="http://technet.microsoft.com/en-us/library/cc749438%28WS.10%29.aspx">Kerberos </a>service ticket (TGT) with PREAUTH data</strong>KRB5: Kerberos AS-REQ<br />
1 Forwardable: FORWARDABLE tickets are allowed/requested<br />
1 Renewable: This ticket is RENEWABLE<br />
1 Canonicalize: This is a request for a CANONICALIZED ticket<br />
1 Renewable OK: We accept RENEWED ticketsClient Name (Principal): admin<br />
Realm: ADSECURITY.ORG<br />
Service: krbtgt/ADSecurity.org<br />
till: 2037-09-12 02:48:05 (UTC)<br />
rtime: 2037-09-12 02:48:05 (UTC)<br />
Nonce: 1976014234<br />
Principal Name: user<br />
HostAddress: METCORPORGDC02&lt;20&gt;<br />
PAC_Request: True<br />
Encryption Types: aes256-cts-hmac-sha1-96 aes128-cts-hmac-sha1-96 rc4-hmac rc4-hmac-exp rc4-hmac-old-exp des-cbc-md5KRB5: Kerberos AS-REP<br />
Client Name (Principal): user<br />
Tkt-vno: 5</li>
<li><strong>The Kerberos server (KDC) receives the authentication request, validates the data, and replies with a TGT.</strong><br />
The KDC receives the AS-REQ, decrypts the authenticator (encrypted with key <strong>(A)</strong>), and validates the timestamp is within the time skew limits set by the domain (5 minutes by default). If the KDC is satisfied the request is a valid user request, the KDC responds with an AS-REP packet which includes the TGT. The TGT can only be decrypted by a KDC (using the <strong>(B)</strong> key) and is used to authenticate the user to the Kerberos server so it doesn’t have to look up the user’s password (long-term key) again. The KDC also includes a session key (<strong>(C)</strong>key) for use in future communication with the KC.Keys used:<strong><br />
</strong><strong>(B)</strong> Kerberos account’s password derived key<strong><br />
(C)</strong>User’s Kerberos service (KDC) session key NOTE: The TGT is encrypted with the <a href="https://adsecurity.org/?p=483">KRBTGT account password </a>so only a valid Kerberos server can decrypt it. In an environment with RODCs, each RODC has its own krbtgt account with a unique password. This means that if a user presents a TGT received from a RODC to a writable DC, the DC dumps the TGT and generates a new one.<a href="http://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/Capture-KRB5-AS-REP.png"><img loading="lazy" class="aligncenter size-full wp-image-1056" title="Capture-KRB5-AS-REP" src="https://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/Capture-KRB5-AS-REP.png" alt="" width="738" height="371" /></a><strong>Packet Data:<br />
The KDC replies with the TGT and session key</strong><br />
KRB5: Kerberos AS-REP<br />
Client Name (Principal): User<br />
Ticket (Tkt-vno): 5<br />
Realm: ADSECURITY.ORG<br />
Server Name: krbtgt/ADSecurity.org<br />
enc-part aes256-cts-hmac-sha1-96<br />
[Encrypted Key]<br />
enc-part rc4-hmac<br />
[Encrypted Key]</li>
<li><strong>The user opens Outlook which locates the user’s mailbox server and requests a TGS ticket for access.</strong><br />
The workstation locates the Exchange mailbox server containing the user’s mailbox (MetcorpEXMB02.ADSecurity.org) and reads the ServicePrincipalName attribute on the computer account in AD (ExchangeMDB/ADSecurityEXMB02.ADSecurity.org – there are a bunch, so I will just use this one for the example).<br />
The client then sends a TGS-REQ to the KDC requesting a TGS for access to the Exchange service running on the MetcorpEXMB02 Exchange server. The TGS request includes the target server SPN, the user’s TGT (encrypted with the <strong>(B)</strong> key), and an authenticator (encrypted with the<strong> (C)</strong>key).Keys used:<strong><br />
(B)</strong> Kerberos account’s password derived key<strong><br />
(C)</strong>User’s Kerberos service (KDC) session key<a href="http://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/Capture-KRB5-TGS-REQ-APREQ-exchangeMDB.png"><img loading="lazy" class="aligncenter size-full wp-image-1052" title="Capture-KRB5-TGS-REQ-APREQ-exchangeMDB" src="https://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/Capture-KRB5-TGS-REQ-APREQ-exchangeMDB.png" alt="" width="890" height="513" /></a><strong>Packet Data:</strong><br />
<strong>User account requests service ticket (TGS) for MetcorpEXMB02 Exchange service access</strong><br />
KRB5: Kerberos TGS-REQ<br />
1 Forwardable: FORWARDABLE tickets are allowed/requested<br />
1 Renewable: This ticket is RENEWABLE<br />
1 Canonicalize: This is a request for a CANONICALIZED ticket<br />
Realm: ADSECURITY.ORG<br />
Server Name: ExchangeMDB/MetcorpEXMB02.ADSecurity.org<br />
till: 2037-09-12 02:48:05 (UTC)<br />
Nonce: 1976014234<br />
Encryption Types: aes256-cts-hmac-sha1-96 aes128-cts-hmac-sha1-96 rc4-hmac rc4-hmac-exp rc4-hmac-old-exp des-cbc-md5KRB5: Kerberos AS-REP</li>
<li><strong>The KDC validates the TGS request and replies with the TGS.</strong><br />
The KDC replies with a TGS-REP packet to the client which includes 2 session tickets (TGS) (2?). One of the session tickets is encrypted with the user’s (KDC) session key (<strong>(C)</strong> key) and the second one is encrypted with the target server’s (KDC) session key (<strong>(D)</strong> key). The second TGS also includes the user’s group membership &amp; associated SIDs which provides the server information used to determine authorization and help the server determine: Is the user allowed to access the server’s resource?<br />
Both session tickets include a new session key (<strong>(E)</strong>key) for exclusive use in communication between the Exchange server and the user.Keys used:<strong><br />
(C)</strong> User’s Kerberos service (KDC) session key<strong><br />
(D)</strong> Server’s Kerberos service (KDC) session key<strong><br />
(E)</strong>User-Exchange service session key<a href="http://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/Capture-KRB5-TGS-REP-APREP-exchangeMDB.png"><img loading="lazy" class="aligncenter size-full wp-image-1058" title="Capture-KRB5-TGS-REP-APREP-exchangeMDB" src="https://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/Capture-KRB5-TGS-REP-APREP-exchangeMDB.png" alt="" width="594" height="274" /></a><strong>Packet Data:</strong><br />
<strong>The KDC replies with the service ticket (TGS) for MetcorpEXMB02 Exchange service access</strong><br />
KRB5: Kerberos TGS-REP<br />
Client Name (Principal): User<br />
Ticket (Tkt-vno): 5<br />
Realm: ADSECURITY.ORG<br />
Server Name: krbtgt/ADSecurity.org<br />
enc-part aes256-cts-hmac-sha1-96<br />
[Encrypted Key]<br />
enc-part rc4-hmac<br />
[Encrypted Key]</li>
<li><strong>The client authenticates to the Exchange server with the session ticket.</strong><br />
The client sends the target server (MetcorpEXMB02.ADSecurity.org) an AP-REQ packet containing the TGS it received from the KDC encrypted with the server’s session key (<strong>(D)</strong> key) and an authenticator encrypted with the user-Exchange server session key (<strong>(E)</strong> key) . This lets the Exchange server know that the user was authenticated to the Kerberos domain (realm) and that the TGS is valid (assuming the Exchange server is able to decrypt it). The client also sends the server an authenticator (timestamp) encrypted with the session key (<strong>(E)</strong>key) it received from the KDC in Step 5. The Exchange server decrypts the TGS, extracts the user’s group information, extracts the session key, and uses the session key to decrypt the authenticator. This provides the server enough information to make an authorization decision. If the user is authorized to connect to the server, it sends a reply.Keys used:<strong><br />
(C)</strong> User’s Kerberos service (KDC) session key<strong><br />
(D)</strong> Server’s Kerberos service (KDC) session key<strong><br />
(E)</strong> User-Exchange service session key</li>
<li><strong>The Exchange server replies that authorization to the service is granted.<br />
</strong>The Exchange server sends the client an AP-REP packet which includes its own authenticator encrypted with the user-Exchange service session key (<strong>(E)</strong> key)<strong>. </strong>This assumes the client requested mutual authentication which is the default configuration.Keys used:<strong><strong><strong><br />
</strong><strong>(E)</strong></strong></strong>User-Exchange service session key</li>
</ol>
<p><strong>Note:</strong><br />
This is a simplified explanation of Kerberos and doesn’t cover everything involved in this process.</p>
<p><strong>Kerberos Key Storage Locatons<br />
</strong></p>
<p>Workstation Keys:</p>
<ul>
<li>User Key</li>
<li>Ticket-Granting Ticket</li>
<li>Ticket-Granting Service Session Key</li>
<li>Service Ticket</li>
<li>Session Key</li>
</ul>
<p>Domain Controller:</p>
<ul>
<li>User Key</li>
<li>Ticket-Granting Service Key</li>
<li>Service Key</li>
</ul>
<p>Server:</p>
<ul>
<li>Service Key</li>
<li>Session Key</li>
</ul>
<p><strong>TICKETING</strong></p>
<p>There are different “tickets” that are used to authenticate a client to a server’s resource. The client can be a user or a computer.</p>
<p>The Ticket Granting Ticket (TGT) is the first ticket given to the requester (user or computer.</p>
<p>The TGT is comprised of the following fields:</p>
<ul>
<li>Ticket Version Number</li>
<li>Realm: The AD domain name in CAPITAL LETTERS</li>
<li>Server Name: The KDC</li>
<li>Flags: Kerberos Flag options</li>
<li>Key</li>
<li>Client Realm: The client’s AD domain name in CAPITAL LETTERS</li>
<li>Client Name: The user name</li>
<li>Transited: If the user is in a different domain than the resource, Kerberos tickets have transited.</li>
<li>Authentication</li>
<li>Time</li>
<li>Start Time</li>
<li>End Time</li>
<li>Renew Till</li>
<li>Client Address</li>
<li>Authorization Data</li>
</ul>
<p>Ticket Flags:</p>
<ul>
<li>FORWARDABLE</li>
<li>FORWARDED</li>
<li>PROXIABLE</li>
<li>PROXY</li>
<li>MAY-POSTDATE</li>
<li>POSTDATED</li>
<li>INVALID</li>
<li>RENEWABLE</li>
<li>INITIAL</li>
<li>PRE-AUTHENT</li>
<li>HW-AUTHENT</li>
</ul>
<p>Supported Encryption Algorithms &amp; Key Lengths:</p>
<ul>
<li><a href="http://blogs.msdn.com/b/openspecification/archive/2011/05/31/windows-configurations-for-kerberos-supported-encryption-type.aspx">AES</a>                       128<br />
AES128-CTS-HMAC-SHA1-96 (0x08)</li>
<li><a href="http://blogs.msdn.com/b/openspecification/archive/2011/05/31/windows-configurations-for-kerberos-supported-encryption-type.aspx">AES                       </a>256<br />
AES256-CTS-HMAC-SHA1-96 (0x10)</li>
<li><a href="http://tools.ietf.org/html/rfc4757">RC4-HMAC</a>           128<br />
RC4-HMAC  (0x04)</li>
<li><a href="http://support.microsoft.com/kb/296842">DES-CBC-CRC</a>       56<br />
DES-CBC-CRC  (0x01)</li>
<li><a href="http://www.freesoft.org/CIE/RFC/1510/76.htm">DES-CBC-MD5</a>      56<br />
DES-CBC-MD5  (0x02)</li>
</ul>
<p><strong>DEFAULT AD KERBEROS POLICY SETTINGS</strong></p>
<p><strong> <a href="http://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/DefaultDomainPolicy-Kerberos.jpg"><img loading="lazy" class="wp-image-978 aligncenter" title="DefaultDomainPolicy-Kerberos" src="https://blogs.metcorpconsulting.com/tech/wp-content/uploads/2012/01/DefaultDomainPolicy-Kerberos-300x76.jpg" alt="" width="463" height="116" /></a></strong></p>
<ul>
<li><strong>Enforce user logon restrictions: </strong>Enabled</li>
<li><strong>Maximum lifetime for service ticket: </strong>600 minutes (10 hours)</li>
<li><strong>Maximum lifetime for user ticket:</strong> 600 minutes (10 hours)</li>
<li><strong>Maximum lifetime for user ticket renewal :</strong> 7 days<strong><br />
</strong></li>
<li><strong>Maximum tolerance for computer clock synchronization: </strong>5 minutes</li>
</ul>
<p><strong>References:</strong></p>
<ul>
<li><a href="http://technet.microsoft.com/en-us/library/bb742516.aspx">Kerberos Explained</a></li>
<li><a href="http://blogs.technet.com/b/askds/archive/2008/03/06/kerberos-for-the-busy-admin.aspx">Kerberos for the Busy Admin</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/cc237917.aspx">[MS-PAC]: Privilege Attribute Certificate Data Structure</a></li>
<li><a href="http://en.wikipedia.org/wiki/Kerberos_%28protocol%29">The Kerberos Protocol (Wikipedia)</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa378747%28v=vs.85%29.aspx">Microsoft Kerberos Protocol (MSDN)</a></li>
<li><a href="http://technet.microsoft.com/en-us/library/cc780469%28WS.10%29.aspx">What is Kerberos Authentication</a></li>
<li><a href="http://technet.microsoft.com/en-us/library/cc739058%28WS.10%29.aspx">Kerberos Authentication Technical Reference</a></li>
<li><a href="http://technet.microsoft.com/en-us/library/cc772815%28WS.10%29.aspx">How the Kerberos Version 5 Authentication Protocol Works</a></li>
<li><a href="http://tools.ietf.org/html/rfc3244">Microsoft&#8217;s Kerberos Extensions &#8211; RFC 3244: &#8220;Microsoft Windows 2000 Kerberos Change Password and Set Password Protocols&#8221;</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/ff649429.aspx">Kerberos Technical Supplement for Windows</a></li>
</ul>
<div class="tptn_counter" id="tptn_counter_227">(Visited 21,283 times, 6 visits today)</div>								</div>
		
			    <ul class="entry-footer">
	    		        <li class="post-tags col-sm-8"><i class="fa fa-tags" title="Tags"></i> <span class="terms"><a class="term term-tagpost_tag term-75" href="https://adsecurity.org/?tag=active-directory">Active Directory</a>, <a class="term term-tagpost_tag term-76" href="https://adsecurity.org/?tag=as-rep">AS-REP</a>, <a class="term term-tagpost_tag term-77" href="https://adsecurity.org/?tag=as-req">AS-REQ</a>, <a class="term term-tagpost_tag term-78" href="https://adsecurity.org/?tag=configuration">Configuration</a>, <a class="term term-tagpost_tag term-79" href="https://adsecurity.org/?tag=domain-controller">Domain Controller</a>, <a class="term term-tagpost_tag term-80" href="https://adsecurity.org/?tag=kdc">KDC</a>, <a class="term term-tagpost_tag term-81" href="https://adsecurity.org/?tag=kerberos">Kerberos</a>, <a class="term term-tagpost_tag term-392" href="https://adsecurity.org/?tag=kerberosexplained">KerberosExplained</a>, <a class="term term-tagpost_tag term-393" href="https://adsecurity.org/?tag=kerberosoverview">KerberosOverview</a>, <a class="term term-tagpost_tag term-394" href="https://adsecurity.org/?tag=krbtgt">KRBTGT</a>, <a class="term term-tagpost_tag term-82" href="https://adsecurity.org/?tag=windows-server">Windows Server</a></span></li>
	        	        <li class="addthis col-sm-8"><div class="add-this"></div></li>
	        	    </ul>
    	</div>

</div>

    <div class="entry-author">
        <div class="row">
            <div class="author-avatar col-sm-3">
            	<a href="https://adsecurity.org/?author=2" rel="author">
					<img alt='' src='https://secure.gravatar.com/avatar/1f3ad5e878e5d0e6096c5a33718a04d0?s=200&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f3ad5e878e5d0e6096c5a33718a04d0?s=400&#038;d=mm&#038;r=g 2x' class='avatar avatar-200 photo' height='200' width='200' loading='lazy'/>                </a>
            </div>

            <div class="author-bio col-sm-9">
                <h3 class="section-title-sm">Sean Metcalf</h3>
                <p>I improve security for enterprises around the world working for TrimarcSecurity.com<br />
Read the About page (top left) for information about me. :)<br />
https://adsecurity.org/?page_id=8</p>
    <ul class="author-social">
    	        
			        <li><a href="mailto:sean@adsecurity.org"><i class="fa fa-envelope-o"></i></a></li>
            </ul>
                </div>
        </div>
    </div>
    












            
  

                </div><!-- #content-main -->
        
            
<div id="sidebar1" class="sidebar sidebar-right widget-area col-md-4">

	
    
		<div id="recent-posts-4" class="sidebar-wrap widget_recent_entries">
		<h3>Recent Posts</h3>
		<ul>
											<li>
					<a href="https://adsecurity.org/?p=4367">Attacking Active Directory Group Managed Service Accounts (GMSAs)</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4277">From Azure AD to Active Directory (via Azure) &#8211; An Unanticipated Attack Path</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4211">What is Azure Active Directory?</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4179">Slides Posted for Black Hat USA 2019 Talk: Attacking &#038; Defending the Microsoft Cloud</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4187">AD Reading: Windows Server 2019 Active Directory Features</a>
									</li>
					</ul>

		</div><div id="text-3" class="sidebar-wrap widget_text"><h3>Trimarc Active Directory Security Services</h3>			<div class="textwidget">Have concerns about your Active Directory environment?

Trimarc helps enterprises improve their security posture. <p>
<a href="http://trimarcsecurity.com/security-services">Find out how...</a> 
TrimarcSecurity.com</div>
		</div><div id="widget_tptn_pop-4" class="sidebar-wrap tptn_posts_list_widget"><h3>Popular Posts</h3><div class="tptn_posts  tptn_posts_widget tptn_posts_widget4"><ul><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2362"     class="tptn_link"><span class="tptn_title">Attack Methods for Gaining Domain Admin Rights in&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=478"     class="tptn_link"><span class="tptn_title">PowerShell Encoding &#038; Decoding (Base64)</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=483"     class="tptn_link"><span class="tptn_title">Kerberos &#038; KRBTGT: Active Directory&#8217;s&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=3377"     class="tptn_link"><span class="tptn_title">Securing Domain Controllers to Improve Active&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2288"     class="tptn_link"><span class="tptn_title">Finding Passwords in SYSVOL &#038; Exploiting Group&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=3299"     class="tptn_link"><span class="tptn_title">Securing Windows Workstations: Developing a Secure Baseline</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1684"     class="tptn_link"><span class="tptn_title">The Most Common Active Directory Security Issues and&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2653"     class="tptn_link"><span class="tptn_title">Building an Effective Active Directory Lab&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1729"     class="tptn_link"><span class="tptn_title">Mimikatz DCSync Usage, Exploitation, and Detection</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1790"     class="tptn_link"><span class="tptn_title">Microsoft Local Administrator Password Solution (LAPS)</span></a></span></li></ul><div class="tptn_clear"></div></div></div><div id="categories-4" class="sidebar-wrap widget_categories"><h3>Categories</h3>
			<ul>
					<li class="cat-item cat-item-565"><a href="https://adsecurity.org/?cat=565">ActiveDirectorySecurity</a>
</li>
	<li class="cat-item cat-item-55"><a href="https://adsecurity.org/?cat=55">Apple Security</a>
</li>
	<li class="cat-item cat-item-431"><a href="https://adsecurity.org/?cat=431">Cloud Security</a>
</li>
	<li class="cat-item cat-item-17"><a href="https://adsecurity.org/?cat=17">Continuing Education</a>
</li>
	<li class="cat-item cat-item-396"><a href="https://adsecurity.org/?cat=396">Entertainment</a>
</li>
	<li class="cat-item cat-item-347"><a href="https://adsecurity.org/?cat=347">Exploit</a>
</li>
	<li class="cat-item cat-item-1039"><a href="https://adsecurity.org/?cat=1039">Hacking</a>
</li>
	<li class="cat-item cat-item-168"><a href="https://adsecurity.org/?cat=168">Hardware Security</a>
</li>
	<li class="cat-item cat-item-172"><a href="https://adsecurity.org/?cat=172">Hypervisor Security</a>
</li>
	<li class="cat-item cat-item-126"><a href="https://adsecurity.org/?cat=126">Linux/Unix Security</a>
</li>
	<li class="cat-item cat-item-343"><a href="https://adsecurity.org/?cat=343">Malware</a>
</li>
	<li class="cat-item cat-item-11"><a href="https://adsecurity.org/?cat=11">Microsoft Security</a>
</li>
	<li class="cat-item cat-item-819"><a href="https://adsecurity.org/?cat=819">Mitigation</a>
</li>
	<li class="cat-item cat-item-48"><a href="https://adsecurity.org/?cat=48">Network/System Security</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://adsecurity.org/?cat=7">PowerShell</a>
</li>
	<li class="cat-item cat-item-698"><a href="https://adsecurity.org/?cat=698">RealWorld</a>
</li>
	<li class="cat-item cat-item-21"><a href="https://adsecurity.org/?cat=21">Security</a>
</li>
	<li class="cat-item cat-item-234"><a href="https://adsecurity.org/?cat=234">Security Conference Presentation/Video</a>
</li>
	<li class="cat-item cat-item-1045"><a href="https://adsecurity.org/?cat=1045">Security Recommendation</a>
</li>
	<li class="cat-item cat-item-24"><a href="https://adsecurity.org/?cat=24">Technical Article</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://adsecurity.org/?cat=4">Technical Reading</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://adsecurity.org/?cat=2">Technical Reference</a>
</li>
	<li class="cat-item cat-item-156"><a href="https://adsecurity.org/?cat=156">TheCloud</a>
</li>
	<li class="cat-item cat-item-930"><a href="https://adsecurity.org/?cat=930">Vulnerability</a>
</li>
			</ul>

			</div><div id="tag_cloud-3" class="sidebar-wrap widget_tag_cloud"><h3>Tags</h3><div class="tagcloud"><a href="https://adsecurity.org/?tag=activedirectory" class="tag-cloud-link tag-link-20 tag-link-position-1" style="font-size: 22pt;" aria-label="ActiveDirectory (52 items)">ActiveDirectory</a>
<a href="https://adsecurity.org/?tag=active-directory" class="tag-cloud-link tag-link-75 tag-link-position-2" style="font-size: 10.531914893617pt;" aria-label="Active Directory (8 items)">Active Directory</a>
<a href="https://adsecurity.org/?tag=activedirectoryattack" class="tag-cloud-link tag-link-537 tag-link-position-3" style="font-size: 8pt;" aria-label="ActiveDirectoryAttack (5 items)">ActiveDirectoryAttack</a>
<a href="https://adsecurity.org/?tag=activedirectorysecurity" class="tag-cloud-link tag-link-113 tag-link-position-4" style="font-size: 13.957446808511pt;" aria-label="ActiveDirectorySecurity (14 items)">ActiveDirectorySecurity</a>
<a href="https://adsecurity.org/?tag=active-directory-security" class="tag-cloud-link tag-link-976 tag-link-position-5" style="font-size: 9.7872340425532pt;" aria-label="Active Directory Security (7 items)">Active Directory Security</a>
<a href="https://adsecurity.org/?tag=adreading" class="tag-cloud-link tag-link-5 tag-link-position-6" style="font-size: 13.510638297872pt;" aria-label="ADReading (13 items)">ADReading</a>
<a href="https://adsecurity.org/?tag=adsecurity" class="tag-cloud-link tag-link-86 tag-link-position-7" style="font-size: 10.531914893617pt;" aria-label="ADSecurity (8 items)">ADSecurity</a>
<a href="https://adsecurity.org/?tag=ad-security" class="tag-cloud-link tag-link-100 tag-link-position-8" style="font-size: 8pt;" aria-label="AD Security (5 items)">AD Security</a>
<a href="https://adsecurity.org/?tag=dcsync" class="tag-cloud-link tag-link-598 tag-link-position-9" style="font-size: 10.531914893617pt;" aria-label="DCSync (8 items)">DCSync</a>
<a href="https://adsecurity.org/?tag=defcon" class="tag-cloud-link tag-link-518 tag-link-position-10" style="font-size: 8pt;" aria-label="DEFCON (5 items)">DEFCON</a>
<a href="https://adsecurity.org/?tag=domaincontroller" class="tag-cloud-link tag-link-101 tag-link-position-11" style="font-size: 15.446808510638pt;" aria-label="DomainController (18 items)">DomainController</a>
<a href="https://adsecurity.org/?tag=emet5" class="tag-cloud-link tag-link-338 tag-link-position-12" style="font-size: 8pt;" aria-label="EMET5 (5 items)">EMET5</a>
<a href="https://adsecurity.org/?tag=goldenticket" class="tag-cloud-link tag-link-303 tag-link-position-13" style="font-size: 11.276595744681pt;" aria-label="GoldenTicket (9 items)">GoldenTicket</a>
<a href="https://adsecurity.org/?tag=hyperv" class="tag-cloud-link tag-link-3 tag-link-position-14" style="font-size: 8pt;" aria-label="HyperV (5 items)">HyperV</a>
<a href="https://adsecurity.org/?tag=invoke-mimikatz" class="tag-cloud-link tag-link-336 tag-link-position-15" style="font-size: 10.531914893617pt;" aria-label="Invoke-Mimikatz (8 items)">Invoke-Mimikatz</a>
<a href="https://adsecurity.org/?tag=kb3011780" class="tag-cloud-link tag-link-337 tag-link-position-16" style="font-size: 9.7872340425532pt;" aria-label="KB3011780 (7 items)">KB3011780</a>
<a href="https://adsecurity.org/?tag=kdc" class="tag-cloud-link tag-link-80 tag-link-position-17" style="font-size: 8pt;" aria-label="KDC (5 items)">KDC</a>
<a href="https://adsecurity.org/?tag=kerberos" class="tag-cloud-link tag-link-81 tag-link-position-18" style="font-size: 15.446808510638pt;" aria-label="Kerberos (18 items)">Kerberos</a>
<a href="https://adsecurity.org/?tag=kerberoshacking" class="tag-cloud-link tag-link-298 tag-link-position-19" style="font-size: 11.872340425532pt;" aria-label="KerberosHacking (10 items)">KerberosHacking</a>
<a href="https://adsecurity.org/?tag=krbtgt" class="tag-cloud-link tag-link-394 tag-link-position-20" style="font-size: 9.7872340425532pt;" aria-label="KRBTGT (7 items)">KRBTGT</a>
<a href="https://adsecurity.org/?tag=laps" class="tag-cloud-link tag-link-631 tag-link-position-21" style="font-size: 9.0425531914894pt;" aria-label="LAPS (6 items)">LAPS</a>
<a href="https://adsecurity.org/?tag=lsass" class="tag-cloud-link tag-link-71 tag-link-position-22" style="font-size: 11.276595744681pt;" aria-label="LSASS (9 items)">LSASS</a>
<a href="https://adsecurity.org/?tag=mcm" class="tag-cloud-link tag-link-6 tag-link-position-23" style="font-size: 14.255319148936pt;" aria-label="MCM (15 items)">MCM</a>
<a href="https://adsecurity.org/?tag=microsoftemet" class="tag-cloud-link tag-link-58 tag-link-position-24" style="font-size: 11.276595744681pt;" aria-label="MicrosoftEMET (9 items)">MicrosoftEMET</a>
<a href="https://adsecurity.org/?tag=microsoftwindows" class="tag-cloud-link tag-link-102 tag-link-position-25" style="font-size: 9.7872340425532pt;" aria-label="MicrosoftWindows (7 items)">MicrosoftWindows</a>
<a href="https://adsecurity.org/?tag=mimikatz" class="tag-cloud-link tag-link-207 tag-link-position-26" style="font-size: 18.425531914894pt;" aria-label="mimikatz (29 items)">mimikatz</a>
<a href="https://adsecurity.org/?tag=ms14068" class="tag-cloud-link tag-link-295 tag-link-position-27" style="font-size: 11.276595744681pt;" aria-label="MS14068 (9 items)">MS14068</a>
<a href="https://adsecurity.org/?tag=passthehash" class="tag-cloud-link tag-link-44 tag-link-position-28" style="font-size: 9.7872340425532pt;" aria-label="PassTheHash (7 items)">PassTheHash</a>
<a href="https://adsecurity.org/?tag=powershell" class="tag-cloud-link tag-link-575 tag-link-position-29" style="font-size: 18.872340425532pt;" aria-label="PowerShell (31 items)">PowerShell</a>
<a href="https://adsecurity.org/?tag=powershellcode" class="tag-cloud-link tag-link-22 tag-link-position-30" style="font-size: 15.148936170213pt;" aria-label="PowerShellCode (17 items)">PowerShellCode</a>
<a href="https://adsecurity.org/?tag=powershellhacking" class="tag-cloud-link tag-link-68 tag-link-position-31" style="font-size: 8pt;" aria-label="PowerShellHacking (5 items)">PowerShellHacking</a>
<a href="https://adsecurity.org/?tag=powershellv5" class="tag-cloud-link tag-link-69 tag-link-position-32" style="font-size: 8pt;" aria-label="PowerShellv5 (5 items)">PowerShellv5</a>
<a href="https://adsecurity.org/?tag=powersploit" class="tag-cloud-link tag-link-232 tag-link-position-33" style="font-size: 10.531914893617pt;" aria-label="PowerSploit (8 items)">PowerSploit</a>
<a href="https://adsecurity.org/?tag=presentation" class="tag-cloud-link tag-link-422 tag-link-position-34" style="font-size: 9.7872340425532pt;" aria-label="Presentation (7 items)">Presentation</a>
<a href="https://adsecurity.org/?tag=security" class="tag-cloud-link tag-link-576 tag-link-position-35" style="font-size: 8pt;" aria-label="Security (5 items)">Security</a>
<a href="https://adsecurity.org/?tag=sidhistory" class="tag-cloud-link tag-link-547 tag-link-position-36" style="font-size: 8pt;" aria-label="SIDHistory (5 items)">SIDHistory</a>
<a href="https://adsecurity.org/?tag=silverticket" class="tag-cloud-link tag-link-304 tag-link-position-37" style="font-size: 11.276595744681pt;" aria-label="SilverTicket (9 items)">SilverTicket</a>
<a href="https://adsecurity.org/?tag=sneakyadpersistence" class="tag-cloud-link tag-link-596 tag-link-position-38" style="font-size: 9.0425531914894pt;" aria-label="SneakyADPersistence (6 items)">SneakyADPersistence</a>
<a href="https://adsecurity.org/?tag=spn" class="tag-cloud-link tag-link-294 tag-link-position-39" style="font-size: 9.0425531914894pt;" aria-label="SPN (6 items)">SPN</a>
<a href="https://adsecurity.org/?tag=tgs" class="tag-cloud-link tag-link-528 tag-link-position-40" style="font-size: 9.0425531914894pt;" aria-label="TGS (6 items)">TGS</a>
<a href="https://adsecurity.org/?tag=tgt" class="tag-cloud-link tag-link-529 tag-link-position-41" style="font-size: 9.0425531914894pt;" aria-label="TGT (6 items)">TGT</a>
<a href="https://adsecurity.org/?tag=windows10" class="tag-cloud-link tag-link-494 tag-link-position-42" style="font-size: 10.531914893617pt;" aria-label="Windows10 (8 items)">Windows10</a>
<a href="https://adsecurity.org/?tag=windowsserver2008r2" class="tag-cloud-link tag-link-46 tag-link-position-43" style="font-size: 9.0425531914894pt;" aria-label="WindowsServer2008R2 (6 items)">WindowsServer2008R2</a>
<a href="https://adsecurity.org/?tag=windowsserver2012" class="tag-cloud-link tag-link-47 tag-link-position-44" style="font-size: 11.276595744681pt;" aria-label="WindowsServer2012 (9 items)">WindowsServer2012</a>
<a href="https://adsecurity.org/?tag=windowsserver2012r2" class="tag-cloud-link tag-link-54 tag-link-position-45" style="font-size: 9.7872340425532pt;" aria-label="WindowsServer2012R2 (7 items)">WindowsServer2012R2</a></div>
</div>    
        
    
</div><!-- #sidebar1 -->        
        
    </div><!-- #content -->


    
        
    <div id="sidebar_bottom" class="sidebar widget-area row footer-widget-col-3">
                    <div id="text-2" class="sidebar-wrap widget_text col-sm-4"><h3>Copyright</h3>			<div class="textwidget">Content Disclaimer: This blog and its contents are provided "AS IS" with no warranties, and they confer no rights. Script samples are provided for informational purposes only and no guarantee is provided as to functionality or suitability.
The views shared on this blog reflect those of the authors and do not represent the views of any companies mentioned.

Content Ownership: All content posted here is intellectual work and under the current law, the poster owns the copyright of the article. Terms of Use Copyright © 2011 - 2020.</div>
		</div>		
            </div>

	

<div id="footer" class="row default-footer">
    
        
            
            <div class="copyright-developer">
                                    <div id="copyright">
                        <p>Content Disclaimer: This blog and its contents are provided "AS IS" with no warranties, and they confer no rights. Script samples are provided for informational purposes only and no guarantee is provided as to functionality or suitability. The views shared on this blog reflect those of the authors and do not represent the views of any companies mentioned. </p>
                    </div>
                
                                    <div id="developer">
                        <p>
                                                        Made with <i class="fa fa-heart"></i> by <a href="https://www.graphene-theme.com/" rel="nofollow">Graphene Themes</a>.                        </p>

                                            </div>
                            </div>

        
                
    </div><!-- #footer -->


</div><!-- #container -->

		<!-- Start of StatCounter Code -->
		<script>
			<!--
			var sc_project=10100711;
			var sc_security="4b306538";
			      var sc_invisible=1;
			var scJsHost = (("https:" == document.location.protocol) ?
				"https://secure." : "http://www.");
			//-->
					</script>
		
<script type="text/javascript"
				src="https://secure.statcounter.com/counter/counter.js"
				async></script>		<noscript><div class="statcounter"><a title="web analytics" href="https://statcounter.com/"><img class="statcounter" src="https://c.statcounter.com/10100711/0/4b306538/1/" alt="web analytics" /></a></div></noscript>
		<!-- End of StatCounter Code -->
				<a href="#" id="back-to-top" title="Back to top"><i class="fa fa-chevron-up"></i></a>
	<script type='text/javascript' id='tptn_tracker-js-extra'>
/* <![CDATA[ */
var ajax_tptn_tracker = {"ajax_url":"https:\/\/adsecurity.org\/wp-admin\/admin-ajax.php","top_ten_id":"227","top_ten_blog_id":"1","activate_counter":"11","top_ten_debug":"0","tptn_rnd":"1027930140"};
/* ]]> */
</script>
<script type='text/javascript' src='https://adsecurity.org/wp-content/plugins/top-10/includes/js/top-10-tracker.min.js?ver=1.0' id='tptn_tracker-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-includes/js/comment-reply.min.js?ver=5.7.2' id='comment-reply-js'></script>
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/wp-embed.min.js?ver=5.7.2' id='wp-embed-js'></script>
</body>
</html>