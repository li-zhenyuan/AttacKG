<!DOCTYPE html>
<html class='v2' dir='ltr' lang='fr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/115981500-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://adds-security.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://adds-security.blogspot.com/2018/02/detecter-dcshadow-impossible.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Active Directory et la Sécurité - Atom" href="https://adds-security.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Active Directory et la Sécurité - RSS" href="https://adds-security.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Active Directory et la Sécurité - Atom" href="https://www.blogger.com/feeds/4451739250645785187/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Active Directory et la Sécurité - Atom" href="https://adds-security.blogspot.com/feeds/5206035592070825767/comments/default" />
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/951198144-ieretrofit.js"></script>
<![endif]-->
<link href='https://1.bp.blogspot.com/-svGKyONCwNY/WofffuBcUII/AAAAAAAACU0/zQu7YsSGV5wrZ5wGxOn3h8du-PJ0NzSVACLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B08-34-49.png' rel='image_src'/>
<meta content='http://adds-security.blogspot.com/2018/02/detecter-dcshadow-impossible.html' property='og:url'/>
<meta content='Détecter DCShadow, impossible ?' property='og:title'/>
<meta content='Bonjour à tous,   Je vous propose aujourd&#39;hui un article sur l&#39;attaque présentée par Vincent Le Toux ( @mysmartlogon ) et Benjamin Delpy ( @...' property='og:description'/>
<meta content='https://1.bp.blogspot.com/-svGKyONCwNY/WofffuBcUII/AAAAAAAACU0/zQu7YsSGV5wrZ5wGxOn3h8du-PJ0NzSVACLcBGAs/w1200-h630-p-k-no-nu/Screenshot%2Bfrom%2B2018-02-17%2B08-34-49.png' property='og:image'/>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>Active Directory et la Sécurité: Détecter DCShadow, impossible ?</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Awesome Inc.
Designer: Tina Chen
URL:      tinachen.org
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: #eeeeee none repeat scroll top left;
}
html body .content-outer {
min-width: 0;
max-width: 100%;
width: 100%;
}
a:link {
text-decoration: none;
color: #3778cd;
}
a:visited {
text-decoration: none;
color: #4d469c;
}
a:hover {
text-decoration: underline;
color: #3778cd;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 276px;
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
/* Columns
----------------------------------------------- */
.content-inner {
padding: 0;
}
.header-inner .section {
margin: 0 16px;
}
.tabs-inner .section {
margin: 0 16px;
}
.main-inner {
padding-top: 30px;
}
.main-inner .column-center-inner,
.main-inner .column-left-inner,
.main-inner .column-right-inner {
padding: 0 5px;
}
*+html body .main-inner .column-center-inner {
margin-top: -30px;
}
#layout .main-inner .column-center-inner {
margin-top: 0;
}
/* Header
----------------------------------------------- */
.header-outer {
margin: 0 0 0 0;
background: transparent none repeat scroll 0 0;
}
.Header h1 {
font: normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
text-shadow: 0 0 -1px #000000;
}
.Header h1 a {
color: #444444;
}
.Header .description {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
margin-bottom: 0;
}
.header-inner .Header .titlewrapper {
padding-top: 22px;
}
/* Tabs
----------------------------------------------- */
.tabs-outer {
overflow: hidden;
position: relative;
background: #eeeeee url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
#layout .tabs-outer {
overflow: visible;
}
.tabs-cap-top, .tabs-cap-bottom {
position: absolute;
width: 100%;
border-top: 1px solid #999999;
}
.tabs-cap-bottom {
bottom: 0;
}
.tabs-inner .widget li a {
display: inline-block;
margin: 0;
padding: .6em 1.5em;
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
border-left: 1px solid #999999;
height: 16px;
line-height: 16px;
}
.tabs-inner .widget li:last-child a {
border-right: 1px solid #999999;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
background: #666666 url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat-x scroll 0 -100px;
color: #ffffff;
}
/* Headings
----------------------------------------------- */
h2 {
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
/* Widgets
----------------------------------------------- */
.main-inner .section {
margin: 0 27px;
padding: 0;
}
.main-inner .column-left-outer,
.main-inner .column-right-outer {
margin-top: 0;
}
#layout .main-inner .column-left-outer,
#layout .main-inner .column-right-outer {
margin-top: 0;
}
.main-inner .column-left-inner,
.main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
#layout .main-inner .column-left-inner,
#layout .main-inner .column-right-inner {
margin-top: 0;
}
.sidebar .widget {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.sidebar .widget a:link {
color: #3778cd;
}
.sidebar .widget a:visited {
color: #4d469c;
}
.sidebar .widget a:hover {
color: #3778cd;
}
.sidebar .widget h2 {
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget {
background-color: #ffffff;
border: 1px solid #eeeeee;
padding: 0 15px 15px;
margin: 20px -16px;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.main-inner .widget h2 {
margin: 0 -15px;
padding: .6em 15px .5em;
border-bottom: 1px solid transparent;
}
.footer-inner .widget h2 {
padding: 0 0 .4em;
border-bottom: 1px solid transparent;
}
.main-inner .widget h2 + div, .footer-inner .widget h2 + div {
border-top: 1px solid #eeeeee;
padding-top: 8px;
}
.main-inner .widget .widget-content {
margin: 0 -15px;
padding: 7px 15px 0;
}
.main-inner .widget ul, .main-inner .widget #ArchiveList ul.flat {
margin: -8px -15px 0;
padding: 0;
list-style: none;
}
.main-inner .widget #ArchiveList {
margin: -8px 0 0;
}
.main-inner .widget ul li, .main-inner .widget #ArchiveList ul.flat li {
padding: .5em 15px;
text-indent: 0;
color: #666666;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid transparent;
}
.main-inner .widget #ArchiveList ul li {
padding-top: .25em;
padding-bottom: .25em;
}
.main-inner .widget ul li:first-child, .main-inner .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.main-inner .widget ul li:last-child, .main-inner .widget #ArchiveList ul.flat li:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.main-inner .widget .post-body ul {
padding: 0 2.5em;
margin: .5em 0;
list-style: disc;
}
.main-inner .widget .post-body ul li {
padding: 0.25em 0;
margin-bottom: .25em;
color: #444444;
border: none;
}
.footer-inner .widget ul {
padding: 0;
list-style: none;
}
.widget .zippy {
color: #666666;
}
/* Posts
----------------------------------------------- */
body .main-inner .Blog {
padding: 0;
margin-bottom: 1em;
background-color: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}
.main-inner .section:last-child .Blog:last-child {
padding: 0;
margin-bottom: 1em;
}
.main-inner .widget h2.date-header {
margin: 0 -15px 1px;
padding: 0 0 0 0;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: transparent none no-repeat scroll top left;
border-top: 0 solid #eeeeee;
border-bottom: 1px solid transparent;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
position: static;
bottom: 100%;
right: 15px;
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget h2.date-header span {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
display: block;
padding: .5em 15px;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.date-outer {
position: relative;
margin: 30px 0 20px;
padding: 0 15px;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.date-outer:first-child {
margin-top: 0;
}
.date-outer:last-child {
margin-bottom: 20px;
-moz-border-radius-bottomleft: 0;
-moz-border-radius-bottomright: 0;
-webkit-border-bottom-left-radius: 0;
-webkit-border-bottom-right-radius: 0;
-goog-ms-border-bottom-left-radius: 0;
-goog-ms-border-bottom-right-radius: 0;
border-bottom-left-radius: 0;
border-bottom-right-radius: 0;
}
.date-posts {
margin: 0 -15px;
padding: 0 15px;
clear: both;
}
.post-outer, .inline-ad {
border-top: 1px solid #eeeeee;
margin: 0 -15px;
padding: 15px 15px;
}
.post-outer {
padding-bottom: 10px;
}
.post-outer:first-child {
padding-top: 0;
border-top: none;
}
.post-outer:last-child, .inline-ad:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.post-body img {
padding: 8px;
background: transparent;
border: 1px solid transparent;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
border-radius: 0;
}
h3.post-title, h4 {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a:hover {
color: #3778cd;
text-decoration: underline;
}
.post-header {
margin: 0 0 1em;
}
.post-body {
line-height: 1.4;
}
.post-outer h2 {
color: #444444;
}
.post-footer {
margin: 1.5em 0 0;
}
#blog-pager {
padding: 15px;
font-size: 120%;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius-topright: 0;
margin-top: 1em;
}
.blog-feeds, .post-feeds {
margin: 1em 0;
text-align: center;
color: #444444;
}
.blog-feeds a, .post-feeds a {
color: #3778cd;
}
.blog-feeds a:visited, .post-feeds a:visited {
color: #4d469c;
}
.blog-feeds a:hover, .post-feeds a:hover {
color: #3778cd;
}
.post-outer .comments {
margin-top: 2em;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Footer
----------------------------------------------- */
.footer-outer {
margin: -20px 0 -1px;
padding: 20px 0 0;
color: #444444;
overflow: hidden;
}
.footer-fauxborder-left {
border-top: 1px solid #eeeeee;
background: #ffffff none repeat scroll 0 0;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
margin: 0 -20px;
}
/* Mobile
----------------------------------------------- */
body.mobile {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
*+html body.mobile .main-inner .column-center-inner {
margin-top: 0;
}
.mobile .main-inner .widget {
padding: 0 0 15px;
}
.mobile .main-inner .widget h2 + div,
.mobile .footer-inner .widget h2 + div {
border-top: none;
padding-top: 0;
}
.mobile .footer-inner .widget h2 {
padding: 0.5em 0;
border-bottom: none;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile .main-inner .widget ul,
.mobile .main-inner .widget #ArchiveList ul.flat {
margin: 0 -15px 0;
}
.mobile .main-inner .widget h2.date-header {
right: 0;
}
.mobile .date-header span {
padding: 0.4em 0;
}
.mobile .date-outer:first-child {
margin-bottom: 0;
border: 1px solid #eeeeee;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
}
.mobile .date-outer {
border-color: #eeeeee;
border-width: 0 1px 1px;
}
.mobile .date-outer:last-child {
margin-bottom: 0;
}
.mobile .main-inner {
padding: 0;
}
.mobile .header-inner .section {
margin: 0;
}
.mobile .post-outer, .mobile .inline-ad {
padding: 5px 0;
}
.mobile .tabs-inner .section {
margin: 0 10px;
}
.mobile .main-inner .widget h2 {
margin: 0;
padding: 0;
}
.mobile .main-inner .widget h2.date-header span {
padding: 0;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile #blog-pager {
border: 1px solid transparent;
background: #ffffff none repeat scroll 0 0;
}
.mobile .main-inner .column-left-inner,
.mobile .main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: none;
-webkit-box-shadow: none;
-goog-ms-box-shadow: none;
box-shadow: none;
}
.mobile .date-posts {
margin: 0;
padding: 0;
}
.mobile .footer-fauxborder-left {
margin: 0;
border-top: inherit;
}
.mobile .main-inner .section:last-child .Blog:last-child {
margin-bottom: 0;
}
.mobile-index-contents {
color: #444444;
}
.mobile .mobile-link-button {
background: #3778cd url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content {
background: transparent;
border-top: 1px solid;
border-color: #999999;
color: #444444;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #999999;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1100px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1100px;
max-width: 1100px;
_width: 1100px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4451739250645785187&amp;zx=72883e26-ae67-45d1-91aa-9d2ff9bea580' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4451739250645785187&amp;zx=72883e26-ae67-45d1-91aa-9d2ff9bea580' rel='stylesheet'/></noscript>

</head>
<body class='loading variant-light'>
<div class='navbar section' id='navbar' name='Barre de navigation'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d4451739250645785187\x26blogName\x3dActive+Directory+et+la+S%C3%A9curit%C3%A9\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://adds-security.blogspot.com/search\x26blogLocale\x3dfr\x26v\x3d2\x26homepageUrl\x3dhttps://adds-security.blogspot.com/\x26targetPostID\x3d5206035592070825767\x26blogPostOrPageUrl\x3dhttps://adds-security.blogspot.com/2018/02/detecter-dcshadow-impossible.html\x26vt\x3d3520423670057078694',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='En-tête'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://adds-security.blogspot.com/'>
Active Directory et la Sécurité
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>Blog dédié à la sécurisation des environnements Active Directory et  aux environnements Microsoft en général</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Toutes les colonnes'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Principal'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>dimanche 18 février 2018</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://1.bp.blogspot.com/-svGKyONCwNY/WofffuBcUII/AAAAAAAACU0/zQu7YsSGV5wrZ5wGxOn3h8du-PJ0NzSVACLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B08-34-49.png' itemprop='image_url'/>
<meta content='4451739250645785187' itemprop='blogId'/>
<meta content='5206035592070825767' itemprop='postId'/>
<a name='5206035592070825767'></a>
<h3 class='post-title entry-title' itemprop='name'>
Détecter DCShadow, impossible ?
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-5206035592070825767' itemprop='description articleBody'>
Bonjour à tous,<br />
<br />
Je vous propose aujourd'hui un article sur l'attaque présentée par Vincent Le Toux (<a href="https://twitter.com/mysmartlogon">@mysmartlogon</a>) et Benjamin Delpy (<a href="https://twitter.com/gentilkiwi">@gentilkiwi</a>) durant la conférence de sécurité BluehatIL 2018 qui a eu lieu les 23 et 24 janvier.<br />
<br />
Leur présentation s'intitulait&nbsp;<b>Active Directory: What can make your million dollar SIEM go blind?</b><br />
<b><br /></b>
En effet, l'intérêt pour un attaquant d'utiliser DCSHadow est de ne laisser aucune tracer de ses modifications puisque celles-ci sont effectuées sur une machine compromise par l'attaquant. Ainsi aucun log de modification AD n'est remonté.<br />
<br />
Vous pouvez retrouver la vidéo et les slides de la présentation sur le site officiel sur DCShadow&nbsp;<a href="https://www.dcshadow.com/">https://www.dcshadow.com/</a>.<br />
<br />
<br />
<h2>
Un peu d'histoire</h2>
La première évocation par Vincent et Benjamin&nbsp;de ce qui allait devenir DCShadow remonte à l'été 2017.<br />
<br />
Faisant de la réponse à incident sur Active Directory depuis quelques années le tweet de Vincent m'a forcémment interpelé. La possibilité qu'un attaquant puisse altérer les métadonnées de réplication a toujours été une de nos craintes sur le forensic AD.<br />
<br />
J'ai pourtant évoqué en répondant à ses tweets une autre méthode, non forensic mais plus de blue team, les cookies de réplication AD.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-svGKyONCwNY/WofffuBcUII/AAAAAAAACU0/zQu7YsSGV5wrZ5wGxOn3h8du-PJ0NzSVACLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B08-34-49.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" data-original-height="898" data-original-width="634" height="400" src="https://1.bp.blogspot.com/-svGKyONCwNY/WofffuBcUII/AAAAAAAACU0/zQu7YsSGV5wrZ5wGxOn3h8du-PJ0NzSVACLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B08-34-49.png" width="281" /></a><a href="https://4.bp.blogspot.com/-daduxMtDwVg/WofeYHQnbPI/AAAAAAAACUs/-3jo4m27klI-6xycRZ1Cc1V56c6kJWpGgCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B08-35-51.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="919" data-original-width="639" height="400" src="https://4.bp.blogspot.com/-daduxMtDwVg/WofeYHQnbPI/AAAAAAAACUs/-3jo4m27klI-6xycRZ1Cc1V56c6kJWpGgCLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B08-35-51.png" width="277" /></a></div>
<div class="separator" style="clear: both; text-align: center;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Les cookies de réplication AD sont assez méconnus mais utilisés par les équipes de réponse à incident AD lors des remédiations/reconstructions d'environnement Active Directory compromis.</div>
<div class="separator" style="clear: both; text-align: left;">
Ils permettent notamment de limiter l'interruption de service lors de la remédiation contrairement aux précédentes méthodologies.</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
C'est un sujet assez peu documenté mais on peut en trouver une trace dans la présentation de l'ANSSI sur TV5 Monde du SSTIC 2017 <a href="https://www.sstic.org/2017/presentation/2017_cloture/">Retour technique de l'incident de TV5Monde</a>.</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<h2 style="clear: both; text-align: left;">
Cookie de réplication AD</h2>
<div class="separator" style="clear: both; text-align: left;">
Un cookie de réplication est un fichier généré par l'utilisation d'une extension de serveur LDAP, le contrôle DirSync. Il faut d'abord initialiser le cookie pour pouvoir avoir les modifications depuis la dernière utilisation du cookie.</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Pour plus d'informations sur comment tracer les modifications vous pouvez consulter le lien suivant :&nbsp;<a href="https://msdn.microsoft.com/en-us/library/ms677625(v=vs.85).aspx">Overview of Change Tracking Techniques</a>.</div>
<div class="separator" style="clear: both; text-align: left;">
Vous retrouverez dedans une page dédiée au contrôle DirSync.&nbsp;</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Pour utiliser ce contrôle, il ya plusieurs possibilités.</div>
<div class="separator" style="clear: both; text-align: left;">
La plus simple pour tester rapidement, c'est d'utiliser Repadmin avec le switch /showchanges (visible avec l'aide en mode expert de repadmin /experthelp).</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
C'est ce que je vais utiliser dans cet article.</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Pour des résultats plus exploitables, on utilisera les méthodes de la classe&nbsp;<a href="https://msdn.microsoft.com/fr-fr/library/system.directoryservices.directorysynchronization(v=vs.110).aspx">System.DirectoryServices.DirectorySynchronization</a>&nbsp;</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Ca marche très bien avec du powershell :</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://3.bp.blogspot.com/-hRVcyAwId8E/Wolf7qJ12TI/AAAAAAAACjY/D6XhoOsrY-wITuxZ2HzrQIXaNDS1poTCACLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-15%2B10-26-28.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="855" data-original-width="1600" height="213" src="https://3.bp.blogspot.com/-hRVcyAwId8E/Wolf7qJ12TI/AAAAAAAACjY/D6XhoOsrY-wITuxZ2HzrQIXaNDS1poTCACLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-15%2B10-26-28.png" width="400" /></a></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Je ne vais pas m'étender c'est relativement simple à utiliser. Revenons maintenant sur l'attaque DCShadow.</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<h2 style="clear: both; text-align: left;">
Détection de l'utilisation de DCShadow</h2>
<div class="separator" style="clear: both; text-align: left;">
Alsid a fait un très bon article sur DCShadow (<a href="https://blog.alsid.eu/dcshadow-explained-4510f52fc19d">DCShadow explained: A technical deep dive into the latest AD attack technique</a>) je vais donc revenir dessus très brièvement.&nbsp; &nbsp;</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Détecter l'utilisation de DCShadow peut paraître assez trivial. En effet, pour être utilisé, DCShadow doit au préalable effectuer des modifications sur des objets Active Directory. En journalisant la modification de ces objets, on peut détecter facilement l'utilisation de DCShadow.</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Il suffit pour cela de configurer correctement la politique d'audit (audit réplication détaillée et modifications AD) et de configurer quelques SACL (écriture de l'attribut servicePrincipalName des objets Computer ).</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-sSki5SfxbcM/WogM11jO9SI/AAAAAAAACVI/4XkQT-2rTQwx5hRKhLYrVdsIbse_yKt2gCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-15%2B09-41-38.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="725" data-original-width="639" height="320" src="https://1.bp.blogspot.com/-sSki5SfxbcM/WogM11jO9SI/AAAAAAAACVI/4XkQT-2rTQwx5hRKhLYrVdsIbse_yKt2gCLcBGAs/s320/Screenshot%2Bfrom%2B2018-02-15%2B09-41-38.png" width="281" /></a><a href="https://1.bp.blogspot.com/-vVwBXXPnMnI/WogMek8E6mI/AAAAAAAACVE/gOhMD3CCv5U6ECH5mTDxgsIKKughmYADACLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-15%2B09-41-11.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="776" data-original-width="638" height="320" src="https://1.bp.blogspot.com/-vVwBXXPnMnI/WogMek8E6mI/AAAAAAAACVE/gOhMD3CCv5U6ECH5mTDxgsIKKughmYADACLcBGAs/s320/Screenshot%2Bfrom%2B2018-02-15%2B09-41-11.png" width="262" /></a></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Il ya toutefois un gros bémol à cette technique. L'attaquant en capacité d'utiliser DCShadow dispose de privilèges élevés sur l'Active Directory. Rien ne l'empêche de modifier temporairement la politique d'audit sur le contrôleur de domaine qui sera ciblé par DCShadow pour la réactiver par la suite.&nbsp;&nbsp;</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Ca nous laisse donc la détection par le réseau qui est beaucoup moins trivial à mettre en place ou les cookies de réplication.</div>
<br />
<br />
Il est intéressant d'ailleurs de comparer ce que remonte la journalisation AD avec ce que remonte le cookie de réplication.<br />
<br />
J'effectue une modification avec DCShadow.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-VsPpgU7Gqr0/WogeEf2Xr9I/AAAAAAAACVc/nsCWRj26YDgKADoBJbJIkm-tRrP3uvy-QCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B13-18-18.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="841" data-original-width="679" height="400" src="https://2.bp.blogspot.com/-VsPpgU7Gqr0/WogeEf2Xr9I/AAAAAAAACVc/nsCWRj26YDgKADoBJbJIkm-tRrP3uvy-QCLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B13-18-18.png" width="322" /></a></div>
<br />
<br />
<br />
Voici ce que j'ai dans le log:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://3.bp.blogspot.com/-bH3nYRHDrhw/WoggIpYTaXI/AAAAAAAACV4/OU_DciASLPQOkHf3pNC4YcHdlhro_tbNgCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B13-21-12.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" data-original-height="828" data-original-width="638" height="320" src="https://3.bp.blogspot.com/-bH3nYRHDrhw/WoggIpYTaXI/AAAAAAAACV4/OU_DciASLPQOkHf3pNC4YcHdlhro_tbNgCLcBGAs/s320/Screenshot%2Bfrom%2B2018-02-17%2B13-21-12.png" width="246" /></a><a href="https://2.bp.blogspot.com/-NoQCIlJhCcc/WogeZm6rL3I/AAAAAAAACVg/ZO1xabubxPId_Mf0EbKDbqvqeFlk8r6RgCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B13-21-43.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="776" data-original-width="640" height="320" src="https://2.bp.blogspot.com/-NoQCIlJhCcc/WogeZm6rL3I/AAAAAAAACVg/ZO1xabubxPId_Mf0EbKDbqvqeFlk8r6RgCLcBGAs/s320/Screenshot%2Bfrom%2B2018-02-17%2B13-21-43.png" width="262" /></a></div>
<br />
<br />
On peut voir l'ajout puis la suppression du SPN de catalogue global (GC/).<br />
<br />
<br />
Voici ce qu'on a avec le cookie de réplication:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://4.bp.blogspot.com/-wYnb3ZXjx_w/Wogewy-WA3I/AAAAAAAACVo/Be5-M82Lw9AQ4IzhLrMwCu9p5NML6DsfQCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B13-17-55.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="302" data-original-width="999" height="120" src="https://4.bp.blogspot.com/-wYnb3ZXjx_w/Wogewy-WA3I/AAAAAAAACVo/Be5-M82Lw9AQ4IzhLrMwCu9p5NML6DsfQCLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B13-17-55.png" width="400" /></a></div>
<div class="separator" style="clear: both; text-align: center;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Avec le cookie de réplication, on a la valeur finale du SPN, avec le GUID du service DRS mais pas le GC qui a été supprimé.</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
Ce qui est intéressant c'est que la journalisation ne log pas l'ajout du SPN du service DRS (GUID E35...).&nbsp;</div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
<br /></div>
<div class="separator" style="clear: both; text-align: left;">
On peut donc déjà détecter l'utilisation de DCShadow sans utiliser la journalisation ni la capture réseau.</div>
<br />
Comme je l'ai déjà dit, l'intérêt de DCShadow est de ne pas laisser de trace sur les modifications en elles-même.<br />
<br />
C'est bien de détecter que DCShadow a été utilisé mais ne pas savoir ce qui a été modifié rend la remédiation imposible.<br />
<br />
On va voir qu'il y a plusieurs cas en fonction de comment on utilise DCShadow.<br />
<br />
Mais avant de voir tout ça nous allons faire un très court rappel sur ce qui déclenche une réplication entre les contrôleurs de domaine car ça a énormément d'importance pour la suite.<br />
<br />
<br />
<h2>
Réplication AD et USN</h2>
La réplication AD se base sur le numéro USN (Update Sequence Number).<br />
<br />
Pour faire très simple, le DC qui demande les réplications à son partenaire demande les modifications effectuées depuis le dernier USN qu'il connait.<br />
<br />
Autrement dit, ton dernier USN que je connais est X, envoie-moi les attributs qui ont un numéro USN supérieur.<br />
<br />
<br />
Pour plus d'informations, vous pouvez vous réferrez à cet article du technet : <a href="https://technet.microsoft.com/en-us/library/cc961798.aspx">Tracking updates</a><br />
<br />
Comme je l'ai dit l'USN a beaucoup d'importance pour la suite.<br />
<br />
<h2>
Détection des modifications opérées via DCShadow</h2>
Je n'ai pas pu tester tous les cas possibles en quelques heures mais voici déjà un bon aperçu.<br />
<br />
<h3>
Modification d'un attribut existant sur le DC où a eu lieu la dernière modification de l'attribut avec les switchs de DCShadow par défaut</h3>
Le premier cas que l'on va voir est l'utilisation de DCShadow telle qu'elle a été faite au début de l'article.<br />
<br />
Si l'on regarde les métadonnées de l'objet nous avons ceci :<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://4.bp.blogspot.com/-3J-dlmLa7II/Wogmnx1PBII/AAAAAAAACWI/yd7Zhki2HIwKq8j_vLZVUs37KvoWqNupwCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B13-56-03.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="541" data-original-width="993" height="217" src="https://4.bp.blogspot.com/-3J-dlmLa7II/Wogmnx1PBII/AAAAAAAACWI/yd7Zhki2HIwKq8j_vLZVUs37KvoWqNupwCLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B13-56-03.png" width="400" /></a></div>
<br />
<br />
On peut voir que la valeur du numéro USN de l'attribut Description est 42, nombre assez remarquable.<br />
<br />
En regardant le code source, on trouve rapidement que c'est une valeur hardcodée et qu'il ya une branche conditionnelle (switch qu'on verra plus tard).<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://4.bp.blogspot.com/-83SI4o0VvkI/WognbYJMRGI/AAAAAAAACWQ/PKXBydPboskyDp5K665pRq2XG11OG_tzQCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B14-00-08.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="86" data-original-width="970" height="35" src="https://4.bp.blogspot.com/-83SI4o0VvkI/WognbYJMRGI/AAAAAAAACWQ/PKXBydPboskyDp5K665pRq2XG11OG_tzQCLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B14-00-08.png" width="400" /></a></div>
<br />
<br />
Ce qui m'a étonné quand j'ai joué la première fois avec DCShadow, c'était que cette modification n'était pas détectée par le cookie de réplication.<br />
<br />
Mon premier réflexe a été de me dire qu'il sera catché par le cookie sur mon second DC lors de la réplication, mais je n'avais rien non plus et surtout l'attribut n'était pas modifié sur le second DC.<br />
<br />
Je vérifie les réplications et il n'y a pas de problème.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://3.bp.blogspot.com/-tzilOrt7Hac/Wogo-lwrzbI/AAAAAAAACWc/dhKwD7zS0tY-YA5i6aVtKxupmiN3wwklQCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B14-05-48.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="342" data-original-width="996" height="136" src="https://3.bp.blogspot.com/-tzilOrt7Hac/Wogo-lwrzbI/AAAAAAAACWc/dhKwD7zS0tY-YA5i6aVtKxupmiN3wwklQCLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B14-05-48.png" width="400" /></a></div>
<br />
<br />
Je compare ensuite les métadonnées de réplication.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-dlxhZUoWrEA/WogpMOOfuSI/AAAAAAAACWg/DQoLO83d040u-EOLhfNSQBzfsRI7JCm3ACLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-17%2B14-06-03.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1025" data-original-width="996" height="400" src="https://2.bp.blogspot.com/-dlxhZUoWrEA/WogpMOOfuSI/AAAAAAAACWg/DQoLO83d040u-EOLhfNSQBzfsRI7JCm3ACLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B14-06-03.png" width="387" /></a></div>
<br />
<br />
Et là on peut voir une différence entre les 2.<br />
Ma modification effectuée avec DCShadow n'a donc pas été repliquée sur les autres contrôleurs de domaine.<br />
<br />
La raison est simple, la valeur d'USN étant 42, la modification n'est pas répliquée.<br />
<br />
<br />
On voit tout de suite un intérêt du point de vue DFIR.<br />
<br />
Premièrement, 42 est un marquant fort dans les métadonnées de réplication (mais peut-être modifié dans le code par l'attaquant).<br />
Deuxièmement, les modifications n'ayant pas été repliquées, la remédiation des modifications est très simple, il suffit de reconstruire le DC (après avoir réglé le problème de privilège bien évidemment).<br />
<br />
Dans ce cas, on ne se sert pas du cookie de réplication puisqu'il n'y a pas réplication mais on peut retrouver les modifications via les métadonnées (ou comparer les données entre le DC sur lequel DCShadow a été utilisé et un autre DC).<br />
<br />
L'intérêt pour l'attaquant est bien évidemment de ne pas utiliser DCShadow dans ce sens. Puisque si on détecte l'utilisation de DCShadow sur ce contrôleur de domaine on retrouvera rapidement les modifications qu'il a effectuées.<br />
<br />
On va donc utiliser l'autre branche conditionnelle du code qui est un switch permettant de spécifier le numéro USN.<br />
<br />
<br />
<h3>
Modification d'un attribut existant sur le DC où a eu lieu la dernière modification de l'attribut&nbsp;en utilisant le switch replOriginatingUsn de DCShadow</h3>
Cette fois, nous allons spécifier la valeur du numéro USN.<br />
<br />
On recommence cette fois en utilisant le switch /replOriginatingUsn avec un numéro USN permettant la réplication.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://2.bp.blogspot.com/-M15eBHJUpog/WogtZrw7jDI/AAAAAAAACWw/rViBkr8WvrwDS7QaiBKSNPc7642RFz7pQCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-16%2B09-16-19.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="933" data-original-width="675" height="400" src="https://2.bp.blogspot.com/-M15eBHJUpog/WogtZrw7jDI/AAAAAAAACWw/rViBkr8WvrwDS7QaiBKSNPc7642RFz7pQCLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-16%2B09-16-19.png" width="288" /></a></div>
<br />
<br />
<br />
On vérifie les réplications.<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-yDjQLGOE1u8/Wogtq-oyIzI/AAAAAAAACW0/RJ-4moQd6RAen6ICFpR3kziTVOjIuWLAwCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-16%2B09-19-57.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1038" data-original-width="995" height="400" src="https://1.bp.blogspot.com/-yDjQLGOE1u8/Wogtq-oyIzI/AAAAAAAACW0/RJ-4moQd6RAen6ICFpR3kziTVOjIuWLAwCLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-16%2B09-19-57.png" width="382" /></a></div>
<h3>
</h3>
Et là, on voit que la modification de l'attribut Description a bien été répliquée.<br />
<br />
D'un point de vue DFIR c'est la merde, les modifications ont été répliquées et je n'ai plus le marquant du numéro USN.<br />
Bonne chance pour remédier ...<br />
<br />
<br />
Mais cette fois, si on regarde le cookie de réplication:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://1.bp.blogspot.com/-avddSObo5eI/WoguBjxp1BI/AAAAAAAACW8/LRJ3VPsl6oMKGuquNOnuUJiVu7RsjRdaQCLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-16%2B09-18-14.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="532" data-original-width="1131" height="187" src="https://1.bp.blogspot.com/-avddSObo5eI/WoguBjxp1BI/AAAAAAAACW8/LRJ3VPsl6oMKGuquNOnuUJiVu7RsjRdaQCLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-16%2B09-18-14.png" width="400" /></a></div>
<br />
<br />
On voit bien la modification avec la valeur de l'attribut modifié.<br />
Il est assez facile de retrouver les modifications opérées avec DCShadow puisqu'elles vont suivre la modification du SPN.<br />
<br />
<br />
<h2>
Autre marquant</h2>
<div>
Je me suis demandé si l'utilisation de DCShadow pouvait provoquer un USN Rollback.</div>
<div>
En réflechissant, ça ne peut pas être le cas mais en regardant la valeur de Up-to-dateness Vector j'ai eu la surprise de voir ceci.</div>
<h2>
<div style="font-size: medium; font-weight: 400;">
<br /></div>
<div class="separator" style="clear: both; font-size: medium; font-weight: 400; text-align: center;">
<a href="https://3.bp.blogspot.com/-OPU0DmtIpTo/WolmJsUqDbI/AAAAAAAACjo/eq5tBHV4i7oKB6U0YJqjFxL7ZfEfcf7mACLcBGAs/s1600/Screenshot%2Bfrom%2B2018-02-18%2B11-42-40.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="460" data-original-width="994" height="185" src="https://3.bp.blogspot.com/-OPU0DmtIpTo/WolmJsUqDbI/AAAAAAAACjo/eq5tBHV4i7oKB6U0YJqjFxL7ZfEfcf7mACLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-18%2B11-42-40.png" width="400" /></a></div>
<div class="separator" style="clear: both; font-size: medium; font-weight: 400; text-align: center;">
<br /></div>
<div class="separator" style="clear: both; font-size: medium; font-weight: 400; text-align: left;">
A creuser mais ça pourrait être un marquant de l'utilisation de DCShadow si on n'a pas déployé de moyen de détection.&nbsp;</div>
<div style="font-size: medium; font-weight: 400;">
<br /></div>
<div style="font-size: medium; font-weight: 400;">
<br /></div>
</h2>
<h2>
Conclusion</h2>
On peut donc désormais répondre à la question de cet article, est-ce vraiment impossible de détecter DCShadow ?<br />
<br />
Il faut bien séparer utilisation de DCShadow et modifications opérées par DCShadow.<br />
<br />
Dans les 2 cas on a pu voir qu'il était possible de les détecter (Bien que je n'ai pas pu tester tous les cas possibles).<br />
Cette détection s'avère tout de même très difficile.<br />
<br />
Clairement si vous n'êtes pas en capacité d'empêcher l'attaquant de récupérer les privilèges nécessaires à l'utilisation de DCShadow, il est peu probable que vous soyez en capacité de déployer une détection basée sur les cookies de réplication.<br />
<br />
<br />
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Publié par
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/01395492479022691854' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/01395492479022691854' rel='author' title='author profile'>
<span itemprop='name'>Grégory LUCAND</span>
</a>
</span>
</span>
<span class='post-timestamp'>
à
<meta content='http://adds-security.blogspot.com/2018/02/detecter-dcshadow-impossible.html' itemprop='url'/>
<a class='timestamp-link' href='https://adds-security.blogspot.com/2018/02/detecter-dcshadow-impossible.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2018-02-18T12:54:00+01:00'>12:54:00 PM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-1863866446'>
<a href='https://www.blogger.com/post-edit.g?blogID=4451739250645785187&postID=5206035592070825767&from=pencil' title='Modifier l&#39;article'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=4451739250645785187&postID=5206035592070825767&target=email' target='_blank' title='Envoyer par e-mail'><span class='share-button-link-text'>Envoyer par e-mail</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=4451739250645785187&postID=5206035592070825767&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=4451739250645785187&postID=5206035592070825767&target=twitter' target='_blank' title='Partager sur Twitter'><span class='share-button-link-text'>Partager sur Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=4451739250645785187&postID=5206035592070825767&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Partager sur Facebook'><span class='share-button-link-text'>Partager sur Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=4451739250645785187&postID=5206035592070825767&target=pinterest' target='_blank' title='Partager sur Pinterest'><span class='share-button-link-text'>Partager sur Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Libellés :
<a href='https://adds-security.blogspot.com/search/label/Active%20Directory' rel='tag'>Active Directory</a>,
<a href='https://adds-security.blogspot.com/search/label/dcshadow' rel='tag'>dcshadow</a>,
<a href='https://adds-security.blogspot.com/search/label/Forensic' rel='tag'>Forensic</a>,
<a href='https://adds-security.blogspot.com/search/label/Metadata' rel='tag'>Metadata</a>,
<a href='https://adds-security.blogspot.com/search/label/mimikatz' rel='tag'>mimikatz</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>Aucun commentaire:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Publier un commentaire</h4>
<p>
</p>
<a href='https://www.blogger.com/comment-iframe.g?blogID=4451739250645785187&postID=5206035592070825767' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/1706263374-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://adds-security.blogspot.com/2018/08/mise-en-place-dune-backdoor-laps-via.html' id='Blog1_blog-pager-newer-link' title='Article plus récent'>Article plus récent</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://adds-security.blogspot.com/2017/08/dissimulation-dune-configuration-de-gpo.html' id='Blog1_blog-pager-older-link' title='Article plus ancien'>Article plus ancien</a>
</span>
<a class='home-link' href='https://adds-security.blogspot.com/'>Accueil</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Inscription à :
<a class='feed-link' href='https://adds-security.blogspot.com/feeds/5206035592070825767/comments/default' target='_blank' type='application/atom+xml'>Publier les commentaires (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget Profile' data-version='1' id='Profile1'>
<h2>Qui suis-je ?</h2>
<div class='widget-content'>
<dl class='profile-datablock'>
<dt class='profile-data'>
<a class='profile-name-link g-profile' href='https://www.blogger.com/profile/01395492479022691854' rel='author' style='background-image: url(//www.blogger.com/img/logo-16.png);'>
Grégory LUCAND
</a>
</dt>
<dd class='profile-textblock'>Active Directory Security Consultant</dd>
</dl>
<a class='profile-link' href='https://www.blogger.com/profile/01395492479022691854' rel='author'>Afficher mon profil complet</a>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("Profile1"));' rel='nofollow' target='configProfile1' title='Modifier'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Archive du blog</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://adds-security.blogspot.com/2018/'>
2018
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='post-count-link' href='https://adds-security.blogspot.com/2018/08/'>
août
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='post-count-link' href='https://adds-security.blogspot.com/2018/02/'>
février
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://adds-security.blogspot.com/2017/'>
2017
</a>
<span class='post-count' dir='ltr'>(7)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='post-count-link' href='https://adds-security.blogspot.com/2017/08/'>
août
</a>
<span class='post-count' dir='ltr'>(7)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://adds-security.blogspot.com/2014/'>
2014
</a>
<span class='post-count' dir='ltr'>(22)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='post-count-link' href='https://adds-security.blogspot.com/2014/08/'>
août
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='post-count-link' href='https://adds-security.blogspot.com/2014/07/'>
juillet
</a>
<span class='post-count' dir='ltr'>(8)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='post-count-link' href='https://adds-security.blogspot.com/2014/06/'>
juin
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='post-count-link' href='https://adds-security.blogspot.com/2014/04/'>
avril
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='post-count-link' href='https://adds-security.blogspot.com/2014/03/'>
mars
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='post-count-link' href='https://adds-security.blogspot.com/2014/02/'>
février
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' rel='nofollow' target='configBlogArchive1' title='Modifier'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget PageList' data-version='1' id='PageList2'>
<div class='widget-content'>
<ul>
<li>
<a href='https://adds-security.blogspot.com/'>Accueil</a>
</li>
<li>
<a href='https://adds-security.blogspot.com/p/vous-trouverez-ici-tous-les-articles.html'>Délégation AD</a>
</li>
<li>
<a href='https://adds-security.blogspot.com/p/forensic-ad.html'>Forensic AD</a>
</li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("PageList2"));' rel='nofollow' target='configPageList2' title='Modifier'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Pied de page'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Thème Awesome Inc.. Fourni par <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("Attribution1"));' rel='nofollow' target='configAttribution1' title='Modifier'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script src='https://apis.google.com/js/plusone.js' type='text/javascript'></script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3464975383-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY7MwvickbXE167C8d9AX5OdPSwNRA:1621666747192';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d4451739250645785187','//adds-security.blogspot.com/2018/02/detecter-dcshadow-impossible.html','4451739250645785187');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '4451739250645785187', 'title': 'Active Directory et la S\xe9curit\xe9', 'url': 'https://adds-security.blogspot.com/2018/02/detecter-dcshadow-impossible.html', 'canonicalUrl': 'http://adds-security.blogspot.com/2018/02/detecter-dcshadow-impossible.html', 'homepageUrl': 'https://adds-security.blogspot.com/', 'searchUrl': 'https://adds-security.blogspot.com/search', 'canonicalHomepageUrl': 'http://adds-security.blogspot.com/', 'blogspotFaviconUrl': 'https://adds-security.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'fr', 'localeUnderscoreDelimited': 'fr', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Active Directory et la S\xe9curit\xe9 - Atom\x22 href\x3d\x22https://adds-security.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Active Directory et la S\xe9curit\xe9 - RSS\x22 href\x3d\x22https://adds-security.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Active Directory et la S\xe9curit\xe9 - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/4451739250645785187/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Active Directory et la S\xe9curit\xe9 - Atom\x22 href\x3d\x22https://adds-security.blogspot.com/feeds/5206035592070825767/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/951198144-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/751ccdc09ff31f1f', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Obtenir le lien', 'key': 'link', 'shareMessage': 'Obtenir le lien', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Partager sur Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Partager sur Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Partager sur Pinterest', 'target': 'pinterest'}, {'name': 'Adresse e-mail', 'key': 'email', 'shareMessage': 'Adresse e-mail', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 300, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27fr\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Lire la suite', 'pageType': 'item', 'postId': '5206035592070825767', 'postImageThumbnailUrl': 'https://1.bp.blogspot.com/-svGKyONCwNY/WofffuBcUII/AAAAAAAACU0/zQu7YsSGV5wrZ5wGxOn3h8du-PJ0NzSVACLcBGAs/s72-c/Screenshot%2Bfrom%2B2018-02-17%2B08-34-49.png', 'postImageUrl': 'https://1.bp.blogspot.com/-svGKyONCwNY/WofffuBcUII/AAAAAAAACU0/zQu7YsSGV5wrZ5wGxOn3h8du-PJ0NzSVACLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B08-34-49.png', 'pageName': 'D\xe9tecter DCShadow, impossible ?', 'pageTitle': 'Active Directory et la S\xe9curit\xe9: D\xe9tecter DCShadow, impossible ?'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Modifier', 'linkCopiedToClipboard': 'Lien copi\xe9 dans le presse-papiers\xa0!', 'ok': 'OK', 'postLink': 'Publier le lien'}}, {'name': 'template', 'data': {'name': 'Awesome Inc.', 'localizedName': 'Awesome Inc.', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'light', 'variantId': 'light'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'D\xe9tecter DCShadow, impossible ?', 'description': 'Bonjour \xe0 tous,   Je vous propose aujourd\x27hui un article sur l\x27attaque pr\xe9sent\xe9e par Vincent Le Toux ( @mysmartlogon ) et Benjamin Delpy ( @...', 'featuredImage': 'https://1.bp.blogspot.com/-svGKyONCwNY/WofffuBcUII/AAAAAAAACU0/zQu7YsSGV5wrZ5wGxOn3h8du-PJ0NzSVACLcBGAs/s400/Screenshot%2Bfrom%2B2018-02-17%2B08-34-49.png', 'url': 'https://adds-security.blogspot.com/2018/02/detecter-dcshadow-impossible.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 5206035592070825767}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/1455235419-lbx__fr.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1050234869-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-1', document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Chargement\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList2', 'sidebar-right-1', document.getElementById('PageList2'), {'title': '', 'links': [{'isCurrentPage': false, 'href': 'https://adds-security.blogspot.com/', 'title': 'Accueil'}, {'isCurrentPage': false, 'href': 'https://adds-security.blogspot.com/p/vous-trouverez-ici-tous-les-articles.html', 'id': '279335643494880991', 'title': 'D\xe9l\xe9gation AD'}, {'isCurrentPage': false, 'href': 'https://adds-security.blogspot.com/p/forensic-ad.html', 'id': '4549426704424792148', 'title': 'Forensic AD'}], 'mobile': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>