<!DOCTYPE html>


















































<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Using DsAddSidHistory - Win32 apps" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/windows/win32/ad/using-dsaddsidhistory" />
			<meta property="og:description" content="This topic describes how to use the DsAddSidHistory function." />
		<meta property="og:image" content="https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png" />
		<meta property="og:image:alt" content="Microsoft Logo" />

	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@docsmsft" />

	<meta name="color-scheme" content="light dark">


	<meta name="author" content="mikben" />
<meta name="breadcrumb_path" content="/windows/desktop/breadcrumb/toc.json" />
<meta name="depot_name" content="MSDN.win32" />
<meta name="description" content="This topic describes how to use the DsAddSidHistory function." />
<meta name="document_id" content="43bf3f0b-e682-0d9e-353d-18dc70006604" />
<meta name="document_version_independent_id" content="6ce9ffbf-39ba-2fa3-8845-91c9ddada6a1" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/win32-pr/blob/0180b6dbcaa133e58745702bf0ebefa871ee151b/desktop-src/AD/using-dsaddsidhistory.md" />
<meta name="keywords" content="Using DsAddSidHistory Active Directory" />
<meta name="keywords" content="Active Directory Active Directory , using, Using DsAddSidHistory" />
<meta name="keywords" content="DsAddSidHistory Active Directory , using" />
<meta name="locale" content="en-us" />
<meta name="ms.assetid" content="cbf4983c-551d-4771-870e-a192ed898eb7" />
<meta name="ms.author" content="mikben" />
<meta name="ms.date" content="05/31/2018" />
<meta name="ms.prod" content="desktop" />
<meta name="ms.technology" content="security-identity" />
<meta name="ms.tgt_platform" content="multiple" />
<meta name="ms.topic" content="article" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/AD/using-dsaddsidhistory.md" />
<meta name="schema" content="Conceptual" />
<meta name="search.ms_docsetname" content="win32" />
<meta name="search.ms_product" content="MSDN" />
<meta name="search.ms_sitename" content="Docs" />
<meta name="site_name" content="Docs" />
<meta name="uhfHeaderId" content="MSDocsHeader-WinDevCenter" />
<meta name="updated_at" content="2019-08-23 08:04 PM" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="toc.json" />
<meta name="pdf_url_template" content="https://docs.microsoft.com/pdfstore/en-us/MSDN.win32/{branchName}{pdfName}" />
<meta name="word_count" content="2933" />


	<meta name="scope" content="Windows, Desktop" />
<link href="https://docs.microsoft.com/en-us/windows/win32/ad/using-dsaddsidhistory" rel="canonical">
	<title>Using DsAddSidHistory - Win32 apps | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/8147a557.site-ltr.css ">

	


	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://github.com/MicrosoftDocs/win32/blob/docs/desktop-src/AD/using-dsaddsidhistory.md',
			extendBreadcrumb: false,
			isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: false,
			contributors: [
						{ name: "mikben", url: "https://github.com/mikben" },
						{ name: "msatranjr", url: "https://github.com/msatranjr" }
],
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-3.min.js"></script>
	<script>window.onedsAwa = window.awa; delete window.awa;</script>	
	<script src="/static/third-party/jsll/4.3.4/jsll-4.js"></script>
	<script nomodule src="/static/third-party/bluebird/3.5.0/bluebird.min.js" integrity="sha384-aD4BDeDGeLXLpPK4yKeqtZQa9dv4a/7mQ+4L5vwshIYH1Mc2BrXvHd32iHzYCQy5" crossorigin="anonymous"></script>
	<script nomodule src="/static/third-party/fetch/3.0.0/fetch.umd.min.js" integrity="sha384-EQIXrC5K2+7X8nGgLkB995I0/6jfAvvyG1ieZ+WYGxgJHFMD/alsG9fSDWvzb5Y1" crossorigin="anonymous"></script>
	<script nomodule src="/static/third-party/template/1.4.0/template.min.js" integrity="sha384-1zKzI6ldTVHMU7n0W2HpE/lhHI+UG4D9IIaxbj3kT2UhCWicdTuJkTtnKuu0CQzN" crossorigin="anonymous"></script>
	<script nomodule src="/static/third-party/url/0.5.7/url.min.js" integrity="sha384-vn7xBMtpSTfzaTRWxj0kVq0UcsbBrTOgZ/M1ISHqe1V358elYva+lfiEC+T8jLPc" crossorigin="anonymous"></script>
	<script src="/_themes/docs.theme/master/en-us/_themes/scripts/8a64e446.index-polyfills.js"></script>

		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/2777d474.index-docs.js"></script>
</head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 has-padding-medium has-text-centered has-body-background-medium" tabindex="1">Skip to main content</a>
		
		<div id="ignite-banner-holder" class="has-default-focus has-overflow-hidden"></div>
		<div id="build-banner-holder" class="has-default-focus has-overflow-hidden"></div>
		
		<div hidden id="cookie-consent-holder"></div>
		<!-- liquid-tag banners global -->
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
	<div class="nav-bar">
		<div class="nav-bar-brand">
			<a itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft" class="nav-bar-button">
				<div class="nav-bar-logo has-background-image theme-display is-light" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
				<div class="nav-bar-logo has-background-image theme-display is-dark is-high-contrast" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
			</a>
		</div>
	</div>
	<div class="nav-bar border-top is-hidden-mobile"></div>
</header>		</div>

						<div class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
					<nav class="breadcrumb-holder has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop flex-grow-1" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
						<ul id="page-breadcrumbs" class="breadcrumbs">
						</ul>
					</nav>
				<div class="content-header-controls">
					<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
				<div class="has-padding-none-tablet has-padding-medium font-size-s display-flex justify-content-space-between flex-grow-1 page-action-holder">
					<ul class="is-hidden-mobile action-list justify-content-flex-start has-flex-justify-content-end-tablet display-flex flex-wrap-wrap flex-grow-1 is-unstyled">
						<li hidden>
							<a id="lang-link" class="button is-text has-inner-focus is-small is-icon-only-touch" title="Read in English" data-bi-name="language-toggle">
								<span id="lang-link-icon" class="icon docon docon-locale-globe" aria-hidden="true"></span>
								<span id="lang-link-text" class="is-visually-hidden-touch is-hidden-portrait"></span>
							</a>
						</li>
						<li>
							<button type="button" class="collection button is-text has-inner-focus is-small is-icon-only-touch" data-list-type="collection" data-bi-name="collection" title="Add to collection">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-circle-addition has-text-primary"></span>
								</span>
								<span class="collection-status is-visually-hidden-touch is-hidden-portrait">Save</span>
							</button>
						</li>
								<li id="contenteditbtn">
									<a href="https://github.com/MicrosoftDocs/win32/blob/docs/desktop-src/AD/using-dsaddsidhistory.md" class="button is-text has-inner-focus is-icon-only-touch is-small" title="Edit This Document" data-bi-name="edit" data-original_content_git_url="https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/AD/using-dsaddsidhistory.md" data-original_content_git_url_template="{repo}/blob/{branch}/desktop-src/AD/using-dsaddsidhistory.md" data-pr_repo="" data-pr_branch="">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-edit-outline"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
								</a>
							</li>
						<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small is-icon-only-touch" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-twitter" data-bi-name="twitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-linkedin" data-bi-name="linkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-facebook" data-bi-name="facebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-email" data-bi-name="email">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>						</li>
					</ul>
					<button type="button" class="border contents-button button is-small is-text is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
						<span class="icon">
							<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
						</span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<div class="is-invisible"></div>
					<div class="is-hidden-tablet level-item is-flexible level-right">
						<button type="button" class="page-actions-button button is-small is-text is-hidden-tablet has-inner-focus border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
							<span class="icon">
								<span class="docon docon-more-vertical" aria-hidden="true"></span>
							</span>
						</button>
					</div>
				</div>
			</div>



		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="position-fixed display-flex flex-direction-column" role="navigation" aria-label="Primary"></nav>
			</div>

			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<div class="columns is-gapless-mobile has-large-gaps ">


				<div id="main-column" class="column  is-full is-four-fifths-desktop ">

					<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



						<h1 id="using-dsaddsidhistory">Using DsAddSidHistory</h1>

						<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
							<li>
								<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2018-05-31T00:00:00.000Z" data-article-date-source="ms.date">05/31/2018</time>
							</li>
									<li class="readingTime">14 minutes to read</li>
								<li class="contributors-holder">
									<ul class="facepile has-margin-left-none is-small" data-bi-name="contributors">
														<li class="facepile-item">
															<a href="https://github.com/mikben" title="mikben" aria-label="mikbenGithub profile" data-src="https://github.com/mikben.png?size=32" data-contributor-name="mikben" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/mikben.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">m</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/msatranjr" title="msatranjr" aria-label="msatranjrGithub profile" data-src="https://github.com/msatranjr.png?size=32" data-contributor-name="msatranjr" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/msatranjr.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">m</span>
															</a>
														</li>
									</ul>
								</li>
						</ul>

						<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
							<h3>In this article</h3>
						</nav>

						<!-- <content> -->
							<p>The <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> function gets the primary account security identifier (SID) of a security principal from one domain (the source domain) and adds it to the <strong>sIDHistory</strong> attribute of a security principal in another (destination) domain in a different forest. When the source domain is in Windows 2000 native mode, this function also retrieves the <strong>sIDHistory</strong> values of the source principal and adds them to the destination principal's <strong>sIDHistory</strong>.</p>
<p>Adding SIDs to a security principal's <strong>sIDHistory</strong> is a security-sensitive operation that effectively grants to the destination principal access to all resources accessible to the source principal, provided that trusts exist from applicable resource domains to the destination domain.</p>
<p>In a native mode Windows 2000 domain a user logon creates an access token that contains the user primary account SID and group SIDs, as well as the user <strong>sIDHistory</strong> and the <strong>sIDHistory</strong> of the groups of which the user is a member. Having these former SIDs (<strong>sIDHistory</strong> values) in the user's token grants the user access to resources protected by access-control lists (ACLs) containing the former SIDs.</p>
<p>This operation facilitates certain Windows 2000 deployment scenarios. In particular, it supports a scenario in which accounts in a new Windows 2000 forest are created for users and groups that already exist in an Windows NT 4.0 production environment. By placing the Windows NT 4.0 account SID in the Windows 2000 account <strong>sIDHistory</strong>, access to network resources is preserved for the user logging onto his new Windows 2000 account.</p>
<p><a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> also supports migration of Windows NT 4.0 backup domain controllers (BDCs) resource servers (or DCs and member servers in a native mode Windows 2000 domain) to a Windows 2000 domain as member servers. This migration requires the creation, in the destination Windows 2000 domain, of domain local groups that contain, in their <strong>sIDHistory</strong>, the primary SIDs of the local groups defined on the BDC (or domain local groups referenced in ACLs on the Windows 2000 servers) in the source domain. By creating a destination local group containing the <strong>sIDHistory</strong> and all members of the source local group, access to the migrated server resources, protected by ACLs referencing the source local group, is maintained for all members.</p>
<div class="NOTE">
<p>Note</p>
<p>Use of <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> requires an understanding of its broader administrative and security implications in these and other scenarios. For more information, see the white paper &quot;Planning Migration from Windows NT to Microsoft Windows 2000&quot;, delivered as Dommig.doc in the Windows 2000 Support Tools. This documentation may also be found on the product CD under \support\tools.</p>
</div>
<h2 id="authorization-requirements">Authorization Requirements</h2>
<p><a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> requires administrator privileges in the source and destination domains. Specifically, the caller of this API must be a member of the Domain Administrators group in the destination domain. A hard-coded check for this membership is performed. Also, the caller or the account provided in the <em>SrcDomainCreds</em> parameter, if not <strong>NULL</strong>, must be a member of either the Administrators or Domain Administrators group in the source domain.</p>
<h2 id="domain-and-trust-requirements">Domain and Trust Requirements</h2>
<p><a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> requires that the destination domain be in Windows 2000 native mode or later, because only this domain type supports the <strong>sIDHistory</strong> attribute. The source domain may be either Windows NT 4.0 or Windows 2000, mixed or native mode. The source and destination domains must not be in the same forest. Windows NT 4.0 domains are by definition not in a forest. This inter-forest constraint ensures that duplicate SIDs, whether appearing as primary SIDs or <strong>sIDHistory</strong> values, are not created in the same forest.</p>
<p><a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> requires an external trust from the source domain to the destination domain in the cases listed in the following table.</p>
<table>
<thead>
<tr>
<th>Case</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>The source domain is Windows 2000.<br/></td>
<td>The source <strong>sIDHistory</strong> attribute, available only in Windows 2000 source domains, may be read only using LDAP, which requires this trust for integrity protection.<br/></td>
</tr>
<tr>
<td>The source domain is Windows NT 4.0 and <em>SrcDomainCreds</em> is <strong>NULL</strong>.<br/></td>
<td>The impersonation, required to support source domain operations using the caller's credentials, depends on this trust. Impersonation also requires that the destination domain controller has &quot;Trusted for Delegation&quot; enabled by default on domain controllers.<br/></td>
</tr>
</tbody>
</table>
<p>However, there is no trust required between the source and destination domains if the source domain is Windows NT 4.0 and <em>SrcDomainCreds</em> is not <strong>NULL</strong>.</p>
<h2 id="source-domain-controller-requirements">Source Domain Controller Requirements</h2>
<p><a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> requires that the domain controller, selected as the target for operations in the source domain, be the PDC in Windows NT 4.0 domains or the PDC Emulator in Windows 2000 domains. Source domain auditing is generated by way of write operations, therefore, the PDC is required in Windows NT 4.0 source domains, and the PDC-only restriction ensures that <strong>DsAddSidHistory</strong> audits are generated on a single computer. This reduces the need to review the audit logs of all DCs to monitor use of this operation.</p>
<div class="NOTE">
<p>Note</p>
<p>In Windows NT 4.0 source domains, the PDC (target of operations in the source domain) must be running Service Pack 4 (SP4) and later to ensure proper auditing support.</p>
</div>
<p>The following registry value must be created as a REG_DWORD value and set to 1 on the source domain controller for both Windows NT 4.0 and Windows 2000 source DCs.</p>
<pre><code>HKEY_LOCAL_MACHINE
   System
      CurrentControlSet
         Control
            Lsa
               TcpipClientSupport
</code></pre>
<p>Setting this value enables RPC calls over the TCP transport. This is required because, by default, SAMRPC interfaces are remotable only on named pipes. Using named pipes results in a credential management system suitable for interactively logged-on users making networked calls, but is not flexible for a system process that makes network calls with user-supplied credentials. RPC over TCP is more suitable for that purpose. Setting this value does not diminish system security. If this value is created or changed, the source domain controller must be restarted for this setting to take effect.</p>
<p>A new local group, &quot;$$$&quot;, must be created in the source domain for auditing purposes.</p>
<h2 id="auditing">Auditing</h2>
<p><a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> operations are audited to ensure that both source and destination domain administrators are able to detect when this function has been run. Auditing is mandatory in both the source and destination domains. <strong>DsAddSidHistory</strong> verifies that the Audit Mode is on in each domain and that Account Management auditing of Success/Failure events is on. In the destination domain, a unique &quot;Add Sid History&quot; audit event is generated for each successful or failed <strong>DsAddSidHistory</strong> operation.</p>
<p>Unique &quot;Add Sid History&quot; audit events are not available on Windows NT 4.0 systems. To generate audit events that unambiguously reflect use of <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> against the source domain, it performs operations on a special group whose name is the unique identifier in the audit log. A local group, &quot;$$$&quot;, whose name is composed of the source domain NetBIOS name appended with three dollar signs ($) (ASCII code = 0x24 and Unicode = U+0024), must be created on the source domain controller prior to calling <strong>DsAddSidHistory</strong>. Each source user and global group that is a target of this operation is added to and then removed from the membership of this group. This generates Add Member and Delete Member audit events in the source domain, which can be monitored by searching for events that reference the group name.</p>
<div class="NOTE">
<p>Note</p>
<p><a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> operations on local groups in a Windows NT 4.0, or Windows 2000 mixed-mode source domain cannot be audited because local groups cannot be made members of another local group and therefore cannot be added to the special &quot;$$$&quot; local group. This lack of auditing does not present a security issue to the source domain, because source domain resource access is not affected by this operation. Adding the SID of a source local group to a destination local group does not grant access to source resources, protected by that local group, to any additional users. Adding members to the destination local group does not grant them access to source resources. Added members are granted access only to servers in the destination domain migrated from the source domain, which may have resources protected by the source local group SID.</p>
</div>
<h2 id="data-transmission-security">Data Transmission Security</h2>
<p><a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> enforces the following security measures:</p>
<ul>
<li>Called from a Windows 2000 workstation, the caller's credentials are used to authenticate and privacy-protect the RPC call to the destination domain controller. If <em>SrcDomainCreds</em> is not <strong>NULL</strong>, both the workstation and the destination DC must support 128-bit encryption to privacy-protect the credentials. If 128-bit encryption is not available and <em>SrcDomainCreds</em> are provided, then the call must be made on the destination DC.</li>
<li>The destination domain controller communicates with the source domain controller using either <em>SrcDomainCreds</em> or the caller's credentials to mutually authenticate and integrity-protect the read of the source account SID (using a SAM lookup) and <strong>sIDHistory</strong> (using an LDAP read).</li>
</ul>
<h2 id="threat-models">Threat Models</h2>
<p>The following table lists the potential threats associated with the <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> call and addresses the security measures pertinent to the particular threat.</p>
<table>
<colgroup>
<col/>
<col/>
</colgroup>
<thead>
<tr class="header">
<th>Potential threat</th>
<th>Security measure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Man in the Middle Attack<br/> An unauthorized user intercepts the <em>lookup SID of source object</em> return call, replacing the source object SID with an arbitrary SID for insertion into a target object SIDhistory.<br/></td>
<td>The <em>lookup SID of source object</em> is an authenticated RPC, using the caller's administrator credentials, with packet integrity message protection. This ensures that the return call cannot be modified without detection. The destination domain controller creates a unique &quot;Add SID History&quot; audit event that reflects the SID added to the destination account <strong>sIDHistory</strong>.<br/></td>
</tr>
<tr class="even">
<td>Trojan Source Domain<br/> An unauthorized user creates a &quot;Trojan Horse&quot; source domain on a private network that has the same domain SID and some of the same account SIDs as the legitimate source domain. The unauthorized user then attempts to run <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> in a destination domain to obtain the SID of a source account. This is done without the need for the real source Domain Administrator credentials and without leaving an audit trail in the real source domain. The unauthorized user's method for creating the Trojan Horse source domain could be one of the following:
<ul>
<li>Obtain a copy (BDC backup) of the source domain SAM.</li>
<li>Create a new domain, altering the domain SID on disk to match the legitimate source domain SID, then create enough users to instantiate an account with the desired SID.</li>
<li>Create a BDC replica. This requires source domain Administrator credentials. Then the unauthorized user takes the replica to a private network to implement the attack.</li>
</ul>
<br/></td>
<td>Although there are many ways for an unauthorized user to retrieve or create a desired source object SID, the unauthorized user cannot use it to update an account's <strong>sIDHistory</strong> without being a member of the destination Domain Administrators group. Because the check, on the destination domain controller, for Domain Administrator membership is hard-coded, on the target DC, there is no method for doing a disk modification to change the access control data protecting this function. An attempt to clone a Trojan Horse source account is audited in the destination domain. This attack is mitigated by reserving membership in the Domain Administrators group for only highly trusted individuals.<br/></td>
</tr>
<tr class="odd">
<td>On-disk Modification of SID History<br/> A sophisticated unauthorized user, with Domain Administrator credentials and with physical access to a DC in the destination domain, could modify an account <strong>sIDHistory</strong> value on disk.<br/></td>
<td>This attempt is not enabled by use of <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a>. This attack is mitigated by preventing physical access to domain controllers to all except highly trusted administrators.<br/></td>
</tr>
<tr class="even">
<td>Rogue Code Used to Remove Protections<br/> An unauthorized user or rogue administrator with physical access to the Directory Service code could create rogue code that:
<ol>
<li>Removes the check for membership in the Domain Administrators group in the code.</li>
<li>Changes the calls on the source domain controller that points the SID to a LookupSidFromName that is not audited.</li>
<li>Removes audit log calls.</li>
</ol>
<br/></td>
<td>Someone with physical access to the DS code and knowledgeable enough to create rogue code has the capability of arbitrarily modifying the <strong>sIDHistory</strong> attribute of an account. The <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> API does not increase this security risk.<br/></td>
</tr>
<tr class="odd">
<td>Resources Vulnerable to Stolen SIDs<br/> If an unauthorized user has succeeded in using one of the methods described here to modify an account <strong>sIDHistory</strong>, and if the resource domains of interest trust the unauthorized user account domain, then the unauthorized user can get unauthorized access to the stolen SID's resources, potentially without leaving an audit trail in the account domain from which the SID was stolen.<br/></td>
<td>Resource domain administrators protect their resources by setting up only those trust relationships that make sense from a security perspective. Use of <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> is restricted, in the trusted target domain, to members of the Domain Administrators group who already have broad permissions within the scope of their responsibilities.<br/></td>
</tr>
<tr class="even">
<td>Rogue Target Domain<br/> An unauthorized user creates a Windows 2000 domain with an account whose <strong>sIDHistory</strong> contains a SID that has been stolen from a source domain. The unauthorized user uses this account for unauthorized access to resources.<br/></td>
<td>The unauthorized user requires Administrator credentials for the source domain in order to use <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a>, and leaves an audit trail on the source domain controller. The rogue target domain gains unauthorized access only in other domains that trust the rogue domain, which requires Administrator privileges in those resource domains.<br/></td>
</tr>
</tbody>
</table>
<h2 id="operational-constraints">Operational Constraints</h2>
<p>This section describes the operational constraints of using the <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> function.</p>
<p>The SID of <em>SrcPrincipal</em> must not already exist in the destination forest, either as a primary account SID or in the <strong>sIDHistory</strong> of an account. The exception is that <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> does not generate an error when attempting to add a SID to a <strong>sIDHistory</strong> that contains an identical SID. This behavior enables <strong>DsAddSidHistory</strong> to be run multiple times with identical input, resulting in success and a consistent end state, for tool developer ease-of-use.</p>
<div class="NOTE">
<p>Note</p>
<p>Global Catalog replication latency may provide a window during which duplicate SIDs may be created. However, duplicate SIDs can be easily deleted by an administrator.</p>
</div>
<p><em>SrcPrincipal</em> and <em>DstPrincipal</em> must be one of the following types:</p>
<ul>
<li><p>User</p>
</li>
<li><p>Security Enabled Group, including:</p>
<dl> Local group  
Global group  
Domain local group (Windows 2000 native mode only)  
Universal group (Windows 2000 native mode only)  
</dl>
</li>
</ul>
<p>The object types of <em>SrcPrincipal</em> and <em>DstPrincipal</em> must match.</p>
<ul>
<li>If <em>SrcPrincipal</em> is a User, <em>DstPrincipal</em> must be a User.</li>
<li>If <em>SrcPrincipal</em> is a Local or Domain Local Group, <em>DstPrincipal</em> must be a Domain Local Group.</li>
<li>If <em>SrcPrincipal</em> is a Global or Universal Group, <em>DstPrincipal</em> must be a Global or Universal Group.</li>
</ul>
<p><em>SrcPrincipal</em> and <em>DstPrincipal</em> cannot be one of the following types: (<a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> fails with an error in these cases)</p>
<ul>
<li><p>Computer (workstation or domain controller)</p>
</li>
<li><p>Inter-domain trust</p>
</li>
<li><p>Temporary duplicate account (virtually unused feature, a legacy of LANman)</p>
</li>
<li><p>Accounts with Well Known SIDs. Well Known SIDs are identical in every domain; thus adding them to a <strong>sIDHistory</strong> would violate the SID uniqueness requirement of a Windows 2000 forest. Accounts with Well Known SIDs include the following local groups:</p>
<dl> Account operators  
Administrators  
Backup operators  
Guests  
Print operators  
Replicator  
Server operators  
Users  
</dl>
</li>
</ul>
<p>If <em>SrcPrincipal</em> has a well-known relative identifier (RID) and a domain specific prefix, that is, Domain Administrators, Domain Users, and Domain Computers, then <em>DstPrincipal</em> must possess the same well-known RID in order for <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> to succeed. Accounts with well-known RIDs include the following users and global groups:</p>
<ul>
<li>Administrator</li>
<li>Guest</li>
<li>Domain administrators</li>
<li>Domain guests</li>
<li>Domain users</li>
</ul>
<h2 id="setting-the-registry-value">Setting the Registry Value</h2>
<p>The following procedure shows how to set the TcpipClientSupport registry value.</p>
<p><strong>To Set the TcpipClientSupport Registry Value</strong></p>
<ol>
<li><p>Create the following registry value as a REG_DWORD value on the source domain controller and set its value to 1.</p>
<p><strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\TcpipClientSupport</strong></p>
</li>
<li><p>Then, restart the source domain controller. This registry value causes the SAM to listen on TCP/IP. <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> will fail if this value is not set on the source domain controller.</p>
</li>
</ol>
<h2 id="enabling-auditing-of-usergroup-management-events">Enabling Auditing of User/Group Management Events</h2>
<p>The following procedure shows how to enable auditing of User/Group management events in a Windows 2000 or Windows Server 2003 source or destination domain.</p>
<p><strong>To enable auditing of User/Group management events in a Windows 2000 or Windows Server 2003 source or destination domain</strong></p>
<ol>
<li>In the Active Directory Users and Computers MMC Snap-in, select the destination domain Domain Controllers container.</li>
<li>Right-click <strong>Domain Controllers</strong> and choose <strong>Properties</strong>.</li>
<li>Click the <strong>Group Policy</strong> tab.</li>
<li>Select the <strong>Default Domain Controllers Policy</strong> and click <strong>Edit</strong>.</li>
<li>Under <strong>Computer Configuration\Windows Settings\Security Settings\Local Policies\Audit Policy</strong>, double-click <strong>Audit Account Management</strong>.</li>
<li>In the <strong>Audit Account Management</strong> window, select both <strong>Success</strong> and <strong>Failure</strong> auditing. Policy updates take effect after a restart or after a refresh occurs.</li>
<li>Verify that auditing is enabled by viewing the effective audit policy in the Group Policy MMC Snap-in.</li>
</ol>
<p>The following procedure shows how to enable auditing of User/Group management events in a Windows NT 4.0 domain.</p>
<p><strong>To enable auditing of User/Group management events in a Windows NT 4.0 domain</strong></p>
<ol>
<li>In <strong>User Manager for Domains</strong>, click the <strong>Policies</strong> menu and select <strong>Audit</strong>.</li>
<li>Select <strong>Audit These Events</strong>.</li>
<li>For <strong>User and Group Management</strong>, check <strong>Success and Failure</strong>.</li>
</ol>
<p>The following procedure shows how to enable auditing of User/Group management events in a Windows NT 4.0, Windows 2000, or Windows Server 2003 source domain.</p>
<p><strong>To enable auditing of User/Group management events in a Windows NT 4.0, Windows 2000, or Windows Server 2003 source domain</strong></p>
<ol>
<li>In <strong>User Manager for Domains</strong>, click the <strong>User</strong> menu and select <strong>New Local Group</strong>.</li>
<li>Enter a group name composed of the source domain NetBIOS name appended with three dollar signs ($), for example, FABRIKAM$$$. The description field should indicate that this group is used to audit use of <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> or cloning operations. Ensure there are no members in the group. Click <strong>OK</strong>.</li>
</ol>
<p>The <a href="/en-us/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya" data-linktype="absolute-path"><strong>DsAddSidHistory</strong></a> operation fails if source and destination auditing are not enabled as described here.</p>
<h2 id="set-up-trust-if-required">Set up Trust if Required</h2>
<p>If one of the following is true, a trust must be established from the source domain to the destination domain (this must occur in a different forest):</p>
<ul>
<li>The source domain is Windows Server 2003.</li>
<li>The source domain is Windows NT 4.0 and <em>SrcDomainCreds</em> is <strong>NULL</strong>.</li>
</ul>

						<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop border-top has-margin-top-large has-padding-top-large binary-rating-holder">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-large has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small font-size-h4 has-margin-bottom-medium">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons is-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small border-none" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>									</div>
						<!-- end page rating section -->


						<!-- recommendations section -->
						<!-- end recommendations section -->

						<!-- feedback section -->
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="border-top is-visible-interactive has-default-focus has-margin-top-large ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link flex-shrink-0" href="#" data-bi-name="select-locale"><span class="icon docon docon-world font-size-l has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text"></span></a>
		<div class="has-margin-left-medium has-margin-right-medium flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
						</div>
					</div>
					
					<div class="font-size-s right-container column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only" data-bi-name="pageactions" role="complementary" aria-label="Page Actions">
						<div id="affixed-right-container" class="doc-outline position-fixed is-vertically-scrollable">
								
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">

				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons is-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small border-none" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>							<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
								<h3>In this article</h3>
							</nav>
						</div>
					</div>

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
		</div>

		<!--end of .mainContainer -->
	</div>

	<section class="border-top has-default-focus is-hidden-interactive has-margin-top-large ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link flex-shrink-0" href="#" data-bi-name="select-locale"><span class="icon docon docon-world font-size-l has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text"></span></a>
		<div class="has-margin-left-medium has-margin-right-medium flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>
