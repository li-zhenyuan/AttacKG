<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Nocturnus">
    <meta name="description" content="In this report, we explain one of the most recent and unique campaigns involving the Astaroth trojan. This Trojan and information stealer was recognized in Europe and chiefly affected Brazil through the abuse of native OS processes and the exploitation of security-related products.">
    <meta name="generator" content="HubSpot">
    <title>Astaroth Malware Uses Legitimate OS and Antivirus Processes to Steal Passwords and Personal Data</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/favicon-1.ico">
    

    <script src="/hs/hsstatic/jquery-libs/static-1.4/jquery/jquery-1.11.2.js"></script>
<script>hsjQuery = window['jQuery'];</script>
    <meta property="og:description" content="In this report, we explain one of the most recent and unique campaigns involving the Astaroth trojan. This Trojan and information stealer was recognized in Europe and chiefly affected Brazil through the abuse of native OS processes and the exploitation of security-related products.">
    <meta property="og:title" content="Astaroth Malware Uses Legitimate OS and Antivirus Processes to Steal Passwords and Personal Data">
    <meta name="twitter:description" content="In this report, we explain one of the most recent and unique campaigns involving the Astaroth trojan. This Trojan and information stealer was recognized in Europe and chiefly affected Brazil through the abuse of native OS processes and the exploitation of security-related products.">
    <meta name="twitter:title" content="Astaroth Malware Uses Legitimate OS and Antivirus Processes to Steal Passwords and Personal Data">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/41681847227/1619109182781/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/41682410610/1618194603032/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/43300360745/1617857458537/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/34473990280/1617772255567/module_34473990280_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleAnalytics integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
_hsp.push(['addPrivacyConsentListener', function(consent) { if (consent.allowed || (consent.categories && consent.categories.analytics)) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create','UA-56367941-1','auto');
  ga('send','pageview');
}}]);
</script>

<!-- /Added by GoogleAnalytics integration -->

<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || []; _hsp.push(['addPrivacyConsentListener', function(consent) { if (consent.allowed || (consent.categories && consent.categories.analytics)) {
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TJVVB7C');
}}]);
</script>

<!-- /Added by GoogleTagManager integration -->


<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<link rel="amphtml" href="https://www.cybereason.com/blog/information-stealing-malware-targeting-brazil-full-research?hs_amp=true">

<meta property="og:image" content="https://lh3.googleusercontent.com/KGncTYSX4fHVDj12-3LiS3KJ0HDenbf-FPnESKjYrBfJRHxaQD1vRGnvQa2XHrlddr4EMlvISyvyK8-TjculztoHZhBkxMI8XLrTDc8_qgIJML9KRwn0YitqAIU8_LUqZmTW2P7d#keepProtocol">

<meta name="twitter:image" content="https://lh3.googleusercontent.com/KGncTYSX4fHVDj12-3LiS3KJ0HDenbf-FPnESKjYrBfJRHxaQD1vRGnvQa2XHrlddr4EMlvISyvyK8-TjculztoHZhBkxMI8XLrTDc8_qgIJML9KRwn0YitqAIU8_LUqZmTW2P7d#keepProtocol">


<meta property="og:url" content="https://www.cybereason.com/blog/information-stealing-malware-targeting-brazil-full-research">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@cr_nocturnus">

<link rel="canonical" href="https://www.cybereason.com/blog/information-stealing-malware-targeting-brazil-full-research">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/7052064/hub_generated/template_assets/1621526769050/hubspot/hubspot_default/shared/responsive/layout.min.css">


<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/34470223313/1613710752320/__CR_Web_Platform_2020/CSS/cr-master__cta.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/34470477360/1621270587578/__CR_Web_Platform_2020/CSS/cr-master__main.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/35275979682/1600880367101/__CR_Web_Platform_2020/CSS/ionicons.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/42760289143/1621016677351/__CR_Web_Platform_2020/CSS/cr-mln__build.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/34470224480/1614969030468/__CR_Web_Platform_2020/CSS/bulma/cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/35291999472/1614661129976/__CR_Web_Platform_2020/CSS/bulma/cr-framework__bulma.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/42363645447/1614911253070/__CR_Web_Platform_2020/CSS/hamburger-animation.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/42507091846/1614920868925/__CR_Web_Platform_2020/CSS/animate.min.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'#FFC628',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    

</head>
<body class="   hs-content-id-7525628640 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-logo-web-horizontal-black-500px.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all">All Posts</a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news">News</a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-malicious-life-network-logo.svg"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">






<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">
    <div class="column is-2-fullhd is-2-desktop is-10-tablet is-hidden-mobile cr-mln__post-author-share">
      &nbsp;
    </div>
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://lh3.googleusercontent.com/KGncTYSX4fHVDj12-3LiS3KJ0HDenbf-FPnESKjYrBfJRHxaQD1vRGnvQa2XHrlddr4EMlvISyvyK8-TjculztoHZhBkxMI8XLrTDc8_qgIJML9KRwn0YitqAIU8_LUqZmTW2P7d" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Astaroth Malware Uses Legitimate OS and Antivirus Processes to Steal Passwords and Personal Data</span></h1>
      <p class="date-and-duration">
        <span class="publish-date">February 13, 2019 |</span>
        <span class="read-time">
          
          
          
          
          
          10 minute read
          
        </span>
      </p>
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-2-fullhd is-2-desktop is-10-tablet is-12-mobile is-offset-1-tablet is-offset-1-mobile cr-mln__post-author-share">
         <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
            
              <span class="descriptor">Written By</span>
              <p><span class="author">Cybereason Nocturnus</span></p>
             
          </div>
          <div class="cr-blog-post__social-sharing">
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/information-stealing-malware-targeting-brazil-full-research&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/information-stealing-malware-targeting-brazil-full-research&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/information-stealing-malware-targeting-brazil-full-research&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/information-stealing-malware-targeting-brazil-full-research&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
        </div>
        <div class="column is-8-fullhd is-8-desktop is-10-tablet is-10-mobile is-offset-0-fullhd is-offset-0-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><h4>Research By: Eli Salem</h4>
<p>In 2018, we saw a dramatic increase in <a href="https://www.cybereason.com/blog/brazilian-financial-malware-banking-europe-south-america">cyber crimes in Brazil</a> and, separately, the abuse of<a href="https://www.cybereason.com/blog/banking-trojan-delivered-by-lolbins-ramnit-trojan"> legitimate native Windows OS processes</a> for malicious intent. Cyber attackers used living off the land binaries (LOLbins) to hide their malicious activity and operate stealthily in target systems. Using native, legitimate operating system tools, attackers were able to infiltrate and gain remote access to devices without any malware. For organizations with limited visibility into their environment, this type of attack can be fatal.</p>
<p><!--more--><br>In this research, we explain one of the most recent and unique campaigns involving the <strong>Astaroth trojan.</strong> This Trojan and information stealer was recognized in Europe and&nbsp;chiefly&nbsp;affected Brazil through the abuse of native OS processes and the exploitation of security-related products.</p>
<p><a href="/blog/brazilian-financial-malware-banking-europe-south-america" rel="noopener" target="_blank"><em>Pervasive Brazilian Financial Malware Targets Bank Customers in Latin America and Europe</em></a></p>
<p>The <a href="/deep-detect-and-respond">Cybereason Platform</a> was able to detect this new variant of the Astaroth Trojan in a massive spam campaign that targeted Brazil and parts of Europe. Our <a href="https://www.cybereason.com/services/active-hunting">Active Hunting Service</a> team was able to analyze the campaign and identify that it maliciously took advantage of legitimate tools like <a href="https://docs.microsoft.com/en-us/windows/desktop/bits/bitsadmin-tool">the BITSAdmin utility</a> and <a href="https://docs.microsoft.com/en-us/windows/desktop/wmisdk/wmic">the WMIC utility</a> to interact with a C2 server and download a payload. It was also able to use a component of multinational antivirus software <a href="https://www.avast.com/en-us/index#mac">Avast</a> to gain information about the target system, as well as a process belonging to Brazilian information security company <a href="https://www.bnamericas.com/company-profile/en/gas-tecnologia-gas">GAS Tecnologia</a> to gather personal information. With a sophisticated attack such as this, it is critical for your security team to have a clear understanding of your environment so they can swiftly detect malicious activity and respond effectively.&nbsp;</p>
<h2 style="line-height: 1.75;">Unique Aspects to this Latest Version of the Astaroth Trojan Campaign</h2>
<p>The Astaroth Trojan campaign is a phishing-based campaign that gained momentum towards the end of 2018 and was identified in thousands of incidents. Early versions differed significantly from later versions as the adversaries advanced and optimized their attack. This version contrasted significantly from previous versions in four key ways.</p>
<ol>
<li><span style="font-size: 18px;">This version maliciously used BITSAdmin to download the attackers payload. This differed from early versions of the campaign that used <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil">certutil</a>.</span></li>
<li><span style="font-size: 18px;">This version&nbsp;injects a malicious module into one of&nbsp;Avast's processes, whereas early versions of the campaign detected Avast and quit. As Avast is <a href="https://www.statista.com/statistics/271048/market-share-held-by-antivirus-vendors-for-windows-systems/">the most common antivirus software in the world</a>, this is an effective evasive strategy.</span></li>
<li><span style="font-size: 18px;">This version of the campaign made malicious use of unins000.exe, a process that belongs to the Brazilian information security company GAS Tecnologia, to gather personal information undetected. This trusted process is prevalent on Brazilian machines. To the best of our knowledge, no other versions of the malware used this process.</span></li>
<li><span style="font-size: 18px;">This version used a <em>fromCharCode()</em> deobfuscation method to avoid explicitly writing execution commands and help hide the code it is initiating. Earlier versions did not use this method.</span><br><br></li>
</ol>
<h2>A Breakdown of the Latest Astaroth Trojan Spam Campaign</h2>
<p>&nbsp;</p>
<div><img src="https://lh3.googleusercontent.com/KGncTYSX4fHVDj12-3LiS3KJ0HDenbf-FPnESKjYrBfJRHxaQD1vRGnvQa2XHrlddr4EMlvISyvyK8-TjculztoHZhBkxMI8XLrTDc8_qgIJML9KRwn0YitqAIU8_LUqZmTW2P7d" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p>As with many traditional spam campaigns, this campaign begins with a .7zip file. This file gets downloaded to a user machine through a mail attachment or a mistakenly-pressed hyperlink.</p>
<p>The downloaded .7zip file contains a .lnk file that, once pressed, initializes the malware.</p>
<h4 style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/lnk-1.png?width=588&amp;name=lnk-1.png" alt="lnk-1" width="588" style="width: 588px; margin: 0px auto;" srcset="https://www.cybereason.com/hs-fs/hubfs/lnk-1.png?width=294&amp;name=lnk-1.png 294w, https://www.cybereason.com/hs-fs/hubfs/lnk-1.png?width=588&amp;name=lnk-1.png 588w, https://www.cybereason.com/hs-fs/hubfs/lnk-1.png?width=882&amp;name=lnk-1.png 882w, https://www.cybereason.com/hs-fs/hubfs/lnk-1.png?width=1176&amp;name=lnk-1.png 1176w, https://www.cybereason.com/hs-fs/hubfs/lnk-1.png?width=1470&amp;name=lnk-1.png 1470w, https://www.cybereason.com/hs-fs/hubfs/lnk-1.png?width=1764&amp;name=lnk-1.png 1764w" sizes="(max-width: 588px) 100vw, 588px">&nbsp;</h4>
<p style="text-align: center; font-size: 16px;"><em>The .lnk file extracted from the .7zip file.</em></p>
<p>An obfuscated command is located inside the <strong>Target</strong> bar in the .lnk file properties.&nbsp;</p>
<p>&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/DmIeN1CtS4FReJKMsaAMx71j_wB6CFcUxnK3mtzZuezLPc4Ge44LPDiV2YRHibmqQFBsnnkvKwu24RospKaUgE1TG8CCThy5zu5f59RlmQSD9ksfsDiAk073CLQ9PLk61ORqT8Qp" alt="" width="379" style="width: 379px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>Hidden command inside the .lnk file.</em></p>
<div><img src="https://lh6.googleusercontent.com/77PEdKREVD9Ev6OymB0KRIAvIFEgu9yTUbpYa1frNFanbLxsuP5WVf0IejeIBOmRGhRQgHlVUEKhcTNN7RqvdT3NLecv6IhmRJsP5RwaegvLSMU93BvmFyPAou1HihdR_hefTynN" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;">&nbsp;</div>
<p style="text-align: center; font-size: 16px;"><em>The full obfuscated command inside the .lnk file.</em></p>
<p>When the .lnk file is initialized, it spawns a CMD process. This process executes a command to maliciously use the legitimate wmic.exe to initialize an <a href="https://attack.mitre.org/techniques/T1220/">XSL Script Processing</a> (MITRE Technique T1220) attack. The attack executes embedded JScript or VBScript in an XSL stylesheet located on a remote domain (<em>qnccmvbrh.wilstonbrwsaq[.]pw</em>).</p>
<p>wmic.exe is a powerful, native Windows command line utility used to interact with <a href="https://docs.microsoft.com/en-us/windows/desktop/wmisdk/wmi-start-page">Windows Management Instrumentation</a> (WMI). This utility is able to execute complicated <a href="https://docs.microsoft.com/en-us/windows/desktop/wmisdk/querying-with-wql">WQL queries</a> and <a href="https://docs.microsoft.com/en-us/windows/desktop/wmisdk/calling-a-wmi-method">WMI methods</a>. It is often used by attackers for <a href="https://www.cybereason.com/defending-against-fileless-malware-webinar">lateral movement, reconnaissance, and basic code invocation</a>. By using a trusted, native utility, the attackers can hide the scope of the full attack and evade detection.</p>
<div><img src="https://lh4.googleusercontent.com/KTAVPyDAh9k7EFWAsTVhjiiVXpnKPIKyT-AeOxY_iEVobgufrH-3JRDB2cPL9tCfkCxewwSk_F_K0EurRUandSau5g0oyjWE1CFbZOhlf6AtQet1deMpLQAoKQ5YZzxMitJQ5aH_" alt="" style="width: 600px; margin: 0px auto; display: block;" width="600"></div>
<p style="text-align: center; font-size: 16px;"><em>The initial attack vector as detected by the Cybereason Platform.</em></p>
<p>wmic.exe creates a .txt file with information about the domain that stores the remote XSL script. It identifies the location of the infected machine, including country, city, and other information. Once this information is gathered, it sends location data about the infected machine to the remote XSL script.</p>
<p>This location data gives the attacker a unique edge, as they can specify a target country or city to attack and maximize their accuracy when choosing a particular target.&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/XpvqyV4dd8Tt8TP09M0hwYzKz9ThBD3iE5iw2gCUrpGU-XTIwWnjnsM67W6lY00KfRzIpwSua1BUrU0CTEiuymH-7cJHPUGNOcK9gRfwnIA54yRzxtorDGVS2wHtG4cBFVmRcElB" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center; font-size: 16px; line-height: 1;">&nbsp;</p>
<p style="text-align: center; font-size: 16px;"><em>The .txt file contains information about the C2 domain and infected machine, as detected in a Cybereason Lab environment.</em></p>
<h2 style="line-height: 1.75;">Phase one: An Analysis of the Remote XSL</h2>
<p>The remote XSL script that wmic.exe sends information to contains highly obfuscated JScript code that will execute additional steps of the malicious activity. The code is obfuscated in order to hide any malicious activity on the remote server.</p>
<p>Initially, the XSL script defines several variables for command execution and data storage. It also creates several <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms221401(v=vs.85).aspx">ActiveX objects</a>. The majority of ActiveX Objects created with <strong>Wscript.Shell</strong> and <strong>Shell.Application </strong>are used to run programs, create shortcuts, manipulate the contents of the registry, or access system folders. These variables are used to invoke legitimate Windows OS processes for malicious activities, and serve as a bridge between the remote domain that stores the script and the infected machine.&nbsp;&nbsp;</p>
<div><img src="https://lh3.googleusercontent.com/jFXQixe628zkDSTkcNeodkzHD8-nsZ7le1I_jxW24MSsdWB6xSImjXwuZ41CcZ1RQ61N41n4Zkm9C7sphKouCgMFQMnKCEMbbScmucuYUWDNNo4ptMmKXwLrVrmS_HUCfnMJqsDp" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;">&nbsp;</div>
<p style="text-align: center; font-size: 16px;"><em>Malicious script variables.</em></p>
<h3>Obfuscation Mechanism for the JScript Code</h3>
<p>The malicious JScript code obfuscation relies on two main techniques.</p>
<ol>
<li><span style="font-size: 18px;">The script uses the function <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCharCode">fromCharCode()</a> that returns a string created from a sequence of UTF-16 code units. By using this function, it avoids explicitly writing commands it wants to execute and it hides the actual code it is initiating. In particular, the script uses this function to hide information related to process names. To the best of our knowledge, this method was not used in early versions of the spam campaign.</span></li>
<li><span style="font-size: 18px;">The script uses the function <em>radador()</em>, which returns a randomized integer. This function is able to obfuscate code so that every iteration of the code is presented differently. In contrast to the first method of obfuscation, this has been used effectively since early versions of the Astaroth Trojan campaign.&nbsp;</span><br><br></li>
</ol>
<div><img src="https://lh5.googleusercontent.com/HMgqpyFfqZKMSyVjFWI29FKVMDm0Ca95ZDhQjlA8R5xIpur9v8vYnQqekNLf0rHj80lFZuw3ooKd26PVk5dbNBXTApg9pt8948ZBNEPIWN3IpkWf8VhpzVvqGv-M7vnBV8dtO51Z" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;">&nbsp;<em>String.fromCharCode() usage in the XSL script.</em>&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/bBHXvj1C0ZPCNARhCaiQ9Pt4GIs5y86eWfsGgoY7sV6xo-TwYoMwRnplkHIowwEn_vXenPZ81uLUYHRAeYRHTbwOhvb90C47v_JxQZX9-yS7Pl31Vi6X8qlXe1xpydGyxEw7nFd0" alt="" width="595" style="width: 595px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>The random number generator function radador().</em></p>
<p>&nbsp;These two obfuscation techniques are used to bypass antivirus defenses and make security researcher investigations more challenging.</p>
<h3>Choosing a C2 Server</h3>
<p>The XSL script contains variable <em>xparis() </em>that holds the C2 domain the malicious files will be downloaded from. In order to extend the lifespan of the domains in case one or more are blacklisted, there are twelve different C2 domains that <em>xparis() </em>can be set to. In order to decide which domain <em>xparis() </em>holds, a variable <em>pingadori() </em>uses the <em>radador() </em>function to randomize the domain. <em>pingadori() </em>is a random integer between one and twelve, which decides which domain <em>xparis() </em>is assigned.</p>
<div><img src="https://lh3.googleusercontent.com/QULH3I83EnrMMR8XjhdWRtc7ixx-Ue2aC1WnhCXaQtc3mMnYlAcWsn2cxRg39fwpFr7yNXpaT2hkosXbYhG5_SgKov7wBZfxAUi1LSxLTfPLuG7qbAb1h5G4jbDaMdRdHbrJN-ce" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>The C2 domain selection mechanism.</em></p>
<p>One of the most used functions in the XSL script is <em>Bxaki()</em>. <em>Bxaki() </em>takes a URL and a file as arguments. It downloads the file to the infected machine from the input URL using BITSAdmin, and is called every time the script attempts to download a file.</p>
<p>In previous iterations, the Astaroth Trojan campaign used cerutil to download files. In order to hide this process, it was renamed <strong>certis</strong>. In this iteration, they have replaced certutil with BITSAdmin.</p>
<div><img src="https://lh3.googleusercontent.com/zx1dCH9kgP6T13LxrBvXnpIbP7PQn53WcWdLF6rYL70bGwYYZJoMR9QVQKZCCckykh9viSNzILIMEXMMC0DckB6n452irP-KOGIHDxlNJvjPExpiUk9-2FZNkKM0Vi2-N2Yk2L3O" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;">&nbsp;<em>Bxaki obfuscated function.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/soulto.png?width=600&amp;name=soulto.png" alt="soulto" width="600" style="width: 600px; display: block; margin: 0px auto;" srcset="https://www.cybereason.com/hs-fs/hubfs/soulto.png?width=300&amp;name=soulto.png 300w, https://www.cybereason.com/hs-fs/hubfs/soulto.png?width=600&amp;name=soulto.png 600w, https://www.cybereason.com/hs-fs/hubfs/soulto.png?width=900&amp;name=soulto.png 900w, https://www.cybereason.com/hs-fs/hubfs/soulto.png?width=1200&amp;name=soulto.png 1200w, https://www.cybereason.com/hs-fs/hubfs/soulto.png?width=1500&amp;name=soulto.png 1500w, https://www.cybereason.com/hs-fs/hubfs/soulto.png?width=1800&amp;name=soulto.png 1800w" sizes="(max-width: 600px) 100vw, 600px"></em><span style="font-size: 16px;"><em>Bxaki deobfuscated function.</em></span></p>
<p>In order to gain access to the infected computer’s file system, the XSL script uses the variable <strong>fso</strong> with <strong>FileSystemObject</strong> capabilities. This variable is created using an ActiveX object. The XSL script contains additional hard coded variables <strong>sVarRaz</strong> and <strong>sVar2RazX</strong>, which contain file paths that direct to the downloaded files.&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/RWRFz2Q0VN5JZ6WbOaMG0S7-VQDJQqWeRRN8W6KujfgrVPDrTDMcp5_NO6kYOIPU_700YwiOEKfibc7Ae2gu9AlbGnp92cUzTycnVn5oSn0CDAQdI4IWTvHQ8bOq94BaZL6NCXOb" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>The file’s path. </em>&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/_5MeJLKVbiLWDFSsA-VbtVpvCYTPVcy7jf5sjbNHQQLM4wrjXQfMIUZ4e3fAJMZLPjK3Wigkt2eRXCbKPxTdppt4EQqZqmSn6uhqq5l0EYdbTcoNTnRk2d91flt7VMST7KIVNuYc" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>The directory creation.</em>&nbsp;</p>
<h3 style="line-height: 1.75;">Downloading the Payloads</h3>
<p>The remote XSL script downloads twelve files from the C2 server that masquerade themselves as JPEG, GIF, and extensionless files<strong>.</strong> These files are downloaded to a directory <em>(C:\Users\Public\Libraries\tempsys)</em> on the infected machine by <em>Bxaki() </em>and <em>xparis()</em>. Within these twelve files are the Astaroth Trojan modules, several additional files the Trojan may use to extend its capabilities, and an r1.log file. The r1.log file stores information for exfiltration. A thorough explanation of what information is collected can be found in a <a href="https://cofense.com/seeing-resurgence-demonic-astaroth-wmic-trojan/">breakdown by Cofense</a> from late 2018.&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/EFwLC1sVE9jMsTwgCJTetI4HMaEOUYabDA9GKab88QczzLpAliNp10bq2NIiHAG0Dtc5IsGa99BtG26TWiPc72qgedW_s9nt0JiXqAhKm8MbxsvahE5WfTGR-AzpS0rxkAjs2pbg" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>The script verifies all parts of the malware have been downloaded.</em>&nbsp;</p>
<p>After downloading the payload, the XSL script checks to make sure every piece of the malware was downloaded.&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/hrhCzOWStzLy8s7qFVp7DdjnHM-o8l1B1G0MNA7H9TYuBVlihISjx9R3yuaL8t7S1TuRdKU1E_dvqwJmYyKlGVIYec3i2OvtMtoItksboLymd9W2kiG5UEO2ivqUfGZoi745RnOn" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>One of the twelve download commands as detected by the Cybereason platform in same variant of Astaroth.</em>&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/csq9JYXIckI_Inn4nhUBguMxjIiz_GDq8Bqp9YDeijsna9BGLMfyDP86k0GRGojdw7gBNxDtIdQrSesg5lWUPl6H7Pzj4NptHlDJIiNoYKrzoEqVkn57egELxZMhyz3J9_YZH_ye" alt="" width="513" style="width: 513px; display: block; margin: 0px auto;"></div>
<p style="text-align: center;"><em>The twelve downloaded files.</em></p>
<h3>Detecting Avast&nbsp;</h3>
<p>A unique feature of this latest Astaroth Trojan campaign is the malware's ability to search for specific security products and exploit them.</p>
<p>&nbsp;In earlier variants, upon detecting Avast, the XSL script would simply quit. Instead, it now uses Avast to execute malicious actions.&nbsp;</p>
<p>Similar to earlier versions of the Astaroth Trojan campaign, the XSL script searches for Avast on the infected machine, and specifically targets a certain process of Avast <strong>aswrundll.exe</strong>. It uses three variables <strong>stem1</strong>, <strong>stem2</strong>, and <strong>stem3</strong> that, when combined, form a specific path <em>(C:\Program Files\AVAST Software\AVAST\aswRunDll.exe)</em> to <strong>aswRundll.exe</strong>. It obfuscates this path using the <em>fromCharCode()</em> function.</p>
<p><strong>aswrundll.exe</strong> is the Avast Software Runtime Dynamic Link Library that is responsible for running modules for Avast. If <strong>aswrundll.exe</strong> exists at this path, Avast exists on the machine.</p>
<p><strong>Note:</strong> aswrundll.exe is very similar to Microsoft’s own rundll32.exe - it allows you to execute DLLs by calling their exported functions. The use of aswrundll.exe as a LOLbin <a href="https://twitter.com/pabraeken/status/1000806146805059585">has been mentioned in the past year.</a></p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/jsfile3.png?width=600&amp;name=jsfile3.png" alt="jsfile3" width="600" style="width: 600px; display: block; margin: 0px auto;" srcset="https://www.cybereason.com/hs-fs/hubfs/jsfile3.png?width=300&amp;name=jsfile3.png 300w, https://www.cybereason.com/hs-fs/hubfs/jsfile3.png?width=600&amp;name=jsfile3.png 600w, https://www.cybereason.com/hs-fs/hubfs/jsfile3.png?width=900&amp;name=jsfile3.png 900w, https://www.cybereason.com/hs-fs/hubfs/jsfile3.png?width=1200&amp;name=jsfile3.png 1200w, https://www.cybereason.com/hs-fs/hubfs/jsfile3.png?width=1500&amp;name=jsfile3.png 1500w, https://www.cybereason.com/hs-fs/hubfs/jsfile3.png?width=1800&amp;name=jsfile3.png 1800w" sizes="(max-width: 600px) 100vw, 600px"></p>
<p style="text-align: center;"><span style="font-size: 16px;"><em>Stem variables presented as unicode strings.</em></span></p>
<div><img src="https://lh6.googleusercontent.com/5KRePirwtgXtsbGaHvSuMGuN887sJ0tU1kxY21LMmLpCts-6pvWgFht7rAgoywxNCYxrtcQAAS3-cSEXNKBxWC8WunBglDFsmgNT_uqmxQOqbZQ1z_q8ON48RuD6KCY8GfVHmTbR" alt="" width="327" style="width: 327px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>Stem variables decoded to ASCII.</em></p>
<h3>Manipulating Avast</h3>
<p>Once the XSL script has identified that Avast is installed on the machine, it loads a malicious module <strong>Irdsnhrxxxfery64 </strong>from its location on disk. In order to load this module, it uses an ActiveX Object <strong>ShA </strong>created with <strong>Shell.Application </strong>capabilities. The object uses <a href="https://docs.microsoft.com/en-us/windows/desktop/shell/shell-shellexecute">ShellExecute()</a> to create an <strong>aswrundll.exe</strong> process instance and loads <strong>Irdsnhrxxxfery64</strong>. It loads the module with parameter <strong>vShow</strong> set to zero, which opens the application with a hidden window.&nbsp;</p>
<p>Alternatively, if Avast is not installed on the machine, the malicious module loads using <strong>regsvr32.exe</strong>. <strong>regsvr32.exe</strong> is a native Windows utility for registering and unregistering DLLs and ActiveX controls in the Windows registry.&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/iLIfBT141JqnXEwt4JFj77yjoE3EwNp_N9lyQG0HhtbOJVmMH-qyThoQktXqaTxI2joov8qMA6wS8Iw_l3CXboGIMeERo2NHQSHz7vqYpRKciFfRG9G0KQP062QAcbXEOQcL81pY" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;">&nbsp;<em>The script attempts to load the malicious module using regsvr with the run function.</em>&nbsp;</p>
<div><img src="https://lh3.googleusercontent.com/dU21N9i2Mns1XLOjFU77AUB45uVC_gYlN_HkKvJAq2K3WcETRnHqUK6h_Y2zxgISlNKzifhzIoHtqMtIVMMr9sBXIz1mBsAk1XMJO8YW9ID-MoH9of4LccAglLL0K4RxylL1BazI" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>Procmon shows the malicious module loaded to the Avast process.</em></p>
<div><img src="https://lh5.googleusercontent.com/Z6jbaRcMnOkZKiA8yYDlSr6RTrw1KHgS22LR0PGqAERt-sJiGPt9XmxXuXjEeH462eJCLLngfzOYPcIlmHWr0VaSTH1haQv6np9jnkzoF4rLOBLDZjoIrdu-kk2co-FZdXbpn-so" alt="" width="474" style="width: 474px; display: block; margin: 0px auto;"></div>
<p style="text-align: center;"><span style="font-size: 16px;"><em>Procmon shows the malicious module loaded using the regsvr32.exe process.</em></span>&nbsp;&nbsp;</p>
<h2>Phase two: Payload Analysis&nbsp;</h2>
<div><img src="https://lh4.googleusercontent.com/OGPC1fZkOCKojrz0AdwhGxxdnVLXNXEw0-C2LJmPhMuIAuIf_E0wqhjOx0D2RmYOHFQy1s2Zgpb5J4VxUB4MsoZZ6WmAg5LWCnlgPQLQqnIsYgZb5HcxTNFA_K_6tjcR2c587W0f" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;">&nbsp;</div>
<p>The only module the XSL script loads is <strong>Irdsnhrxxxfery64</strong>, which is packed using the <a href="https://upx.github.io/">UPX packer</a>.</p>
<div><img src="https://lh5.googleusercontent.com/WXnjkrBqIthojOIZ1adbdZjEktexwd6ENEJjPB7p3vnbUeUE230HxhiaPbiyGksN496ZFfsvy21bKdDEJynC4qcD0M5kg1zLpM6lZmdeYGFeeF5DO_Ncv7EWxI-PDOUMy1sCo0rN" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;">&nbsp;<em>Information pertaining to lrdsnhxxfery64.~.</em></p>
<p>After unpacking the module, it is packed with an additional inner packer <strong>Pe123\RPolyCryptor</strong>. This module has to be investigated in a dynamic way to fully understand the malware and the role the module played during execution.</p>
<div><img src="https://lh4.googleusercontent.com/54zkiiTtaz5nril5GFKxWj8REi1ga5ihWxN5M0qA8scvwZMYZwQHLm1n6UDRAFS8kDLu4Ksfdx4rsN0MA4hVtZTa829FJJ_f0j8YZWlJ9uc3jlXSdUjWr_wEsNgShLQZou-Iq7rH" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>Information pertaining to lrdsnhrxxfery64_Unpacked.dll.</em></p>
<p>&nbsp;Throughout the malware execution, <strong>Irdsnhrxxxfery64.~</strong> acts as the main malware controller. The module initiates the malicious activity once the payload download is complete. It executes the other modules and collects initial information about the machine, including information about the network, locale, and the keyboard language.&nbsp;</p>
<div><img src="https://lh3.googleusercontent.com/0KY7fBmFkXvqgbTS2hlMP7E50Y65xFIKuQt0v3Zgw5nHT1UhnNqUhCq95m7DMR2mXjHiNZ_eh5YGb_g6nZDK2EGbxzrWFNsLFUN5pTWMhWggYBxWA54_DUvpOGhdQ2hCW_jHgh7M" alt="" width="509" style="width: 509px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;">&nbsp;<em>The main module collecting information about the machine.</em></p>
<h4>Continuing Malicious Activity and Manipulating Additional Security Products</h4>
<p>After the module loads with <strong>regsvr32.exe</strong>, the <strong>Irdsnhrxxxfery64 </strong>module injects another module <strong>Irdsnhrxxxfery98</strong>, which was downloaded by the script into <strong>regsvr32.exe</strong> using the <a href="https://docs.microsoft.com/en-us/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibraryexa">LoadLibraryExW()</a> function.</p>
<p>Similar to the previous case, if Avast and <strong>aswrundll.exe </strong>are on the machine, <strong>Irdsnhrxxxfery98</strong> will be injected into that process instead of <strong>regsvr32.exe</strong>.&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/Fw5b9j5KN4PfJibFTh3EdpciupXpgu2p6Gi23fba4NEJbKEwfZqaenUZm2XgNCDJjj-VsArnqMHvJQwcN48GFSMIklEZMm0Z8DyDbuLDMGuAj1w365RhW1XH1wm5Wy-ZWggJ34qf" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>Irdsnhrxxxfery64 injecting lrdsnhrxxfery98.</em></p>
<div><img src="https://lh4.googleusercontent.com/zv35LRyXUUgdLyuiXChLOhY_ptyoxhBY5UIpwWFzoilJtijLnc7XNOenhfqWZZNuUKVtDLPV5wqf4oOadzjL_SJEQ1cHtk0kh3kWDUpWRLhhHLSwCfJm31CPC81IsrM5fvV4aIVO" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>The malicious modules in regsvr32.exe memory</em></p>
<p>After the <strong>Irdsnhrxxxfery98 </strong>module is loaded, the malware searches different processes to continue its malicious activity depending on the way <strong>Irdsnhrxxxfery64</strong> was loaded.</p>
<ol>
<li><span style="font-size: 18px;">If <strong>Irdsnhrxxxfery64</strong> is loaded using <strong>aswrundll.exe</strong>, the module will continue to target <strong>aswrundll.exe.</strong> It will create new instances and continue to inject malicious content to it.</span></li>
<li><span style="font-size: 18px;">If <strong>Irdsnhrxxxfery64</strong> is loaded using <strong>regsvr32.exe, </strong>it will target three processes:</span></li>
</ol>
<ul>
<li><span style="font-size: 18px;">It will target <strong>unins000.exe</strong> if it is available. <strong>unins000.exe</strong> is a process developed by GAS Tecnologia that is common on Brazilian machines.</span></li>
<li>&nbsp;</li>
<li><span style="font-size: 18px;">If unins000.exe does not exist, it will target Syswow64\<strong>userinit.exe</strong>. <strong>userinit.exe</strong> is a native Windows process that specifies the program that Winlogon runs when a user logs on to their computer. </span><span style="font-size: 18px;">Similarly, if unins000.exe and Syswow64\<strong>userinit.exe </strong>do not exist, it will target System32\<strong>userinit.exe</strong>.</span><br><br></li>
</ul>
<div><img src="https://lh5.googleusercontent.com/b24R-VchoTQFKzyOOKgDMtkDWU8XNvDMvR8YSEem9_-NsApKnaVlfcPEpWsRZzn4huDhu2bcpPb6dw4Zry0rjlGiKtZyRflZLA2999PeW8KJCOyBnxmPtXJ8d3_3PLItBxoLjXaS" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>The malware searches for targeted processes.</em></p>
<div><img src="https://lh4.googleusercontent.com/ON_MI6ZCzBzVrTHBVF92FRIex-gRSQfVP6bJV7PAMvESvAWgiGaqRXVN4bg0ThvJlmq2-2yCYqixDDUBGOw52cC0QHFvGjcygNjrVKT1J6AxS4MHIxh2SRWYQ-GVHA1y9gZkBiyo" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>Irdsnhrxxxfery64 manipulation on userinit.exe &amp; unins000.exe</em></p>
<h4>Injection Technique To Increase Stealthiness</h4>
<p>After locating one of the target processes, the malware uses Process Hollowing (MITRE Technique T1093) to evasively create a new process from a legitimate source. This new process is in a suspended state so the malware can unmap its memory and write its contents to the new, allocated space. Once this is complete, it will resume the suspended process. By using this technique, the malware is able to leverage itself from a signed and verified legitimate Windows OS process, or, alternatively, if <strong>aswrundll.exe </strong>or <strong>unins000.exe</strong> exists, a signed and verified security product process.</p>
<div><img src="https://lh4.googleusercontent.com/2M51zDomiK8EnJYJ1J_sn6rN_tRrRwDxfDaIa6pR6PTHOMku7yjFg2KX86Wuvp2zFtNZEF47lKBAVV_kW5EtaUc8NVbd8utZC6bcS7jCsQ8B-hiSsLvGBT_e6Y4aKahC5kUo5YoD" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;">&nbsp;</div>
<p style="text-align: center; font-size: 16px;"><em>Astaroth module creates a process in a suspended state (dwCreationFlags set to 4).</em></p>
<div><img src="https://lh4.googleusercontent.com/2X4CtMIPOFvHtvuQYXHKtfGKAC09nb-HsT-B6R_-6cHgBwFCIfmtkq2i-pBn5OdFlCaUKcamfh3TtYcwgBc8j0Q7Ay458j-eH_wi3h71h84yZiaKdusJa8yE7CYczFVHeYueaRpz" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>Unmapping process memory.</em></p>
<div><img src="https://lh5.googleusercontent.com/qylHMJauvd7VG6PD86EvxWjGB9w6H9PvYKFK4AvSSdTYUUm93p2OeYllLdHaQo890z9_AZpGtxiu1Rd30hnafjQNgLuM9sQcEPskzsK2T9ky0FvUNVPHe2bCWA0dL5mMZ0ZaAaPM" alt="" style="width: 600px; margin: 0px auto; display: block;" width="600"></div>
<p style="text-align: center; font-size: 16px;"><em>Writing content and resuming the process.</em></p>
<p>The Cybereason platform was able to detect the malicious injection, identifying <strong>Irdsnhrxxxfery64.~</strong>, <strong>Irdsnhrxxxfery98.~</strong>, and module <strong>arqueiro</strong>.&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/l-OFl0SDggVAkDJScXtRSPYL7Bi8AIjItRE09JxSokXfVksOrST2n5R9O-C6v6MvqjOl77dUo-G44GqgyAlxVXCUVvwMRd7ThmHCSCMVvMsnwJQYK_l7SMPQomfOOw8R45mELANi" alt="" width="383" style="width: 383px; display: block; margin: 0px auto;"></div>
<p style="font-size: 16px; text-align: center;"><em>The downloaded modules found in regsvr32.exe as detected by the Cybereason platform.</em></p>
<h3>Data Exfiltration</h3>
<p>The second module <strong>Irdsnhrxxxfery98.~ </strong>is responsible for a vast amount of information stealing, and is able to collect information through hooking, clipboard usage, and monitoring the keystate.</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/monitor98.png?width=498&amp;name=monitor98.png" alt="monitor98" width="498" style="width: 498px; display: block; margin: 0px auto;" srcset="https://www.cybereason.com/hs-fs/hubfs/monitor98.png?width=249&amp;name=monitor98.png 249w, https://www.cybereason.com/hs-fs/hubfs/monitor98.png?width=498&amp;name=monitor98.png 498w, https://www.cybereason.com/hs-fs/hubfs/monitor98.png?width=747&amp;name=monitor98.png 747w, https://www.cybereason.com/hs-fs/hubfs/monitor98.png?width=996&amp;name=monitor98.png 996w, https://www.cybereason.com/hs-fs/hubfs/monitor98.png?width=1245&amp;name=monitor98.png 1245w, https://www.cybereason.com/hs-fs/hubfs/monitor98.png?width=1494&amp;name=monitor98.png 1494w" sizes="(max-width: 498px) 100vw, 498px"></p>
<p style="text-align: center; font-size: 16px;"><em>Irdsnhrxxxfery98 information collecting capabilities.</em></p>
<p>In addition to its own information stealing capabilities, the Astaroth Trojan campaign also uses an external feature <a href="https://www.nirsoft.net/utils/network_password_recovery.html">NetPass</a><strong>.</strong> NetPass is one of the downloaded payload files renamed to <strong>lrdsnhrxxferyb.jpg</strong>.</p>
<p>NetPass is a free network password recovery tool that, according to its <a href="https://www.nirsoft.net/">developer Nirsoft</a>, can recover passwords including:</p>
<ul>
<li><span style="font-size: 18px;">Login passwords of remote computers on LAN.</span></li>
<li><span style="font-size: 18px;">Passwords of mail accounts on an exchange server stored by Microsoft Outlook.</span></li>
<li><span style="font-size: 18px;">Passwords of MSN Messenger and Windows Messenger accounts.</span></li>
<li><span style="font-size: 18px;">Internet Explorer 7.x and 8.x passwords from password-protected web sites that include <strong>Basic Authentication </strong>or <strong>Digest Access Authentication</strong>.</span></li>
<li><span style="font-size: 18px;">The item name of Internet Explorer 7 passwords that always begin with <strong>Microsoft_WinInet</strong> prefix.</span></li>
<li><span style="font-size: 18px;">The passwords stored by Remote Desktop 6.&nbsp;</span></li>
<li>&nbsp;</li>
</ul>
<div><img src="https://lh3.googleusercontent.com/MRtCEqBRuc4klDJppM6gurM_SXcV2pU6WSaGctUB1cuRpiNKouhbVhTgB6IvV2X1Has_kuBYq2oIhGIdzDVyFTf5C_r4aebkdlQclY-8gX-8XFp6bTVSfOljNTRNBGx1E_AZRCF-" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>NetPass usage.</em></p>
<h3>Attack Flow and Exfiltration</h3>
<p>After injecting into the targeted processes, the modules continue their malicious activity through those processes. The malware executes malicious activity in a small period of time through the target process, deletes itself, and then repeats. This occurs periodically and is persistent.</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/3%20ways.png?width=543&amp;name=3%20ways.png" alt="3 ways" width="543" style="width: 543px; display: block; margin: 0px auto;" srcset="https://www.cybereason.com/hs-fs/hubfs/3%20ways.png?width=272&amp;name=3%20ways.png 272w, https://www.cybereason.com/hs-fs/hubfs/3%20ways.png?width=543&amp;name=3%20ways.png 543w, https://www.cybereason.com/hs-fs/hubfs/3%20ways.png?width=815&amp;name=3%20ways.png 815w, https://www.cybereason.com/hs-fs/hubfs/3%20ways.png?width=1086&amp;name=3%20ways.png 1086w, https://www.cybereason.com/hs-fs/hubfs/3%20ways.png?width=1358&amp;name=3%20ways.png 1358w, https://www.cybereason.com/hs-fs/hubfs/3%20ways.png?width=1629&amp;name=3%20ways.png 1629w" sizes="(max-width: 543px) 100vw, 543px"><span style="font-size: 16px;"><em>The malware’s different functionality.</em></span></p>
<p>Once the targeted processes are infected by the malicious modules, they begin communicating with the payload C2 server and exfiltrating information saved to the r1.log file. The communication and exfiltration of data was detected in a real-world scenario using the Cybereason platform.</p>
<div><img src="https://lh5.googleusercontent.com/5N1423uzX4VfVvl6n4XmBRDEIhZoL49X3bGFWnPWCBbSTL3N9AnbQRLAsu9R2p2fgox-hyx4uv8hu9hfc6Hr9Erycovr1Z7U0w8fqgpoF6OElYapNus8I2Pek-5i0nvQWFfBiLA8" alt="" width="600" style="width: 600px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>The malicious use of GAS Tecnologia security process unins000.exe.</em>&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/siNOmW8UmdgqdYlGk8VNKSVpauiqZv4ipqlpNz_uKxqJc3HqglnGAt1YAhRWm3bRMoyVRyjNA16RwKbGnzhTpBfNyEVLx0ecwfM8pbSg0GZqTxTrd5mI6ntV-NZPqrc0m4W377vI" alt="" width="341" style="width: 341px; display: block; margin: 0px auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>Data exfiltration from unins000.exe to a malicious IP.</em>&nbsp;</p>
<h2 style="line-height: 1.75;">Conclusion</h2>
<p>Our Active Hunting Service was able to detect both the malicious use of the BITSAdmin utility and the WMIC utility. Our customer immediately stopped the attack using the remediation section of our platform and prevented any exfiltration of data. From there, our hunting team identified the rest of the attack and completed a thorough analysis.</p>
<p>We were able to detect and evaluate an evasive infection technique used to spread a variant of the Astaroth Trojan as part of a large, Brazilian-based spam campaign. In our discovery, we highlighted the use of legitimate, built-in Windows OS processes used to perform malicious activities to deliver a payload without being detected, as well as how the Astaroth Trojan operates and installs multiple modules covertly. We also showed its use of well-known tools and antivirus products to expand its capabilities. The analysis of the tools and techniques used in the Astaroth campaign show how truly effective LOLbins are at evading antivirus products. As we enter 2019, we anticipate that the use of LOLbins will likely increase. Because of the great potential for malicious exploitation inherent in the use of native processes, it is very likely that many other information stealers will adopt this method to deliver their payload into targeted machines.</p>
<p>As a result of this detection, the customer was able to contain an advanced attack before any damage was done. The Astaroth Trojan was controlled, WMIC was disabled, and the attack was halted in its tracks.</p>
<p>Part of the difficulty identifying this attack is in how it evades detection. It is difficult to catch, even for security teams aware of the complications ensuring a secure system, as with our customer above. LOLbins are deceptive because their execution seems benign at first, or even sometimes safe, as with the malicious use of antivirus software. As the use of LOLbins becomes more commonplace, we suspect this complex method of attack will become more common as well. The potential for damage will grow as attackers will look to other more destructive payloads.</p>
<p><em>For more information on LOLbins in the wild,&nbsp;read&nbsp;our research into a different Trojan.&nbsp;</em></p>
<p style="text-align: center;"><em><!--HubSpot Call-to-Action Code --><span class="hs-cta-wrapper" id="hs-cta-wrapper-37725f60-26a0-4102-8835-914f137a7dd9"><span class="hs-cta-node hs-cta-37725f60-26a0-4102-8835-914f137a7dd9" id="hs-cta-37725f60-26a0-4102-8835-914f137a7dd9"><!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--><a href="https://cta-redirect.hubspot.com/cta/redirect/3354902/37725f60-26a0-4102-8835-914f137a7dd9"><img class="hs-cta-img" id="hs-cta-img-37725f60-26a0-4102-8835-914f137a7dd9" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/3354902/37725f60-26a0-4102-8835-914f137a7dd9.png" alt="LOLbins and Trojans: How the Ramnit Trojan Spreads via sLoad in a Cyberattack  <https://www.cybereason.com/blog/banking-trojan-delivered-by-lolbins-ramnit-trojan>"></a></span><script charset="utf-8" src="/hs/cta/cta/current.js"></script><script type="text/javascript"> hbspt.cta._relativeUrls=true;hbspt.cta.load(3354902, '37725f60-26a0-4102-8835-914f137a7dd9', {"region":"na1"}); </script></span><!-- end HubSpot Call-to-Action Code --></em></p>
<h2 style="line-height: 1.75;">Indicators of CompromisE</h2>
<table>
<tbody>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>01782747C12Bf06A52704A144DB59FEC41B3CB36</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>NF-e513468.zip<span><br><br></span></p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>1F83403398964D4E8B6C70B171C51CD278909172</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>Script.js</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>CE8BDB56CCAC55C6881701EBD39DA316EE7ED18D</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxfery64.~</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>926137A50f473BBD257CD19E207C1C9114F6B215</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxfery98.~</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>5579E03EB1DA076EF939196CB14F8B769F30A302</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferyb.jpg</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>B2734835888756929EE3FF4DCDE85080CB299D2A</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferyc.jpg</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>206352E13D601239E2D043D971EA6657C091071A</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferydwwn.gif</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>EAE82A63A980998F8D388BCCE7D967F28309F593</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferydwwn.gif</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>9CD5A399C9320CBFB87C9D1CAD3BC366FB12E54F</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferydx.gif</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>206352E13D601239E2D043D971EA6657C091071A</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferye.jpg</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>4CDE9A53A9A49D606BC89E74D47398A69E767056</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferyg.gif</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>F99319B1B321AE9F2D1F0361BC756A43D25444CE</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferygx.gif</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>B85C106B68ED410107f97A2CC38b7EC05353F1FA</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferyxa.~</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>77809236FDF621ABE37B32BF073B0B893E9CE67A</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferyxb.~</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>B85C106B68ED410107f97A2CC38b7EC05353F1fA</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>lrdsnhrxxferyxa.~</p>
</td>
</tr>
<tr>
<td>
<p><strong>SHA1</strong></p>
<p>C2F3350AC58DE900768032554C009C4A78C47CCC</p>
</td>
<td>
<p>Hash</p>
</td>
<td>
<p>r1.log</p>
</td>
</tr>
<tr>
<td><br>
<p>104.129.204[.]41</p>
</td>
<td>
<p>IP</p>
</td>
<td>
<p>C2</p>
</td>
</tr>
<tr>
<td><br>
<p>63.251.126[.]7</p>
</td>
<td>
<p>IP</p>
</td>
<td>
<p>C2</p>
</td>
</tr>
<tr>
<td><br>
<p>195.157.15[.]100</p>
</td>
<td>
<p>IP</p>
</td>
<td>
<p>C2</p>
</td>
</tr>
<tr>
<td><br>
<p>173.231.184[.]59</p>
</td>
<td>
<p>IP</p>
</td>
<td>
<p>C2</p>
</td>
</tr>
<tr>
<td><br>
<p>64.95.103[.]181</p>
</td>
<td>
<p>IP</p>
</td>
<td>
<p>C2</p>
</td>
</tr>
<tr>
<td><br>
<p>19analiticsx00220a[.]com</p>
</td>
<td>
<p>Domain</p>
</td>
<td>
<p>C2</p>
</td>
</tr>
<tr>
<td><br>
<p>qnccmvbrh.wilstonbrwsaq[.]pw</p>
</td>
<td>
<p>Domain</p>
</td>
<td>
<p>C2</p>
</td>
</tr>
</tbody>
</table></span>
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/CR_Owl_Web_Mono@3x%202.png" alt="Cybereason Nocturnus">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Nocturnus</h4>
                
                  <a class="social" href="https://www.linkedin.com/company/cybereason" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-linkedin.png">
                  </a>
                
                
                  <a class="social" href="https://twitter.com/cr_nocturnus" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-twitter.svg">
                  </a>
                
                
                  <p>The Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-nocturnus">All Posts by Cybereason Nocturnus</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
      </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__blog-listing related-posts__wrapper">
    <h3>Related Posts</h3>
  <div class="container container-is-blog columns is-multiline page-center">
      
          
          
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
  </div>
</section>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              <a href="https://www.cybereason.com">
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-logo-web-horizontal-white-500px.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
                </li><li><a href="https://www.cybereason.com/company/leadership-and-advisory-board">Leadership</a>
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2021. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<script>
(function () {
    window.addEventListener('load', function () {
        setTimeout(function () {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/_hcms/perf', true /*async*/);
            xhr.setRequestHeader("Content-type", "application/json");
            xhr.onreadystatechange = function () {
                // do nothing.
            };
            var connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            function populateNetworkInfo(name, connection, info) {
                if (name in connection) {
                    info[name] = connection[name];
                }
            }
            var networkInfo = {};
            if (connection) {
                ['type', 'effectiveType', 'downlink', 'rtt'].forEach(function(name) {
                    populateNetworkInfo(name, connection, networkInfo);
                });
            }
            var perfData = {
                url: location.href,
                portal: 3354902,
                content: 7525628640,
                group: -1,
                connection: networkInfo,
                timing: performance.timing
            };
            xhr.send(JSON.stringify(perfData));
        }, 3000);  // Execute this 3 seconds after onload.
    });
})();
</script>

<script src="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/42507089303/1614944819152/__CR_Web_Platform_2020/JS/animatedModal/animatedModal.min.js"></script>
<script>
if (typeof hsVars !== 'undefined') { hsVars['language'] = 'en'; }
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.27/bundles/project.js"></script>
<script src="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/41681847227/1619109182704/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/41682410610/1618194602937/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/information-stealing-malware-targeting-brazil-full-research"]);
_hsq.push(["setPageId", "7525628640"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 7525628640,
    "legacyPageId": "7525628640",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 7525628640,
    "languageCode": "en",
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    ticks: 1621734511729,
    page_id: 7525628640,

    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.103/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
 <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&status=0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
 <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

</body></html>