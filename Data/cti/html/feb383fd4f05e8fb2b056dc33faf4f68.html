

<!doctype html>

<html lang="en-US">
    <head>
        


	<title>Tall Tales of Hunting with TLS/SSL Certificates  | Splunk</title>
	<meta name="description" content="TLS and SSL certificates are a great way to hunt advanced adversaries. Collect them with Splunk Stream, Bro, or Suricata and hunt in your own data!"/>
    <meta name="keywords" content="TLS, SSL, Hunting, Pivoting, Ryan Kovar, Kovar, Splunk, Security, Mark Parsons, Parsons,"/>
	<meta charset="utf-8"/>
    
	
      <link rel="alternate" href="https://www.splunk.com/en_us/blog/security/tall-tales-of-hunting-with-tls-ssl-certificates.html" hreflang="x-default"/>
	
	<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-57x57.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-114x114.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-72x72.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-144x144.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="60x60" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-60x60.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-120x120.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-76x76.png"/>
	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/content/dam/splunk2/images/icons/favicons/apple-touch-icon-152x152.png"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-196x196.png" sizes="196x196"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-96x96.png" sizes="96x96"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-32x32.png" sizes="32x32"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-16x16.png" sizes="16x16"/>
	<link rel="icon" type="image/png" href="/content/dam/splunk2/images/icons/favicons/favicon-128.png" sizes="128x128"/>
	<link rel="shortcut icon" type="image/x-icon" href="/content/dam/splunk2/images/icons/favicons/favicon.ico"/>
	<meta name="application-name" content="Splunk"/>
	<meta name="msapplication-TileColor" content="#FFFFFF"/>
	<meta name="msapplication-TileImage" content="/content/dam/splunk2/images/icons/favicons/mstile-144x144.png"/>
	<meta name="msapplication-square70x70logo" content="/content/dam/splunk2/images/icons/favicons/mstile-70x70.png"/>
	<meta name="msapplication-square150x150logo" content="/content/dam/splunk2/images/icons/favicons/mstile-150x150.png"/>
	<meta name="msapplication-wide310x150logo" content="/content/dam/splunk2/images/icons/favicons/mstile-310x150.png"/>
	<meta name="msapplication-square310x310logo" content="/content/dam/splunk2/images/icons/favicons/mstile-310x310.png"/>
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/> 
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta property="og:title" content="Tall Tales of Hunting with TLS/SSL Certificates "/>
    <meta property="og:description" content="TLS and SSL certificates are a great way to hunt advanced adversaries. Collect them with Splunk Stream, Bro, or Suricata and hunt in your own data!"/>

    

    <meta property="og:image" content="https://www.splunk.com/content/dam/splunk-blogs/images/2017/06/BOTS.png"/>
    <meta property="og:site_name" content="Splunk-Blogs"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.splunk.com/en_us/blog/security/tall-tales-of-hunting-with-tls-ssl-certificates.html"/>
	<meta name="article-published_time" property="article:published_time" content="2017-12-11T10:03:14.000-09:00"/>
	<meta name="publish_date" property="og:publish_date" content="2017-12-11T10:03:14.000-09:00"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Tall Tales of Hunting with TLS/SSL Certificates "/>
    <meta name="twitter:description" content="TLS and SSL certificates are a great way to hunt advanced adversaries. Collect them with Splunk Stream, Bro, or Suricata and hunt in your own data!"/>
    <meta name="twitter:image" content="https://www.splunk.com/content/dam/splunk-blogs/images/2017/06/BOTS.png"/>

	<link rel="canonical" href="https://www.splunk.com/en_us/blog/security/tall-tales-of-hunting-with-tls-ssl-certificates.html"/>
	
    <!-- /*[if lt IE 9]*/>
    	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>    
    <!/*[endif]*/-->
	
	<script type="text/javascript" src="//cdn.bizible.com/scripts/bizible.js" async=""></script>
	
	<script type="text/javascript" async src="https://play.vidyard.com/embed/v4.js"></script>
	
    	
    		<script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Tall Tales of Hunting with TLS/SSL Certificates ","image":["/content/dam/splunk-blogs/images/authors/rkovar","/content/dam/splunk-blogs/images/2017/06/BOTS.png","/content/dam/splunk-blogs/images/2017/06/BOTS.png"],"datePublished":"2017-12-11T10:03:14.000-09:00","dateModified":"2017-12-11T10:03:14.000-09:00"}</script>
    	
	

	
	<!-- /* Google Tag Manager */-->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '';f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-TPV7TP');</script>
	<!-- /* End Google Tag Manager */-->
	

        



    
<link rel="stylesheet" href="/etc/clientlibs/splunk/splunk-blogs/dist.731da9790a20d6a68f44215eaa7ee466.css" type="text/css">




    
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery.0811b5e7037ada110b591bbd86240386.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/utils.7d1c4e1c54f4b3bce718f5d6a06ffd06.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite.ed0d934d509c9dab702088c125c92b4f.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/jquery.d7602973233c4c7f80959aa5a7f2f4af.js"></script>











        <!--WWW-13669: Observability blogs header spacing bug fix-->        
        <script>
            var pageUrl = window.location.href;
            if (pageUrl.indexOf('observability') != -1) {
                document.querySelector('html').classList.add('o11y');
            }
            $(function () {
              var ssosid_cookie = document.cookie.indexOf('WEBID=');
			  var webid_cookie = document.cookie.indexOf('SSOSID=');
                if(ssosid_cookie=='-1' && webid_cookie!="-1"){
                    window.location.href = "/saml/login?module=nav&redirecturl="+window.location.href
                }
            });
        </script>        
    
  <script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"","rua.texp":""}]);</script>
                          <script>!function(a){var e="https://s.go-mpulse.net/boomerang/",t="addEventListener";if("False"=="True")a.BOOMR_config=a.BOOMR_config||{},a.BOOMR_config.PageParams=a.BOOMR_config.PageParams||{},a.BOOMR_config.PageParams.pci=!0,e="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="M7Q82-FTRNS-TEZ4E-UCSZ2-NQJ9C",function(){function n(e){a.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!a.BOOMR||!a.BOOMR.version&&!a.BOOMR.snippetExecuted){a.BOOMR=a.BOOMR||{},a.BOOMR.snippetExecuted=!0;var i,_,o,r=document.createElement("iframe");if(a[t])a[t]("load",n,!1);else if(a.attachEvent)a.attachEvent("onload",n);r.src="javascript:void(0)",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="width:0;height:0;border:0;display:none;",o=document.getElementsByTagName("script")[0],o.parentNode.insertBefore(r,o);try{_=r.contentWindow.document}catch(O){i=document.domain,r.src="javascript:var d=document.open();d.domain='"+i+"';void(0);",_=r.contentWindow.document}_.open()._l=function(){var a=this.createElement("script");if(i)this.domain=i;a.id="boomr-if-as",a.src=e+"M7Q82-FTRNS-TEZ4E-UCSZ2-NQJ9C",BOOMR_lstart=(new Date).getTime(),this.body.appendChild(a)},_.write("<bo"+'dy onload="document._l();">'),_.close()}}(),"".length>0)if(a&&"performance"in a&&a.performance&&"function"==typeof a.performance.setResourceTimingBufferSize)a.performance.setResourceTimingBufferSize();!function(){if(BOOMR=a.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var e=""=="true"?1:0,t="",n="pif4udwlosxxcyfjwiba-f-2c7247313-clientnsv4-s.akamaihd.net",i={"ak.v":"31","ak.cp":"640520","ak.ai":parseInt("418654",10),"ak.ol":"0","ak.cr":11,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"5e99ae12","ak.r":40729,"ak.a2":e,"ak.m":"a","ak.n":"essl","ak.bpcip":"122.11.202.0","ak.cport":12789,"ak.gh":"203.116.175.109","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1621733890","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==t4SKDWQ6Nzd5oRoAmC0eKM08/D7aRUqGwYLjhIMP3EGbKZ/g7AA0wjiMoI3xXs/N4fW/xy9cWMufjMj2G6YmvneZw4dNZUSVMRJT4mkY7JOPlsc5SdgG31nfEWh43dzBzqb3wpXZjHWA7KyBzCFLfWzpCltlsYGCEtYiXkO6eOOTIpgnSnhngijSpR6hmFn9JVpoz8YVQNVoGwNNLDX0dVOgAIezwgc5wt7utTX2F3zGyhUwgfC4DZxEHWxmcCdmGunIueY2lxZE1Ae4hxCMx7aBD307sv40O7z6aVRd5LeHgITCenObmDiOfry1co1tRi+Fop3XeXIc+UWqW96FE0BIxJ+wcZ4WpXJ35cj/e7UH+HA0/W9tr6ZhWiR/U10IqGl2Y6oOqm/beWa9o5+uIdO/tslJg8DnqyqroN2dhh4=","ak.pv":"111","ak.dpoabenc":""};if(""!==t)i["ak.ruds"]=t;var _={i:!1,av:function(e){var t="http.initiator";if(e&&(!e[t]||"spa_hard"===e[t]))i["ak.feo"]=void 0!==a.aFeoApplied?1:0,BOOMR.addVar(i)},rv:function(){var a=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t"];BOOMR.removeVar(a)}};BOOMR.plugins.AK={akVars:i,akDNSPreFetchDomain:n,init:function(){if(!_.i){var a=BOOMR.subscribe;a("before_beacon",_.av,null,null),a("onbeacon",_.rv,null,null),_.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
    <body>        
        <!--[if lt IE 7]>
        	<p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        
  <!-- /* Google Tag Manager (noscript) */-->
  <noscript><iframe title="GTM NoScript" src="https://www.googletagmanager.com/ns.html?id=GTM-TPV7TP" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- /* End Google Tag Manager (noscript) */ -->

<!-- /* start: Header section */-->
  
  <div id="iframe-modal" class="modal fade overlay-form-modal" role="dialog">
    <div id="header-signup-xcomp" class="overlay-form overlay" style="margin-right:-600px;"></div>
  </div>
  <header>
         


<div class="section"><div class="new"></div>
</div><div class="iparys_inherited"><div class="headerIParsys iparsys parsys"><div class="reference parbase section"><div class="cq-dd-paragraph"><div class="htmlcomp parbase"><a></a>


<section>
    
    <style>
.splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a.btn, .splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a#free-splunk-click-desktop {
    background-color: #FFFFFF;
    border: 1px solid #FFFFFF;
    color: #ED0080;
}
.splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a.btn:hover,
.splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a.btn:active,
.splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a.btn:focus,
.splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a.btn.focus,
.splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a#free-splunk-click-desktop:hover,
.splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a#free-splunk-click-desktop:active,
.splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a#free-splunk-click-desktop:focus,
.splunk-header-v3 .navbar-splunk-v3 .navbar-right .free-splunk a#free-splunk-click-desktop.focus
 {
    color: #E8339B;
    background-color: #FFFFFF;
    border: 1px solid #FFFFFF;
}
.splunk-header-v3-mobile .free-splunk-mobile, .splunk-header-v3-mobile  #free-splunk-click-mobile {
    background-color: #FFFFFF;
    color: #ED0080;
    border: 1px solid #FFFFFF;
}
</style>
  </section>

</div>
</div>
</div>
<div class="globalheader parbase section">

<!-- /* start: Header section */-->

<!-- /* Header Desktop Section Start*/-->
<div class="splunk-header-v3">
  <nav class="navbar navbar-default navbar-fixed-top navbar-splunk-v3 ">
    <div class="container-fluid custom-masthead">
      <div class="navbar-header">
        <a class="navbar-brand" href="https://www.splunk.com">

          <img src="/content/dam/splunk-blogs/images/logos/splunk-logo.svg" alt="https://www.splunk.com" title=""/> </a>
        </a>
      </div>
      <ul class="nav navbar-nav navbar-right ">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle cm-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="splunk-icon icon-expanded-splunk-sites-launchpad"></span>Splunk Sites<span class="caret"></span></a>
          <ul class="dropdown-menu cm-dropdown cm-sites">
            <li class="ss-list">
              <a href="https://answers.splunk.com/index.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-answers gray"></span>
                
                
                <span class="link-text">Answers</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/blog" target="_blank">
                <span class="link-img splunk-icon icon-expanded-blogs gray"></span>
                
                
                <span class="link-text">Blogs</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/en_us/community.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-community gray"></span>
                
                
                <span class="link-text">Community</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://conf.splunk.com" target="_blank">
                <span class="link-img splunk-icon icon-expanded-conf gray"></span>
                
                
                <span class="link-text">.conf</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://dev.splunk.com" target="_blank">
                <span class="link-img splunk-icon icon-expanded-dev gray"></span>
                
                
                <span class="link-text">Developers</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://docs.splunk.com/Documentation" target="_blank">
                <span class="link-img splunk-icon icon-expanded-docs gray"></span>
                
                
                <span class="link-text">Documentation</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/" target="_blank">
                <span class="link-img splunk-icon icon-expanded-splunkcom gray"></span>
                
                
                <span class="link-text">Splunk.com </span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://splunkbase.splunk.com/" target="_blank">
                <span class="link-img splunk-icon icon-expanded-splunkbase gray"></span>
                
                
                <span class="link-text">Splunkbase</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://splunklive.splunk.com/" target="_blank">
                <span class="link-img splunk-icon icon-expanded-splunklive gray"></span>
                
                
                <span class="link-text">SplunkLive!</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/en_us/support-and-services.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-support gray"></span>
                
                
                <span class="link-text">Support</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://www.splunk.com/en_us/training.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-training gray"></span>
                
                
                <span class="link-text">Training</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="https://usergroups.splunk.com/" target="_blank">
                <span class="link-img splunk-icon icon-expanded-usergroups gray"></span>
                
                
                <span class="link-text">User Groups</span>
              </a>
            </li>
          
            <li class="ss-list">
              <a href="/en_us/resources/videos.html" target="_blank">
                <span class="link-img splunk-icon icon-expanded-splunktv gray"></span>
                
                
                <span class="link-text">Splunk TV</span>
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </div>
    <div class="container-fluid masthead">
      
      <div class="navbar-header">
        <a href="https://www.splunk.com" class="navbar-brand">
          <img src="/content/dam/splunk-blogs/images/logos/splunk-logo.svg" alt="https://www.splunk.com" title=""/> </a>
        </a>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-left">
          <li class="dropdown mega-menu-nav">
            <a href="https://www.splunk.com/blog" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">BLOGS
              <span class="caret"></span><span class="vertical-divider"></span></a>
          </li>
          <li class="dropdown mega-menu-nav">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">CATEGORIES<span class="caret"></span></a>
            <div class="dropdown-menu">
              <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="mega-menu-heading-titleContainer">
                            <div class="mega-menu-heading-title splunk2-h5">Categories</div>
                            <div class="mega-menu-heading-title-icon close-icon">
                                <a href="#" class="splunk-icon icon-expanded-close-btn" id="Top_Nav-Close"></a>
                            </div>
                        </div>
                        <div role="separator" class="divider"></div>
                        
                    </div>  
                </div>
                <div class="row">
                  <div class="col-sm-9">
                    <div class="row">
                      <!--/* Html will be rendered from globalhead.js */ -->
                      <div class="col-xs-4">	<ul class="mega-menu-list category-block">		<li>			<a href="/en_us/blog/bulletins.html">				<img src="/content/dam/splunk-blogs/images/category/bulletins.svg">Bulletins			</a>		</li>		<li>			<a href="/en_us/blog/conf-splunklive.html">				<img src="/content/dam/splunk-blogs/images/category/conf-splunklive.svg">.conf & SplunkLive!			</a>		</li>		<li>			<a href="/en_us/blog/customers.html">				<img src="/content/dam/splunk-blogs/images/category/customers.svg">Customers & Community			</a>		</li>		<li>			<a href="/en_us/blog/devops.html">				<img src="/content/dam/splunk-blogs/images/category/devops.svg">DevOps			</a>		</li>		<li>			<a href="/en_us/blog/industries.html">				<img src="/content/dam/splunk-blogs/images/category/industries.svg">Industries			</a>		</li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list category-block">		<li>			<a href="/en_us/blog/it.html">				<img src="/content/dam/splunk-blogs/images/category/it.svg">IT			</a>		</li>		<li>			<a href="/en_us/blog/leadership.html">				<img src="/content/dam/splunk-blogs/images/category/leadership.svg">Leadership			</a>		</li>		<li>			<a href="/en_us/blog/partners.html">				<img src="/content/dam/splunk-blogs/images/category/partners.svg">Partners			</a>		</li>		<li>			<a href="/en_us/blog/platform.html">				<img src="/content/dam/splunk-blogs/images/category/platform.svg">Platform			</a>		</li>		<li>			<a href="/en_us/blog/security.html">				<img src="/content/dam/splunk-blogs/images/category/security.svg">Security			</a>		</li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list category-block">		<li>			<a href="/en_us/blog/splunk-for-good.html">				<img src="/content/dam/splunk-blogs/images/category/splunk-for-good.svg">Splunk for Good			</a>		</li>		<li>			<a href="/en_us/blog/splunklife.html">				<img src="/content/dam/splunk-blogs/images/category/splunklife.svg">Splunk Life			</a>		</li>		<li>			<a href="/en_us/blog/tips-and-tricks.html">				<img src="/content/dam/splunk-blogs/images/category/tips-and-tricks.svg">Tips & Tricks			</a>		</li>	</ul></div>
                    </div>
                  </div>
                  
                  <div class="col-sm-3 mega-menu-spotlight">
                    <div class="spotlight-img"><img alt="Category Spot Image" src="/content/dam/splunk2/images/spotlight/spot-light-promo-cloud-on-AWS.jpg"/></div>
                    <div class="mega-menu-heading splunk2-eyebrow">Partner Solution</div>
                    <div class="title splunk2-h5">Splunk Cloud on AWS</div>
                    <p class="mega-menu-heading-description splunk-body">Simplify your procurement process and subscribe to Splunk Cloud via the AWS marketplace</p>
                    <div class="splunk-button-aem">
                        <a class="splunk-btn sp-btn-borderless sp-btn-pink ga-cta" href="https://aws.amazon.com/marketplace/saas/pp/B06XK299KV?ref=_splunk_awspartnerpage">Learn More</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </li>

          <li class="dropdown mega-menu-nav">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">AUTHORS
              <span class="caret"></span></a>
            <div class="dropdown-menu">
              <div class="container">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="mega-menu-heading-titleContainer">
                            <div class="mega-menu-heading-title splunk2-h5">Authors</div>
                            <div class="mega-menu-heading-title-icon close-icon">
                                <a href="#" class="splunk-icon icon-expanded-close-btn" id="Top_Nav-Close"></a>
                            </div>
                        </div>
                        <div role="separator" class="divider"></div>
                    </div>
                </div>
                <div class="row">
                  <div class="col-sm-9">
                    <div class="row">
                      <!-- /*Html will be rendered from globalhead.js */ -->
                      <div class="col-xs-4">	<ul class="mega-menu-list author-block">   <li>     <a href="/en_us/blog/author/dmerritt.html">         <img src="/content/splunk-blogs/en_us/author/dmerritt.thumb.png"/>Doug Merritt     </a>   </li>   <li>     <a href="/en_us/blog/author/ttully.html">         <img src="/content/dam/splunk-blogs/images/authors/default-author-image.jpg"/>Tim Tully     </a>   </li>   <li>     <a href="/en_us/blog/author/smcgovern.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/suzanne-mcgovern.jpg.thumb.png"/>Suzanne McGovern     </a>   </li>   <li>     <a href="/en_us/blog/author/ssellakumar.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/ssellakumar_square.jpg.thumb.png"/>Sendur Sellakumar     </a>   </li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list author-block">   <li>     <a href="/en_us/blog/author/gbassett.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/GrantBassett_1.jpg.thumb.png"/>Grant Bassett     </a>   </li>   <li>     <a href="/en_us/blog/author/jvida.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/jvida.jpg.thumb.png"/>Juliana Vida     </a>   </li>   <li>     <a href="/en_us/blog/author/ofriedrichs.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/ofriedrichs.jpg.thumb.png"/>Oliver Friedrichs     </a>   </li>   <li>     <a href="/en_us/blog/author/btalbot.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/btalbot.jpg.thumb.png"/>Bill Talbot     </a>   </li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list author-block">   <li>     <a href="/en_us/blog/author/kdeiglmeier.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/kriss_ deiglmeier_headshot.jpg.thumb.png"/>Kriss Deiglmeier     </a>   </li>   <li>     <a href="/en_us/blog/author/mmaier.html">         <img src="/content/splunk-blogs/en_us/author/mmaier.thumb.png"/>Matthias Maier     </a>   </li>   <li>     <a href="/en_us/blog/author/wemmett.html">         <img src="/content/splunk-blogs/en_us/author/wemmett.thumb.png"/>Bill Emmett     </a>   </li>   <li>     <a href="/en_us/blog/author/rogner.html">         <img src="/content/dam/splunk-blogs/images/author-profile-pics/rogner.jpg.thumb.png"/>Regan Ogner     </a>   </li>	<li class="mega-menu-spotlight">        <div class="splunk-button-aem">            <a class="splunk-btn sp-btn-borderless sp-btn-pink ga-cta" href="/en_us/blog/author.html">Browse All Authors...</a>        </div>	</li>	</ul></div><div class="col-xs-4">   <ul class="mega-menu-list author-block">	</ul></div>
                    </div>
                  </div>
                  <div class="col-sm-3 mega-menu-spotlight">
                    <div class="spotlight-img"><img alt="Author Spot Image" src="/content/dam/splunk2/images/spotlight/spot-light-promo-ebook-machine-data.jpg"/></div>
                    <div class="mega-menu-heading splunk2-eyebrow">E-book</div>
                    <div class="title splunk2-h5">The Essential Guide to Machine Data</div>
                    <p class="mega-menu-heading-description splunk-body">Unlock the secrets of machine data with our new guide</p>
                    <div class="splunk-button-aem">
                        <a class="splunk-btn sp-btn-borderless sp-btn-pink ga-cta" href="https://www.splunk.com/en_us/form/the-essential-guide-to-machine-data.html">Get the E-book</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </li>

          <li class="dropdown mega-menu-nav">
            <a href="/en_us/blog/subscribe.html" target="_parent" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false">SUBSCRIBE
              <span class="caret"></span></a>
          </li>
        </ul>

        <ul class="nav navbar-nav navbar-right">

          <li class="dropdown mega-menu-nav">
            <a href="#" class="dropdown-toggle search-icon" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
              <span class="splunk-icon icon-expanded-search-icon"></span>
              <span class="splunk-icon icon-expanded-close-btn"></span>
            </a>
            <div class="dropdown-menu">
              <div class="container">
                <div class="row">
                  <div class="input-group">
                    <form action="/en_us/blog/search.html" id="searchForm" method="get">
                      <input class="form-control mm-input" placeholder="Search Blogs" type="text" value="" id="query" name="query"/>
                      <span class="splunk-icon icon-expanded-search-icon form-control-feedback"></span>
                    </form>
                  </div>
                </div>
              </div>
            </div>

            <li>
              <div class="free-splunk">
                <a id="free-splunk-click-desktop" href="https://www.splunk.com/en_us/download.html" class="btn hidden-xs" data-toggle="modal">
                  Free Splunk
                </a>
              </div>
            </li>

        </ul>


      </div>
    </div>

  </nav>
</div>


<!-- /*Header Mobile Section Start*/-->
<div class="splunk-header-v3-mobile">
  <nav>
    <div class="header-main">
      <a href="https://www.splunk.com" class="logo">
        <img src="/content/dam/splunk-blogs/images/logos/splunk-logo.svg" alt="https://www.splunk.com" title=""/>
      </a>
      <a id="free-splunk-click-mobile" href="https://www.splunk.com/en_us/download.html" class="free-splunk-mobile" data-toggle="modal"> Free Splunk</a>
      <div class="hamburger-container collapsed" data-toggle="collapse" data-target="#header-collapse" aria-expanded="false">
        <div class="hamburger hamburger--spin" type="button">
            <span class="hamburger-box">
              <span class="hamburger-inner"></span>   
            </span>
          </div>
      </div>
    </div>
    <div class="header-collapse collapse" id="header-collapse">
      <div class="search">
        <form action="/en_us/blog/search.html" id="searchForm" method="get">
          <input type="text" placeholder="Search Blogs" name="query" value="" class="form-control" id="query"/>
          <span class="splunk-icon icon-expanded-search-icon"></span>
        </form>
      </div>
      <!-- /*menu title and list items */-->
      <div class="generic-menu-title darkened-menu-title collapsed site-title separator-bottom" data-toggle="collapse" data-target="#customers">
        <a href="https://www.splunk.com/blog">BLOGS</a>
      </div>
      <!-- /*END of menu title and list items */-->
      <!-- /*menu title and list items */-->
      <div class="generic-menu-title darkened-menu-title collapsed" data-toggle="collapse" data-target="#products">
        CATEGORIES
        <span class="glyphicon glyphicon-chevron-up"></span>
        <span class="glyphicon glyphicon-chevron-down"></span>
      </div>
      <div class="generic-menu-list darkened-menu-list collapse" id="products">
        <ul>
          <!-- /*Html will be rendered from globalhead.js  */-->
          		<li>			<a href="/en_us/blog/bulletins.html">Bulletins			</a>		</li>		<li>			<a href="/en_us/blog/conf-splunklive.html">.conf & SplunkLive!			</a>		</li>		<li>			<a href="/en_us/blog/customers.html">Customers & Community			</a>		</li>		<li>			<a href="/en_us/blog/devops.html">DevOps			</a>		</li>		<li>			<a href="/en_us/blog/industries.html">Industries			</a>		</li>		<li>			<a href="/en_us/blog/it.html">IT			</a>		</li>		<li>			<a href="/en_us/blog/leadership.html">Leadership			</a>		</li>		<li>			<a href="/en_us/blog/partners.html">Partners			</a>		</li>		<li>			<a href="/en_us/blog/platform.html">Platform			</a>		</li>		<li>			<a href="/en_us/blog/security.html">Security			</a>		</li>		<li>			<a href="/en_us/blog/splunk-for-good.html">Splunk for Good			</a>		</li>		<li>			<a href="/en_us/blog/splunklife.html">Splunk Life			</a>		</li>		<li>			<a href="/en_us/blog/tips-and-tricks.html">Tips & Tricks			</a>		</li>
        </ul>
      </div>
      

      <!-- /*menu title and list items */-->
      <div class="generic-menu-title darkened-menu-title collapsed" data-toggle="collapse" data-target="#solutions">
        <div class="separator-top"></div>
        AUTHORS
        <span class="glyphicon glyphicon-chevron-up"></span>
        <span class="glyphicon glyphicon-chevron-down"></span>
      </div>
      <div class="generic-menu-list darkened-menu-list collapse" id="solutions">
        <ul>
          <!-- /* Html will be rendered from globalhead.js  */-->
             <li>     <a href="/en_us/blog/author/dmerritt.html">Doug Merritt     </a>   </li>   <li>     <a href="/en_us/blog/author/ttully.html">Tim Tully     </a>   </li>   <li>     <a href="/en_us/blog/author/smcgovern.html">Suzanne McGovern     </a>   </li>   <li>     <a href="/en_us/blog/author/ssellakumar.html">Sendur Sellakumar     </a>   </li>   <li>     <a href="/en_us/blog/author/gbassett.html">Grant Bassett     </a>   </li>   <li>     <a href="/en_us/blog/author/jvida.html">Juliana Vida     </a>   </li>   <li>     <a href="/en_us/blog/author/ofriedrichs.html">Oliver Friedrichs     </a>   </li>   <li>     <a href="/en_us/blog/author/btalbot.html">Bill Talbot     </a>   </li>   <li>     <a href="/en_us/blog/author/kdeiglmeier.html">Kriss Deiglmeier     </a>   </li>   <li>     <a href="/en_us/blog/author/mmaier.html">Matthias Maier     </a>   </li>   <li>     <a href="/en_us/blog/author/wemmett.html">Bill Emmett     </a>   </li>   <li>     <a href="/en_us/blog/author/rogner.html">Regan Ogner     </a>   </li>	<li>        <div class="splunk-button-aem">            <a class="splunk-btn sp-btn-borderless sp-btn-pink ga-cta" href="/en_us/blog/author.html">Browse All Authors...</a>        </div>	</li>
        </ul>
      </div>
      

      
      <div class="generic-menu-title darkened-menu-title collapsed" data-toggle="collapse" data-target="#customers">
        <div class="separator-top"></div>
        <a href="/en_us/blog/subscribe.html" target="_parent">SUBSCRIBE</a>
      </div>
      

      <!-- /*menu title and list items */-->
      <div class="generic-menu-title collapsed" data-toggle="collapse" data-target="#splunksites">
        <div class="separator-top"></div>
        <span class="splunk-icon icon-expanded-splunk-sites-launchpad"></span> Splunk Sites
        <span class="glyphicon glyphicon-chevron-up"></span>
        <span class="glyphicon glyphicon-chevron-down"></span>
      </div>
      <div class="generic-menu-list collapse" id="splunksites">
        <ul>
          <li>
            <a href="https://answers.splunk.com/index.html" target="_blank">Answers</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/blog" target="_blank">Blogs</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/en_us/community.html" target="_blank">Community</a>
          </li>
        
          <li>
            <a href="https://conf.splunk.com" target="_blank">.conf</a>
          </li>
        
          <li>
            <a href="https://dev.splunk.com" target="_blank">Developers</a>
          </li>
        
          <li>
            <a href="https://docs.splunk.com/Documentation" target="_blank">Documentation</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/" target="_blank">Splunk.com </a>
          </li>
        
          <li>
            <a href="https://splunkbase.splunk.com/" target="_blank">Splunkbase</a>
          </li>
        
          <li>
            <a href="https://splunklive.splunk.com/" target="_blank">SplunkLive!</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/en_us/support-and-services.html" target="_blank">Support</a>
          </li>
        
          <li>
            <a href="https://www.splunk.com/en_us/training.html" target="_blank">Training</a>
          </li>
        
          <li>
            <a href="https://usergroups.splunk.com/" target="_blank">User Groups</a>
          </li>
        
          <li>
            <a href="/en_us/resources/videos.html" target="_blank">Splunk TV</a>
          </li>
        </ul>
      </div>
      <!-- /*END of menu title and list items */-->
    </div>
  </nav>
</div>


<script src="//account.splunk.com/sign-up/js/xcomponent.min.js"></script>
<script src="//account.splunk.com/sign-up/js/splunk-xcomponent.js" id="cx-xcomponent"></script>

<script src="/etc/clientlibs/splunk/splunk-core/source/js/vendor/jquery_cookie.js"></script>
<script src="/etc/clientlibs/splunk/splunk-com/source/js/mobile-detect.min.js"></script>
<script src="/etc/clientlibs/splunk/splunk-com/source/js/cx-form-iphone-fix.js"></script>
<script>
  var ssoid = $.cookie("WEBID");
  if (ssoid) {
    $.ajax({
      cache: false,
      url: "/bin/splunk/userSessionInfoServlet?sessionId=" + ssoid,
      dataType: "json",
      success: function (userinfo) {
        if (!userinfo.login_status) {
          loadExLaneForm();
        }
      },
      failure: function () {
        loadExLaneForm();
      }
    });
  } else {
    loadExLaneForm();
  }
  function loadExLaneForm() {
    var isMobile = false;
    if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)) {
      isMobile = true;
    }
    var md = new MobileDetect(window.navigator.userAgent);
    var dimensions = md.getOverlaySignupIframeSize();
    //Fix for WWW-437
    //update old-flow-mobile to new-flow-mobile
    $("#free-splunk-click-mobile").addClass("express-lane-open");
    //update old-flow-desktop to new-flow-desktop
    $("#free-splunk-click-desktop").addClass("express-lane-open");
    //add data-target value only for guest user
    $('#free-splunk-click-desktop, #free-splunk-click-mobile').attr('data-target','#iframe-modal');
    $('#iframe-modal').css('z-index','30000');
    /**
    * sign up form - express flow.
    */
    signupXcomponent.render({
      dimensions: {
        width: dimensions.width,
        height: dimensions.height
      },
      theme: "light",
      locale: "en_us",
      redirectUrl: "https:\/\/www.splunk.com\/en_us\/download.html",
      isMobile: isMobile,
      isQuickAccess: true,
      isRecaptcha: false,
      customProps: {
        leadSource: "splunk"
      },
      onSignup: function (data) {
        try {
          if (data.status == "close") {
            $("html").removeClass("iphone-fix");
            $("body").removeClass("iphone-fix");
          }
        } catch (e) {
          //do nothing
          console.log("no status to close");
        }
        nextAction(data);
      },
      isCloseButtonOn: true,
      title: "Get Started With Splunk",
      id: "header-signup-xcomp"
    }, '#header-signup-xcomp');
    $(".express-lane-open").click(function (e) {
      if ($(e.target).hasClass("express-lane-open")) {
        e.preventDefault();
        $("#header-signup-xcomp").animate({ "margin-right": '0px' });
      }
    });
  }

  // Hide iframe form on click of modal overlay
  $("#iframe-modal").click(function(){
    $(".overlay-form").animate({"margin-right": '-'+$('.overlay-form').width()+"px"});
    $("html").removeClass("iphone-fix stop-scrolling");
    $("body").removeClass("iphone-fix");
  });

  // Listener event to handle click event from iframe or child window
  var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
  var eventer = window[eventMethod];
  var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";

  // Listen to message from child window
  eventer(messageEvent,function(e) {
      var key = e.message ? "message" : "data";
      var data = e[key];
      //run function//
      console.log(data);
      if(data == "hide-signup-form") {
        $('#iframe-modal').modal('hide');
        $("html").removeClass("iphone-fix stop-scrolling");
        $("body").removeClass("iphone-fix");
        $(".overlay-form").animate({"margin-right": '-'+$('.overlay-form').width()+"px"});
      }
  },false);

  $("#free-splunk-click-desktop").click(function(){
      $('html').addClass('stop-scrolling');
  });
</script>
</div>
</div>
</div>


  </header>

  



<div>




</div>





<div class="blog-post">

	<!-- Start: blogpost Hero -->
    <div class="hero">
      <div class="background-image" style="background-image: url(/content/dam/splunk-blogs/images/2017/06/BOTS.png);"></div>
      <div class="background-blend-multiply" style="background-color:rgba(0,0,0,0.55);"></div>
      <div class="container main-container">
        <div class="row main-row">
          <div class="col-xs-12">
            <div class="blog-type splunk2-eyebrow">
              SECURITY
            </div>
            <h1 class="splunk2-h2 blog-title">
              Tall Tales of Hunting with TLS/SSL Certificates 
            </h1>
          </div>
        </div>
      </div>
    </div>
    <!-- End of blogpost hero -->
<!-- /* end: author blog list */-->
<!-- /* start: main content body */-->
<div class="main-body">
  <div class="container">
    <div class="row">
      <div class="col-sm-1 col-sm-offset-1">
        
          <div class="blog-post">
            <div class="social-band">
              <span class="social-band-title body-small">Share: </span>
              <ul>
                <li>
                  <!-- /*twitter supports title, url and hashtag */-->
                  <a class="twitter button-wrap social-icon" href="#" title="Share on Twitter" data-title="Tall Tales of Hunting with TLS/SSL Certificates " data-url="https://www.splunk.com/en_us/blog/security/tall-tales-of-hunting-with-tls-ssl-certificates.html" data-hashtag="#splunkBlogs">
                  </a>
                </li>
                <li>
                  <!-- /* facebook only support url, facebook will pull data from page url */-->
                  <a class="facebook button-wrap social-icon" href="#" title="Share on Facebook" data-title="Tall Tales of Hunting with TLS/SSL Certificates " data-url="https://www.splunk.com/en_us/blog/security/tall-tales-of-hunting-with-tls-ssl-certificates.html">
                  </a>
                </li>
                <li>
                  <!-- /* linkedIn only supports url linkedin will pull data from page url */-->
                  <a class="linkedin button-wrap social-icon" href="#" title="Share on LinkedIn" data-title="Tall Tales of Hunting with TLS/SSL Certificates " data-url="https://www.splunk.com/en_us/blog/security/tall-tales-of-hunting-with-tls-ssl-certificates.html">
                  </a>
                </li>
              </ul>
            </div>
          </div>

        
      </div>
      <div class="col-sm-9">
        <div class="blog-postdate">
               <span><a href="/en_us/blog/author/rkovar.html" title="">
                 <img src="/content/dam/splunk-blogs/images/authors/rkovar" alt="Ryan Kovar"/>
                 </a> By  <a class="author-name" href="/en_us/blog/author/rkovar.html" title="">Ryan Kovar</a> December 11, 2017
               </span>
        </div>
        <div class="copy-content splunk-body">
          
          <div data-emptytext="Blogs details page content">
            <p><i>&nbsp; &nbsp; &nbsp;&nbsp;</i></p>
<p><i>This is part twelve of the &quot;<a href="https://www.splunk.com/blog/2017/07/06/hunting-with-splunk-the-basics.html">Hunting with Splunk: The Basics</a>&quot; series. I've wanted to work on SSL hunting with Splunk ever since I saw my friend @markpars0ns present on the idea at a security conference in 2016. I hope you enjoy - <a href="https://www.splunk.com/blog/author/rkovar.html" target="_blank">Ryan Kovar</a></i></p>
<p>Recently, my beloved colleague <a href="https://www.splunk.com/blog/author/sbrant.html" target="_blank">Steve Brant</a> and I presented &quot;<a href="http://conf.splunk.com/sessions/2017-sessions.html#search=hunting%20the%20known&amp;" target="_blank">Hunting the Known Unknowns: Finding Evil With SSL Traffic</a>&quot;&nbsp;at <a href="https://conf.splunk.com/resources/2017/on-demand.html" target="_blank">.conf2017</a>. Turns out it was an extremely popular talk with over 500 attendees. However, not everyone has time to work their way through 120+ slides and 50 minutes of two bearded gentlemen mumbling and bumbling their way through a talk, so we thought we would synthesize the content down<span class="alignright"><img src="/content/dam/splunk-blogs/images/2017/12/tall-tales-hunting-ssl.jpg" alt="Tall Tales Hunting SSL" style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 12px;">&nbsp;</span>&nbsp;to one or two blog posts. This blog post will specifically focus on how to use SSL certificate information to find evil in your network! Look forward to a new post by Steve Brant coming out soon on JA3.</p>
<h3>Why should I care about hunting with SSL certificates?</h3>
<p><i>First though, let's clear up a couple things.&nbsp; This is not going to be a complicated discussion of the cryptographic innards of TLS and SSL. Furthermore, for those of you who are as pedantic as <a href="http://www.thanksbrodsky.com/" target="_blank">James</a> or <a href="https://www.splunk.com/content/dam/splunk-blogs/images/author-profile-pics/DavidVeuve_resized.png" target="_blank">David</a> (you know who you are!)—yes, I use the abbreviation SSL interchangeably with TLS. Why? Because I am an elderly security dude and TLS is just the newest version of SSL. So there. If this is a problem, please feel free to think poorly of me. There is a fan club: </i><a href="http://www.peoplewhohateryankovar.club/" target="_blank"><i>http://www.peoplewhohateryankovar.club/</i></a><i>… you can join. :-) Finally, if you want more in-depth SSL hunting info, check out our </i><a href="http://conf.splunk.com/sessions/2017-sessions.html#search=hunting%20the%20known&amp;" target="_blank"><i>.conf2017</i></a><i> session. Okay, MOVING ON.</i></p>
<p>Just like banks, airlines and every other industry, advanced adversaries are moving to SSL encrypted communications to evade detection by our tribe of network defenders. Five years ago, we could decode PoisonIvy C2 communications via clear text HTTP! Fast forward to today and now the baddies cavalierly use SSL encryption to hide their PowerShell Empire connections as they run rampant in our networks like Roundheads chasing Royalists! However, all is not doom and gloom for blue teamers:</p>
<ol>
<li>Adversaries (like me) are lazy</li>
<li style="padding-top: 10px;">SSL has unencrypted information that you can pivot with via Splunk</li>
</ol>
<p style="padding-top: 30px;">This blog post only covers what to do *if* you have captured SSL metadata in Splunk. If you DON'T, check out our <a href="http://conf.splunk.com/sessions/2017-sessions.html#search=hunting%20the%20known&amp;" target="_blank">.conf2017 session</a>&nbsp;to learn how. :-)</p>
<h3>What is this unencrypted information that SSL leaves?&nbsp;</h3>
<p>A very succinct definition of TLS/SSL certificates are “small [unencrypted] data files that digitally bind a&nbsp;<a href="https://www.globalsign.com/en/ssl-information-center/choosing-safe-key-sizes/" title="Choosing Safe Key Sizes" target="_blank">cryptographic key</a>&nbsp;to an organization’s details.”&nbsp;<sup>[1]</sup> This is a huge deal for blue teamers because the information in these certificates are static and can be tracked.</p>
<p><img src="/content/dam/splunk-blogs/images/2017/12/splunk-tsl-ssl-certificate.jpg" alt="Splunk TSL/SSL certificate" class="aligncenter"></p>
<p>These fields are either generated by ciphers and algorithms used to create the certificate or by manual input at the time of the cert creation. How does this help you? Because these fields can be unique and are often shared by adversaries across their backend infrastructure. So… what are some unique fields? The ones that we are primarily interested in are: <i>ssl_cert_self_signed, ssl_subject_country, ssl_subject_state, ssl_issuer, ssl_subject_locality, ssl_subject_unit, ssl_subject_organization, ssl_validity_end, ssl_subject_common_name, ssl_serialnumber, and ssl_cert_sha1. </i>But honestly… almost every field that you can extract from the SSL certificate is of interest.</p>
<h3>What do we do with the fields when we have them?</h3>
<p>Let’s start with the basics. A commonly held belief is that malware often uses unusual ports to communicate. Since we have a hypothesis that malware is beginning to use SSL to encrypt its communications, I believe it is reasonable to assume that they would use SSL to encrypt communication on alternative ports! For nearly all the following examples, we will be using SSL data captured in Stream. Let’s look:</p>
<pre>
sourcetype=stream:tcp ssl_cert_sha1=* NOT (dest_port=443 OR dest_port=993 OR dest_port=995 OR dest_port=465 OR dest_port=9001) 
 | stats VALUES(ssl_issuer) VALUES(dest_port) VALUES(ssl_subject_common_name) VALUES(dest_ip) count(ssl_subject_common_name) BY ssl_cert_sha1
</pre>
<p><img src="/content/dam/splunk-blogs/images/2017/12/tls3.png" class="aligncenter"></p>
<p>BOOM! You’ll notice the 3<sup>rd</sup> and 4<sup>th</sup> entry have very suspicious metadata and link to some nasty looking domains and IP addresses. A quick pivot to VirusTotal shows that there have been malicious files hosted on that IP address in the past:</p>
<p><img src="/content/dam/splunk-blogs/images/2017/12/tls4.png" class="aligncenter"><br>
<br>
For our next search, let’s try and find values in SSL certificates that are unique. We will do a little pre-parsing by showing only SSL certificates that are not part of the <a></a><a href="http://s3.amazonaws.com/alexa-static/top-1m.csv.zip" target="_blank">Alexa 1 Million top sites</a>. This is done with the UT_PARSE macro (which you can install with&nbsp;<a href="https://splunkbase.splunk.com/app/2734/" target="_blank">URL Toolbox</a>) and the Alexa 1 Million list.&nbsp;<a>You can download a sample of Alexa 1 Million from my </a><a href="https://github.com/rkovar/splunk-hunting-helpers/tree/master/conf2017_SSL_talk" target="_blank">github</a> as a properly formatted lookup table.</p>
<pre>
sourcetype=stream:tcp ssl_cert_sha1=*
 | stats VALUES(ssl_issuer) AS ssl_issuer VALUES(ssl_subject_common_name) AS ssl_subject_common_name VALUES(dest_ip) AS dest_ip count(ssl_subject_common_name)&nbsp; AS count BY ssl_cert_sha1
 | search count=1
 | eval list=&quot;*&quot;
 |`ut_parse(ssl_subject_common_name,list)`
 | lookup alexa-1MM domain AS ut_domain
 | fillnull value=NULL rank
 | search rank=NULL
 | stats VALUES(ssl_cert_sha1) VALUES(ssl_subject_common_name) AS ssl_subject_common_name VALUES(dest_ip) AS dest_ip values(ut_domain) AS ut_domain count(ssl_subject_common_name)&nbsp; AS count BY ssl_issuer
</pre>
<p><img src="/content/dam/splunk-blogs/images/2017/12/tls5.png" class="aligncenter"><br>
Right away we see some very odd values in the <i>ssl_issuer</i> and <i>ssl_subject_common_name</i> fields. If we search for that SHA1 certificate value (ssl_cert_sha1) in google we find that various websites have identified that SHA1 hash as malicious.</p>
<p><img src="/content/dam/splunk-blogs/images/2017/12/tls6.png" class="aligncenter"></p>
<p>Finally, what about detecting certificates that are “known bad”? The most common repository of externally identified certificates is from <a href="https://sslbl.abuse.ch/" target="_blank">https://sslbl.abuse.ch</a><a href="https://sslbl.abuse.ch/">/</a>.&nbsp; With minimal effort, you can turn that list of malicious SHA1 SSL certificates into a lookup table in Splunk. The example below assumes that you have done that already, but if you want an example, check out my <a href="https://github.com/rkovar/splunk-hunting-helpers/tree/master/conf2017_SSL_talk" target="_blank">github</a> and download the ssl_blacklist_2.csv file.&nbsp;</p>
<pre>
index=* sourcetype=stream:tcp ssl_cert_sha1=*
 | lookup ssl_block_list sha1_cert AS ssl_cert_sha1 
 | search reason=*
 | stats VALUES(ssl_issuer) AS issuer VALUES(dest_port) AS &quot;Destination Port&quot; VALUES(ssl_subject_common_name) AS &quot;Subject Common Name&quot;&nbsp; VALUES(reason) AS Reason&nbsp; VALUES(ssl_cert_sha1) AS SHA1 count(ssl_cert_sha1) AS count by dest_ip
</pre>
<p><img src="/content/dam/splunk-blogs/images/2017/12/tls7.png"></p>
<p>The results below show that we have five hits against our data and a quick explanation of each malicious certificate.&nbsp;</p>
<h3>Now what?!?!</h3>
<p>Finding malicious SSL/TLS in your environment is just the first step. Just like finding malicious IP addresses or file hashes you will need to pivot and research using tools like <a href="https://community.riskiq.com/" target="_blank">www.passivetotal.com</a>, <a href="http://www.censys.io" target="_blank">www.censys.io</a>, and <a href="https://www.circl.lu/services/passive-ssl/" target="_blank">https://www.circl.lu/services/passive-ssl/</a>. Once you understand how to use these certificates, try creating workflow actions in Splunk to pivot “automagically”. If you’d like an example, check out my sample workflow action for <a href="http://www.censys.io" target="_blank">www.censys.io</a> located on my <a href="https://github.com/rkovar/splunk-hunting-helpers/blob/master/conf2017_SSL_talk/workflow_actions.conf" target="_blank">github page</a>. If you are interested in more information on hunting and pivoting with TLS certificates, check out this great talk from my good friend Mark Parsons (<a href="https://twitter.com/markpars0ns" target="_blank">@markpars0ns</a>) on <a href="https://medium.com/@mark.parsons/hunting-a-tls-certificate-series-post-1-6ad7adfebe44" target="_blank">hunting a TLS certificate</a>. Until then…</p>
<p>Happy Hunting! :-)</p>
<p><sup>[1] <a href="https://www.godaddy.com/help/what-is-an-ssl-certificate-542">https://www.godaddy.com/help/what-is-an-ssl-certificate-542</a></sup></p>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- /* end: main content body */-->


<!-- ======== parsys obersvability  ============ -->

<!-- /* start: author bio blurb */-->
<div class="author-intro">
  <div class="container">
    <div class="row">

      <div class="col-sm-4 col-sm-offset-1">
        <div class="author-image">
          <img src="/content/dam/splunk-blogs/images/authors/rkovar" alt="Ryan Kovar"/>
        </div>
        <div class="author-handle">
          <div class="splunk2-eyebrow">Posted by</div>
          <h4 class="splunk2-h5"><a href="/en_us/blog/author/rkovar.html" class="author-name splunk2-color splunk-black">Ryan Kovar</a></h4>
          <!-- /* start: social band, links only */-->
          <div class="author-blurb">
            <div class="social-band">
              <ul>
                <li>
                  <!-- /* supports title, url and hashtag */-->
                  <a class="twitter button-wrap social-icon" href="https://twitter.com/meansec" target="_blank">
                  </a>
                </li>
              </ul>
            </div>
          </div>
          <!-- /* end: social band, links only */-->
        </div>
      </div>

      <div class="col-sm-6">
        <div class="author-description body-small">
          <p>NY. AZ. Navy. SOCA. KBMG. DARPA. Splunk.</p>

        </div>
      </div>

    </div>
  </div>
</div>
<!-- /*end: author bio blurb */-->
<!-- this is optional only need more changes -->


<!-- /*Start: Comments/Discussion section */-->
<div class="comments">
  <div class="container">
    <div class="row">
      <div class="col-xs-12">
        <h4 class="splunk2-h3">Join the Discussion</h4>
        
        <div id="disqus_thread"></div>
        <script>
          (function () { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = '//splunk-blogs.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
          Disqus.</a></noscript>
        <script id="dsq-count-scr" src="//splunk-blogs.disqus.com/count.js" async></script>
        <!-- /* End: disqus comments plugin */-->
      </div>
    </div>
  </div>
</div>
</div>
<!-- /* End: Comments/Discussion section */-->

<script src="/etc/clientlibs/splunk/splunk-blogs/dist/js/rteImage.js"></script>
<script async defer src="//platform.instagram.com/en_US/embeds.js"></script>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

  <!-- /* start: footer section */-->
  <footer class="splunk-footer fat-footer splunk-footer-v2" id="footer">
      	


<div class="section"><div class="new"></div>
</div><div class="iparys_inherited"><div class="footerIParsys iparsys parsys"><div class="globalfooter parbase section">

<!-- /*start: footer section */ -->
  
    <div class="section">
    <div class="container">
        <div class="row">
            <div class="footer-links-v2 clearfix container responsive-padding">
                
                <div class="col-sm-8">
                    <div class="top-footer-block-container inverted">
                        <div class="top-footer-block">
                            <a href="https://www.splunk.com/en_us/newsroom.html" target="_blank">
                                <span class="splunk-icon icon-splunk-newspaper"> </span>
                                News 
                            </a>
                        </div>
                        <div class="top-footer-block">
                            <a href="https://www.splunk.com/en_us/about-us/events.html" target="_blank ">
                                <span class="splunk-icon icon-splunk-events-icon"> </span>
                                Events 
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4"></div>
                <div class="col-sm-12">
                    <div class="footer-line-separator"></div> 
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="clearfix container responsive-padding">
            <div class="col-sm-1"></div>
            <div class="col-sm-2 main-blocks">
                <button class="splunk-body inverted footer-category-title collapsed" role="button" data-toggle="collapse" data-target="#products-mobile-dropdown" aria-expanded="false">Splunk on Twitter
                    <span class="splunk-icon icon-chevron-down"></span>
                    <span class="splunk-icon icon-chevron-up"></span>
                </button>
                <nav>
                    <ul class="footer-links-v2 ul-bottom-padding collapse" id="products-mobile-dropdown">
                         <li>
                             <a href="https://twitter.com/splunk" target="_blank">@Splunk</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkanswers" target="_blank">@splunkanswers</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkdev" target="_blank">@splunkdev</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkUK" target="_blank">@SplunkUK</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkDE" target="_blank">@SplunkDE</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkGov" target="_blank">@SplunkGov</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkforgood" target="_blank">@SplunkforGood</a>
                         </li>  
                    
                         <li>
                             <a href="https://twitter.com/splunkdocs" target="_blank">@SplunkDocs</a>
                         </li>  
                    </ul>
                </nav>
            </div>
            <div class="col-sm-3 main-blocks">
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#facebook-mobile-dropdown">Splunk on Facebook
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="facebook-mobile-dropdown">
                       <li>
                           <a href="https://www.facebook.com/splunk" target="_blank">Like us on Facebook</a>
                       </li>
                    
                       <li>
                           <a href="https://www.facebook.com/splunkuniversityjobs" target="_blank">Like Splunk University on Facebook</a>
                       </li>
                    </ul>
                </nav>
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#slideshare-mobile-dropdown">Splunk on SlideShare
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="slideshare-mobile-dropdown">
                       <li>
                           <a href="https://www.slideshare.net/Splunk" target="_blank">Follow us on SlideShare</a>
                       </li>
                    </ul>
                </nav>
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#instagram-mobile-dropdown">Splunk on Instagram
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="instagram-mobile-dropdown">
                        <li>
                            <a href="https://www.instagram.com/splunk/" target="_blank">Follow us on Instagram</a>
                        </li>
                    </ul>
                </nav>
            </div>
            <div class="col-sm-3 main-blocks">
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#linkedin-mobile-dropdown">Splunk on LinkedIn
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="linkedin-mobile-dropdown">
                        <li>
                            <a href="https://www.linkedin.com/company/splunk" target="_blank">Follow us on LinkedIn</a>
                        </li>  
                    
                        <li>
                            <a href="https://www.linkedin.com/showcase/-conf-splunk-worldwide-users%27%E2%80%8B-conference/" target="_blank">Follow .conf on LinkedIn</a>
                        </li>  
                    </ul>
                </nav>
                <button class="splunk-body inverted footer-category-title collapsed" role="button" aria-expanded="false" data-target="#youtube-mobile-dropdown">Splunk on YouTube
                  
                </button>
                <nav>
                    <ul class="ul-bottom-padding footer-links-v2 " id="youtube-mobile-dropdown">
                         <li>
                             <a href="https://www.youtube.com/user/splunkvideos" target="_blank">Subscribe to our Channel</a>
                         </li>
                    </ul>
                </nav>
            </div>
            <div class="col-sm-2 main-blocks splunk-sites">
                <button class="splunk-body inverted footer-category-title collapsed" role="button" data-toggle="collapse" data-target="#sites-mobile-dropdown" aria-expanded="false">SPLUNK SITES
                    <span class="splunk-icon icon-chevron-down"></span>
                    <span class="splunk-icon icon-chevron-up"></span>
                </button>
                <nav>
                    <ul class="footer-links-v2 collapse" id="sites-mobile-dropdown">
                        <li>
                            <span><a href="https://answers.splunk.com/index.html" target="_blank"> Answers</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.splunk.com/en_us/community.html" target="_blank"> Community</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://conf.splunk.com/" target="_blank"> .conf</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://dev.splunk.com/" target="_blank"> Developers</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://docs.splunk.com/Documentation" target="_blank"> Documentation</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.splunk.com" target="_blank"> Splunk.com</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://splunkbase.splunk.com/" target="_blank"> Splunkbase</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://splunklive.splunk.com/" target="_blank"> SplunkLive!</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.mylogocloud.com/splunk" target="_blank"> T-Shirt Store</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.splunk.com/en_us/support-and-services.html" target="_blank"> Support</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://www.splunk.com/en_us/training.html" target="_blank"> Training</a></span>
                        </li>                        
                    
                        <li>
                            <span><a href="https://usergroups.splunk.com/" target="_blank"> User Groups</a></span>
                        </li>                        
                    </ul>
                </nav>
            </div>
            <div class="col-sm-1"></div>
        </div>
        <div class="copyright-section container">
            <div class="map-links map-links-social">
                <div class="splunk-footer-logo">
                    <a href="https://www.splunk.com">
                        <img class="footer-logo" src="/content/dam/splunk-blogs/images/logos/splunk-logo.svg" alt="Splunk" title=""/>
                   </a>
                </div>
               <div class="footer-links-v2">
                    <div class="top-footer-block-container social-icons">
                        <a href="https://twitter.com/splunk" target="_blank"><span class="splunk-icon icon-expanded-splunk-twitter first-social-icon first-social-icon"></span></a>
                    
                        <a href="https://www.facebook.com/splunk" target="_blank"><span class="splunk-icon icon-expanded-splunk-facebook first-social-icon "></span></a>
                    
                        <a href="https://www.linkedin.com/company/splunk" target="_blank"><span class="splunk-icon icon-expanded-splunk-linkedIn first-social-icon "></span></a>
                    
                        <a href="https://www.instagram.com/splunk/" target="_blank"><span class="splunk-icon icon-expanded-splunk-instagram first-social-icon "></span></a>
                    
                        <a href="https://www.youtube.com/user/splunkvideos" target="_blank"><span class="splunk-icon icon-expanded-splunk-youtube first-social-icon "></span></a>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 map-links">
                <span class="copyright">© 2005-2021 Splunk Inc. All rights reserved. </span>
                <ul>
                    <li>
                        <a href="https://www.splunk.com/en_us/site-map.html" target="_blank">Sitemap</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/about-splunk/contact-us.html#tabs/tab_parsys_tabs_OfficeLocations_1" target="_blank">Contact</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/careers.html" target="_blank">Careers</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/legal/privacy/privacy-policy.html" target="_blank">Privacy</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/legal/terms/terms-of-use.html" target="_blank">Terms of Use</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/en_us/legal/export-controls.html" target="_blank">Export Control</a>|
                    </li>
                
                    <li>
                        <a href="https://www.splunk.com/pdfs/legal/splunk-modern-slavery-act-transparancy-statement.pdf" target="_blank">Modern Slavery Statement</a>
                    </li>
                </ul>
                <div class="copyright-links"><span>Splunk, Splunk&gt; and Turn Data Into Doing are trademarks or registered trademarks of Splunk Inc. in the United States and other countries. All other brand names, product names, or trademarks belong to their respective owners.</span></div>
            </div>
        </div>
    </div>
</div>
  
  <!-- /*end: footer section */--></div>
<div class="reference parbase section"><div class="cq-dd-paragraph"><div class="htmlcomp parbase"><a></a>


<section>
    
    <!-- OneTrust Cookies Consent Notice start -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="9ff638b7-8097-449d-9741-7b3c526b0da7"></script>
<script type="text/javascript">
function OptanonWrapper() { window.dataLayer.push( { event: 'OneTrustGroupsUpdated' } ) ; }
</script>
<!-- OneTrust Cookies Consent Notice end -->
  </section>

</div>
</div>
</div>
</div>
</div>

  </footer>

        




    
<script type="text/javascript" src="/etc/clientlibs/splunk/splunk-blogs/dist.f4071053bb3ec30c664b53414ca17b21.js"></script>




        

    </body>
</html>
