
<!DOCTYPE HTML>
<html lang="en" data-template="post-page teal-layer">
<head>
    <meta charset="UTF-8"/>
    <title>Another Metamorfo Variant Targeting Customers of Financial Institutions in More Countries</title>
    <meta name="keywords" content="financial services,windows,Threat Research,Cybersecurity Architect"/>
    <meta name="description" content="Read about the malware family of the Metamorfo targeting financial organizations, in this analysis from FortiGuard Labs."/>
    <meta name="template" content="post-page"/>
    

    <meta name="viewport" content="width=device-width, initial-scale=1"/>


<meta name="google-site-verification" content="tiQ03tSujT2TSsWJ6tNHiiUn8cwYVmdMQrGUCNrPQmo"/>

<meta property="og:site_name" content="Fortinet Blog"/>
<meta property="og:title" content="Another Metamorfo Variant Targeting Customers of Financial Institutions in More Countries"/>
<meta property="og:url" content="https://www.fortinet.com/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions.html"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Read about the malware family of the Metamorfo targeting financial organizations, in this analysis from FortiGuard Labs.…"/>
<meta property="og:image" content="https://www.fortinet.com/content/dam/fortinet-blog/article-images/metamorfo-blog/Metamorfo1.png"/>

<meta property="twitter:card" content="summary"/>
<meta property="twitter:site" content="@Fortinet"/>

<meta property="article:author" content="Xiaopeng Zhang"/>

    <meta property="article:section" content="Threat Research"/>


    <meta property="article:published_time" content="2020-02-04T00:00:00.000-08:00"/>


    <meta property="article:tag" content="financial services"/>

    <meta property="article:tag" content="windows"/>

    <meta property="article:tag" content="Cybersecurity Architect"/>


<link rel="shortcut icon" href="/etc/designs/fortinet-blog/favicon.ico"/>


    
<link rel="stylesheet" href="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.css" type="text/css">






<!-- SEO Script -->




<!-- OneTrust Cookies Consent Notice start for fortinet.com -->



    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="f85f39fc-d7aa-467a-b762-fbb722748016"></script>
    <script type="text/javascript">

function OptanonWrapper() {
    {
       try{
            $('#cookiescript_injected').remove(); // remove old cookie script
        }catch(e){}
        window.dataLayer.push({
            event: 'OneTrustGroupsUpdated'
        });
        Optanon.InsertScript('//assets.adobedtm.com/launch-EN23cb8375449840dc93b13f34d935b8b9.min.js','head',null, null, '1',true);
    }
}

</script>


<!-- OneTrust Cookies Consent Notice end for fortinet.com -->
    
    
    

    
    

    
    
    
    

    

    

    

    

    

</head>
<body>





<div class="root responsivegrid">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="b1-header aem-GridColumn aem-GridColumn--default--12">


<header class="b1-header__container">
    <div class="b1-header__logo">
        <a href="https://www.fortinet.com">
            
            <img class="desktop-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Another Metamorfo Variant Targeting Customers of Financial Institutions in More Countries"/>
            <img class="mobile-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Another Metamorfo Variant Targeting Customers of Financial Institutions in More Countries"/>
        </a>
    </div>

    <div class="b1-header__cta-list">
      <a class="b1-header__cta-list-item " href="https://www.fortinet.com/blog">
          <span>Blog</span>
      </a>
    </div>

    <div class="b1-header__nav"><div class="b2-navigation">




    <ul class="b2-navigation__list">
        
            <li class="b2-navigation-categories"><div class="b2-navigation__list-item nav-dropdown-title">Categories</div>
                <ul class="navdropdown">
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/business-and-technology">
                                <span>Business &amp; Technology </span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/threat-research">
                                <span>Threat Research</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/industry-trends">
                                <span>Industry Trends</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/partners">
                                <span>Partners</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/customer-stories">
                                <span>Customer Stories</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/psirt-blogs">
                                <span>PSIRT Blogs</span>
                            </a>
                        </li>
                    
                </ul>
            </li>

        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/business-and-technology">
                    <span>Business &amp; Technology </span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/threat-research">
                    <span>Threat Research</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/industry-trends">
                    <span>Industry Trends</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/partners">
                    <span>Partners</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/customer-stories">
                    <span>Customer Stories</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/psirt-blogs">
                    <span>PSIRT Blogs</span>
                </a>
            </li>
        
        
        
            <li>
                <a class="b2-navigation__list-item false" href="/blog/ciso-collective">
                    <span>CISO Collective</span>
                </a>
            </li>
        
    </ul>


    

</div>
</div>

    <div class="b1-header__search"><div class="b3-searchbox">


<form class="b3-searchbox__form" action="/blog/search" method="get">
    <input class="b3-searchbox__input" type="text" name="q" placeholder="Search Blogs"/>
    <button class="b3-searchbox__icon" aria-label="Search" type="submit">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z" fill="#fff">
        </path>
    </svg>

    </button>
</form>


    

</div>
</div>

    <div class="b1-header__search-toggle">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z">
        </path>
    </svg>

        <div class="b1-header__search-toggle-close">
            <span class="b1-header__search-toggle-close-line"></span>
            <span class="b1-header__search-toggle-close-line"></span>
        </div>
    </div>

    <div class="b1-header__nav-toggle" aria-hidden="true">
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
    </div>
</header>

    

</div>
<section class="b4-hero aem-GridColumn aem-GridColumn--default--12">



<div class="b4-hero__container" style="background-image:url(/content/dam/fortinet-blog/article-images/metamorfo-blog/Metamorfo1.png);">
    <img class="ratio" alt="Another Metamorfo Variant Targeting Customers of Financial Institutions in More Countries" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
    <div class="b4-hero__text text-container">
        <p data-ly-test class="b4-hero__kicker">Threat Research</p>
        
        
        <h1 class="b4-hero__headline">Another Metamorfo Variant Targeting Customers of Financial Institutions in More Countries</h1>
        
    </div>
</div>
</section>
<section class="b15-blog-meta aem-GridColumn aem-GridColumn--default--12">

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                              <a href="/blog/search?author=Xiaopeng+Zhang">Xiaopeng Zhang</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | February 04, 2020</span>
</div>
</section>
<div class="responsivegrid aem-GridColumn aem-GridColumn--default--12">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="cmp cmp-image aem-GridColumn aem-GridColumn--default--12">


    

</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p><b><a href="https://www.fortinet.com/fortiguard/labs.html?utm_source=blog&amp;utm_medium=campaign&amp;utm_campaign=FortiGuardLabs">FortiGuard Labs</a> Threat Analysis</b></p>
<p> </p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Affected platforms:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Windows<br />Impacted parties:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Online Financial Institutions<br />Impact:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;Theft of financial information</span></p> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Severity level: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; High</span></p></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Metamorfo is a malware family that was observed targeting the customers of online financial institutions. Recently, FortiGuard Labs captured two different Metamorfo variants. We have already published an <a href="https://www.fortinet.com/blog/threat-research/analysis-metamorfo-variant-targets-financial-organizations.html" style="">analysis blog</a><span style=""> for the first, which only targets the customers of Brazilian financial institutions. </span><br />
</p>
<p>This second Metamorfo variant targets the customers of even more financial institutions across multiple countries. In this post you can see how it infects the machines of its victims and what it is able to do on a victim’s machine, including how it collects data and communicates with its command and control (C&amp;C) server, as well as what C&amp;C commands it supports.</p>
<h2>Starting from the Captured Sample </h2>
<p>The captured sample used in this analysis is an MSI file named “view-(AVISO)2020.msi” that is spread through a ZIP archive, just as with the previous variant. In the previous analysis, I showed that this MSI file is parsed and executed automatically by MsiExec.exe when a user double clicks on it in Windows OS.</p>
<p>Analyzing this latest MSI file, I discovered that it also has a stream with the same name –“!_StringData” – where I found a piece of JavaScript code that had been mixed in with a huge amount of garbage strings. After I extracted and de-obfuscated the JavaScript code, it was easy to see what the code does. Figure 1 is a code snippet that shows the key functions of that JavaScript code being used.</p>
<p> </p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--12 aem-GridColumn--offset--default--0">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            <img src="/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions/_jcr_content/root/responsivegrid/image_699478850.img.png/1580748141383/metamorfo1.png" alt="Figure 1. JavaScript code snippet extracted from the stream “!_StringData“"/>
        </noscript>
    
    <span class="cmp-image--title">Figure 1. JavaScript code snippet extracted from the stream “!_StringData“</span>


    

</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>It downloads a file from the URL &quot;hxxp[:]//www[.]chmsc[.]edu[.]ph/library/modules/down/op57.lts&quot;, which is actually a ZIP file containing three files. It then gets decompressed into a newly-created random string folder (in this case, “RrRbiebL”) under “C:\”. Also, the three decompressed files are renamed with random strings, which in this analysis were “cMejBlQe.exe”, “M6WnYxAh” and “YvSVUyps.dll”.  Figure 2 shows the folder information.</p>


</div>
<div class="cmp cmp-image aem-GridColumn aem-GridColumn--default--12">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            <img src="/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions/_jcr_content/root/responsivegrid/image_1440546402.img.png/1580748245916/metamorfo2.png" alt="Figure 2. Three decompressed files in a random name folder"/>
        </noscript>
    
    <span class="cmp-image--title">Figure 2. Three decompressed files in a random name folder</span>


    

</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>These three files are executed in the command line: &quot;C:\RrRbiebL\cMejBlQe.exe   C:\RrRbiebL\M6WnYxAh C:\RrRbiebL\YvSVUyps.dll”. You may have noticed in Figure 1 that it also added itself into the auto-run group in the victim’s system registry. This ensure that it runs automatically whenever the infected system starts. Figure 3 is a screenshot of the auto-run item in the system registry, whose value is just the above command line.</p>


</div>
<div class="cmp cmp-image aem-GridColumn aem-GridColumn--default--12">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            <img src="/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions/_jcr_content/root/responsivegrid/image_2096620880.img.png/1580748302635/metamorfo3.png" alt="Figure 3. Added into auto-run group in the system registry"/>
        </noscript>
    
    <span class="cmp-image--title">Figure 3. Added into auto-run group in the system registry</span>


    

</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>AutoIt Script Runs Metamorfo</h2>
<p>“C:\RrRbiebL\cMejBlQe.exe” is run with the parameters “C:\RrRbiebL\M6WnYxAh C:\RrRbiebL\YvSVUyps.dll”. Through my analysis I learned that the file “cMejBlQe.exe” is an AutoIt script execution program, whose original name was “AutoIt3.exe”. The file “M6WnYxAh” is a compiled binary AutoIt script file (i.e. “.A3X” file), and “YvSVUyps.dll” includes the major body of this Metamorfo variant.</p>
<p><a href="https://www.autoitscript.com/site/">AutoIt</a> has been observed being abused by a number of malware families for malicious purposes in the past. The reason for using AutoIt could be to bypass antivirus detection.</p>
<p>Decompiling the file “M6WnYxAh” reveals its source code:</p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">SLEEP(2000)</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">_SLEEP(2000)</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">SLEEP(2000)</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">_SLEEP(2000)</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">GLOBAL $NPYVKYZFH1Z9T8E5CL48UGNZ878HTHO91S63AH=$CMDLINE[1]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">GLOBAL $KPH98S477U6K32TXPN3F8UBVSHZ=<span style="color: red;">DLLOPEN</span>($NPYVKYZFH1Z9T8E5CL48UGNZ878HTHO91S63AH)</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; color: red; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">DLLCALL</span></em><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">($KPH98S477U6K32TXPN3F8UBVSHZ,"Int","<span style="color: red;">B1OWOEFK3SBYS0ETX4XXHRNV7SZGYFTU</span>")</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">FUNC _SLEEP($IDELAY)</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DLLCALL("Kernel32.dll","none","Sleep","dword",$IDELAY)</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">ENDFUNC</span></em></p></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>It pauses 8 seconds at first. Then it loads a DLL file from the path $CMDLINE[1], which is the last parameter in the command line; i.e. “C:\RrRbiebL\YvSVUyps.dll”. It continues to call an export function of the DLL file named “<i>B1OWOEFK3SBYS0ETX4XXHRNV7SZGYFTU</i>”. After that, the infected victim machine is controlled by the DLL code.</p>
<h2>Analysis of the Main Part of Metamorfo</h2>
<p>Let’s now take a look at the file “YvSVUyps.dll”. From Figure 4, we can see that the DLL file is protected by the packer “VMProtect v3.00-3.3.1”. VMProtect is a very strong packer that supports dynamic code protection when the target process is running. This creates a big challenge for analysts. For example, all API addresses are hidden and are dynamically calculated before calling.</p>


</div>
<div class="cmp cmp-image aem-GridColumn aem-GridColumn--default--12">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            <img src="/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions/_jcr_content/root/responsivegrid/image_1940546585.img.png/1580748449077/metamorfo4.png" alt="Figure 4. Analzying YvSVUyps.dll with an analysis tool"/>
        </noscript>
    
    <span class="cmp-image--title">Figure 4. Analzying YvSVUyps.dll with an analysis tool</span>


    

</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Once it ran, I dumped the restored real code from memory. By analyzing its ASM code, I also learned that it was compiled by Borland Delphi, just like the previous variant I analyzed.</p>
<p>Now it’s time to see what major tasks it will perform on a victim’s system.</p>
<p>After the code is restored by VMProtect, the FormCreate() function is called – which can be considered to be the Main() function.</p>
<p>It terminates running browsers, such as Microsoft IE, Mozilla Firefox, Google Chrome, Microsoft Edge and Opera, by killing the following processes: &quot;iexplore.exe&quot;, &quot;firefox.exe&quot;, &quot;chrome.exe&quot;, &quot;microsoftedge.exe&quot;, and &quot;opera.exe&quot;. The process name strings and other most constant strings in the variant are encrypted using the same method as in the previous variant, but with different decryption keys.</p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">[...]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2BA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_30]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2BD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, offset a015f924af437_0&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;decrypt_fun&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2C7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_30]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2CA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_2C]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2CD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;str_copy_Ascii_Unicode</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_2C]<span style="color: #00b050;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; de=&gt;&nbsp;&nbsp;"iexplore.exe"</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2D5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_4]&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: red;">call&nbsp;&nbsp;&nbsp;&nbsp;_TerminateProcess&nbsp;</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2DD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_38]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, offset a5af5093ad16e_0&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2E5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;decrypt_fun&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2EA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_38]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2ED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_34]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;str_copy_Ascii_Unicode ;&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2F5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_34]<span style="color: #00b050;">&nbsp;&nbsp;&nbsp;&nbsp;; de=&gt; "firefox.exe"</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_4]&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE2FB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: red;">call&nbsp;&nbsp;&nbsp;&nbsp;_TerminateProcess&nbsp;</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE300&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_40]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE303&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, offset aA233cd013efd_0&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE308&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;decrypt_fun&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE30D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_40]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE310&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_3C]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE313&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;str_copy_Ascii_Unicode ;&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE318&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_3C]<span style="color: #00b050;">&nbsp;&nbsp;&nbsp;&nbsp;; de=&gt; "chrome.exe"</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE31B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_4]&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE31E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: red;">call&nbsp;&nbsp;&nbsp;&nbsp;_TerminateProcess&nbsp;</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE323&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_48]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE326&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, offset aC9023de11adf_0&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE32B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;decrypt_fun&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE330&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_48]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE333&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_44]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE336&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;str_copy_Ascii_Unicode ;&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE33B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_44]<span style="color: #00b050;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; de=&gt; "microsoftedge.exe"</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE33E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_4]&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE341&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: red;">call&nbsp;&nbsp;&nbsp;&nbsp;_TerminateProcess&nbsp;</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE346&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_50]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE349&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, offset a84c66187b74f_0&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE34E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;decrypt_fun&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE353&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_50]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE356&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_4C]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE359&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;str_copy_Ascii_Unicode ;&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE35E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edx, [ebp+var_4C]<span style="color: #00b050;">&nbsp;&nbsp;&nbsp;&nbsp;; de=&gt; "opera.exe"</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE361&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [ebp+var_4]&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022AE364&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: red;">call&nbsp;&nbsp;&nbsp;&nbsp;_TerminateProcess&nbsp;</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">[...]</span></em></p></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>This piece of ASM code shows that it calls a function to decrypt the process name strings and then calls the function _TerminateProcess() to kill all the matched processes from the process list.</p>
<p>It then modifies several registry key values to disable the IE browser’s functions such as auto-complete, auto-suggest, etc. The disabled keys are: &quot;Use FormSuggest&quot;, &quot;FormSuggest Passwords&quot;, &quot;FormSuggest PW Ask&quot; under the sub-key “HKCU\Software\Microsoft\Internet Explorer\Main”, and &quot;AutoSuggest&quot; under the sub-key &quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\AutoComplete&quot;.</p>
<p>What is the purpose of killing the browsers and disabling their auto-complete and auto-suggest functions? This action forces the victim to hand-enter data without auto-complete, such as whole URLs, along with login-name, password, and so on in the browser. This allows the malware’s key logger function to record the largest number of actions from the victim’s input.</p>
<p>It also collects information such as the OS version, Computer Name, installed AV software, and so on from victim’s system. </p>
<p>If it is running on an infected machine for the first time (depending on whether a flag file exists), it sends a POST packet to its command-and-control (C&amp;C) server informing it that a machine has been infected. Figure 5 shows the details of that packet.</p>


</div>
<div class="cmp cmp-image aem-GridColumn aem-GridColumn--default--12">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            <img src="/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions/_jcr_content/root/responsivegrid/image_1071439374.img.png/1580748551194/metamorfo5.png" alt="Figure 5. Screenshot of a POST packet to the C&amp;C server"/>
        </noscript>
    
    <span class="cmp-image--title">Figure 5. Screenshot of a POST packet to the C&amp;C server</span>


    

</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The URL “hxxp[:]//escapuliu[.]com/happynewyear/EYHS2BZM31D225Q.php” was previously decrypted, and the body of this packet contains the victim’s system information. Some of the values are base64 encoded. After decoding, the data looks like this: </p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><strong><em><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">vv</span></em></strong><em><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">=OP57--06-01&amp;<strong>vw</strong>=&amp;<strong>mods</strong>=&amp;<strong>uname</strong>=*********V-PC&amp;<strong>cname</strong>=N-96&amp;<strong>os</strong>=Windows 7 Ultimate6.17601-32&amp;<strong>is</strong>=&amp;<strong>iss</strong>=IE.AssocFile.HTM&amp;<strong>iav</strong>= microsoft security essentials</span></em></p></div>
</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif;">&ldquo;<em>vv=OP57--06-01</em>&rdquo; is the version information of Metamorfo.</span></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif;">&ldquo;<em>mods=&rdquo;</em>&nbsp;records whether IBM Trusteer Rapport is running, which is used to protect users from malware.</span></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif;">&ldquo;<em>uname=*********V-PC</em>&rdquo; is the victim&rsquo;s computer name.</span></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif;">&ldquo;<em>cname=N-96</em>&rdquo; is a value read out from the system registry.</span></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif;">&ldquo;<em>os=Windows 7 Ultimate6.17601-32</em>&rdquo; contains the infected OS version and platform.</span></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif;">&ldquo;<em>iss=IE.AssocFile.HTM</em>&rdquo; indicates the victim&rsquo;s default browser, which in this case is IE.</span></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif;">&ldquo;<em>iav= microsoft security essentials</em>&rdquo; is a list of AV software that the victim has installed.</span></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif;">&nbsp;</span></p></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Timer Functions</h2>
<p>As with the previous variant, this one also uses Timers to perform its tasks. At the end of the FormCreate() function it starts two Timers. The first Timer is used to monitor a bitcoin wallet address in the system clipboard, and the other is used to detect whether or not the victim is accessing a financial institution website. I will elaborate on both of these below.<b></b></p>
<p><b>Bitcoin Address Timer Function</b></p>
<p>This function keeps receiving data from the system clipboard and then determines if it is a valid bitcoin wallet address. If yes, it overwrites the wallet address with the attacker’s. </p>


</div>
<div class="cmp cmp-image aem-GridColumn aem-GridColumn--default--12">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            <img src="/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions/_jcr_content/root/responsivegrid/image_1814588592.img.png/1580748788894/metamorfo6.png" alt="Figure 6. Calling the API SetClipboardData() to overwrite the bitcoin wallet address"/>
        </noscript>
    
    <span class="cmp-image--title">Figure 6. Calling the API SetClipboardData() to overwrite the bitcoin wallet address</span>


    

</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Figure 6 shows the calling of the API SetClipboardData(), whose second parameter is the attacker’s wallet address (&quot;163McXwBrc9S7JzbgegzVuw7QTJ9H1dQj7&quot;) used to replace the original one in the system clipboard. </p>
<p>Usually, users copy&amp;paste the wallet address to make a bitcoin transfer. In this variant, Metamorfo detects and overwrites the target wallet in the clipboard. In this way, it attempts to make the victim unknowingly transfer their bitcoin to the attacker’s bitcoin wallet address (&quot;163McXwBrc9S7JzbgegzVuw7QTJ9H1dQj7&quot;).</p>
<p><b>Financial institution Timer Function</b></p>
<p>It then calls the API EnumWindows() function to enumerate all windows from the victim’s system. Its EnumFunc() callback function collects all windows titles and then adds a 14H long random string prefix. One mixed windows title looks like this:  “{14H long random string}+windows title”. All the mixed windows titles are added into a string list box control. It can also collect the page title of an online banking website that the victim may access in a browser.</p>
<p>In the timer function, it then reads out the mixed windows titles from the string list box control, one by one, to perform string matching against keywords from the targeted financial institutions. There are 32 such keywords that are used to enable matching with more than twenty financial institutions in multiple countries, including the US, Canada, Peru, Chile, Spain, Brazil, Ecuador, Mexico, and others. For safety reasons, I will not mention the specified keywords or the names of the financial institutions being targeted by this malware in this post.</p>
<p>Once a window title matches one of the keywords of a targeted financial institution, it connects to the C&amp;C server, whose host is different from the one mentioned earlier.</p>
<p>Below is a code snippet that decrypts the C&amp;C server host string and port number, which are “ssl[.]teamo[.]life” and “8350”.</p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">[...]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022965F7&nbsp;&nbsp;lea&nbsp;&nbsp;eax, [ebp+var_18]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">022965FA&nbsp;&nbsp;mov&nbsp;&nbsp;edx, ds:dword_235CE2C&nbsp;&nbsp;&nbsp;<span style="color: #00b050;">;encrypted host string</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296600&nbsp;&nbsp;mov&nbsp;&nbsp;ecx, 0</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296605&nbsp;&nbsp;call&nbsp;&nbsp;_WideCharToMultiByte&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">0229660A&nbsp;&nbsp;mov&nbsp;&nbsp;eax, [ebp+var_18]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">0229660D&nbsp;&nbsp;lea&nbsp;&nbsp;edx, [ebp+var_14]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296610&nbsp;&nbsp;<strong>call&nbsp;&nbsp;decrypt_fun</strong>&nbsp;&nbsp;&nbsp;<span style="color: #00b050;">; de=&gt; "<strong>ssl.teamo.life</strong>"</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296615&nbsp;&nbsp;mov&nbsp;&nbsp;edx, [ebp+var_14]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296618&nbsp;&nbsp;lea&nbsp;&nbsp;eax, [ebp+var_10]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">0229661B&nbsp;&nbsp;call&nbsp;&nbsp;str_Ascii_Unicode</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296620&nbsp;&nbsp;mov&nbsp;&nbsp;edx, [ebp+var_10]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296623&nbsp;&nbsp;lea&nbsp;&nbsp;ecx, [ebp+var_C]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296626&nbsp;&nbsp;mov&nbsp;&nbsp;eax, [ebp+var_4]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296629&nbsp;&nbsp;call&nbsp;&nbsp;sub_2296470&nbsp;&nbsp;<span style="color: #00b050;">; gethostbyname</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">0229662E&nbsp;&nbsp;mov&nbsp;&nbsp;edx, [ebp+var_C]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296631&nbsp;&nbsp;mov&nbsp;&nbsp;eax, [ebp+var_4]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296634&nbsp;&nbsp;mov&nbsp;&nbsp;eax, [eax+3DCh]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">0229663A&nbsp;&nbsp;call&nbsp;&nbsp;sub_20BF29C</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">0229663F&nbsp;&nbsp;lea&nbsp;&nbsp;eax, [ebp+var_24]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296642&nbsp;&nbsp;mov&nbsp;&nbsp;edx, ds:dword_235CE30&nbsp;&nbsp;<span style="color: #00b050;">;encrypted port number</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296648&nbsp;&nbsp;mov&nbsp;&nbsp;ecx, 0</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">0229664D&nbsp;&nbsp;call&nbsp;&nbsp;_WideCharToMultiByte&nbsp;</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296652&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;eax, [ebp+var_24]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296655&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;edx, [ebp+var_20]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">02296658&nbsp;&nbsp;<strong>call&nbsp;&nbsp;decrypt_fun</strong>&nbsp;&nbsp;&nbsp;<span style="color: #00b050;">;; de=&gt; "<strong>8350</strong>"</span></span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">0229665D&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;edx, [ebp+var_20]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><em><span style="font-family: 'Times New Roman', serif; background-color: #d9d9d9; background-position: initial initial; background-repeat: initial initial;">[...]</span></em></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif;">&nbsp;</span></p></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Command and Control with C&amp;C Server </h2>
<p>When a connection is established with the C&amp;C Server, it sends the command “&lt;|QFUNHSNXU|&gt;” to the server and waits for control commands to come back to execute further functions on the victim’s system.</p>
<p>Following is an example communication between Metamorfo and its C&amp;C server. </p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif; color: #7f0000; background-color: #fbeded; background-position: initial initial; background-repeat: initial initial;">&lt;|QFUNHSNXU|&gt;</span></p> <p class="MsoNormal" style="margin: 0in 0in 0.0001pt; line-height: normal; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif; color: #00007f; background-color: #ededfb; background-position: initial initial; background-repeat: initial initial;">&lt;|PT|&gt;</span></p> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="font-family: 'Times New Roman', serif; color: #7f0000; background-color: #fbeded; background-position: initial initial; background-repeat: initial initial;">&lt;|tksN|&gt;OP57--06-01-N-96&lt;|&gt;32 - Windows 7 Ultimate6.17601&lt;|&gt;********-PC - microsoft security essentials-L4N4c10n&lt;|&gt;********-PC&lt;&lt;|2//&amp;ikILVm9ZtX!L4N4c10n</span></p></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Metamorfo sent “&lt;|QFUNHSNXU|&gt;” to the server, and then received the control command “&lt;|PT|&gt;” back from the server and executed the code for this command. As you can see, it then sent the response packet “&lt;|tksN|&gt;”, which contains the Metamorfo version, system version, platform information, the victim’s computer name, any installed AV software, the identifier string of the matched financial institution name (“L4N4c10n”), and so on. </p>
<p>NOTE: in a packet, the symbol “&lt;|&gt;” is kind of a delimiter, while “&lt;&lt;|” is an end symbol.</p>
<p>As with the previous variant, this Metamorfo client uses the SocketRead() function to receive and process the control commands from the C&amp;C server for this socket. </p>
<p>This Metamorfo variant supports 119 control commands in total. Here they are:</p>
<p><b>&quot;&lt;|YuiqkwSgot|&gt;&quot;, &quot;&lt;|PT|&gt;&quot;, &quot;&lt;|VOTM|&gt;&quot;, &quot;&lt;|Gpsxi|&gt;&quot;, &quot;&lt;|ZKXAKYWQKEHUGZJ|&gt;&quot;, &quot;&lt;|lozyw|&gt;&quot;, &quot;&lt;|SuaykRJ|&gt;&quot;, &quot;&lt;|SuaykJI|&gt;&quot;, &quot;&lt;|ztUjzwtR|&gt;&quot;, &quot;&lt;|IXjzwtR|&gt;&quot;, &quot;&lt;|Folder|&gt;&quot;, &quot;&lt;|Files|&gt;&quot;, &quot;&lt;|DownloadFile|&gt;&quot;, &quot;&lt;|UploadFile|&gt;&quot;, &quot;dkxqdpdv&quot;, &quot;fuobhjh&quot;, &quot;pyfsqtpofn&quot;, &quot;camarinho&quot;, &quot;beijada&quot;, &quot;cidadao&quot;, &quot;dlulztody&quot;, &quot;janainaa&quot;, &quot;nnnaewhwf23nvcxx&quot;, &quot;vanuza&quot;, &quot;vanessa&quot;, &quot;carmena&quot;, &quot;petereca&quot;, &quot;jpevtpjevtjte&quot;, &quot;djqduidxorv&quot;, &quot;dulhkqzprf&quot;, &quot;vaidamole&quot;, &quot;vadiadaum&quot;, &quot;lzyxyzoxzdy&quot;, &quot;baraomagao&quot;, &quot;IbqJxbxma&quot;, &quot;Lmatqo&quot;, &quot;puplY&quot;, &quot;hajluvjlY&quot;, &quot;wlylajhyhJ&quot;, &quot;gsxuymrle&quot;, &quot;sjemwbgonehjexhjjexhjxh&quot;, &quot;phjdqdfdv&quot;, &quot;madona&quot;, &quot;LkingWajuGhkzwu&quot;, &quot;vkbAlcvtlY&quot;, &quot;JtxyXLWA&quot;, &quot;urpdzchlrdi&quot;, &quot;JXyhylipS&quot;, &quot;ndsoiu43098s&quot;, &quot;snis4duo3098&quot;, &quot;ki74yfhsag&quot;, &quot;KxvoJJ&quot;, &quot;Bwilmakx&quot;, &quot;semvergonha&quot;, &quot;mh42jkrxc3&quot;, &quot;BwiAivbi&quot;, &quot;vBiAiiwbwew&quot;, &quot;Bwiqbi&quot;, &quot;kdaf4w84fds&quot;, &quot;iru4837fbcz&quot;, &quot;apqi398wjx&quot;, &quot;Bwiaqk&quot;, &quot;mfklsjfk3049jsfd&quot;, &quot;Bwikmn&quot;, &quot;vpupqbd&quot;, &quot;ulrvAkhyI&quot;, &quot;posseco&quot;, &quot;jpwhslAzvsI&quot;, &quot;ihAhaP&quot;, &quot;dsefsdfds342342&quot;, &quot;massonaria&quot;, &quot;kldiu4324987dyyds&quot;, &quot;iejdskdjkfl3426232hdshdhs&quot;, &quot;maconha&quot;, &quot;cnirhx87ds&quot;, &quot;b9f8vnh3f7dhvsja4&quot;, &quot;ihAwpMhauhW&quot;, &quot;nhfjds98743hvfavb&quot;, &quot;mfki73t1dav&quot;, &quot;fodiufjdo834yfdgf&quot;, &quot;f9ksa8iuvdo&quot;, &quot;miwey82fqq&quot;, &quot;oropeiru23&quot;, &quot;kmcjds09498&quot;, &quot;ewaewqrtrrmwoa&quot;, &quot;m94ufasjczbal&quot;, &quot;ulzcecrvAkhocpgyI&quot;, &quot;hslfasreweyI&quot;, &quot;perebao&quot;, &quot;japones3fadhh&quot;, &quot;uhkozphslAzvsI&quot;, &quot;HruxWkrgHHMqgbkgs&quot;, &quot;kxsHqddeuMHgHrbgrWgk&quot;, &quot;bisurdor&quot;, &quot;curvaduru&quot;, &quot;vvjpwulw&quot;, &quot;bosteiro&quot;, &quot;lkfjasofu4343849&quot;, &quot;fkvoiudas98&quot;, &quot;coichzbz&quot;, &quot;b98djzc&quot;, &quot;klfjs943jfs&quot;, &quot;eaqeutmn5r&quot;, &quot;cracreuz&quot;, &quot;guilhermina&quot;, &quot;ztchrhAhaP&quot;, &quot;IIzvsI&quot;, &quot;HAPzvsI&quot;, &quot;juventude&quot;, &quot;HAUHWzvsI&quot;, &quot;KHYIzvsI&quot;, &quot;jpwzvsI&quot;, &quot;mljzvsI&quot;, &quot;hruxyoiu&quot;, &quot;COZUMEL&quot;, &quot;COZUMARIA&quot;, &quot;LMAimwc&quot;, &quot;baci83427daca&quot;, &quot;daa243bi78acc&quot;.</b></p>
<p>The following table lists most of the control commands for the main socket, along with their descriptions. From it you are able to discover what actions Metamorfo variant can perform on a victim’s machine.</p>


</div>
<div class="raw-import aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--2">
<div class="text-container"><table class="MsoNormalTable" style="color: #000000; font-style: normal; font-weight: normal; text-align: start; width: 6.1in; margin-left: -0.75pt;" border="1" cellspacing="0" cellpadding="0"> <tbody> <tr style="height: 29.4pt;"> <td style="width: 99.75pt; background-color: yellow; padding: 0in; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: 'Times New Roman', serif;">Command</span></strong></p> </td> <td style="width: 339.45pt; background-color: yellow; padding: 0in; background-position: initial initial; background-repeat: initial initial;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="font-size: 12pt; line-height: 18.399999618530273px; font-family: 'Times New Roman', serif;">Description</span></strong></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|YuiqkwSgot|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Sets the sub-command used for &ldquo;&lt;|DownloadFile|&gt;&rdquo;</span></p> </td> </tr> <tr style="height: 28.65pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|PT|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Asks for basic information of the victim&rsquo;s system and the triggered financial name identifier.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|VOTM|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Sends packets "&lt;|LSTU|&gt;" to the server. Functions like a heartbeat.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|Gpsxi|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Closes all sockets that have connected to the C&amp;C server.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|lozyw|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Restarts a specified socket.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|SuaykJI|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Performs a double-click at a specified position.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|ztUjzwtR|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Moves the cursor to a specific position.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|IXjzwtR|&gt;&nbsp;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Performs a right click at a specified position.</span></p> </td> </tr> <tr style="height: 30.9pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|Folder|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Searches folders using given keywords and sends the result to the C&amp;C server.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|Files|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Searches files using given keywords and send the results to the C&amp;C server.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|DownloadFile|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Downloads a file from the C&amp;C server, depending on the command&nbsp;</span><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|YuiqkwSgot|&gt;.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&lt;|UploadFile|&gt;</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Uploads a file onto the C&amp;C server.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">dkxqdpdv</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Shows the victim a MessageBox with coaxing information.</span></p> </td> </tr> <tr style="height: 0.25in;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">vanuza</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Restarts some sockets.</span></p> </td> </tr> <tr style="height: 33.6pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">vanessa</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Displays a fake message to the victim asking them to enter a confirmation code.</span></p> </td> </tr> <tr style="height: 30pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">carmena</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">This command has multiple sub-commands to simulate the victim typing characters that are from the command packet into a text box.</span></p> </td> </tr> <tr style="height: 32.25pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">jpevtpjevtjte</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Downloads an MSI file from the C&amp;C server and executes it. It can also update itself.</span></p> </td> </tr> <tr style="height: 21.9pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">djqduidxorv</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Resets the switch-file. Delete files and related folders.&nbsp;</span></p> </td> </tr> <tr style="height: 30.9pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">baraomagao</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Make all running browsers (IE, Chrome and Firefox) maximize their windows.</span></p> </td> </tr> <tr style="height: 35.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">IbqJxbxma, hajluvjlY</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Makes the system taskbar visible.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Lmatqo</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Shuts down the infected system.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">puplY</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Reboots the infected system.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">wlylajhyhJ</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Plays the "SYSTEMSTART" sound by calling the API PlaySoundW().</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">LkingWajuGhkzwu</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Closes sockets and exits Metamorfo.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">vkbAlcvtlY</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Runs a .bat file to delete files.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">JtxyXLWA</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Deletes a .dll file and shuts down the system.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">urpdzchlrdi</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" rowspan="5" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">These commands are related. They could start threads and then manipulate those threads to control the victim's input, including mouse and keyboard.&nbsp;</span></p> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">For example, it is able to block the victim's mouse actions (click, double click, select text, right click. and so on) on a browser.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">JXyhylipS</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">ndsoiu43098s</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">snis4duo3098</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">ki74yfhsag</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">KxvoJJ</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" rowspan="7" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">here are more than 50 commands here, but I only listed 7 of them here as an example.</span></p> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">They can make the system taskbar and mouse cursor invisible, display a control such as a canvas showing the victim&rsquo;s information; ask the victim to enter something like password, etc.</span></p> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Some commands also run a Timer to keep killing "Windows Task Manager".</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Bwilmakx</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">semvergonha</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">mh42jkrxc3</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">BwiAivbi</span></strong></p> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&nbsp;</span></strong></p> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&nbsp;</span></strong></p> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&nbsp;</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">vBiAiiwbwew</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Bwiqbi</span></strong></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">vpupqbd</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Restores all the status that the above commands changed.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">IIzvsI</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Creates a file under the user profile folder.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">COZUMEL</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Starts a thread to run a key logger on a browser.</span></p> </td> </tr> <tr style="height: 17.4pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">COZUMARIA</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Stops the key logger and sends the recorded data to the C&amp;C server.</span></p> </td> </tr> <tr style="height: 30pt;"> <td style="width: 99.75pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; text-align: center;" align="center"><strong><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">LMAimwc</span></strong></p> </td> <td style="width: 339.45pt; padding: 0in;" valign="top"> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">Closes running browsers, shows the victim a message, then restarts the&nbsp;&nbsp;victim's system.</span></p> </td> </tr> </tbody> </table> <p class="MsoNormal" style="margin: 0in 0in 12pt; line-height: 16.866666793823242px; font-size: 11pt; font-family: Calibri, sans-serif; color: #000000; font-style: normal; font-weight: normal; text-align: start;"><span style="line-height: 16.866666793823242px; font-family: 'Times New Roman', serif;">&nbsp;</span></p></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Here is an example of the last control command, &quot;LMAimwc&quot;.  It closes running browsers – including “Microsoft Internet Explorer”, “Google Chrome”, and “Mozilla Firefox”, displays a message, and then restarts the victim’s system. Figure 7, below, shows a screenshot of the message in the Spanish language that I’ve translated it into English.</p>


</div>
<div class="cmp cmp-image aem-GridColumn aem-GridColumn--default--12">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            <img src="/blog/threat-research/another-metamorfo-variant-targeting-customers-of-financial-institutions/_jcr_content/root/responsivegrid/image_1988861339.img.png/1580749228159/metamorfo7.png" alt="Figure 7. The message of the control command &#34;LMAimwc&#34;."/>
        </noscript>
    
    <span class="cmp-image--title">Figure 7. The message of the control command &#34;LMAimwc&#34;.</span>


    

</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Solution</h2>
<p>Fortinet customers are protected from this Metamorfo variant by FortiGuard’s Web Filtering, AntiVirus, and IPS services as follows:</p>
<p>The related URLs are rated as &quot;<b>Malicious Websites</b>&quot; by the FortiGuard Web Filtering service.</p>
<p>The MSI file is detected as &quot;<b>W32/Metamorfo</b>&quot; and blocked by the FortiGuard AntiVirus service.</p>
<p>The traffic between Metamorfo and its C&amp;C server is detected by the FortiGuard IPS signature “<b>Trojan.Metamorfo</b>”.</p>
<h2>IOCs:</h2>
<p><b>URLs</b></p>
<p>hxxp[:]//escapuliu[.]com/happynewyear/EYHS2BZM31D225Q.php</p>
<p>hxxp[:]//www[.]chmsc[.]edu[.]ph/library/modules/down/op57.lts</p>
<p><b>Sample SHA-256</b></p>
<p>[view-(AVISO)2020.msi]</p>
<p>EB1E5EAEA4ECC04B920BBD955C16B17F3D5AC3C580EA266FF5B9D589B8B49E0C</p>
<p><i>Learn more about <a href="https://www.fortinet.com/fortiguard/labs.html?utm_source=blog&amp;utm_medium=campaign&amp;utm_campaign=FortiGuardLabs">FortiGuard Labs</a> threat research and the FortiGuard Security Subscriptions and Services <a href="https://www.fortinet.com/fortiguard/labs.html?utm_source=blog&amp;utm_medium=campaign&amp;utm_campaign=FortiGuardLabs">portfolio</a>. <a href="https://www.fortinet.com/fortiguard/labs.html?utm_source=blog&amp;utm_medium=campaign&amp;utm_campaign=FortiGuardLabs">Sign up</a> for the weekly Threat Brief from FortiGuard Labs. </i></p>
<p><i>Learn more about Fortinet’s <a href="https://www.fortinet.com/blog/business-and-technology/why-cybersecurity-training-is-more-important-than-ever.html">free cybersecurity training initiative</a> or about the Fortinet <a href="https://training.fortinet.com/?utm_source=blog&amp;utm_campaign=2019-q3-nse-institute">Network Security Expert program</a>, <a href="https://training.fortinet.com/local/staticpage/view.php?page=fnsa&amp;utm_source=blog&amp;utm_campaign=2019-q3-fnsa">Network Security Academy program</a>, and <a href="https://www.fortinet.com/corporate/careers/vets.html?utm_source=blog&amp;utm_campaign=2018-q2-fortivet">FortiVet program</a>.</i></p>


</div>
<div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"><div id="om-qxx1b0gslklfu2kjckea-holder"></div> 
</div>
</div>

    
</div>
</div>
<div class="b16-blog-tags aem-GridColumn aem-GridColumn--default--12">



  <div class="b16-blog-tags__container text-container">
    <span class="b16-blog-tags__headline">Tags:</span>
    <p class="b16-blog-tags__tag-links">
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=financialservices">financial services</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=windows">windows</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=cybersecurity-architect">Cybersecurity Architect</a>
    </p>
  </div>

</div>
<section class="b12-related aem-GridColumn aem-GridColumn--default--12">




<div class="b12-related__container text-container">
    

    
    
    <h3>Related Posts</h3>
    <div class="b12-related__posts">
        
        <a href="/blog/threat-research/microsoft-windows-office-zeroday-remote-code-vulnerabilities" class="b12-related__post b12-related__post-0">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/lockergoga-blog/microsoft-blog-img.png.thumb.319.319.png);">
                <img class="ratio" alt="Patch Your Microsoft Windows and Office: Fortinet Discovers Three Zero-Day Remote Code Execution Vulnerabilities" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    Threat Research
                </p>
                <h5 class="b12-related__title">Patch Your Microsoft Windows and Office: Fortinet Discovers Three Zero-Day Remote Code Execution Vulnerabilities</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/microsoft-windows-jet-engine-msrd3x-code-execution-vulnerability" class="b12-related__post b12-related__post-1">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/microsoft_windows_jet_engine_msrd-/hong_01b.png.thumb.319.319.png);">
                <img class="ratio" alt="Microsoft Windows JET Engine Msrd3x Code Execution Vulnerability" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    Threat Research
                </p>
                <h5 class="b12-related__title">Microsoft Windows JET Engine Msrd3x Code Execution Vulnerability</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/microsoft-word-file-spreads-malware-targeting-both-mac-os-x-and-windows-part-ii" class="b12-related__post b12-related__post-2">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/individual-images/microsoft-word-file-spreads-malware-targeting-both-mac-os-x-and-windows-part-ii.png.thumb.319.319.png);">
                <img class="ratio" alt="Microsoft Word File Spreads Malware Targeting Both Mac OS X and Windows (Part II)" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    Threat Research
                </p>
                <h5 class="b12-related__title">Microsoft Word File Spreads Malware Targeting Both Mac OS X and Windows (Part II)</h5>
            </div>
        </a>
    
    </div>
</div>


</section>
<div class="b13-comment-section aem-GridColumn aem-GridColumn--default--12">


<div class="b13-comment-section__container text-container">


  <!--data-sly-test="true - got replaced with false to disable the discussion event-->
  
</div>
</div>
<div class="b6-footer aem-GridColumn aem-GridColumn--default--12">


  

  <div class="b6-footer__container text-container">
    <div class="b6-footer__footer-info">
      <div class="b6-footer__logo">
        <a href="https://www.fortinet.com" target="_blank">
          <img src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet"/>
        </a>
      </div>
      <div class="b6-footer__social-footer">
        <ul>
          
            <li class="social-icon facebook">
              <a href="https://www.facebook.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 9 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M8.934.758v3.385H7.24c-.583 0-.845.685-.845 1.27v2.114h2.54v3.385h-2.54v6.77H3.01v-6.77H.472V7.527H3.01V4.143c0-1.87 1.516-3.385 3.385-3.385h2.54z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon twitter">
              <a href="https://www.twitter.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 19 15" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.17 2.296c-.652.296-1.354.49-2.082.584.745-.448 1.32-1.16 1.59-2.014-.702.423-1.48.72-2.3.89-.67-.73-1.61-1.152-2.675-1.152-1.988 0-3.613 1.625-3.613 3.63 0 .288.034.567.093.83-3.012-.153-5.694-1.6-7.48-3.792-.313.534-.49 1.16-.49 1.82 0 1.26.634 2.377 1.616 3.012-.61 0-1.16-.17-1.65-.423v.03c0 1.76 1.25 3.237 2.91 3.567-.31.084-.63.127-.96.127-.23 0-.46-.026-.68-.07.455 1.43 1.784 2.497 3.383 2.52-1.235.984-2.8 1.56-4.51 1.56-.288 0-.575-.018-.863-.05 1.61 1.03 3.52 1.632 5.57 1.632 6.667 0 10.33-5.534 10.33-10.332 0-.16 0-.313-.007-.474.71-.508 1.32-1.15 1.81-1.888z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon youtube">
              <a href="https://www.youtube.com/user/SecureNetworks" target="_blank">
                
    <svg viewBox="0 0 18 14" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.472 11.027V3.412L12.55 7.22l-5.08 3.806zM15.934.787C15.426.62 12.294.45 9.164.45c-3.13 0-6.26.16-6.77.322-1.32.44-1.69 3.4-1.69 6.447 0 3.03.37 6 1.69 6.43.51.17 3.64.33 6.77.33 3.13 0 6.262-.16 6.77-.33 1.32-.43 1.692-3.4 1.692-6.44 0-3.047-.372-6-1.692-6.43z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon linkedin">
              <a href="https://www.linkedin.com/company/fortinet" target="_blank">
                
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.934 15.835H12.55v-5.712c0-.897-1.008-1.64-1.905-1.64s-1.48.743-1.48 1.64v5.712H5.78V5.68h3.385v1.693c.558-.905 1.996-1.49 2.96-1.49 2.116 0 3.81 1.727 3.81 3.817v6.135zm-11.846 0H.703V5.68h3.385v10.155zM2.395.605c.935 0 1.693.757 1.693 1.69 0 .936-.758 1.694-1.693 1.694S.703 3.23.703 2.29C.703 1.36 1.46.6 2.395.6z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon instagram">
              <a href="https://www.instagram.com/behindthefirewall/" target="_blank">
                
    <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <path class="st0" d="M16,3.7c4,0,4.5,0,6.1,0.1c1.5,0.1,2.3,0.3,2.8,0.5c0.7,0.3,1.2,0.6,1.7,1.1c0.5,0.5,0.8,1,1.1,1.7
          c0.2,0.5,0.4,1.3,0.5,2.8c0.1,1.6,0.1,2.1,0.1,6.1s0,4.5-0.1,6.1c-0.1,1.5-0.3,2.3-0.5,2.8c-0.3,0.7-0.6,1.2-1.1,1.7
          c-0.5,0.5-1,0.8-1.7,1.1c-0.5,0.2-1.3,0.4-2.8,0.5c-1.6,0.1-2.1,0.1-6.1,0.1s-4.5,0-6.1-0.1c-1.5-0.1-2.3-0.3-2.8-0.5
          c-0.7-0.3-1.2-0.6-1.7-1.1c-0.5-0.5-0.8-1-1.1-1.7c-0.2-0.5-0.4-1.3-0.5-2.8C3.7,20.5,3.7,20,3.7,16s0-4.5,0.1-6.1
          c0.1-1.5,0.3-2.3,0.5-2.8C4.6,6.5,4.9,6,5.4,5.4c0.5-0.5,1-0.8,1.7-1.1c0.5-0.2,1.3-0.4,2.8-0.5C11.5,3.7,12,3.7,16,3.7 M16,1
          c-4.1,0-4.6,0-6.2,0.1C8.2,1.2,7.1,1.4,6.2,1.8c-1,0.4-1.8,0.9-2.7,1.7C2.7,4.4,2.2,5.2,1.8,6.2c-0.4,1-0.6,2-0.7,3.6
          C1,11.4,1,11.9,1,16c0,4.1,0,4.6,0.1,6.2c0.1,1.6,0.3,2.7,0.7,3.6c0.4,1,0.9,1.8,1.7,2.7c0.8,0.8,1.7,1.3,2.7,1.7
          c1,0.4,2,0.6,3.6,0.7C11.4,31,11.9,31,16,31s4.6,0,6.2-0.1c1.6-0.1,2.7-0.3,3.6-0.7c1-0.4,1.8-0.9,2.7-1.7c0.8-0.8,1.3-1.7,1.7-2.7
          c0.4-1,0.6-2,0.7-3.6C31,20.6,31,20.1,31,16s0-4.6-0.1-6.2c-0.1-1.6-0.3-2.7-0.7-3.6c-0.4-1-0.9-1.8-1.7-2.7
          c-0.8-0.8-1.7-1.3-2.7-1.7c-1-0.4-2-0.6-3.6-0.7C20.6,1,20.1,1,16,1L16,1z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <path class="st0" d="M16,8.3c-4.3,0-7.7,3.4-7.7,7.7s3.4,7.7,7.7,7.7s7.7-3.4,7.7-7.7S20.3,8.3,16,8.3z M16,21c-2.8,0-5-2.2-5-5
          s2.2-5,5-5s5,2.2,5,5S18.8,21,16,21z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <circle class="st0" cx="24" cy="8" r="1.8" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></circle>
    </svg>

              </a>
            </li>
          
            <li class="social-icon rss">
              <a href="https://www.fortinet.com/rss-feeds.html" target="_blank">
                
    <svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.072 17.68c-1.27 0-2.37-1.1-2.37-2.368 0-1.27 1.1-2.37 2.37-2.37s2.37 1.1 2.37 2.37-1.016 2.37-2.37 2.37zM.702.76v2.538c7.955 0 14.386 6.43 14.386 14.385h2.538C17.626 8.336 10.05.76.703.76zm0 5.162V8.46c5.078 0 9.224 4.146 9.224 9.223h2.54c0-6.514-5.248-11.76-11.763-11.76z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
        </ul>
      </div>
    </div>
    <div class="b6-footer__footer-links">
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">News &amp; Articles</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html" target="_self">News Releases</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/news.html" target="_blank">News Articles</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/contact-us/fortinet-trademark-guidelines.html" target="_self">Trademarks</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Security Research</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html" target="_self">Threat Research</a>
              </li>
            
              <li>
                <a href="https://fortiguard.com/" target="_self">FortiGuard Labs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html" target="_self">Threat Map</a>
              </li>
            
              <li>
                <a href="https://secure.fortinet.com/fortiguard" target="_blank">Threat Briefs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/solutions/ransomware.html" target="_self">Ransomware</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Connect With Us</h4>
          <ul>
            
              <li>
                <a href="/content/fortinet-blog/us/en" target="_self">Blog</a>
              </li>
            
              <li>
                <a href="https://fusecommunity.fortinet.com" target="_self">Fuse Community</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Company</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/about-us.html" target="_blank">About Us</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/why-fortinet.html" target="_blank">Why Fortinet</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/security-fabric.html" target="_self">Security Fabric</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/executive-management.html" target="_self">Exec Mgmt</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/careers.html" target="_self">Careers</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/product-certifications.html" target="_self">Certifications</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/events.html" target="_self">Events</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/industry-awards.html" target="_self">Industry Awards</a>
              </li>
            
          </ul>
        </div>
      
      <div class="b6-footer__contact-info">
        <h4 class="b6-footer__header">Contact Us</h4>
        <ul>
          <li>(866) 868-3678</li>
        </ul>
      </div>
    </div>
    <div class="b6-footer__copyright">
      <div class="b6-footer__copyright-info">
        <p class="b6-footer__copyright-text">Copyright © 2021 Fortinet, Inc. All Rights Reserved</p>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/legal.html" target="_blank">Terms of Services</a>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/privacy.html" target="_blank">Privacy Policy</a>
        
        <span class="ot-ftnt-cookie-settings"> | <a href="#" onclick="Optanon.ToggleInfoDisplay()">Cookie Settings</a></span>
      </div>
    </div>
  </div>

<!-- Launch COnfiguration -->


<!-- END Launch COnfiguration --></div>

    
</div>
</div>



    
    

    
    
<script type="text/javascript" src="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.js"></script>





    




</body>
</html>
