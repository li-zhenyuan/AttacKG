<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Romain Dumont',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>OceanLotus: macOS malware update | WeLiveSecurity</title>
<meta name="description" content="ESET researchers dissect a new version of a previously documented tool deployed by OceanLotus, showing that the group isn&#039;t resting on its laurels."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/04/09/oceanlotus-macos-malware-update/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="OceanLotus: macOS malware update | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers dissect a new version of a previously documented tool deployed by OceanLotus, showing that the group isn&#039;t resting on its laurels." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/04/09/oceanlotus-macos-malware-update/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-04-09T09:30:51+00:00" />
<meta property="article:modified_time" content="2019-06-19T11:38:40+00:00" />
<meta property="og:updated_time" content="2019-06-19T11:38:40+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/04/shutterstock_783283267-resized-e1554801758621.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/04/shutterstock_783283267-resized-e1554801758621.jpg" />
<meta property="og:image:width" content="1001" />
<meta property="og:image:height" content="563" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers dissect a new version of a previously documented tool deployed by OceanLotus, showing that the group isn&#039;t resting on its laurels." />
<meta name="twitter:title" content="OceanLotus: macOS malware update | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/04/shutterstock_783283267-resized-e1554801758621.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/04/09/oceanlotus-mise-a-jour-macos/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/04/09/oceanlotus-macos-malware-update/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/04/09/oceanlotus-actualiza-malware-apunta-usuarios-macos/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/04/11/macos-malware-update-von-oceanlotus/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/04/09/oceanlotus-mise-a-jour-macos/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/04/09/oceanlotus-actualiza-malware-apunta-usuarios-macos/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/04/11/macos-malware-update-von-oceanlotus/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/04/09/oceanlotus-mise-a-jour-macos/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/04/09/oceanlotus-actualiza-malware-apunta-usuarios-macos/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/04/11/macos-malware-update-von-oceanlotus/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/04/shutterstock_ocean-lotus-1920-resized.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>OceanLotus: macOS malware update</h1>
<div class="excerpt">Latest ESET research describes the inner workings of a recently found addition to OceanLotus’s toolset for targeting Mac users</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/romaindupont/" title="Romain Dumont">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2018/03/20180322_114641-5-222x179.jpg" alt="Romain Dumont">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/romaindupont/" title="Romain Dumont">
                    Romain Dumont                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-04-09 11:30:51">9 Apr 2019 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F04%2F09%2Foceanlotus-macos-malware-update%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F04%2F09%2Foceanlotus-macos-malware-update%2F&text=OceanLotus: macOS malware update%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F04%2F09%2Foceanlotus-macos-malware-update%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Latest ESET research describes the inner workings of a recently found addition to OceanLotus’s toolset for targeting Mac users</p>
                            </div>

                            <p>Early in March 2019, a new macOS malware sample from the OceanLotus group was uploaded to VirusTotal, a popular online multi-scanner service. This backdoor executable bears the same features as the previous macOS variant we looked at, but its structure has changed and its detection was made harder. Unfortunately, we couldn&#8217;t find the dropper associated with this sample so we do not know the initial compromise vector.</p>
<p>We <a href="https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/" target="_blank" rel="noopener">recently published a detailed update about OceanLotus</a> and how its operators employ a wide range of techniques to gain code execution, achieve persistence, and leave as little trace as possible on a Windows system. OceanLotus is also known to have a malicious macOS component. This article details what has changed from the previous macOS <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/new-macos-backdoor-linked-to-oceanlotus-found/" target="_blank" rel="noopener">version analyzed by Trend Micro</a> and describes how, while analyzing this variant’s code, you can automate string decryption using the IDA Hex-Rays API.</p>
<h1>Analysis</h1>
<p>The following three sections of this blogpost describe the analysis of the sample with the SHA-1 hash <span style="font-family: courier new, courier, monospace;">E615632C9998E4D3E5ACD8851864ED09B02C77D2</span>. The file is named flashlightd and is detected by ESET products as OSX/OceanLotus.D.</p>
<h2>Anti-debug and anti-sandbox</h2>
<p>As usual for OceanLotus macOS binaries, the sample is packed with UPX, but most packer identification tools do not recognize it as such, probably because they mostly include a signature that relies on the presence of a “UPX” string, and further, Mach-O signatures are less common and not as regularly updated. This particular characteristic makes static detection more difficult. Once unpacked, one interesting thing is that the entry point is located at the beginning of the <span style="font-family: courier new, courier, monospace;">__cfstring</span> section in the <span style="font-family: courier new, courier, monospace;">.TEXT</span> segment. This section has the flag attributes seen in Figure 1.</p>
<div id="attachment_124256" style="width: 595px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/04/Figure-1-wm-1.png"><img class="wp-image-124256 size-full" src="/wp-content/uploads/2019/04/Figure-1-wm-1.png" alt="" width="585" height="320" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-1-wm-1.png 585w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-1-wm-1-300x164.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-1-wm-1-143x79.png 143w" sizes="(max-width: 585px) 100vw, 585px" /></a><p class="wp-caption-text"><i>Figure 1. MACH-O <span style="font-family: courier new, courier, monospace;">__cfstring</span> section attributes</i></p></div>
<p>As seen in Figure 2, the fact that the code is in the <span style="font-family: courier new, courier, monospace;">__cfstring</span> section tricks some disassembly tools to display the code as strings.</p>
<div id="attachment_124260" style="width: 595px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/04/Figure-2-wm2.png"><img class="wp-image-124260" src="/wp-content/uploads/2019/04/Figure-2-wm2.png" alt="" width="585" height="65" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-2-wm2.png 813w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-2-wm2-300x34.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-2-wm2-768x86.png 768w" sizes="(max-width: 585px) 100vw, 585px" /></a><p class="wp-caption-text"><i>Figure 2. The backdoor code is defined as data by IDA</i></p></div>
<p>When run, the binary first creates a thread as an anti-debugging watchdog whose sole purpose is to continuously check if a debugger is present. In order to do that, this thread:</p>
<ul>
<li>Tries to detach any debugger by calling <span style="font-family: courier new, courier, monospace;">ptrace </span>with <span style="font-family: courier new, courier, monospace;">PT_DENY_ATTACH</span> as a request parameter</li>
<li>Checks if some exception ports are open by calling the <span style="font-family: courier new, courier, monospace;">task_get_exception_ports</span> function</li>
<li>Checks if a debugger is attached, as seen in Figure 3, by verifying if the <span style="font-family: courier new, courier, monospace;">P_TRACED</span> flag is set in the current process</li>
</ul>
<div id="attachment_124261" style="width: 595px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/04/Figure-3-wm.png"><img class="wp-image-124261" src="/wp-content/uploads/2019/04/Figure-3-wm.png" alt="" width="585" height="167" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-3-wm.png 476w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-3-wm-300x86.png 300w" sizes="(max-width: 585px) 100vw, 585px" /></a><p class="wp-caption-text"><i>Figure 3. Check if a debugger is attached via <span style="font-family: courier new, courier, monospace;">sysctl</span> function</i></p></div>
<p>If the watchdog detects that a debugger is present the <span style="font-family: courier new, courier, monospace;">exit </span>function is called. Moreover, the sample then checks its environment by issuing the following two commands:<br />
<span style="font-family: courier new, courier, monospace;">ioreg -l | grep -e &#8220;Manufacturer&#8221;</span> and <span style="font-family: courier new, courier, monospace;">sysctl hw.model</span><br />
and checks the return value against a hardcoded list of known virtualization system strings: oracle, vmware, virtualbox or parallels. Finally, the command:<br />
<span style="font-family: courier new, courier, monospace;">system_profiler SPHardwareDataType 2&gt;/dev/null | awk &#8216;/Boot ROM Version/ {split($0, line, &#8220;:&#8221;);printf(&#8220;%s&#8221;, line[2]);}</span><br />
checks if the machine is one of the following: &#8220;MBP&#8221;, “MBA”, “MB”, “MM”, “IM”, “MP” and “XS”. These codes represent the model of the system. For instance, “MBP” stands for MacBook Pro, “MBA” stands for MacBook Air and so on…</p>
<h2>Major updates</h2>
<p>Even though the backdoor commands have not changed since the Trend Micro article, we noticed a few other modifications. The C&amp;C servers used for this sample are quite recent as their creation date is 2018-10-22.</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">daff.faybilodeau[.]com</span></li>
<li><span style="font-family: courier new, courier, monospace;">sarc.onteagleroad[.]com</span></li>
<li><span style="font-family: courier new, courier, monospace;">au.charlineopkesston[.]com</span></li>
</ul>
<p>The URL resource used has changed to <span style="font-family: courier new, courier, monospace;">/dp/B074WC4NHW/ref=gbps_img_m-9_62c3_750e6b35</span>.</p>
<p>The first packet that is sent to the C&amp;C server contains more information regarding the host machine. All data gathered by the commands in the following table are included.</p>

<table id="tablepress-661" class="tablepress tablepress-id-661">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Commands</th><th class="column-2">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">system_profiler SPHardwareDataType 2>/dev/null | awk '/Processor / {split($0,line,":"); printf("%s",line[2]);}'<br />
machdep.cpu.brand_string</td><td class="column-2">Gather processor information</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">system_profiler SPHardwareDataType 2>/dev/null | awk '/Memory/ {split($0,line, ":"); printf("%s", line[2]);}'</td><td class="column-2">Gather memory information</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">ifconfig -l</td><td class="column-2">Gather network interface MAC addresses</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">ioreg -rd1 -c IOPlatformExpertDevice | awk '/IOPlatformSerialNumber/ { split($0, line, "\""); printf("%s", line[4]); }'</td><td class="column-2">Retrieves the serial number of the device</td>
</tr>
</tbody>
</table>

<p>On top of this configuration change, this sample does not use the <a href="https://curl.haxx.se/libcurl/" target="_blank" rel="noopener">libcurl</a> library for network exfiltration. Instead, it uses an external library. To locate it, the backdoor tries to decrypt each file in the current directory using AES-256-CBC with the key <span style="font-family: courier new, courier, monospace;">gFjMXBgyXWULmVVVzyxy </span>padded with zeroes. Each file is “decrypted” and saved as <span style="font-family: courier new, courier, monospace;">/tmp/store </span>and an attempt to load it as a library made using the <a href="https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/dlopen.3.html" target="_blank" rel="noopener">dlopen</a> function. When a decryption attempt results in a successful call to dlopen, the backdoor then retrieves the exported functions <span style="font-family: courier new, courier, monospace;">Boriry </span>and <span style="font-family: courier new, courier, monospace;">ChadylonV</span><strong>,</strong> which seem to be responsible for the network communication with the server. As we do not have the dropper or other files from the original sample’s location, we could not analyse this library. Moreover, since the component is encrypted, a YARA rule based on these strings would not match the file found on disk.</p>
<p>As described in the analysis of the group’s previous macOS backdoor, a <em>clientID</em> is created. This identifier is the MD5 hash of the return value of one of the following commands:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">ioreg -rd1 -c IOPlatformExpertDevice | awk &#8216;/IOPlatformSerialNumber/ { split($0, line, &#8220;\&#8221;&#8221;); printf(&#8220;%s&#8221;, line[4]); }&#8217;</span></li>
<li><span style="font-family: courier new, courier, monospace;">ioreg -rd1 -c IOPlatformExpertDevice | awk &#8216;/IOPlatformUUID/ { split($0, line, &#8220;\&#8221;&#8221;); printf(&#8220;%s&#8221;, line[4]); }&#8217;</span></li>
<li><span style="font-family: courier new, courier, monospace;">ifconfig en0 | awk \&#8217;/ether /{print $2}\&#8217;</span> (obtain the MAC address)</li>
<li>an unknown command (&#8220;<span style="font-family: courier new, courier, monospace;">\x1e\x72\x0a</span>&#8220;) which used to be “uuidgen” in the previous samples</li>
</ul>
<p>Before being hashed, the character “0” or “1” is appended to the return value indicating root privileges. This <em>clientID</em> is stored in <span style="font-family: courier new, courier, monospace;">/Library/Storage/File System/HFS/25cf5d02-e50b-4288-870a-528d56c3cf6e/pivtoken.appex</span> if the code runs as root, or in <span style="font-family: courier new, courier, monospace;">~/Library/SmartCardsServices/Technology/PlugIns/drivers/snippets.ecgML</span> otherwise. This file is normally hidden via the <a href="https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man2/chflags.2.html" target="_blank" rel="noopener">_<span style="font-family: courier new, courier, monospace;">chflags</span></a> function and its timestamp is modified using the “<span style="font-family: courier new, courier, monospace;">touch –t</span>” command with a random value.</p>
<h2>String decryption</h2>
<p>Like previous variants, the strings are encrypted using AES-256-CBC (hex-encoded key: <span style="font-family: courier new, courier, monospace;">9D7274AD7BCEF0DED29BDBB428C251DF8B350B92</span> padded with zeroes and the IV is filled with zeroes) using the <span style="font-family: courier new, courier, monospace;"><a href="https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/CCCrypt.3cc.html" target="_blank" rel="noopener">CCCrypt</a> </span>function. The key has changed from previous versions but since the group is still using the same algorithm to encrypt strings, decryption could be automated. Along with this article, we are releasing an IDA script leveraging the Hex-Rays API to decrypt the strings present in the binary. This script may help future analysis of OceanLotus and the analysis of existing samples that we have not yet been able to obtain. At the core of this script lies a generic method to obtain the arguments passed to a function. Moreover, it looks for the parameter assignments in order to find their values. This method could be reused to retrieve the list of arguments of a function and then pass them to a callback.</p>
<p>Knowing the prototype of the <em>decrypt</em> function, the script first finds all cross-references to this function, finds all the arguments, decrypts the data and puts the plaintext inside a comment at the address of the cross-reference. In order for the script to work correctly, the custom alphabet used by the base64 decode function must be set in the script and the global variable containing the length of the key must be defined (as a DWORD in this case; see Figure 4).</p>
<div id="attachment_124262" style="width: 701px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/04/Figure-4-wm.png"><img class="wp-image-124262" src="/wp-content/uploads/2019/04/Figure-4-wm.png" alt="" width="691" height="113" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-4-wm.png 837w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-4-wm-300x49.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-4-wm-768x126.png 768w" sizes="(max-width: 691px) 100vw, 691px" /></a><p class="wp-caption-text"><i>Figure 4. Defining the global variable <em><span style="font-family: courier new, courier, monospace;">key_len</span></em></i></p></div>
<p>In the <em>Function</em> window, you can right-click the decryption function and click “Extract and decrypt arguments”. The script should put the decrypted strings in comments, much as in Figure 5.</p>
<div id="attachment_124263" style="width: 701px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/04/Figure-5-wm.png"><img class="wp-image-124263 size-full" src="/wp-content/uploads/2019/04/Figure-5-wm.png" alt="" width="691" height="501" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-5-wm.png 691w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-5-wm-300x218.png 300w" sizes="(max-width: 691px) 100vw, 691px" /></a><p class="wp-caption-text"><i>Figure 5. Decrypted text is put into comments</i></p></div>
<p>This conveniently lists the decrypted strings together in IDA’s <em>xrefs to</em> window for that function, as seen in Figure 6.</p>
<div id="attachment_124267" style="width: 701px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/04/Figure-6-wm.png"><img class="wp-image-124267" src="/wp-content/uploads/2019/04/Figure-6-wm-1024x461.png" alt="" width="691" height="311" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-6-wm-1024x461.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-6-wm-300x135.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-6-wm-768x346.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/04/Figure-6-wm.png 1217w" sizes="(max-width: 691px) 100vw, 691px" /></a><p class="wp-caption-text"><i>Figure 6. <em>Xrefs</em> to of <em><span style="font-family: courier new, courier, monospace;">f_decrypt</span> </em>function</i></p></div>
<p>The final script can be found on our <a href="https://github.com/eset/malware-research/tree/master/oceanlotus/" target="_blank" rel="noopener">Github repository</a>.</p>
<h1>Conclusion</h1>
<p>As recently documented in another of our <a href="https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/" target="_blank" rel="noopener">articles</a>, the OceanLotus group keeps improving and updating its toolset, and once again, it has improved its tools for targeting Mac users. The code has not changed that much, but because many Mac users don’t run security software on their machines, the need to evade detection is of less importance. ESET products already detected this file when we found it. Since the network library used for the C&amp;C communication is now encrypted on the disk, the exact network protocol used remains unknown.</p>
<h1>Indicators of Compromise (IoCs)</h1>
<p>The IoCs in this blogpost, as well as the MITRE ATT&amp;CK attributes, are also available in our <a href="https://github.com/eset/malware-ioc/tree/master/oceanlotus" target="_blank" rel="noopener">GitHub repository</a>.</p>
<h2>Domain names</h2>
<ul>
<li><span style="font-family: courier new, courier, monospace;">daff.faybilodeau[.]com</span></li>
<li><span style="font-family: courier new, courier, monospace;">sarc.onteagleroad[.]com</span></li>
<li><span style="font-family: courier new, courier, monospace;">au.charlineopkesston[.]com</span></li>
</ul>
<h2>URL resource</h2>
<ul>
<li><span style="font-family: courier new, courier, monospace;">/dp/B074WC4NHW/ref=gbps_img_m-9_62c3_750e6b35</span></li>
</ul>
<h2>File paths</h2>
<ul>
<li><span style="font-family: courier new, courier, monospace;">~/Library/SmartCardsServices/Technology/PlugIns/drivers/snippets.ecgML</span></li>
<li><span style="font-family: courier new, courier, monospace;">/Library/Storage/File System/HFS/25cf5d02-e50b-4288-870a-528d56c3cf6e/pivtoken.appex</span></li>
<li><span style="font-family: courier new, courier, monospace;">/tmp/store</span></li>
</ul>

<table id="tablepress-662" class="tablepress tablepress-id-662">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Sample analyzed</th><th class="column-2">SHA-1 hash</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">fleshlightd</td><td class="column-2">E615632C9998E4D3E5ACD8851864ED09B02C77D2</td><td class="column-3">OSX/OceanLotus.D</td>
</tr>
</tbody>
</table>

<h1><a href="https://attack.mitre.org/matrices/enterprise/macos/" target="_blank" rel="noopener">MITRE ATT&amp;CK techniques</a></h1>

<table id="tablepress-663" class="tablepress tablepress-id-663">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="5" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1158/" rel="noopener" target="_blank"><b>T1158</b></a></td><td class="column-3">Hidden Files and Directories</td><td class="column-4">The backdoor hides the <em>clientID </em> file via <span style="font-family: courier new, courier, monospace;"><strong>chflags</strong></span> function.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1107/" rel="noopener" target="_blank"><b>T1107</b></a></td><td class="column-3">File Deletion</td><td class="column-4">The backdoor can receive a “delete” command.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1222/" rel="noopener" target="_blank"><b>T1222</b></a></td><td class="column-3">File Permissions Modification</td><td class="column-4">The backdoor changes the permission of the file it wants to execute to 755.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1027/" rel="noopener" target="_blank"><b>T1027</b></a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">The library used for network exfiltration is encrypted with AES-256 in CBC mode.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1099/" rel="noopener" target="_blank"><b>T1099</b></a> (macOS)</td><td class="column-3">Timestomp</td><td class="column-4">The timestamp of the file storing the clientID is modified with a random value.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank"><b>T1082</b></a></td><td class="column-3">System Information Discovery</td><td class="column-4">The backdoor performs a fingerprint of the machine on its first connection to the C&amp;C server.</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1022/" rel="noopener" target="_blank"><b>T1022</b></a></td><td class="column-3">Data Encrypted</td><td class="column-4">The backdoor encrypts the data before exfiltration.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1094/" rel="noopener" target="_blank"><b>T1094</b></a></td><td class="column-3">Custom Command and Control Protocol</td><td class="column-4">The backdoor implements a specific format for the packet involving random values. See <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/new-macos-backdoor-linked-to-oceanlotus-found/" rel="noopener" target="_blank">Trend Micro article</a>.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/romaindupont/" title="Romain Dumont">
                    Romain Dumont                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-04-09 11:30:51">9 Apr 2019 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybersecurity/" class="category-tag-btn">Cybersecurity</a>                                                <a href="https://www.welivesecurity.com/2021/05/12/eset-research-rsa-conference-2021-presentations/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/05/eset-research-rsa2021-conference-preview-623x415.jpg"
                                                         alt="OceanLotus: macOS malware update">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/05/12/eset-research-rsa-conference-2021-presentations/">
                                                    ESET Research goes to RSA Conference 2021 with two presentations                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/05/ousaban-banking-trojan-brazil-eset-research-623x415.jpg"
                                                         alt="OceanLotus: macOS malware update">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/">
                                                    Ousaban: Private photo collection hidden in a CABinet                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/04/14/fbi-removes-malware-compromised-exchange-servers/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/fbi-removing-malware-exchange-server-623x415.jpg"
                                                         alt="OceanLotus: macOS malware update">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/14/fbi-removes-malware-compromised-exchange-servers/">
                                                    FBI removes web shells from compromised Exchange servers                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/04/08/are-you-afreight-dark-watch-out-vyveva-new-lazarus-backdoor/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/lazarus-vyveva-backdoor-south-africa-623x432.jpg"
                                                         alt="OceanLotus: macOS malware update">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/08/are-you-afreight-dark-watch-out-vyveva-new-lazarus-backdoor/">
                                                    (Are you) afreight of the dark? Watch out for Vyveva, new Lazarus backdoor                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F04%2F09%2Foceanlotus-macos-malware-update%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F04%2F09%2Foceanlotus-macos-malware-update%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F04%2F09%2Foceanlotus-macos-malware-update%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.2.0.adc7d1ec.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"124239 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=124239","disqusShortname":"welivesecurity","disqusTitle":"OceanLotus: macOS malware update","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/04\/09\/oceanlotus-macos-malware-update\/","postId":"124239"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>