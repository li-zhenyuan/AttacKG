<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">

<title>Kerberoasting Without Mimikatz &#8211; harmj0y</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Feed" href="https://www.harmj0y.net/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Comments Feed" href="https://www.harmj0y.net/blog/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Kerberoasting Without Mimikatz Comments Feed" href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/feed/" />
		<script>
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.harmj0y.net\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style>
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='crayon-css'  href='https://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='astra-theme-css-css'  href='https://www.harmj0y.net/blog/wp-content/themes/astra/assets/css/minified/main.min.css?ver=3.4.2' media='all' />
<style id='astra-theme-css-inline-css'>
html{font-size:93.75%;}a,.page-title{color:#1d798b;}a:hover,a:focus{color:#f9f9f9;}body,button,input,select,textarea,.ast-button,.ast-custom-button{font-family:'Roboto',sans-serif;font-weight:400;font-size:15px;font-size:1rem;}blockquote{color:#000000;}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6,.site-title,.site-title a{font-family:'Oxanium',display;font-weight:400;}.site-title{font-size:35px;font-size:2.3333333333333rem;}header .custom-logo-link img{max-width:120px;}.astra-logo-svg{width:120px;}.ast-archive-description .ast-archive-title{font-size:40px;font-size:2.6666666666667rem;}.site-header .site-description{font-size:15px;font-size:1rem;}.entry-title{font-size:30px;font-size:2rem;}h1,.entry-content h1{font-size:40px;font-size:2.6666666666667rem;font-weight:400;font-family:'Oxanium',display;}h2,.entry-content h2{font-size:30px;font-size:2rem;font-weight:400;font-family:'Oxanium',display;}h3,.entry-content h3{font-size:25px;font-size:1.6666666666667rem;font-weight:400;font-family:'Oxanium',display;}h4,.entry-content h4{font-size:20px;font-size:1.3333333333333rem;}h5,.entry-content h5{font-size:18px;font-size:1.2rem;}h6,.entry-content h6{font-size:15px;font-size:1rem;}.ast-single-post .entry-title,.page-title{font-size:30px;font-size:2rem;}::selection{background-color:#33ccda;color:#000000;}body,h1,.entry-title a,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:#3a3a3a;}.tagcloud a:hover,.tagcloud a:focus,.tagcloud a.current-item{color:#ffffff;border-color:#1d798b;background-color:#1d798b;}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,textarea:focus{border-color:#1d798b;}input[type="radio"]:checked,input[type=reset],input[type="checkbox"]:checked,input[type="checkbox"]:hover:checked,input[type="checkbox"]:focus:checked,input[type=range]::-webkit-slider-thumb{border-color:#1d798b;background-color:#1d798b;box-shadow:none;}.site-footer a:hover + .post-count,.site-footer a:focus + .post-count{background:#1d798b;border-color:#1d798b;}.single .nav-links .nav-previous,.single .nav-links .nav-next{color:#1d798b;}.entry-meta,.entry-meta *{line-height:1.45;color:#1d798b;}.entry-meta a:hover,.entry-meta a:hover *,.entry-meta a:focus,.entry-meta a:focus *,.page-links > .page-link,.page-links .page-link:hover,.post-navigation a:hover{color:#f9f9f9;}.widget-title{font-size:21px;font-size:1.4rem;color:#3a3a3a;}#cat option,.secondary .calendar_wrap thead a,.secondary .calendar_wrap thead a:visited{color:#1d798b;}.secondary .calendar_wrap #today,.ast-progress-val span{background:#1d798b;}.secondary a:hover + .post-count,.secondary a:focus + .post-count{background:#1d798b;border-color:#1d798b;}.calendar_wrap #today > a{color:#ffffff;}.page-links .page-link,.single .post-navigation a{color:#1d798b;}#secondary,#secondary button,#secondary input,#secondary select,#secondary textarea{font-size:15px;font-size:1rem;}#secondary {margin: 4em 0 2.5em;word-break: break-word;line-height: 2;}#secondary li {margin-bottom: 0.25em;}#secondary li:last-child {margin-bottom: 0;}@media (max-width: 768px) {.js_active .ast-plain-container.ast-single-post #secondary {margin-top: 1.5em;}}.ast-separate-container.ast-two-container #secondary .widget {background-color: #fff;padding: 2em;margin-bottom: 2em;}@media (min-width: 993px) {.ast-left-sidebar #secondary {padding-right: 60px;}.ast-right-sidebar #secondary {padding-left: 60px;}}@media (max-width: 993px) {.ast-right-sidebar #secondary {padding-left: 30px;}.ast-left-sidebar #secondary {padding-right: 30px;}}.wp-block-buttons.aligncenter{justify-content:center;}@media (min-width:1200px){.ast-separate-container.ast-right-sidebar .entry-content .wp-block-image.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-image.alignfull,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignfull{margin-left:-6.67em;margin-right:-6.67em;max-width:unset;width:unset;}.ast-separate-container.ast-right-sidebar .entry-content .wp-block-image.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-image.alignwide,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignwide{margin-left:-20px;margin-right:-20px;max-width:unset;width:unset;}}@media (min-width:1200px){.wp-block-group .has-background{padding:20px;}}@media (min-width:1200px){.ast-separate-container.ast-right-sidebar .entry-content .wp-block-group.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-group.alignwide,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignwide{margin-left:-20px;margin-right:-20px;padding-left:20px;padding-right:20px;}.ast-separate-container.ast-right-sidebar .entry-content .wp-block-group.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-group.alignfull,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignfull{margin-left:-6.67em;margin-right:-6.67em;padding-left:6.67em;padding-right:6.67em;}}@media (min-width:1200px){.wp-block-cover-image.alignwide .wp-block-cover__inner-container,.wp-block-cover.alignwide .wp-block-cover__inner-container,.wp-block-cover-image.alignfull .wp-block-cover__inner-container,.wp-block-cover.alignfull .wp-block-cover__inner-container{width:100%;}}.ast-plain-container.ast-no-sidebar #primary{margin-top:0;margin-bottom:0;}@media (max-width:921px){.ast-theme-transparent-header #primary,.ast-theme-transparent-header #secondary{padding:0;}}.wp-block-columns{margin-bottom:unset;}.wp-block-image.size-full{margin:2rem 0;}.wp-block-separator.has-background{padding:0;}.wp-block-gallery{margin-bottom:1.6em;}.wp-block-group{padding-top:4em;padding-bottom:4em;}.wp-block-group__inner-container .wp-block-columns:last-child,.wp-block-group__inner-container :last-child,.wp-block-table table{margin-bottom:0;}.blocks-gallery-grid{width:100%;}.wp-block-navigation-link__content{padding:5px 0;}.wp-block-group .wp-block-group .has-text-align-center,.wp-block-group .wp-block-column .has-text-align-center{max-width:100%;}.has-text-align-center{margin:0 auto;}@media (min-width:1200px){.wp-block-cover__inner-container,.alignwide .wp-block-group__inner-container,.alignfull .wp-block-group__inner-container{max-width:1200px;margin:0 auto;}.wp-block-group.alignnone,.wp-block-group.aligncenter,.wp-block-group.alignleft,.wp-block-group.alignright,.wp-block-group.alignwide,.wp-block-columns.alignwide{margin:2rem 0 1rem 0;}}@media (max-width:1200px){.wp-block-group{padding:3em;}.wp-block-group .wp-block-group{padding:1.5em;}.wp-block-columns,.wp-block-column{margin:1rem 0;}}@media (min-width:921px){.wp-block-columns .wp-block-group{padding:2em;}}@media (max-width:544px){.wp-block-cover-image .wp-block-cover__inner-container,.wp-block-cover .wp-block-cover__inner-container{width:unset;}.wp-block-cover,.wp-block-cover-image{padding:2em 0;}.wp-block-group,.wp-block-cover{padding:2em;}.wp-block-media-text__media img,.wp-block-media-text__media video{width:unset;max-width:100%;}.wp-block-media-text.has-background .wp-block-media-text__content{padding:1em;}}@media (max-width:921px){.ast-plain-container.ast-no-sidebar #primary{padding:0;}}@media (min-width:544px){.entry-content .wp-block-media-text.has-media-on-the-right .wp-block-media-text__content{padding:0 8% 0 0;}.entry-content .wp-block-media-text .wp-block-media-text__content{padding:0 0 0 8%;}.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-bottom-left > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-bottom-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-top-left > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-top-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-center-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-center-left > *{margin:0;}}@media (max-width:544px){.entry-content .wp-block-media-text .wp-block-media-text__content{padding:8% 0;}.wp-block-media-text .wp-block-media-text__media img{width:auto;max-width:100%;}}.wp-block-button.is-style-outline .wp-block-button__link{border-color:#33ccda;border-top-width:2px;border-right-width:2px;border-bottom-width:2px;border-left-width:2px;}.wp-block-button.is-style-outline > .wp-block-button__link:not(.has-text-color),.wp-block-button.wp-block-button__link.is-style-outline:not(.has-text-color){color:#33ccda;}.wp-block-button.is-style-outline .wp-block-button__link:hover,.wp-block-button.is-style-outline .wp-block-button__link:focus{color:#000000 !important;background-color:#f9f9f9;border-color:#f9f9f9;}.post-page-numbers.current .page-link,.ast-pagination .page-numbers.current{color:#000000;border-color:#33ccda;background-color:#33ccda;border-radius:2px;}@media (max-width:921px){.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (max-width:544px){.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (min-width:544px){.entry-content > .alignleft{margin-right:20px;}.entry-content > .alignright{margin-left:20px;}.wp-block-group.has-background{padding:20px;}}@media (max-width:921px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single{padding:1.5em 2.14em;}.ast-separate-container #primary,.ast-separate-container #secondary{padding:1.5em 0;}#primary,#secondary{padding:1.5em 0;margin:0;}.ast-left-sidebar #content > .ast-container{display:flex;flex-direction:column-reverse;width:100%;}.ast-author-box img.avatar{margin:20px 0 0 0;}}@media (max-width:921px){#secondary.secondary{padding-top:0;}.ast-separate-container.ast-right-sidebar #secondary{padding-left:1em;padding-right:1em;}.ast-separate-container.ast-two-container #secondary{padding-left:0;padding-right:0;}.ast-page-builder-template .entry-header #secondary,.ast-page-builder-template #secondary{margin-top:1.5em;}}@media (max-width:921px){.ast-right-sidebar #primary{padding-right:0;}.ast-page-builder-template.ast-left-sidebar #secondary,.ast-page-builder-template.ast-right-sidebar #secondary{padding-right:20px;padding-left:20px;}.ast-right-sidebar #secondary,.ast-left-sidebar #primary{padding-left:0;}.ast-left-sidebar #secondary{padding-right:0;}}@media (min-width:922px){.ast-separate-container.ast-right-sidebar #primary,.ast-separate-container.ast-left-sidebar #primary{border:0;}.search-no-results.ast-separate-container #primary{margin-bottom:4em;}}@media (min-width:922px){.ast-right-sidebar #primary{border-right:1px solid #eee;}.ast-left-sidebar #primary{border-left:1px solid #eee;}.ast-right-sidebar #secondary{border-left:1px solid #eee;margin-left:-1px;}.ast-left-sidebar #secondary{border-right:1px solid #eee;margin-right:-1px;}.ast-separate-container.ast-two-container.ast-right-sidebar #secondary{padding-left:30px;padding-right:0;}.ast-separate-container.ast-two-container.ast-left-sidebar #secondary{padding-right:30px;padding-left:0;}.ast-separate-container.ast-right-sidebar #secondary,.ast-separate-container.ast-left-sidebar #secondary{border:0;margin-left:auto;margin-right:auto;}.ast-separate-container.ast-two-container #secondary .widget:last-child{margin-bottom:0;}}.wp-block-button .wp-block-button__link,{color:#000000;}.wp-block-button .wp-block-button__link:hover,.wp-block-button .wp-block-button__link:focus{color:#000000;background-color:#f9f9f9;border-color:#f9f9f9;}.wp-block-button .wp-block-button__link{border:none;background-color:#33ccda;color:#000000;font-family:inherit;font-weight:inherit;line-height:1;border-radius:2px;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{border-style:solid;border-top-width:2px;border-right-width:2px;border-left-width:2px;border-bottom-width:2px;border-color:#33ccda;padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}@media (max-width:921px){.wp-block-button .wp-block-button__link{border:none;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (max-width:544px){.wp-block-button .wp-block-button__link{border:none;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}.menu-toggle,button,.ast-button,.ast-custom-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"]{border-style:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;color:#000000;border-color:#33ccda;background-color:#33ccda;border-radius:2px;padding-top:10px;padding-right:40px;padding-bottom:10px;padding-left:40px;font-family:inherit;font-weight:inherit;line-height:1;}button:focus,.menu-toggle:hover,button:hover,.ast-button:hover,.ast-custom-button:hover .button:hover,.ast-custom-button:hover ,input[type=reset]:hover,input[type=reset]:focus,input#submit:hover,input#submit:focus,input[type="button"]:hover,input[type="button"]:focus,input[type="submit"]:hover,input[type="submit"]:focus{color:#000000;background-color:#f9f9f9;border-color:#f9f9f9;}@media (min-width:544px){.ast-container{max-width:100%;}}@media (max-width:544px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single,.ast-separate-container .comments-title,.ast-separate-container .ast-archive-description{padding:1.5em 1em;}.ast-separate-container #content .ast-container{padding-left:0.54em;padding-right:0.54em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-search-menu-icon.ast-dropdown-active .search-field{width:170px;}.ast-separate-container #secondary{padding-top:0;}.ast-separate-container.ast-two-container #secondary .widget{margin-bottom:1.5em;padding-left:1em;padding-right:1em;}}@media (max-width:544px){.ast-separate-container .comments-count-wrapper{padding:1.5em 1em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-separate-container .comment-respond{padding:1.5em 1em;}}@media (max-width:544px){.ast-comment-list .children{margin-left:0.66666em;}.ast-separate-container .ast-comment-list .bypostauthor li{padding:0 0 0 .5em;}}@media (max-width:921px){.ast-mobile-header-stack .main-header-bar .ast-search-menu-icon{display:inline-block;}.ast-header-break-point.ast-header-custom-item-outside .ast-mobile-header-stack .main-header-bar .ast-search-icon{margin:0;}.ast-comment-avatar-wrap img{max-width:2.5em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}}@media (max-width:921px){.ast-comment-avatar-wrap img{max-width:2.5em;}.comments-area{margin-top:1.5em;}.ast-separate-container .comments-count-wrapper{padding:2em 2.14em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}}@media (max-width:921px){.ast-comment-avatar-wrap{margin-right:0.5em;}}body,.ast-separate-container{background-color:#f9f9f9;;background-image:none;;}@media (max-width:921px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:30px;}}@media (max-width:544px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:30px;}}@media (max-width:921px){html{font-size:85.5%;}}@media (max-width:544px){html{font-size:85.5%;}}@media (min-width:922px){.ast-container{max-width:1240px;}}@media (min-width:922px){.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu:hover > .sub-menu,.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu.focus > .sub-menu{margin-left:-0px;}}.ast-breadcrumbs .trail-browse,.ast-breadcrumbs .trail-items,.ast-breadcrumbs .trail-items li{display:inline-block;margin:0;padding:0;border:none;background:inherit;text-indent:0;}.ast-breadcrumbs .trail-browse{font-size:inherit;font-style:inherit;font-weight:inherit;color:inherit;}.ast-breadcrumbs .trail-items{list-style:none;}.trail-items li::after{padding:0 0.3em;content:"\00bb";}.trail-items li:last-of-type::after{display:none;}@media (max-width:921px){.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}@media (max-width:544px){.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}.ast-builder-layout-element[data-section="title_tagline"]{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}.ast-builder-menu-1{font-family:'Oxanium',display;font-weight:inherit;text-transform:uppercase;}.ast-builder-menu-1 .menu-item > .menu-link{color:#33ccda;}.ast-builder-menu-1 .menu-item > .ast-menu-toggle{color:#33ccda;}.ast-builder-menu-1 .menu-item:hover > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:#ffffff;}.ast-builder-menu-1 .menu-item:hover > .ast-menu-toggle{color:#ffffff;}.ast-builder-menu-1 .sub-menu,.ast-builder-menu-1 .inline-on-mobile .sub-menu{border-top-width:2px;border-bottom-width:0;border-right-width:0;border-left-width:0;border-color:#33ccda;border-style:solid;border-radius:0;}.ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu,.ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper{margin-top:0;}.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu:before,.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper:before{height:calc( 0px + 5px );}.ast-desktop .ast-builder-menu-1 .menu-item .sub-menu .menu-link{border-style:none;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-1 .menu-item-has-children > .menu-link:after{content:unset;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-1{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}.site-below-footer-wrap[data-section="section-below-footer-builder"]{background-color:#eeeeee;;min-height:80px;}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row{max-width:1200px;margin-left:auto;margin-right:auto;}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row,.site-below-footer-wrap[data-section="section-below-footer-builder"] .site-footer-section{align-items:flex-start;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-full .ast-builder-grid-row{grid-template-columns:1fr;}@media (max-width:921px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-full .ast-builder-grid-row{grid-template-columns:1fr;}}@media (max-width:544px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}.ast-footer-copyright{text-align:center;}.ast-footer-copyright {color:#3a3a3a;}@media (max-width:921px){.ast-footer-copyright{text-align:center;}}@media (max-width:544px){.ast-footer-copyright{text-align:center;}}.ast-footer-copyright.ast-builder-layout-element{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}.site-footer{background-color:;;background-image:none;;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{background-color:#f9f9f9;;border-style:solid;border-width:0px;border-top-width:1px;border-top-color:#e6e6e6;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row{max-width:1200px;margin-left:auto;margin-right:auto;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row,.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .site-footer-section{align-items:flex-start;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}@media (max-width:921px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}}@media (max-width:544px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}.elementor-template-full-width .ast-container{display:block;}.ast-header-break-point .main-header-bar{border-bottom-width:1px;}@media (min-width:922px){.main-header-bar{border-bottom-width:1px;}}@media (min-width:922px){#primary{width:70%;}#secondary{width:30%;}}.ast-safari-browser-less-than-11 .main-header-menu .menu-item, .ast-safari-browser-less-than-11 .main-header-bar .ast-masthead-custom-menu-items{display:block;}.main-header-menu .menu-item, #astra-footer-menu .menu-item, .main-header-bar .ast-masthead-custom-menu-items{-js-display:flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;}.main-header-menu > .menu-item > .menu-link, #astra-footer-menu > .menu-item > .menu-link,{height:100%;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-js-display:flex;display:flex;}.ast-primary-menu-disabled .main-header-bar .ast-masthead-custom-menu-items{flex:unset;}.ast-header-break-point .main-navigation ul .menu-item .menu-link .icon-arrow:first-of-type svg{top:.2em;margin-top:0px;margin-left:0px;width:.65em;transform:translate(0, -2px) rotateZ(270deg);}.ast-mobile-popup-content .ast-submenu-expanded > .ast-menu-toggle{transform:rotateX(180deg);}.ast-mobile-header-content > *,.ast-desktop-header-content > * {padding: 10px 0;height: auto;}.ast-mobile-header-content > *:first-child,.ast-desktop-header-content > *:first-child {padding-top: 10px;}.ast-mobile-header-content > .ast-builder-menu,.ast-desktop-header-content > .ast-builder-menu {padding-top: 0;}.ast-mobile-header-content > *:last-child,.ast-desktop-header-content > *:last-child {padding-bottom: 0;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search label,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search label {width: 100%;}.ast-desktop-header-content .main-header-bar-navigation .ast-submenu-expanded > .ast-menu-toggle::before {transform: rotateX(180deg);}#ast-desktop-header .ast-desktop-header-content,.ast-mobile-header-content .ast-search-icon,.ast-desktop-header-content .ast-search-icon,.ast-off-canvas-active .ast-main-header-nav-open.ast-popup-nav-open .ast-mobile-header-wrap .ast-mobile-header-content,.ast-mobile-header-wrap .ast-mobile-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-mobile-header-wrap .ast-mobile-header-content,.ast-off-canvas-active .ast-main-header-nav-open.ast-popup-nav-open .ast-desktop-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-desktop-header-content {display: none;}.ast-main-header-nav-open.ast-header-break-point #ast-desktop-header .ast-desktop-header-content,.ast-main-header-nav-open.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content {display: block;}.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item .menu-item > .sub-menu {opacity: 1;visibility: visible;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation {width: unset;margin: unset;}.ast-mobile-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle,.ast-desktop-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle {left: calc( 20px - 0.907em);}.ast-mobile-header-content .ast-search-menu-icon,.ast-mobile-header-content .ast-search-menu-icon.slide-search,.ast-desktop-header-content .ast-search-menu-icon,.ast-desktop-header-content .ast-search-menu-icon.slide-search {width: 100%;position: relative;display: block;right: auto;transform: none;}.ast-mobile-header-content .ast-search-menu-icon.slide-search .search-form,.ast-mobile-header-content .ast-search-menu-icon .search-form,.ast-desktop-header-content .ast-search-menu-icon.slide-search .search-form,.ast-desktop-header-content .ast-search-menu-icon .search-form {right: 0;visibility: visible;opacity: 1;position: relative;top: auto;transform: none;padding: 0;display: block;overflow: hidden;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-mobile-header-content .ast-search-menu-icon .search-field,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-desktop-header-content .ast-search-menu-icon .search-field {width: 100%;padding-right: 5.5em;}.ast-mobile-header-content .ast-search-menu-icon .search-submit,.ast-desktop-header-content .ast-search-menu-icon .search-submit {display: block;position: absolute;height: 100%;top: 0;right: 0;padding: 0 1em;border-radius: 0;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation ul .sub-menu .menu-link {padding-left: 30px;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation .sub-menu .menu-item .menu-item .menu-link {padding-left: 40px;}.ast-mobile-popup-drawer.active .ast-mobile-popup-inner{background-color:#ffffff;;}.ast-mobile-header-wrap .ast-mobile-header-content, .ast-desktop-header-content{background-color:#ffffff;;}.ast-mobile-popup-content > *, .ast-mobile-header-content > *, .ast-desktop-popup-content > *, .ast-desktop-header-content > *{padding-top:0;padding-bottom:0;}.content-align-flex-start .ast-builder-layout-element{justify-content:flex-start;}.content-align-flex-start .main-header-menu{text-align:left;}.ast-mobile-popup-drawer.active .ast-mobile-popup-drawer.active .menu-toggle-close{color:#3a3a3a;}.ast-mobile-header-wrap .ast-primary-header-bar,.ast-primary-header-bar .site-primary-header-wrap{min-height:70px;}.ast-desktop .ast-primary-header-bar .main-header-menu > .menu-item{line-height:70px;}@media (max-width:921px){#masthead .ast-mobile-header-wrap .ast-above-header-bar,#masthead .ast-mobile-header-wrap .ast-primary-header-bar,#masthead .ast-mobile-header-wrap .ast-below-header-bar{padding-left:20px;padding-right:20px;}}.ast-header-break-point .ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:#eaeaea;border-bottom-style:solid;}@media (min-width:922px){.ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:#eaeaea;border-bottom-style:solid;}}.ast-primary-header-bar{background-color:#191919;;background-image:none;;}.ast-primary-header-bar{display:block;}@media (max-width:921px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}@media (max-width:544px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}[data-section="section-header-mobile-trigger"] .ast-button-wrap .ast-mobile-menu-trigger-minimal{color:#33ccda;border:none;background:transparent;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-toggle-icon .ast-mobile-svg{width:20px;height:20px;fill:#33ccda;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-wrap .mobile-menu{color:#33ccda;}.ast-builder-menu-mobile .main-navigation .menu-item > .menu-link{font-family:inherit;font-weight:inherit;}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}.ast-hfb-header .ast-builder-menu-mobile .main-header-menu, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .menu-link, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .sub-menu .menu-link{border-style:none;}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}@media (max-width:921px){.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}}@media (max-width:544px){.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-mobile .main-navigation{display:block;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-vertical-menu .menu-item{align-items:center;}@media (max-width:921px){.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-vertical-menu{display:grid;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-vertical-menu .menu-item{align-items:center;}#astra-footer-menu .menu-item > a{padding-left:20px;padding-right:20px;}}@media (max-width:544px){.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-vertical-menu{display:grid;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-vertical-menu .menu-item{align-items:center;}}.footer-widget-area[data-section="section-footer-menu"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="section-footer-menu"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="section-footer-menu"]{display:block;}}.comment-reply-title{font-size:24px;font-size:1.6rem;}.ast-comment-meta{line-height:1.666666667;color:#1d798b;font-size:12px;font-size:0.8rem;}.ast-comment-list #cancel-comment-reply-link{font-size:15px;font-size:1rem;}.comments-title {padding: 2em 0;}.comments-title {font-weight: normal;word-wrap: break-word;}.ast-comment-list {margin: 0;word-wrap: break-word;padding-bottom: 0.5em;list-style: none;}.ast-comment-list li {list-style: none;}.ast-comment-list .ast-comment-edit-reply-wrap {-js-display: flex;display: flex;justify-content: flex-end;}.ast-comment-list .ast-edit-link {flex: 1;}.ast-comment-list .comment-awaiting-moderation {margin-bottom: 0;}.ast-comment {padding: 1em 0;}.ast-comment-info img {border-radius: 50%;}.ast-comment-cite-wrap cite {font-style: normal;}.comment-reply-title {padding-top: 1em;font-weight: normal;line-height: 1.65;}.ast-comment-meta {margin-bottom: 0.5em;}.comments-area {border-top: 1px solid #eeeeee;margin-top: 2em;}.comments-area .comment-form-comment {width: 100%;border: none;margin: 0;padding: 0;}.comments-area .comment-notes,.comments-area .comment-textarea,.comments-area .form-allowed-tags {margin-bottom: 1.5em;}.comments-area .form-submit {margin-bottom: 0;}.comments-area textarea#comment,.comments-area .ast-comment-formwrap input[type="text"] {width: 100%;border-radius: 0;vertical-align: middle;margin-bottom: 10px;}.comments-area .no-comments {margin-top: 0.5em;margin-bottom: 0.5em;}.comments-area p.logged-in-as {margin-bottom: 1em;}.ast-separate-container .comments-title {background-color: #fff;padding: 1.2em 3.99em 0;}.ast-separate-container .comments-area {border-top: 0;}.ast-separate-container .ast-comment-list {padding-bottom: 0;}.ast-separate-container .ast-comment-list li {background-color: #fff;}.ast-separate-container .ast-comment-list li.depth-1 {padding: 4em 6.67em;margin-bottom: 2em;}@media (max-width: 1200px) {.ast-separate-container .ast-comment-list li.depth-1 {padding: 3em 3.34em;}}.ast-separate-container .ast-comment-list li.depth-1 .children li {padding-bottom: 0;padding-top: 0;margin-bottom: 0;}.ast-separate-container .ast-comment-list li.depth-1 .ast-comment,.ast-separate-container .ast-comment-list li.depth-2 .ast-comment {border-bottom: 0;}.ast-separate-container .ast-comment-list .comment-respond {padding-top: 0;padding-bottom: 1em;background-color: transparent;}.ast-separate-container .ast-comment-list .pingback p {margin-bottom: 0;}.ast-separate-container .ast-comment-list .bypostauthor {padding: 2em;margin-bottom: 1em;}.ast-separate-container .ast-comment-list .bypostauthor li {background: transparent;margin-bottom: 0;padding: 0 0 0 2em;}.ast-separate-container .comment-respond {background-color: #fff;padding: 4em 6.67em;border-bottom: 0;}@media (max-width: 1200px) {.ast-separate-container .comment-respond {padding: 3em 2.34em;}}.ast-separate-container .comment-reply-title {padding-top: 0;}.ast-comment-list .children {margin-left: 2em;}@media (max-width: 992px) {.ast-comment-list .children {margin-left: 1em;}}.ast-comment-list #cancel-comment-reply-link {white-space: nowrap;font-size: 15px;font-size: 1rem;margin-left: 1em;}.ast-comment-info {display: flex;position: relative;}.ast-comment-meta {justify-content: right;padding: 0 3.4em 1.60em;}.ast-comment-time .timendate{margin-right: 0.5em;}.comments-area #wp-comment-cookies-consent {margin-right: 10px;}.ast-page-builder-template .comments-area {padding-left: 20px;padding-right: 20px;margin-top: 2em;margin-bottom: 2em;}.ast-separate-container .ast-comment-list .bypostauthor .bypostauthor {background: transparent;margin-bottom: 0;padding-right: 0;padding-bottom: 0;padding-top: 0;}@media (min-width:922px){.ast-separate-container .ast-comment-list li .comment-respond{padding-left:2.66666em;padding-right:2.66666em;}}@media (max-width:544px){.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-separate-container .comment-respond{padding:1.5em 1em;}}@media (max-width:921px){.ast-comment-avatar-wrap img{max-width:2.5em;}.comments-area{margin-top:1.5em;}.ast-separate-container .comments-title{padding:1.43em 1.48em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}}
</style>
<link rel='stylesheet' id='astra-google-fonts-css'  href='//fonts.googleapis.com/css?family=Roboto%3A400%2C%7COxanium%3A400%2C&#038;display=fallback&#038;ver=3.4.2' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://www.harmj0y.net/blog/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='tablepress-default-css'  href='https://www.harmj0y.net/blog/wp-content/plugins/tablepress/css/default.min.css?ver=1.13' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://www.harmj0y.net/blog/wp-content/plugins/jetpack/css/jetpack.css?ver=9.7' media='all' />
<script src='https://www.harmj0y.net/blog/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script src='https://www.harmj0y.net/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script id='crayon_js-js-extra'>
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/www.harmj0y.net\/blog\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src='https://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta' id='crayon_js-js'></script>
<!--[if IE]>
<script src='https://www.harmj0y.net/blog/wp-content/themes/astra/assets/js/minified/flexibility.min.js?ver=3.4.2' id='astra-flexibility-js'></script>
<script id='astra-flexibility-js-after'>
flexibility(document.documentElement);
</script>
<![endif]-->
<link rel="https://api.w.org/" href="https://www.harmj0y.net/blog/wp-json/" /><link rel="alternate" type="application/json" href="https://www.harmj0y.net/blog/wp-json/wp/v2/posts/3466" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.harmj0y.net/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.harmj0y.net/blog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/" />
<link rel='shortlink' href='https://wp.me/p4qDDn-TU' />
<link rel="alternate" type="application/json+oembed" href="https://www.harmj0y.net/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.harmj0y.net%2Fblog%2Fpowershell%2Fkerberoasting-without-mimikatz%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.harmj0y.net/blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.harmj0y.net%2Fblog%2Fpowershell%2Fkerberoasting-without-mimikatz%2F&#038;format=xml" />
<link rel="pingback" href="https://www.harmj0y.net/blog/xmlrpc.php">

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Kerberoasting Without Mimikatz" />
<meta property="og:url" content="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/" />
<meta property="og:description" content="Just about two years ago, Tim Medin presented a new attack technique he christened &#8220;Kerberoasting&#8221;. While we didn&#8217;t realize the full implications of this at the time of release, tâ€¦" />
<meta property="article:published_time" content="2016-11-01T19:09:24+00:00" />
<meta property="article:modified_time" content="2016-11-10T21:22:38+00:00" />
<meta property="og:site_name" content="harmj0y" />
<meta property="og:image" content="http://www.harmj0y.net/blog/wp-content/uploads/2015/05/kerberos_key_diagram-1024x670.png" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="419" />
<meta property="og:image:alt" content="kerberos_key_diagram" />
<meta name="twitter:text:title" content="Kerberoasting Without Mimikatz" />
<meta name="twitter:image" content="http://www.harmj0y.net/blog/wp-content/uploads/2015/05/kerberos_key_diagram-1024x670.png?w=640" />
<meta name="twitter:image:alt" content="kerberos_key_diagram" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-270x270.png" />
			<style type="text/css" id="wp-custom-css">
				.btn {
  text-decoration: none;
	font-size: 18px;
	padding: 1rem 3rem;
	color: #ffffff;
	text-transform:uppercase;
  border: 1px solid rgb(146, 148, 248);
  position: relative;
  overflow: hidden;
	display: fixed;
  justify-content: center;
  align-items: center;
}

.btn:hover {
  box-shadow: 1px 1px 25px 10px rgba(146, 148, 248, 0.4);
}

.btn:before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  transition: all 650ms;
}

.btn:hover:before {
  left: 100%;
}
			</style>
		</head>

<body itemtype='https://schema.org/Blog' itemscope='itemscope' class="post-template-default single single-post postid-3466 single-format-standard wp-custom-logo ast-blog-single-style-1 ast-single-post ast-inherit-site-logo-transparent ast-hfb-header ast-desktop ast-separate-container ast-right-sidebar astra-3.4.2 ast-normal-title-enabled elementor-default elementor-kit-5017">
<div 
class="hfeed site" id="page">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
			<header
		class="site-header header-main-layout-1 ast-primary-menu-enabled ast-logo-title-inline ast-hide-custom-menu-mobile ast-builder-menu-toggle-icon ast-mobile-header-inline" id="masthead" itemtype="https://schema.org/WPHeader" itemscope="itemscope" itemid="#masthead"		>
			<div id="ast-desktop-header" data-toggle-type="dropdown">
		<div class="ast-main-header-wrap main-header-bar-wrap ">
		<div class="ast-primary-header-bar ast-primary-header main-header-bar site-header-focus-item" data-section="section-primary-header-builder">
						<div class="site-primary-header-wrap ast-builder-grid-row-container site-header-focus-item ast-container" data-section="section-primary-header-builder">
				<div class="ast-builder-grid-row ast-builder-grid-row-has-sides ast-builder-grid-row-no-center">
											<div class="site-header-primary-section-left site-header-section ast-flex site-header-section-left">
									<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="title_tagline">
											<div
				class="site-branding ast-site-identity" itemtype="https://schema.org/Organization" itemscope="itemscope"				>
					<span class="site-logo-img"><a href="https://www.harmj0y.net/blog/" class="custom-logo-link" rel="home"><img width="120" height="38" src="https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png" class="custom-logo" alt="harmj0y logo" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png 120w, https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-300x95.png 300w, https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-768x242.png 768w, https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union.png 904w" sizes="(max-width: 120px) 100vw, 120px" /></a></span>				</div>
			<!-- .site-branding -->
					</div>
								</div>
																									<div class="site-header-primary-section-right site-header-section ast-flex ast-grid-right-section">
										<div class="ast-builder-menu-1 ast-builder-menu ast-flex ast-builder-menu-1-focus-item ast-builder-layout-element site-header-focus-item" data-section="section-hb-menu-1">
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation ast-flex-1"><nav class="site-navigation" id="site-navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" class="ast-flex-grow-1 navigation-accessibility" aria-label="Site Navigation"><div id="ast-hf-menu-1" class="main-navigation ast-inline-flex"><ul class="main-header-menu ast-nav-menu ast-flex  submenu-with-border ast-menu-hover-style-overline  stack-on-mobile"><li class="page_item page-item-12 menu-item"><a href="https://www.harmj0y.net/blog/about/" class="menu-link">About</a></li><li class="page_item page-item-20 menu-item"><a href="https://www.harmj0y.net/blog/presentations/" class="menu-link">Presentations</a></li><li class="page_item page-item-10 menu-item"><a href="https://www.harmj0y.net/blog/projects/" class="menu-link">Projects</a></li></ul></div></nav></div></div>		</div>
									</div>
												</div>
					</div>
								</div>
			</div>
		<div class="ast-desktop-header-content content-align-flex-start ">
			</div>
</div> <!-- Main Header Bar Wrap -->
<div id="ast-mobile-header" class="ast-mobile-header-wrap " data-type="dropdown">
		<div class="ast-main-header-wrap main-header-bar-wrap" >
		<div class="ast-primary-header-bar ast-primary-header main-header-bar site-primary-header-wrap site-header-focus-item ast-builder-grid-row-layout-default ast-builder-grid-row-tablet-layout-default ast-builder-grid-row-mobile-layout-default" data-section="section-primary-header-builder">
									<div class="ast-builder-grid-row ast-builder-grid-row-has-sides ast-builder-grid-row-no-center">
													<div class="site-header-primary-section-left site-header-section ast-flex site-header-section-left">
										<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="title_tagline">
											<div
				class="site-branding ast-site-identity" itemtype="https://schema.org/Organization" itemscope="itemscope"				>
					<span class="site-logo-img"><a href="https://www.harmj0y.net/blog/" class="custom-logo-link" rel="home"><img width="120" height="38" src="https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png" class="custom-logo" alt="harmj0y logo" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png 120w, https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-300x95.png 300w, https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-768x242.png 768w, https://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union.png 904w" sizes="(max-width: 120px) 100vw, 120px" /></a></span>				</div>
			<!-- .site-branding -->
					</div>
									</div>
																									<div class="site-header-primary-section-right site-header-section ast-flex ast-grid-right-section">
										<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="section-header-mobile-trigger">
						<div class="ast-button-wrap">
				<button type="button" class="menu-toggle main-header-menu-toggle ast-mobile-menu-trigger-minimal"   aria-expanded="false">
					<span class="screen-reader-text">Main Menu</span>
					<span class="mobile-menu-toggle-icon">
						<span class="ahfb-svg-iconset ast-inline-flex svg-baseline"><svg role='img' class='ast-mobile-svg ast-menu-svg' fill='currentColor' version='1.1' xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path d='M3 13h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 7h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 19h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1z'></path></svg></span><span class="ahfb-svg-iconset ast-inline-flex svg-baseline"><svg class='ast-mobile-svg ast-close-svg' fill='currentColor' version='1.1' xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path d='M5.293 6.707l5.293 5.293-5.293 5.293c-0.391 0.391-0.391 1.024 0 1.414s1.024 0.391 1.414 0l5.293-5.293 5.293 5.293c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414l-5.293-5.293 5.293-5.293c0.391-0.391 0.391-1.024 0-1.414s-1.024-0.391-1.414 0l-5.293 5.293-5.293-5.293c-0.391-0.391-1.024-0.391-1.414 0s-0.391 1.024 0 1.414z'></path></svg></span>					</span>
									</button>
			</div>
					</div>
									</div>
											</div>
						</div>
	</div>
		<div class="ast-mobile-header-content content-align-flex-start ">
				<div class="ast-builder-menu-mobile ast-builder-menu ast-builder-menu-mobile-focus-item ast-builder-layout-element site-header-focus-item" data-section="section-header-mobile-menu">
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation"><nav class="site-navigation" id="site-navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" class="ast-flex-grow-1 navigation-accessibility" aria-label="Site Navigation"><div id="ast-hf-mobile-menu" class="main-navigation"><ul class="main-header-menu ast-nav-menu ast-flex  submenu-with-border astra-menu-animation-fade  stack-on-mobile"><li class="page_item page-item-12 menu-item"><a href="https://www.harmj0y.net/blog/about/" class="menu-link">About</a></li><li class="page_item page-item-20 menu-item"><a href="https://www.harmj0y.net/blog/presentations/" class="menu-link">Presentations</a></li><li class="page_item page-item-10 menu-item"><a href="https://www.harmj0y.net/blog/projects/" class="menu-link">Projects</a></li></ul></div></nav></div></div>		</div>
			</div>
</div>
		</header><!-- #masthead -->
			<div id="content" class="site-content">
		<div class="ast-container">
		

	<div id="primary" class="content-area primary">

		
					<main id="main" class="site-main">
				

<article
class="post-3466 post type-post status-publish format-standard hentry category-powershell tag-kerberoast ast-article-single" id="post-3466" itemtype="https://schema.org/CreativeWork" itemscope="itemscope">

	
	
<div class="ast-post-format- ast-no-thumb single-layout-1">

	
	<header class="entry-header ast-no-thumbnail">

		
				<div class="ast-single-post-order">
			<h1 class="entry-title" itemprop="headline">Kerberoasting Without Mimikatz</h1><div class="entry-meta">			<span class="comments-link">
				<a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comments">23 Comments</a>			</span>

			 / <span class="cat-links"><a href="https://www.harmj0y.net/blog/category/powershell/" rel="category tag">Powershell</a></span> / By <span class="posted-by vcard author" itemtype="https://schema.org/Person" itemscope="itemscope" itemprop="author">			<a title="View all posts by harmj0y" 
				href="https://www.harmj0y.net/blog/author/harmj0y/" rel="author"
				class="url fn n" itemprop="url"				>
				<span 
				class="author-name" itemprop="name"				>harmj0y</span>
			</a>
		</span>

		</div>		</div>
		
		
	</header><!-- .entry-header -->

	
	<div class="entry-content clear" 
	itemprop="text"	>

		
		<p><span style="font-weight: 400;">Just about two years ago, </span><a href="https://twitter.com/TimMedin"><span style="font-weight: 400;">Tim Medin</span></a><span style="font-weight: 400;"> presented a new attack technique he christened &#8220;</span><a href="https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf"><span style="font-weight: 400;">Kerberoasting</span></a><span style="font-weight: 400;">&#8220;. While we didn&#8217;t realize the full implications of this at the time of release, this attack technique has been a bit of a game changer for us on engagements. More and more attention has been brought to Kerberoasting recently, with </span><a href="https://twitter.com/mubix"><span style="font-weight: 400;">@mubix</span></a><span style="font-weight: 400;"> releasing a </span><a href="https://room362.com/post/2016/kerberoast-pt1/"><span style="font-weight: 400;">three part</span></a> <a href="https://room362.com/post/2016/kerberoast-pt2/"><span style="font-weight: 400;">series</span></a><span style="font-weight: 400;"> on </span><a href="https://room362.com/post/2016/kerberoast-pt3/"><span style="font-weight: 400;">the topic</span></a><span style="font-weight: 400;">, </span><a href="https://twitter.com/pyrotek3"><span style="font-weight: 400;">Sean Metcalf</span></a><span style="font-weight: 400;"> covering it </span><a href="https://adsecurity.org/?tag=kerberoast"><span style="font-weight: 400;">several times</span></a><span style="font-weight: 400;">, and </span><a href="https://twitter.com/leonjza"><span style="font-weight: 400;">@leonjza</span></a><span style="font-weight: 400;"> doing a </span><a href="https://leonjza.github.io/blog/2016/01/09/kerberos-kerberoast-and-golden-tickets/"><span style="font-weight: 400;">detailed writeup</span></a><span style="font-weight: 400;"> as well.</span></p>
<p><span style="font-weight: 400;">Thanks to an awesome </span><a href="https://github.com/PowerShellMafia/PowerSploit/pull/180"><span style="font-weight: 400;">PowerView pull request</span></a><span style="font-weight: 400;"> by </span><a href="https://twitter.com/machosec"><span style="font-weight: 400;">@machosec</span></a><span style="font-weight: 400;">, Kerberoasting is easier than ever using pure PowerShell. I wanted to briefly cover this technique and its background, how we&#8217;ve been using it recently, and a few awesome <a href="https://gist.github.com/HarmJ0y/cc1004307157e372fc5bd3f89e553059">new developments</a>.</span></p>
<h2>Kerberoasting Background</h2>
<p><span style="font-weight: 400;">I first heard about Kerberoasting from Tim at SANS HackFest 2014 during his &#8220;</span><a href="https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf"><span style="font-weight: 400;">Attacking Kerberos: Kicking the Guard Dog of Hades</span></a><span style="font-weight: 400;">&#8221; talk (he also released a </span><a href="https://github.com/nidem/kerberoast"><span style="font-weight: 400;">Kerberoasting toolkit here</span></a><span style="font-weight: 400;">). I&#8217;ll </span><i><span style="font-weight: 400;">briefly</span></i><span style="font-weight: 400;"> paraphrase some technical detail of the attack, but I highly recommend you read </span><a href="https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf"><span style="font-weight: 400;">Tim&#8217;s slides</span></a><span style="font-weight: 400;"> and/or </span><a href="https://adsecurity.org/?p=2293"><span style="font-weight: 400;">Sean&#8217;s explanation</span></a><span style="font-weight: 400;"> for more detail. Thereâ€™s also an excellent page of Microsoft documentation titled â€œ</span><a href="https://msdn.microsoft.com/en-us/library/ff649429.aspx"><span style="font-weight: 400;">Kerberos Technical Supplement for Windows</span></a><span style="font-weight: 400;">â€ which finally clarified a few points involved in this process that were fuzzy to me.</span></p>
<p>Here&#8217;s myÂ version of the obligatory &#8220;this is how kerberos works&#8221; graphic:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-1397" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/05/kerberos_key_diagram-1024x670.png" alt="kerberos_key_diagram" width="640" height="419" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2015/05/kerberos_key_diagram-1024x670.png 1024w, https://www.harmj0y.net/blog/wp-content/uploads/2015/05/kerberos_key_diagram-300x196.png 300w, https://www.harmj0y.net/blog/wp-content/uploads/2015/05/kerberos_key_diagram.png 1188w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><span style="font-weight: 400;">As far as how Kerberoasting fits into this process, this is how I understand it (if I am mistaken on some point please let me know!): after a user authenticates to the key distribution center (KDC, which in the case of a Windows domain is the domain controller) they receive a ticket-granting-ticket (TGT) signed with the domain krbtgt account that provesÂ they are who they say they are. The TGT is then used to request service tickets (TGS) for specific resources/services on the domain. Part of the service ticket is encrypted with the NTLM hash of the target service instance. So how does the KDC determine exactly what key to use when encrypting these service tickets?</span></p>
<p><span style="font-weight: 400;">The Windows implementation of the Kerberos protocol uses service principal names (SPNs) to determine which service account hash to use to encrypt the service ticket. There are two â€œtypesâ€ of service principal names in Active Directory: â€œhost-basedâ€ SPNs that are linked to a domain </span><b>computer</b><span style="font-weight: 400;"> account and â€œarbitraryâ€ SPNs that are usually (but not always) linked to a domain </span><b>user</b><span style="font-weight: 400;"> account.</span></p>
<p><span style="font-weight: 400;">As Microsoft explains, â€œ</span><a href="https://msdn.microsoft.com/en-us/library/ff649429.aspx"><i><span style="font-weight: 400;">When a new computer account is created in Active Directory, host-based SPNs are automatically generated for built-in services&#8230;In reality, SPNs are only created for the HOST service and all built-in services use the HOST SPN</span></i></a><span style="font-weight: 400;">â€. Put another way, â€œ</span><a href="https://msdn.microsoft.com/en-us/library/ff649429.aspx"><i><span style="font-weight: 400;">The HOST service represents the host computer. The HOST SPN is used to access the host computer account whose long term key is used by the Kerberos protocol when it creates a service ticket</span></i></a><span style="font-weight: 400;">â€. Hereâ€™s an example of a default </span><b>computer</b><span style="font-weight: 400;"> account in my test domain:</span></p>
<p><img loading="lazy" class="aligncenter size-large wp-image-3490" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/11/host_default_spn-1024x571.png" alt="host_default_spn" width="640" height="357" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2016/11/host_default_spn-1024x571.png 1024w, https://www.harmj0y.net/blog/wp-content/uploads/2016/11/host_default_spn-300x167.png 300w, https://www.harmj0y.net/blog/wp-content/uploads/2016/11/host_default_spn-768x428.png 768w, https://www.harmj0y.net/blog/wp-content/uploads/2016/11/host_default_spn.png 1796w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><span style="font-weight: 400;">You can see the HOST/WINDOWS1 and HOST/WINDOWS1.testlab.local SPNs for the WINDOWS1$ computer account. When a domain user requests access to \\WINDOWS1.testlab.local\C$, the KDC maps this request to the HOST/WINDOWS1.testlab.local SPN, indicating that the WINDOWS1$ machine account NTLM hash (which is stored both on WINDOWS1 locally and the NTDS.dit Active Directory database on the DC/KDC) should be used to encrypt the server part of the service ticket. The signed/encrypted ticket is then presented to WINDOWS1.testlab.local, which is responsible for determining whether the requesting user should be granted access.</span></p>
<p><span style="font-weight: 400;">From the Kerberoasting perspective, we generally donâ€™t care about host-based SPNs, as a computer&#8217;s machine account password is randomized by default and rotates every 30 days. However, remember that arbitrary SPNs can also be registered for domain </span><b>user</b><span style="font-weight: 400;"> accounts as well. One common example is a service account that manages several MSSQL instances; this user account would have a &lt;MSSQLSvc/HOST:PORT&gt; SPN for each MSSQL instance it&#8217;s registered forÂ stored in the user&#8217;sÂ <strong>serviceprincipalname</strong> attribute (Sean keepsÂ an updated list of </span><a href="https://adsecurity.org/?page_id=183"><span style="font-weight: 400;">SPNs here</span></a><span style="font-weight: 400;">). If we have an arbitrary SPN that is registered for a domain user account, then the NTLM hash of that userâ€™s accountâ€™s </span><i><span style="font-weight: 400;">plaintext</span></i><span style="font-weight: 400;"> password is used for the service ticket creation. </span><b>This is the key to Kerberoasting.</b></p>
<h2><b>Obligatory â€œSo Why Does This Matter?â€</b></h2>
<p><span style="font-weight: 400;">Because of how Kerberos works, any user can request a TGS for any service that has a registered SPN (HOST or arbitrary) in a user or computer account in Active Directory. Remember that just requesting this ticket doesnâ€™t grant access to the requesting user, as it&#8217;s up to the server/service to ultimately determine whether the user should be given access. Tim realized that because of this, and because part of a TGS requested for an SPN instance is encrypted with the NTLM hash of a service account&#8217;s plaintext password, </span><b>any user can request these TGS tickets and then crack the service account&#8217;s plaintext password offline</b><span style="font-weight: 400;">, without the risk of account lockout!</span></p>
<p><span style="font-weight: 400;">To reiterate, any domain user account that has a service principal name set can have a TGS for that SPN requested by </span><b>any user in the domain</b><span style="font-weight: 400;">, allowing for the offline cracking of the service account plaintext password! This is obviously dependent on a crackable service account plaintext, but luckily for us service accounts tend to often have simple passwords that change very infrequently. Â¯\_(ãƒ„)_/Â¯</span></p>
<p><span style="font-weight: 400;">As an added bonus, Tim mentions on </span><a href="https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf"><span style="font-weight: 400;">slide 18 of his presentation deck</span></a><span style="font-weight: 400;">:</span></p>
<p><img loading="lazy" class="aligncenter size-large wp-image-3469" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/10/medin_kerberoast-1024x486.png" alt="medin_kerberoast" width="640" height="304" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2016/10/medin_kerberoast-1024x486.png 1024w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/medin_kerberoast-300x142.png 300w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/medin_kerberoast-768x364.png 768w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/medin_kerberoast.png 1881w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>Â¯\_(ãƒ„)_/Â¯</p>
<h2>&#8220;OldÂ School&#8221; Kerberoasting</h2>
<p><span style="font-weight: 400;">Tim&#8217;s outlined </span><a href="https://github.com/nidem/kerberoast"><span style="font-weight: 400;">approach/toolkit</span></a><span style="font-weight: 400;"> used a combination of toolsets to request tickets, extract them from memory (using <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz</a>), and transform them into a crackable format. In general, the process (up until recently) went as follows:</span></p>
<ul>
<li><span style="font-weight: 400;">Enumerate the domain accounts with SPNs set- either with Tim&#8217;s </span><a href="https://github.com/nidem/kerberoast/blob/master/GetUserSPNs.ps1"><span style="font-weight: 400;">GetUserSPNS.ps1</span></a><span style="font-weight: 400;"> script, Sean&#8217;s </span><a href="https://github.com/PyroTek3/PowerShell-AD-Recon/blob/master/Find-PSServiceAccounts"><span style="font-weight: 400;">Find-PSServiceAccounts.ps1</span></a><span style="font-weight: 400;"> script, or PowerView&#8217;s &#8220;</span><a href="https://github.com/PowerShellMafia/PowerSploit/blob/5690b09027b53a5932e42399f6943e03fa32e549/Recon/PowerView.ps1#L2087-L2089"><span style="font-weight: 400;">Get-NetUser -SPN</span></a><span style="font-weight: 400;">&#8220;.</span></li>
<li><span style="font-weight: 400;">Request TGSs for these specific SPNs with the builtin Windows tool setspn.exe or the .NET </span><a href="https://msdn.microsoft.com/en-us/library/system.identitymodel.tokens.kerberosrequestorsecuritytoken(v=vs.110).aspx"><span style="font-weight: 400;">System.IdentityModel.Tokens.KerberosRequestorSecurityToken</span></a><span style="font-weight: 400;"> class in PowerShell.</span></li>
<li><span style="font-weight: 400;">Extract these tickets from memory by invoking the </span><b>kerberos::list /export</b><span style="font-weight: 400;"> Mimikatz command , with the optional base64 export format set first. The tickets were then downloaded, or the base64-encoded versions pulled down to the attacker&#8217;s machine and decoded.</span></li>
<li><span style="font-weight: 400;">Begin offline password cracking with Tim&#8217;s </span><a href="https://github.com/nidem/kerberoast/blob/master/tgsrepcrack.py"><span style="font-weight: 400;">tgsrepcrack.py</span></a><span style="font-weight: 400;">, or extract a crackable hash format from the raw ticket with John the Ripper&#8217;s Â </span><a href="https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/run/kirbi2john.py"><span style="font-weight: 400;">kirbi2john.py</span></a><span style="font-weight: 400;">.</span></li>
</ul>
<p><a href="https://github.com/xan7r"><span style="font-weight: 400;">xan7r</span></a><span style="font-weight: 400;"> branched Tim&#8217;s toolset and added an </span><a href="https://raw.githubusercontent.com/xan7r/kerberoast/master/autokerberoast.ps1"><span style="font-weight: 400;">autokerberoast.ps1</span></a><span style="font-weight: 400;"> script that automated large components of this process. Also, </span><a href="https://twitter.com/tifkin_"><span style="font-weight: 400;">@tifkin_</span></a><span style="font-weight: 400;"> wrote a </span><a href="https://github.com/leechristensen/tgscrack"><span style="font-weight: 400;">Go version of a TGS cracker</span></a><span style="font-weight: 400;"> that functioned a bit faster than the original Python version.</span></p>
<h2>&#8220;New School&#8221; Kerberoasting</h2>
<p><span style="font-weight: 400;">A few recent(ish) things really simplified our usage of Kerberoasting on engagements. First, Michael Kramer added the KRB5TGS format to John the Ripper in </span><a href="https://github.com/magnumripper/JohnTheRipper/commit/05e514646dfe5aa65ee48774571c0169f7e25a53"><span style="font-weight: 400;">September of 2015.</span></a><span style="font-weight: 400;"> Second, </span><a href="https://twitter.com/Fist0urs"><span style="font-weight: 400;">@Fist0urs</span></a><span style="font-weight: 400;"> committed the </span><a href="https://github.com/hashcat/hashcat/pull/225"><span style="font-weight: 400;">same algorithm to Hashcat</span></a><span style="font-weight: 400;"> in Febuary 2016, opening the door for GPU-based cracking of these tickets. This was really a watershed for us, as it greatly expanded the range of service account passwords we could crack. And finally, Matan Hart (</span><a href="https://twitter.com/machosec"><span style="font-weight: 400;">@machosec</span></a><span style="font-weight: 400;">)&#8217;s </span><a href="https://github.com/PowerShellMafia/PowerSploit/pull/180"><span style="font-weight: 400;">pull request to PowerView</span></a><span style="font-weight: 400;"> removed the Mimikatz requirement.</span></p>
<p><a href="https://twitter.com/machosec"><span style="font-weight: 400;">@machosec</span></a><span style="font-weight: 400;"> realized that .NET class </span><a href="https://msdn.microsoft.com/en-us/library/system.identitymodel.tokens.kerberosrequestorsecuritytoken(v=vs.110).aspx"><span style="font-weight: 400;">KerberosRequestorSecurityToken</span></a><span style="font-weight: 400;"> used in previous approaches also had a </span><span style="font-weight: 400;"><a href="https://msdn.microsoft.com/en-us/library/system.identitymodel.tokens.kerberosrequestorsecuritytoken.getrequest(v=vs.110).aspx">GetRequest()</a>Â method</span><span style="font-weight: 400;">, which returns the raw byte stream of the Kerberos service ticket. With a </span><a href="https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1#L1381-L1384"><span style="font-weight: 400;">bit string manipulation</span></a><span style="font-weight: 400;">, Matan was able to easily extract out the encrypted (i.e. the crackable hash component) of the TGS. We are now no longer dependent on Mimikatz for ticket extraction!</span></p>
<p><span style="font-weight: 400;">I recently rolled the necessary functions into a single, </span><a href="https://gist.github.com/HarmJ0y/53a837fce877e32e18d78acbb08c8fe9"><span style="font-weight: 400;">self-contained script</span></a><span style="font-weight: 400;"> that contains the necessary components from PowerView (this has also </span><a href="https://github.com/adaptivethreat/Empire/commit/6ee7e036607a62b0192daed46d3711afc65c3921"><span style="font-weight: 400;">been updated in Empire</span></a><span style="font-weight: 400;">). We are currently in the process of refactoring large components of </span><a href="https://github.com/PowerShellMafia/PowerSploit"><span style="font-weight: 400;">PowerSploit</span></a><span style="font-weight: 400;">, and the updated functions will be posted here after the changes are published. This custom-rolled script includes the </span><b>Invoke-Kerberoast</b><span style="font-weight: 400;"> function, which wraps the logic from </span><b>Get-NetUser -SPN</b><span style="font-weight: 400;"> (to enumerate user accounts with a non-null servicePrincipalName) and </span><b>Get-SPNTicket</b><span style="font-weight: 400;"> to request associated TGS tickets and output John and Hashcat crackable strings. For now, here&#8217;s what the output of the script looks like:</span></p>
<p><img loading="lazy" class="aligncenter size-large wp-image-3474" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast1-1024x342.png" alt="invoke_kerberoast1" width="640" height="214" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast1-1024x342.png 1024w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast1-300x100.png 300w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast1-768x256.png 768w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast1.png 1792w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>It also works across domains!</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-3475" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast2-1024x361.png" alt="invoke_kerberoast2" width="640" height="226" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast2-1024x361.png 1024w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast2-300x106.png 300w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast2-768x271.png 768w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast2.png 1800w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><span style="font-weight: 400;">By default, the John format is output, but </span><b>-OutputFormat Hashcat</b><span style="font-weight: 400;"> will output everything Hashcat-ready. Note that the </span><b>-AdminCount </b><span style="font-weight: 400;">flag only Kerberoasts accounts with AdminCount=1, meaning user accounts that are (or were) &#8216;protected&#8217; and, therefore, almost always highly privileged:</span></p>
<p><img loading="lazy" class="aligncenter size-large wp-image-3476" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast3-1024x364.png" alt="invoke_kerberoast3" width="640" height="228" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast3-1024x364.png 1024w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast3-300x107.png 300w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast3-768x273.png 768w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast3.png 1796w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>And here&#8217;s how the <a href="https://github.com/adaptivethreat/Empire/commit/6ee7e036607a62b0192daed46d3711afc65c3921">updated Empire module</a> looks:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-3484" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast_empire-1024x520.png" alt="invoke_kerberoast_empire" width="640" height="325" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast_empire-1024x520.png 1024w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast_empire-300x152.png 300w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast_empire-768x390.png 768w, https://www.harmj0y.net/blog/wp-content/uploads/2016/10/invoke_kerberoast_empire.png 1477w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><span style="font-weight: 400;">Note that for non-Empire weaponizations, as PSObjects are output, you will need to pipe the results to </span><b>Format-List </b><span style="font-weight: 400;">or </span><b>ConvertTo-Csv -NoTypeInformation</b><span style="font-weight: 400;"> in order to preserve the information you want displayed. You can then crack these tickets as </span><a href="https://twitter.com/mubix"><span style="font-weight: 400;">@mubix</span></a><span style="font-weight: 400;"> described in </span><a href="https://room362.com/post/2016/kerberoast-pt3/"><span style="font-weight: 400;">his third post</span></a><span style="font-weight: 400;">.</span></p>
<p><span style="font-weight: 400;">Again, the self-contained, PowerShell 2.0-compliant script is on my </span><a href="https://gist.github.com/HarmJ0y/cc1004307157e372fc5bd3f89e553059"><span style="font-weight: 400;">Gists here</span></a><span style="font-weight: 400;">. Hopefully this is as much use to you as it has been for us over the past few months!</span></p>

		
		
			</div><!-- .entry-content .clear -->
</div>

	
</article><!-- #post-## -->


	<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.harmj0y.net/blog/empire/empire-fails/" rel="prev"><span class="ast-left-arrow">&larr;</span> Previous Post</a></div><div class="nav-next"><a href="https://www.harmj0y.net/blog/powershell/make-powerview-great-again/" rel="next">Next Post <span class="ast-right-arrow">&rarr;</span></a></div></div>
	</nav>
<div id="comments" class="comments-area">

	
				<h3 class="comments-title">
				23 thoughts on &ldquo;Kerberoasting Without Mimikatz&rdquo;			</h3>
		
		<ol class="ast-comment-list">
							<li class="comment even thread-even depth-1" id="li-comment-33557">

					<article id="comment-33557" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/7cb5012ce43561cba51785ac4fd49dad?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7cb5012ce43561cba51785ac4fd49dad?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">Ros Gul</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-33557"><time datetime="2016-11-01T15:46:34-05:00">November 1, 2016 at 3:46 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>mitigations?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=33557#respond' data-commentid="33557" data-postid="3466" data-belowelement="comment-33557" data-respondelement="respond" data-replyto="Reply to Ros Gul" aria-label='Reply to Ros Gul'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor odd alt depth-2" id="li-comment-33789">

					<article id="comment-33789" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-33789"><time datetime="2016-11-05T19:10:03-05:00">November 5, 2016 at 7:10 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Ensure service account passwords are longer than 25 characters, or try to integrate Managed Service Accounts/Group Managed Service Accounts</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=33789#respond' data-commentid="33789" data-postid="3466" data-belowelement="comment-33789" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
				<li class="comment byuser comment-author-harmj0y bypostauthor even depth-2" id="li-comment-35496">

					<article id="comment-35496" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-35496"><time datetime="2016-12-14T23:56:13-05:00">December 14, 2016 at 11:56 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p><a href="https://adsecurity.org/?p=2293" rel="nofollow ugc">https://adsecurity.org/?p=2293</a></p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=35496#respond' data-commentid="35496" data-postid="3466" data-belowelement="comment-35496" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-33604">

					<article id="comment-33604" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/813722e41de3bc9c45062f9ef557acb2?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/813722e41de3bc9c45062f9ef557acb2?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">flux</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-33604"><time datetime="2016-11-02T12:22:11-05:00">November 2, 2016 at 12:22 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hey harmj0y,</p>
<p>first of all: Thanks for the nice write-up!</p>
<p>I have added the module to empire and tested it against my lab domain.<br />
As there was no SPN available I added a user &#8220;spntest&#8221; and a spn using &#8220;setspn -U -S http/spntest spntest&#8221;. The hashcat formated hash was retrieved by the Invoke-Kerberoast module without any problems.<br />
I handed the hash over to my windows based hashcat machine using &#8220;hashcat64.exe -m 13300 hashfile D:\wordlists\testlist&#8221;. The wordlist was only containing the correct password and four dummies.<br />
Surprisingly hashcat recognized the hash as Kerberos 5 TGS-REP etype 23, finished its run without any errors, but did not recover the password from it.<br />
I suspected the output format of the module to be the problem as it needs some massaging to fit into the one liner hashcat expects but after retesting it for the third time I am pretty sure that the input to hashcat is correct.<br />
Could you give me a hint how you were able to utilize hashcat for the cracking stage?<br />
Thanks in advance!<br />
flux*</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=33604#respond' data-commentid="33604" data-postid="3466" data-belowelement="comment-33604" data-respondelement="respond" data-replyto="Reply to flux" aria-label='Reply to flux'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor even depth-2" id="li-comment-35497">

					<article id="comment-35497" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-35497"><time datetime="2016-12-14T23:57:05-05:00">December 14, 2016 at 11:57 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>we&#8217;ve received reports of this and are looking into it, thanks!</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=35497#respond' data-commentid="35497" data-postid="3466" data-belowelement="comment-35497" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment odd alt thread-even depth-1" id="li-comment-33613">

					<article id="comment-33613" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/dcdc65f3a1409202c8181b11a313fa53?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dcdc65f3a1409202c8181b11a313fa53?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">Brad</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-33613"><time datetime="2016-11-02T16:21:24-05:00">November 2, 2016 at 4:21 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Your Invoke-Kerberoast from the gist you linked seems to have a bug somewhere. When I run it with no -Identity argument it lists accounts with the wrong SPN/hash even though there was an error retrieving the information. So basically, it&#8217;s outputting objects with incorrect data when it should output nothing for that identity because there was an error.</p>
<p>For example in one instance the same SPN/hash is listed for 13 different accounts. Only the first of the 13 is correct. The other accounts have SPNs/hashes of their own, but obviously they are different. Seems like maybe you&#8217;re reusing some variables from identity to identity where if an operation on an identity fails the script still outputs an object but it just contains the SPN/Hash of the last identity that succeeded.</p>
<p>For the record the error it gives on the identities that don&#8217;t work is below:<br />
New-Object : Exception calling &#8220;.ctor&#8221; with &#8220;1&#8221; argument(s): &#8220;The NetworkCredentials provided were unable to create a<br />
Kerberos credential, see inner exception for details.&#8221;<br />
At C:\tools\Invoke-Kerberoast.ps1:555 char:23<br />
+ &#8230;   $Ticket = New-Object System.IdentityModel.Tokens.KerberosRequestorS &#8230;<br />
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />
    + CategoryInfo          : InvalidOperation: (:) [New-Object], MethodInvocationException<br />
    + FullyQualifiedErrorId : ConstructorInvokedThrowException,Microsoft.PowerShell.Commands.NewObjectCommand</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=33613#respond' data-commentid="33613" data-postid="3466" data-belowelement="comment-33613" data-respondelement="respond" data-replyto="Reply to Brad" aria-label='Reply to Brad'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor even depth-2" id="li-comment-33790">

					<article id="comment-33790" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-33790"><time datetime="2016-11-05T19:10:30-05:00">November 5, 2016 at 7:10 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Thanks for the heads up, will try to check into this over the next few days.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=33790#respond' data-commentid="33790" data-postid="3466" data-belowelement="comment-33790" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
				<li class="comment odd alt depth-2" id="li-comment-34817">

					<article id="comment-34817" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/b42ff7f9bc86bef4346478dc5a113bca?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b42ff7f9bc86bef4346478dc5a113bca?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn"><a href='http://www.secforce.com' rel='external nofollow ugc' class='url'>st3r30byt3</a></b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-34817"><time datetime="2016-11-30T05:27:15-05:00">November 30, 2016 at 5:27 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hey Brad,</p>
<p>I was having the same problem and found the solution.  Created a pull request today (Empire) addressing the issue.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=34817#respond' data-commentid="34817" data-postid="3466" data-belowelement="comment-34817" data-respondelement="respond" data-replyto="Reply to st3r30byt3" aria-label='Reply to st3r30byt3'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment even depth-3" id="li-comment-39227">

					<article id="comment-39227" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/39cf09e81f30b0474ef1f7f82fa242dc?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/39cf09e81f30b0474ef1f7f82fa242dc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">Thomas Hankers</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-39227"><time datetime="2017-03-15T07:51:56-05:00">March 15, 2017 at 7:51 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>st3r30byt3,</p>
<p>I&#8217;m getting the same error above that Brad is getting, can you link to your fix?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=39227#respond' data-commentid="39227" data-postid="3466" data-belowelement="comment-39227" data-respondelement="respond" data-replyto="Reply to Thomas Hankers" aria-label='Reply to Thomas Hankers'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-33907">

					<article id="comment-33907" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/f220d4aa86b7f1248872346fe4ef82f2?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f220d4aa86b7f1248872346fe4ef82f2?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn"><a href='http://www.exumbraops.com' rel='external nofollow ugc' class='url'>Geoff Janjua</a></b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-33907"><time datetime="2016-11-09T21:48:34-05:00">November 9, 2016 at 9:48 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Great work.  I&#8217;ve also done some work on Kerberos and found a couple of things that you might be interested in. One, that you can use also enumerate users by requesting an AS-REP and reading the error codes.  Two, you can crack the AS-REPs that do not require pre-authentication in the same way as the TGS-REPs.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=33907#respond' data-commentid="33907" data-postid="3466" data-belowelement="comment-33907" data-respondelement="respond" data-replyto="Reply to Geoff Janjua" aria-label='Reply to Geoff Janjua'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor even depth-2" id="li-comment-35401">

					<article id="comment-35401" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-35401"><time datetime="2016-12-13T01:38:50-05:00">December 13, 2016 at 1:38 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Geoff,</p>
<p>@tifkin_ and I stumbled on your work a few weeks ago and it&#8217;s definitely interesting! Evidence of us paying attention ;) &#8211; <a href="https://github.com/PowerShellMafia/PowerSploit/blob/7c32bf69f334b7c15c644cdb41188bdfe1a0b0e8/Recon/PowerView.ps1#L4412-L4414" rel="nofollow ugc">https://github.com/PowerShellMafia/PowerSploit/blob/7c32bf69f334b7c15c644cdb41188bdfe1a0b0e8/Recon/PowerView.ps1#L4412-L4414</a></p>
<p>Feel free to DM me on Twitter or through email, would love to chat more.</p>
<p>-Will</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=35401#respond' data-commentid="35401" data-postid="3466" data-belowelement="comment-35401" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="pingback odd alt thread-even depth-1" id="comment-37570">
					<p>Pingback: <a href='https://adsecurity.org/?p=3458' rel='external nofollow ugc' class='url'>Detecting Kerberoasting Activity &#187; Active Directory Security</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback even thread-odd thread-alt depth-1" id="comment-37571">
					<p>Pingback: <a href='https://adsecurity.org/?p=3513' rel='external nofollow ugc' class='url'>Detecting Kerberoasting Activity Part 2 &#8211; Creating a Kerberoast Service Account Honeypot &#187; Active Directory Security</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback odd alt thread-even depth-1" id="comment-37712">
					<p>Pingback: <a href='https://trimarcsecurity.com/trimarc-research-detecting-kerberoasting-activity' rel='external nofollow ugc' class='url'>Trimarc Research: Detecting Kerberoasting Activity &#8211; TRIMARC</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback even thread-odd thread-alt depth-1" id="comment-40013">
					<p>Pingback: <a href='https://adsecurity.org/?p=2293' rel='external nofollow ugc' class='url'>Cracking Kerberos TGS Tickets Using Kerberoast &#8211; Exploiting Kerberos to Compromise the Active Directory Domain &#187; Active Directory Security</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback odd alt thread-even depth-1" id="comment-41279">
					<p>Pingback: <a href='http://www.blackhillsinfosec.com/?p=5914' rel='external nofollow ugc' class='url'>A Toast to Kerberoast - Black Hills Information Security</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-44410">

					<article id="comment-44410" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/84f652ca20ba1853ee8c4de4a4e12c88?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/84f652ca20ba1853ee8c4de4a4e12c88?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">Jakob Heidelberg</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-44410"><time datetime="2017-08-28T08:48:52-05:00">August 28, 2017 at 8:48 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>I still get the &#8220;The NetworkCredentials provided were unable to create a<br />
Kerberos credentia&#8221; error &#8211; last two places I tested it.</p>
<p>Was the issue ever fixed?</p>
<p>And if so, in which release?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=44410#respond' data-commentid="44410" data-postid="3466" data-belowelement="comment-44410" data-respondelement="respond" data-replyto="Reply to Jakob Heidelberg" aria-label='Reply to Jakob Heidelberg'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
				<li class="comment odd alt thread-even depth-1" id="li-comment-51299">

					<article id="comment-51299" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/f58e369332fe3e41985f346118863588?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f58e369332fe3e41985f346118863588?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">AJ</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-51299"><time datetime="2018-07-15T06:35:15-05:00">July 15, 2018 at 6:35 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Can the hash output from the command of Invoke-Kerberaost be used to create a silver ticket using Mimikatz ?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=51299#respond' data-commentid="51299" data-postid="3466" data-belowelement="comment-51299" data-respondelement="respond" data-replyto="Reply to AJ" aria-label='Reply to AJ'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor even depth-2" id="li-comment-51306">

					<article id="comment-51306" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/#comment-51306"><time datetime="2018-07-15T22:30:32-05:00">July 15, 2018 at 10:30 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Not directly, no. The output of Kerberoasting is part of the service ticket replay (TGS-REP) that can be cracked offline to recover an account plaintext, it is NOT the hash format that would be needed to create a silver ticket.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/?replytocom=51306#respond' data-commentid="51306" data-postid="3466" data-belowelement="comment-51306" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-59859">
					<p>Pingback: <a href='https://hackinganarchy.wordpress.com/2019/02/20/hackthebox-active-write-up/' rel='external nofollow ugc' class='url'>HackTheBox &#8220;Active&#8221; Write-Up &#8211; Hacking Anarchy</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback even thread-even depth-1" id="comment-61449">
					<p>Pingback: <a href='https://redcanary.com/blog/threat-hunting-dridex-attacks/' rel='external nofollow ugc' class='url'>Threat Hunting for Dridex Attacks: Red Canary &amp; Carbon Black</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-68569">
					<p>Pingback: <a href='https://www.carbonblack.com/2017/07/24/threat-hunting-dridex-attacks-top-questions-security-teams/' rel='external nofollow ugc' class='url'>Threat Hunting for Dridex Attacks: Top Questions from Security Teams | Carbon Black</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback even thread-even depth-1" id="comment-73722">
					<p>Pingback: <a href='https://cybersecuritypad.com/how-to-kerberoast-like-a-boss/' rel='external nofollow ugc' class='url'>How to: Kerberoast like a boss &#8211; Cyber Security Pad &#8211; Cyber Security | Home Automation | Risk Management</a> </p>
				</li>
				</li><!-- #comment-## -->
		</ol><!-- .ast-comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/powershell/kerberoasting-without-mimikatz/#respond" style="display:none;">Cancel Reply</a></small></h3><form action="https://www.harmj0y.net/blog/wp-comments-post.php" method="post" id="ast-commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><div class="ast-row comment-textarea"><fieldset class="comment-form-comment"><div class="comment-form-textarea ast-grid-common-col"><label for="comment" class="screen-reader-text">Type here..</label><textarea id="comment" name="comment" placeholder="Type here.." cols="45" rows="8" aria-required="true"></textarea></div></fieldset></div><div class="ast-comment-formwrap ast-row"><p class="comment-form-author ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="author" class="screen-reader-text">Name*</label><input id="author" name="author" type="text" value="" placeholder="Name*" size="30" aria-required='true' /></p>
<p class="comment-form-email ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="email" class="screen-reader-text">Email*</label><input id="email" name="email" type="text" value="" placeholder="Email*" size="30" aria-required='true' /></p>
<p class="comment-form-url ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="url"><label for="url" class="screen-reader-text">Website</label><input id="url" name="url" type="text" value="" placeholder="Website" size="30" /></label></p></div>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment &raquo;" /> <input type='hidden' name='comment_post_ID' value='3466' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="3f49bb3f17" /></p><input type="hidden" id="ak_js" name="ak_js" value="218"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	<p class="akismet_comment_form_privacy_notice">This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" target="_blank" rel="nofollow noopener">Learn how your comment data is processed</a>.</p>
	
</div><!-- #comments -->
			</main><!-- #main -->
			
		
	</div><!-- #primary -->


	<div class="widget-area secondary" id="secondary" role="complementary" itemtype="https://schema.org/WPSideBar" itemscope="itemscope">
	<div class="sidebar-main" >
				<aside id="media_image-5" class="widget widget_media_image"><a href="https://specterops.io/" target="_blank" rel="noopener"><img width="751" height="786" src="https://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops.png" class="image wp-image-4177 alignleft attachment-full size-full" alt="" loading="lazy" style="max-width: 100%; height: auto;" srcset="https://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops.png 751w, https://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops-287x300.png 287w" sizes="(max-width: 751px) 100vw, 751px" /></a></aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h2 class="widget-title">Recent Posts</h2><nav role="navigation" aria-label="Recent Posts">
		<ul>
											<li>
					<a href="https://www.harmj0y.net/blog/activedirectory/a-case-study-in-wagging-the-dog-computer-takeover/">A Case Study in Wagging the Dog: Computer Takeover</a>
									</li>
											<li>
					<a href="https://www.harmj0y.net/blog/redteaming/kerberoasting-revisited/">Kerberoasting Revisited</a>
									</li>
											<li>
					<a href="https://www.harmj0y.net/blog/redteaming/not-a-security-boundary-breaking-forest-trusts/">Not A Security Boundary: Breaking Forest Trusts</a>
									</li>
											<li>
					<a href="https://www.harmj0y.net/blog/redteaming/another-word-on-delegation/">Another Word on Delegation</a>
									</li>
											<li>
					<a href="https://www.harmj0y.net/blog/redteaming/rubeus-now-with-more-kekeo/">Rubeus &#8211; Now With More Kekeo</a>
									</li>
					</ul>

		</nav></aside><aside id="archives-2" class="widget widget_archive"><h2 class="widget-title">Archives</h2>		<label class="screen-reader-text" for="archives-dropdown-2">Archives</label>
		<select id="archives-dropdown-2" name="archive-dropdown">
			
			<option value="">Select Month</option>
				<option value='https://www.harmj0y.net/blog/2019/02/'> February 2019 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2018/11/'> November 2018 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2018/10/'> October 2018 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2018/09/'> September 2018 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2018/08/'> August 2018 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2018/07/'> July 2018 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2018/04/'> April 2018 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2017/11/'> November 2017 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2017/10/'> October 2017 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2017/09/'> September 2017 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2017/08/'> August 2017 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2017/07/'> July 2017 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2017/06/'> June 2017 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2017/05/'> May 2017 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2017/03/'> March 2017 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2017/01/'> January 2017 &nbsp;(4)</option>
	<option value='https://www.harmj0y.net/blog/2016/12/'> December 2016 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2016/11/'> November 2016 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2016/10/'> October 2016 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2016/09/'> September 2016 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2016/08/'> August 2016 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2016/07/'> July 2016 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2016/06/'> June 2016 &nbsp;(3)</option>
	<option value='https://www.harmj0y.net/blog/2016/05/'> May 2016 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2016/04/'> April 2016 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2016/03/'> March 2016 &nbsp;(4)</option>
	<option value='https://www.harmj0y.net/blog/2016/02/'> February 2016 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2016/01/'> January 2016 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2015/12/'> December 2015 &nbsp;(4)</option>
	<option value='https://www.harmj0y.net/blog/2015/11/'> November 2015 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2015/10/'> October 2015 &nbsp;(3)</option>
	<option value='https://www.harmj0y.net/blog/2015/09/'> September 2015 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2015/08/'> August 2015 &nbsp;(3)</option>
	<option value='https://www.harmj0y.net/blog/2015/07/'> July 2015 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2015/06/'> June 2015 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2015/05/'> May 2015 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2015/04/'> April 2015 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2015/03/'> March 2015 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2015/01/'> January 2015 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2014/12/'> December 2014 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2014/11/'> November 2014 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2014/10/'> October 2014 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2014/09/'> September 2014 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2014/08/'> August 2014 &nbsp;(1)</option>
	<option value='https://www.harmj0y.net/blog/2014/07/'> July 2014 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2014/06/'> June 2014 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2014/05/'> May 2014 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2014/04/'> April 2014 &nbsp;(2)</option>
	<option value='https://www.harmj0y.net/blog/2014/03/'> March 2014 &nbsp;(1)</option>

		</select>

<script>
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "archives-dropdown-2" );
	function onSelectChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value !== '' ) {
			document.location.href = this.options[ this.selectedIndex ].value;
		}
	}
	dropdown.onchange = onSelectChange;
})();
/* ]]> */
</script>
			</aside><aside id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://www.harmj0y.net/blog/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
					<button class="search-submit">
				<span hidden>Search</span>
				<i><span class="ast-icon icon-search"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="-888 480 142 142" enable-background="new -888 480 142 142" xml:space="preserve">
				<title/>
				<desc/>
				<path id="Shape" d="M-787.4,568.7h-6.3l-2.4-2.4c7.9-8.7,12.6-20.5,12.6-33.1c0-28.4-22.9-51.3-51.3-51.3  c-28.4,0-51.3,22.9-51.3,51.3c0,28.4,22.9,51.3,51.3,51.3c12.6,0,24.4-4.7,33.1-12.6l2.4,2.4v6.3l39.4,39.4l11.8-11.8L-787.4,568.7  L-787.4,568.7z M-834.7,568.7c-19.7,0-35.5-15.8-35.5-35.5c0-19.7,15.8-35.5,35.5-35.5c19.7,0,35.5,15.8,35.5,35.5  C-799.3,553-815,568.7-834.7,568.7L-834.7,568.7z"/>
				</svg></span></i>
			</button>
			</label>
	<input type="submit" class="search-submit" value="Search">
</form>
</aside><aside id="categories-4" class="widget widget_categories"><h2 class="widget-title">Categories</h2><nav role="navigation" aria-label="Categories">
			<ul>
					<li class="cat-item cat-item-38"><a href="https://www.harmj0y.net/blog/category/activedirectory/">ActiveDirectory</a>
</li>
	<li class="cat-item cat-item-25"><a href="https://www.harmj0y.net/blog/category/defense/">Defense</a>
</li>
	<li class="cat-item cat-item-21"><a href="https://www.harmj0y.net/blog/category/empire/">Empire</a>
</li>
	<li class="cat-item cat-item-32"><a href="https://www.harmj0y.net/blog/category/empyre/">EmPyre</a>
</li>
	<li class="cat-item cat-item-12"><a href="https://www.harmj0y.net/blog/category/informational/">Informational</a>
</li>
	<li class="cat-item cat-item-8"><a href="https://www.harmj0y.net/blog/category/penetesting/">Penetesting</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://www.harmj0y.net/blog/category/powershell/">Powershell</a>
</li>
	<li class="cat-item cat-item-5"><a href="https://www.harmj0y.net/blog/category/python/">Python</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://www.harmj0y.net/blog/category/redteaming/">Red Teaming</a>
</li>
	<li class="cat-item cat-item-50"><a href="https://www.harmj0y.net/blog/category/top-posts/">Top Posts</a>
</li>
			</ul>

			</nav></aside><aside id="linkcat-2" class="widget widget_links"><h2 class="widget-title">Blogroll</h2>
	<ul class='xoxo blogroll'>
<li><a href="https://bluescreenofjeff.com/">bluescreenofjeff.com</a></li>
<li><a href="https://enigma0x3.net/">enigma0x3.net</a></li>
<li><a href="http://www.invoke-ir.com/">invoke-ir.com</a></li>
<li><a href="https://wald0.com/">wald0.com</a></li>

	</ul>
</aside>
<aside id="twitter_timeline-3" class="widget widget_twitter_timeline"><a class="twitter-timeline" data-width="220" data-theme="dark" data-border-color="#e8e8e8" data-tweet-limit="5" data-lang="EN" data-partner="jetpack" data-chrome="noscrollbar" href="https://twitter.com/harmj0y" href="https://twitter.com/harmj0y">My Tweets</a></aside>
	</div><!-- .sidebar-main -->
</div><!-- #secondary -->


	</div> <!-- ast-container -->
	</div><!-- #content -->
<footer
class="site-footer" id="colophon" itemtype="https://schema.org/WPFooter" itemscope="itemscope" itemid="#colophon">
			<div class="site-primary-footer-wrap ast-builder-grid-row-container site-footer-focus-item ast-builder-grid-row-3-equal ast-builder-grid-row-tablet-3-equal ast-builder-grid-row-mobile-full ast-footer-row-stack ast-footer-row-tablet-stack ast-footer-row-mobile-stack" data-section="section-primary-footer-builder">
	<div class="ast-builder-grid-row-container-inner">
					<div class="ast-builder-footer-grid-columns site-primary-footer-inner-wrap ast-builder-grid-row">
											<div class="site-footer-primary-section-1 site-footer-section site-footer-section-1">
								<div class="footer-widget-area widget-area site-footer-focus-item" data-section="section-footer-menu">
							</div>
							</div>
											<div class="site-footer-primary-section-2 site-footer-section site-footer-section-2">
									</div>
											<div class="site-footer-primary-section-3 site-footer-section site-footer-section-3">
									</div>
										</div>
			</div>

</div>
<div class="site-below-footer-wrap ast-builder-grid-row-container site-footer-focus-item ast-builder-grid-row-full ast-builder-grid-row-tablet-full ast-builder-grid-row-mobile-full ast-footer-row-stack ast-footer-row-tablet-stack ast-footer-row-mobile-stack" data-section="section-below-footer-builder">
	<div class="ast-builder-grid-row-container-inner">
					<div class="ast-builder-footer-grid-columns site-below-footer-inner-wrap ast-builder-grid-row">
											<div class="site-footer-below-section-1 site-footer-section site-footer-section-1">
								<div class="ast-builder-layout-element ast-flex site-footer-focus-item ast-footer-copyright" data-section="section-footer-builder">
				<div class="ast-footer-copyright"><p>Copyright &copy; 2021 harmj0y | Designed by <a href="http://felicitybrigham.com">Felicity Brigham Design</a></p>
</div>			</div>
						</div>
										</div>
			</div>

</div>
	</footer><!-- #colophon -->
	</div><!-- #page -->
	<div style="display:none">
	<div class="grofile-hash-map-7cb5012ce43561cba51785ac4fd49dad">
	</div>
	<div class="grofile-hash-map-a874809641a854ae50e959b608dadefc">
	</div>
	<div class="grofile-hash-map-813722e41de3bc9c45062f9ef557acb2">
	</div>
	<div class="grofile-hash-map-dcdc65f3a1409202c8181b11a313fa53">
	</div>
	<div class="grofile-hash-map-b42ff7f9bc86bef4346478dc5a113bca">
	</div>
	<div class="grofile-hash-map-39cf09e81f30b0474ef1f7f82fa242dc">
	</div>
	<div class="grofile-hash-map-f220d4aa86b7f1248872346fe4ef82f2">
	</div>
	<div class="grofile-hash-map-84f652ca20ba1853ee8c4de4a4e12c88">
	</div>
	<div class="grofile-hash-map-f58e369332fe3e41985f346118863588">
	</div>
	</div>
<script src='https://www.harmj0y.net/blog/wp-includes/js/comment-reply.min.js?ver=5.7.2' id='comment-reply-js'></script>
<script id='astra-theme-js-js-extra'>
var astra = {"break_point":"921","isRtl":""};
</script>
<script src='https://www.harmj0y.net/blog/wp-content/themes/astra/assets/js/minified/frontend.min.js?ver=3.4.2' id='astra-theme-js-js'></script>
<script src='https://secure.gravatar.com/js/gprofiles.js?ver=202120' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":""};
</script>
<script src='https://www.harmj0y.net/blog/wp-content/plugins/jetpack/modules/wpgroho.js?ver=9.7' id='wpgroho-js'></script>
<script src='https://www.harmj0y.net/blog/wp-content/plugins/jetpack/_inc/build/twitter-timeline.min.js?ver=4.0.0' id='jetpack-twitter-timeline-js'></script>
<script src='https://www.harmj0y.net/blog/wp-includes/js/wp-embed.min.js?ver=5.7.2' id='wp-embed-js'></script>
<script async="async" src='https://www.harmj0y.net/blog/wp-content/plugins/akismet/_inc/form.js?ver=4.1.9' id='akismet-form-js'></script>
			<script>
			/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
			</script>
			<script src='https://stats.wp.com/e-202120.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'65454229',post:'3466',tz:'-5',srv:'www.harmj0y.net'} ]);
	_stq.push([ 'clickTrackerInit', '65454229', '3466' ]);
</script>
	</body>
</html>

<!-- Page generated by LiteSpeed Cache 3.6.4 on 2021-05-22 16:49:57 -->