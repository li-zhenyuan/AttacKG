
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/icon-Unit42-180x180.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/icon-Unit42-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/icon-Unit42-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/%e3%80%8cxbash%e3%80%8d-%e3%83%9c%e3%83%83%e3%83%88%e3%83%8d%e3%83%83%e3%83%88%e3%80%81%e3%83%a9%e3%83%b3%e3%82%b5%e3%83%a0%e3%82%a6%e3%82%a7%e3%82%a2%e3%80%81%e6%9a%97%e5%8f%b7%e9%80%9a%e8%b2%a8/" />

	<!-- This site is optimized with the Yoast SEO plugin v15.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Xbash Combines Botnet, Ransomware, Coinmining in Worm that Targets Linux and Windows</title>
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Xbash Combines Botnet, Ransomware, Coinmining in Worm that Targets Linux and Windows" />
	<meta property="og:description" content="Unit 42 researchers discover Xbash, a new malware family tied to the Iron Group targeting Linux and Microsoft Servers" />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/" />
	<meta property="og:site_name" content="Unit42" />
	<meta property="article:published_time" content="2018-09-17T12:00:46+00:00" />
	<meta property="article:modified_time" content="2020-01-16T21:43:55+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" />
	<meta property="og:image:width" content="600" />
	<meta property="og:image:height" content="300" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Claud Xiao">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="13 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://unit42.paloaltonetworks.com/#website","url":"https://unit42.paloaltonetworks.com/","name":"Unit42","description":"Palo Alto Networks","potentialAction":[{"@type":"SearchAction","target":"https://unit42.paloaltonetworks.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/#primaryimage","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg","width":600,"height":300},{"@type":"WebPage","@id":"https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/#webpage","url":"https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/","name":"Xbash Combines Botnet, Ransomware, Coinmining in Worm that Targets Linux and Windows","isPartOf":{"@id":"https://unit42.paloaltonetworks.com/#website"},"primaryImageOfPage":{"@id":"https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/#primaryimage"},"datePublished":"2018-09-17T12:00:46+00:00","dateModified":"2020-01-16T21:43:55+00:00","author":{"@id":"https://unit42.paloaltonetworks.com/#/schema/person/89ee8ac0f6c12996775dcaad722a90dd"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/"]}]},{"@type":"Person","@id":"https://unit42.paloaltonetworks.com/#/schema/person/89ee8ac0f6c12996775dcaad722a90dd","name":"Claud Xiao","image":{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.com/#personlogo","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg","caption":"Claud Xiao"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Xbash Combines Botnet, Ransomware, Coinmining in Worm that Targets Linux and Windows Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/feed/" />
<meta property="og:likes" content="1"/>
<meta property="og:readtime" content="12"/>
<meta property="og:views" content="47,572"/>
<meta property="og:date_created" content="September 17, 2018 at 5:00 AM"/>
<meta property="og:post_length" content="3247"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Claud Xiao"/>
<meta property="og:author" content="Cong Zheng"/>
<meta property="og:author" content="Xingyu Jin"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/claud-xiao/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/cong-zheng/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/xingyu-jin/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Xbash Combines Botnet, Ransomware, Coinmining in Worm that Targets Linux and Windows","name":"Xbash Combines Botnet, Ransomware, Coinmining in Worm that Targets Linux and Windows","description":"Unit 42 researchers discover Xbash, a new malware family tied to the Iron Group targeting Linux and Microsoft Servers","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows\/","datePublished":"September 17, 2018","articleBody":"Executive Summary:\r\n\r\nUnit 42 researchers have found a new malware family that is targeting Linux and Microsoft Windows servers that we have named XBash. We can tie this malware to the Iron Group, a threat actor group known for ransomware attacks in the past.\r\n\r\nXbash has ransomware and coinmining capabilities.\r\n\r\nIt also has self-propagating capabilities (meaning it has worm-like characteristics similar to WannaCry or Petya\/NotPetya). It also has capabilities not currently implemented that, when implemented, could enable it to spread very quickly within an organizations\u2019 network (again, much like WannaCry or Petya\/NotPetya).\r\n\r\nXbash spreads by attacking weak passwords and unpatched vulnerabilities.\r\n\r\nXbash is data-destructive; destroying Linux-based databases as part of its ransomware capabilities. We can also find NO functionality within Xbash that would enable restoration after the ransom is paid.\r\n\r\nThis means that, like NotPetya, Xbash is data destructive malware posing at ransomware.\r\n\r\nOrganizations can protect themselves against Xbash by:\r\n\r\n \tUsing strong, non-default passwords\r\n \tKeeping up-to-date on security updates\r\n \tImplementing endpoint security on Microsoft Windows AND Linux systems\r\n \tPreventing access to unknown hosts on the internet (to prevent access to command and control servers)\r\n \tImplementing and maintaining rigorous and effective backup and restoration processes and procedures.\r\n\r\nPalo Alto Networks customers are protected against this threat as outlined at the end of this blog.\r\n\r\nBelow are some more specifics on Xbash\u2019s capabilities:\r\n\r\n \tIt combines botnet, coinmining, ransomware and self-propagation.\r\n \tIt targets Linux-based for its ransomware and botnet capabilities.\r\n \tIt targets Microsoft Windows-based systems for its coinmining and self-propagating capabilities.\r\n \tThe ransomware component targets and deletes Linux-based databases.\r\n \tTo date, we have observed 48 incoming transactions to these wallets with total income of about 0.964 bitcoins meaning 48 victims have paid about US$6,000 total (at the time of this writing).\r\n \tHowever, as see no evidence that the paid ransoms have resulted in recovery for the victims.\r\n \tIn fact, we can find no evidence of any functionality that makes recovery possible through ransom payment.\r\n \tOur analysis shows this is likely the work of the Iron group, a group publicly linked to other ransomware campaigns including those that use the Remote Control System (RCS), whose source code was believed to be stolen from the HackingTeam in 2015.\r\n\r\nResearch:\r\n\r\nRecently Unit 42 used WildFire to identify a new malware family targeting Linux servers. After further investigation we realized it\u2019s a combination of botnet and ransomware that developed by an active cybercrime group Iron (aka Rocke) in this year. We have named this new malware \u201cXbash\u201d, based on the name of the malicious code\u2019s original main module.\r\n\r\nPreviously the Iron group developed and spread cryptocurrency miners or cryptocurrency transaction hijacking trojans mainly for Microsoft Windows and only a few for Linux. Instead, Xbash aimed on discovering unprotected services, deleting victim\u2019s MySQL, PostgreSQL and MongoDB databases, and ransom for Bitcoins. Xbash uses three known vulnerabilities in Hadoop, Redis and ActiveMQ for self-propagation or infecting Windows system.\r\n\r\nOther new technical characteristics in Xbash that are worth noting:\r\n\r\n \tDeveloped in Python: Xbash was developed using Python and then converted into self-contained Linux ELF executables by abusing the legitimate tool PyInstaller for distribution.\r\n \tTargets IP addresses and Domain Names: Modern Linux malware such as Mirai or Gafgyt usually generate random IP addresses as scanning destinations. By contrast, Xbash fetches from its C2 servers both IP addresses and domain names for service probing and exploiting.\r\n \tTargets Windows and Linux: When exploiting vulnerable Redis service, Xbash will also figure out whether the service is running on Windows or not. If so, it will send malicious JavaScript or VBScript payload for downloading and executing a coinminer for Windows.\r\n \tIntranet Scanning Functionality: The Xbash authors have developed the new capability of scanning for vulnerable servers within enterprise intranet. We see this functionality in the samples but, interestingly, it has not been enabled that we can see.\r\n\r\nWe have discovered four different versions of Xbash so far. Code and timestamp differences among these versions show that it\u2019s still under active development. The botnet began to operate since as early as May 2018. Thus far, we\u2019ve observed 48 incoming transactions to the Bitcoin wallet addresses used by the malware, which may indicate 48 victims of its ransom behavior.\r\n\r\nIn the rest of this blog, we will introduce more technical details of these behaviors, and introduce how Palo Alto Networks products prevent the threat.\r\n\r\n&nbsp;\r\n\r\nTechnical Details\r\n\r\nFrom Python Code to Native Executable\r\n\r\nIn a previous blog from 2016, Unit 42 revealed a Windows malware being developed by Python and being converted to PE executable by PyInstaller. All four versions of Xbash that we discovered also used this technique. Based on this, we believe the malware authors gain many benefits:\r\n\r\n \tFaster Development: Developing in Python can be easier and faster than in C, C++ or Go: therefore it can enable faster, iterative development which enables the malware\u2019s faster evolution (and can enable faster counter-counter-measures as well).\r\n \tEasy, Assured Installation: PyInstaller creates self-contained native executables which include all necessary dependencies including Python runtime, libraries,user and third-party libraries. Given the diversity of Linux installations and environments, the attackers cannot be sure that Python-based malware would install and run successfully. By packaging in a self-contained native executable like this, ensures that the malware will successfully install on the target systems.\r\n \tAnti-Detection Capabilities: PyInstaller\u2019s code compilation, code compression\/conversion, and optional code encryption together work to obfuscate the indicators of malicious behavior. This obfuscation helps the malware to defeat detection by antivirus\/antimalware engines or static analysis. At the time of this writing, we observed a 1\/57 detection rate for Xbash in VirusTotal as shown in Figure 1.\r\n \tCross-Platform Malware: PyInstaller supports creating binaries for Windows, Apple macOS and Linux from the same Python code: this enables the malware to be truly cross-platform (though at the time of this writing we have not found any Windows or macOS versions of Xbash).\r\n\r\n\r\nFigure 1\u00a0 Detection Rate of Xbash as shown on VirusTotal\r\nThrough manual reverse engineering, we were able to extract the main malicious Python modules from the Xbash executables and decompile them successfully. Therefore, in the later sections of this analysis, we show the Python source code.\r\n\r\n&nbsp;\r\n\r\nC2 Communication\r\n\r\nXbash hard-coded a bunch of domain names as its C2 servers. It also fetches a webpage hosted on Pastebin (listed in the IOCs) to update the C2 domain list. Some of these C2 domains are reused from previous Windows coinminers attributed to Iron cybercrime group.\r\n\r\nAll C2 communications were based on HTTP protocol. We found three kinds of C2 traffic:\r\n\r\n \tOne for fetching a list of IP addresses or domains for scanning\r\n \tOne for fetching a list of weak passwords, in addition of using hard-coded passwords\r\n \tOne for reporting scan results\r\n\r\nThree types of URIs were used to fetch scanning targets:\r\n\r\n \t\/domain\/phpmyadmin or \/domain\/all: to get a list of domains for scanning of vulnerable or unprotected web services such as phpMyAdmin.\r\n \t\/port\/tcp8080, \/port\/udp1900, etc.: to get a list of IP addresses for scanning of their specific TCP or UDP port\r\n \t\/cidir, to get a list of CIDR of IP addresses for popular ports\/services scanning.\r\n\r\nThrough a still alive C2 domain, we were able to get 1,000 domains, 1,000 IP addresses, or a \/22 CIDR per request, respectively as shown in Figure 2. We found that different requests will return different results, showing that the C2 servers were dynamic dispatching tasks to different bots. We randomly chose some domains and didn\u2019t find any specific region or industry targeted. And, the targeted domains are not in the Alexa top one million domains list.\r\n\r\n&nbsp;\r\n\r\n\r\nFigure 2\u00a0 Xbash fetched domains from C2 server for further scanning\r\nPopular Linux botnets such as Mirai and Gafgyt usually only scan IP addresses. Xbash represents a next-stage evolution of Linux botnets by extending the targets to public websites by targeting domains as well as IP address. This also makes deploying a honeypot to observe Xbash challenging since honeypots are usually deployed with IP addresses only. While it may not be an intentional step, the inclusion of domain targeting has an anti-analysis benefit for the attackers.\r\n\r\nBesides of fetching a list of scanning targets, Xbash will also request C2 server via URI \u201c\/p\u201d to fetch a list of weak passwords for brute forcing.\r\n\r\nAfter Xbash has scanned a target and successfully found specific opening ports, weak credentials or exploitable, unpatched vulnerability, it will report the result to a random C2 server via HTTP POST to URI \u201c\/c\u201d.\r\n\r\n&nbsp;\r\n\r\nService Probing and Brute Forcing\r\n\r\nIf the scanning target is an IP address, Xbash will try to scan many TCP or UDP ports. Here are part of services they\u2019re probing and the ports used:\r\n\r\n \tHTTP: 80, 8080, 8888, 8000, 8001, 8088\r\n \tVNC: 5900, 5901, 5902, 5903\r\n \tMySQL: 3306\r\n \tMemcached: 11211\r\n \tMySQL\/MariaDB: 3309, 3308,3360 3306, 3307, 9806, 1433\r\n \tFTP: 21\r\n \tTelnet: 23, 2323\r\n \tPostgreSQL: 5432\r\n \tRedis: 6379, 2379\r\n \tElasticSearch: 9200\r\n \tMongoDB: 27017\r\n \tRDP: 3389\r\n \tUPnP\/SSDP: 1900\r\n \tNTP: 123\r\n \tDNS: 53\r\n \tSNMP: 161\r\n \tLDAP: 389\r\n \tRexec: 512\r\n \tRlogin: 513\r\n \tRsh: 514\r\n \tRsync: 873\r\n \tOracle database: 1521\r\n \tCouchDB: 5984\r\n\r\nFor some services, such as VNC, Rsync, MySQL, MariaDB, Memcached, PostgreSQL, MongoDB, and phpMyAdmin, if a related port is open, it will use a built-in weak username\/password dictionary and try to login into the service as shown in Figure 3. The dictionary also contains common or default passwords for services like Telnet, FTP, and Redis.\r\n\r\n&nbsp;\r\n\r\n\r\nFigure 3\u00a0 Xbash tries to brute force services such as Rsync\r\n\r\nDelete Databases and Ransom\r\nIf Xbash successfully login into a service including MySQL, MongoDB, and PostgreSQL, it will delete almost all existing databases in the server (except for some databases that stored user login information), create a new database named \u201cPLEASE_READ_ME_XYZ\u201d, and leave a ransom message into table \u201cWARNING\u201d of the new database, as shown in Figure 4 and Figure 5.\r\n\r\nSend 0.02 BTC to this address and contact this email with your website or your ip or db_name of your server to recover your database! Your DB is Backed up to our servers!If we not received your payment,we will leak your database\r\n\r\n1jqpmcLygJdH8fN7BCk2cwwNBRWqMZqL1\r\n\r\nbackupsql@pm.me\r\n\r\n&nbsp;\r\n\r\n\r\nFigure 4\u00a0 Xbash create ransom message into MySQL database via phpMyAdmin\r\n\r\nFigure 5\u00a0 New database, table and ransome message created by Xbash\r\nIf Xbash logged into a phpMyAdmin service, it will do exactly the same operations as above to those databases too, via sending HTTP requests to phpMyAdmin. This is because the phpMyAdmin service is usually managing some MySQL databases.\r\n\r\nIt\u2019s important to note that, the database name, table name, table schema, and the ransom message used by Xbash are almost identical with some incidents within multiple waves of ransom attacks to MySQL, MongoDB, ElasticSearch, Hadoop, CouchDB, Cassandra, Redis, AWS S3, etc. at 2016 and 2017, which have compromised over 56,685 servers in the globe by report. The only changes in Xbash are:\r\n\r\n \tDatabase name changed from PLEASE_READ_ME to PLEASE_README_XYZ\r\n \tBitcoins they\u2019re asking for reduced from 0.2 BTC or 0.15 BTC to0.02 BTC\r\n \tBitcoin wallet address and email address changed\r\n \tThis time a blackmail phrase was added into the message: \u201cIf we not received your payment,we will leak your database\u201d\r\n\r\nThus far, we have observed three different bitcoin wallet addresses hard-coded in the Xbash samples. Since May 2018, there are 48 incoming transactions to these wallets with total income of about 0.964 bitcoins (about US$6,000 at the time of this writing). Figure 5 shows one of the wallets. Also, note that the funds are being withdrawn, showing us that the attackers are actively collecting their ransom.\r\n\r\n\r\nFigure 6\u00a0 Incoming transactions to one of bitcoin wallets\r\nHowever, as is so often the case, we see no evidence that the attackers are actually making good on their \u201cpromise\u201d and helping the victims restore their deleted databases. In fact, contrary to the ransom note, we found NO evidence of code in Xbash that backs up the deleted databases at all.\r\n\r\n&nbsp;\r\n\r\nExploit for Propagation\r\n\r\nWhen Xbash finds a destination has Hadoop, Redis or ActiveMQ running, it will also attempt to exploit the service for self-propagation. Three known vulnerabilities are targeted:\r\n\r\n \tHadoop YARN ResourceManager unauthenticated command execution, which was first disclosed in October 2016 and has no CVE number assigned.\r\n \tRedis arbitrary file write and remote command execution, which was first disclosed in October 2015 and has no CVE number assigned. This is shown below in Figure 6.\r\n \tActiveMQ arbitrary file write vulnerability, CVE-2016-3088.\r\n\r\n\r\nFigure 7\u00a0 Xbash exploiting Redis vulnerability\r\nWhen the exploit succeeds, Xbash will either directly execute a shell command to download and to run malicious Shell or Python scripts, or create new cron job to do the same, again as shown in Figure 6. The malicious scripts were downloaded from the same C2 servers as Xbash used. In either instance, their main functions are to kill other popular Coinminers, download Coinminers developed by the Iron cybercrime group, and download Xbash itself onto the target system for further propagation.\r\n\r\nThe net of this is that Xbash targets and uses vulnerable Hadoop, Redis or ActiveMQ systems both to run the attackers\u2019 coinminer AND propagate Xbash within the environment.\r\n\r\n&nbsp;\r\n\r\nInfecting Windows Servers\r\n\r\nAnother notable feature of Xbash is the way it uses Redis and an HTTP service to determine if the vulnerable Redis service is installed on Linux or Microsoft Windows. If the destination being scanned has both vulnerable Redis service and a HTTP service running, Xbash will try to use information leaked by the Redis vulnerability to guess HTTP web server\u2019s installation location. Xbash then uses the location to guess which operating system (Linux or Windows) the destination is running as shown in Figure 7.\r\n\r\n\r\nFigure 8\u00a0 Web server paths Xbash used to determine operating system\r\nIf it believes it\u2019s found a Windows server, Xbash will exploit the Redis vulnerability to create a Windows startup item (as shown in Figure 6), instead of a Linux cronjob. Depends on Xbash\u2019s version, this new startup item will download a malicious HTML or a Scriptlet file from Xbash\u2019s C2 server, and to execute the JavaScript or VBScript code in the file via \u201cmshta\u201d or via \u201cregsvr32\u201d. These scripts will then invoke PowerShell to download a malicious PE executable or PE DLL file from the same C2 server for execution as shown in Figure 8.\r\n\r\n\r\nFigure 8\u00a0 Malicious JavaScript code to be executed in vulnerable Windows server (with comments)\r\nThrough our investigation we found that these malicious PE files were coinminer or ransomware developed by the Iron cybercrime group as shown in Figure 9.\r\n\r\n\r\nFigure 9\u00a0 AutoFocus associated the malicious PE file with Iron cybercrime group\r\nTargeting Enterprise Intranet\r\n\r\nIn all versions of Xbash we found, there is a Python class named \u201cLanScan\u201d. Its functions are to get local intranet information, generate a list of all IP addresses within the same subnet, and to perform port scanning to all these IPs as shown in figure 10. It appears that during its evolution, the author was adding more ports to this piece of code. However, the code was inert and unutilized: it is still standalone and yet to be connected with the main part of the code. We believe the author may enable this functionality in coming versions.\r\n\r\n\r\nFigure 10\u00a0 Generate list of IP addresses in victim\u2019s subnet and perform port scanning\r\n&nbsp;\r\n\r\nIn an enterprise network (including office network and datacenter or private cloud), there are usually more servers providing services internally than to public. And these services are also more likely unprotected or configured with weak password. The chance of find vulnerable services within Intranet is much higher than over Internet. We believe that is the main motivation of Xbash\u2019s Intranet scanning code.\u00a0 If events like WannaCry and NotPetya are any guide, this intranet functionality could make Xbash even more devastating once it\u2019s enabled.\r\n\r\n&nbsp;\r\n\r\nConclusions\r\n\r\nXbash is a novel and complex Linux malware and the newest work of an active cybercrime group. From its characteristics and behaviors, we could realize many trends in current IoT\/Linux security battleground:\r\n\r\n \tAttackers are expanding their profit-making ways from mining cryptocurrency to hijacking or ransom for cryptocurrency\r\n \tAttackers are expanding territory by scanning domain names and by attacking enterprise Intranet\r\n \tAttackers are looking for more potential victims by gathering more and more vulnerabilities from everywhere, no matter whether the vulnerability is new or old, and no matter whether it\u2019s famous or not (a CVE number was assigned or not)\r\n \tAttackers are to toward cross-platform attacks and quick evolution\r\n \tDifferent types of script files are important actors between exploiting and malware execution\r\n\r\nPalo Alto Networks customers are protected from this threat:\r\n\r\n \tWildFire detected Xbash for Linux as well as the dropped CoinMiner for Windows\r\n \tELF and PE format malware\u2019s signatures have been released via Antivirus\r\n \tAll involved malicious domains have been covered by PAN-DB URL Filtering\r\n \tAll three vulnerabilities exploit by Xbash have been covered by Threat Prevention (39786, 39787, 54654, 54655)\r\n \tXbash C2 traffic have been covered by Threat Prevention too (18474, 18475, 18476)\r\n \tAn AutoFocus tag has been created for tracking this attack.\r\n\r\n&nbsp;\r\n\r\nIndicators of Compromise\r\n\r\nSamples for Linux\r\n\r\n7a18c7bdf0c504832c8552766dcfe0ba33dd5493daa3d9dbe9c985c1ce36e5aa\u00a0 zlibx\r\n\r\n0b9c54692d25f68ede1de47d4206ec3cd2e5836e368794eccb3daa632334c641\u00a0 Xbash\r\n\r\ndbc380cbfb1536dfb24ef460ce18bccdae549b4585ba713b5228c23924385e54\u00a0 xapache\r\n\r\n5b790f02bdb26b6b6b270a5669311b4f231d17872aafb237b7e87b6bbb57426d\u00a0 libhttpd\r\n\r\ne59be6eec9629d376a8a4a70fe9f8f3eec7b0919019f819d44b9bdd1c429277c\u00a0 XbashX\r\n\r\nf808a42b10cf55603389945a549ce45edc6a04562196d14f7489af04688f12bc\u00a0 XbashY\r\n\r\ndcd37e5b266cc0cd3fab73caa63b218f5b92e9bd5b25cf1cacf1afdb0d8e76ff\u00a0 rootv2.sh\r\n\r\nde63ce4a42f06a5903b9daa62b67fcfbdeca05beb574f966370a6ae7fd21190d\u00a0 lowerv2.sh\r\n\r\n09968c4573580398b3269577ced28090eae4a7c326c1a0ec546761c623625885\u00a0 rootv2.sh\r\n\r\na27acc07844bb751ac33f5df569fd949d8b61dba26eb5447482d90243fc739af\u00a0 r88.sh\r\n\r\n&nbsp;\r\n\r\nSamples for Windows\r\n\r\nf888dda9ca1876eba12ffb55a7a993bd1f5a622a30045a675da4955ede3e4cb8\u00a0 tt.txt\r\n\r\n31155bf8c85c6c6193842b8d09bda88990d710db9f70efe85c421f1484f0ee78\u00a0 tg.jpg\r\n\r\n725efd0f5310763bc5375e7b72dbb2e883ad90ec32d6177c578a1c04c1b62054\u00a0 reg9.sct\r\n\r\nd7fbd2a4db44d86b4cf5fa4202203dacfefd6ffca6a0615dca5bc2a200ad56b6\u00a0 m.png\r\n\r\nece3cfdb75aaabc570bf38af6f4653f73101c1641ce78a4bb146e62d9ac0cd50\u00a0 tmp.jpg\r\n\r\n&nbsp;\r\n\r\nDownloading URLs\r\n\r\nhxxp:\/\/3g2upl4pq6kufc4m[.]tk\/zlibx\r\n\r\nhxxp:\/\/e3sas6tzvehwgpak[.]tk\/XbashY\r\n\r\nhxxp:\/\/3g2upl4pq6kufc4m[.]tk\/XbashY\r\n\r\nhxxp:\/\/3g2upl4pq6kufc4m[.]tk\/xapache\r\n\r\nhxxp:\/\/3g2upl4pq6kufc4m[.]tk\/libhttpd\r\n\r\nhxxp:\/\/xmr.enjoytopic[.]tk\/l\/rootv2.sh\r\n\r\nhxxp:\/\/xmr.enjoytopic[.]tk\/l2\/rootv2.sh\r\n\r\nhxxp:\/\/xmr.enjoytopic[.]tk\/l\/r88.sh\r\n\r\nhxxp:\/\/xmr.enjoytopic[.]tk\/12\/r88.sh\r\n\r\nhxxp:\/\/e3sas6tzvehwgpak[.]tk\/lowerv2.sh\r\n\r\nhxxp:\/\/3g2upl4pq6kufc4m[.]tk\/r88.sh\r\n\r\nhxxp:\/\/e3sas6tzvehwgpak[.]tk\/XbashY\r\n\r\nhxxp:\/\/e3sas6tzvehwgpak[.]tk\/XbashX\r\n\r\nhxxp:\/\/png.realtimenews[.]tk\/m.png\r\n\r\nhxxp:\/\/daknobcq4zal6vbm[.]tk\/tt.txt\r\n\r\nhxxp:\/\/d3goboxon32grk2l[.]tk\/reg9.sct\r\n\r\n&nbsp;\r\n\r\nDomains for C2 Communication\r\n\r\nejectrift.censys[.]xyz\r\n\r\nscan.censys[.]xyz\r\n\r\napi.leakingprivacy[.]tk\r\n\r\nnews.realnewstime[.]xyz\r\n\r\nscan.realnewstime[.]xyz\r\n\r\nnews.realtimenews[.]tk\r\n\r\nscanaan[.]tk\r\n\r\nscan.3g2upl4pq6kufc4m[.]tk\r\n\r\nscan.vfk2k5s5tfjr27tz[.]tk\r\n\r\nscan.blockbitcoin[.]tk\r\n\r\nblockbitcoin[.]com\r\n\r\n&nbsp;\r\n\r\nIPs for C2 Communication\r\n\r\n142.44.215[.]177\r\n\r\n144.217.61[.]147\r\n\r\n&nbsp;\r\n\r\nURLs for C2 Domain Updating\r\n\r\nhxxps:\/\/pastebin[.]com\/raw\/Xu74Mzif\r\n\r\nhxxps:\/\/pastebin[.]com\/raw\/rBHjTZY6\r\n\r\n&nbsp;\r\n\r\nBitcoin Wallet Addresses in Ransom Messages\r\n\r\n1Kss6v4eSUgP4WrYtfYGZGDoRsf74M7CMr\r\n\r\n1jqpmcLygJdH8fN7BCk2cwwNBRWqMZqL1\r\n\r\n1ExbdpvKJ6M1t5KyiZbnzsdQ63SEsY6Bff\r\n\r\n&nbsp;\r\n\r\nEmail Addresses in Ransom Messages\r\n\r\nbackupsql@protonmail[.]com\r\n\r\nbackupsql@pm[.]me\r\n\r\nbackupdatabase@pm[.]me","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2018\/04\/unit42-blog-600x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Claud Xiao"},{"@type":"Person","name":"Cong Zheng"},{"@type":"Person","name":"Xingyu Jin"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.2.4' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='application/json' id="wpp-json">
{"sampling_active":0,"sampling_rate":100,"ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":90792,"token":"ca80e59221","lang":0,"debug":0}
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp.min.js?ver=5.2.4'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.4.3'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=90792' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.4.3 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>

  <body class="post-template-default single single-post postid-90792 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <!--<img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" />-->
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/images/svg/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>


  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Xbash Combines Botnet, Ransomware, Coinmining in Worm that Targets Linux and Windows</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-90792 entry-meta">
				
				
				<span class="post-views-count">47,572</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'90792','like')"><i class="ui ui-2"></i><span class="ml-5">1</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 12</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/share?text=Xbash+Combines+Botnet%2C+Ransomware%2C+Coinmining+in+Worm+that+Targets+Linux+and+Windows&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows%2F" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows%2F&title=Xbash+Combines+Botnet%2C+Ransomware%2C+Coinmining+in+Worm+that+Targets+Linux+and+Windows&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>
    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/claud-xiao/" title="Posts by Claud Xiao" class="author url fn" rel="author">Claud Xiao</a>, <a href="https://unit42.paloaltonetworks.com/author/cong-zheng/" title="Posts by Cong Zheng" class="author url fn" rel="author">Cong Zheng</a> and <a href="https://unit42.paloaltonetworks.com/author/xingyu-jin/" title="Posts by Xingyu Jin" class="author url fn" rel="author">Xingyu Jin</a>        </p>
        <p><time datetime="2018-09-17T12:00:46+00:00">September 17, 2018 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/activemq/" rel="tag">ActiveMQ</a>, <a href="https://unit42.paloaltonetworks.com/tag/apple-macos/" rel="tag">Apple macOS</a>, <a href="https://unit42.paloaltonetworks.com/tag/bitcoin-by-claud-xiao/" rel="tag">Bitcoin By: Claud Xiao</a>, <a href="https://unit42.paloaltonetworks.com/tag/botnet/" rel="tag">botnet</a>, <a href="https://unit42.paloaltonetworks.com/tag/cloud/" rel="tag">Cloud</a>, <a href="https://unit42.paloaltonetworks.com/tag/cong-zheng/" rel="tag">Cong Zheng</a>, <a href="https://unit42.paloaltonetworks.com/tag/couchdb/" rel="tag">CouchDB</a>, <a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" rel="tag">Cryptocurrency</a>, <a href="https://unit42.paloaltonetworks.com/tag/elasticsearch/" rel="tag">Elasticsearch</a>, <a href="https://unit42.paloaltonetworks.com/tag/hadoop/" rel="tag">Hadoop</a>, <a href="https://unit42.paloaltonetworks.com/tag/iron/" rel="tag">Iron</a>, <a href="https://unit42.paloaltonetworks.com/tag/linux/" rel="tag">Linux</a>, <a href="https://unit42.paloaltonetworks.com/tag/microsoft-windows/" rel="tag">Microsoft Windows</a>, <a href="https://unit42.paloaltonetworks.com/tag/mongodb/" rel="tag">MongoDB</a>, <a href="https://unit42.paloaltonetworks.com/tag/mysql/" rel="tag">MySQL</a>, <a href="https://unit42.paloaltonetworks.com/tag/oracle/" rel="tag">Oracle</a>, <a href="https://unit42.paloaltonetworks.com/tag/postgresql/" rel="tag">PostgreSQL</a>, <a href="https://unit42.paloaltonetworks.com/tag/rdp/" rel="tag">RDP</a>, <a href="https://unit42.paloaltonetworks.com/tag/redis/" rel="tag">Redis</a>, <a href="https://unit42.paloaltonetworks.com/tag/rocke/" rel="tag">Rocke</a>, <a href="https://unit42.paloaltonetworks.com/tag/vulnerability/" rel="tag">vulnerability</a>, <a href="https://unit42.paloaltonetworks.com/tag/xbash/" rel="tag">Xbash</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="600" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300.jpg 600w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-300x150.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/04/unit42-blog-600x300-370x185.jpg 370w" sizes="(max-width: 600px) 100vw, 600px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/%e3%80%8cxbash%e3%80%8d-%e3%83%9c%e3%83%83%e3%83%88%e3%83%8d%e3%83%83%e3%83%88%e3%80%81%e3%83%a9%e3%83%b3%e3%82%b5%e3%83%a0%e3%82%a6%e3%82%a7%e3%82%a2%e3%80%81%e6%9a%97%e5%8f%b7%e9%80%9a%e8%b2%a8/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p><span style="font-size: 18pt;">Executive Summary:</span></p>
<p>Unit 42 researchers have found a new malware family that is targeting Linux and Microsoft Windows servers that we have named XBash. We can tie this malware to the Iron Group, a threat actor group known for ransomware attacks in the past.</p>
<p>Xbash has ransomware and coinmining capabilities.</p>
<p>It also has self-propagating capabilities (meaning it has worm-like characteristics similar to WannaCry or Petya/NotPetya). It also has capabilities not currently implemented that, when implemented, could enable it to spread very quickly within an organizations’ network (again, much like WannaCry or Petya/NotPetya).</p>
<p>Xbash spreads by attacking weak passwords and unpatched vulnerabilities.</p>
<p>Xbash is data-destructive; destroying Linux-based databases as part of its ransomware capabilities. We can also find NO functionality within Xbash that would enable restoration after the ransom is paid.</p>
<p>This means that, like NotPetya, Xbash is data destructive malware posing at ransomware.</p>
<p>Organizations can protect themselves against Xbash by:</p>
<ol>
<li>Using strong, non-default passwords</li>
<li>Keeping up-to-date on security updates</li>
<li>Implementing endpoint security on Microsoft Windows AND Linux systems</li>
<li>Preventing access to unknown hosts on the internet (to prevent access to command and control servers)</li>
<li>Implementing and maintaining rigorous and effective backup and restoration processes and procedures.</li>
</ol>
<p>Palo Alto Networks customers are protected against this threat as outlined at the end of this blog.</p>
<p>Below are some more specifics on Xbash’s capabilities:</p>
<ul>
<li>It combines botnet, coinmining, ransomware and self-propagation.</li>
<li>It targets Linux-based for its ransomware and botnet capabilities.</li>
<li>It targets Microsoft Windows-based systems for its coinmining and self-propagating capabilities.</li>
<li>The ransomware component targets and deletes Linux-based databases.</li>
<li>To date, we have observed 48 incoming transactions to these wallets with total income of about 0.964 bitcoins meaning 48 victims have paid about US$6,000 total (at the time of this writing).</li>
<li>However, as see no evidence that the paid ransoms have resulted in recovery for the victims.</li>
<li>In fact, we can find no evidence of any functionality that makes recovery possible through ransom payment.</li>
<li>Our analysis shows this is likely the work of the Iron group, a group <a href="https://securityaffairs.co/wordpress/73211/malware/iron-cybercrime-group-hackingteam.html">publicly linked</a> to other ransomware campaigns including those that use the Remote Control System (RCS), whose source code was believed to be stolen <a href="https://en.wikipedia.org/wiki/Hacking_Team#2015_data_breach">from the HackingTeam in 2015</a>.</li>
</ul>
<p><strong>Research:</strong></p>
<p>Recently Unit 42 used WildFire to identify a new malware family targeting Linux servers. After further investigation we realized it’s a combination of botnet and ransomware that developed by an active <a href="https://www.intezer.com/iron-cybercrime-group-under-the-scope-2/">cybercrime group Iron</a> (aka <a href="https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html">Rocke</a>) in this year. We have named this new malware “Xbash”, based on the name of the malicious code’s original main module.</p>
<p>Previously the Iron group developed and spread cryptocurrency miners or <a href="https://4hou.win/wordpress/?p=20588">cryptocurrency transaction hijacking</a> trojans mainly for Microsoft Windows and only a few for Linux. Instead, Xbash aimed on discovering unprotected services, deleting victim’s MySQL, PostgreSQL and MongoDB databases, and ransom for Bitcoins. Xbash uses three known vulnerabilities in Hadoop, Redis and ActiveMQ for self-propagation or infecting Windows system.</p>
<p>Other new technical characteristics in Xbash that are worth noting:</p>
<ul>
<li><strong>Developed in </strong><strong><a href="https://www.python.org/">Python:</a></strong> Xbash was developed using Python and then converted into self-contained Linux ELF executables by abusing the legitimate tool <a href="http://www.pyinstaller.org/">PyInstaller</a> for distribution.</li>
<li><strong>Targets IP addresses and Domain Names:</strong> Modern Linux malware such as <a href="https://blog.paloaltonetworks.com/tag/Mirai/">Mirai</a> or <a href="https://blog.paloaltonetworks.com/tag/Gafgyt/">Gafgyt</a> usually generate random IP addresses as scanning destinations. By contrast, Xbash fetches from its C2 servers both IP addresses and domain names for service probing and exploiting.</li>
<li><strong>Targets Windows and Linux:</strong> When exploiting vulnerable <a href="https://redis.io/">Redis</a> service, Xbash will also figure out whether the service is running on Windows or not. If so, it will send malicious JavaScript or VBScript payload for downloading and executing a coinminer for Windows.</li>
<li><strong>Intranet Scanning Functionality:</strong> The Xbash authors have developed the new capability of scanning for vulnerable servers within enterprise intranet. We see this functionality in the samples but, interestingly, it has not been enabled that we can see.</li>
</ul>
<p>We have discovered four different versions of Xbash so far. Code and timestamp differences among these versions show that it’s still under active development. The botnet began to operate since as early as May 2018. Thus far, we’ve observed 48 incoming transactions to the Bitcoin wallet addresses used by the malware, which may indicate 48 victims of its ransom behavior.</p>
<p>In the rest of this blog, we will introduce more technical details of these behaviors, and introduce how Palo Alto Networks products prevent the threat.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Technical Details</span></p>
<p><strong>From Python Code to Native Executable</strong></p>
<p>In <a href="https://blog.paloaltonetworks.com/2016/04/unit42-python-based-pwobot-targets-european-organizations/">a previous blog from 2016</a>, Unit 42 revealed a Windows malware being developed by Python and being converted to PE executable by PyInstaller. All four versions of Xbash that we discovered also used this technique. Based on this, we believe the malware authors gain many benefits:</p>
<ol>
<li><strong>Faster Development:</strong> Developing in Python can be easier and faster than in C, C++ or Go: therefore it can enable faster, iterative development which enables the malware’s faster evolution (and can enable faster counter-counter-measures as well).</li>
<li><strong>Easy, Assured Installation:</strong> PyInstaller creates self-contained native executables which include all necessary dependencies including Python runtime, libraries,user and third-party libraries. Given the diversity of Linux installations and environments, the attackers cannot be sure that Python-based malware would install and run successfully. By packaging in a self-contained native executable like this, ensures that the malware will successfully install on the target systems.</li>
<li><strong>Anti-Detection Capabilities:</strong> PyInstaller’s code compilation, code compression/conversion, and optional code encryption together work to obfuscate the indicators of malicious behavior. This obfuscation helps the malware to defeat detection by antivirus/antimalware engines or static analysis. At the time of this writing, we observed a 1/57 detection rate for Xbash in VirusTotal as shown in Figure 1.</li>
<li><strong>Cross-Platform Malware: </strong>PyInstaller supports creating binaries for Windows, Apple macOS and Linux from the same Python code: this enables the malware to be truly cross-platform (though at the time of this writing we have not found any Windows or macOS versions of Xbash).</li>
</ol>
<p><img class="aligncenter wp-image-90795" src="https://blog.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_1.png" alt="xbash_1" width="600" height="163" /></p>
<p style="text-align: center;"><em>Figure 1  Detection Rate of Xbash as shown on VirusTotal</em></p>
<p>Through manual reverse engineering, we were able to extract the main malicious Python modules from the Xbash executables and decompile them successfully. Therefore, in the later sections of this analysis, we show the Python source code.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">C2 Communication</span></p>
<p>Xbash hard-coded a bunch of domain names as its C2 servers. It also fetches a webpage hosted on Pastebin (listed in the IOCs) to update the C2 domain list. Some of these C2 domains are reused from previous Windows coinminers <a href="https://4hou.win/wordpress/?p=20588">attributed</a> to Iron cybercrime group.</p>
<p>All C2 communications were based on HTTP protocol. We found three kinds of C2 traffic:</p>
<ol>
<li>One for fetching a list of IP addresses or domains for scanning</li>
<li>One for fetching a list of weak passwords, in addition of using hard-coded passwords</li>
<li>One for reporting scan results</li>
</ol>
<p>Three types of URIs were used to fetch scanning targets:</p>
<ol>
<li>/domain/phpmyadmin or /domain/all: to get a list of domains for scanning of vulnerable or unprotected web services such as phpMyAdmin.</li>
<li>/port/tcp8080, /port/udp1900, etc.: to get a list of IP addresses for scanning of their specific TCP or UDP port</li>
<li>/cidir, to get a list of CIDR of IP addresses for popular ports/services scanning.</li>
</ol>
<p>Through a still alive C2 domain, we were able to get 1,000 domains, 1,000 IP addresses, or a /22 CIDR per request, respectively as shown in Figure 2. We found that different requests will return different results, showing that the C2 servers were dynamic dispatching tasks to different bots. We randomly chose some domains and didn’t find any specific region or industry targeted. And, the targeted domains are not in the Alexa top one million domains list.</p>
<p>&nbsp;</p>
<p><img class="aligncenter wp-image-90834" src="https://blog.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_2.png" alt="xbash_2" width="600" height="440" /></p>
<p style="text-align: center;"><em>Figure 2  Xbash fetched domains from C2 server for further scanning</em></p>
<p>Popular Linux botnets such as Mirai and Gafgyt usually only scan IP addresses. Xbash represents a next-stage evolution of Linux botnets by extending the targets to public websites by targeting domains as well as IP address. This also makes deploying a honeypot to observe Xbash challenging since honeypots are usually deployed with IP addresses only. While it may not be an intentional step, the inclusion of domain targeting has an anti-analysis benefit for the attackers.</p>
<p>Besides of fetching a list of scanning targets, Xbash will also request C2 server via URI “/p” to fetch a list of weak passwords for brute forcing.</p>
<p>After Xbash has scanned a target and successfully found specific opening ports, weak credentials or exploitable, unpatched vulnerability, it will report the result to a random C2 server via HTTP POST to URI “/c”.</p>
<p>&nbsp;</p>
<p><strong>Service Probing and Brute Forcing</strong></p>
<p>If the scanning target is an IP address, Xbash will try to scan many TCP or UDP ports. Here are part of services they’re probing and the ports used:</p>
<ul>
<li>HTTP: 80, 8080, 8888, 8000, 8001, 8088</li>
<li>VNC: 5900, 5901, 5902, 5903</li>
<li>MySQL: 3306</li>
<li>Memcached: 11211</li>
<li>MySQL/MariaDB: 3309, 3308,3360 3306, 3307, 9806, 1433</li>
<li>FTP: 21</li>
<li>Telnet: 23, 2323</li>
<li>PostgreSQL: 5432</li>
<li>Redis: 6379, 2379</li>
<li>ElasticSearch: 9200</li>
<li>MongoDB: 27017</li>
<li>RDP: 3389</li>
<li>UPnP/SSDP: 1900</li>
<li>NTP: 123</li>
<li>DNS: 53</li>
<li>SNMP: 161</li>
<li>LDAP: 389</li>
<li>Rexec: 512</li>
<li>Rlogin: 513</li>
<li>Rsh: 514</li>
<li>Rsync: 873</li>
<li>Oracle database: 1521</li>
<li>CouchDB: 5984</li>
</ul>
<p>For some services, such as VNC, Rsync, MySQL, MariaDB, Memcached, PostgreSQL, MongoDB, and phpMyAdmin, if a related port is open, it will use a built-in weak username/password dictionary and try to login into the service as shown in Figure 3. The dictionary also contains common or default passwords for services like Telnet, FTP, and Redis.</p>
<p>&nbsp;</p>
<p><img class="aligncenter wp-image-90873" src="https://blog.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_3.png" alt="xbash_3" width="600" height="304" /></p>
<p style="text-align: center;"><em>Figure 3  Xbash tries to brute force services such as Rsync</em></p>
<h2><span style="font-size: 18pt;"><strong>Delete Databases and Ransom</strong></span></h2>
<p>If Xbash successfully login into a service including MySQL, MongoDB, and PostgreSQL, it will delete almost all existing databases in the server (except for some databases that stored user login information), create a new database named “PLEASE_READ_ME_XYZ”, and leave a ransom message into table “WARNING” of the new database, as shown in Figure 4 and Figure 5.</p>
<p><span style="font-family: 'courier new', courier, monospace;">Send 0.02 BTC to this address and contact this email with your website or your ip or db_name of your server to recover your database! Your DB is Backed up to our servers!If we not received your payment,we will leak your database</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">1jqpmcLygJdH8fN7BCk2cwwNBRWqMZqL1</span></p>
<p><span style="font-family: 'courier new', courier, monospace;">backupsql@pm.me</span></p>
<p>&nbsp;</p>
<p><img class="aligncenter wp-image-90912" src="https://blog.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_4.png" alt="xbash_4" width="600" height="377" /></p>
<p style="text-align: center;"><em>Figure 4  Xbash create ransom message into MySQL database via phpMyAdmin</em></p>
<p style="text-align: left;"><img class="aligncenter wp-image-90951" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_5.png" alt="xbash_5" width="600" height="510" /></p>
<p style="text-align: center;"><em>Figure 5  New database, table and ransome message created by Xbash</em></p>
<p>If Xbash logged into a phpMyAdmin service, it will do exactly the same operations as above to those databases too, via sending HTTP requests to phpMyAdmin. This is because the phpMyAdmin service is usually managing some MySQL databases.</p>
<p>It’s important to note that, the database name, table name, table schema, and the ransom message used by Xbash are almost identical with <a href="https://www.guardicore.com/2017/02/0-2-btc-strikes-back-now-attacking-mysql-databases/">some incidents</a> within <a href="https://www.bleepingcomputer.com/news/security/massive-wave-of-mongodb-ransom-attacks-makes-26-000-new-victims/">multiple waves of ransom attacks</a> to MySQL, MongoDB, ElasticSearch, Hadoop, CouchDB, Cassandra, Redis, AWS S3, etc. at 2016 and 2017, which have compromised over 56,685 servers in the globe <a href="https://www.bleepingcomputer.com/news/security/massive-wave-of-mongodb-ransom-attacks-makes-26-000-new-victims/">by report</a>. The only changes in Xbash are:</p>
<ul>
<li>Database name changed from PLEASE_READ_ME to PLEASE_README_XYZ</li>
<li>Bitcoins they’re asking for reduced from 0.2 BTC or 0.15 BTC to0.02 BTC</li>
<li>Bitcoin wallet address and email address changed</li>
<li>This time a blackmail phrase was added into the message: “If we not received your payment,we will leak your database”</li>
</ul>
<p>Thus far, we have observed three different bitcoin wallet addresses hard-coded in the Xbash samples. Since May 2018, there are 48 incoming transactions to these wallets with total income of about 0.964 bitcoins (about US$6,000 at the time of this writing). Figure 5 shows one of the wallets. Also, note that the funds are being withdrawn, showing us that the attackers are actively collecting their ransom.</p>
<p><img class="aligncenter wp-image-90990" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_6.png" alt="xbash_6" width="600" height="649" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_6.png 441w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_6-277x300.png 277w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_6-370x400.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 6  Incoming transactions to one of bitcoin wallets</em></p>
<p>However, as is so often the case, we see no evidence that the attackers are actually making good on their “promise” and helping the victims restore their deleted databases. In fact, contrary to the ransom note, we found NO evidence of code in Xbash that backs up the deleted databases at all.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Exploit for Propagation</span></p>
<p>When Xbash finds a destination has Hadoop, Redis or ActiveMQ running, it will also attempt to exploit the service for self-propagation. Three known vulnerabilities are targeted:</p>
<ol>
<li><a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/hadoop_unauth_exec.rb">Hadoop YARN ResourceManager unauthenticated command execution</a>, which was first disclosed in October 2016 and has no CVE number assigned.</li>
<li><a href="https://packetstormsecurity.com/files/134200/Redis-Remote-Command-Execution.html">Redis arbitrary file write and remote command execution</a>, which was first disclosed in October 2015 and has no CVE number assigned. This is shown below in Figure 6.</li>
<li><a href="http://activemq.apache.org/security-advisories.data/CVE-2016-3088-announcement.txt">ActiveMQ arbitrary file write vulnerability</a>, CVE-2016-3088.</li>
</ol>
<p><img class="aligncenter wp-image-91029" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_7.png" alt="xbash_7" width="600" height="253" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_7.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_7-900x379.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_7-300x126.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_7-768x323.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_7-370x156.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 7  Xbash exploiting Redis vulnerability</em></p>
<p>When the exploit succeeds, Xbash will either directly execute a shell command to download and to run malicious Shell or Python scripts, or create new cron job to do the same, again as shown in Figure 6. The malicious scripts were downloaded from the same C2 servers as Xbash used. In either instance, their main functions are to kill other popular Coinminers, download Coinminers developed by the Iron cybercrime group, and download Xbash itself onto the target system for further propagation.</p>
<p>The net of this is that Xbash targets and uses vulnerable Hadoop, Redis or ActiveMQ systems both to run the attackers’ coinminer AND propagate Xbash within the environment.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Infecting Windows Servers</span></p>
<p>Another notable feature of Xbash is the way it uses Redis and an HTTP service to determine if the vulnerable Redis service is installed on Linux or Microsoft Windows. If the destination being scanned has both vulnerable Redis service and a HTTP service running, Xbash will try to use information leaked by the Redis vulnerability to guess HTTP web server’s installation location. Xbash then uses the location to guess which operating system (Linux or Windows) the destination is running as shown in Figure 7.</p>
<p><img class="aligncenter wp-image-91068" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_8.png" alt="xbash_8" width="600" height="132" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_8.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_8-900x198.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_8-300x66.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_8-768x169.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_8-370x81.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 8  Web server paths Xbash used to determine operating system</em></p>
<p>If it believes it’s found a Windows server, Xbash will exploit the Redis vulnerability to create a Windows startup item (as shown in Figure 6), instead of a Linux cronjob. Depends on Xbash’s version, this new startup item will download a malicious HTML or a Scriptlet file from Xbash’s C2 server, and to execute the JavaScript or VBScript code in the file via “mshta” or via “regsvr32”. These scripts will then invoke PowerShell to download a malicious PE executable or PE DLL file from the same C2 server for execution as shown in Figure 8.</p>
<p><img class="aligncenter wp-image-91107" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_9.png" alt="xbash_9" width="600" height="337" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_9.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_9-900x505.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_9-300x168.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_9-768x431.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_9-370x208.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 8  Malicious JavaScript code to be executed in vulnerable Windows server (with comments)</em></p>
<p>Through our investigation we found that these malicious PE files were coinminer or ransomware developed by the Iron cybercrime group as shown in Figure 9.</p>
<p><img class="aligncenter wp-image-91146" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_10.png" alt="xbash_10" width="600" height="209" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_10.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_10-900x313.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_10-300x104.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_10-768x267.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_10-370x129.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 9  AutoFocus associated the malicious PE file with Iron cybercrime group</em></p>
<p><span style="font-size: 18pt;">Targeting Enterprise Intranet</span></p>
<p>In all versions of Xbash we found, there is a Python class named “LanScan”. Its functions are to get local intranet information, generate a list of all IP addresses within the same subnet, and to perform port scanning to all these IPs as shown in figure 10. It appears that during its evolution, the author was adding more ports to this piece of code. However, the code was inert and unutilized: it is still standalone and yet to be connected with the main part of the code. We believe the author may enable this functionality in coming versions.</p>
<p><img class="aligncenter wp-image-91185" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_11.png" alt="xbash_11" width="600" height="416" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_11.png 974w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_11-900x624.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_11-300x208.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_11-768x532.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2018/09/xbash_11-370x256.png 370w" sizes="(max-width: 600px) 100vw, 600px" /></p>
<p style="text-align: center;"><em>Figure 10  Generate list of IP addresses in victim’s subnet and perform port scanning</em></p>
<p>&nbsp;</p>
<p>In an enterprise network (including office network and datacenter or private cloud), there are usually more servers providing services internally than to public. And these services are also more likely unprotected or configured with weak password. The chance of find vulnerable services within Intranet is much higher than over Internet. We believe that is the main motivation of Xbash’s Intranet scanning code.  If events like WannaCry and NotPetya are any guide, this intranet functionality could make Xbash even more devastating once it’s enabled.</p>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Conclusions</span></p>
<p>Xbash is a novel and complex Linux malware and the newest work of an active cybercrime group. From its characteristics and behaviors, we could realize many trends in current IoT/Linux security battleground:</p>
<ul>
<li>Attackers are expanding their profit-making ways from mining cryptocurrency to hijacking or ransom for cryptocurrency</li>
<li>Attackers are expanding territory by scanning domain names and by attacking enterprise Intranet</li>
<li>Attackers are looking for more potential victims by gathering more and more vulnerabilities from everywhere, no matter whether the vulnerability is new or old, and no matter whether it’s famous or not (a CVE number was assigned or not)</li>
<li>Attackers are to toward cross-platform attacks and quick evolution</li>
<li>Different types of script files are important actors between exploiting and malware execution</li>
</ul>
<p>Palo Alto Networks customers are protected from this threat:</p>
<ul>
<li>WildFire detected Xbash for Linux as well as the dropped CoinMiner for Windows</li>
<li>ELF and PE format malware’s signatures have been released via Antivirus</li>
<li>All involved malicious domains have been covered by PAN-DB URL Filtering</li>
<li>All three vulnerabilities exploit by Xbash have been covered by Threat Prevention (39786, 39787, 54654, 54655)</li>
<li>Xbash C2 traffic have been covered by Threat Prevention too (18474, 18475, 18476)</li>
<li><a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Xbash">An AutoFocus tag</a> has been created for tracking this attack.</li>
</ul>
<p>&nbsp;</p>
<p><span style="font-size: 18pt;">Indicators of Compromise</span></p>
<p><strong>Samples for Linux</strong></p>
<p>7a18c7bdf0c504832c8552766dcfe0ba33dd5493daa3d9dbe9c985c1ce36e5aa  zlibx</p>
<p>0b9c54692d25f68ede1de47d4206ec3cd2e5836e368794eccb3daa632334c641  Xbash</p>
<p>dbc380cbfb1536dfb24ef460ce18bccdae549b4585ba713b5228c23924385e54  xapache</p>
<p>5b790f02bdb26b6b6b270a5669311b4f231d17872aafb237b7e87b6bbb57426d  libhttpd</p>
<p>e59be6eec9629d376a8a4a70fe9f8f3eec7b0919019f819d44b9bdd1c429277c  XbashX</p>
<p>f808a42b10cf55603389945a549ce45edc6a04562196d14f7489af04688f12bc  XbashY</p>
<p>dcd37e5b266cc0cd3fab73caa63b218f5b92e9bd5b25cf1cacf1afdb0d8e76ff  rootv2.sh</p>
<p>de63ce4a42f06a5903b9daa62b67fcfbdeca05beb574f966370a6ae7fd21190d  lowerv2.sh</p>
<p>09968c4573580398b3269577ced28090eae4a7c326c1a0ec546761c623625885  rootv2.sh</p>
<p>a27acc07844bb751ac33f5df569fd949d8b61dba26eb5447482d90243fc739af  r88.sh</p>
<p>&nbsp;</p>
<p><strong>Samples for Windows</strong></p>
<p>f888dda9ca1876eba12ffb55a7a993bd1f5a622a30045a675da4955ede3e4cb8  tt.txt</p>
<p>31155bf8c85c6c6193842b8d09bda88990d710db9f70efe85c421f1484f0ee78  tg.jpg</p>
<p>725efd0f5310763bc5375e7b72dbb2e883ad90ec32d6177c578a1c04c1b62054  reg9.sct</p>
<p>d7fbd2a4db44d86b4cf5fa4202203dacfefd6ffca6a0615dca5bc2a200ad56b6  m.png</p>
<p>ece3cfdb75aaabc570bf38af6f4653f73101c1641ce78a4bb146e62d9ac0cd50  tmp.jpg</p>
<p>&nbsp;</p>
<p><strong>Downloading URLs</strong></p>
<p>hxxp://3g2upl4pq6kufc4m[.]tk/zlibx</p>
<p>hxxp://e3sas6tzvehwgpak[.]tk/XbashY</p>
<p>hxxp://3g2upl4pq6kufc4m[.]tk/XbashY</p>
<p>hxxp://3g2upl4pq6kufc4m[.]tk/xapache</p>
<p>hxxp://3g2upl4pq6kufc4m[.]tk/libhttpd</p>
<p>hxxp://xmr.enjoytopic[.]tk/l/rootv2.sh</p>
<p>hxxp://xmr.enjoytopic[.]tk/l2/rootv2.sh</p>
<p>hxxp://xmr.enjoytopic[.]tk/l/r88.sh</p>
<p>hxxp://xmr.enjoytopic[.]tk/12/r88.sh</p>
<p>hxxp://e3sas6tzvehwgpak[.]tk/lowerv2.sh</p>
<p>hxxp://3g2upl4pq6kufc4m[.]tk/r88.sh</p>
<p>hxxp://e3sas6tzvehwgpak[.]tk/XbashY</p>
<p>hxxp://e3sas6tzvehwgpak[.]tk/XbashX</p>
<p>hxxp://png.realtimenews[.]tk/m.png</p>
<p>hxxp://daknobcq4zal6vbm[.]tk/tt.txt</p>
<p>hxxp://d3goboxon32grk2l[.]tk/reg9.sct</p>
<p>&nbsp;</p>
<p><strong>Domains for C2 Communication</strong></p>
<p>ejectrift.censys[.]xyz</p>
<p>scan.censys[.]xyz</p>
<p>api.leakingprivacy[.]tk</p>
<p>news.realnewstime[.]xyz</p>
<p>scan.realnewstime[.]xyz</p>
<p>news.realtimenews[.]tk</p>
<p>scanaan[.]tk</p>
<p>scan.3g2upl4pq6kufc4m[.]tk</p>
<p>scan.vfk2k5s5tfjr27tz[.]tk</p>
<p>scan.blockbitcoin[.]tk</p>
<p>blockbitcoin[.]com</p>
<p>&nbsp;</p>
<p><strong>IPs for C2 Communication</strong></p>
<p>142.44.215[.]177</p>
<p>144.217.61[.]147</p>
<p>&nbsp;</p>
<p><strong>URLs for C2 Domain Updating</strong></p>
<p>hxxps://pastebin[.]com/raw/Xu74Mzif</p>
<p>hxxps://pastebin[.]com/raw/rBHjTZY6</p>
<p>&nbsp;</p>
<p><strong>Bitcoin Wallet Addresses in Ransom Messages</strong></p>
<p>1Kss6v4eSUgP4WrYtfYGZGDoRsf74M7CMr</p>
<p>1jqpmcLygJdH8fN7BCk2cwwNBRWqMZqL1</p>
<p>1ExbdpvKJ6M1t5KyiZbnzsdQ63SEsY6Bff</p>
<p>&nbsp;</p>
<p><strong>Email Addresses in Ransom Messages</strong></p>
<p>backupsql@protonmail[.]com</p>
<p>backupsql@pm[.]me</p>
<p>backupdatabase@pm[.]me</p>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" name="emailFormMask" value="">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>


        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2021 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","enable_video_popuping":"enable","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
