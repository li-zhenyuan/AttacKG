<!DOCTYPE html><!--[if IE 7]>
<html class="ie ie7" lang="en-US" prefix="og: http://ogp.me/ns#">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US" prefix="og: http://ogp.me/ns#">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<!--<![endif]-->
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Finding Passwords in SYSVOL &#038; Exploiting Group Policy Preferences &#8211; Active Directory Security</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Feed" href="https://adsecurity.org/?feed=rss2" />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Comments Feed" href="https://adsecurity.org/?feed=comments-rss2" />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Finding Passwords in SYSVOL &#038; Exploiting Group Policy Preferences Comments Feed" href="https://adsecurity.org/?feed=rss2&#038;p=2288" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/adsecurity.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='https://adsecurity.org/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css'  href='https://adsecurity.org/wp-content/themes/graphene/bootstrap/css/bootstrap.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://adsecurity.org/wp-content/themes/graphene/fonts/font-awesome/css/font-awesome.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='graphene-css'  href='https://adsecurity.org/wp-content/themes/graphene/style.css?ver=2.8.4' type='text/css' media='screen' />
<link rel='stylesheet' id='graphene-responsive-css'  href='https://adsecurity.org/wp-content/themes/graphene/responsive.css?ver=2.8.4' type='text/css' media='all' />
<link rel='stylesheet' id='graphene-blocks-css'  href='https://adsecurity.org/wp-content/themes/graphene/blocks.css?ver=2.8.4' type='text/css' media='all' />
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/bootstrap/js/bootstrap.min.js?ver=2.8.4' id='bootstrap-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js?ver=2.8.4' id='bootstrap-hover-dropdown-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/bootstrap-submenu/bootstrap-submenu.min.js?ver=2.8.4' id='bootstrap-submenu-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/jquery.infinitescroll.min.js?ver=2.8.4' id='infinite-scroll-js'></script>
<script type='text/javascript' id='graphene-js-extra'>
/* <![CDATA[ */
var grapheneJS = {"siteurl":"https:\/\/adsecurity.org","ajaxurl":"https:\/\/adsecurity.org\/wp-admin\/admin-ajax.php","templateUrl":"https:\/\/adsecurity.org\/wp-content\/themes\/graphene","isSingular":"1","enableStickyMenu":"","shouldShowComments":"1","commentsOrder":"newest","sliderDisable":"","sliderInterval":"7000","infScrollBtnLbl":"Load more","infScrollOn":"","infScrollCommentsOn":"","totalPosts":"1","postsPerPage":"10","isPageNavi":"","infScrollMsgText":"Fetching window.grapheneInfScrollItemsPerPage of window.grapheneInfScrollItemsLeft items left ...","infScrollMsgTextPlural":"Fetching window.grapheneInfScrollItemsPerPage of window.grapheneInfScrollItemsLeft items left ...","infScrollFinishedText":"All loaded!","commentsPerPage":"50","totalComments":"1","infScrollCommentsMsg":"Fetching window.grapheneInfScrollCommentsPerPage of window.grapheneInfScrollCommentsLeft comments left ...","infScrollCommentsMsgPlural":"Fetching window.grapheneInfScrollCommentsPerPage of window.grapheneInfScrollCommentsLeft comments left ...","infScrollCommentsFinishedMsg":"All comments loaded!","disableLiveSearch":"1","txtNoResult":"No result found.","isMasonry":""};
/* ]]> */
</script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/graphene.js?ver=2.8.4' id='graphene-js'></script>
<link rel="https://api.w.org/" href="https://adsecurity.org/index.php?rest_route=/" /><link rel="alternate" type="application/json" href="https://adsecurity.org/index.php?rest_route=/wp/v2/posts/2288" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://adsecurity.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://adsecurity.org/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="https://adsecurity.org/?p=2288" />
<link rel='shortlink' href='https://adsecurity.org/?p=2288' />
<link rel="alternate" type="application/json+oembed" href="https://adsecurity.org/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2Fadsecurity.org%2F%3Fp%3D2288" />
<link rel="alternate" type="text/xml+oembed" href="https://adsecurity.org/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2Fadsecurity.org%2F%3Fp%3D2288&#038;format=xml" />
		<script type="text/javascript">
			var _statcounter = _statcounter || [];
			_statcounter.push({"tags": {"author": "SeanMetcalf"}});
		</script>
				<script>
		   WebFontConfig = {
		      google: { 
		      	families: ["Lato:400,400i,700,700i&display=swap"]		      }
		   };

		   (function(d) {
		      var wf = d.createElement('script'), s = d.scripts[0];
		      wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
		      wf.async = true;
		      s.parentNode.insertBefore(wf, s);
		   })(document);
		</script>
	<style type="text/css">
.header_title, .header_title a, .header_title a:visited, .header_title a:hover, .header_desc {color:#000000}.carousel, .carousel .item{height:400px}@media (max-width: 991px) {.carousel, .carousel .item{height:250px}}#header{max-height:198px}@media (min-width: 1200px) {.container {width:1280px}}
</style>
		<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":"https:\/\/adsecurity.org\/?p=2288","publisher":{"@type":"Organization","name":"Active Directory Security"},"headline":"Finding Passwords in SYSVOL &#038; Exploiting Group Policy Preferences","datePublished":"2015-12-28T15:17:14+00:00","dateModified":"2018-10-12T11:32:36+00:00","description":"At Black Hat and DEF CON this year, I spoke about ways attackers go from Domain User to Domain Admin in modern enterprises. Every Windows computer has a built-in Administrator account with an associated password. Changing this password is a security requirement in most organizations, though the method for doing so is not straight-forward. A ...","author":{"@type":"Person","name":"Sean Metcalf"},"image":["https:\/\/adsecurity.org\/wp-content\/uploads\/2015\/12\/GPP-LocalAdmin-PasswordChange-XML-File-02.png"]}</script>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><meta property="og:type" content="article" />
<meta property="og:title" content="Finding Passwords in SYSVOL &#038; Exploiting Group Policy Preferences" />
<meta property="og:url" content="https://adsecurity.org/?p=2288" />
<meta property="og:site_name" content="Active Directory Security" />
<meta property="og:description" content="At Black Hat and DEF CON this year, I spoke about ways attackers go from Domain User to Domain Admin in modern enterprises. Every Windows computer has a built-in Administrator account with an associated password. Changing this password is a security requirement in most organizations, though the method for doing so is not straight-forward. A ..." />
<meta property="og:updated_time" content="2018-10-12T11:32:36+00:00" />
<meta property="article:modified_time" content="2018-10-12T11:32:36+00:00" />
<meta property="article:published_time" content="2015-12-28T15:17:14+00:00" />
<meta property="og:image" content="https://adsecurity.org/wp-content/uploads/2015/12/GPP-LocalAdmin-PasswordChange-XML-File-02.png" />
<meta property="og:image:width" content="912" />
<meta property="og:image:height" content="179" />
    </head>
    <body class="post-template-default single single-post postid-2288 single-format-standard custom-background wp-embed-responsive layout-boxed two_col_left two-columns singular">
        
        <div class="container boxed-wrapper">
            
                            <div id="top-bar" class="row clearfix top-bar ">
                    
                                                    
                            <div class="col-md-12 top-bar-items">
                                
                                                                                                    	<ul class="social-profiles">
							
			            <li class="social-profile social-profile-rss">
			            	<a href="https://adsecurity.org/?feed=rss2" title="Subscribe to Tech, News, and Other Ideations&#039;s RSS feed" id="social-id-1" class="mysocial social-rss">
			            				                            <i class="fa fa-rss"></i>
		                        			            	</a>
			            </li>
		            
		    	    </ul>
                                    
                                                                    <button type="button" class="search-toggle navbar-toggle collapsed" data-toggle="collapse" data-target="#top_search">
                                        <span class="sr-only">Toggle search form</span>
                                        <i class="fa fa-search-plus"></i>
                                    </button>

                                    <div id="top_search" class="top-search-form">
                                        <form class="searchform" method="get" action="https://adsecurity.org">
	<div class="input-group">
		<div class="form-group live-search-input">
			<label for="s" class="screen-reader-text">Search for:</label>
		    <input type="text" id="s" name="s" class="form-control" placeholder="Search">
		    		</div>
	    <span class="input-group-btn">
	    	<button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button>
	    </span>
    </div>
    </form>                                                                            </div>
                                
                                                            </div>

                        
                                    </div>
            

            <div id="header" class="row">

                <img src="https://adsecurity.org/wp-content/themes/graphene/images/headers/fluid.jpg" alt="Active Directory Security" title="Active Directory Security" width="960" height="198" />                
                                                                </div>


                        <nav class="navbar row navbar-inverse">

                <div class="navbar-header align-center">
                		                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu-wrap, #secondary-menu-wrap">
	                        <span class="sr-only">Toggle navigation</span>
	                        <span class="icon-bar"></span>
	                        <span class="icon-bar"></span>
	                        <span class="icon-bar"></span>
	                    </button>
                	                    
                    
                                            <p class="header_title">
                            <a href="https://adsecurity.org" title="Go back to the front page">                                Active Directory Security                            </a>                        </p>
                    
                                                    <p class="header_desc">Active Directory &amp; Enterprise Security, Methods to Secure Active Directory, Attack Methods &amp; Effective Defenses, PowerShell, Tech Notes, &amp; Geek Trivia&#8230;</p>
                                            
                                    </div>

                                    <div class="collapse navbar-collapse" id="header-menu-wrap">

            			<ul class="nav navbar-nav flip"><li ><a href="https://adsecurity.org/">Home</a></li><li class="menu-item menu-item-8"><a href="https://adsecurity.org/?page_id=8" >About</a></li><li class="menu-item menu-item-41"><a href="https://adsecurity.org/?page_id=41" >AD Resources</a></li><li class="menu-item menu-item-4031"><a href="https://adsecurity.org/?page_id=4031" >Attack Defense &#038; Detection</a></li><li class="menu-item menu-item-293"><a href="https://adsecurity.org/?page_id=293" >Contact</a></li><li class="menu-item menu-item-1821"><a href="https://adsecurity.org/?page_id=1821" >Mimikatz</a></li><li class="menu-item menu-item-1352"><a href="https://adsecurity.org/?page_id=1352" >Presentations</a></li><li class="menu-item menu-item-195"><a href="https://adsecurity.org/?page_id=195" >Schema Versions</a></li><li class="menu-item menu-item-399"><a href="https://adsecurity.org/?page_id=399" >Security Resources</a></li><li class="menu-item menu-item-183"><a href="https://adsecurity.org/?page_id=183" >SPNs</a></li><li class="menu-item menu-item-2532"><a href="https://adsecurity.org/?page_id=2532" >Top Posts</a></li></ul>                        
            			                        
                                            </div>
                
                                    
                            </nav>

            
            <div id="content" class="clearfix hfeed row">
                
                    
                                        
                    <div id="content-main" class="clearfix content-main col-md-8">
                    
	
		<div class="post-nav post-nav-top clearfix">
			<p class="previous col-sm-6"><i class="fa fa-arrow-circle-left"></i> <a href="https://adsecurity.org/?p=2207" rel="prev">Unofficial Guide to Mimikatz &#038; Command Reference</a></p>			<p class="next-post col-sm-6"><a href="https://adsecurity.org/?p=2293" rel="next">Cracking Kerberos TGS Tickets Using Kerberoast &#8211; Exploiting Kerberos to Compromise the Active Directory Domain</a> <i class="fa fa-arrow-circle-right"></i></p>					</div>
		        
<div id="post-2288" class="clearfix post post-2288 type-post status-publish format-standard has-post-thumbnail hentry category-exploit category-microsoft-security category-technical-reference tag-aeskey tag-changelocaladministratorpassword tag-cpassword tag-exploitinggrouppolicypreferences tag-gpp tag-grouppolicypreferences tag-grouppolicypreferencespassword tag-groups-xml tag-kb2962486 tag-laps tag-localadministrator tag-localadministratorpassword tag-ms14-025 tag-ms14025 tag-policymaker tag-scheduledtasks tag-scheduledtasks-xml tag-services-xml tag-sysvol tag-vbs tag-xml item-wrap">
		
	<div class="entry clearfix">
    	
                    	<div class="post-date date alpha with-year">
            <p class="default_date">
            	<span class="month">Dec</span>
                <span class="day">28</span>
                	                <span class="year">2015</span>
                            </p>
                    </div>
            
		        <h1 class="post-title entry-title">
			Finding Passwords in SYSVOL &#038; Exploiting Group Policy Preferences			        </h1>
		
			    <ul class="post-meta entry-meta clearfix">
	    		        <li class="byline">
	        	By <span class="author"><a href="https://adsecurity.org/?author=2" rel="author">Sean Metcalf</a></span><span class="entry-cat"> in <span class="terms"><a class="term term-category term-347" href="https://adsecurity.org/?cat=347">Exploit</a>, <a class="term term-category term-11" href="https://adsecurity.org/?cat=11">Microsoft Security</a>, <a class="term term-category term-2" href="https://adsecurity.org/?cat=2">Technical Reference</a></span></span>	        </li>
	        	    </ul>
    
				
				<div class="entry-content clearfix">
							
										
						<p>At Black Hat and DEF CON this year, I <a href="https://adsecurity.org/?page_id=1352">spoke about ways attackers go from Domain User to Domain Admin</a> in modern enterprises.</p>
<p>Every Windows computer has a built-in Administrator account with an associated password. Changing this password is a security requirement in most organizations, though the method for doing so is not straight-forward. A standard method is to use Group Policy to set the local Administrator password across a large number of workstations. A major issue with this is that all of the computers have the same local Administrator password. Windows is extremely helpful when it comes to local accounts since if two (or more) computers have the same local account name and password, Windows will authenticate the account as if it is local, meaning that by gaining knowledge of the administrator credential on one system, the attacker can gain admin access to all of them (that have the same local administrator credentials).</p>
<p><strong>SYSVOL</strong></p>
<p>One of these methods is mining SYSVOL for credential data.</p>
<p>SYSVOL is the domain-wide share in Active Directory to which all authenticated users have read access. SYSVOL contains logon scripts, group policy data, and other domain-wide data which needs to be available anywhere there is a Domain Controller (since SYSVOL is automatically synchronized and shared among all Domain Controllers).</p>
<p>All domain Group Policies are stored here: \\&lt;DOMAIN&gt;\SYSVOL\&lt;DOMAIN&gt;\Policies\</p>
<p><strong>Credentials in SYSVOL</strong></p>
<p>A big challenge for administrators has been ensuring that the local Administrator account (RID 500) on all Windows computers. The traditional method for doing this (other than buying a product) has been to use a custom script to change the local administrator password. This issue with this is that frequently the password is stored in clear-text within the script (such as a vbs file) which is often in SYSVOL. Here&#8217;s an example of one of the top results when searching for a VBS script that changes the local Administrator password. The vbs script is still available on the Microsoft TechNet gallery and the password is obvious. Remember this script is stored in SYSVOL which every domain user has read access to and the password is the local Administrator password for every computer the Group Policy is applied to.</p>
<p><span id="more-2288"></span></p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/12/VBS-Scripts-In-SYSVOL.jpg" rel="attachment wp-att-2289"><img loading="lazy" class="alignnone wp-image-2289" src="https://adsecurity.org/wp-content/uploads/2015/12/VBS-Scripts-In-SYSVOL.jpg" alt="VBS-Scripts-In-SYSVOL" width="498" height="255" srcset="https://adsecurity.org/wp-content/uploads/2015/12/VBS-Scripts-In-SYSVOL.jpg 904w, https://adsecurity.org/wp-content/uploads/2015/12/VBS-Scripts-In-SYSVOL-300x154.jpg 300w, https://adsecurity.org/wp-content/uploads/2015/12/VBS-Scripts-In-SYSVOL-768x393.jpg 768w" sizes="(max-width: 498px) 100vw, 498px" /></a></p>
<p>Please don&#8217;t use this script to change the local Administrator password.</p>
<p><strong>Group Policy Preferences<br />
</strong></p>
<p>In 2006, Microsoft Bought Desktop Standard’s “PolicyMaker” which they re-branded &amp; released with Windows Server 2008 as &#8220;Group Policy Preferences.&#8221; One of the most useful features of Group Policy Preferences (GPP) is the ability to store and use credentials in several scenarios. These include:</p>
<ul>
<li>Map drives (Drives.xml)</li>
<li>Create Local Users</li>
<li>Data Sources (DataSources.xml)</li>
<li>Printer configuration (Printers.xml)</li>
<li>Create/Update Services (Services.xml)</li>
<li><strong>Scheduled Tasks (ScheduledTasks.xml)<br />
</strong></li>
<li><b>Change </b><b>local </b><b>Administrator passwords</b></li>
</ul>
<p>That&#8217;s very helpful for administrators since it provides an automated mechanism for what previously required a custom solution such as a script. It provides useful capability to leverage Group Policy to “deploy” scheduled tasks with explicit credentials and change the local admin passwords on large numbers of computers at once &#8211; probably the two most popular usage scenario.</p>
<p><strong>Credential Storage in Group Policy Preferences</strong></p>
<p>The question at this point should be: how is the credential data protected?</p>
<p>When a new GPP is created, there&#8217;s an associated XML file created in SYSVOL with the relevant configuration data and if there is a password provided, it is AES-256 bit encrypted which should be good enough&#8230;</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferencesMSDNAESPrivateKey.png" rel="attachment wp-att-2282"><img loading="lazy" class="alignnone size-full wp-image-2282" src="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferencesMSDNAESPrivateKey.png" alt="GroupPolicyPreferencesMSDNAESPrivateKey" width="1049" height="317" srcset="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferencesMSDNAESPrivateKey.png 1049w, https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferencesMSDNAESPrivateKey-300x91.png 300w, https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferencesMSDNAESPrivateKey-768x232.png 768w, https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferencesMSDNAESPrivateKey-1024x309.png 1024w" sizes="(max-width: 1049px) 100vw, 1049px" /></a></p>
<p>Except at some point prior to 2012, <a href="https://msdn.microsoft.com/en-us/library/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be.aspx">Microsoft published the AES private key on MSDN</a> which can be used to decrypt the password. Since authenticated users (any domain user or users in a trusted domain) have read access to SYSVOL, anyone in the domain can search the SYSVOL share for XML files containing &#8220;cpassword&#8221; which is the value that contains the AES encrypted password.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/12/GPP-LocalAdmin-PasswordChange-XML-File-02.png" rel="attachment wp-att-2393"><img loading="lazy" class="alignnone size-full wp-image-2393" src="https://adsecurity.org/wp-content/uploads/2015/12/GPP-LocalAdmin-PasswordChange-XML-File-02.png" alt="GPP-LocalAdmin-PasswordChange-XML-File-02" width="912" height="179" srcset="https://adsecurity.org/wp-content/uploads/2015/12/GPP-LocalAdmin-PasswordChange-XML-File-02.png 912w, https://adsecurity.org/wp-content/uploads/2015/12/GPP-LocalAdmin-PasswordChange-XML-File-02-300x59.png 300w, https://adsecurity.org/wp-content/uploads/2015/12/GPP-LocalAdmin-PasswordChange-XML-File-02-768x151.png 768w" sizes="(max-width: 912px) 100vw, 912px" /></a></p>
<p>&nbsp;</p>
<p><strong>Exploiting Group Policy Preferences</strong></p>
<p>With access to this XML file, the attacker can use the AES private key to decrypt the GPP password. The PowerSploit function <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1">Get-GPPPassword</a> is most useful for Group Policy Preference exploitation. The screenshot here shows a similar PowerShell function encrypting the GPP password from an XML file found in SYSVOL.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferences-Decrypted-Password.png" rel="attachment wp-att-2284"><img loading="lazy" class="alignnone size-full wp-image-2284" src="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferences-Decrypted-Password.png" alt="GroupPolicyPreferences-Decrypted-Password" width="1132" height="41" srcset="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferences-Decrypted-Password.png 1132w, https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferences-Decrypted-Password-300x11.png 300w, https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferences-Decrypted-Password-768x28.png 768w, https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreferences-Decrypted-Password-1024x37.png 1024w" sizes="(max-width: 1132px) 100vw, 1132px" /></a></p>
<p>Oddvar Moe notes a quick way to search for these:</p>
<pre><em>findstr /S /I cpassword \\&lt;FQDN&gt;\sysvol\&lt;FQDN&gt;\policies\*.xml</em></pre>
<p>From what I can find, the issues with GPP credentials was first written about by Emilien Gauralt in the post “<a href="http://esec-pentest.sogeti.com/post/Exploiting-Windows-2008-Group-Policy-Preferences">Exploiting Windows 2008 Group Policy Preferences</a>” in January 2012. Unfortunately the link is dead and the content offline. A few months later in May, Chris Campbell &#8211; wrote the article &#8220;<a href="http://obscuresecurity.blogspot.com/2012/05/gpp-password-retrieval-with-powershell.html">GPP Password Retrieval with PowerShell</a>&#8221; as well as the first PowerShell code to exploit this issue. Chris later updated the PowerShell code and added <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1">Get-GPPPassword</a> to PowerSploit. About a month later, in June, &#8220;Rewt dance&#8221; posted <a href="http://rewtdance.blogspot.com/2012/06/exploiting-windows-2008-">a </a><a href="http://rewtdance.blogspot.com/2012/06/exploiting-windows-2008-">GPP exploitation</a><a href="http://rewtdance.blogspot.com/2012/06/exploiting-windows-2008-"> expanded reference </a>(link offline &#8211; <a href="https://webcache.googleusercontent.com/search?q=cache:MUNO5X9hSwUJ:rewtdance.blogspot.com/2012/06/exploiting-windows-2008-group-policy.html+&amp;cd=6&amp;hl=en&amp;ct=clnk&amp;gl=us">google cached version</a>). I also recently discovered Alexandre Herzog&#8217;s post &#8220;<a href="http://blog.csnc.ch/2012/04/exploit-credentials-stored-in-windows-group-policy-preferences/">Exploit credentials stored in Windows Group Policy Preferences</a>&#8221; (dated April 2012).</p>
<p>I have written about the <a href="https://adsecurity.org/?p=384">problems with credentials in Group Policy Preferences</a> and the <a href="https://adsecurity.org/?p=63">GPP patch (KB2962486)</a>.</p>
<p><em><strong>I continue to find administrative credentials (including Domain Admin credentials) in Group Policy Preference XML files in SYSVOL, especially for scheduled tasks running under the context of admin accounts.<br />
</strong></em></p>
<p>&nbsp;</p>
<p><strong>The Group Policy Preference Credential Patch (KB2962486)</strong></p>
<p>The obvious question for defenders is how to protect against this?</p>
<p>Microsoft released a patch in May 13, 2014 : &#8220;<a href="https://support.microsoft.com/en-us/kb/2962486">MS14-025 Vulnerability in GPP could allow elevation of privilege&#8221; (KB2962486)</a>. This patch needs to be installed on all systems that administer Group Policy using the Remote Server Administration Tools (RSAT). This patch prevents admins from putting password data into a Group Policy Preference.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreference-Patch1.png" rel="attachment wp-att-2285"><img loading="lazy" class="alignnone wp-image-2285" src="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreference-Patch1.png" alt="GroupPolicyPreference-Patch1" width="313" height="350" srcset="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreference-Patch1.png 413w, https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreference-Patch1-268x300.png 268w" sizes="(max-width: 313px) 100vw, 313px" /></a> <a href="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreference-Patch2.png" rel="attachment wp-att-2286"><img loading="lazy" class="alignnone wp-image-2286" src="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreference-Patch2.png" alt="GroupPolicyPreference-Patch2" width="349" height="143" srcset="https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreference-Patch2.png 493w, https://adsecurity.org/wp-content/uploads/2015/12/GroupPolicyPreference-Patch2-300x123.png 300w" sizes="(max-width: 349px) 100vw, 349px" /></a></p>
<p><strong><em>Note that existing Group Policy Preference files with passwords are not removed from SYSVOL</em></strong></p>
<p>Microsoft provides a sample PowerShell script for finding GPP passwords in SYSVOL:<br />
<a href="https://support.microsoft.com/en-us/help/2962486/ms14-025-vulnerability-in-group-policy-preferences-could-allow-elevation-of-privilege-may-13,-2014">https://support.microsoft.com/en-us/help/2962486/ms14-025-vulnerability-in-group-policy-preferences-could-allow-elevation-of-privilege-may-13,-2014</a></p>
<p><strong>Group Policy Preference Exploitation Detection:</strong></p>
<p>XML Permission Denied Checks</p>
<ul>
<li>Place a new xml file in SYSVOL &amp; set Everyone:Deny.</li>
<li>Audit Access Denied errors.</li>
<li>Sing the associated GPO doesn’t exist, there&#8217;s no legitimate reason for access.</li>
</ul>
<p>&nbsp;</p>
<p><strong>Group Policy Preference Exploitation Mitigation</strong>:</p>
<ul>
<li>Install KB2962486 on every computer used to manage GPOs which prevents new credentials from being placed in Group Policy Preferences.</li>
<li>Delete existing GPP xml files in SYSVOL containing passwords.</li>
</ul>
<p>&nbsp;</p>
<p><strong>Microsoft Local Administrator Password Solution (LAPS)</strong></p>
<p>The best Microsoft provided method for changing local Administrator passwords is the <a href="https://adsecurity.org/?p=1790">&#8220;Local Administrator Password Solution&#8221; aka LAPS</a>.</p>
<p>&nbsp;</p>
<p><strong>References:</strong></p>
<ul>
<li><a href="https://adsecurity.org/?page_id=1352">Sean&#8217;s presentation slides &amp; videos on Active Directory security</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be.aspx">Group Policy Preferences AES private key on MSDN</a></li>
<li><a href="https://adsecurity.org/?p=384">Using Group Policy Preferences for Password Management = Bad Idea </a></li>
<li><a href="http://obscuresecurity.blogspot.com/2012/05/gpp-password-retrieval-with-powershell.html">GPP Password Retrieval with PowerShell</a></li>
<li>The PowerSploit function <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1">Get-GPPPassword</a></li>
<li><a href="https://adsecurity.org/?p=63">Group Policy Preferences Password Vulnerability Now Patched </a></li>
<li><a href="https://adsecurity.org/?p=1790">Microsoft Local Administrator Password Solution (LAPS)</a></li>
</ul>
<p>&nbsp;</p>
<div class="tptn_counter" id="tptn_counter_2288">(Visited 141,956 times, 49 visits today)</div>								</div>
		
			    <ul class="entry-footer">
	    		        <li class="post-tags col-sm-8"><i class="fa fa-tags" title="Tags"></i> <span class="terms"><a class="term term-tagpost_tag term-767" href="https://adsecurity.org/?tag=aeskey">AESkey</a>, <a class="term term-tagpost_tag term-731" href="https://adsecurity.org/?tag=changelocaladministratorpassword">ChangeLocalAdministratorPassword</a>, <a class="term term-tagpost_tag term-747" href="https://adsecurity.org/?tag=cpassword">cpassword</a>, <a class="term term-tagpost_tag term-725" href="https://adsecurity.org/?tag=exploitinggrouppolicypreferences">ExploitingGroupPolicyPreferences</a>, <a class="term term-tagpost_tag term-12" href="https://adsecurity.org/?tag=gpp">GPP</a>, <a class="term term-tagpost_tag term-742" href="https://adsecurity.org/?tag=grouppolicypreferences">GroupPolicyPreferences</a>, <a class="term term-tagpost_tag term-191" href="https://adsecurity.org/?tag=grouppolicypreferencespassword">GroupPolicyPreferencesPassword</a>, <a class="term term-tagpost_tag term-748" href="https://adsecurity.org/?tag=groups-xml">groups.xml</a>, <a class="term term-tagpost_tag term-726" href="https://adsecurity.org/?tag=kb2962486">KB2962486</a>, <a class="term term-tagpost_tag term-631" href="https://adsecurity.org/?tag=laps">LAPS</a>, <a class="term term-tagpost_tag term-769" href="https://adsecurity.org/?tag=localadministrator">LocalAdministrator</a>, <a class="term term-tagpost_tag term-768" href="https://adsecurity.org/?tag=localadministratorpassword">LocalAdministratorPassword</a>, <a class="term term-tagpost_tag term-323" href="https://adsecurity.org/?tag=ms14-025">MS14-025</a>, <a class="term term-tagpost_tag term-324" href="https://adsecurity.org/?tag=ms14025">MS14025</a>, <a class="term term-tagpost_tag term-729" href="https://adsecurity.org/?tag=policymaker">PolicyMaker</a>, <a class="term term-tagpost_tag term-730" href="https://adsecurity.org/?tag=scheduledtasks">ScheduledTasks</a>, <a class="term term-tagpost_tag term-749" href="https://adsecurity.org/?tag=scheduledtasks-xml">scheduledtasks.xml</a>, <a class="term term-tagpost_tag term-750" href="https://adsecurity.org/?tag=services-xml">Services.xml</a>, <a class="term term-tagpost_tag term-621" href="https://adsecurity.org/?tag=sysvol">SYSVOL</a>, <a class="term term-tagpost_tag term-727" href="https://adsecurity.org/?tag=vbs">vbs</a>, <a class="term term-tagpost_tag term-728" href="https://adsecurity.org/?tag=xml">xml</a></span></li>
	        	        <li class="addthis col-sm-8"><div class="add-this"></div></li>
	        	    </ul>
    	</div>

</div>

    <div class="entry-author">
        <div class="row">
            <div class="author-avatar col-sm-3">
            	<a href="https://adsecurity.org/?author=2" rel="author">
					<img alt='' src='https://secure.gravatar.com/avatar/1f3ad5e878e5d0e6096c5a33718a04d0?s=200&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f3ad5e878e5d0e6096c5a33718a04d0?s=400&#038;d=mm&#038;r=g 2x' class='avatar avatar-200 photo' height='200' width='200' loading='lazy'/>                </a>
            </div>

            <div class="author-bio col-sm-9">
                <h3 class="section-title-sm">Sean Metcalf</h3>
                <p>I improve security for enterprises around the world working for TrimarcSecurity.com<br />
Read the About page (top left) for information about me. :)<br />
https://adsecurity.org/?page_id=8</p>
    <ul class="author-social">
    	        
			        <li><a href="mailto:sean@adsecurity.org"><i class="fa fa-envelope-o"></i></a></li>
            </ul>
                </div>
        </div>
    </div>
    









<div id="comments" class="clearfix no-ping">
        	<h4 class="comments current">
            <i class="fa fa-comments-o"></i> 4 comments        </h4>
	        
        	<p class="comment-form-jump"><a href="#respond" class="btn btn-sm">Skip to comment form <i class="fa fa-arrow-circle-down"></i></a></p>
	
	
	    <div class="comments-list-wrapper">
        <ol class="clearfix comments-list" id="comments_list">
            		<li id="comment-9818" class="comment even thread-even depth-1 comment">
			<div class="row">
								
											
				<div class="comment-wrap col-md-12">
					
                        <ul class="comment-meta">
                <li class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/aa39b050ddbd44c8b4e27b94492c9677?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/aa39b050ddbd44c8b4e27b94492c9677?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></li>
                <li class="comment-attr"><span class="comment-author">Juggernats</span> on <span class="comment-date">January 4, 2016 <span class="time">at 3:45 pm</span></span></li>
                <li class="single-comment-link"><a href="https://adsecurity.org/?p=2288#comment-9818">#</a></li>
            </ul>
    
					<div class="comment-entry">
												
													<p>How would one decrypt the cpassword string using the MS AES key?</p>
												
											</div>
				</div>
			
							</div>
	<ol class="children">
		<li id="comment-9821" class="comment byuser comment-author-seanmetcalf bypostauthor odd alt depth-2 comment">
			<div class="row">
								
											
				<div class="comment-wrap col-md-12">
					
                        <ul class="comment-meta">
                <li class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/843fd885d49f892c4bc60ed0f9eef40b?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/843fd885d49f892c4bc60ed0f9eef40b?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></li>
                <li class="comment-attr"><span class="comment-author"><a href='https://ADSecurity.org' rel='external'>Sean Metcalf</a></span> on <span class="comment-date">January 4, 2016 <span class="time">at 4:47 pm</span></span><br /><span class="label label-primary author-cred">Author</span></li>
                <li class="single-comment-link"><a href="https://adsecurity.org/?p=2288#comment-9821">#</a></li>
            </ul>
    
					<div class="comment-entry">
												
													<p>Using the PowerShell function Get-GPPPassword in PowerSploit which I link to.<br />
Here&#8217;s the relevant code from <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1" rel="nofollow ugc">https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1</a></p>
<p>Set the $cpassword variable to the cpassword field value.</p>
<blockquote><p>
 #Append appropriate padding based on string length<br />
            $Mod = ($Cpassword.length % 4)</p>
<p>            switch ($Mod) {<br />
            &#8216;1&#8217; {$Cpassword = $Cpassword.Substring(0,$Cpassword.Length -1)}<br />
            &#8216;2&#8217; {$Cpassword += (&#8216;=&#8217; * (4 &#8211; $Mod))}<br />
            &#8216;3&#8217; {$Cpassword += (&#8216;=&#8217; * (4 &#8211; $Mod))}<br />
            }</p>
<p>            $Base64Decoded = [Convert]::FromBase64String($Cpassword)</p>
<p>            #Create a new AES .NET Crypto Object<br />
            $AesObject = New-Object System.Security.Cryptography.AesCryptoServiceProvider<br />
            [Byte[]] $AesKey = @(0x4e,0x99,0x06,0xe8,0xfc,0xb6,0x6c,0xc9,0xfa,0xf4,0x93,0x10,0x62,0x0f,0xfe,0xe8,<br />
                                 0xf4,0x96,0xe8,0x06,0xcc,0x05,0x79,0x90,0x20,0x9b,0x09,0xa4,0x33,0xb6,0x6c,0x1b)</p>
<p>            #Set IV to all nulls to prevent dynamic generation of IV value<br />
            $AesIV = New-Object Byte[]($AesObject.IV.Length)<br />
            $AesObject.IV = $AesIV<br />
            $AesObject.Key = $AesKey<br />
            $DecryptorObject = $AesObject.CreateDecryptor()<br />
            [Byte[]] $OutBlock = $DecryptorObject.TransformFinalBlock($Base64Decoded, 0, $Base64Decoded.length)</p>
<p>            return [System.Text.UnicodeEncoding]::Unicode.GetString($OutBlock)
</p></blockquote>
												
											</div>
				</div>
			
							</div>
	<ol class="children">
		<li id="comment-9824" class="comment even depth-3 comment">
			<div class="row">
								
											
				<div class="comment-wrap col-md-12">
					
                        <ul class="comment-meta">
                <li class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/aa39b050ddbd44c8b4e27b94492c9677?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/aa39b050ddbd44c8b4e27b94492c9677?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></li>
                <li class="comment-attr"><span class="comment-author">Juggernats</span> on <span class="comment-date">January 5, 2016 <span class="time">at 10:18 am</span></span></li>
                <li class="single-comment-link"><a href="https://adsecurity.org/?p=2288#comment-9824">#</a></li>
            </ul>
    
					<div class="comment-entry">
												
													<p>Does the Get-GPPPassword function need to be run on the same domain?  Our users are prevented from editing the Modules available in PowerShell so PowerSploit is not usable.  If the policies were copied outside of the VM to a local machine able to run PowerSploit, would the Get-GPPPassword function work?</p>
												
											</div>
				</div>
			
							</div>
	<ol class="children">
		<li id="comment-9826" class="comment byuser comment-author-seanmetcalf bypostauthor odd alt depth-4 comment">
			<div class="row">
								
											
				<div class="comment-wrap col-md-12">
					
                        <ul class="comment-meta">
                <li class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/843fd885d49f892c4bc60ed0f9eef40b?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/843fd885d49f892c4bc60ed0f9eef40b?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></li>
                <li class="comment-attr"><span class="comment-author"><a href='https://ADSecurity.org' rel='external'>Sean Metcalf</a></span> on <span class="comment-date">January 5, 2016 <span class="time">at 8:06 pm</span></span><br /><span class="label label-primary author-cred">Author</span></li>
                <li class="single-comment-link"><a href="https://adsecurity.org/?p=2288#comment-9826">#</a></li>
            </ul>
    
					<div class="comment-entry">
												
													<p>It can be run against any trusted domain. The key point is that no &#8220;hacking tool&#8221; is required. Open Windows explorer and open the Policies folder in SYSVOL and search for *.xml. Open up the results with the names I listed in the post (groups.xml, scheduledtasks.xml, etc), and copy the cpassword value. This can be uploaded to the internet somewhere, emailed, etc. Then the PowerShell function I pasted in an earlier comment can be run anywhere. Furthermore, that PowerShell function will decrypt the cpassword attribute without loading any modules so it can be used anywhere.</p>
												
											</div>
				</div>
			
							</div>
	</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
        </ol>
       	
            </div>
        
        
    </div>


	<div id="respond">
		<h3 id="reply-title"><i class="fa fa-comment-o"></i> Comments have been disabled.</h3>
            </div>



            
  

                </div><!-- #content-main -->
        
            
<div id="sidebar1" class="sidebar sidebar-right widget-area col-md-4">

	
    
		<div id="recent-posts-4" class="sidebar-wrap widget_recent_entries">
		<h3>Recent Posts</h3>
		<ul>
											<li>
					<a href="https://adsecurity.org/?p=4367">Attacking Active Directory Group Managed Service Accounts (GMSAs)</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4277">From Azure AD to Active Directory (via Azure) &#8211; An Unanticipated Attack Path</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4211">What is Azure Active Directory?</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4179">Slides Posted for Black Hat USA 2019 Talk: Attacking &#038; Defending the Microsoft Cloud</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4187">AD Reading: Windows Server 2019 Active Directory Features</a>
									</li>
					</ul>

		</div><div id="text-3" class="sidebar-wrap widget_text"><h3>Trimarc Active Directory Security Services</h3>			<div class="textwidget">Have concerns about your Active Directory environment?

Trimarc helps enterprises improve their security posture. <p>
<a href="http://trimarcsecurity.com/security-services">Find out how...</a> 
TrimarcSecurity.com</div>
		</div><div id="widget_tptn_pop-4" class="sidebar-wrap tptn_posts_list_widget"><h3>Popular Posts</h3><div class="tptn_posts  tptn_posts_widget tptn_posts_widget4"><ul><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2362"     class="tptn_link"><span class="tptn_title">Attack Methods for Gaining Domain Admin Rights in&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=478"     class="tptn_link"><span class="tptn_title">PowerShell Encoding &#038; Decoding (Base64)</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=483"     class="tptn_link"><span class="tptn_title">Kerberos &#038; KRBTGT: Active Directory&#8217;s&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=3377"     class="tptn_link"><span class="tptn_title">Securing Domain Controllers to Improve Active&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2288"     class="tptn_link"><span class="tptn_title">Finding Passwords in SYSVOL &#038; Exploiting Group&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=3299"     class="tptn_link"><span class="tptn_title">Securing Windows Workstations: Developing a Secure Baseline</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1684"     class="tptn_link"><span class="tptn_title">The Most Common Active Directory Security Issues and&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2653"     class="tptn_link"><span class="tptn_title">Building an Effective Active Directory Lab&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1729"     class="tptn_link"><span class="tptn_title">Mimikatz DCSync Usage, Exploitation, and Detection</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1790"     class="tptn_link"><span class="tptn_title">Microsoft Local Administrator Password Solution (LAPS)</span></a></span></li></ul><div class="tptn_clear"></div></div></div><div id="categories-4" class="sidebar-wrap widget_categories"><h3>Categories</h3>
			<ul>
					<li class="cat-item cat-item-565"><a href="https://adsecurity.org/?cat=565">ActiveDirectorySecurity</a>
</li>
	<li class="cat-item cat-item-55"><a href="https://adsecurity.org/?cat=55">Apple Security</a>
</li>
	<li class="cat-item cat-item-431"><a href="https://adsecurity.org/?cat=431">Cloud Security</a>
</li>
	<li class="cat-item cat-item-17"><a href="https://adsecurity.org/?cat=17">Continuing Education</a>
</li>
	<li class="cat-item cat-item-396"><a href="https://adsecurity.org/?cat=396">Entertainment</a>
</li>
	<li class="cat-item cat-item-347"><a href="https://adsecurity.org/?cat=347">Exploit</a>
</li>
	<li class="cat-item cat-item-1039"><a href="https://adsecurity.org/?cat=1039">Hacking</a>
</li>
	<li class="cat-item cat-item-168"><a href="https://adsecurity.org/?cat=168">Hardware Security</a>
</li>
	<li class="cat-item cat-item-172"><a href="https://adsecurity.org/?cat=172">Hypervisor Security</a>
</li>
	<li class="cat-item cat-item-126"><a href="https://adsecurity.org/?cat=126">Linux/Unix Security</a>
</li>
	<li class="cat-item cat-item-343"><a href="https://adsecurity.org/?cat=343">Malware</a>
</li>
	<li class="cat-item cat-item-11"><a href="https://adsecurity.org/?cat=11">Microsoft Security</a>
</li>
	<li class="cat-item cat-item-819"><a href="https://adsecurity.org/?cat=819">Mitigation</a>
</li>
	<li class="cat-item cat-item-48"><a href="https://adsecurity.org/?cat=48">Network/System Security</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://adsecurity.org/?cat=7">PowerShell</a>
</li>
	<li class="cat-item cat-item-698"><a href="https://adsecurity.org/?cat=698">RealWorld</a>
</li>
	<li class="cat-item cat-item-21"><a href="https://adsecurity.org/?cat=21">Security</a>
</li>
	<li class="cat-item cat-item-234"><a href="https://adsecurity.org/?cat=234">Security Conference Presentation/Video</a>
</li>
	<li class="cat-item cat-item-1045"><a href="https://adsecurity.org/?cat=1045">Security Recommendation</a>
</li>
	<li class="cat-item cat-item-24"><a href="https://adsecurity.org/?cat=24">Technical Article</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://adsecurity.org/?cat=4">Technical Reading</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://adsecurity.org/?cat=2">Technical Reference</a>
</li>
	<li class="cat-item cat-item-156"><a href="https://adsecurity.org/?cat=156">TheCloud</a>
</li>
	<li class="cat-item cat-item-930"><a href="https://adsecurity.org/?cat=930">Vulnerability</a>
</li>
			</ul>

			</div><div id="tag_cloud-3" class="sidebar-wrap widget_tag_cloud"><h3>Tags</h3><div class="tagcloud"><a href="https://adsecurity.org/?tag=activedirectory" class="tag-cloud-link tag-link-20 tag-link-position-1" style="font-size: 22pt;" aria-label="ActiveDirectory (52 items)">ActiveDirectory</a>
<a href="https://adsecurity.org/?tag=active-directory" class="tag-cloud-link tag-link-75 tag-link-position-2" style="font-size: 10.531914893617pt;" aria-label="Active Directory (8 items)">Active Directory</a>
<a href="https://adsecurity.org/?tag=activedirectoryattack" class="tag-cloud-link tag-link-537 tag-link-position-3" style="font-size: 8pt;" aria-label="ActiveDirectoryAttack (5 items)">ActiveDirectoryAttack</a>
<a href="https://adsecurity.org/?tag=activedirectorysecurity" class="tag-cloud-link tag-link-113 tag-link-position-4" style="font-size: 13.957446808511pt;" aria-label="ActiveDirectorySecurity (14 items)">ActiveDirectorySecurity</a>
<a href="https://adsecurity.org/?tag=active-directory-security" class="tag-cloud-link tag-link-976 tag-link-position-5" style="font-size: 9.7872340425532pt;" aria-label="Active Directory Security (7 items)">Active Directory Security</a>
<a href="https://adsecurity.org/?tag=adreading" class="tag-cloud-link tag-link-5 tag-link-position-6" style="font-size: 13.510638297872pt;" aria-label="ADReading (13 items)">ADReading</a>
<a href="https://adsecurity.org/?tag=adsecurity" class="tag-cloud-link tag-link-86 tag-link-position-7" style="font-size: 10.531914893617pt;" aria-label="ADSecurity (8 items)">ADSecurity</a>
<a href="https://adsecurity.org/?tag=ad-security" class="tag-cloud-link tag-link-100 tag-link-position-8" style="font-size: 8pt;" aria-label="AD Security (5 items)">AD Security</a>
<a href="https://adsecurity.org/?tag=dcsync" class="tag-cloud-link tag-link-598 tag-link-position-9" style="font-size: 10.531914893617pt;" aria-label="DCSync (8 items)">DCSync</a>
<a href="https://adsecurity.org/?tag=defcon" class="tag-cloud-link tag-link-518 tag-link-position-10" style="font-size: 8pt;" aria-label="DEFCON (5 items)">DEFCON</a>
<a href="https://adsecurity.org/?tag=domaincontroller" class="tag-cloud-link tag-link-101 tag-link-position-11" style="font-size: 15.446808510638pt;" aria-label="DomainController (18 items)">DomainController</a>
<a href="https://adsecurity.org/?tag=emet5" class="tag-cloud-link tag-link-338 tag-link-position-12" style="font-size: 8pt;" aria-label="EMET5 (5 items)">EMET5</a>
<a href="https://adsecurity.org/?tag=goldenticket" class="tag-cloud-link tag-link-303 tag-link-position-13" style="font-size: 11.276595744681pt;" aria-label="GoldenTicket (9 items)">GoldenTicket</a>
<a href="https://adsecurity.org/?tag=hyperv" class="tag-cloud-link tag-link-3 tag-link-position-14" style="font-size: 8pt;" aria-label="HyperV (5 items)">HyperV</a>
<a href="https://adsecurity.org/?tag=invoke-mimikatz" class="tag-cloud-link tag-link-336 tag-link-position-15" style="font-size: 10.531914893617pt;" aria-label="Invoke-Mimikatz (8 items)">Invoke-Mimikatz</a>
<a href="https://adsecurity.org/?tag=kb3011780" class="tag-cloud-link tag-link-337 tag-link-position-16" style="font-size: 9.7872340425532pt;" aria-label="KB3011780 (7 items)">KB3011780</a>
<a href="https://adsecurity.org/?tag=kdc" class="tag-cloud-link tag-link-80 tag-link-position-17" style="font-size: 8pt;" aria-label="KDC (5 items)">KDC</a>
<a href="https://adsecurity.org/?tag=kerberos" class="tag-cloud-link tag-link-81 tag-link-position-18" style="font-size: 15.446808510638pt;" aria-label="Kerberos (18 items)">Kerberos</a>
<a href="https://adsecurity.org/?tag=kerberoshacking" class="tag-cloud-link tag-link-298 tag-link-position-19" style="font-size: 11.872340425532pt;" aria-label="KerberosHacking (10 items)">KerberosHacking</a>
<a href="https://adsecurity.org/?tag=krbtgt" class="tag-cloud-link tag-link-394 tag-link-position-20" style="font-size: 9.7872340425532pt;" aria-label="KRBTGT (7 items)">KRBTGT</a>
<a href="https://adsecurity.org/?tag=laps" class="tag-cloud-link tag-link-631 tag-link-position-21" style="font-size: 9.0425531914894pt;" aria-label="LAPS (6 items)">LAPS</a>
<a href="https://adsecurity.org/?tag=lsass" class="tag-cloud-link tag-link-71 tag-link-position-22" style="font-size: 11.276595744681pt;" aria-label="LSASS (9 items)">LSASS</a>
<a href="https://adsecurity.org/?tag=mcm" class="tag-cloud-link tag-link-6 tag-link-position-23" style="font-size: 14.255319148936pt;" aria-label="MCM (15 items)">MCM</a>
<a href="https://adsecurity.org/?tag=microsoftemet" class="tag-cloud-link tag-link-58 tag-link-position-24" style="font-size: 11.276595744681pt;" aria-label="MicrosoftEMET (9 items)">MicrosoftEMET</a>
<a href="https://adsecurity.org/?tag=microsoftwindows" class="tag-cloud-link tag-link-102 tag-link-position-25" style="font-size: 9.7872340425532pt;" aria-label="MicrosoftWindows (7 items)">MicrosoftWindows</a>
<a href="https://adsecurity.org/?tag=mimikatz" class="tag-cloud-link tag-link-207 tag-link-position-26" style="font-size: 18.425531914894pt;" aria-label="mimikatz (29 items)">mimikatz</a>
<a href="https://adsecurity.org/?tag=ms14068" class="tag-cloud-link tag-link-295 tag-link-position-27" style="font-size: 11.276595744681pt;" aria-label="MS14068 (9 items)">MS14068</a>
<a href="https://adsecurity.org/?tag=passthehash" class="tag-cloud-link tag-link-44 tag-link-position-28" style="font-size: 9.7872340425532pt;" aria-label="PassTheHash (7 items)">PassTheHash</a>
<a href="https://adsecurity.org/?tag=powershell" class="tag-cloud-link tag-link-575 tag-link-position-29" style="font-size: 18.872340425532pt;" aria-label="PowerShell (31 items)">PowerShell</a>
<a href="https://adsecurity.org/?tag=powershellcode" class="tag-cloud-link tag-link-22 tag-link-position-30" style="font-size: 15.148936170213pt;" aria-label="PowerShellCode (17 items)">PowerShellCode</a>
<a href="https://adsecurity.org/?tag=powershellhacking" class="tag-cloud-link tag-link-68 tag-link-position-31" style="font-size: 8pt;" aria-label="PowerShellHacking (5 items)">PowerShellHacking</a>
<a href="https://adsecurity.org/?tag=powershellv5" class="tag-cloud-link tag-link-69 tag-link-position-32" style="font-size: 8pt;" aria-label="PowerShellv5 (5 items)">PowerShellv5</a>
<a href="https://adsecurity.org/?tag=powersploit" class="tag-cloud-link tag-link-232 tag-link-position-33" style="font-size: 10.531914893617pt;" aria-label="PowerSploit (8 items)">PowerSploit</a>
<a href="https://adsecurity.org/?tag=presentation" class="tag-cloud-link tag-link-422 tag-link-position-34" style="font-size: 9.7872340425532pt;" aria-label="Presentation (7 items)">Presentation</a>
<a href="https://adsecurity.org/?tag=security" class="tag-cloud-link tag-link-576 tag-link-position-35" style="font-size: 8pt;" aria-label="Security (5 items)">Security</a>
<a href="https://adsecurity.org/?tag=sidhistory" class="tag-cloud-link tag-link-547 tag-link-position-36" style="font-size: 8pt;" aria-label="SIDHistory (5 items)">SIDHistory</a>
<a href="https://adsecurity.org/?tag=silverticket" class="tag-cloud-link tag-link-304 tag-link-position-37" style="font-size: 11.276595744681pt;" aria-label="SilverTicket (9 items)">SilverTicket</a>
<a href="https://adsecurity.org/?tag=sneakyadpersistence" class="tag-cloud-link tag-link-596 tag-link-position-38" style="font-size: 9.0425531914894pt;" aria-label="SneakyADPersistence (6 items)">SneakyADPersistence</a>
<a href="https://adsecurity.org/?tag=spn" class="tag-cloud-link tag-link-294 tag-link-position-39" style="font-size: 9.0425531914894pt;" aria-label="SPN (6 items)">SPN</a>
<a href="https://adsecurity.org/?tag=tgs" class="tag-cloud-link tag-link-528 tag-link-position-40" style="font-size: 9.0425531914894pt;" aria-label="TGS (6 items)">TGS</a>
<a href="https://adsecurity.org/?tag=tgt" class="tag-cloud-link tag-link-529 tag-link-position-41" style="font-size: 9.0425531914894pt;" aria-label="TGT (6 items)">TGT</a>
<a href="https://adsecurity.org/?tag=windows10" class="tag-cloud-link tag-link-494 tag-link-position-42" style="font-size: 10.531914893617pt;" aria-label="Windows10 (8 items)">Windows10</a>
<a href="https://adsecurity.org/?tag=windowsserver2008r2" class="tag-cloud-link tag-link-46 tag-link-position-43" style="font-size: 9.0425531914894pt;" aria-label="WindowsServer2008R2 (6 items)">WindowsServer2008R2</a>
<a href="https://adsecurity.org/?tag=windowsserver2012" class="tag-cloud-link tag-link-47 tag-link-position-44" style="font-size: 11.276595744681pt;" aria-label="WindowsServer2012 (9 items)">WindowsServer2012</a>
<a href="https://adsecurity.org/?tag=windowsserver2012r2" class="tag-cloud-link tag-link-54 tag-link-position-45" style="font-size: 9.7872340425532pt;" aria-label="WindowsServer2012R2 (7 items)">WindowsServer2012R2</a></div>
</div>    
        
    
</div><!-- #sidebar1 -->        
        
    </div><!-- #content -->


    
        
    <div id="sidebar_bottom" class="sidebar widget-area row footer-widget-col-3">
                    <div id="text-2" class="sidebar-wrap widget_text col-sm-4"><h3>Copyright</h3>			<div class="textwidget">Content Disclaimer: This blog and its contents are provided "AS IS" with no warranties, and they confer no rights. Script samples are provided for informational purposes only and no guarantee is provided as to functionality or suitability.
The views shared on this blog reflect those of the authors and do not represent the views of any companies mentioned.

Content Ownership: All content posted here is intellectual work and under the current law, the poster owns the copyright of the article. Terms of Use Copyright © 2011 - 2020.</div>
		</div>		
            </div>

	

<div id="footer" class="row default-footer">
    
        
            
            <div class="copyright-developer">
                                    <div id="copyright">
                        <p>Content Disclaimer: This blog and its contents are provided "AS IS" with no warranties, and they confer no rights. Script samples are provided for informational purposes only and no guarantee is provided as to functionality or suitability. The views shared on this blog reflect those of the authors and do not represent the views of any companies mentioned. </p>
                    </div>
                
                                    <div id="developer">
                        <p>
                                                        Made with <i class="fa fa-heart"></i> by <a href="https://www.graphene-theme.com/" rel="nofollow">Graphene Themes</a>.                        </p>

                                            </div>
                            </div>

        
                
    </div><!-- #footer -->


</div><!-- #container -->

		<!-- Start of StatCounter Code -->
		<script>
			<!--
			var sc_project=10100711;
			var sc_security="4b306538";
			      var sc_invisible=1;
			var scJsHost = (("https:" == document.location.protocol) ?
				"https://secure." : "http://www.");
			//-->
					</script>
		
<script type="text/javascript"
				src="https://secure.statcounter.com/counter/counter.js"
				async></script>		<noscript><div class="statcounter"><a title="web analytics" href="https://statcounter.com/"><img class="statcounter" src="https://c.statcounter.com/10100711/0/4b306538/1/" alt="web analytics" /></a></div></noscript>
		<!-- End of StatCounter Code -->
				<a href="#" id="back-to-top" title="Back to top"><i class="fa fa-chevron-up"></i></a>
	<script type='text/javascript' id='tptn_tracker-js-extra'>
/* <![CDATA[ */
var ajax_tptn_tracker = {"ajax_url":"https:\/\/adsecurity.org\/wp-admin\/admin-ajax.php","top_ten_id":"2288","top_ten_blog_id":"1","activate_counter":"11","top_ten_debug":"0","tptn_rnd":"916709153"};
/* ]]> */
</script>
<script type='text/javascript' src='https://adsecurity.org/wp-content/plugins/top-10/includes/js/top-10-tracker.min.js?ver=1.0' id='tptn_tracker-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-includes/js/comment-reply.min.js?ver=5.7.2' id='comment-reply-js'></script>
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/wp-embed.min.js?ver=5.7.2' id='wp-embed-js'></script>
</body>
</html>