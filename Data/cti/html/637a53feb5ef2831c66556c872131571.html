<!doctype html><html lang="en"><head><script defer src="https://cdn.optimizely.com/js/16180790160.js"></script><title data-rh="true">Detecting &amp; Removing an Attacker’s WMI Persistence | by David French | Threat Punter | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2018-10-09T21:02:57.646Z"/><meta data-rh="true" name="title" content="Detecting &amp; Removing an Attacker’s WMI Persistence | by David French | Threat Punter | Medium"/><meta data-rh="true" property="og:title" content="Detecting &amp; Removing WMI Persistence"/><meta data-rh="true" property="twitter:title" content="Detecting &amp; Removing WMI Persistence"/><meta data-rh="true" name="twitter:site" content="@threatpunter"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/60ccbb7dff96"/><meta data-rh="true" property="al:android:url" content="medium://p/60ccbb7dff96"/><meta data-rh="true" property="al:ios:url" content="medium://p/60ccbb7dff96"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Windows Management Instrumentation (WMI) Event Subscription is a popular technique to establish persistence on an endpoint. I decided to spend some time playing with Empire’s WMI modules and…"/><meta data-rh="true" property="og:description" content="Windows Management Instrumentation (WMI) Event Subscription is a popular technique to establish persistence on an endpoint. I decided to…"/><meta data-rh="true" property="twitter:description" content="Windows Management Instrumentation (WMI) Event Subscription is a popular technique to establish persistence on an endpoint. I decided to…"/><meta data-rh="true" property="og:url" content="https://medium.com/threatpunter/detecting-removing-wmi-persistence-60ccbb7dff96"/><meta data-rh="true" property="al:web:url" content="https://medium.com/threatpunter/detecting-removing-wmi-persistence-60ccbb7dff96"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/0*Qxa02RcVVLc4L79Q"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/0*Qxa02RcVVLc4L79Q"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@threatpunter"/><meta data-rh="true" name="twitter:creator" content="@threatpunter"/><meta data-rh="true" name="author" content="David French"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="4 min read"/><meta data-rh="true" name="parsely-post-id" content="60ccbb7dff96"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" rel="preconnect" href="https://logx.optimizely.com"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@threatpunter"/><link data-rh="true" rel="canonical" href="https://medium.com/threatpunter/detecting-removing-wmi-persistence-60ccbb7dff96"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/60ccbb7dff96"/><link data-rh="true" rel="icon" href="https://miro.medium.com/1*m-R_BkNf1Qjr1YbyOIJY2w.png"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F0*Qxa02RcVVLc4L79Q"],"url":"https:\u002F\u002Fmedium.com\u002Fthreatpunter\u002Fdetecting-removing-wmi-persistence-60ccbb7dff96","dateCreated":"2018-10-09T12:04:14.384Z","datePublished":"2018-10-09T12:04:14.384Z","dateModified":"2018-10-09T21:02:57.646Z","headline":"Detecting & Removing an Attacker’s WMI Persistence - Threat Punter - Medium","name":"Detecting & Removing an Attacker’s WMI Persistence - Threat Punter - Medium","description":"Windows Management Instrumentation (WMI) Event Subscription is a popular technique to establish persistence on an endpoint. I decided to spend some time playing with Empire’s WMI modules and…","identifier":"60ccbb7dff96","keywords":["Lite:true","Tag:Threat Hunting","Tag:Threat Detection","Tag:Cybersecurity","Tag:Persistence","Publication:threatpunter","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:0"],"author":{"@type":"Person","name":"David French","url":"https:\u002F\u002Fmedium.com\u002F@threatpunter"},"creator":["David French"],"publisher":{"@type":"Organization","name":"Threat Punter","url":"https:\u002F\u002Fmedium.com\u002Fthreatpunter","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F616\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fthreatpunter\u002Fdetecting-removing-wmi-persistence-60ccbb7dff96"}</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="522" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:25px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{position:absolute}.u{top:0}.v{left:0}.w{right:0}.x{z-index:500}.y{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ab{background-color:rgba(67, 132, 150, 1)}.ai{max-width:1192px}.aj{min-width:0}.ak{width:100%}.al{height:65px}.ao{flex:1 0 auto}.ap{fill:rgba(231, 246, 251, 1)}.aq{border-left:1px solid rgba(147, 186, 198, 1)}.ar{margin-left:15px}.as{margin-right:14px}.at{height:24px}.au{width:1px}.av{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.aw{font-weight:500}.ax{font-size:22px}.ay{line-height:28px}.az{overflow:hidden}.ba{max-height:28px}.bb{text-overflow:ellipsis}.bc{display:-webkit-box}.bd{-webkit-line-clamp:1}.be{-webkit-box-orient:vertical}.bg{letter-spacing:0}.bh{color:rgba(239, 251, 253, 1)}.bi{flex:0 0 auto}.bj{border-top:none}.bk{display:none}.bm{height:54px}.bn{margin-right:40px}.bo{font-size:20px}.bp{line-height:24px}.bq{max-height:24px}.br{overflow:auto}.bs{flex:0 1 auto}.bt{list-style-type:none}.bu{margin:0}.bv{line-height:40px}.bw{white-space:nowrap}.bx{overflow-x:auto}.by{align-items:flex-start}.bz{margin-top:20px}.ca{padding-top:20px}.cb{height:80px}.cc{margin-bottom:0px}.cd{margin-top:0px}.cg{padding-left:24px}.ch{padding-right:24px}.ci{margin-left:auto}.cj{margin-right:auto}.ck{max-width:728px}.cl{box-sizing:border-box}.cm{background:rgba(255, 255, 255, 1)}.cn{border:1px solid rgba(230, 230, 230, 1)}.co{border-radius:4px}.cp{box-shadow:0 1px 4px rgba(230, 230, 230, 1)}.cq{max-height:100vh}.cr{overflow-y:auto}.cs{top:calc(100vh + 100px)}.ct{bottom:calc(100vh + 100px)}.cu{width:10px}.cv{pointer-events:none}.cw{word-break:break-word}.cx{word-wrap:break-word}.cy:after{display:block}.cz:after{content:""}.da:after{clear:both}.db{max-width:680px}.dc{line-height:1.23}.dd{font-style:normal}.de{font-family:fell, Georgia, Cambria, "Times New Roman", Times, serif}.dz{margin-bottom:-0.27em}.ea{color:rgba(41, 41, 41, 1)}.eb{margin-top:32px}.ec{justify-content:space-between}.eg{border-radius:50%}.eh{height:48px}.ei{width:48px}.ej{margin-left:12px}.ek{font-size:14px}.el{line-height:20px}.em{margin-bottom:2px}.eo{max-height:20px}.ep{color:inherit}.eq{fill:inherit}.er{font-size:inherit}.es{border:inherit}.et{font-family:inherit}.eu{letter-spacing:inherit}.ev{font-weight:inherit}.ew{padding:0}.ez:disabled{cursor:default}.fa:disabled{color:rgba(117, 117, 117, 1)}.fb:disabled{fill:rgba(117, 117, 117, 1)}.fc{margin-left:8px}.fd{font-size:13px}.fe{color:rgba(255, 255, 255, 1)}.ff{padding:0px 8px 1px}.fg{fill:rgba(255, 255, 255, 1)}.fh{background:rgba(80, 144, 162, 1)}.fi{border-color:rgba(80, 144, 162, 1)}.fl:disabled{cursor:inherit}.fm:disabled{opacity:0.3}.fn:disabled:hover{background:rgba(80, 144, 162, 1)}.fo:disabled:hover{border-color:rgba(80, 144, 162, 1)}.fp{border-radius:99em}.fq{border-width:1px}.fr{border-style:solid}.fs{display:inline-block}.ft{text-decoration:none}.fu{color:rgba(117, 117, 117, 1)}.fv{align-items:flex-end}.gd{padding-right:6px}.gg{fill:rgba(117, 117, 117, 1)}.gh{margin-right:8px}.gi{max-width:4242px}.go{clear:both}.gq{cursor:zoom-in}.gr{position:relative}.gs{z-index:auto}.gu{max-width:100%}.gv{height:auto}.gw{line-height:1.58}.gx{letter-spacing:-0.004em}.gy{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.ht{margin-bottom:-0.46em}.hu{text-decoration:underline}.hv{line-height:1.18}.hw{letter-spacing:-0.022em}.ir{margin-bottom:-0.31em}.ix{font-weight:700}.iy{background-color:rgba(242, 242, 242, 1)}.iz{padding:2px 4px}.ja{font-size:75%}.jb> strong{font-family:inherit}.jc{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.jd{max-width:1766px}.je{opacity:0}.jf{transition:opacity 100ms 400ms}.jg{height:100%}.jh{will-change:transform}.ji{transform:translateZ(0)}.jj{margin:auto}.jk{padding-bottom:34.314835787089464%}.jl{height:0}.jm{filter:blur(20px)}.jn{transform:scale(1.1)}.jo{visibility:visible}.jp{margin-top:10px}.jq{text-align:center}.jt{padding:20px}.ju{background:rgba(242, 242, 242, 1)}.jv{font-size:16px}.jw{margin-top:-0.09em}.jx{margin-bottom:-0.09em}.jy{white-space:pre-wrap}.jz{max-width:1772px}.ka{padding-bottom:29.853273137697517%}.kb{max-width:2219px}.kc{padding-bottom:85.30869761153673%}.kd{max-width:2084px}.ke{padding-bottom:9.596928982725528%}.kf{list-style-type:decimal}.kg{margin-left:30px}.kh{padding-left:0px}.kn{max-width:2060px}.ko{padding-bottom:18.495145631067963%}.kp{max-width:2166px}.kq{padding-bottom:22.53000923361034%}.kr{max-width:2192px}.ks{padding-bottom:31.386861313868614%}.kt{max-width:1728px}.ku{padding-bottom:20.60185185185185%}.kv{max-width:2696px}.kw{padding-bottom:16.3946587537092%}.kx{max-width:3360px}.ky{padding-bottom:7.976190476190475%}.le{max-width:2945px}.lf{padding-bottom:18.539898132427844%}.lg{max-width:2365px}.lh{padding-bottom:20.972515856236786%}.li{will-change:opacity}.lj{position:fixed}.lk{width:188px}.ll{left:50%}.lm{transform:translateX(406px)}.ln{top:calc(65px + 54px + 14px)}.lq{will-change:opacity, transform}.lr{transform:translateY(159px)}.lt{width:131px}.lu{flex-direction:column}.lv{padding-bottom:28px}.lw{border-bottom:1px solid rgba(230, 230, 230, 1)}.lx{padding-bottom:20px}.ly{padding-top:2px}.lz{max-height:120px}.ma{-webkit-line-clamp:6}.mb{padding-top:28px}.mc{margin-bottom:19px}.md{margin-left:-3px}.mj{outline:0}.mk{border:0}.ml{user-select:none}.mm{cursor:pointer}.mn> svg{pointer-events:none}.mp{-webkit-user-select:none}.mz button{text-align:left}.na{opacity:1}.nb{padding-right:4px}.nc{flex-direction:row}.nl{margin-top:40px}.nm{flex-wrap:wrap}.nn{margin-top:25px}.no{margin-bottom:8px}.np{line-height:22px}.nq{border-radius:3px}.nr{padding:5px 10px}.ns{max-width:155px}.nw{top:1px}.oe{margin-left:-1px}.on{padding-right:8px}.oo{padding-top:32px}.op{border-top:1px solid rgba(230, 230, 230, 1)}.oq{margin-bottom:25px}.os{margin-bottom:32px}.ot{min-height:80px}.oy{width:80px}.oz{padding-left:102px}.pa{margin-bottom:6px}.pc{max-width:550px}.pd{max-width:450px}.pf{padding-top:24px}.pg{margin-top:5px}.ph{height:40px}.pi{width:40px}.pj{font-size:12px}.pk{line-height:16px}.pl{letter-spacing:0.083em}.pm{text-transform:uppercase}.pn{padding-top:8px}.po{margin-bottom:40px}.pp{margin-top:24px}.pq{padding-bottom:16px}.pr{margin-bottom:24px}.rd{flex-grow:0}.re{padding-bottom:24px}.rf{max-width:500px}.rj{padding-bottom:8px}.rw{padding-bottom:100%}.sh{padding:60px 0}.si{background-color:rgba(0, 0, 0, 0.9)}.sk{padding-bottom:48px}.sl{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.sm{margin:0 -12px}.sn{margin:0 12px}.so{flex:1 1 0}.sr:disabled{color:rgba(255, 255, 255, 0.7)}.ss:disabled{fill:rgba(255, 255, 255, 0.7)}.st{color:rgba(255, 255, 255, 0.98)}.su{color:rgba(255, 255, 255, 0.7)}.sv{height:22px}.sw{width:200px}.tc{margin-right:16px}.ex:hover{cursor:pointer}.ey:hover{text-decoration:underline}.fj:hover{background:rgba(73, 123, 138, 1)}.fk:hover{border-color:rgba(73, 123, 138, 1)}.ge:hover{color:rgba(25, 25, 25, 1)}.gf:hover{fill:rgba(25, 25, 25, 1)}.mr:hover{fill:rgba(117, 117, 117, 1)}.sp:hover{color:rgba(255, 255, 255, 0.99)}.sq:hover{fill:rgba(255, 255, 255, 0.99)}.gt:focus{transform:scale(1.01)}.mq:focus{fill:rgba(117, 117, 117, 1)}.mo:active{border-style:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ah{margin:0 64px}.dv{font-size:48px}.dw{margin-top:0.55em}.dx{line-height:60px}.dy{letter-spacing:-0.011em}.gc{margin-left:30px}.gn{margin-top:56px}.hp{font-size:21px}.hq{margin-top:2em}.hr{line-height:32px}.hs{letter-spacing:-0.003em}.in{font-size:22px}.io{margin-top:1.72em}.ip{line-height:28px}.iq{letter-spacing:0}.iw{margin-top:0.86em}.km{margin-top:1.05em}.ld{margin-top:1.91em}.mi{margin-right:5px}.my{margin-top:5px}.nk{padding-left:6px}.ny{display:inline-block}.od{width:8px}.ol{padding-left:7px}.om{top:3px}.qg{width:calc(100% + 32px)}.qh{margin-left:-16px}.qi{margin-right:-16px}.qz{padding-left:16px}.ra{padding-right:16px}.rb{flex-basis:25%}.rc{max-width:25%}.rs{font-size:16px}.rt{line-height:20px}.sf{min-width:70px}.sg{min-height:70px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.gb{margin-left:30px}.jr{margin-left:auto}.js{text-align:center}.mh{margin-right:5px}.mx{margin-top:5px}.nj{padding-left:6px}.nx{display:inline-block}.oc{width:8px}.oj{padding-left:7px}.ok{top:3px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ga{margin-left:30px}.mg{margin-right:5px}.mw{margin-top:5px}.nh{padding-left:6px}.ni{top:3px}.nv{display:inline-block}.ob{width:8px}.oi{padding-left:3px}.ri{margin-right:16px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.am{height:56px}.an{display:flex}.bl{display:block}.ce{margin-bottom:0px}.cf{height:110px}.ee{margin-top:32px}.ef{flex-direction:column-reverse}.fy{margin-bottom:30px}.fz{margin-left:0px}.mf{margin-left:8px}.mu{margin-top:2px}.mv{margin-right:8px}.nf{padding-left:6px}.ng{top:3px}.nu{display:inline-block}.oa{width:8px}.of{margin-left:-4px}.oh{padding-left:3px}.or{padding-top:0}.ou{margin-bottom:24px}.ov{align-items:center}.ow{width:102px}.ox{position:relative}.pb{padding-left:0}.pe{margin-top:24px}.ps{padding-bottom:12px}.pt{margin-top:16px}.rh{margin-right:16px}.ru{margin-left:16px}.rv{margin-right:0px}.sj{padding:32px 0}.sx{width:140px}.sy{margin-bottom:16px}.sz{margin-top:30px}.ta{width:100%}.tb{flex-direction:row}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ac{margin:0 24px}.df{font-size:34px}.dg{margin-top:0.56em}.dh{line-height:42px}.di{letter-spacing:-0.016em}.ed{margin-top:32px}.en{margin-bottom:0px}.fw{margin-bottom:30px}.fx{margin-left:0px}.gj{margin-top:40px}.gz{font-size:18px}.ha{margin-top:1.56em}.hb{line-height:28px}.hc{letter-spacing:-0.003em}.hx{font-size:20px}.hy{margin-top:1.23em}.hz{line-height:24px}.ia{letter-spacing:0}.is{margin-top:0.67em}.ki{margin-top:1.34em}.kz{margin-top:1.41em}.me{margin-left:8px}.ms{margin-top:2px}.mt{margin-right:8px}.nd{padding-left:6px}.ne{top:3px}.nt{display:inline-block}.nz{width:8px}.og{padding-left:3px}.pu{width:calc(100% + 24px)}.pv{margin-left:-12px}.pw{margin-right:-12px}.qj{padding-left:12px}.qk{padding-right:12px}.ql{flex-basis:100%}.qm{max-width:100%}.rg{margin-right:16px}.rk{font-size:16px}.rl{line-height:20px}.rx{min-width:48px}.ry{min-height:48px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ag{margin:0 64px}.dr{font-size:48px}.ds{margin-top:0.55em}.dt{line-height:60px}.du{letter-spacing:-0.011em}.gm{margin-top:56px}.hl{font-size:21px}.hm{margin-top:2em}.hn{line-height:32px}.ho{letter-spacing:-0.003em}.ij{font-size:22px}.ik{margin-top:1.72em}.il{line-height:28px}.im{letter-spacing:0}.iv{margin-top:0.86em}.kl{margin-top:1.05em}.lc{margin-top:1.91em}.qd{width:calc(100% + 32px)}.qe{margin-left:-16px}.qf{margin-right:-16px}.qv{padding-left:16px}.qw{padding-right:16px}.qx{flex-basis:25%}.qy{max-width:25%}.rq{font-size:16px}.rr{line-height:20px}.sd{min-width:70px}.se{min-height:70px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.af{margin:0 48px}.dn{font-size:48px}.do{margin-top:0.55em}.dp{line-height:60px}.dq{letter-spacing:-0.011em}.gl{margin-top:56px}.hh{font-size:21px}.hi{margin-top:2em}.hj{line-height:32px}.hk{letter-spacing:-0.003em}.if{font-size:22px}.ig{margin-top:1.72em}.ih{line-height:28px}.ii{letter-spacing:0}.iu{margin-top:0.86em}.kk{margin-top:1.05em}.lb{margin-top:1.91em}.qa{width:calc(100% + 28px)}.qb{margin-left:-14px}.qc{margin-right:-14px}.qr{padding-left:14px}.qs{padding-right:14px}.qt{flex-basis:50%}.qu{max-width:50%}.ro{font-size:16px}.rp{line-height:20px}.sb{min-width:48px}.sc{min-height:48px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ae{margin:0 24px}.dj{font-size:34px}.dk{margin-top:0.56em}.dl{line-height:42px}.dm{letter-spacing:-0.016em}.gk{margin-top:40px}.hd{font-size:18px}.he{margin-top:1.56em}.hf{line-height:28px}.hg{letter-spacing:-0.003em}.ib{font-size:20px}.ic{margin-top:1.23em}.id{line-height:24px}.ie{letter-spacing:0}.it{margin-top:0.67em}.kj{margin-top:1.34em}.la{margin-top:1.41em}.px{width:calc(100% + 24px)}.py{margin-left:-12px}.pz{margin-right:-12px}.qn{padding-left:12px}.qo{padding-right:12px}.qp{flex-basis:100%}.qq{max-width:100%}.rm{font-size:16px}.rn{line-height:20px}.rz{min-width:48px}.sa{min-height:48px}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="print">.z{display:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.bf{max-height:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.gp{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.lo{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 1230px)">.lp{display:none}</style><style type="text/css" data-fela-rehydration="522" data-fela-type="RULE" media="all and (max-width: 1198px)">.ls{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="s"><nav class="s t u v w c x y z"><div><div class="s ab"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="al n o am an"><div class="n o ao x"><a href="https://medium.com/?source=post_page-----60ccbb7dff96--------------------------------" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q ap"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a><div class="aq ar as at au s g"></div><div class="s g"><a href="/threatpunter?source=post_page-----60ccbb7dff96--------------------------------" rel="noopener"><span class="av aw ax ay az ba bb bc bd be bf bg bh">Threat Punter</span></a></div></div><div class="s bi x"></div></div></div></div></div><div class="bj bk ab bl"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="bm az n o"><div class="bn s bi"><a href="/threatpunter?source=post_page-----60ccbb7dff96--------------------------------" rel="noopener"><span class="av aw bo bp az bq bb bc bd be bf bg bh">Threat Punter</span></a></div><div class="br s bs"><ul class="bt bu bv bw bx n by g bz ca cb"></ul></div></div></div></div></div></div></nav><div class="cc cd al s ce cf"></div><article><section class="cg ch ci cj ak ck cl s"></section><span class="s"></span><div><div class="t v cs ct cu cv"></div><section class="cw cx cy cz da"><div class="n p"><div class="ac ae af ag ah db aj ak"><div class=""><h1 id="4230" class="dc bg dd de b df dg dh di dj dk dl dm dn do dp dq dr ds dt du dv dw dx dy dz ea">Detecting &amp; Removing an Attacker’s WMI Persistence</h1><div class="eb"><div class="n ec ed ee ef"><div class="o n"><div><a rel="noopener" href="/@threatpunter?source=post_page-----60ccbb7dff96--------------------------------"><img alt="David French" class="s eg eh ei" src="https://miro.medium.com/fit/c/96/96/1*MlhCj6a-iXChdhWSaoUxeg.jpeg" width="48" height="48"/></a></div><div class="ej ak s"><div class="n"><div style="flex:1"><span class="av b ek el ea"><div class="em n o en"><span class="av b ek el az eo bb bc bd be bf ea"><a class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener" href="/@threatpunter?source=post_page-----60ccbb7dff96--------------------------------">David French</a></span><div class="fc s bi h"><span><button class="av b fd el fe ff fg fh fi fj fk ex fl fm fn fo fp fq fr cl fs ft">Follow</button></span></div></div></span></div></div><span class="av b ek el fu"><span class="av b ek el az eo bb bc bd be bf fu"><div><a class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener" href="/threatpunter/detecting-removing-wmi-persistence-60ccbb7dff96?source=post_page-----60ccbb7dff96--------------------------------">Oct 9, 2018</a> <!-- -->·<!-- --> <!-- -->4<!-- --> min read</div></span></span></div></div><div class="n fv fw fx fy fz ga gb gc z"><div class="n o"><div class="gd s bi"><button class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" aria-label="Share on twitter"><svg width="29" height="29" class="gg"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gd s bi"><button class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gg"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gd s bi"><button class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" aria-label="Share on facebook"><svg width="29" height="29" class="gg"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="gh s"></div><div class="s ao"></div></div></div></div></div></div><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj gi"><img alt="" class="ak gu gv" src="https://miro.medium.com/max/8484/0*Qxa02RcVVLc4L79Q" width="4242" height="2828" role="presentation"/></div></div></figure><p id="f4f8" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Windows Management Instrumentation (WMI) Event Subscription is a popular technique to establish persistence on an endpoint. I decided to spend some time playing with <a href="https://github.com/EmpireProject/Empire" class="ep hu" rel="noopener nofollow">Empire’s</a> WMI modules and analyzing the artifacts for detection opportunities. I also reviewed the PowerShell commands that can be used to view and remove WMI event subscriptions.</p><p id="0a28" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">“Windows Management Instrumentation Event Subscription” is MITRE ATT&amp;CK Technique <a href="https://attack.mitre.org/wiki/Technique/T1084" class="ep hu" rel="noopener nofollow">T1084</a>.</p><p id="541c" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Attackers may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system.</p><h2 id="a372" class="hv hw dd av aw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir ea">What is WMI?</h2><p id="0300" class="gw gx dd gy b gz is hb hc hd it hf hg hh iu hj hk hl iv hn ho hp iw hr hs ht cw ea">“<a href="https://docs.microsoft.com/en-us/windows/desktop/wmisdk/about-wmi" class="ep hu" rel="noopener nofollow">WMI</a> is the Microsoft implementation of Web-Based Enterprise Management (WBEM), which is an industry initiative to develop a standard technology for accessing management information in an enterprise environment. WMI uses the Common Information Model (CIM) industry standard to represent systems, applications, networks, devices, and other managed components.”</p><p id="375d" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">An <a href="https://docs.microsoft.com/en-us/windows/desktop/wmisdk/creating-an-event-filter" class="ep hu" rel="noopener nofollow"><strong class="gy ix">event filter</strong></a> is a WMI class that describes which events WMI delivers to an <strong class="gy ix">event consumer</strong>. An event filter also describes the conditions under which WMI delivers the events.</p><h2 id="6788" class="hv hw dd av aw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir ea">Configuring Sysmon Logging</h2><p id="c0ff" class="gw gx dd gy b gz is hb hc hd it hf hg hh iu hj hk hl iv hn ho hp iw hr hs ht cw ea"><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon" class="ep hu" rel="noopener nofollow">Sysmon</a> can be configured to log <code class="iy iz ja jb jc b">WmiEventFilter</code>, <code class="iy iz ja jb jc b">WmiEventConsumer</code>, and <code class="iy iz ja jb jc b">WmiEventConsumerToFilter</code> activity and enable the detection of WMI abuse.</p><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj jd"><div class="jj s gr iy"><div class="jk jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*b5Gvr4xP7PLpVKxm26klRA.png?q=20" width="1766" height="606" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="1766" height="606" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/3532/1*b5Gvr4xP7PLpVKxm26klRA.png" width="1766" height="606" srcSet="https://miro.medium.com/max/552/1*b5Gvr4xP7PLpVKxm26klRA.png 276w, https://miro.medium.com/max/1104/1*b5Gvr4xP7PLpVKxm26klRA.png 552w, https://miro.medium.com/max/1280/1*b5Gvr4xP7PLpVKxm26klRA.png 640w, https://miro.medium.com/max/1400/1*b5Gvr4xP7PLpVKxm26klRA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Sysmon Event IDs for WMI activity</figcaption></figure><p id="542f" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Roberto Rodriguez’s (<a href="https://twitter.com/Cyb3rWard0g" class="ep hu" rel="noopener nofollow"><strong class="gy ix">@</strong>Cyb3rWard0g</a>) <a href="https://gist.github.com/Cyb3rWard0g/136481552d8845e52962534d1a4b8664" class="ep hu" rel="noopener nofollow">Sysmon configuration file</a> will capture the above Event IDs.</p><p id="0736" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Execute the following command to install Sysmon and apply a configuration file.</p><pre class="gj gk gl gm gn jt ju bx"><span id="46c5" class="ea hv hw dd jc b jv jw jx s jy">sysmon.exe -i -c .\config_file.xml </span></pre><h2 id="407d" class="hv hw dd av aw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir ea">Establish Persistence</h2><p id="240c" class="gw gx dd gy b gz is hb hc hd it hf hg hh iu hj hk hl iv hn ho hp iw hr hs ht cw ea">Let’s use Empire’s <code class="iy iz ja jb jc b">Invoke-WMI</code> module to create a permanent WMI subscription and persist a stager on the victim endpoint.</p><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj jz"><div class="jj s gr iy"><div class="ka jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*JRCFX-PCSzIPOe76Pft5Qw.png?q=20" width="1772" height="529" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="1772" height="529" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/3544/1*JRCFX-PCSzIPOe76Pft5Qw.png" width="1772" height="529" srcSet="https://miro.medium.com/max/552/1*JRCFX-PCSzIPOe76Pft5Qw.png 276w, https://miro.medium.com/max/1104/1*JRCFX-PCSzIPOe76Pft5Qw.png 552w, https://miro.medium.com/max/1280/1*JRCFX-PCSzIPOe76Pft5Qw.png 640w, https://miro.medium.com/max/1400/1*JRCFX-PCSzIPOe76Pft5Qw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Reviewing Empire’s WMI-related modules</figcaption></figure><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj kb"><div class="jj s gr iy"><div class="kc jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*vl8S6lxvFBdCtlfWWZrHYA.png?q=20" width="2219" height="1893" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="2219" height="1893" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/4438/1*vl8S6lxvFBdCtlfWWZrHYA.png" width="2219" height="1893" srcSet="https://miro.medium.com/max/552/1*vl8S6lxvFBdCtlfWWZrHYA.png 276w, https://miro.medium.com/max/1104/1*vl8S6lxvFBdCtlfWWZrHYA.png 552w, https://miro.medium.com/max/1280/1*vl8S6lxvFBdCtlfWWZrHYA.png 640w, https://miro.medium.com/max/1400/1*vl8S6lxvFBdCtlfWWZrHYA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Reviewing the options for Empire’s Invoke-WMI module</figcaption></figure><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj kd"><div class="jj s gr iy"><div class="ke jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*9Gs6vM3l1q6ElpAOy5vTEA.png?q=20" width="2084" height="200" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="2084" height="200" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/4168/1*9Gs6vM3l1q6ElpAOy5vTEA.png" width="2084" height="200" srcSet="https://miro.medium.com/max/552/1*9Gs6vM3l1q6ElpAOy5vTEA.png 276w, https://miro.medium.com/max/1104/1*9Gs6vM3l1q6ElpAOy5vTEA.png 552w, https://miro.medium.com/max/1280/1*9Gs6vM3l1q6ElpAOy5vTEA.png 640w, https://miro.medium.com/max/1400/1*9Gs6vM3l1q6ElpAOy5vTEA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Running the module</figcaption></figure><h2 id="493f" class="hv hw dd av aw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir ea">Detection</h2><p id="8d29" class="gw gx dd gy b gz is hb hc hd it hf hg hh iu hj hk hl iv hn ho hp iw hr hs ht cw ea">Reviewing the Sysmon logs we can see that the Empire module:</p><ol class=""><li id="6f2e" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht kf kg kh ea">Registered a WMI event filter</li><li id="6828" class="gw gx dd gy b gz ki hb hc hd kj hf hg hh kk hj hk hl kl hn ho hp km hr hs ht kf kg kh ea">Registered a WMI event consumer</li><li id="751b" class="gw gx dd gy b gz ki hb hc hd kj hf hg hh kk hj hk hl kl hn ho hp km hr hs ht kf kg kh ea">Bound the event consumer to the event filter</li></ol><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj kn"><div class="jj s gr iy"><div class="ko jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*cfqTB5-ka63ohhgTqcu52A.png?q=20" width="2060" height="381" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="2060" height="381" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/4120/1*cfqTB5-ka63ohhgTqcu52A.png" width="2060" height="381" srcSet="https://miro.medium.com/max/552/1*cfqTB5-ka63ohhgTqcu52A.png 276w, https://miro.medium.com/max/1104/1*cfqTB5-ka63ohhgTqcu52A.png 552w, https://miro.medium.com/max/1280/1*cfqTB5-ka63ohhgTqcu52A.png 640w, https://miro.medium.com/max/1400/1*cfqTB5-ka63ohhgTqcu52A.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Sysmon events logged after Empire Invoke-WMI module execution</figcaption></figure><p id="01ed" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">The WMI event filter sets the conditions for the stager to execute, which includes references to the system’s uptime.</p><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj kp"><div class="jj s gr iy"><div class="kq jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*EofnbAOSB1mr8odnUSg_cQ.png?q=20" width="2166" height="488" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="2166" height="488" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/4332/1*EofnbAOSB1mr8odnUSg_cQ.png" width="2166" height="488" srcSet="https://miro.medium.com/max/552/1*EofnbAOSB1mr8odnUSg_cQ.png 276w, https://miro.medium.com/max/1104/1*EofnbAOSB1mr8odnUSg_cQ.png 552w, https://miro.medium.com/max/1280/1*EofnbAOSB1mr8odnUSg_cQ.png 640w, https://miro.medium.com/max/1400/1*EofnbAOSB1mr8odnUSg_cQ.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Sysmon Event ID 19: WmiEvent (WmiEventFilter activity detected)</figcaption></figure><p id="5915" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">The WMI event consumer contains the Empire stager in Base64-encoded form and is registered with the innocuous name, <code class="iy iz ja jb jc b">Updater</code> when its default settings are used.</p><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj kr"><div class="jj s gr iy"><div class="ks jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*f5j1NV-BVvQmsglYoQ3Tfw.png?q=20" width="2192" height="688" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="2192" height="688" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/4384/1*f5j1NV-BVvQmsglYoQ3Tfw.png" width="2192" height="688" srcSet="https://miro.medium.com/max/552/1*f5j1NV-BVvQmsglYoQ3Tfw.png 276w, https://miro.medium.com/max/1104/1*f5j1NV-BVvQmsglYoQ3Tfw.png 552w, https://miro.medium.com/max/1280/1*f5j1NV-BVvQmsglYoQ3Tfw.png 640w, https://miro.medium.com/max/1400/1*f5j1NV-BVvQmsglYoQ3Tfw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Sysmon Event ID 20: WmiEvent (WmiEventConsumer activity detected)</figcaption></figure><p id="0eef" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">The WMI event consumer <code class="iy iz ja jb jc b">CommandLineEventConsumer.Name=\”Updater\&quot;</code> is bound to the event filter <code class="iy iz ja jb jc b">__EventFilter.Name=\”Updater\”</code></p><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj kt"><div class="jj s gr iy"><div class="ku jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*Ql2SRtWXie8iycEJ-AQ_Rw.png?q=20" width="1728" height="356" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="1728" height="356" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/3456/1*Ql2SRtWXie8iycEJ-AQ_Rw.png" width="1728" height="356" srcSet="https://miro.medium.com/max/552/1*Ql2SRtWXie8iycEJ-AQ_Rw.png 276w, https://miro.medium.com/max/1104/1*Ql2SRtWXie8iycEJ-AQ_Rw.png 552w, https://miro.medium.com/max/1280/1*Ql2SRtWXie8iycEJ-AQ_Rw.png 640w, https://miro.medium.com/max/1400/1*Ql2SRtWXie8iycEJ-AQ_Rw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Sysmon Event ID 21: WmiEvent (WmiEventConsumerToFilter activity detected)</figcaption></figure><p id="58d2" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Now that the event consumer is bound to the event filter, <strong class="gy ix">IF</strong> the event filter conditions are true <strong class="gy ix">THEN</strong> trigger the event consumer (the stager).</p><h2 id="b815" class="hv hw dd av aw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir ea">Eradication</h2><p id="b1fe" class="gw gx dd gy b gz is hb hc hd it hf hg hh iu hj hk hl iv hn ho hp iw hr hs ht cw ea">The simplest method to remove the entry from the WMI database is to use <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns" class="ep hu" rel="noopener nofollow">Autoruns</a>. Launch Autoruns as an administrator and select the <code class="iy iz ja jb jc b">WMI</code> tab to review WMI-related persistence.</p><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj kv"><div class="jj s gr iy"><div class="kw jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*HrM52HnYVK7UH3DQGYykGg.png?q=20" width="2696" height="442" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="2696" height="442" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/5392/1*HrM52HnYVK7UH3DQGYykGg.png" width="2696" height="442" srcSet="https://miro.medium.com/max/552/1*HrM52HnYVK7UH3DQGYykGg.png 276w, https://miro.medium.com/max/1104/1*HrM52HnYVK7UH3DQGYykGg.png 552w, https://miro.medium.com/max/1280/1*HrM52HnYVK7UH3DQGYykGg.png 640w, https://miro.medium.com/max/1400/1*HrM52HnYVK7UH3DQGYykGg.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Using Autoruns to review WMI database entries</figcaption></figure><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj kx"><div class="jj s gr iy"><div class="ky jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*UjaSX9LZkS1CX_OzVIoCPg.png?q=20" width="3360" height="268" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="3360" height="268" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/6720/1*UjaSX9LZkS1CX_OzVIoCPg.png" width="3360" height="268" srcSet="https://miro.medium.com/max/552/1*UjaSX9LZkS1CX_OzVIoCPg.png 276w, https://miro.medium.com/max/1104/1*UjaSX9LZkS1CX_OzVIoCPg.png 552w, https://miro.medium.com/max/1280/1*UjaSX9LZkS1CX_OzVIoCPg.png 640w, https://miro.medium.com/max/1400/1*UjaSX9LZkS1CX_OzVIoCPg.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Using Autoruns to review content of the WMI database</figcaption></figure><p id="8da1" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Right-click the malicious WMI database entry and select <code class="iy iz ja jb jc b">Delete</code>.</p><p id="8051" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Alternatively, you can remove the WMI event subscriptions from the command line.</p><p id="ceba" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Use <code class="iy iz ja jb jc b">Get-WMIObject</code> in PowerShell to review the WMI event filter, event consumer, and consumer filter to event filter binding. Thanks to Boe Prox (<a href="https://twitter.com/proxb" class="ep hu" rel="noopener nofollow">@proxb</a>) for explaining these commands in detail on <a href="https://learn-powershell.net/2013/08/14/powershell-and-events-permanent-wmi-event-subscriptions/" class="ep hu" rel="noopener nofollow">his blog</a>.</p><pre class="gj gk gl gm gn jt ju bx"><span id="ff81" class="ea hv hw dd jc b jv jw jx s jy"># Reviewing WMI Subscriptions using Get-WMIObject<br/># Event Filter<br/>Get-WMIObject -Namespace root\Subscription -Class __EventFilter -Filter “Name=’Updater’”</span><span id="dd04" class="ea hv hw dd jc b jv kz la lb lc ld jx s jy"># Event Consumer<br/>Get-WMIObject -Namespace root\Subscription -Class CommandLineEventConsumer -Filter “Name=’Updater’”<br/> <br/># Binding<br/>Get-WMIObject -Namespace root\Subscription -Class __FilterToConsumerBinding -Filter “__Path LIKE ‘%Updater%’”</span></pre><p id="079c" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Use <code class="iy iz ja jb jc b">Remove-WMIObject</code> to remove all components of the WMI persistence.</p><pre class="gj gk gl gm gn jt ju bx"><span id="ec6a" class="ea hv hw dd jc b jv jw jx s jy"># Removing WMI Subscriptions using Remove-WMIObject<br/># Event Filter<br/>Get-WMIObject -Namespace root\Subscription -Class __EventFilter -Filter “Name=’Updater’” | Remove-WmiObject -Verbose</span><span id="fcd7" class="ea hv hw dd jc b jv kz la lb lc ld jx s jy"># Event Consumer<br/>Get-WMIObject -Namespace root\Subscription -Class CommandLineEventConsumer -Filter “Name=’Updater’” | Remove-WmiObject -Verbose<br/> <br/># Binding<br/>Get-WMIObject -Namespace root\Subscription -Class __FilterToConsumerBinding -Filter “__Path LIKE ‘%Updater%’” | Remove-WmiObject -Verbose</span></pre><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj le"><div class="jj s gr iy"><div class="lf jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*0N2vYQPq1uo83m_15djMdA.png?q=20" width="2945" height="546" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="2945" height="546" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/5890/1*0N2vYQPq1uo83m_15djMdA.png" width="2945" height="546" srcSet="https://miro.medium.com/max/552/1*0N2vYQPq1uo83m_15djMdA.png 276w, https://miro.medium.com/max/1104/1*0N2vYQPq1uo83m_15djMdA.png 552w, https://miro.medium.com/max/1280/1*0N2vYQPq1uo83m_15djMdA.png 640w, https://miro.medium.com/max/1400/1*0N2vYQPq1uo83m_15djMdA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="jp jq ck ci cj jr js av b ek el fu">Removing WMI event subscriptions</figcaption></figure><p id="90cb" class="gw gx dd gy b gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht cw ea">Run Autoruns again to verify that the persistence was removed.</p><figure class="gj gk gl gm gn go ci cj paragraph-image"><div role="button" tabindex="0" class="gp gq gr gs ak gt"><div class="ci cj lg"><div class="jj s gr iy"><div class="lh jl s"><div class="je jf t u v jg ak az jh ji"><img alt="" class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*xux-iys417DB89mNZC7RKw.png?q=20" width="2365" height="496" role="presentation"/></div><img alt="" class="je jf t u v jg ak c" width="2365" height="496" role="presentation"/><noscript><img alt="" class="t u v jg ak" src="https://miro.medium.com/max/4730/1*xux-iys417DB89mNZC7RKw.png" width="2365" height="496" srcSet="https://miro.medium.com/max/552/1*xux-iys417DB89mNZC7RKw.png 276w, https://miro.medium.com/max/1104/1*xux-iys417DB89mNZC7RKw.png 552w, https://miro.medium.com/max/1280/1*xux-iys417DB89mNZC7RKw.png 640w, https://miro.medium.com/max/1400/1*xux-iys417DB89mNZC7RKw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure></div></div></section></div></article><div class="je cv lj lq ak lr u lo ls" data-test-id="post-sidebar"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="lt n lu"><div class="cv"><div><div class="lv lw s"><a href="/threatpunter?source=post_sidebar--------------------------post_sidebar-----------" class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" rel="noopener"><h2 class="av aw jv el bg ea cw">Threat Punter</h2></a><div class="lx ly s"><p class="av b ek el az lz bb bc ma be bf fu">Threat Hunting | Threat Detection | Digital Forensics</p></div></div><div class="mb mc md n"><div class="n o"><div class="s gr me mf mg mh mi"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fthreatpunter%2F60ccbb7dff96&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fthreatpunter%2Fdetecting-removing-wmi-persistence-60ccbb7dff96&amp;user=David%20French&amp;userId=b9eaa7b7dd5c&amp;source=post_sidebar-----60ccbb7dff96---------------------clap_sidebar-----------" class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" rel="noopener"><div class="ew mj mk ml mm mn mo mp r mq mr"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s ms mt mu mv mw mx my"><div class="mz"><p class="av b ek el fu"><button class="ep eq er es et eu ev ew bu ex ge gf ez fa fb">75<!-- --> </button></p></div></div></div></div><div class="mc s"><button class="mm mk ew"><div class="nb n o nc"><svg width="25" height="25" class="r na mm mr" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s gr nd ne nf ng nh ni nj nk"></div></div></button></div></div></div></div></div></div></div><div class="je cv li lj lk ll lm ln lo lp"></div><div><div class="nl go n lu p"><div class="n p"><div class="ac ae af ag ah db aj ak"><div class="n nm"></div><div class="n o nm"></div><div class="nn s"><ul class="ew bu"><li class="fs bt gh no"><a href="https://medium.com/threatpunter/tagged/threat-hunting" class="av b fd np fu nq nr ft s ju">Threat Hunting</a></li><li class="fs bt gh no"><a href="https://medium.com/threatpunter/tagged/threat-detection" class="av b fd np fu nq nr ft s ju">Threat Detection</a></li><li class="fs bt gh no"><a href="https://medium.com/threatpunter/tagged/cybersecurity" class="av b fd np fu nq nr ft s ju">Cybersecurity</a></li><li class="fs bt gh no"><a href="https://medium.com/threatpunter/tagged/persistence" class="av b fd np fu nq nr ft s ju">Persistence</a></li></ul></div><div class="nn n ec z"><div class="n o nc"><div class="ns s"><span class="s nt nu nv e d"><div class="n o"><div class="s gr me mf mg mh mi"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fthreatpunter%2F60ccbb7dff96&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fthreatpunter%2Fdetecting-removing-wmi-persistence-60ccbb7dff96&amp;user=David%20French&amp;userId=b9eaa7b7dd5c&amp;source=post_actions_footer-----60ccbb7dff96---------------------clap_footer-----------" class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" rel="noopener"><div class="ew mj mk ml mm mn mo mp r mq mr"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s ms mt mu mv mw mx my"><div class="gr nw mz"><p class="av b ek el ea"><button class="ep eq er es et eu ev ew bu ex ge gf ez fa fb">75<span class="s h g f nx ny"> <!-- -->claps</span></button><span class="s h g f nx ny"></span></p></div></div></div></span><span class="s h g f nx ny"><div class="n o"><div class="s gr me mf mg mh mi"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fthreatpunter%2F60ccbb7dff96&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fthreatpunter%2Fdetecting-removing-wmi-persistence-60ccbb7dff96&amp;user=David%20French&amp;userId=b9eaa7b7dd5c&amp;source=post_actions_footer-----60ccbb7dff96---------------------clap_footer-----------" class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" rel="noopener"><div class="ew mj mk ml mm mn mo mp r mq mr"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s ms mt mu mv mw mx my"><div class="mz"><p class="av b ek el fu"><button class="ep eq er es et eu ev ew bu ex ge gf ez fa fb">75<!-- --> </button></p></div></div></div></span></div><div class="s nz oa ob oc od"></div><button class="mm mk ew"><div class="nb n o nc"><span class="oe s of"><svg width="25" height="25" class="r na mm mr" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span><div class="s gr og ne oh ng oi ni oj ok ol om"></div></div></button></div><div class="n o"><div class="gd s bi"><button class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" aria-label="Share on twitter"><svg width="29" height="29" class="gg"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gd s bi"><button class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gg"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gd s bi"><button class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" aria-label="Share on facebook"><svg width="29" height="29" class="gg"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="on s bi"></div></div></div></div></div><div><div class="n p"><div class="ac ae af ag ah db aj ak"><div class="oo op oq nn s or z"><div class="s g"><div class="oo s"></div><div class="os ot s gr"><span class="s ou an ov"><div class="s t ow ox"><a href="/threatpunter?source=follow_footer-------------------------------------" rel="noopener"><img alt="Threat Punter" class="co oy cb" src="https://miro.medium.com/fit/c/160/160/1*51cURBhf0Pw5BQuCmndliQ.png" width="80" height="80"/></a></div><span class="s"><div class="oz pa n pb"><div class="ak n o ec"><h2 class="av aw ax ay bg ea"><a href="/threatpunter?source=follow_footer-------------------------------------" class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" rel="noopener">Threat Punter</a></h2><div class="s g"></div></div></div></span></span><div class="oz pc s pb bl"><div class="pd s"><p class="av b jv bp fu">Threat Hunting | Threat Detection | Digital Forensics</p></div><div class="bk pe bl"></div></div></div></div><div class="bk bl"><div class="pf s"><div class="n nc"><div class="pg s"><a rel="noopener" href="/@threatpunter?source=follow_footer-------------------------------------"><img alt="David French" class="s eg ph pi" src="https://miro.medium.com/fit/c/80/80/1*MlhCj6a-iXChdhWSaoUxeg.jpeg" width="40" height="40"/></a></div><div class="ej s"><p class="av b pj pk pl fu pm">Written by</p><div class="n nc"><h2 class="av aw jv el bg ea"><a class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" rel="noopener" href="/@threatpunter?source=follow_footer-------------------------------------">David French</a></h2><div class="ej s"><span><button class="av b fd el fe ff fg fh fi fj fk ex fl fm fn fo fp fq fr cl fs ft">Follow</button></span></div></div><div class="pn s"><p class="av b ek el fu">Threat Hunting | Detection Engineering | Digital Forensics</p></div></div></div><div class="pf s"><div class="n nc"><a href="/threatpunter?source=follow_footer-------------------------------------" rel="noopener"><img alt="Threat Punter" class="co pi ph" src="https://miro.medium.com/fit/c/80/80/1*51cURBhf0Pw5BQuCmndliQ.png" width="40" height="40"/></a><div class="ej s"><div class="n nc"><h2 class="av aw jv el bg ea"><a href="/threatpunter?source=follow_footer-------------------------------------" class="ep eq er es et eu ev ew bu ex ge gf ez fa fb" rel="noopener">Threat Punter</a></h2><div class="ej s"></div></div><div class="pn s"><p class="av b ek el fu">Threat Hunting | Threat Detection | Digital Forensics</p></div></div></div></div></div></div></div></div></div><div class="s cm z"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="po pp s"><div class="pq lw pr pp s ps pt"><h2 class="av aw hx hz ia ib id ie if ih ii ij il im in ip iq ea">More From Medium</h2></div><div class="by n nc nm pu pv pw px py pz qa qb qc qd qe qf qg qh qi"><div class="qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb rc rd"><div class="re rf s"><div class="ak jg"><div class="n ec"><div class="s bs rg rh ri"><div class="rj s"><h2 class="av aw rk rl ia rm rn ie ro rp ii rq rr im rs rt iq ea"><a rel="noopener" href="/nerd-for-tech/do-you-know-your-cyber-risk-score-be0de8df0532?source=post_internal_links---------0----------------------------">Do You Know Your Cyber Risk Score?</a></h2></div><div class="o n"><div></div><div class="ak s"><div class="n"><div style="flex:1"><span class="av b ek el ea"><div class="cc n o en"><span class="av b fd el ea"><a href="https://himtyagi.medium.com/?source=post_internal_links---------0----------------------------" class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener">Himanshu Tyagi</a><span> <!-- -->in<!-- --> <a href="/nerd-for-tech?source=post_internal_links---------0----------------------------" class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener">Nerd For Tech</a></span></span></div></span></div></div></div></div></div><div class="ej gh s ru rv"><a class="ep eq er es et eu ev ew bu ex ge gf ez fa fb s" rel="noopener" href="/nerd-for-tech/do-you-know-your-cyber-risk-score-be0de8df0532?source=post_internal_links---------0----------------------------"><div class="jj s gr iy"><div class="rw jl s"><div class="je jf t u v jg ak az jh ji"><img class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/0*WEFGk4rjOa3x19v8?q=20" width="70" height="70" role="presentation"/></div><img class="je jf rx ry rz sa sb sc sd se sf sg c" width="70" height="70" role="presentation"/><noscript><img class="rx ry rz sa sb sc sd se sf sg" src="https://miro.medium.com/fit/c/140/140/0*WEFGk4rjOa3x19v8" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*WEFGk4rjOa3x19v8 48w, https://miro.medium.com/fit/c/140/140/0*WEFGk4rjOa3x19v8 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb rc rd"><div class="re rf s"><div class="ak jg"><div class="n ec"><div class="s bs rg rh ri"><div class="rj s"><h2 class="av aw rk rl ia rm rn ie ro rp ii rq rr im rs rt iq ea"><a rel="noopener" href="/iocscan/dns-cache-poisoning-bea939b5afaf?source=post_internal_links---------1----------------------------">DNS Cache Poisoning</a></h2></div><div class="o n"><div></div><div class="ak s"><div class="n"><div style="flex:1"><span class="av b ek el ea"><div class="cc n o en"><span class="av b fd el ea"><a class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener" href="/@x24mak?source=post_internal_links---------1----------------------------">Christopher Makarem</a><span> <!-- -->in<!-- --> <a href="/iocscan?source=post_internal_links---------1----------------------------" class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener">IOCSCAN</a></span></span></div></span></div></div></div></div></div><div class="ej gh s ru rv"><a class="ep eq er es et eu ev ew bu ex ge gf ez fa fb s" rel="noopener" href="/iocscan/dns-cache-poisoning-bea939b5afaf?source=post_internal_links---------1----------------------------"><div class="jj s gr iy"><div class="rw jl s"><div class="je jf t u v jg ak az jh ji"><img class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*iBZM5hvnXRvelyJ0E1KRig.png?q=20" width="70" height="70" role="presentation"/></div><img class="je jf rx ry rz sa sb sc sd se sf sg c" width="70" height="70" role="presentation"/><noscript><img class="rx ry rz sa sb sc sd se sf sg" src="https://miro.medium.com/fit/c/140/140/1*iBZM5hvnXRvelyJ0E1KRig.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*iBZM5hvnXRvelyJ0E1KRig.png 48w, https://miro.medium.com/fit/c/140/140/1*iBZM5hvnXRvelyJ0E1KRig.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb rc rd"><div class="re rf s"><div class="ak jg"><div class="n ec"><div class="s bs rg rh ri"><div class="rj s"><h2 class="av aw rk rl ia rm rn ie ro rp ii rq rr im rs rt iq ea"><a rel="noopener" href="/hackernoon/why-does-a-coffee-machine-need-its-own-account-be70a760a5f?source=post_internal_links---------2----------------------------">Why Does a Coffee Machine Need Its Own Account?</a></h2></div><div class="o n"><div></div><div class="ak s"><div class="n"><div style="flex:1"><span class="av b ek el ea"><div class="cc n o en"><span class="av b fd el ea"><a class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener" href="/@david.w.balaban?source=post_internal_links---------2----------------------------">David Balaban</a><span> <!-- -->in<!-- --> <a href="/hackernoon?source=post_internal_links---------2----------------------------" class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener">HackerNoon.com</a></span></span></div></span></div></div></div></div></div><div class="ej gh s ru rv"><a class="ep eq er es et eu ev ew bu ex ge gf ez fa fb s" rel="noopener" href="/hackernoon/why-does-a-coffee-machine-need-its-own-account-be70a760a5f?source=post_internal_links---------2----------------------------"><div class="jj s gr iy"><div class="rw jl s"><div class="je jf t u v jg ak az jh ji"><img class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*Z7p-OTp2imOZ3N1DezQLRw.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="je jf rx ry rz sa sb sc sd se sf sg c" width="70" height="70" role="presentation"/><noscript><img class="rx ry rz sa sb sc sd se sf sg" src="https://miro.medium.com/fit/c/140/140/1*Z7p-OTp2imOZ3N1DezQLRw.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*Z7p-OTp2imOZ3N1DezQLRw.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*Z7p-OTp2imOZ3N1DezQLRw.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb rc rd"><div class="re rf s"><div class="ak jg"><div class="n ec"><div class="s bs rg rh ri"><div class="rj s"><h2 class="av aw rk rl ia rm rn ie ro rp ii rq rr im rs rt iq ea"><a rel="noopener" href="/baiduxlab/pc-security-facing-another-heavy-hammer-baidu-security-discovers-a-new-rowhammer-attack-be3dce8d1e92?source=post_internal_links---------3----------------------------">PC security facing another “heavy hammer”, Baidu Security discovers a new Rowhammer attack</a></h2></div><div class="o n"><div></div><div class="ak s"><div class="n"><div style="flex:1"><span class="av b ek el ea"><div class="cc n o en"><span class="av b fd el ea"><a class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener" href="/@baidu.xlab?source=post_internal_links---------3----------------------------">Baidu Security X-Lab</a><span> <!-- -->in<!-- --> <a href="/baiduxlab?source=post_internal_links---------3----------------------------" class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener">Baidu Security X-Lab</a></span></span></div></span></div></div></div></div></div><div class="ej gh s ru rv"><a class="ep eq er es et eu ev ew bu ex ge gf ez fa fb s" rel="noopener" href="/baiduxlab/pc-security-facing-another-heavy-hammer-baidu-security-discovers-a-new-rowhammer-attack-be3dce8d1e92?source=post_internal_links---------3----------------------------"><div class="jj s gr iy"><div class="rw jl s"><div class="je jf t u v jg ak az jh ji"><img class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*6mItxq_7zX4uv2yJ3q6JlQ.png?q=20" width="70" height="70" role="presentation"/></div><img class="je jf rx ry rz sa sb sc sd se sf sg c" width="70" height="70" role="presentation"/><noscript><img class="rx ry rz sa sb sc sd se sf sg" src="https://miro.medium.com/fit/c/140/140/1*6mItxq_7zX4uv2yJ3q6JlQ.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*6mItxq_7zX4uv2yJ3q6JlQ.png 48w, https://miro.medium.com/fit/c/140/140/1*6mItxq_7zX4uv2yJ3q6JlQ.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb rc rd"><div class="re rf s"><div class="ak jg"><div class="n ec"><div class="s bs rg rh ri"><div class="rj s"><h2 class="av aw rk rl ia rm rn ie ro rp ii rq rr im rs rt iq ea"><a href="https://rww.medium.com/the-key-issues-that-stand-between-us-and-the-future-of-the-internet-beeb9a6d1459?source=post_internal_links---------4----------------------------" rel="noopener">The Key Issues That Stand Between Us and the Future of the Internet</a></h2></div><div class="o n"><div></div><div class="ak s"><div class="n"><div style="flex:1"><span class="av b ek el ea"><div class="cc n o en"><span class="av b fd el ea"><a href="https://rww.medium.com/?source=post_internal_links---------4----------------------------" class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener">ReadWrite</a></span></div></span></div></div></div></div></div><div class="ej gh s ru rv"><a href="https://rww.medium.com/the-key-issues-that-stand-between-us-and-the-future-of-the-internet-beeb9a6d1459?source=post_internal_links---------4----------------------------" class="ep eq er es et eu ev ew bu ex ge gf ez fa fb s" rel="noopener"><div class="jj s gr iy"><div class="rw jl s"><div class="je jf t u v jg ak az jh ji"><img class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*frbJ5rHvSQqszIdNGDmXyw.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="je jf rx ry rz sa sb sc sd se sf sg c" width="70" height="70" role="presentation"/><noscript><img class="rx ry rz sa sb sc sd se sf sg" src="https://miro.medium.com/fit/c/140/140/1*frbJ5rHvSQqszIdNGDmXyw.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*frbJ5rHvSQqszIdNGDmXyw.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*frbJ5rHvSQqszIdNGDmXyw.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb rc rd"><div class="re rf s"><div class="ak jg"><div class="n ec"><div class="s bs rg rh ri"><div class="rj s"><h2 class="av aw rk rl ia rm rn ie ro rp ii rq rr im rs rt iq ea"><a rel="noopener" href="/swlh/intro-to-ssrf-beb35857771f?source=post_internal_links---------5----------------------------">Intro to SSRF</a></h2></div><div class="o n"><div></div><div class="ak s"><div class="n"><div style="flex:1"><span class="av b ek el ea"><div class="cc n o en"><span class="av b fd el ea"><a href="https://vickieli.medium.com/?source=post_internal_links---------5----------------------------" class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener">Vickie Li</a><span> <!-- -->in<!-- --> <a href="/swlh?source=post_internal_links---------5----------------------------" class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener">The Startup</a></span></span></div></span></div></div></div></div></div><div class="ej gh s ru rv"><a class="ep eq er es et eu ev ew bu ex ge gf ez fa fb s" rel="noopener" href="/swlh/intro-to-ssrf-beb35857771f?source=post_internal_links---------5----------------------------"><div class="jj s gr iy"><div class="rw jl s"><div class="je jf t u v jg ak az jh ji"><img class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/0*s4UFOw-mAiGaeQrF.png?q=20" width="70" height="70" role="presentation"/></div><img class="je jf rx ry rz sa sb sc sd se sf sg c" width="70" height="70" role="presentation"/><noscript><img class="rx ry rz sa sb sc sd se sf sg" src="https://miro.medium.com/fit/c/140/140/0*s4UFOw-mAiGaeQrF.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*s4UFOw-mAiGaeQrF.png 48w, https://miro.medium.com/fit/c/140/140/0*s4UFOw-mAiGaeQrF.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb rc rd"><div class="re rf s"><div class="ak jg"><div class="n ec"><div class="s bs rg rh ri"><div class="rj s"><h2 class="av aw rk rl ia rm rn ie ro rp ii rq rr im rs rt iq ea"><a rel="noopener" href="/@eescobar/my-security-leadership-journey-so-far-be57f4f3dcd7?source=post_internal_links---------6----------------------------">My Security Leadership Journey So Far</a></h2></div><div class="o n"><div></div><div class="ak s"><div class="n"><div style="flex:1"><span class="av b ek el ea"><div class="cc n o en"><span class="av b fd el ea"><a class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener" href="/@eescobar?source=post_internal_links---------6----------------------------">Emilio Escobar</a></span></div></span></div></div></div></div></div><div class="ej gh s ru rv"><a class="ep eq er es et eu ev ew bu ex ge gf ez fa fb s" rel="noopener" href="/@eescobar/my-security-leadership-journey-so-far-be57f4f3dcd7?source=post_internal_links---------6----------------------------"><div class="jj s gr iy"><div class="rw jl s"><div class="je jf t u v jg ak az jh ji"><img class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*CMflG4Br-l9smE9B_eOd7g.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="je jf rx ry rz sa sb sc sd se sf sg c" width="70" height="70" role="presentation"/><noscript><img class="rx ry rz sa sb sc sd se sf sg" src="https://miro.medium.com/fit/c/140/140/1*CMflG4Br-l9smE9B_eOd7g.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*CMflG4Br-l9smE9B_eOd7g.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*CMflG4Br-l9smE9B_eOd7g.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb rc rd"><div class="re rf s"><div class="ak jg"><div class="n ec"><div class="s bs rg rh ri"><div class="rj s"><h2 class="av aw rk rl ia rm rn ie ro rp ii rq rr im rs rt iq ea"><a rel="noopener" href="/adobetech/enabling-a-secure-by-requirement-approach-be53faf02635?source=post_internal_links---------7----------------------------">Enabling a “Secure by Requirement” Approach</a></h2></div><div class="o n"><div></div><div class="ak s"><div class="n"><div style="flex:1"><span class="av b ek el ea"><div class="cc n o en"><span class="av b fd el ea"><a class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener" href="/@cparkers?source=post_internal_links---------7----------------------------">Chris Parkerson</a><span> <!-- -->in<!-- --> <a href="/adobetech?source=post_internal_links---------7----------------------------" class="ep eq er es et eu ev ew bu ex ey ez fa fb" rel="noopener">Adobe Tech Blog</a></span></span></div></span></div></div></div></div></div><div class="ej gh s ru rv"><a class="ep eq er es et eu ev ew bu ex ge gf ez fa fb s" rel="noopener" href="/adobetech/enabling-a-secure-by-requirement-approach-be53faf02635?source=post_internal_links---------7----------------------------"><div class="jj s gr iy"><div class="rw jl s"><div class="je jf t u v jg ak az jh ji"><img class="t u v jg ak jm jn jo" src="https://miro.medium.com/max/60/1*1WAioB0Ul2qJdksfj9_GLg.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="je jf rx ry rz sa sb sc sd se sf sg c" width="70" height="70" role="presentation"/><noscript><img class="rx ry rz sa sb sc sd se sf sg" src="https://miro.medium.com/fit/c/140/140/1*1WAioB0Ul2qJdksfj9_GLg.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*1WAioB0Ul2qJdksfj9_GLg.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*1WAioB0Ul2qJdksfj9_GLg.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="sh s si sj"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="sk sl os n ec g"><div class="sm n ec"><div class="sn s so"><div class="rj s"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex sp sq ez sr ss" rel="noopener"><h2 class="av aw bo bp bg st">Learn more.</h2></a></div><p class="av b ek el su">Medium<!-- --> is an open platform where 170 million readers come to find insightful and dynamic thinking. Here, expert and undiscovered voices alike dive into the heart of any topic and bring new ideas to the surface.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex ez sr ss hu" rel="noopener">Learn more</a></p></div><div class="sn s so"><div class="rj s"><a href="https://medium.com/topics?source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex sp sq ez sr ss" rel="noopener"><h2 class="av aw bo bp bg st">Make <!-- -->Medium<!-- --> yours.</h2></a></div><p class="av b ek el su">Follow the writers, publications, and topics that matter to you, and you’ll see them on your homepage and in your inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex ez sr ss hu" rel="noopener">Explore</a></p></div><div class="sn s so"><div class="rj s"><a href="https://about.medium.com/creators/?source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex sp sq ez sr ss" rel="noopener"><h2 class="av aw bo bp bg st">Share your thinking.</h2></a></div><p class="av b ek el su">If you have a story to tell, knowledge to share, or a perspective to offer — welcome home. It’s easy and free to post your thinking on any topic.<!-- --> <a href="https://about.medium.com/creators/?source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex ez sr ss hu" rel="noopener">Write on <!-- -->Medium</a></p></div></div></div><div class="n lu"><div class="n o ec"><a href="https://medium.com/?source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex sp sq ez sr ss" rel="noopener"><svg viewBox="0 0 3940 610" class="fg sv"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="pn sw n ec sx an"><p class="av b jv bp st"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex ey ez sr ss" rel="noopener">About</a></p><p class="av b jv bp st"><a href="https://help.medium.com/hc/en-us?source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex ey ez sr ss" rel="noopener">Help</a></p><p class="av b jv bp st"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex ey ez sr ss" rel="noopener">Legal</a></p></div></div><div class="bk sy sz an"><p class="av b jv bp su">Get the Medium app</p></div><div class="bk sy ta an tb"><div class="tc s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex sp sq ez sr ss" rel="noopener nofollow"><img alt="A button that says &#x27;Download on the App Store&#x27;, and if clicked it will lead you to the iOS App store" class="" src="https://miro.medium.com/max/270/1*Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"/></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----60ccbb7dff96--------------------------------" class="ep eq er es et eu ev ew bu ex sp sq ez sr ss" rel="noopener nofollow"><img alt="A button that says &#x27;Get it on, Google Play&#x27;, and if clicked it will lead you to the Google Play store" class="" src="https://miro.medium.com/max/270/1*W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"/></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210521-194149-8205a38997"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":false},"bookReader":{"assets":{},"reader":{"currentAsset":null,"currentGFI":null,"settingsPanelIsOpen":false,"settings":{"fontFamily":"CHARTER","fontScale":"M","publisherStyling":true,"textAlignment":"start","theme":"White","lineSpacing":0,"wordSpacing":0,"letterSpacing":0},"internalNavCounter":0,"currentSelection":null,"highlights":[]}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-60ccbb7dff96","user-b9eaa7b7dd5c","collection-aa99595b7c"],"serverVariantState":"69990ad9e576e2e592f6369d095c931008141a17962207b6894c8903f6896bb9","middlewareEnabled":true,"cacheStatus":"DYNAMIC"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"routingEntity":{"type":"DEFAULT","explicit":false}},"debug":{"requestId":"41abb92f-e98c-4616-b3ad-a5dffcca1353","hybridDevServices":[],"showBookReaderDebugger":false,"originalSpanCarrier":{"ot-tracer-spanid":"39b7f5d1536e029f","ot-tracer-traceid":"674553f484ef5a61","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fthreatpunter\u002Fdetecting-removing-wmi-persistence-60ccbb7dff96","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"queryString":"","currentHash":""},"tracing":{},"config":{"nodeEnv":"production","version":"main-20210521-194149-8205a38997","isTaggedVersion":false,"target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210521-194149-8205a38997"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210521-194149-8205a38997","commit":"8205a389970795cdb2c37068f2062c807d740019"}},"datacenter":"us"},"googleAnalyticsCode":"UA-24232453-2","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium"},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl"},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","meterPost({\"postId\":\"60ccbb7dff96\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\",\"sk\":null,\"source\":null}})":{"__ref":"MeteringInfo:{}"},"postResult({\"id\":\"60ccbb7dff96\"})":{"__ref":"Post:60ccbb7dff96"}},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":0},"UserViewerEdge:userId:b9eaa7b7dd5c-viewerId:lo_c0f7a3dc0662":{"id":"userId:b9eaa7b7dd5c-viewerId:lo_c0f7a3dc0662","__typename":"UserViewerEdge","isAllowEdsEnabled":false,"isFollowing":false,"readPostsCount":0,"createdAt":0,"lastPostCreatedAt":0,"isBlocking":false,"isUser":false},"User:b9eaa7b7dd5c":{"id":"b9eaa7b7dd5c","__typename":"User","viewerIsUser":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:b9eaa7b7dd5c-viewerId:lo_c0f7a3dc0662"},"customStyleSheet":null,"isSuspended":false,"name":"David French","hasCompletedProfile":false,"bio":"Threat Hunting | Detection Engineering | Digital Forensics","imageId":"1*MlhCj6a-iXChdhWSaoUxeg.jpeg","username":"threatpunter","customDomainState":null,"isAuroraVisible":true,"mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":177,"followingCount":0},"hasSubdomain":false,"allowNotes":true,"newsletterV3":null,"twitterScreenName":"threatpunter","followedCollections":11,"atsQualifiedAt":1613380042188},"ImageMetadata:":{"id":"","__typename":"ImageMetadata","originalWidth":0,"originalHeight":0},"CollectionViewerEdge:collectionId:aa99595b7c-viewerId:lo_c0f7a3dc0662":{"id":"collectionId:aa99595b7c-viewerId:lo_c0f7a3dc0662","__typename":"CollectionViewerEdge","isEditor":false,"canEditOwnPosts":false,"canEditPosts":false,"isFollowing":false},"ImageMetadata:1*51cURBhf0Pw5BQuCmndliQ.png":{"id":"1*51cURBhf0Pw5BQuCmndliQ.png","__typename":"ImageMetadata"},"Collection:aa99595b7c":{"id":"aa99595b7c","__typename":"Collection","domain":null,"googleAnalyticsId":null,"slug":"threatpunter","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","isAuroraVisible":false,"favicon":{"__ref":"ImageMetadata:"},"name":"Threat Punter","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFE8F6FA","point":0},{"__typename":"ColorPoint","color":"#FFE4F4FA","point":0.1},{"__typename":"ColorPoint","color":"#FFE0F3FA","point":0.2},{"__typename":"ColorPoint","color":"#FFDBF2FA","point":0.3},{"__typename":"ColorPoint","color":"#FFD7F1FA","point":0.4},{"__typename":"ColorPoint","color":"#FFD2F0F9","point":0.5},{"__typename":"ColorPoint","color":"#FFCDEEF9","point":0.6},{"__typename":"ColorPoint","color":"#FFC9EDF9","point":0.7},{"__typename":"ColorPoint","color":"#FFC4ECF9","point":0.8},{"__typename":"ColorPoint","color":"#FFBFEBF9","point":0.9},{"__typename":"ColorPoint","color":"#FFBAEAF9","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF5090A2","point":0},{"__typename":"ColorPoint","color":"#FF4D8696","point":0.1},{"__typename":"ColorPoint","color":"#FF497B8A","point":0.2},{"__typename":"ColorPoint","color":"#FF45707D","point":0.3},{"__typename":"ColorPoint","color":"#FF406571","point":0.4},{"__typename":"ColorPoint","color":"#FF3B5A64","point":0.5},{"__typename":"ColorPoint","color":"#FF354F57","point":0.6},{"__typename":"ColorPoint","color":"#FF2E4349","point":0.7},{"__typename":"ColorPoint","color":"#FF26373C","point":0.8},{"__typename":"ColorPoint","color":"#FF1D2A2D","point":0.9},{"__typename":"ColorPoint","color":"#FF131C1E","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF438496","colorPoints":[{"__typename":"ColorPoint","color":"#FF438496","point":0},{"__typename":"ColorPoint","color":"#FF5992A3","point":0.1},{"__typename":"ColorPoint","color":"#FF6DA0AF","point":0.2},{"__typename":"ColorPoint","color":"#FF80ADBB","point":0.3},{"__typename":"ColorPoint","color":"#FF93BAC6","point":0.4},{"__typename":"ColorPoint","color":"#FFA4C6D1","point":0.5},{"__typename":"ColorPoint","color":"#FFB6D3DC","point":0.6},{"__typename":"ColorPoint","color":"#FFC7DFE7","point":0.7},{"__typename":"ColorPoint","color":"#FFD7EAF1","point":0.8},{"__typename":"ColorPoint","color":"#FFE7F6FB","point":0.9},{"__typename":"ColorPoint","color":"#FFF7FFFF","point":1}]}},"customStyleSheet":null,"tagline":"Threat Hunting | Threat Detection | Digital Forensics","isAuroraEligible":false,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:aa99595b7c-viewerId:lo_c0f7a3dc0662"},"logo":{"__ref":"ImageMetadata:"},"navItems":[],"creator":{"__ref":"User:b9eaa7b7dd5c"},"subscriberCount":236,"avatar":{"__ref":"ImageMetadata:1*51cURBhf0Pw5BQuCmndliQ.png"},"newsletterV3":null,"canToggleEmail":false,"description":"Threat Hunting | Threat Detection | Digital Forensics","ampEnabled":false,"twitterUsername":"threatpunter","facebookPageId":null,"customDomainState":null,"ptsQualifiedAt":0},"PostViewerEdge:postId:60ccbb7dff96-viewerId:lo_c0f7a3dc0662":{"id":"postId:60ccbb7dff96-viewerId:lo_c0f7a3dc0662","__typename":"PostViewerEdge","readingList":"READING_LIST_NONE","clapCount":0,"creatorPartnerProgramEnrollmentStatus":"PERMISSION_DENIED","shareKey":null},"Paragraph:82fd49a492df_0":{"id":"82fd49a492df_0","__typename":"Paragraph","name":"4230","text":"Detecting & Removing an Attacker’s WMI Persistence","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_1":{"id":"82fd49a492df_1","__typename":"Paragraph","name":"6da9","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Qxa02RcVVLc4L79Q"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_2":{"id":"82fd49a492df_2","__typename":"Paragraph","name":"f4f8","text":"Windows Management Instrumentation (WMI) Event Subscription is a popular technique to establish persistence on an endpoint. I decided to spend some time playing with Empire’s WMI modules and analyzing the artifacts for detection opportunities. I also reviewed the PowerShell commands that can be used to view and remove WMI event subscriptions.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":166,"end":174,"type":"A","href":"https:\u002F\u002Fgithub.com\u002FEmpireProject\u002FEmpire","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_3":{"id":"82fd49a492df_3","__typename":"Paragraph","name":"0a28","text":"“Windows Management Instrumentation Event Subscription” is MITRE ATT&CK Technique T1084.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":82,"end":87,"type":"A","href":"https:\u002F\u002Fattack.mitre.org\u002Fwiki\u002FTechnique\u002FT1084","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_4":{"id":"82fd49a492df_4","__typename":"Paragraph","name":"541c","text":"Attackers may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_5":{"id":"82fd49a492df_5","__typename":"Paragraph","name":"a372","text":"What is WMI?","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_6":{"id":"82fd49a492df_6","__typename":"Paragraph","name":"0300","text":"“WMI is the Microsoft implementation of Web-Based Enterprise Management (WBEM), which is an industry initiative to develop a standard technology for accessing management information in an enterprise environment. WMI uses the Common Information Model (CIM) industry standard to represent systems, applications, networks, devices, and other managed components.”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":1,"end":4,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fdesktop\u002Fwmisdk\u002Fabout-wmi","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_7":{"id":"82fd49a492df_7","__typename":"Paragraph","name":"375d","text":"An event filter is a WMI class that describes which events WMI delivers to an event consumer. An event filter also describes the conditions under which WMI delivers the events.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":3,"end":15,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fdesktop\u002Fwmisdk\u002Fcreating-an-event-filter","anchorType":"LINK","userId":"","linkMetadata":null},{"__typename":"Markup","start":3,"end":15,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null},{"__typename":"Markup","start":78,"end":92,"type":"STRONG","href":"","anchorType":"LINK","userId":"","linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_8":{"id":"82fd49a492df_8","__typename":"Paragraph","name":"6788","text":"Configuring Sysmon Logging","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_9":{"id":"82fd49a492df_9","__typename":"Paragraph","name":"c0ff","text":"Sysmon can be configured to log WmiEventFilter, WmiEventConsumer, and WmiEventConsumerToFilter activity and enable the detection of WMI abuse.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":32,"end":46,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":48,"end":64,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":70,"end":94,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":6,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsysinternals\u002Fdownloads\u002Fsysmon","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_10":{"id":"82fd49a492df_10","__typename":"Paragraph","name":"afaa","text":"Sysmon Event IDs for WMI activity","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*b5Gvr4xP7PLpVKxm26klRA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_11":{"id":"82fd49a492df_11","__typename":"Paragraph","name":"542f","text":"Roberto Rodriguez’s (@Cyb3rWard0g) Sysmon configuration file will capture the above Event IDs.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":21,"end":33,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002FCyb3rWard0g","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":35,"end":60,"type":"A","href":"https:\u002F\u002Fgist.github.com\u002FCyb3rWard0g\u002F136481552d8845e52962534d1a4b8664","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":21,"end":22,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_12":{"id":"82fd49a492df_12","__typename":"Paragraph","name":"0736","text":"Execute the following command to install Sysmon and apply a configuration file.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_13":{"id":"82fd49a492df_13","__typename":"Paragraph","name":"46c5","text":"sysmon.exe -i -c .\\config_file.xml ","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_14":{"id":"82fd49a492df_14","__typename":"Paragraph","name":"407d","text":"Establish Persistence","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_15":{"id":"82fd49a492df_15","__typename":"Paragraph","name":"240c","text":"Let’s use Empire’s Invoke-WMI module to create a permanent WMI subscription and persist a stager on the victim endpoint.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":19,"end":29,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_16":{"id":"82fd49a492df_16","__typename":"Paragraph","name":"9f0e","text":"Reviewing Empire’s WMI-related modules","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JRCFX-PCSzIPOe76Pft5Qw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_17":{"id":"82fd49a492df_17","__typename":"Paragraph","name":"ff42","text":"Reviewing the options for Empire’s Invoke-WMI module","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vl8S6lxvFBdCtlfWWZrHYA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_18":{"id":"82fd49a492df_18","__typename":"Paragraph","name":"9a88","text":"Running the module","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9Gs6vM3l1q6ElpAOy5vTEA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_19":{"id":"82fd49a492df_19","__typename":"Paragraph","name":"493f","text":"Detection","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_20":{"id":"82fd49a492df_20","__typename":"Paragraph","name":"8d29","text":"Reviewing the Sysmon logs we can see that the Empire module:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_21":{"id":"82fd49a492df_21","__typename":"Paragraph","name":"6f2e","text":"Registered a WMI event filter","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_22":{"id":"82fd49a492df_22","__typename":"Paragraph","name":"6828","text":"Registered a WMI event consumer","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_23":{"id":"82fd49a492df_23","__typename":"Paragraph","name":"751b","text":"Bound the event consumer to the event filter","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_24":{"id":"82fd49a492df_24","__typename":"Paragraph","name":"de4c","text":"Sysmon events logged after Empire Invoke-WMI module execution","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*cfqTB5-ka63ohhgTqcu52A.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_25":{"id":"82fd49a492df_25","__typename":"Paragraph","name":"01ed","text":"The WMI event filter sets the conditions for the stager to execute, which includes references to the system’s uptime.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_26":{"id":"82fd49a492df_26","__typename":"Paragraph","name":"be76","text":"Sysmon Event ID 19: WmiEvent (WmiEventFilter activity detected)","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*EofnbAOSB1mr8odnUSg_cQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_27":{"id":"82fd49a492df_27","__typename":"Paragraph","name":"5915","text":"The WMI event consumer contains the Empire stager in Base64-encoded form and is registered with the innocuous name, Updater when its default settings are used.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":116,"end":123,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_28":{"id":"82fd49a492df_28","__typename":"Paragraph","name":"ed7d","text":"Sysmon Event ID 20: WmiEvent (WmiEventConsumer activity detected)","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*f5j1NV-BVvQmsglYoQ3Tfw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_29":{"id":"82fd49a492df_29","__typename":"Paragraph","name":"0eef","text":"The WMI event consumer CommandLineEventConsumer.Name=\\”Updater\\\" is bound to the event filter __EventFilter.Name=\\”Updater\\”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":23,"end":64,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":94,"end":124,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_30":{"id":"82fd49a492df_30","__typename":"Paragraph","name":"09bc","text":"Sysmon Event ID 21: WmiEvent (WmiEventConsumerToFilter activity detected)","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Ql2SRtWXie8iycEJ-AQ_Rw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_31":{"id":"82fd49a492df_31","__typename":"Paragraph","name":"58d2","text":"Now that the event consumer is bound to the event filter, IF the event filter conditions are true THEN trigger the event consumer (the stager).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":58,"end":60,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":98,"end":102,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_32":{"id":"82fd49a492df_32","__typename":"Paragraph","name":"b815","text":"Eradication","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_33":{"id":"82fd49a492df_33","__typename":"Paragraph","name":"b1fe","text":"The simplest method to remove the entry from the WMI database is to use Autoruns. Launch Autoruns as an administrator and select the WMI tab to review WMI-related persistence.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":133,"end":136,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":72,"end":80,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsysinternals\u002Fdownloads\u002Fautoruns","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_34":{"id":"82fd49a492df_34","__typename":"Paragraph","name":"6f48","text":"Using Autoruns to review WMI database entries","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*HrM52HnYVK7UH3DQGYykGg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_35":{"id":"82fd49a492df_35","__typename":"Paragraph","name":"54bf","text":"Using Autoruns to review content of the WMI database","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*UjaSX9LZkS1CX_OzVIoCPg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_36":{"id":"82fd49a492df_36","__typename":"Paragraph","name":"8da1","text":"Right-click the malicious WMI database entry and select Delete.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":56,"end":62,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_37":{"id":"82fd49a492df_37","__typename":"Paragraph","name":"8051","text":"Alternatively, you can remove the WMI event subscriptions from the command line.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_38":{"id":"82fd49a492df_38","__typename":"Paragraph","name":"ceba","text":"Use Get-WMIObject in PowerShell to review the WMI event filter, event consumer, and consumer filter to event filter binding. Thanks to Boe Prox (@proxb) for explaining these commands in detail on his blog.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":4,"end":17,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":145,"end":151,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002Fproxb","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":196,"end":204,"type":"A","href":"https:\u002F\u002Flearn-powershell.net\u002F2013\u002F08\u002F14\u002Fpowershell-and-events-permanent-wmi-event-subscriptions\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_39":{"id":"82fd49a492df_39","__typename":"Paragraph","name":"ff81","text":"# Reviewing WMI Subscriptions using Get-WMIObject\n# Event Filter\nGet-WMIObject -Namespace root\\Subscription -Class __EventFilter -Filter “Name=’Updater’”","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_40":{"id":"82fd49a492df_40","__typename":"Paragraph","name":"dd04","text":"# Event Consumer\nGet-WMIObject -Namespace root\\Subscription -Class CommandLineEventConsumer -Filter “Name=’Updater’”\n \n# Binding\nGet-WMIObject -Namespace root\\Subscription -Class __FilterToConsumerBinding -Filter “__Path LIKE ‘%Updater%’”","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_41":{"id":"82fd49a492df_41","__typename":"Paragraph","name":"079c","text":"Use Remove-WMIObject to remove all components of the WMI persistence.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":4,"end":20,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:82fd49a492df_42":{"id":"82fd49a492df_42","__typename":"Paragraph","name":"ec6a","text":"# Removing WMI Subscriptions using Remove-WMIObject\n# Event Filter\nGet-WMIObject -Namespace root\\Subscription -Class __EventFilter -Filter “Name=’Updater’” | Remove-WmiObject -Verbose","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_43":{"id":"82fd49a492df_43","__typename":"Paragraph","name":"fcd7","text":"# Event Consumer\nGet-WMIObject -Namespace root\\Subscription -Class CommandLineEventConsumer -Filter “Name=’Updater’” | Remove-WmiObject -Verbose\n \n# Binding\nGet-WMIObject -Namespace root\\Subscription -Class __FilterToConsumerBinding -Filter “__Path LIKE ‘%Updater%’” | Remove-WmiObject -Verbose","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_44":{"id":"82fd49a492df_44","__typename":"Paragraph","name":"44bb","text":"Removing WMI event subscriptions","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0N2vYQPq1uo83m_15djMdA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_45":{"id":"82fd49a492df_45","__typename":"Paragraph","name":"90cb","text":"Run Autoruns again to verify that the persistence was removed.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:82fd49a492df_46":{"id":"82fd49a492df_46","__typename":"Paragraph","name":"4ce6","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xux-iys417DB89mNZC7RKw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"ImageMetadata:0*Qxa02RcVVLc4L79Q":{"id":"0*Qxa02RcVVLc4L79Q","__typename":"ImageMetadata","originalHeight":2828,"originalWidth":4242,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*b5Gvr4xP7PLpVKxm26klRA.png":{"id":"1*b5Gvr4xP7PLpVKxm26klRA.png","__typename":"ImageMetadata","originalHeight":606,"originalWidth":1766,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*JRCFX-PCSzIPOe76Pft5Qw.png":{"id":"1*JRCFX-PCSzIPOe76Pft5Qw.png","__typename":"ImageMetadata","originalHeight":529,"originalWidth":1772,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*vl8S6lxvFBdCtlfWWZrHYA.png":{"id":"1*vl8S6lxvFBdCtlfWWZrHYA.png","__typename":"ImageMetadata","originalHeight":1893,"originalWidth":2219,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*9Gs6vM3l1q6ElpAOy5vTEA.png":{"id":"1*9Gs6vM3l1q6ElpAOy5vTEA.png","__typename":"ImageMetadata","originalHeight":200,"originalWidth":2084,"focusPercentX":-1,"focusPercentY":-1,"alt":""},"ImageMetadata:1*cfqTB5-ka63ohhgTqcu52A.png":{"id":"1*cfqTB5-ka63ohhgTqcu52A.png","__typename":"ImageMetadata","originalHeight":381,"originalWidth":2060,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*EofnbAOSB1mr8odnUSg_cQ.png":{"id":"1*EofnbAOSB1mr8odnUSg_cQ.png","__typename":"ImageMetadata","originalHeight":488,"originalWidth":2166,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*f5j1NV-BVvQmsglYoQ3Tfw.png":{"id":"1*f5j1NV-BVvQmsglYoQ3Tfw.png","__typename":"ImageMetadata","originalHeight":688,"originalWidth":2192,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*Ql2SRtWXie8iycEJ-AQ_Rw.png":{"id":"1*Ql2SRtWXie8iycEJ-AQ_Rw.png","__typename":"ImageMetadata","originalHeight":356,"originalWidth":1728,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*HrM52HnYVK7UH3DQGYykGg.png":{"id":"1*HrM52HnYVK7UH3DQGYykGg.png","__typename":"ImageMetadata","originalHeight":442,"originalWidth":2696,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*UjaSX9LZkS1CX_OzVIoCPg.png":{"id":"1*UjaSX9LZkS1CX_OzVIoCPg.png","__typename":"ImageMetadata","originalHeight":268,"originalWidth":3360,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*0N2vYQPq1uo83m_15djMdA.png":{"id":"1*0N2vYQPq1uo83m_15djMdA.png","__typename":"ImageMetadata","originalHeight":546,"originalWidth":2945,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*xux-iys417DB89mNZC7RKw.png":{"id":"1*xux-iys417DB89mNZC7RKw.png","__typename":"ImageMetadata","originalHeight":496,"originalWidth":2365,"focusPercentX":null,"focusPercentY":null,"alt":null},"Tag:threat-hunting":{"id":"threat-hunting","__typename":"Tag","displayTitle":"Threat Hunting","normalizedTagSlug":""},"Tag:threat-detection":{"id":"threat-detection","__typename":"Tag","displayTitle":"Threat Detection","normalizedTagSlug":""},"Tag:cybersecurity":{"id":"cybersecurity","__typename":"Tag","displayTitle":"Cybersecurity","normalizedTagSlug":""},"Tag:persistence":{"id":"persistence","__typename":"Tag","displayTitle":"Persistence","normalizedTagSlug":""},"ImageMetadata:0*WEFGk4rjOa3x19v8":{"id":"0*WEFGk4rjOa3x19v8","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:24d8f4fa8912":{"id":"24d8f4fa8912","__typename":"Collection","name":"Nerd For Tech","domain":null,"slug":"nerd-for-tech"},"UserViewerEdge:userId:e4b53b0c695f-viewerId:lo_c0f7a3dc0662":{"id":"userId:e4b53b0c695f-viewerId:lo_c0f7a3dc0662","__typename":"UserViewerEdge","isFollowing":false},"User:e4b53b0c695f":{"id":"e4b53b0c695f","__typename":"User","name":"Himanshu Tyagi","username":"himtyagi","bio":"Love to write on the topics of programming, data science, and cloud communications: https:\u002F\u002Fwww.codeitbro.com\u002F and https:\u002F\u002Fwww.himtyagi.com\u002F","imageId":"2*XKY8VMi1n-6otJOUc3qHbg.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"himtyagi.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:e4b53b0c695f-viewerId:lo_c0f7a3dc0662"}},"Post:be0de8df0532":{"id":"be0de8df0532","__typename":"Post","title":"Do You Know Your Cyber Risk Score?","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fnerd-for-tech\u002Fdo-you-know-your-cyber-risk-score-be0de8df0532","previewImage":{"__ref":"ImageMetadata:0*WEFGk4rjOa3x19v8"},"isPublished":true,"firstPublishedAt":1613263044513,"readingTime":4.250943396226415,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:24d8f4fa8912"},"creator":{"__ref":"User:e4b53b0c695f"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*iBZM5hvnXRvelyJ0E1KRig.png":{"id":"1*iBZM5hvnXRvelyJ0E1KRig.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:888fdcf1d60":{"id":"888fdcf1d60","__typename":"Collection","name":"IOCSCAN","domain":null,"slug":"iocscan"},"UserViewerEdge:userId:57fb76e9d343-viewerId:lo_c0f7a3dc0662":{"id":"userId:57fb76e9d343-viewerId:lo_c0f7a3dc0662","__typename":"UserViewerEdge","isFollowing":false},"User:57fb76e9d343":{"id":"57fb76e9d343","__typename":"User","name":"Christopher Makarem","username":"x24mak","bio":"","imageId":"0*ymNIEzTWSsnbLs-p","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:57fb76e9d343-viewerId:lo_c0f7a3dc0662"}},"Post:bea939b5afaf":{"id":"bea939b5afaf","__typename":"Post","title":"DNS Cache Poisoning","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fiocscan\u002Fdns-cache-poisoning-bea939b5afaf","previewImage":{"__ref":"ImageMetadata:1*iBZM5hvnXRvelyJ0E1KRig.png"},"isPublished":true,"firstPublishedAt":1544762918833,"readingTime":4.481446540880504,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:888fdcf1d60"},"creator":{"__ref":"User:57fb76e9d343"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*Z7p-OTp2imOZ3N1DezQLRw.jpeg":{"id":"1*Z7p-OTp2imOZ3N1DezQLRw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:3a8144eabfe3":{"id":"3a8144eabfe3","__typename":"Collection","name":"HackerNoon.com","domain":null,"slug":"hackernoon"},"UserViewerEdge:userId:8112e2395028-viewerId:lo_c0f7a3dc0662":{"id":"userId:8112e2395028-viewerId:lo_c0f7a3dc0662","__typename":"UserViewerEdge","isFollowing":false},"User:8112e2395028":{"id":"8112e2395028","__typename":"User","name":"David Balaban","username":"david.w.balaban","bio":"David Balaban is a computer security researcher with over 15 years of experience in malware analysis and antivirus software.","imageId":"1*6DpiCKSS_8X0fuU1w07Llg.jpeg","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:8112e2395028-viewerId:lo_c0f7a3dc0662"}},"Post:be70a760a5f":{"id":"be70a760a5f","__typename":"Post","title":"Why Does a Coffee Machine Need Its Own Account?","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fhackernoon\u002Fwhy-does-a-coffee-machine-need-its-own-account-be70a760a5f","previewImage":{"__ref":"ImageMetadata:1*Z7p-OTp2imOZ3N1DezQLRw.jpeg"},"isPublished":true,"firstPublishedAt":1536759311689,"readingTime":3.7132075471698114,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:3a8144eabfe3"},"creator":{"__ref":"User:8112e2395028"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*6mItxq_7zX4uv2yJ3q6JlQ.png":{"id":"1*6mItxq_7zX4uv2yJ3q6JlQ.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:2002df67af84":{"id":"2002df67af84","__typename":"Collection","name":"Baidu Security X-Lab","domain":null,"slug":"baiduxlab"},"UserViewerEdge:userId:1b8ec2a2d350-viewerId:lo_c0f7a3dc0662":{"id":"userId:1b8ec2a2d350-viewerId:lo_c0f7a3dc0662","__typename":"UserViewerEdge","isFollowing":false},"User:1b8ec2a2d350":{"id":"1b8ec2a2d350","__typename":"User","name":"Baidu Security X-Lab","username":"baidu.xlab","bio":"Security never sleeps","imageId":"1*MU4sMwu4XVlHhGGo-9Wkfg.png","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:1b8ec2a2d350-viewerId:lo_c0f7a3dc0662"}},"Post:be3dce8d1e92":{"id":"be3dce8d1e92","__typename":"Post","title":"PC security facing another “heavy hammer”, Baidu Security discovers a new Rowhammer attack","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fbaiduxlab\u002Fpc-security-facing-another-heavy-hammer-baidu-security-discovers-a-new-rowhammer-attack-be3dce8d1e92","previewImage":{"__ref":"ImageMetadata:1*6mItxq_7zX4uv2yJ3q6JlQ.png"},"isPublished":true,"firstPublishedAt":1556155381617,"readingTime":6.330503144654088,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:2002df67af84"},"creator":{"__ref":"User:1b8ec2a2d350"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*frbJ5rHvSQqszIdNGDmXyw.jpeg":{"id":"1*frbJ5rHvSQqszIdNGDmXyw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:f42947bffb0f-viewerId:lo_c0f7a3dc0662":{"id":"userId:f42947bffb0f-viewerId:lo_c0f7a3dc0662","__typename":"UserViewerEdge","isFollowing":false},"User:f42947bffb0f":{"id":"f42947bffb0f","__typename":"User","name":"ReadWrite","username":"rww","bio":"The latest #news, analysis, and conversation on the #InternetOfThings","imageId":"0*jR2dI8fezO9-Ndbf.jpg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"rww.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:f42947bffb0f-viewerId:lo_c0f7a3dc0662"}},"Post:beeb9a6d1459":{"id":"beeb9a6d1459","__typename":"Post","title":"The Key Issues That Stand Between Us and the Future of the Internet","mediumUrl":"https:\u002F\u002Frww.medium.com\u002Fthe-key-issues-that-stand-between-us-and-the-future-of-the-internet-beeb9a6d1459","previewImage":{"__ref":"ImageMetadata:1*frbJ5rHvSQqszIdNGDmXyw.jpeg"},"isPublished":true,"firstPublishedAt":1619713260014,"readingTime":5.30188679245283,"statusForCollection":null,"isLocked":false,"visibility":"PUBLIC","collection":null,"creator":{"__ref":"User:f42947bffb0f"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*s4UFOw-mAiGaeQrF.png":{"id":"0*s4UFOw-mAiGaeQrF.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:f5af2b715248":{"id":"f5af2b715248","__typename":"Collection","name":"The Startup","domain":null,"slug":"swlh"},"UserViewerEdge:userId:871f2599811b-viewerId:lo_c0f7a3dc0662":{"id":"userId:871f2599811b-viewerId:lo_c0f7a3dc0662","__typename":"UserViewerEdge","isFollowing":false},"User:871f2599811b":{"id":"871f2599811b","__typename":"User","name":"Vickie Li","username":"vickieli","bio":"Professional investigator of nerdy stuff. Hacks and secures. Creates god awful infographics. https:\u002F\u002Ftwitter.com\u002Fvickieli7","imageId":"2*pAMQ3POj0h1mZUA5za-6sg.png","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"vickieli.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:871f2599811b-viewerId:lo_c0f7a3dc0662"}},"Post:beb35857771f":{"id":"beb35857771f","__typename":"Post","title":"Intro to SSRF","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fswlh\u002Fintro-to-ssrf-beb35857771f","previewImage":{"__ref":"ImageMetadata:0*s4UFOw-mAiGaeQrF.png"},"isPublished":true,"firstPublishedAt":1559588199000,"readingTime":4.576729559748427,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f5af2b715248"},"creator":{"__ref":"User:871f2599811b"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*CMflG4Br-l9smE9B_eOd7g.jpeg":{"id":"1*CMflG4Br-l9smE9B_eOd7g.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:f3391f89617d-viewerId:lo_c0f7a3dc0662":{"id":"userId:f3391f89617d-viewerId:lo_c0f7a3dc0662","__typename":"UserViewerEdge","isFollowing":false},"User:f3391f89617d":{"id":"f3391f89617d","__typename":"User","name":"Emilio Escobar","username":"eescobar","bio":"Information security professional, CISO at Datadog, and Ettercap developer. Building pragmatic security programs and hoping to improve diversity and inclusion.","imageId":"1*VJiriJ27WY-_cF9sFoqK2w.jpeg","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:f3391f89617d-viewerId:lo_c0f7a3dc0662"}},"Post:be57f4f3dcd7":{"id":"be57f4f3dcd7","__typename":"Post","title":"My Security Leadership Journey So Far","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@eescobar\u002Fmy-security-leadership-journey-so-far-be57f4f3dcd7","previewImage":{"__ref":"ImageMetadata:1*CMflG4Br-l9smE9B_eOd7g.jpeg"},"isPublished":true,"firstPublishedAt":1568840181765,"readingTime":6.278301886792453,"statusForCollection":null,"isLocked":true,"visibility":"LOCKED","collection":null,"creator":{"__ref":"User:f3391f89617d"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*1WAioB0Ul2qJdksfj9_GLg.jpeg":{"id":"1*1WAioB0Ul2qJdksfj9_GLg.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:9342990108af":{"id":"9342990108af","__typename":"Collection","name":"Adobe Tech Blog","domain":null,"slug":"adobetech"},"UserViewerEdge:userId:e2826ed0ce19-viewerId:lo_c0f7a3dc0662":{"id":"userId:e2826ed0ce19-viewerId:lo_c0f7a3dc0662","__typename":"UserViewerEdge","isFollowing":false},"User:e2826ed0ce19":{"id":"e2826ed0ce19","__typename":"User","name":"Chris Parkerson","username":"cparkers","bio":"Marketing lead for the Adobe Corporate Security Team | Focus on the customer & make it happen | Foodie & cook | Gamer | Persistent wanderlust","imageId":"1*_lCXy09QTCyvOoXLCN75DA.jpeg","mediumMemberAt":1613594848000,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:e2826ed0ce19-viewerId:lo_c0f7a3dc0662"}},"Post:be53faf02635":{"id":"be53faf02635","__typename":"Post","title":"Enabling a “Secure by Requirement” Approach","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fadobetech\u002Fenabling-a-secure-by-requirement-approach-be53faf02635","previewImage":{"__ref":"ImageMetadata:1*1WAioB0Ul2qJdksfj9_GLg.jpeg"},"isPublished":true,"firstPublishedAt":1620320247870,"readingTime":3.290566037735849,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:9342990108af"},"creator":{"__ref":"User:e2826ed0ce19"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"Post:60ccbb7dff96":{"id":"60ccbb7dff96","__typename":"Post","creator":{"__ref":"User:b9eaa7b7dd5c"},"canonicalUrl":"","collection":{"__ref":"Collection:aa99595b7c"},"content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\",\"sk\":null,\"source\":null}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:82fd49a492df_0"},{"__ref":"Paragraph:82fd49a492df_1"},{"__ref":"Paragraph:82fd49a492df_2"},{"__ref":"Paragraph:82fd49a492df_3"},{"__ref":"Paragraph:82fd49a492df_4"},{"__ref":"Paragraph:82fd49a492df_5"},{"__ref":"Paragraph:82fd49a492df_6"},{"__ref":"Paragraph:82fd49a492df_7"},{"__ref":"Paragraph:82fd49a492df_8"},{"__ref":"Paragraph:82fd49a492df_9"},{"__ref":"Paragraph:82fd49a492df_10"},{"__ref":"Paragraph:82fd49a492df_11"},{"__ref":"Paragraph:82fd49a492df_12"},{"__ref":"Paragraph:82fd49a492df_13"},{"__ref":"Paragraph:82fd49a492df_14"},{"__ref":"Paragraph:82fd49a492df_15"},{"__ref":"Paragraph:82fd49a492df_16"},{"__ref":"Paragraph:82fd49a492df_17"},{"__ref":"Paragraph:82fd49a492df_18"},{"__ref":"Paragraph:82fd49a492df_19"},{"__ref":"Paragraph:82fd49a492df_20"},{"__ref":"Paragraph:82fd49a492df_21"},{"__ref":"Paragraph:82fd49a492df_22"},{"__ref":"Paragraph:82fd49a492df_23"},{"__ref":"Paragraph:82fd49a492df_24"},{"__ref":"Paragraph:82fd49a492df_25"},{"__ref":"Paragraph:82fd49a492df_26"},{"__ref":"Paragraph:82fd49a492df_27"},{"__ref":"Paragraph:82fd49a492df_28"},{"__ref":"Paragraph:82fd49a492df_29"},{"__ref":"Paragraph:82fd49a492df_30"},{"__ref":"Paragraph:82fd49a492df_31"},{"__ref":"Paragraph:82fd49a492df_32"},{"__ref":"Paragraph:82fd49a492df_33"},{"__ref":"Paragraph:82fd49a492df_34"},{"__ref":"Paragraph:82fd49a492df_35"},{"__ref":"Paragraph:82fd49a492df_36"},{"__ref":"Paragraph:82fd49a492df_37"},{"__ref":"Paragraph:82fd49a492df_38"},{"__ref":"Paragraph:82fd49a492df_39"},{"__ref":"Paragraph:82fd49a492df_40"},{"__ref":"Paragraph:82fd49a492df_41"},{"__ref":"Paragraph:82fd49a492df_42"},{"__ref":"Paragraph:82fd49a492df_43"},{"__ref":"Paragraph:82fd49a492df_44"},{"__ref":"Paragraph:82fd49a492df_45"},{"__ref":"Paragraph:82fd49a492df_46"}],"sections":[{"__typename":"Section","name":"33a5","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"customStyleSheet":null,"firstPublishedAt":1539086654384,"isLocked":false,"isPublished":true,"isShortform":false,"layerCake":0,"primaryTopic":null,"viewerEdge":{"__ref":"PostViewerEdge:postId:60ccbb7dff96-viewerId:lo_c0f7a3dc0662"},"title":"Detecting & Removing WMI Persistence","isMarkedPaywallOnly":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fthreatpunter\u002Fdetecting-removing-wmi-persistence-60ccbb7dff96","isLimitedState":false,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:threat-detection"},{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:persistence"}],"topics":[{"__typename":"Topic","topicId":"d4e7f4144ac5","name":"Cybersecurity"},{"__typename":"Topic","topicId":"decb52b64abf","name":"Programming"}],"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","noIndex":null,"curationStatus":null,"metaDescription":"","latestPublishedAt":1539118977646,"readingTime":3.509433962264151,"previewContent":{"__typename":"PreviewContent","subtitle":"Windows Management Instrumentation (WMI) Event Subscription is a popular technique to establish persistence on an endpoint. I decided to…"},"previewImage":{"__ref":"ImageMetadata:0*Qxa02RcVVLc4L79Q"},"clapCount":75,"lockedSource":"LOCKED_POST_SOURCE_NONE","isSuspended":false,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":0,"responseDistribution":"NOT_DISTRIBUTED","internalLinks({\"paging\":{\"limit\":8}})":{"__typename":"InternalLinksConnection","items":[{"__ref":"Post:be0de8df0532"},{"__ref":"Post:bea939b5afaf"},{"__ref":"Post:be70a760a5f"},{"__ref":"Post:be3dce8d1e92"},{"__ref":"Post:beeb9a6d1459"},{"__ref":"Post:beb35857771f"},{"__ref":"Post:be57f4f3dcd7"},{"__ref":"Post:be53faf02635"}]},"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"audioVersionUrl":"","seoTitle":"","updatedAt":1539118977646,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":0},"latestPublishedVersion":"82fd49a492df","isPublishToEmail":false,"voterCount":22,"recommenders":[],"content({})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:82fd49a492df_0"},{"__ref":"Paragraph:82fd49a492df_1"},{"__ref":"Paragraph:82fd49a492df_2"},{"__ref":"Paragraph:82fd49a492df_3"},{"__ref":"Paragraph:82fd49a492df_4"},{"__ref":"Paragraph:82fd49a492df_5"},{"__ref":"Paragraph:82fd49a492df_6"},{"__ref":"Paragraph:82fd49a492df_7"},{"__ref":"Paragraph:82fd49a492df_8"},{"__ref":"Paragraph:82fd49a492df_9"},{"__ref":"Paragraph:82fd49a492df_10"},{"__ref":"Paragraph:82fd49a492df_11"},{"__ref":"Paragraph:82fd49a492df_12"},{"__ref":"Paragraph:82fd49a492df_13"},{"__ref":"Paragraph:82fd49a492df_14"},{"__ref":"Paragraph:82fd49a492df_15"},{"__ref":"Paragraph:82fd49a492df_16"},{"__ref":"Paragraph:82fd49a492df_17"},{"__ref":"Paragraph:82fd49a492df_18"},{"__ref":"Paragraph:82fd49a492df_19"},{"__ref":"Paragraph:82fd49a492df_20"},{"__ref":"Paragraph:82fd49a492df_21"},{"__ref":"Paragraph:82fd49a492df_22"},{"__ref":"Paragraph:82fd49a492df_23"},{"__ref":"Paragraph:82fd49a492df_24"},{"__ref":"Paragraph:82fd49a492df_25"},{"__ref":"Paragraph:82fd49a492df_26"},{"__ref":"Paragraph:82fd49a492df_27"},{"__ref":"Paragraph:82fd49a492df_28"},{"__ref":"Paragraph:82fd49a492df_29"},{"__ref":"Paragraph:82fd49a492df_30"},{"__ref":"Paragraph:82fd49a492df_31"},{"__ref":"Paragraph:82fd49a492df_32"},{"__ref":"Paragraph:82fd49a492df_33"},{"__ref":"Paragraph:82fd49a492df_34"},{"__ref":"Paragraph:82fd49a492df_35"},{"__ref":"Paragraph:82fd49a492df_36"},{"__ref":"Paragraph:82fd49a492df_37"},{"__ref":"Paragraph:82fd49a492df_38"},{"__ref":"Paragraph:82fd49a492df_39"},{"__ref":"Paragraph:82fd49a492df_40"},{"__ref":"Paragraph:82fd49a492df_41"},{"__ref":"Paragraph:82fd49a492df_42"},{"__ref":"Paragraph:82fd49a492df_43"},{"__ref":"Paragraph:82fd49a492df_44"},{"__ref":"Paragraph:82fd49a492df_45"},{"__ref":"Paragraph:82fd49a492df_46"}],"sections":[{"__typename":"Section","name":"33a5","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}}}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.32733017.js"></script><script src="https://cdn-client.medium.com/lite/static/js/6484.96815e61.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.23bdaf70.js"></script><script src="https://cdn-client.medium.com/lite/static/js/5573.159bf40f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/instrumentation.8ea15b6a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.65aadb14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1752.a348f767.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/953.19c0a4db.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3211.3e30b0d8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4586.0206cca1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9692.b4a02f3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5064.7974654b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9046.8e42140f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2846.012d369f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2176.958ba593.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2712.a43f33d4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9972.f6abd8ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5828.582128b9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2955.12744204.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7131.faa9f1cc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/664.68f7c552.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8751.a9b26c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2238.af816699.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5009.dbfd66e8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4803.15ea4361.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8127.7b79de8f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6371.bfa476ae.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8995.7ff30d72.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5435.7a0af391.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3874.3f41bcb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1794.574e0f73.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9454.d9a3a4a8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/Post.50144cfa.chunk.js"></script><script>window.main();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"653ab04f0f901a26","token":"0b5f665943484354a59c39c6833f7078","version":"2021.5.1","si":10}'></script>
</body></html>