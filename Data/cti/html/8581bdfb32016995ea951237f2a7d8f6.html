<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/115981500-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://volatility-labs.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Volatility Labs - Atom" href="https://volatility-labs.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Volatility Labs - RSS" href="https://volatility-labs.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Volatility Labs - Atom" href="https://www.blogger.com/feeds/7693961727488638788/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Volatility Labs - Atom" href="https://volatility-labs.blogspot.com/feeds/7612350045286977534/comments/default" />
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/951198144-ieretrofit.js"></script>
<![endif]-->
<link href='http://4.bp.blogspot.com/-edFWjeI95CY/UHShRo70D3I/AAAAAAAAA-I/VBnCgEfz2yc/s320/phalanx2+flag.png' rel='image_src'/>
<meta content='https://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html' property='og:url'/>
<meta content='Phalanx 2 Revealed: Using Volatility to Analyze an Advanced Linux Rootkit' property='og:title'/>
<meta content='Month of Volatility Plugins       In this blog post I will analyze the Phalanax2 rootkit using both Volatility as well as traditional malwar...' property='og:description'/>
<meta content='//4.bp.blogspot.com/-edFWjeI95CY/UHShRo70D3I/AAAAAAAAA-I/VBnCgEfz2yc/w1200-h630-p-k-no-nu/phalanx2+flag.png' property='og:image'/>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>Volatility Labs: Phalanx 2 Revealed: Using Volatility to Analyze an Advanced Linux Rootkit</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Awesome Inc.
Designer: Tina Chen
URL:      tinachen.org
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#ffffff"/>
<Group description="Page" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.background.color" description="Background Color" type="color" default="#000000"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Links" selector=".main-inner">
<Variable name="link.color" description="Link Color" type="color" default="#888888"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#444444"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#cccccc"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Title Font" type="font"
default="normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#444444" />
<Variable name="header.background.color" description="Header Background" type="color" default="transparent" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="description.text.color" description="Text Color" type="color"
default="#444444" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#444444"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#444444"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#444444"/>
<Variable name="tabs.border.color" description="Border Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Date Header" selector=".main-inner .widget h2.date-header, .main-inner .widget h2.date-header span">
<Variable name="date.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="date.border.color" description="Border Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Post Title" selector="h3.post-title, h4, h3.post-title a">
<Variable name="post.title.font" description="Font" type="font"
default="normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="post.title.text.color" description="Text Color" type="color" default="#444444"/>
</Group>
<Group description="Post Background" selector=".post">
<Variable name="post.background.color" description="Background Color" type="color" default="#ffffff" />
<Variable name="post.border.color" description="Border Color" type="color" default="#eeeeee" />
<Variable name="post.border.bevel.color" description="Bevel Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Gadget Title" selector="h2">
<Variable name="widget.title.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Text Color" type="color" default="#444444"/>
</Group>
<Group description="Gadget Text" selector=".sidebar .widget">
<Variable name="widget.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.text.color" description="Text Color" type="color" default="#444444"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#666666"/>
</Group>
<Group description="Gadget Links" selector=".sidebar .widget">
<Variable name="widget.link.color" description="Link Color" type="color" default="#3778cd"/>
<Variable name="widget.link.visited.color" description="Visited Color" type="color" default="#3778cd"/>
<Variable name="widget.link.hover.color" description="Hover Color" type="color" default="#3778cd"/>
</Group>
<Group description="Gadget Background" selector=".sidebar .widget">
<Variable name="widget.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="widget.border.color" description="Border Color" type="color" default="#222222"/>
<Variable name="widget.border.bevel.color" description="Bevel Color" type="color" default="#000000"/>
</Group>
<Group description="Sidebar Background" selector=".column-left-inner .column-right-inner">
<Variable name="widget.outer.background.color" description="Background Color" type="color" default="transparent" />
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="transparent"/>
<Variable name="image.border.color" description="Border Color" type="color" default="transparent"/>
</Group>
<Group description="Feed" selector=".blog-feeds">
<Variable name="feed.text.color" description="Text Color" type="color" default="#444444"/>
</Group>
<Group description="Feed Links" selector=".blog-feeds">
<Variable name="feed.link.color" description="Link Color" type="color" default="#3778cd"/>
<Variable name="feed.link.visited.color" description="Visited Color" type="color" default="#3778cd"/>
<Variable name="feed.link.hover.color" description="Hover Color" type="color" default="#3778cd"/>
</Group>
<Group description="Pager" selector=".blog-pager">
<Variable name="pager.background.color" description="Background Color" type="color" default="#ffffff" />
</Group>
<Group description="Footer" selector=".footer-outer">
<Variable name="footer.background.color" description="Background Color" type="color" default="#ffffff" />
<Variable name="footer.text.color" description="Text Color" type="color" default="#444444" />
</Group>
<Variable name="title.shadow.spread" description="Title Shadow" type="length" default="-1px"/>
<Variable name="body.background" description="Body Background" type="background"
color="#eeeeee"
default="$(color) none repeat scroll top left"/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="none"/>
<Variable name="body.background.size" description="Body Background Size" type="string" default="auto"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="none"/>
<Variable name="header.background.gradient" description="Header Background Gradient" type="url" default="none" />
<Variable name="header.padding.top" description="Header Top Padding" type="length" default="22px" />
<Variable name="header.margin.top" description="Header Top Margin" type="length" default="0" />
<Variable name="header.margin.bottom" description="Header Bottom Margin" type="length" default="0" />
<Variable name="widget.padding.top" description="Widget Padding Top" type="length" default="8px" />
<Variable name="widget.padding.side" description="Widget Padding Side" type="length" default="15px" />
<Variable name="widget.outer.margin.top" description="Widget Top Margin" type="length" default="0" />
<Variable name="widget.outer.background.gradient" description="Gradient" type="url" default="none" />
<Variable name="widget.border.radius" description="Gadget Border Radius" type="length" default="0" />
<Variable name="outer.shadow.spread" description="Outer Shadow Size" type="length" default="0" />
<Variable name="date.header.border.radius.top" description="Date Header Border Radius Top" type="length" default="0" />
<Variable name="date.header.position" description="Date Header Position" type="length" default="15px" />
<Variable name="date.space" description="Date Space" type="length" default="30px" />
<Variable name="date.position" description="Date Float" type="string" default="static" />
<Variable name="date.padding.bottom" description="Date Padding Bottom" type="length" default="0" />
<Variable name="date.border.size" description="Date Border Size" type="length" default="0" />
<Variable name="date.background" description="Date Background" type="background" color="transparent"
default="$(color) none no-repeat scroll top left" />
<Variable name="date.first.border.radius.top" description="Date First top radius" type="length" default="0" />
<Variable name="date.last.space.bottom" description="Date Last Space Bottom" type="length"
default="20px" />
<Variable name="date.last.border.radius.bottom" description="Date Last bottom radius" type="length" default="0" />
<Variable name="post.first.padding.top" description="First Post Padding Top" type="length" default="0" />
<Variable name="image.shadow.spread" description="Image Shadow Size" type="length" default="0"/>
<Variable name="image.border.radius" description="Image Border Radius" type="length" default="0"/>
<Variable name="separator.outdent" description="Separator Outdent" type="length" default="15px" />
<Variable name="title.separator.border.size" description="Widget Title Border Size" type="length" default="1px" />
<Variable name="list.separator.border.size" description="List Separator Border Size" type="length" default="1px" />
<Variable name="shadow.spread" description="Shadow Size" type="length" default="0"/>
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
<Variable name="date.side" description="Side where date header is placed" type="string" default="right"/>
<Variable name="pager.border.radius.top" description="Pager Border Top Radius" type="length" default="0" />
<Variable name="pager.space.top" description="Pager Top Space" type="length" default="1em" />
<Variable name="footer.background.gradient" description="Background Gradient" type="url" default="none" />
<Variable name="mobile.background.size" description="Mobile Background Size" type="string"
default="auto"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: #eeeeee none repeat scroll top left;
}
html body .content-outer {
min-width: 0;
max-width: 100%;
width: 100%;
}
pre {
display: block;
white-space: pre;
color: black;
border: 1px dashed #CCCCCC;
background-color: #f0f0f0;
font-family: Monospace, "Courier New";
font-size: 12px;
height: auto;
line-height: 20px;
overflow: auto;
padding: 0px;
text-align: left;
width: 99%;
word-wrap: normal;
overflow-wrap: normal;
overflow: auto;
}
p.code {
color: black;
border: 1px dashed #CCCCCC;
background-color: #f0f0f0;
font-family: Monospace, "Courier New";
height: auto;
line-height: 20px;
overflow: auto;
padding: 0px;
text-align: left;
width: 99%;
word-wrap: normal;
overflow-wrap: normal;
overflow: auto;
}
p.code2 {
color: black;
background-color: #f0f0f0;
font-family: Monospace, "Courier New";
font-size: 10px;
}
a:link {
text-decoration: none;
color: #3778cd;
}
a:visited {
text-decoration: none;
color: #3778cd;
}
a:hover {
text-decoration: underline;
color: #3778cd;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 276px;
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
/* Columns
----------------------------------------------- */
.content-inner {
padding: 0;
}
.header-inner .section {
margin: 0 16px;
}
.tabs-inner .section {
margin: 0 16px;
}
.main-inner {
padding-top: 30px;
}
.main-inner .column-center-inner,
.main-inner .column-left-inner,
.main-inner .column-right-inner {
padding: 0 5px;
}
*+html body .main-inner .column-center-inner {
margin-top: -30px;
}
#layout .main-inner .column-center-inner {
margin-top: 0;
}
/* Header
----------------------------------------------- */
.header-outer {
margin: 0 0 0 0;
background: transparent none repeat scroll 0 0;
}
.Header h1 {
font: normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
text-shadow: 0 0 -1px #000000;
}
.Header h1 a {
color: #444444;
}
.Header .description {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
margin-bottom: 0;
}
.header-inner .Header .titlewrapper {
padding-top: 22px;
}
/* Tabs
----------------------------------------------- */
.tabs-outer {
overflow: hidden;
position: relative;
background: #eeeeee url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
#layout .tabs-outer {
overflow: visible;
}
.tabs-cap-top, .tabs-cap-bottom {
position: absolute;
width: 100%;
border-top: 1px solid #999999;
}
.tabs-cap-bottom {
bottom: 0;
}
.tabs-inner .widget li a {
display: inline-block;
margin: 0;
padding: .6em 1.5em;
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
border-left: 1px solid #999999;
height: 16px;
line-height: 16px;
}
.tabs-inner .widget li:last-child a {
border-right: 1px solid #999999;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
background: #666666 url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat-x scroll 0 -100px;
color: #ffffff;
}
/* Headings
----------------------------------------------- */
h2 {
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
/* Widgets
----------------------------------------------- */
.main-inner .section {
margin: 0 27px;
padding: 0;
}
.main-inner .column-left-outer,
.main-inner .column-right-outer {
margin-top: 0;
}
#layout .main-inner .column-left-outer,
#layout .main-inner .column-right-outer {
margin-top: 0;
}
.main-inner .column-left-inner,
.main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
#layout .main-inner .column-left-inner,
#layout .main-inner .column-right-inner {
margin-top: 0;
}
.sidebar .widget {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.sidebar .widget a:link {
color: #3778cd;
}
.sidebar .widget a:visited {
color: #4d469c;
}
.sidebar .widget a:hover {
color: #3778cd;
}
.sidebar .widget h2 {
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget {
background-color: #ffffff;
border: 1px solid #eeeeee;
padding: 0 15px 15px;
margin: 20px -16px;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.main-inner .widget h2 {
margin: 0 -15px;
padding: .6em 15px .5em;
border-bottom: 1px solid transparent;
}
.footer-inner .widget h2 {
padding: 0 0 .4em;
border-bottom: 1px solid transparent;
}
.main-inner .widget h2 + div, .footer-inner .widget h2 + div {
border-top: 1px solid #eeeeee;
padding-top: 8px;
}
.main-inner .widget .widget-content {
margin: 0 -15px;
padding: 7px 15px 0;
}
.main-inner .widget ul, .main-inner .widget #ArchiveList ul.flat {
margin: -8px -15px 0;
padding: 0;
list-style: none;
}
.main-inner .widget #ArchiveList {
margin: -8px 0 0;
}
.main-inner .widget ul li, .main-inner .widget #ArchiveList ul.flat li {
padding: .5em 15px;
text-indent: 0;
color: #666666;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid transparent;
}
.main-inner .widget #ArchiveList ul li {
padding-top: .25em;
padding-bottom: .25em;
}
.main-inner .widget ul li:first-child, .main-inner .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.main-inner .widget ul li:last-child, .main-inner .widget #ArchiveList ul.flat li:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.main-inner .widget .post-body ul {
padding: 0 2.5em;
margin: .5em 0;
list-style: disc;
}
.main-inner .widget .post-body ul li {
padding: 0.25em 0;
margin-bottom: .25em;
color: #444444;
border: none;
}
.footer-inner .widget ul {
padding: 0;
list-style: none;
}
.widget .zippy {
color: #666666;
}
/* Posts
----------------------------------------------- */
body .main-inner .Blog {
padding: 0;
margin-bottom: 1em;
background-color: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}
.main-inner .section:last-child .Blog:last-child {
padding: 0;
margin-bottom: 1em;
}
.main-inner .widget h2.date-header {
margin: 0 -15px 1px;
padding: 0 0 0 0;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: transparent none no-repeat scroll top left;
border-top: 0 solid #eeeeee;
border-bottom: 1px solid transparent;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
position: static;
bottom: 100%;
right: 15px;
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget h2.date-header span {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
display: block;
padding: .5em 15px;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.date-outer {
position: relative;
margin: 30px 0 20px;
padding: 0 15px;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.date-outer:first-child {
margin-top: 0;
}
.date-outer:last-child {
margin-bottom: 20px;
-moz-border-radius-bottomleft: 0;
-moz-border-radius-bottomright: 0;
-webkit-border-bottom-left-radius: 0;
-webkit-border-bottom-right-radius: 0;
-goog-ms-border-bottom-left-radius: 0;
-goog-ms-border-bottom-right-radius: 0;
border-bottom-left-radius: 0;
border-bottom-right-radius: 0;
}
.date-posts {
margin: 0 -15px;
padding: 0 15px;
clear: both;
}
.post-outer, .inline-ad {
border-top: 1px solid #eeeeee;
margin: 0 -15px;
padding: 15px 15px;
}
.post-outer {
padding-bottom: 10px;
}
.post-outer:first-child {
padding-top: 0;
border-top: none;
}
.post-outer:last-child, .inline-ad:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.post-body img {
padding: 8px;
background: transparent;
border: 1px solid transparent;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
border-radius: 0;
}
h3.post-title, h4 {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a:hover {
color: #3778cd;
text-decoration: underline;
}
.post-header {
margin: 0 0 1em;
}
.post-body {
line-height: 1.4;
}
.post-outer h2 {
color: #444444;
}
.post-footer {
margin: 1.5em 0 0;
}
#blog-pager {
padding: 15px;
font-size: 120%;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius-topright: 0;
margin-top: 1em;
}
.blog-feeds, .post-feeds {
margin: 1em 0;
text-align: center;
color: #444444;
}
.blog-feeds a, .post-feeds a {
color: #3778cd;
}
.blog-feeds a:visited, .post-feeds a:visited {
color: #4d469c;
}
.blog-feeds a:hover, .post-feeds a:hover {
color: #3778cd;
}
.post-outer .comments {
margin-top: 2em;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Footer
----------------------------------------------- */
.footer-outer {
margin: -20px 0 -1px;
padding: 20px 0 0;
color: #444444;
overflow: hidden;
}
.footer-fauxborder-left {
border-top: 1px solid #eeeeee;
background: #ffffff none repeat scroll 0 0;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
margin: 0 -20px;
}
/* Mobile
----------------------------------------------- */
body.mobile {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
*+html body.mobile .main-inner .column-center-inner {
margin-top: 0;
}
.mobile .main-inner .widget {
padding: 0 0 15px;
}
.mobile .main-inner .widget h2 + div,
.mobile .footer-inner .widget h2 + div {
border-top: none;
padding-top: 0;
}
.mobile .footer-inner .widget h2 {
padding: 0.5em 0;
border-bottom: none;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile .main-inner .widget ul,
.mobile .main-inner .widget #ArchiveList ul.flat {
margin: 0 -15px 0;
}
.mobile .main-inner .widget h2.date-header {
right: 0;
}
.mobile .date-header span {
padding: 0.4em 0;
}
.mobile .date-outer:first-child {
margin-bottom: 0;
border: 1px solid #eeeeee;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
}
.mobile .date-outer {
border-color: #eeeeee;
border-width: 0 1px 1px;
}
.mobile .date-outer:last-child {
margin-bottom: 0;
}
.mobile .main-inner {
padding: 0;
}
.mobile .header-inner .section {
margin: 0;
}
.mobile .post-outer, .mobile .inline-ad {
padding: 5px 0;
}
.mobile .tabs-inner .section {
margin: 0 10px;
}
.mobile .main-inner .widget h2 {
margin: 0;
padding: 0;
}
.mobile .main-inner .widget h2.date-header span {
padding: 0;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile #blog-pager {
border: 1px solid transparent;
background: #ffffff none repeat scroll 0 0;
}
.mobile .main-inner .column-left-inner,
.mobile .main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: none;
-webkit-box-shadow: none;
-goog-ms-box-shadow: none;
box-shadow: none;
}
.mobile .date-posts {
margin: 0;
padding: 0;
}
.mobile .footer-fauxborder-left {
margin: 0;
border-top: inherit;
}
.mobile .main-inner .section:last-child .Blog:last-child {
margin-bottom: 0;
}
.mobile-index-contents {
color: #444444;
}
.mobile .mobile-link-button {
background: #3778cd url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content {
background: transparent;
border-top: 1px solid;
border-color: #999999;
color: #444444;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #999999;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 960px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 960px;
max-width: 960px;
_width: 960px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 280px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 280px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("280px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 280px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 280px;
margin-right: -280px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<script type='text/javascript'>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-6968853-8', 'auto', 'blogger');
        ga('blogger.send', 'pageview');
      </script>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7693961727488638788&amp;zx=4a67bd86-21ac-4be0-9047-179b1222180a' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7693961727488638788&amp;zx=4a67bd86-21ac-4be0-9047-179b1222180a' rel='stylesheet'/></noscript>

</head>
<body class='loading'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d7693961727488638788\x26blogName\x3dVolatility+Labs\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://volatility-labs.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://volatility-labs.blogspot.com/\x26targetPostID\x3d7612350045286977534\x26blogPostOrPageUrl\x3dhttps://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html\x26vt\x3d7701558426568145874',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://volatility-labs.blogspot.com/'>
Volatility Labs
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Wednesday, October 10, 2012</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='http://4.bp.blogspot.com/-edFWjeI95CY/UHShRo70D3I/AAAAAAAAA-I/VBnCgEfz2yc/s320/phalanx2+flag.png' itemprop='image_url'/>
<meta content='7693961727488638788' itemprop='blogId'/>
<meta content='7612350045286977534' itemprop='postId'/>
<a name='7612350045286977534'></a>
<h3 class='post-title entry-title' itemprop='name'>
Phalanx 2 Revealed: Using Volatility to Analyze an Advanced Linux Rootkit
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-7612350045286977534' itemprop='description articleBody'>
<!--[if gte mso 9]><xml>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]--><b>Month of Volatility Plugins</b><br />
<br />
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Normal</w:View>
  <w:Zoom>0</w:Zoom>
  <w:TrackMoves/>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]--><!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
 {mso-style-name:"Table Normal";
 mso-tstyle-rowband-size:0;
 mso-tstyle-colband-size:0;
 mso-style-noshow:yes;
 mso-style-priority:99;
 mso-style-parent:"";
 mso-padding-alt:0in 5.4pt 0in 5.4pt;
 mso-para-margin-top:0in;
 mso-para-margin-right:0in;
 mso-para-margin-bottom:10.0pt;
 mso-para-margin-left:0in;
 line-height:115%;
 mso-pagination:widow-orphan;
 font-size:11.0pt;
 font-family:"Calibri","sans-serif";
 mso-ascii-font-family:Calibri;
 mso-ascii-theme-font:minor-latin;
 mso-hansi-font-family:Calibri;
 mso-hansi-theme-font:minor-latin;
 mso-bidi-font-family:"Times New Roman";
 mso-bidi-theme-font:minor-bidi;}
</style>
<![endif]-->

<br />
<div class="MsoNormal">
In this blog post I will analyze the Phalanax2 rootkit using
both Volatility as well as traditional malware analysis techniques.</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
<u>Phalanx2</u></div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
Phalanx2 (P2) is the latest version of a private rootkit,
whose original source was leaked to <a href="http://packetstormsecurity.org/files/42556/phalanx-b6.tar.bz2.html">PacketStorm</a>
back in late 2005. Since then there have been no public leaks of either the
source code or the complete set of files for using the rootkit (backdoor,
client, config instructions, etc). Instead, the only occurrences of it were
from sysadmins and IR teams who found that their systems were infected with it.
None of these teams have ever released the files public, so deep analysis of
the rootkit is not available in any public forums.</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
With that said, we recently got our hands on a working
sample (backdoor and config file only). Although we also are not allowed to
release the sample, we can release our analysis of it.<br />
<br /></div>
<div class="MsoNormal">
The rootkit comes as a statically compiled userland ELF file
with stripped symbols. The config file specifies the group ID of processes to
hide, the prefix of filenames to hide, and a hash value that we did not
determine the purpose of yet.</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
<u>Analysis Setup &amp; Approach</u><br />
<u><br /></u></div>
<div class="MsoNormal">
Analysis was done on a Debian 6.0.3 (Squeeze) 32 bit VMware
virtual machine running the 2.6.32-5-686 #1 SMP kernel. I also compiled a
custom kernel, explained later, that let me automate some of the analysis.</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
Our sample included three files, the userland binary that
controls all functionality and a .config file that specified the group ID to
hide, the hidden directory for files, and a .p2rc file used for when
communicating with the backdoor.<span style="mso-spacerun: yes;">&nbsp; </span>When
running, P2 produced a file of recorded keystrokes into the hidden directory.</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
The approach during this analysis was a mix of both static
and dynamic analysis using Volatility, IDA Pro, custom dynamic monitoring code, and
the usual Linux analysis tools (gdb, strace, etc).</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
<u>Analysis with Volatility</u></div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
I will first walk through the analysis of P2 with
Volatility.<span style="mso-spacerun: yes;">&nbsp; </span>To determine the changes
that the rootkit makes, I booted the VM, took a memory capture with <a href="http://code.google.com/p/lime-forensics/">LiME</a>, installed P2, and then
took another memory capture. Note that if you run the program without arguments you are greeted with a nice 'HACKED BY CHINESE' message that can be seen below:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># insmod ./lime-2.6.32-5-686.ko
"format=lime path=before-blog-post.lime"</b></span><br />
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># ./phalanx2</b></span><br />
<div class="separator" style="clear: both; text-align: center;">
<a href="//4.bp.blogspot.com/-edFWjeI95CY/UHShRo70D3I/AAAAAAAAA-I/VBnCgEfz2yc/s1600/phalanx2+flag.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="167" src="//4.bp.blogspot.com/-edFWjeI95CY/UHShRo70D3I/AAAAAAAAA-I/VBnCgEfz2yc/s320/phalanx2+flag.png" width="320"></a></div>
<div class="separator" style="clear: both; text-align: center;">
</div>
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><b style="mso-bidi-font-weight: normal;">&nbsp; </b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"><span style="mso-spacerun: yes;"></span># ./phalanx2
i</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">(_-<span style="mso-spacerun: yes;">&nbsp; </span>phalanx 2.5f -_)</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">; mmap
failed..bypassing /dev/mem restrictions</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">; locating
sys_call_table..</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">;
sys_call_table_phys = 0x12742b0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">; phys_base =
0x0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">;
sys_call_table = 0xc12742b0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">; hooking..
[8=======================D]</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">; locating
&amp;tcp4_seq_show..................... found</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;&gt;injected</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># insmod ./lime-2.6.32-5-686.ko
"format=lime path=after-blog-post.lime"</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal">
The output from P2, assuming that it can be trusted, seems
like we will need to investigate /dev/mem, the system call table, and the <i style="mso-bidi-font-style: normal;">/proc </i>handlers for the TCP protocol. If
we tried to install P2 while the hooks are still active we get an error
message:</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># ./phalanx2 i</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">(_-<span style="mso-spacerun: yes;">&nbsp; </span>phalanx 2.5f -_)</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">fatal:
already injected?</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal">
<span style="mso-spacerun: yes;"></span>I then ran a number
of plugins and diff&#8217;ed their output to determine the effects of the rootkit.</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
<i style="mso-bidi-font-style: normal;">Hidden Processes</i></div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
before-blog-post.lime linux_pslist &gt; pslist-before</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile Systems
Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_pslist &gt; pslist-after</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile Systems
Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># diff pslist-before pslist-after</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">64c64,65</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&lt;
0xf6698000 insmod<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>1292<span style="mso-spacerun: yes;">&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Sun, 07 Oct 2012 03:47:59 +0000</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">---</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;
0xf669e600 <b><span style="color: red;">Xnest</span></b><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>1319<span style="mso-spacerun: yes;">&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp; </span>42779<span style="mso-spacerun: yes;">&nbsp; </span>Sun, 07 Oct 2012 03:52:58 +0000</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;
0xf671aa80 insmod<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>1353<span style="mso-spacerun: yes;">&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Sun, 07 Oct 2012 03:53:33 +0000</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="margin-bottom: 3pt;">
In this
output we can see that insmod is different, as we should expect since we ran
LiME twice and unloaded it in between runs. We also see a process named <span style="line-height: normal;"><span style="font-family: Courier New, Courier, monospace;">Xnest</span><span style="font-family: inherit;"> </span></span>with a PID of 1319 and a GID of
42779.<span style="line-height: normal;">&nbsp;&nbsp; </span>This is the userland process
spawned by P2, and 42779 is the GID to hide from userland. If we investigate
this process with <span style="font-family: Courier New, Courier, monospace; line-height: normal;">linux_psaux</span>, which gathers
arguments from userland, we see that
the process name is different - it is&nbsp;disguised&nbsp;as a kernel thread (because the name is enclosed in brackets).&nbsp;</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_psaux -p 1319</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile Systems
Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Pid<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>Uid<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;
</span>Gid<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Arguments</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">1319<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>42779<span style="mso-spacerun: yes;">&nbsp; </span>[ata/0]</span><span style="mso-spacerun: yes;"><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: x-small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Although the Xnest process is hidden, it would look very strange on
a normal system if it became uncovered, so P2 tries to blend the "Xnest" process name by
disguising it as a normal kernel thread.<span style="mso-spacerun: yes;">&nbsp; </span>An
experienced investigator or system administrator would even find the new name
suspicious though as the PID is very high for a kernel thread, which are all
normally started soon after <i style="mso-bidi-font-style: normal;">init</i>.
Similarly, the process will have memory maps even though the name is in
brackets.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
As final
proof that our PID is not really a kernel thread, we can look at the output of
the pstree plugin and see that Xnest is indeed not a child of the kernel thread
daemon as all kernel threads should be:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_pstree</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&lt;snip&gt;</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.Xnest<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes;"></span>1319<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[kthreadd]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>2<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.[migration/0]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>3<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.[ksoftirqd/0]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>4<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.[watchdog/0]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>5<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.[events/0]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>6<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.[cpuset]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>7<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.[khelper]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>8<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.[netns]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>9<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.[async/mgr]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>10<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">.[pm]<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>11<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&lt;snip&gt;</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal">
<i style="mso-bidi-font-style: normal;">Memory Maps</i></div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Investigating
the memory maps is pretty straightforward as the binary is statically compiled and
does not load any libraries on its own. The memory maps between the binary and
the stack may be of interest though, and the &#8220;rwx&#8221; mapping only adds to this
interest. This is because memory mappings normally are either rw, ro, or rx, but not all three. The use of rwx pages is a common malware technique as it allows the malware to write to a memory buffer and then execute it.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_proc_maps -p 1319</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">9c27000 |
9c27000</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">0x8048000-0x805c000
r-x<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp; </span>8: 1<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>362195 /usr/share/XXXXXXXXXXXX.p2/.p-2.5f</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">0x805c000-0x805d000
rwx<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>81920<span style="mso-spacerun: yes;">&nbsp; </span>8: 1<span style="mso-spacerun: yes;">&nbsp;
</span>362195 /usr/share/XXXXXXXXXXXX.p2/.p-2.5f</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">0x805d000-0x805f000
rwx<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp; </span>0: 0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">0xaf891000-0xaf894000
rwx<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp; </span>0: 0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">0xb7894000-0xb78ac000
rwx<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp; </span>0: 0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;
</span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">0xb78ac000-0xb78ad000
r-x<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp; </span>0: 0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">0xbf874000-0xbf88a000
rwx<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp; </span>0: 0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>0 [stack]</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal">
<i style="mso-bidi-font-style: normal;">Open Files</i></div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
If we investigate the open files we see that file
descriptors 0, 1, and 2 are set to /dev/null, 3 is not present, and 4 and 5 are
sockets. This is also fairly strange output as socket file descriptors are normally either dup'ed over the inital 0, 1, and 2 file descriptors.&nbsp; In the binary
analysis portion of this blog post we will see how these file descriptors are
set.</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_lsof -p 1319</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Pid<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FD<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Path</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">--------
-------- ----</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">1319<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0 <span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>/dev/null</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">1319<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>1 <span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>/dev/null</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">1319<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>2 <span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>/dev/null</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">1319<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>4 <span style="mso-spacerun: yes;">&nbsp;&nbsp;</span>socket:[4441]</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">1319<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>5 <span style="mso-spacerun: yes;">&nbsp;&nbsp;</span>socket:[4442]</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<i style="mso-bidi-font-style: normal;">Netstat</i></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Next, we see
that the open sockets actually connected over localhost to each other:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_netstat</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&lt;snip&gt;</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">TCP<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>127.0.0.1:40719 127.0.0.1:50271
ESTABLISHED<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Xnest/1319</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">TCP<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>127.0.0.1:50271 127.0.0.1:40719
ESTABLISHED<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Xnest/1319</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&lt;snip&gt;</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal">
Again, this is quite abnormal&#8230;</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
<i style="mso-bidi-font-style: normal;">Dmesg</i></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
before-blog-post.lime linux_dmesg &gt; dmesg_before</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_dmesg &gt; dmesg_after</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># diff dmesg_before dmesg_after</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">1150a1151,1159</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="color: red; font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><i style="mso-bidi-font-style: normal;"><b>&gt; &lt;6&gt;[ 1573.826831] Program Xnest
tried to access /dev/mem between 0-&gt;8000000.</b></i></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="color: red; font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><i style="mso-bidi-font-style: normal;"><b>&gt; &lt;4&gt;[ 1576.063304] Xnest:1297 map
pfn RAM range req write-back for 0-8000000, got uncached-minus</b></i></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;
&lt;4&gt;[ 1613.438913] [LiME] Parameters</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;
&lt;4&gt;[ 1613.438921] [LiME]<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>PATH:
after-blog-post.lime</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;
&lt;4&gt;[ 1613.438925] [LiME]<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>DIO: 1</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;
&lt;4&gt;[ 1613.438928] [LiME]<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>FORMAT:
lime</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;
&lt;4&gt;[ 1613.438931] [LiME] Initilizing Disk...</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;
&lt;4&gt;[ 1613.454205] [LiME] Direct IO may not be supported on this file
system. Retrying.</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&gt;
&lt;4&gt;[ 1613.454217] [LiME] Direct IO Disabled</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
In this
output, we can see in the entries that the Xnest binary tried to
access /dev/mem. The next line shows us the PID of Xnest, which the attentive
reader will notice is different than the one we investigated with the previous
plugins ;)</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal">
<i style="mso-bidi-font-style: normal;">Loaded Modules</i></div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Investigating
the loaded modules between memory captures produces interesting results.<span style="mso-spacerun: yes;">&nbsp; </span>First, there is no difference between the
two. This means that any active kernel module loaded by the rootkit would have
to be hidden, but the <span style="font-family: Courier New, Courier, monospace;">check_modules</span> plugin also reports no hidden modules. We
will see in the binary analysis part why we cannot find any modules related to
the rootkit.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
before-blog-post.lime linux_lsmod &gt; lsmod_before</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_lsmod &gt; lsmod_after</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># diff lsmod_after lsmod_before</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_check_modules</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Module Name</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">-----------</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<i style="mso-bidi-font-style: normal;">Looking for Hooked Kernel Structures</i></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
As we have
seen in <a href="http://volatility-labs.blogspot.com/2012/09/movp-15-kbeast-rootkit-detecting-hidden.html">previous MoVP rootkits</a>, P2 hooks <span style="font-family: Courier New, Courier, monospace;">tcp4_seq_afino</span>.
This allows for trivially hiding network connections from userland.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_check_afinfo</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Symbol
Name<span style="mso-spacerun: yes;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>Member<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Address</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">-------------------- ----------- ----------</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">tcp4_seq_afinfo<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>show<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>0xf7c7f000</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
We then see
that P2 hooks a wide range of system calls:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_check_syscall &gt; p2syscalls</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># grep HOOKED p2syscalls</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x3 0xf7c4f000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x4 0xf7c53000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x5 0xf7c40000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0xa 0xf7c57000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0xc 0xf7c3d000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x25 0xf7c4c000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x27 0xf7c6a000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x53 0xf7c67000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x60 0xf7c43000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x66 0xf7c7c000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x6a 0xf7c73000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x6b 0xf7c70000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x84 0xf7c5a000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x8d 0xf7c3a000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0xc3 0xf7c79000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>0xc4 0xf7c76000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0xdc 0xf7c37000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x127 0xf7c64000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x128 0xf7c6d000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">32bit<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x12d 0xf7c61000 HOOKED</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
To determine
exactly which system calls are hooked, I modified the plugin to print the
decimal form of only the hooked system calls. I then used this numbers to grep
on unistd:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># grep -wf hooked-syscalls
/usr/include/asm/unistd_32.h</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_read<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>3</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_write<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>4</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_open<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>5</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_unlink<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>10</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_chdir<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>12</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_kill<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>37</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_mkdir<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>39</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_symlink<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>83</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_getpriority<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>96</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define __NR_socketcall<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>102</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_stat<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>106</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_lstat<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>107</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_getpgid<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>132</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_getdents<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>141</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_stat64<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>195</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_lstat64<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>196</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_getdents64<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>220</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_openat<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>295</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_mkdirat<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>296</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">#define
__NR_unlinkat<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>301</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
This tells us
exactly which system calls are hooked and we can guess some of the rootkit&#8217;s
functionality based on this.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal">
<u>Dynamic &amp; Binary Analysis</u></div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
<i style="mso-bidi-font-style: normal;">The Loaded Module</i></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
I started the
analysis process by looking at the strings of the binary in hopes to find
something interesting to target analysis on. The first thing I noticed was:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: x-small; mso-bidi-font-style: normal;">rm dummy.ko helper.ko p2.ko</span></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
From there I
grepped for kernel modules and found:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># grep \.ko strings</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">UN=`uname
-r`;cp `find /lib/modules/$UN -name dummy.ko` .</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">could not
find dummy.ko</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">helper.ko</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">ld -r
helper.ko dummy.ko -o p2.ko</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">readelf -s
p2.ko|grep ' init_module'|awk '{print $1}'</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">readelf -S
p2.ko|grep symtab|awk '{print $5}'</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">insmod p2.ko
2&gt;&amp;1</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">rm dummy.ko
helper.ko p2.ko</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
which showed
quite a few interesting entries. From the output we can that P2 attempts to
find the dummy network interface kernel module, and then links another module <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">helper.ko</span></span><i style="mso-bidi-font-style: normal;"> </i>with <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">dummy.ko</span></span> to produce <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">p2.ko</span></span>. This module (<span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">p2.ko)</span></span> is eventually loaded and then
the three modules are deleted.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
At this point
I wanted to get <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">helper.ko</span></span><i style="mso-bidi-font-style: normal;"> </i><span style="mso-spacerun: yes;">&nbsp;</span>and <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">p2.ko</span></span><i style="mso-bidi-font-style: normal;">
</i>so that I could reverse them to determine what in-kernel features P2 had. I
was also intrigued as I did not see any calls to <span style="font-family: Courier New, Courier, monospace;">rmmod</span> in the strings, although
it could just have simply been obfuscated.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
My first
thought was to recover the deleted modules with the Sleuthkit, but
unfortunately they were unrecoverable each time I tried. I then decided that I
could simply get rid of the call to <span style="font-family: Courier New, Courier, monospace;">rm</span> and they would stay on disk. For this,
I made a copy of the rootkit and changed <span style="font-family: Courier New, Courier, monospace;">rm</span> to <span style="font-family: Courier New, Courier, monospace;">aa</span> (a non-existent command)
so that the loading would error out. I then loaded the rootkit and was able to
get the three kernel modules after the loading process aborted on attempting to
execute the <span style="font-family: Courier New, Courier, monospace;">aa</span> command.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
I first
examined helper.ko and saw that it only referenced two functions:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: x-small; mso-bidi-font-style: normal;">5: 00000000<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>48 FUNC<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;
</span>LOCAL<span style="mso-spacerun: yes;">&nbsp; </span>DEFAULT<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>1 __memcpy</span></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: x-small; mso-bidi-font-style: normal;">9: 00000000<span style="mso-spacerun: yes;">&nbsp;&nbsp;
</span>142 FUNC<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>GLOBAL DEFAULT<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>4 module_helper</span></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Investigation
of <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">module&#173;&#173;_helper</span></span><i style="mso-bidi-font-style: normal;"> </i>inside of <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">p2.ko</span>
(remember they are linked) showed that it was a fairly small function:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="//1.bp.blogspot.com/-Cf3GrTBHEG4/UHSSHDUb3_I/AAAAAAAAAEg/zwMGhrk9hoE/s1600/init_module.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="//1.bp.blogspot.com/-Cf3GrTBHEG4/UHSSHDUb3_I/AAAAAAAAAEg/zwMGhrk9hoE/s640/init_module.jpg" width="488"></a></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
If you
examine helper.ko&#8217;s version of this function, the kernel address references
0xCxxxxxxx in p2.ko, are actually stored as 0xcacacaca, and are later fixed up
with the addresses from the kernel that is going to be infected.<br />
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
The rootkit
relies on determining the address of <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">devmem_is_allowed</span></span>
and <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">set_memory_rw</span></span> for the current
kernel.<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>After gathering these
addresses, the rootkit then marks the page for <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">devmem_is_allowed</span> writeable, and
uses <span style="font-family: Courier New, Courier, monospace;">memcpy</span> to overwrite the function. This code that is used to overwrite is
declared in the beginning of the function starting with <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">mov
[ebp+hook_opcodes], 55h</span>. If you disassemble these opcodes you will see:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;"></span># <b>perl -e 'print
"\x55\x89\xE5\xB8\x01\x00\x00\x00\x5d\xc3"' &gt; bin2</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;"></span># <b>ndisasm -b32 bin2</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;"></span>00000000<span style="mso-spacerun: yes;">&nbsp; </span>55<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span><span style="mso-spacerun: yes;"></span>push ebp</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;"></span>00000001<span style="mso-spacerun: yes;">&nbsp; </span>89E5<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;"></span><span style="mso-spacerun: yes;"></span><span style="mso-spacerun: yes;"></span>mov ebp,esp</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;"></span>00000003<span style="mso-spacerun: yes;">&nbsp; </span>B801000000<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>mov eax,0x1</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;"></span>00000008<span style="mso-spacerun: yes;">&nbsp; </span>5D<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes;"></span>pop ebp</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;"></span>00000009<span style="mso-spacerun: yes;">&nbsp; </span>C3<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes;"></span>ret</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
This function
simply returns 1, which allows all addresses to be accessed. The outcome of
this hooking is that the protections of /dev/mem are disabled and the full
range of physical memory can be written to and read.<span style="mso-spacerun: yes;">&nbsp; </span>If you remember from the output of running
P2, we saw this line:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&#8220;; mmap
failed..bypassing /dev/mem restrictions&#8221;</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
And now we
know what it is referring to. You may also remember that the Volatility Linux
plugins could not find any loadable kernel modules even though we are clearly
seeing <span style="mso-bidi-font-style: normal;">p2.ko</span><i style="mso-bidi-font-style: normal;"> </i>being loaded into the
system. The reason for this is evidence in the last few instructions of <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">init_module</span></span><i style="mso-bidi-font-style: normal;">:</i></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt; margin-left: .5in; margin-right: 0in; margin-top: 0in;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">mov<span style="mso-spacerun: yes;">&nbsp; </span>eax,0xfffffffd</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt; margin-left: .5in; margin-right: 0in; margin-top: 0in;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">leave</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt; margin-left: .5in; margin-right: 0in; margin-top: 0in;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">ret</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt; margin-left: .5in; margin-right: 0in; margin-top: 0in;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Since <span style="font-family: Courier New, Courier, monospace;">eax</span> is
used as the return value, this is the equivalent of &#8220;return -3&#8221; in C code. Any
negative return value from an <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">init_module</span></span><i style="mso-bidi-font-style: normal;">
</i>function signifies an error to the LKM loader and will force it to unload
the beginning pieces of the module and stop processing it. This has the effect
of letting P2 disable /dev/mem protections without ever fully loading a kernel
module; hence why we cannot find traces of it.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal">
<i style="mso-bidi-font-style: normal;">Already Injected?</i></div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal">
When testing what P2 would do if you tried to inject it on
an already infected system, I got the output from above about it being already injected.
I then wanted to understand how P2 knew the system was already infected.<br />
<br /></div>
<div class="MsoNormal">
For
this, I grepped the strings output for the userland binary for &#8220;injected&#8221;:</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<b style="mso-bidi-font-weight: normal;"><span style="font-family: Courier New, Courier, monospace; font-size: x-small;"># grep -i injected strings</span></b></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;">[1;40minjected</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;">/dev/shm/%s.injected</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;">already
injected?</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<b style="mso-bidi-font-weight: normal;"><span style="font-family: Courier New, Courier, monospace; font-size: x-small;"># grep shm strings</span></b></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;">/dev/shm/....</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;">; rm
/dev/shm/.... and try again</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;">/dev/shm/%s.injected</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
The /dev/shm
line stood out quite a bit in this output as <span style="mso-bidi-font-style: normal;">/dev/shm</span><i style="mso-bidi-font-style: normal;"> </i>is always a tmpfs filesystem and rootkits often write to
this directory as it does not persist across reboots. To determine what this
injected file was, I used the <span style="font-family: Courier New, Courier, monospace;">tmpfs</span> plugin to recover <span style="mso-bidi-font-style: normal;">/dev/shm</span>.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_tmpfs -L</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">1 -&gt;
/dev/shm</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">2 -&gt; /lib/init/rw</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># python vol.py --profile=Linuxthisx86 -f
after-blog-post.lime linux_tmpfs -S 1 -D tmpfs</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">Volatile
Systems Volatility Framework 2.2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><b style="mso-bidi-font-weight: normal;"># ls -lR tmpfs</b></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">tmpfs:</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">total 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">-rw------- 1
root root 0 Oct<span style="mso-spacerun: yes;">&nbsp; </span>7<span style="mso-spacerun: yes;">&nbsp; </span>2012 XXXXXXXXXXX.injected</span></div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
As can be
seen in the output, there is a file named as <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;prefix of hidden
files&gt;.injected</span> under /dev/shmem. In this output I changed the prefix of our
sample config to all Xs. We know now how P2 checks for the existence of a
previous infection.<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>If you are
interested in how Volatility recovers tmpfs, please see this blog <a href="http://memoryforensics.blogspot.com/2012/08/recoving-tmpfs-from-memory-with.html">post</a>.</div>
<div class="MsoNormal" style="tab-stops: 100.15pt;">
<br /></div>
<div class="MsoNormal" style="tab-stops: 100.15pt;">
<i style="mso-bidi-font-style: normal;">Looking with strace</i></div>
<div class="MsoNormal" style="tab-stops: 100.15pt;">
<br /></div>
<div class="MsoNormal">
By analyzing the output of strace on the binary as it
installs, we uncover a number of interesting activities. The first involves the
use of <i style="mso-bidi-font-style: normal;">/proc/self/exe </i>to execute:</div>
<div class="MsoNormal">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">chdir("/usr/share/XXXXXXXXXXXX.p2")
= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">symlink("/proc/self/exe",
"Xnest") = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">execve("./Xnest",
["Xnest", "i"], [/* 0 vars */]) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">readlink("/proc/self/exe",
"/usr/share/XXXXXXXXXXXX.p2/.p-2.5f", 255) = 34</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">chdir("/usr/share/XXXXXXXXXXXX.p2")
= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">unlink("./Xnest")<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">open(".config",
O_RDONLY)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 3</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
In this case,
P2 is creating a symlink between <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">/proc/self/exe</span></span><i style="mso-bidi-font-style: normal;">
</i>and <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Xnest</span>, which was the name of our hidden process. Xnest, which is a
symlink to the same binary that is already running, is then re-executed with
the same command-line parameters (&#8220;i&#8221;), and this time the Xnest binary is
unlinked, followed by an opening of the .config file.<br />
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
This output
explains why the error we saw in dmesg that did not match the PID we investigated
with Volatility. This abuse of /proc/self/exe also thoroughly confused gdb as
the Xnest process is hidden upon the second execution and gdb cannot properly
follow the child process. </div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Next, we see
activity related to /dev/shm:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">open("/dev/shm/....",
O_RDWR)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= -1 ENOENT (No such file or
directory)</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">open("/dev/shm/....",
O_RDWR|O_CREAT|O_TRUNC, 0600) = 3</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">close(3)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">open("/dev/shm/XXXXXXXXXXXX.injected",
O_RDWR) = -1 ENOENT (No such file or directory)</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
In this case
we see it create <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">/dev/shm/&#8230;.</span>, and check for the non-existent injected
file &#8212; remember we are tracing the install process.<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
P2 then
mmap&#8217;s /dev/mem in order to start its reading and hooking of kernel memory:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">13185
open("/dev/mem", O_RDWR)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>= 3</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">13185
old_mmap(NULL, 134217728, PROT_READ|PROT_WRITE, MAP_SHARED, 3,
0xbf8533e0097c0020) = 0xaf866000</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">13185
write(1, "; locating sys_call_table..", 27) = 27</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
After the
injection and hooking is completed, we see the activity we already noted from
the userland process:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">setresuid(0,
0, 0)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">setresgid(42779,
42779, 42779)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">getpid()<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 13188</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">setpriority(PRIO_PROCESS,
13188, 7) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">chdir("/")<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">setsid()<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 13188</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">open("/dev/null",
O_RDWR)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 3</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">dup2(3,
0)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">dup2(3,
1)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 1</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">dup2(3,
2)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">close(3)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
In this case
it is setting its privileges to UID 0 and its GID to 42779. We also see the
call to <span style="font-family: Courier New, Courier, monospace;">setsid</span> followed by the setting of file descriptors 0, 1, and 2 to
/dev/null, which is then closed as file descriptor 3. This matches our output
from <span style="font-family: Courier New, Courier, monospace;">linux_lsof</span>.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
The signal
handlers for the hooked process are then set to avoid detection by sending of
signals to random PIDs in order to find hidden processes. The set handlers will
simply ignore any signals.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">rt_sigaction(SIGHUP,
{SIG_IGN, [HUP], SA_RESTORER|SA_NODEFER, 0x8059830}, {SIG_DFL, [], 0}, 8) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>rt_sigaction(SIGINT, {SIG_IGN, [INT],
SA_RESTORER|SA_NODEFER, 0x8059830}, {SIG_DFL, [], SA_RESTORER, 0x8059830}, 8) =
0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>rt_sigaction(SIGQUIT, {SIG_IGN, [QUIT],
SA_RESTORER|SA_NODEFER, 0x8059830}, {SIG_DFL, [], SA_RESTORER, 0x8059830}, 8) =
0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>rt_sigaction(SIGILL, {SIG_IGN, [ILL],
SA_RESTORER|SA_NODEFER, 0x8059830}, {SIG_DFL, [], 0}, 8) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>rt_sigaction(SIGTRAP, {SIG_IGN, [TRAP],
SA_RESTORER|SA_NODEFER, 0x8059830}, {SIG_DFL, [], 0}, 8) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">&lt;snip&gt;</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">rt_sigaction(SIGRT_28,
{SIG_IGN, [RT_28], SA_RESTORER|SA_NODEFER, 0x8059830}, {SIG_DFL, [], 0}, 8) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>rt_sigaction(SIGRT_29, {SIG_IGN, [RT_29],
SA_RESTORER|SA_NODEFER, 0x8059830}, {SIG_DFL, [], 0}, 8) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>rt_sigaction(SIGRT_30, {SIG_IGN, [RT_30],
SA_RESTORER|SA_NODEFER, 0x8059830}, {SIG_DFL, [], 0}, 8) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>rt_sigaction(SIGRT_31, {SIG_IGN, [RT_31],
SA_RESTORER|SA_NODEFER, 0x8059830}, {SIG_DFL, [], 0}, 8) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Setting up of
the network connections we saw in <span style="font-family: Courier New, Courier, monospace;">linux_netstat</span>
also appears, as well as a call to symlink with 0xdeadbeef as the first
parameter and our newly accepted file
descriptor 11/0xb being sent to <span style="mso-bidi-font-style: normal;">sys_symlink</span>.<span style="mso-spacerun: yes;">&nbsp;</span>We will look into this shortly.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">socket(PF_INET,
SOCK_STREAM, IPPROTO_IP) = 9</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>bind(9, {sa_family=AF_INET, sin_port=htons(4161),
sin_addr=inet_addr("127.0.0.1")}, 16) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>listen(9, 1)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>socket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 10</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>bind(10, {sa_family=AF_INET,
sin_port=htons(0), sin_addr=inet_addr("0.0.0.0")}, 16) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>connect(10, {sa_family=AF_INET,
sin_port=htons(4161), sin_addr=inet_addr("127.0.0.1")}, 16) = 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>accept(9, 0, NULL)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 11</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>close(9)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-spacerun: yes;">&nbsp;</span>symlink(0xdeadbeef, 0xb)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= -1 EFAULT (Bad address)</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
At the end of
the installation process we see:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">open("/dev/shm/XXXXXXXXXXXX.injected",
O_RDWR|O_CREAT|O_TRUNC, 0600) = 3</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">close(3)<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">unlink("/dev/shm/....")<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Which is P2
deleting its temporary marker&nbsp;and creating the real injected file, which
will be hidden due to its prefix.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<i style="mso-bidi-font-style: normal;">Monitoring Interactions with /dev/mem</i></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Since I knew
that P2 operated by mmap&#8217;ing /dev/mem I thought that I could simply record all
of interactions by hooking the <span style="font-family: Courier New, Courier, monospace;">open</span>, <span style="font-family: Courier New, Courier, monospace;">mmap</span>, and <span style="font-family: Courier New, Courier, monospace;">lseek</span> handlers for the device file. After I implemented this, I
installed P2 and got this output from the kernel:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="color: red; font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><i style="mso-bidi-font-style: normal;"><b>[<span style="mso-spacerun: yes;">&nbsp;&nbsp;
</span>40.552968] open_port Xnest 906 2014</b></i></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>40.596772] Program Xnest tried to access
/dev/mem between 0-&gt;8000000.</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="color: red; font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><i style="mso-bidi-font-style: normal;"><b>[<span style="mso-spacerun: yes;">&nbsp;&nbsp;
</span>41.020102] open_port Xnest 906 2014</b></i></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="color: red; font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><i style="mso-bidi-font-style: normal;"><b>[<span style="mso-spacerun: yes;">&nbsp;&nbsp;
</span>41.082741] mmap_mem Xnest 906 offset 0 count 134217728</b></i></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>41.108800] Xnest:906 map pfn RAM range req
write-back for 0-8000000, got uncached-minus</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
From the
highlighted lines (output from my hooks), we can see that the Xnest process
tried to access /dev/mem and was denied, and then it later was able to access
it (after the protections were turned off). It then calls <span style="font-family: Courier New, Courier, monospace;">mmap</span> from 0 to
134217728/0x8000000. Unfortunately, this is all the output we get and the <span style="font-family: Courier New, Courier, monospace;">lseek</span>
and <span style="font-family: Courier New, Courier, monospace;">mmap</span> hooks are never triggered again. <br />
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
At this
point, I decided I would have to revisit this approach since I was obviously
missing something related to how character devices are mmap&#8217;ed. I guess having
a nice log of all reads and writes to kernel memory from the rootkit would have
been too easy anyway!</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<i style="mso-bidi-font-style: normal;">Finding the mmap Code</i><br />
<i style="mso-bidi-font-style: normal;"><br /></i></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
My next
approach was to add to my existing kernel hooks to print out the saved
instruction and stack pointers from the userland process that triggers them
(Xnest). These are the saved registers that the kernel uses to return control
flow to userland after servicing some type of request (system call, ioctl,
etc). Gathering of these registers would have the effect of telling me exactly
where in the userland binary the hooks were being placed from.<br />
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Unfortunately,
while I later figured out my code was correct, I thought this approach was
wrong as all the registers pointed into the kernel. This should never occur as
userland code cannot execute within the kernel address space. <span style="mso-spacerun: yes;">&nbsp;</span>I chalked this up to P2 tampering and decided
to move on.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<i style="mso-bidi-font-style: normal;">Symlink Hook</i><br />
<i style="mso-bidi-font-style: normal;"><br /></i></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
At this point,
I was out of methods to fully automate the analysis and also seemingly could
not locate where the userland binary was executing code.<span style="mso-spacerun: yes;">&nbsp;&nbsp;</span>I then decided to start analyzing functions
that I knew would be interesting. My first thought was to track down the
handler for that strange symlink call that had 0xdeadbeef as the first
parameter and the socket file descriptor number as the second. These were
obviously not normal usages of the symlink system call.<br />
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
I could have
got the address of this function from the <span style="font-family: Courier New, Courier, monospace;">check_system_call</span><i style="mso-bidi-font-style: normal;">
</i>output, but at this point I really did not trust anything in memory.
Instead, I did a search with IDA for the immediate value of 0xdeadbeef. That
brought me to this function, which is the symlink hook handler:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="//2.bp.blogspot.com/-q0xg8P_ADBQ/UHSU_o1tpjI/AAAAAAAAAEo/U-xaqXGDwLc/s1600/symlink-deadbeef.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="//2.bp.blogspot.com/-q0xg8P_ADBQ/UHSU_o1tpjI/AAAAAAAAAEo/U-xaqXGDwLc/s400/symlink-deadbeef.jpg" width="400"></a></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
In the first
basic block we see a compare of the first argument with 0xdeadbeef. IDA is also
telling us the function is at 0x804CAEF. This is interesting as we know the
handler has to be in the kernel, but is instead a regular function of our non-PIE
userland binary - as opposed to some hook that gets copied into the kernel
address space. Wanting to test this out, I uninstalled P2, loaded it into GDB,
set a breakpoint on the symlink hook function (in userland), and then installed
it. <br />
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Or I at least
tried to install it&#8230; Instead I got <span style="mso-spacerun: yes;">&nbsp;</span>a
kernel OOPs backtrace inside GDB:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><i style="mso-bidi-font-style: normal;">[13088.506133] int3: 0000 [#1] SMP</i></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.524203]
last sysfs file: /sys/module/vt/parameters/default_utf8</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.544028]
Modules linked in:</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.562724]</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.580913]
Pid: 3469, comm: Xnest Not tainted (2.6.32 #19) VMware Virtual Platform</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.619038]
EIP: 0060:[&lt;f7d02001&gt;] EFLAGS: 00200283 CPU: 0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.638601]
EIP is at 0xf7d02001</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><i style="mso-bidi-font-style: normal;">[13088.657447] EAX: 00000053 EBX: deadbeef
ECX: 00000007 EDX: 000000e0</i></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.676627]
ESI: bffffcf0 EDI: 00000000 EBP: f6758000 ESP: f6759fb0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.696022]<span style="mso-spacerun: yes;">&nbsp; </span>DS: 007b ES: 007b FS: 00d8 GS: 00e0 SS: 0068</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.715510]
Process Xnest (pid: 3469, ti=f6758000 task=f6192e10 task.ti=f6758000)</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.754439]
Stack:</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.773388]<span style="mso-spacerun: yes;">&nbsp; </span>c100309b deadbeef 00000007 00000000 bffffcf0
00000000 bffffdb8 00000053</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.793871]
&lt;0&gt; 0000007b 0000007b 00000000 00000033 00000053 b7fff424 00000073
00200213</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.835624]
&lt;0&gt; bffffcd0 0000007b 00000000 00000000</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.878145]
Call Trace:</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.899668]<span style="mso-spacerun: yes;">&nbsp; </span>[&lt;c100309b&gt;] ?
sysenter_do_call+0x12/0x28</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.921467]
Code: &lt;89&gt; e5 56 81 ec 84 00 00 00 b8 00 30 c3 f7 89 45 b4 81 7d 08 ef be</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.967353]
EIP: [&lt;f7d02001&gt;] 0xf7d02001 SS:ESP 0068:f6759fb0</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13089.017713]
---[ end trace 12c622b2a9c13906 ]---</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13089.041329]
note: Xnest[3469] exited with preempt_count 1</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><i style="mso-bidi-font-style: normal;">[13089.064735] BUG: scheduling while atomic:
Xnest/3469/0x10000001</i></span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
For those who
have not seen kernel backtraces before, the first line:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13088.506133]
int3: 0000 [#1] SMP</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
and this
line:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;">[13089.064735]
BUG: scheduling while atomic: Xnest/3469/0x10000001</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Are basically
telling us that our userland breakpoint (int3 is the debug trap on Intel)
triggered inside the kernel! We also see that EBX is 0xdeadbeef, which we know
is the parameter sent by the rootkit during install.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
At this
point, I realized that P2 was doing some sort of page mirroring between
userland and the kernel, and many things that I saw over two days of analysis
and reversing started to make sense. First, all the references I saw into the
kernel from userland were indeed valid.<span style="mso-spacerun: yes;">&nbsp;
</span>This includes the saved registers I was retrieving from my <span style="font-family: Courier New, Courier, monospace;">mmap</span><i style="mso-bidi-font-style: normal;"> </i>hooks &#8211; meaning my code was
correct.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
It also
clarified why, if I pulled a function from userland memory (e.g 0x804xxxx), its
relocatable references like we saw in the module helper code, were still
0xcacacaca even though they would have to be fixed up for the code to operate.
Pulling the functions from a function&#8217;s kernel memory equivalent revealed the
correct address for references though and all references were fixed up.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Note: Pulling
arbitrary kernel and userland addresses was done using the<i style="mso-bidi-font-style: normal;"> </i><span style="font-family: Courier New, Courier, monospace;">linux_dump_address_range</span> plugin that will be a part of the 2.3
Volatility release and in SVN shortly.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Now that I
knew what to expect between the different addresses, I realized that I could
analyze a function contained in the userland binary with IDA and look at its
in-kernel memory equivalent to help resolve any relocatable addresses.<span style="mso-spacerun: yes;">&nbsp;&nbsp;</span>Having reversed quite a few functions before
this stage, I noticed a pattern of (remember this was before I could fix
relocations):</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>mov<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>eax, 0CACACACAh </span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt; text-indent: .5in;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;">&nbsp; mov<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>[ebp+XXX], eax</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Followed
later by:<br />
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>mov reg, [ebp+XXX]</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>mov reg2, [reg+OFFSET]</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<span style="font-family: Courier New, Courier, monospace; font-size: x-small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call reg2</span></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
So I knew
that the symbol that every function was referencing was some type of global
data structure that at the very least held function pointers.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Now that I could
resolve references, I could finally get the address of this data structure and
analyze it. I then dumped it to disk with the <span style="font-family: Courier New, Courier, monospace;">dump_address_range</span> plugin, and immediately
saw a few things in the output.<br />
<br /></div>
<div class="MsoListParagraphCxSpFirst" style="line-height: normal; margin-bottom: 3.0pt; mso-add-space: auto; mso-list: l1 level1 lfo1; text-indent: -.25in;">
<span style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin;"><span style="mso-list: Ignore;"><span style="font: 7.0pt &quot;Times New Roman&quot;;"></span></span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1) The short at offset 0 held the hidden GID</div>
<div class="MsoListParagraphCxSpLast" style="line-height: normal; margin-bottom: 3.0pt; mso-add-space: auto; mso-list: l1 level1 lfo1; text-indent: -.25in;">
<span style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin;"><span style="mso-list: Ignore;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2)<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;&nbsp; </span></span></span>The ASCII char array after the GID stored the
prefix used to hide files</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
I now knew I
was on to something good&#8230;</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
I then
started reversing the actual symlink handler (previous picture) and noticed
that the first thing it does is check for 0xdeadbeef and skips some code if it
is not the first parameter. If it is the first parameter, then it checks a
magic number, which in all my tests leads to the basic block on the bottom
right. This basic block calls the kernel&#8217;s <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">fget</span>
</span>function with the second file descriptor, which returns the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">file </span></span>structure corresponding to the file
descriptor. This is then stored at offset 0x10f8 within the global structure. <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">sockfd_lookup</span></span><i style="mso-bidi-font-style: normal;"> </i>is then called with the
same file descriptor in order to retrieve its <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">sock</span> </span>structure. This reference is stored at offset 0x10fc within
the global structure.&nbsp;</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Note:<span style="mso-spacerun: yes;">&nbsp; </span>I was able to determine which functions are
being called by finding the instruction that references them from the global
structure (e.g. mov edx, [eax+260h] for fget), then looking at the offset
(260h) in a hex editor view of the global structure I dumped. This gave me a
function address in little endian that I could grep for in System.map to
determine the actual function being called.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
So now that I
knew what the purpose of the strange call to symlink was, which is to store a
reference to the file descriptor that P2 connects to itself with, I then wanted
to see what the rest of the function did.<span style="mso-spacerun: yes;">&nbsp;
</span>The rest of the hook focuses on keeping users from setting symlinks to
hidden files. To accomplish this, the hook walks each portion of the target
path given (every directory and subdirectory as well as the final file), and
calls stat on it. It then checks to see if the current portion of the path is
owned by the hidden GID. It needs to check each part of the path so that a
person cannot symlink deep into the hidden directory tree if they know of a certain
file name. This process can be partially seen in the following picture, notice
that I have commented the system calls and a few other instructions:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="//4.bp.blogspot.com/-rN6WpSbgdMk/UHSWsiMnbTI/AAAAAAAAAE4/p2FEyU_Mj6A/s1600/symlink-hidden-gid-stat.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="//4.bp.blogspot.com/-rN6WpSbgdMk/UHSWsiMnbTI/AAAAAAAAAE4/p2FEyU_Mj6A/s400/symlink-hidden-gid-stat.jpg" width="396"></a></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
The last part
of the hook is the rootkit either returning an error (-2) or allowing the real
symlink system call to process the request. It is hard to tell from the limited
picture, but the left and middle basic blocks at the top come from code paths
that P2 allows to call the real symlink, so they set the check variable
(var_5C) to 0, while the top right basic block will set var_5C to one.&nbsp; This is the
path when P2 wants to stop the symlink operation. We then see in the last basic
block that the return value comes from var_64 which is set by the two basic
blocks above it. This value will either be the -2 error value or whatever value
the actual symlink call produces:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="//4.bp.blogspot.com/-W5Rc6Ba7144/UHSXDWxUqEI/AAAAAAAAAFA/iK5hyVmH0k8/s1600/symlink-bail-if-hidden.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="361" src="//4.bp.blogspot.com/-W5Rc6Ba7144/UHSXDWxUqEI/AAAAAAAAAFA/iK5hyVmH0k8/s400/symlink-bail-if-hidden.jpg" width="400"></a></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
In summary,
the symlink hook serves both as a backdoor communication channel as well as a way
for the rootkit to stop ordinary users from accessing its hidden files on a
live machine.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<u>Other
Hooks</u></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
After
spending two or three days analyzing P2 with Volatility, IDA, and dynamic
analysis through standard Linux tools and my own kernel modules, I pretty much
wanted a break&#8230; but I thought analyzing another system call would be
interesting for the blog post. I then decided to analyze the <span style="font-family: Courier New, Courier, monospace;">sys_read</span><i style="mso-bidi-font-style: normal;"> </i>hook and was presented with the
star destroyer:</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="//4.bp.blogspot.com/-1RgAr0H9qms/UHSXTQhveyI/AAAAAAAAAFI/SUX7D2d_E8M/s1600/starship.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="//4.bp.blogspot.com/-1RgAr0H9qms/UHSXTQhveyI/AAAAAAAAAFI/SUX7D2d_E8M/s640/starship.jpg" width="300"></a></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
Analyzing
this hook was &#8220;interesting&#8221; as it seems to bail on hooking if the file
descriptor sent is &lt;=3 or if the read request is larger than 0x3fff.<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>The rest of the function was pretty
complicated and called into P2&#8217;s <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="mso-bidi-font-style: normal;">ioctl </span></span>infrastructure
which is something that may be its own blog post in the future...</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<u>Misc
Thoughts</u></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
There were a
number of interesting things about P2 that were discovered but did not really
fit into their own category or were not understood enough to post.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoListParagraphCxSpFirst" style="line-height: normal; margin-bottom: 3.0pt; margin-left: 0in; margin-right: 0in; margin-top: 0in; mso-add-space: auto; mso-list: l0 level1 lfo2; tab-stops: 13.5pt; text-indent: 0in;">
<span style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin;"><span style="mso-list: Ignore;">1)<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;
</span></span></span>If you look at the strings output from the
binary, you see many interesting strings &#8211; system call names, error/debug
messages, send_file(), get_file() &#8211; but none of them have any cross references.
I believe this is because P2, like other rootkits, declare their hooks as a C
char array that contains only the opcodes of the hook. Since hooks are never
called directly from the inside the rookit and instead are only used to
override function pointers, RE tools like IDA will not detect/analyze them as
code or detect any of the references.<span style="mso-spacerun: yes;">&nbsp;&nbsp;
</span>This makes finding the code that does the hooking more difficult.</div>
<div class="MsoListParagraphCxSpMiddle" style="line-height: normal; margin-bottom: 3.0pt; margin-left: 0in; margin-right: 0in; margin-top: 0in; mso-add-space: auto; tab-stops: 13.5pt;">
<br /></div>
<div class="MsoListParagraphCxSpMiddle" style="line-height: normal; margin-bottom: 3.0pt; margin-left: 0in; margin-right: 0in; margin-top: 0in; mso-add-space: auto; mso-list: l0 level1 lfo2; tab-stops: 13.5pt; text-indent: 0in;">
<span style="mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin;"><span style="mso-list: Ignore;">2)<span style="font: 7.0pt &quot;Times New Roman&quot;;">&nbsp;&nbsp;
</span></span></span>After loading, P2 sits in a loop of:</div>
<div class="MsoListParagraphCxSpMiddle" style="line-height: normal; margin-bottom: 3.0pt; margin-left: 0in; margin-right: 0in; margin-top: 0in; mso-add-space: auto; tab-stops: 13.5pt;">
<br /></div>
<div class="MsoListParagraphCxSpMiddle" style="line-height: normal; margin-bottom: 3.0pt; margin-left: 0in; margin-right: 0in; margin-top: 0in; mso-add-space: auto; tab-stops: 13.5pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ioctl(&lt;fd sent
to symlink&gt;, &#8230;.)</span></div>
<div class="MsoListParagraphCxSpMiddle" style="line-height: normal; margin-bottom: 3.0pt; margin-left: 0in; margin-right: 0in; margin-top: 0in; mso-add-space: auto; tab-stops: 13.5pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>getsockopt(&lt;fd
sent to symlink&gt;, &#8230;)</span></div>
<div class="MsoListParagraphCxSpMiddle" style="line-height: normal; margin-bottom: 3.0pt; margin-left: 0in; margin-right: 0in; margin-top: 0in; mso-add-space: auto; tab-stops: 13.5pt;">
<span style="font-family: &quot;Courier New&quot;,Courier,monospace; font-size: x-small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>nanosleep()</span></div>
<div class="MsoListParagraphCxSpMiddle" style="line-height: normal; margin-bottom: 3.0pt; margin-left: 0in; margin-right: 0in; margin-top: 0in; mso-add-space: auto; tab-stops: 13.5pt;">
<br /></div>
<div class="MsoListParagraphCxSpLast" style="line-height: normal; margin-bottom: 3.0pt; margin-left: 0in; margin-right: 0in; margin-top: 0in; mso-add-space: auto; tab-stops: 13.5pt;">
I have not fully analyzed the ioctl or getsockopt handlers
yet, but they are main priorities for future analysis.<span style="mso-spacerun: yes;">&nbsp; </span>We also see many calls to ioctl with a
special value from a number of the hooks, so it is definitely an important code
path.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<u>Conclusion</u></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
We have
showed how to detect and analyze P2 in a number of ways. Between the userland
anti-debugging techniques, the quirky way of loading a 30 instruction module,
the statically declared hooks, and the page mirroring (which is not 100%
understood yet), P2 has proven to be by far the most interesting piece of Linux
malware I have seen. I will definitely be spending more time with it in the
future as I know I have not yet analyzed large pieces of its functionality.</div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
<br /></div>
<div class="MsoNormal" style="line-height: normal; margin-bottom: 3.0pt;">
If you have
any questions please either comment on the blog post or you can find me on
Twitter <a href="http://www.twitter.com/attrc">(@attrc</a>).</div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'><span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/11014708860635242525' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/11014708860635242525' rel='author' title='author profile'>
<span itemprop='name'>Andrew Case</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='https://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html' itemprop='url'/>
<a class='timestamp-link' href='https://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2012-10-10T11:47:00-04:00'>11:47 AM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-2136047950'>
<a href='https://www.blogger.com/post-edit.g?blogID=7693961727488638788&postID=7612350045286977534&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=7612350045286977534&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=7612350045286977534&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=7612350045286977534&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=7612350045286977534&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=7693961727488638788&postID=7612350045286977534&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'><span class='post-labels'>
Labels:
<a href='https://volatility-labs.blogspot.com/search/label/kernel' rel='tag'>kernel</a>,
<a href='https://volatility-labs.blogspot.com/search/label/malware' rel='tag'>malware</a>,
<a href='https://volatility-labs.blogspot.com/search/label/movp' rel='tag'>movp</a>,
<a href='https://volatility-labs.blogspot.com/search/label/volatility' rel='tag'>volatility</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'><span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>1 comment:</h4>
<div class='comments-content'>
<script async='async' src='' type='text/javascript'></script>
<script type='text/javascript'>
    (function() {
      var items = null;
      var msgs = null;
      var config = {};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        var text = (entry &&
                    ((entry.content && entry.content.$t) ||
                     (entry.summary && entry.summary.$t))) ||
            '';
        if (entry && entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + text + '</span>';
            }
          }
        }
        return text;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          replybox.src = '';
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
  </script>
<div id='comment-holder'>
<div class="comment-thread toplevel-thread"><ol id="top-ra"><li class="comment" id="c1824790666346505606"><div class="avatar-image-container"><img src="//resources.blogblog.com/img/blank.gif" alt=""/></div><div class="comment-block"><div class="comment-header"><cite class="user">Anonymous</cite><span class="icon user "></span><span class="datetime secondary-text"><a rel="nofollow" href="https://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html?showComment=1367538721238#c1824790666346505606">May 2, 2013 at 7:52 PM</a></span></div><p class="comment-content">Amazing.  I was simply searching Google to find out what Phalanx RPM was on the SUSE page, clicked this and read all of it.  Great post, slightly over my head, but not at the same time.  Its more of a Linux unfamiliarity.  I&#39;ve decided to run it solely, so I&#39;m on my way!  <br><br>Excellent reading &amp; hats off; professional status, all the way!  =)</p><span class="comment-actions secondary-text"><a class="comment-reply" target="_self" data-comment-id="1824790666346505606">Reply</a><span class="item-control blog-admin blog-admin pid-385530721"><a target="_self" href="https://www.blogger.com/delete-comment.g?blogID=7693961727488638788&amp;postID=1824790666346505606">Delete</a></span></span></div><div class="comment-replies"><div id="c1824790666346505606-rt" class="comment-thread inline-thread hidden"><span class="thread-toggle thread-expanded"><span class="thread-arrow"></span><span class="thread-count"><a target="_self">Replies</a></span></span><ol id="c1824790666346505606-ra" class="thread-chrome thread-expanded"><div></div><div id="c1824790666346505606-continue" class="continue"><a class="comment-reply" target="_self" data-comment-id="1824790666346505606">Reply</a></div></ol></div></div><div class="comment-replybox-single" id="c1824790666346505606-ce"></div></li></ol><div id="top-continue" class="continue"><a class="comment-reply" target="_self">Add comment</a></div><div class="comment-replybox-thread" id="top-ce"></div><div class="loadmore hidden" data-post-id="7612350045286977534"><a target="_self">Load more...</a></div></div>
</div>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<p>
</p>
<a href='https://www.blogger.com/comment-iframe.g?blogID=7693961727488638788&postID=7612350045286977534' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/1706263374-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
<div id='backlinks-container'>
<div id='Blog1_backlinks-container'>
</div>
</div>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://volatility-labs.blogspot.com/2012/10/solving-grrcon-network-forensics.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://volatility-labs.blogspot.com/2012/10/omfw-2012-reconstructing-mbr-and-mft.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://volatility-labs.blogspot.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://volatility-labs.blogspot.com/feeds/7612350045286977534/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget TextList' data-version='1' id='TextList1'>
<h2>Volatility Links</h2>
<div class='widget-content'>
<ul>
<li><a href='http://www.volatilityfoundation.org/'>The Volatility Foundation</a></li>
<li><a href='http://www.amazon.com/gp/product/1118825098/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1118825098&linkCode=as2&tag=malwacookb-20'>The Art of Memory Forensics</a></li>
<li><a href='http://www.memoryanalysis.net'>Memory Analysis Site</a></li>
<li><a href='https://volatility-labs.blogspot.com/2020/11/the-2020-volatility-plugin-contest-results.html'>2020 Plugin Contest</a></li>
<li><a href="https://volatility-labs.blogspot.com/2019/11/results-from-2019-volatility-contests.html">2019 Plugin & Analysis Contests</a></li>
<li><a href="https://volatility-labs.blogspot.com/2018/11/results-from-annual-2018-volatility-contests.html">2018 Plugin & Analysis Contests</a></li>
<li><a href="https://volatility-labs.blogspot.com/2017/11/results-from-5th-annual-2017-volatility.html">2017 Plugin Contest</a></li>
<li><a href="https://volatility-labs.blogspot.com/2016/12/results-from-2016-volatility-plugin.html">2016 Plugin Contest</a></li>
<li><a href="http://www.volatilityfoundation.org/2015" target="_new">2015 Plugin Contest</a></li>
<li><a href="http://www.volatilityfoundation.org/2014-cjpn" target="_new">2014 Plugin Contest</a></li>
<li><a href="http://www.volatilityfoundation.org/2013-c19yz" target="_new">2013 Plugin Contest</a></li>
<li><a href="https://github.com/volatilityfoundation" target="_new">Code Repository</a></li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("TextList1"));' rel='nofollow' target='configTextList1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget HTML' data-version='1' id='HTML1'>
<h2 class='title'>Volatility on Twitter</h2>
<div class='widget-content'>
<a class="twitter-timeline"  href="https://twitter.com/volatility"  data-widget-id="370242030368088065">Tweets by @volatility</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("HTML1"));' rel='nofollow' target='configHTML1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2021/'>
2021
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2021/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2021/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2020/'>
2020
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2020/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2020/05/'>
May
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2019/'>
2019
</a>
<span class='post-count' dir='ltr'>(5)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2019/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2019/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2019/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2019/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2018/'>
2018
</a>
<span class='post-count' dir='ltr'>(4)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2018/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2018/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2018/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2017/'>
2017
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2017/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2017/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2017/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2016/'>
2016
</a>
<span class='post-count' dir='ltr'>(9)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2016/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2016/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2016/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2016/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2016/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/'>
2015
</a>
<span class='post-count' dir='ltr'>(12)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/07/'>
July
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2015/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/'>
2014
</a>
<span class='post-count' dir='ltr'>(27)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/09/'>
September
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/08/'>
August
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/07/'>
July
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/04/'>
April
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2014/01/'>
January
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/'>
2013
</a>
<span class='post-count' dir='ltr'>(39)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/06/'>
June
</a>
<span class='post-count' dir='ltr'>(9)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/05/'>
May
</a>
<span class='post-count' dir='ltr'>(15)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/04/'>
April
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2013/01/'>
January
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2012/'>
2012
</a>
<span class='post-count' dir='ltr'>(34)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2012/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2012/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2012/10/'>
October
</a>
<span class='post-count' dir='ltr'>(14)</span>
<ul class='posts'>
<li><a href='https://volatility-labs.blogspot.com/2012/10/omfw-2012-mining-pfn-database-for.html'>OMFW 2012: Mining the PFN Database for Malware Art...</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/omfw-2012-analysis-of-process-token.html'>OMFW 2012: The Analysis of Process Token Privileges</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/reverse-engineering-poison-ivys.html'>Reverse Engineering Poison Ivy&#39;s Injected Code Fra...</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/movp-for-volatility-22-and-omfw-2012.html'>MoVP for Volatility 2.2 and OMFW 2012 Wrap-Up</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/omfw-2012-datalore-android-memory.html'>OMFW 2012: Datalore: Android Memory Analysis</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/omfw-2012-analyzing-linux-kernel.html'>OMFW 2012: Analyzing Linux Kernel Rootkits with Vo...</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/solving-grrcon-network-forensics.html'>Solving the GrrCon Network Forensics Challenge wit...</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html'>Phalanx 2 Revealed: Using Volatility to Analyze an...</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/omfw-2012-reconstructing-mbr-and-mft.html'>OMFW 2012: Reconstructing the MBR and MFT from Memory</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/omfw-2012-malware-in-windows-gui.html'>OMFW 2012: Malware In the Windows GUI Subsystem</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/movp-44-cache-rules-everything-around.html'>MoVP 4.4 Cache Rules Everything Around Me(mory)</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/movp-43-recovering-master-boot-records.html'>MoVP 4.3 Recovering Master Boot Records (MBRs) fro...</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/movp-43-taking-screenshots-from-memory.html'>MoVP 4.2 Taking Screenshots from Memory Dumps</a></li>
<li><a href='https://volatility-labs.blogspot.com/2012/10/movp-41-detecting-malware-with-gdi.html'>MoVP 4.1 Detecting Malware with GDI Timers and Cal...</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://volatility-labs.blogspot.com/2012/09/'>
September
</a>
<span class='post-count' dir='ltr'>(17)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' rel='nofollow' target='configBlogArchive1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget Profile' data-version='1' id='Profile1'>
<h2>Contributors</h2>
<div class='widget-content'>
<ul>
<li><a class='profile-name-link g-profile' href='https://www.blogger.com/profile/10359512733052592184' style='background-image: url(//www.blogger.com/img/logo-16.png);'>AW</a></li>
<li><a class='profile-name-link g-profile' href='https://www.blogger.com/profile/11014708860635242525' style='background-image: url(//www.blogger.com/img/logo-16.png);'>Andrew Case</a></li>
<li><a class='profile-name-link g-profile' href='https://www.blogger.com/profile/11247452583345130208' style='background-image: url(//www.blogger.com/img/logo-16.png);'>Dave Lassalle</a></li>
<li><a class='profile-name-link g-profile' href='https://www.blogger.com/profile/16089000750284843256' style='background-image: url(//www.blogger.com/img/logo-16.png);'>Jamie Levy</a></li>
<li><a class='profile-name-link g-profile' href='https://www.blogger.com/profile/00592192196631437377' style='background-image: url(//www.blogger.com/img/logo-16.png);'>Kristel Faris</a></li>
<li><a class='profile-name-link g-profile' href='https://www.blogger.com/profile/17377327006242921434' style='background-image: url(//www.blogger.com/img/logo-16.png);'>Michael Hale Ligh</a></li>
<li><a class='profile-name-link g-profile' href='https://www.blogger.com/profile/11924663493124924408' style='background-image: url(//www.blogger.com/img/logo-16.png);'>Nick</a></li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("Profile1"));' rel='nofollow' target='configProfile1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget BlogList' data-version='1' id='BlogList1'>
<h2 class='title'>Blogroll</h2>
<div class='widget-content'>
<div class='blog-list-container' id='BlogList1_container'>
<ul id='BlogList1_blogs'>
<li style='display: block;'>
<div class='blog-icon'>
<img data-lateloadsrc='https://lh4.googleusercontent.com/proxy/eodytH_MaUkfNJvrP2wCbFD0i2QqI7xxP5fSP1zbsUdfHovUjZMJ0E-THrj1jqNgC9YudUmMRMU=s0-d' height='16' width='16'/>
</div>
<div class='blog-content'>
<div class='blog-title'>
<a href='https://www.volexity.com' target='_blank'>
Blog &#8211; Volexity</a>
</div>
<div class='item-content'>
<span class='item-title'>
<a href='https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/?utm_source=rss&utm_medium=rss&utm_campaign=active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities' target='_blank'>
Operation Exchange Marauder: Active Exploitation of Multiple Zero-Day Microsoft Exchange Vulnerabilities
</a>
</span>

                      -
                    
<span class='item-snippet'>
Volexity is seeing active in-the-wild exploitation of multiple Microsoft 
Exchange vulnerabilities used to steal e-mail and compromise networks. 
These attac...
</span>
<div class='item-time'>
2 months ago
</div>
</div>
</div>
<div style='clear: both;'></div>
</li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogList1"));' rel='nofollow' target='configBlogList1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("Attribution1"));' rel='nofollow' target='configAttribution1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script src='https://apis.google.com/js/plusone.js' type='text/javascript'></script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3464975383-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY4fZET6wzP6L1Jb2pDI98BcA_KMJA:1621735100896';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d7693961727488638788','//volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html','7693961727488638788');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '7693961727488638788', 'title': 'Volatility Labs', 'url': 'https://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html', 'canonicalUrl': 'https://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html', 'homepageUrl': 'https://volatility-labs.blogspot.com/', 'searchUrl': 'https://volatility-labs.blogspot.com/search', 'canonicalHomepageUrl': 'https://volatility-labs.blogspot.com/', 'blogspotFaviconUrl': 'https://volatility-labs.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': 'UA-6968853-8', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Volatility Labs - Atom\x22 href\x3d\x22https://volatility-labs.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Volatility Labs - RSS\x22 href\x3d\x22https://volatility-labs.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Volatility Labs - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/7693961727488638788/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Volatility Labs - Atom\x22 href\x3d\x22https://volatility-labs.blogspot.com/feeds/7612350045286977534/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/951198144-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/751ccdc09ff31f1f', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 300, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '7612350045286977534', 'postImageThumbnailUrl': 'http://4.bp.blogspot.com/-edFWjeI95CY/UHShRo70D3I/AAAAAAAAA-I/VBnCgEfz2yc/s72-c/phalanx2+flag.png', 'postImageUrl': 'http://4.bp.blogspot.com/-edFWjeI95CY/UHShRo70D3I/AAAAAAAAA-I/VBnCgEfz2yc/s320/phalanx2+flag.png', 'pageName': 'Phalanx 2 Revealed: Using Volatility to Analyze an Advanced Linux Rootkit', 'pageTitle': 'Volatility Labs: Phalanx 2 Revealed: Using Volatility to Analyze an Advanced Linux Rootkit'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Phalanx 2 Revealed: Using Volatility to Analyze an Advanced Linux Rootkit', 'description': 'Month of Volatility Plugins       In this blog post I will analyze the Phalanax2 rootkit using both Volatility as well as traditional malwar...', 'featuredImage': '//4.bp.blogspot.com/-edFWjeI95CY/UHShRo70D3I/AAAAAAAAA-I/VBnCgEfz2yc/s320/phalanx2+flag.png', 'url': 'https://volatility-labs.blogspot.com/2012/10/phalanx-2-revealed-using-volatility-to.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 7612350045286977534}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/840662228-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1050234869-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_TextListView', new _WidgetInfo('TextList1', 'sidebar-right-1', document.getElementById('TextList1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'sidebar-right-1', document.getElementById('HTML1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-1', document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogListView', new _WidgetInfo('BlogList1', 'sidebar-right-1', document.getElementById('BlogList1'), {'numItemsToShow': 0, 'totalItems': 1}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>