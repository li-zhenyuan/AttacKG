<!doctype html><html lang="en"><head><script defer src="https://cdn.optimizely.com/js/16180790160.js"></script><title data-rh="true">Code Signing Certificate Cloning Attacks and Defenses | by Matt Graeber | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2019-10-10T18:05:37.409Z"/><meta data-rh="true" name="title" content="Code Signing Certificate Cloning Attacks and Defenses | by Matt Graeber | Posts By SpecterOps Team Members"/><meta data-rh="true" property="og:title" content="Code Signing Certificate Cloning Attacks and Defenses"/><meta data-rh="true" property="twitter:title" content="Code Signing Certificate Cloning Attacks and Defenses"/><meta data-rh="true" name="twitter:site" content="@specterops"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/6f98657fc6ec"/><meta data-rh="true" property="al:android:url" content="medium://p/6f98657fc6ec"/><meta data-rh="true" property="al:ios:url" content="medium://p/6f98657fc6ec"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any vendor for that matter)?” Imagine you’re working in a SOC…"/><meta data-rh="true" property="og:description" content="Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any…"/><meta data-rh="true" property="twitter:description" content="Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any…"/><meta data-rh="true" property="og:url" content="https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"/><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/1*fLrpueTtcZk_Gx5qOIxvsA.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*fLrpueTtcZk_Gx5qOIxvsA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://mattifestation.medium.com"/><meta data-rh="true" name="author" content="Matt Graeber"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="11 min read"/><meta data-rh="true" name="parsely-post-id" content="6f98657fc6ec"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://mattifestation.medium.com"/><link data-rh="true" rel="canonical" href="https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/6f98657fc6ec"/><link data-rh="true" rel="icon" href="https://miro.medium.com/fit/c/256/256/1*D-FDlfkqivRBQZoESrwtqw.png"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*fLrpueTtcZk_Gx5qOIxvsA.png"],"url":"https:\u002F\u002Fposts.specterops.io\u002Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec","dateCreated":"2017-12-22T14:50:40.211Z","datePublished":"2017-12-22T14:50:40.211Z","dateModified":"2019-10-10T18:05:37.788Z","headline":"Code Signing Certificate Cloning Attacks and Defenses","name":"Code Signing Certificate Cloning Attacks and Defenses","description":"Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any vendor for that matter)?” Imagine you’re working in a SOC…","identifier":"6f98657fc6ec","keywords":["Lite:true","Tag:Security","Tag:Code Signing","Publication:specter-ops-posts","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:0"],"author":{"@type":"Person","name":"Matt Graeber","url":"https:\u002F\u002Fmattifestation.medium.com"},"creator":["Matt Graeber"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":253,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F506\u002F1*aa0HsXZL43r95TuTJlJNPw.png"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"}</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="538" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:25px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{position:absolute}.u{top:0}.v{left:0}.w{right:0}.x{z-index:500}.y{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ah{max-width:1192px}.ai{min-width:0}.aj{width:100%}.ak{height:65px}.an{flex:1 0 auto}.ao{fill:rgba(25, 25, 25, 1)}.ap{flex:0 0 auto}.aq{margin-left:16px}.ar{color:rgba(128, 128, 183, 1)}.as{fill:rgba(128, 128, 183, 1)}.at{font-size:inherit}.au{border:inherit}.av{font-family:inherit}.aw{letter-spacing:inherit}.ax{font-weight:inherit}.ay{padding:0}.az{margin:0}.bd:disabled{cursor:default}.be:disabled{color:rgba(163, 208, 162, 0.5)}.bf:disabled{fill:rgba(163, 208, 162, 0.5)}.bg{border-top:none}.bh{background-color:rgba(30, 24, 75, 1)}.bj{height:54px}.bk{overflow:hidden}.bl{margin-right:40px}.bm{height:36px}.bn{width:152px}.bo{overflow:auto}.bp{flex:0 1 auto}.bq{list-style-type:none}.br{line-height:40px}.bs{white-space:nowrap}.bt{overflow-x:auto}.bu{align-items:flex-start}.bv{margin-top:20px}.bw{padding-top:20px}.bx{height:80px}.by{height:20px}.bz{margin-right:15px}.ca{margin-left:15px}.cb:first-child{margin-left:0}.cc{min-width:1px}.cd{background-color:rgba(174, 174, 202, 1)}.ce{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.cf{font-size:13px}.cg{line-height:20px}.ch{color:rgba(235, 234, 250, 1)}.ci{text-transform:uppercase}.cj{letter-spacing:1px}.ck{color:inherit}.cl{fill:inherit}.co:disabled{color:rgba(195, 194, 219, 1)}.cp:disabled{fill:rgba(195, 194, 219, 1)}.cq{margin-bottom:0px}.cr{margin-top:0px}.cs{height:119px}.cv{padding-left:24px}.cw{padding-right:24px}.cx{margin-left:auto}.cy{margin-right:auto}.cz{max-width:728px}.da{box-sizing:border-box}.db{background:rgba(255, 255, 255, 1)}.dc{border:1px solid rgba(230, 230, 230, 1)}.dd{border-radius:4px}.de{box-shadow:0 1px 4px rgba(230, 230, 230, 1)}.df{max-height:100vh}.dg{overflow-y:auto}.dh{top:calc(100vh + 100px)}.di{bottom:calc(100vh + 100px)}.dj{width:10px}.dk{pointer-events:none}.dl{word-break:break-word}.dm{word-wrap:break-word}.dn:after{display:block}.do:after{content:""}.dp:after{clear:both}.dq{max-width:680px}.dr{line-height:1.23}.ds{letter-spacing:0}.dt{font-style:normal}.du{font-family:fell, Georgia, Cambria, "Times New Roman", Times, serif}.ep{margin-bottom:-0.27em}.eq{color:rgba(41, 41, 41, 1)}.er{margin-top:32px}.es{justify-content:space-between}.ew{border-radius:50%}.ex{height:48px}.ey{width:48px}.ez{margin-left:12px}.fa{font-size:14px}.fb{margin-bottom:2px}.fd{max-height:20px}.fe{text-overflow:ellipsis}.ff{display:-webkit-box}.fg{-webkit-line-clamp:1}.fh{-webkit-box-orient:vertical}.fk:disabled{color:rgba(117, 117, 117, 1)}.fl:disabled{fill:rgba(117, 117, 117, 1)}.fm{margin-left:8px}.fn{color:rgba(255, 255, 255, 1)}.fo{padding:0px 8px 1px}.fp{fill:rgba(255, 255, 255, 1)}.fq{background:rgba(128, 128, 183, 1)}.fr{border-color:rgba(128, 128, 183, 1)}.fu:disabled{cursor:inherit}.fv:disabled{opacity:0.3}.fw:disabled:hover{background:rgba(128, 128, 183, 1)}.fx:disabled:hover{border-color:rgba(128, 128, 183, 1)}.fy{border-radius:99em}.fz{border-width:1px}.ga{border-style:solid}.gb{display:inline-block}.gc{text-decoration:none}.gd{color:rgba(117, 117, 117, 1)}.ge{align-items:flex-end}.gm{padding-right:6px}.gp{fill:rgba(117, 117, 117, 1)}.gq{margin-right:8px}.gr{line-height:1.58}.gs{letter-spacing:-0.004em}.gt{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.ho{margin-bottom:-0.46em}.hp{font-style:italic}.hq{line-height:1.12}.hr{letter-spacing:-0.022em}.hs{font-weight:500}.il{margin-bottom:-0.28em}.ir{text-decoration:underline}.ix{padding:20px}.iy{background:rgba(242, 242, 242, 1)}.iz{line-height:1.18}.ja{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.jb{font-size:16px}.jc{margin-top:-0.09em}.jd{margin-bottom:-0.09em}.je{white-space:pre-wrap}.jf{list-style-type:decimal}.jg{margin-left:30px}.jh{padding-left:0px}.jn{margin-bottom:14px}.jo{padding-top:24px}.jp{padding-bottom:10px}.jq{background-color:rgba(8, 8, 8, 1)}.jr{height:3px}.js{width:3px}.jt{margin-right:20px}.jz{clear:both}.ka{margin:auto}.kb{position:relative}.kc{padding-bottom:56.206088992974244%}.kd{height:0}.ke{margin-top:10px}.kf{text-align:center}.ki{padding-bottom:NaN%}.ko{max-width:1197px}.kq{cursor:zoom-in}.kr{z-index:auto}.kt{opacity:0}.ku{transition:opacity 100ms 400ms}.kv{height:100%}.kw{will-change:transform}.kx{transform:translateZ(0)}.ky{background-color:rgba(242, 242, 242, 1)}.kz{padding-bottom:41.01921470342523%}.la{filter:blur(20px)}.lb{transform:scale(1.1)}.lc{visibility:visible}.ld{max-width:1596px}.le{padding-bottom:32.769423558897245%}.lf{max-width:775px}.lg{padding-bottom:177.93548387096774%}.lh{will-change:opacity}.li{position:fixed}.lj{width:188px}.lk{left:50%}.ll{transform:translateX(406px)}.lm{top:calc(65px + 54px + 14px)}.lp{will-change:opacity, transform}.lq{transform:translateY(159px)}.ls{width:131px}.lt{flex-direction:column}.lu{padding-bottom:28px}.lv{border-bottom:1px solid rgba(230, 230, 230, 1)}.lw{padding-bottom:20px}.lx{padding-top:2px}.ly{max-height:120px}.lz{-webkit-line-clamp:6}.ma{padding-top:28px}.mb{margin-bottom:19px}.mc{margin-left:-3px}.mi{outline:0}.mj{border:0}.mk{user-select:none}.ml{cursor:pointer}.mm> svg{pointer-events:none}.mo{-webkit-user-select:none}.my button{text-align:left}.mz{opacity:1}.na{padding-right:9px}.nb{flex-direction:row}.nk{margin-top:40px}.nl{flex-wrap:wrap}.nm{margin-top:25px}.nn{margin-bottom:8px}.no{line-height:22px}.np{border-radius:3px}.nq{padding:5px 10px}.nr{max-width:155px}.nv{top:1px}.od{margin-left:-1px}.om{padding-right:8px}.on{padding-top:32px}.oo{border-top:1px solid rgba(230, 230, 230, 1)}.op{margin-bottom:25px}.or{margin-bottom:32px}.os{min-height:80px}.ox{width:80px}.oy{padding-left:102px}.pa{line-height:18px}.pb{letter-spacing:0.077em}.pc{margin-bottom:6px}.pd{font-size:22px}.pe{line-height:28px}.pf{padding:4px 12px 6px}.pg{max-width:555px}.ph{max-width:450px}.pi{line-height:24px}.pj{display:none}.pl{max-width:550px}.pm{margin-top:5px}.pn{height:40px}.po{width:40px}.pp{font-size:12px}.pq{line-height:16px}.pr{letter-spacing:0.083em}.ps{padding-top:8px}.pt{margin-bottom:40px}.pu{margin-top:24px}.pv{padding-bottom:16px}.pw{margin-bottom:24px}.rs{flex-grow:0}.rt{padding-bottom:24px}.ru{max-width:500px}.ry{padding-bottom:8px}.sl{padding-bottom:100%}.sw{padding:60px 0}.sx{background-color:rgba(0, 0, 0, 0.9)}.sz{padding-bottom:48px}.ta{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.tb{margin:0 -12px}.tc{margin:0 12px}.td{flex:1 1 0}.tg:disabled{color:rgba(255, 255, 255, 0.7)}.th:disabled{fill:rgba(255, 255, 255, 0.7)}.ti{font-size:20px}.tj{color:rgba(255, 255, 255, 0.98)}.tk{color:rgba(255, 255, 255, 0.7)}.tl{height:22px}.tm{width:200px}.ts{margin-right:16px}.ba:hover{cursor:pointer}.bb:hover{color:rgba(110, 110, 154, 1)}.bc:hover{fill:rgba(110, 110, 154, 1)}.cm:hover{color:rgba(245, 244, 253, 1)}.cn:hover{fill:rgba(245, 244, 253, 1)}.fj:hover{text-decoration:underline}.fs:hover{background:rgba(110, 110, 154, 1)}.ft:hover{border-color:rgba(110, 110, 154, 1)}.gn:hover{color:rgba(25, 25, 25, 1)}.go:hover{fill:rgba(25, 25, 25, 1)}.mq:hover{fill:rgba(117, 117, 117, 1)}.te:hover{color:rgba(255, 255, 255, 0.99)}.tf:hover{fill:rgba(255, 255, 255, 0.99)}.ks:focus{transform:scale(1.01)}.mp:focus{fill:rgba(117, 117, 117, 1)}.mn:active{border-style:none}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ag{margin:0 64px}.el{font-size:48px}.em{margin-top:0.55em}.en{line-height:60px}.eo{letter-spacing:-0.011em}.gl{margin-left:30px}.hk{font-size:21px}.hl{margin-top:2em}.hm{line-height:32px}.hn{letter-spacing:-0.003em}.ih{font-size:30px}.ii{margin-top:1.95em}.ij{line-height:36px}.ik{letter-spacing:0}.iq{margin-top:0.86em}.iw{margin-top:56px}.jm{margin-top:1.05em}.jy{margin-top:1.25em}.kn{margin-top:1.91em}.mh{margin-right:5px}.mx{margin-top:5px}.nj{padding-left:6px}.nx{display:inline-block}.oc{width:8px}.ok{padding-left:7px}.ol{top:3px}.qh{font-size:22px}.qi{line-height:28px}.qv{width:calc(100% + 32px)}.qw{margin-left:-16px}.qx{margin-right:-16px}.ro{padding-left:16px}.rp{padding-right:16px}.rq{flex-basis:25%}.rr{max-width:25%}.sh{font-size:16px}.si{line-height:20px}.su{min-width:70px}.sv{min-height:70px}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.gk{margin-left:30px}.kg{margin-left:auto}.kh{text-align:center}.mg{margin-right:5px}.mw{margin-top:5px}.ni{padding-left:6px}.nw{display:inline-block}.ob{width:8px}.oi{padding-left:7px}.oj{top:3px}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.gj{margin-left:30px}.mf{margin-right:5px}.mv{margin-top:5px}.ng{padding-left:6px}.nh{top:3px}.nu{display:inline-block}.oa{width:8px}.oh{padding-left:3px}.rx{margin-right:16px}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.al{height:56px}.am{display:flex}.bi{display:block}.ct{margin-bottom:0px}.cu{height:110px}.eu{margin-top:32px}.ev{flex-direction:column-reverse}.gh{margin-bottom:30px}.gi{margin-left:0px}.me{margin-left:8px}.mt{margin-top:2px}.mu{margin-right:8px}.ne{padding-left:6px}.nf{top:3px}.nt{display:inline-block}.nz{width:8px}.oe{margin-left:-4px}.og{padding-left:3px}.oq{padding-top:0}.ot{margin-bottom:24px}.ou{align-items:center}.ov{width:102px}.ow{position:relative}.oz{padding-left:0}.pk{margin-top:24px}.px{padding-bottom:12px}.py{margin-top:16px}.rw{margin-right:16px}.sj{margin-left:16px}.sk{margin-right:0px}.sy{padding:32px 0}.tn{width:140px}.to{margin-bottom:16px}.tp{margin-top:30px}.tq{width:100%}.tr{flex-direction:row}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ab{margin:0 24px}.dv{font-size:34px}.dw{margin-top:0.56em}.dx{line-height:42px}.dy{letter-spacing:-0.016em}.et{margin-top:32px}.fc{margin-bottom:0px}.gf{margin-bottom:30px}.gg{margin-left:0px}.gu{font-size:18px}.gv{margin-top:1.56em}.gw{line-height:28px}.gx{letter-spacing:-0.003em}.ht{font-size:22px}.hu{margin-top:1.2em}.hv{letter-spacing:0}.im{margin-top:0.67em}.is{margin-top:40px}.ji{margin-top:1.34em}.ju{margin-top:0.93em}.kj{margin-top:1.41em}.md{margin-left:8px}.mr{margin-top:2px}.ms{margin-right:8px}.nc{padding-left:6px}.nd{top:3px}.ns{display:inline-block}.ny{width:8px}.of{padding-left:3px}.pz{font-size:20px}.qa{line-height:24px}.qj{width:calc(100% + 24px)}.qk{margin-left:-12px}.ql{margin-right:-12px}.qy{padding-left:12px}.qz{padding-right:12px}.ra{flex-basis:100%}.rb{max-width:100%}.rv{margin-right:16px}.rz{font-size:16px}.sa{line-height:20px}.sm{min-width:48px}.sn{min-height:48px}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.af{margin:0 64px}.eh{font-size:48px}.ei{margin-top:0.55em}.ej{line-height:60px}.ek{letter-spacing:-0.011em}.hg{font-size:21px}.hh{margin-top:2em}.hi{line-height:32px}.hj{letter-spacing:-0.003em}.id{font-size:30px}.ie{margin-top:1.95em}.if{line-height:36px}.ig{letter-spacing:0}.ip{margin-top:0.86em}.iv{margin-top:56px}.jl{margin-top:1.05em}.jx{margin-top:1.25em}.km{margin-top:1.91em}.qf{font-size:22px}.qg{line-height:28px}.qs{width:calc(100% + 32px)}.qt{margin-left:-16px}.qu{margin-right:-16px}.rk{padding-left:16px}.rl{padding-right:16px}.rm{flex-basis:25%}.rn{max-width:25%}.sf{font-size:16px}.sg{line-height:20px}.ss{min-width:70px}.st{min-height:70px}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.ae{margin:0 48px}.ed{font-size:48px}.ee{margin-top:0.55em}.ef{line-height:60px}.eg{letter-spacing:-0.011em}.hc{font-size:21px}.hd{margin-top:2em}.he{line-height:32px}.hf{letter-spacing:-0.003em}.hz{font-size:30px}.ia{margin-top:1.95em}.ib{line-height:36px}.ic{letter-spacing:0}.io{margin-top:0.86em}.iu{margin-top:56px}.jk{margin-top:1.05em}.jw{margin-top:1.25em}.kl{margin-top:1.91em}.qd{font-size:22px}.qe{line-height:28px}.qp{width:calc(100% + 28px)}.qq{margin-left:-14px}.qr{margin-right:-14px}.rg{padding-left:14px}.rh{padding-right:14px}.ri{flex-basis:50%}.rj{max-width:50%}.sd{font-size:16px}.se{line-height:20px}.sq{min-width:48px}.sr{min-height:48px}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ac{margin:0 24px}.dz{font-size:34px}.ea{margin-top:0.56em}.eb{line-height:42px}.ec{letter-spacing:-0.016em}.gy{font-size:18px}.gz{margin-top:1.56em}.ha{line-height:28px}.hb{letter-spacing:-0.003em}.hw{font-size:22px}.hx{margin-top:1.2em}.hy{letter-spacing:0}.in{margin-top:0.67em}.it{margin-top:40px}.jj{margin-top:1.34em}.jv{margin-top:0.93em}.kk{margin-top:1.41em}.qb{font-size:20px}.qc{line-height:24px}.qm{width:calc(100% + 24px)}.qn{margin-left:-12px}.qo{margin-right:-12px}.rc{padding-left:12px}.rd{padding-right:12px}.re{flex-basis:100%}.rf{max-width:100%}.sb{font-size:16px}.sc{line-height:20px}.so{min-width:48px}.sp{min-height:48px}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="print">.z{display:none}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.fi{max-height:none}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.kp{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.ln{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (max-width: 1230px)">.lo{display:none}</style><style type="text/css" data-fela-rehydration="538" data-fela-type="RULE" media="all and (max-width: 1198px)">.lr{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="s"><nav class="s t u v w c x y z"><div><div class="s c"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="ak n o al am"><div class="n o an x"><a href="https://medium.com/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q ao"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div><div class="s ap x"><div class="n o"><div class="n o g"><div class="aq s"><span><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=post_page-----6f98657fc6ec---------------------nav_reg-----------" class="ar as at au av aw ax ay az ba bb bc bd be bf" rel="noopener">Sign in</a></span></div></div></div></div></div></div></div></div><div class="bg s bh bi"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="bj bk n o"><div class="bl s ap"><a href="https://posts.specterops.io/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener"><div class="bm bn s"><img alt="Posts By SpecterOps Team Members" class="" src="https://miro.medium.com/max/304/1*aa0HsXZL43r95TuTJlJNPw.png" width="152" height="36"/></div></a></div><div class="bo s bp"><ul class="bq az br bs bt n bu g bv bw bx"><li class="n o by bz ca cb"><span class="ce b cf cg ch ci cj"><a href="https://posts.specterops.io/about?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba cm cn bd co cp" rel="noopener">About</a></span></li><li class="n o by bz ca cb"><span class="ce b cf cg ch ci cj"><a href="https://posts.specterops.io/archive?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba cm cn bd co cp" rel="noopener">All Posts</a></span></li><span class="by cc cd"></span><li class="n o by bz ca cb"><span class="ce b cf cg ch ci cj"><a href="https://www.specterops.io/?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba cm cn bd co cp" rel="noopener">specterops.io</a></span></li></ul></div></div></div></div></div></div></nav><div class="cq cr cs s ct cu"></div><article><section class="cv cw cx cy aj cz da s"></section><span class="s"></span><div><div class="t v dh di dj dk"></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><div class=""><h1 id="2be8" class="dr ds dt du b dv dw dx dy dz ea eb ec ed ee ef eg eh ei ej ek el em en eo ep eq">Code Signing Certificate Cloning Attacks and Defenses</h1><div class="er"><div class="n es et eu ev"><div class="o n"><div><a href="https://mattifestation.medium.com/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener"><img alt="Matt Graeber" class="s ew ex ey" src="https://miro.medium.com/fit/c/96/96/1*rzDEywT-rGMVud0vq03qfw.jpeg" width="48" height="48"/></a></div><div class="ez aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="fb n o fc"><span class="ce b fa cg bk fd fe ff fg fh fi eq"><a href="https://mattifestation.medium.com/?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Matt Graeber</a></span><div class="fm s ap h"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8e64b89121&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt%20Graeber&amp;userId=e8e64b89121&amp;source=post_page-e8e64b89121----6f98657fc6ec---------------------follow_byline-----------" class="ce b cf cg fn fo fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div></span></div></div><span class="ce b fa cg gd"><span class="ce b fa cg bk fd fe ff fg fh fi gd"><div><a class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener" href="/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec?source=post_page-----6f98657fc6ec--------------------------------">Dec 22, 2017</a> <!-- -->·<!-- --> <!-- -->11<!-- --> min read</div></span></span></div></div><div class="n ge gf gg gh gi gj gk gl z"><div class="n o"><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on twitter"><svg width="29" height="29" class="gp"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gp"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on facebook"><svg width="29" height="29" class="gp"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="gq s"><div class="gp"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=post_actions_header--------------------------bookmark_preview-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div><div class="s an"></div></div></div></div></div></div><p id="5c00" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Before reading this post, ponder the following question: “What does it <em class="hp">actually </em>mean to you for something to be signed by Microsoft (or any vendor for that matter)?”</p><h1 id="9410" class="hq hr dt ce hs ht hu gw hv hw hx ha hy hz ia ib ic id ie if ig ih ii ij ik il eq">Introduction: SOC Analyst Autoruns Baselining Scenario</h1><p id="98e6" class="gr gs dt gt b gu im gw gx gy in ha hb hc io he hf hg ip hi hj hk iq hm hn ho dl eq">Imagine you’re working in a SOC and you’re tasked with baselining persistence entries across 40,000 hosts. You’re tasked specifically with inspecting run key persistence. You have <a href="https://docs.microsoft.com/en-us/sysinternals/" class="ck ir" rel="noopener">Sysinternals</a> deployed across the enterprise, you run <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns" class="ck ir" rel="noopener">Autoruns</a> across every system, and forward the results to a Splunk dashboard that allows you to easily interpret the results. The smart SOC analyst you are knows that signed Microsoft applications <a href="https://www.youtube.com/watch?v=AEmuhCwFL5I" class="ck ir" rel="noopener">can be abused</a>, so you make sure that “Microsoft” and “Windows” entries are not hidden when running autorunsc.exe. You cluster all of the common results together and start focusing on outliers in the data set. You find the following outlier on</p><p id="53b1" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">6 systems out of 40,000:</p><pre class="is it iu iv iw ix iy bt"><span id="436e" class="eq iz hr dt ja b jb jc jd s je">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run<br/>   SecurityAudit<br/>     C:\Windows Defender\MpCmdRun.exe<br/>     Microsoft Malware Protection Command Line Utility<br/>     (Verified) Microsoft Corporation<br/>     4.12.16299.15<br/>     c:\windows defender\mpcmdrun.exe<br/>     11/25/1912 5:39 AM</span></pre><p id="7a02" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">You apply the following process to determine whether the entry is benign or suspicious:</p><ol class=""><li id="3670" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho jf jg jh eq">You note that the binary is a verified “Microsoft Corporation” binary. Knowing that it is signed by Microsoft allows you to scrutinize it less since this particular signed binary is not known to have been abused by attackers.</li><li id="69e7" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">You Google MpCmdRun.exe and confirm that it is indeed associated with Windows Defender.</li><li id="730d" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">You enabled VirusTotal integration with Autoruns (assuming your organization has accepted that risk) and it comes back with 0 positive AV hits.</li><li id="2187" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">You’re still unsure as to why it’s an outlier but your enterprise is a large, heterogenous environment where the concept of a baselined gold image does not exist.</li><li id="62be" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">You accept that it’s an outlier but you are confident that MpCmdRun.exe isn’t being abused in the wild and you subsequently filter future hits of this hash. After all, you have many more outliers to wade through.</li></ol><p id="f53f" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Does this scenario sound familiar to anyone? Unfortunately, as much as I hate to say it, that Autoruns entry was positive evidence of compromise and you overlooked it and decided to overlook it in the future as well.</p></div></div></section><div class="n p er jn jo jp" role="separator"><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js"></span></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><h1 id="fa13" class="hq hr dt ce hs ht ju gw hv hw jv ha hy hz jw ib ic id jx if ig ih jy ij ik il eq">Certificate Chain Cloning and Cloned Root Trust Attacks</h1><p id="1454" class="gr gs dt gt b gu im gw gx gy in ha hb hc io he hf hg ip hi hj hk iq hm hn ho dl eq">What our SOC analyst failed to pick up on was the fact that MpCmdRun.exe was signed using a cloned Microsoft certificate chain where the attacker also trusted their cloned root certificate on the compromised victim systems. How might an attacker go about performing such an attack? The steps can be summarized as follows:</p><ol class=""><li id="20aa" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho jf jg jh eq">Export all certificates in a legitimate certificate chain to disk. These certificates are what you’ll be using as a template for your own cloned certificate chain.</li><li id="30e7" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">Build a cloned certificate chain using the chain that was exported to disk. The <a href="https://docs.microsoft.com/en-us/powershell/module/pkiclient/new-selfsignedcertificate?view=win10-ps" class="ck ir" rel="noopener">New-SelfSignedCertificate</a> cmdlet in PowerShell has very convenient “-CloneCert” and “-Signer” parameters to enable this. Upon cloning the chain, you will be able to sign malicious code with the cloned certificate chain.</li><li id="dd21" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">You’ll also want to export the cloned root certificate as you will need to trust this certificate on the victim system in order for any of your signed, malicious code to verify properly and blend in with many security tools.</li></ol><p id="c1e2" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">The following video shows the manual process of exporting the certificate chain used to sign kernel32.dll:</p><figure class="is it iu iv iw jz"><div class="ka s kb"><div class="kc kd s"></div></div><figcaption class="ke kf cz cx cy kg kh ce b fa cg gd">Manually exporting a legitimate Microsoft certificate chain to disk to use as a template for cloning.</figcaption></figure><p id="68b9" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Now that the Microsoft certificate chain has been exported to disk, you can now use it as a template for building a spoofed Microsoft certificate chain. The following code was used to achieve this:</p><figure class="is it iu iv iw jz"><div class="ka s kb"><div class="ki kd s"></div></div></figure><p id="f3da" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">The following video demonstrates running the code above:</p><figure class="is it iu iv iw jz"><div class="ka s kb"><div class="kc kd s"></div></div></figure><p id="f7d9" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So why does this attack work? Well, at a high level, digital signature validation relies upon the following:</p><ol class=""><li id="be56" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho jf jg jh eq">Integrity validation — Does the hash of the file match the signed hash in the signature? If not, the integrity of the file has been compromised and it should not be trusted.</li><li id="958f" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">Certificate chain validation — Was each certificate in the chain properly issued by its parent?</li><li id="b832" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">Certificate validity check — If each certificate in the chain is not timestamped, is each certificate within its stated validity time frame? If the digital signature is timestamped, validate the timestamping certificate counter-signature chain.</li><li id="366f" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">Revocation check — Are any of the certificates in the chain revoked or explicitly untrusted by an administrator?</li><li id="da9e" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">Root CA validation — Is the root certificate in the signer chain a trusted certificate?</li></ol><p id="3a76" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Technically, our cloned certificate chain passes all of these checks so any tool that performs signature validation (sigcheck, autoruns, procexp, AV?, etc.) will likely be fooled.</p><p id="172c" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">You may have noticed in the video, upon installation of the root certificate in the “CurrentUser” certificate store, a dialog popped up asking if you trust the certificate. If running in an elevated context, that popup will not occur. Why non-admin users are able to trust root CA certificates is beyond my comprehension. That should not be permitted in any organization.</p></div></div></section><div class="n p er jn jo jp" role="separator"><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js"></span></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><h1 id="8369" class="hq hr dt ce hs ht ju gw hv hw jv ha hy hz jw ib ic id jx if ig ih jy ij ik il eq">Attack Weaponization</h1><p id="53dc" class="gr gs dt gt b gu im gw gx gy in ha hb hc io he hf hg ip hi hj hk iq hm hn ho dl eq">The video above showed a demo of how to create and trust a cloned root certificate locally. Ideally, in a real-world attack scenario, you wouldn’t clone a certificate chain and sign your malicious file on a compromised system. Rather, you would build the cloned chain and sign your malicious code on an attacker system. Now, the problem remains however of how you would realistically trust the cloned CA certificate on the victim system. You could probably get away with dropping it to disk and installing it but if you wanted to be a bit stealthier, as an admin, you could install and trust the certificate directly in the registry. The following is an example of how you could use WMI to remotely install and trust a cloned root CA certificate:</p><figure class="is it iu iv iw jz"><div class="ka s kb"><div class="ki kd s"></div></div></figure><p id="bdab" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">In this example, $EncodedCertBlob is just the contents of the exported cloned root CA .cer file base64-encoded. $CertThumbprint is the thumbprint value (i.e. SHA1 hash of the certificate). So, upon installation of that certificate, any code signed with a certificate from that CA will properly validate. In this particular case, the code will additionally give the appearance of being Microsoft-signed code.</p></div></div></section><div class="n p er jn jo jp" role="separator"><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js"></span></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><h1 id="8a63" class="hq hr dt ce hs ht ju gw hv hw jv ha hy hz jw ib ic id jx if ig ih jy ij ik il eq">Detecting Malicious Root CA Certificate Installation</h1><p id="ffe9" class="gr gs dt gt b gu im gw gx gy in ha hb hc io he hf hg ip hi hj hk iq hm hn ho dl eq">Considering the root of this attack involves installation of a root CA certificate, this action will be the focus of building a detection. The installation of root CAs should be sufficiently uncommon such that a high-fidelity alert should be possible by monitoring the registry. Sysmon serves this purpose really well and what follows is an ideal config for catching root certificate installation:</p><figure class="is it iu iv iw jz"><div class="ka s kb"><div class="ki kd s"></div></div></figure><p id="cffb" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">When an event fires, it would look like the following:</p><pre class="is it iu iv iw ix iy bt"><span id="db70" class="eq iz hr dt ja b jb jc jd s je">Registry value set:<br/>EventType: SetValue<br/>UtcTime: 2017-12-20 17:12:11.999<br/>ProcessGuid: {7ed59fb9-99eb-5a3a-0000-00102ab1af06}<br/>ProcessId: 4404<br/>Image: C:\WINDOWS\system32\wbem\wmiprvse.exe<br/>TargetObject: HKLM\SOFTWARE\Microsoft\SystemCertificates\ROOT\Certificates\1F3D38F280635F275BE92B87CF83E40E40458400\Blob<br/>Details: Binary Data</span></pre><p id="0f5c" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Using this rule set, you will likely get a lot of CreateKey event false positives. The high-fidelity events to pay attention to are SetValue events where the TargetObject property ends with “&lt;THUMBPRINT_VALUE&gt;\Blob” as this indicates the direct installation or modification of a root certificate binary blob. Unfortunately, as of this writing, Sysmon configurations don’t allow sufficient granularity to constrain a set of registry events to a specific EventType nor are wildcards permitted in rule entries.</p><p id="1095" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So the next question to ask yourself would be, “how do I know if this root certificate installation is ‘malicious’?” A logical first step would be to investigate the contents of the certificate to see if anything stands out. PowerShell makes inspecting certificates really easy.</p><pre class="is it iu iv iw ix iy bt"><span id="9f87" class="eq iz hr dt ja b jb jc jd s je">Get-ChildItem -Path Cert:\ -Recurse | Where-Object { $_.Thumbprint -eq &#x27;1F3D38F280635F275BE92B87CF83E40E40458400&#x27; } | For<br/>mat-List *</span></pre><p id="7e22" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">The result of running this command might produce the following output:</p><pre class="is it iu iv iw ix iy bt"><span id="d60f" class="eq iz hr dt ja b jb jc jd s je">PSPath                   : Microsoft.PowerShell.Security\Certificate::LocalMachine\Root\1F3D38F280635F275BE92B87CF83E40E40458400<br/>PSParentPath             : Microsoft.PowerShell.Security\Certificate::LocalMachine\Root<br/>PSChildName              : 1F3D38F280635F275BE92B87CF83E40E40458400<br/>PSDrive                  : Cert<br/>PSProvider               : Microsoft.PowerShell.Security\Certificate<br/>PSIsContainer            : False<br/>EnhancedKeyUsageList     : {}<br/>DnsNameList              : {Microsoft Root Certificate Authority 2010}<br/>SendAsTrustedIssuer      : False<br/>EnrollmentPolicyEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty<br/>EnrollmentServerEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty<br/>PolicyId                 :<br/>Archived                 : False<br/>Extensions               : {System.Security.Cryptography.Oid, System.Security.Cryptography.Oid,<br/>                           System.Security.Cryptography.Oid}<br/>FriendlyName             :<br/>IssuerName               : System.Security.Cryptography.X509Certificates.X500DistinguishedName<br/>NotAfter                 : 11/30/2042 9:06:37 PM<br/>NotBefore                : 12/1/2017 1:55:14 PM<br/>HasPrivateKey            : False<br/>PrivateKey               :<br/>PublicKey                : System.Security.Cryptography.X509Certificates.PublicKey<br/>RawData                  : {48, 130, 5, 219...}<br/>SerialNumber             : 52761736EEA4458142453E2D73FA89B2<br/>SubjectName              : System.Security.Cryptography.X509Certificates.X500DistinguishedName<br/>SignatureAlgorithm       : System.Security.Cryptography.Oid<br/>Thumbprint               : 1F3D38F280635F275BE92B87CF83E40E40458400<br/>Version                  : 3<br/>Handle                   : 1849876297952<br/>Issuer                   : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US<br/>Subject                  : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US</span></pre><p id="e99d" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">To any observer, this certificate definitely has the “look and feel” of a legitimate certificate but what is it exactly that makes a certificate “legitimate” or trusted? That process will be described in the last section of the post.</p></div></div></section><div class="n p er jn jo jp" role="separator"><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js"></span></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><h1 id="74bb" class="hq hr dt ce hs ht ju gw hv hw jv ha hy hz jw ib ic id jx if ig ih jy ij ik il eq">Preventing Malicious “CurrentUser” Root CA Certificate Installation</h1><p id="2041" class="gr gs dt gt b gu im gw gx gy in ha hb hc io he hf hg ip hi hj hk iq hm hn ho dl eq">In the video demonstrating the root CA installation, it was performed in the current user context. While there may not be strong preventative mitigations for certificate installation as an admin, it is possible to prevent root certificate installation in the current user context by setting the following registry value:</p><pre class="is it iu iv iw ix iy bt"><span id="e49d" class="eq iz hr dt ja b jb jc jd s je">HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\ProtectedRoots - Flags (REG_DWORD) - 1</span></pre><p id="42a8" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">While this registry key is not well documented <a href="https://technet.microsoft.com/en-us/library/cc783813(v=ws.10).aspx" class="ck ir" rel="noopener">online</a>, wincrypt.h in the Windows SDK provides some contextual clues regarding the options available to set in the “Flags” value. The following relevant flag values are documented in the header file:</p><pre class="is it iu iv iw ix iy bt"><span id="1bd8" class="eq iz hr dt ja b jb jc jd s je">// Set the following flag to inhibit the opening of the CurrentUser&#x27;s<br/>// .Default physical store when opening the CurrentUser&#x27;s &quot;Root&quot; system store.<br/>// The .Default physical store open&#x27;s the CurrentUser SystemRegistry &quot;Root&quot;<br/>// store.<br/>#define CERT_PROT_ROOT_DISABLE_CURRENT_USER_FLAG    0x1</span><span id="0cc6" class="eq iz hr dt ja b jb kj kk kl km kn jd s je">// Set the following flag to inhibit the adding of roots from the<br/>// CurrentUser SystemRegistry &quot;Root&quot; store to the protected root list<br/>// when the &quot;Root&quot; store is initially protected.<br/>#define CERT_PROT_ROOT_INHIBIT_ADD_AT_INIT_FLAG     0x2</span></pre><p id="84b2" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">After setting this key, you will get an access denied error when attempting to install a root CA to the CurrentUser Root certificate store.</p><figure class="is it iu iv iw jz cx cy paragraph-image"><div role="button" tabindex="0" class="kp kq kb kr aj ks"><div class="cx cy ko"><div class="ka s kb ky"><div class="kz kd s"><div class="kt ku t u v kv aj bk kw kx"><img alt="" class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/1*Pe1OeWP-UySRMW4aWa4jJQ.png?q=20" width="1197" height="491" role="presentation"/></div><img alt="" class="kt ku t u v kv aj c" width="1197" height="491" role="presentation"/><noscript><img alt="" class="t u v kv aj" src="https://miro.medium.com/max/2394/1*Pe1OeWP-UySRMW4aWa4jJQ.png" width="1197" height="491" srcSet="https://miro.medium.com/max/552/1*Pe1OeWP-UySRMW4aWa4jJQ.png 276w, https://miro.medium.com/max/1104/1*Pe1OeWP-UySRMW4aWa4jJQ.png 552w, https://miro.medium.com/max/1280/1*Pe1OeWP-UySRMW4aWa4jJQ.png 640w, https://miro.medium.com/max/1400/1*Pe1OeWP-UySRMW4aWa4jJQ.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="5e6f" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So while not the most robust of preventative techniques, preventing non-admin users from trusting their own root CAs is certainly a strong policy to enforce in your organization.</p><p id="4f51" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">As with any enforced preventative measure, an admin will need to consider “what might this break in my environment?” As with any preventative measure, it is important to roll them out in phases across an environment. If for whatever reason there is a business justification for permitting any user to trust a root certificate, you accept that an attacker or rogue software can trust arbitrary root certificates as well. Windows administrators will always have the ability to push trusted root certificates <a href="https://technet.microsoft.com/en-us/library/cc754841(v=ws.11).aspx" class="ck ir" rel="noopener">via Group Policy</a>. A recent case where software installed its own root certificate without alerting the user was a <a href="https://www.bleepingcomputer.com/news/security/popular-usb-audio-driver-ships-with-root-certificate-big-security-no-no/" class="ck ir" rel="noopener">Savitech audio driver</a>. In this case, you would have needed to be admin to trust this root certificate but arbitrary root certificates have no basis for the establishment of trust compared to the arduous steps required to get your root certificate <a href="https://technet.microsoft.com/en-us/library/cc751157.aspx" class="ck ir" rel="noopener">trusted by Microsoft</a>.</p></div></div></section><div class="n p er jn jo jp" role="separator"><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js"></span></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><h1 id="f682" class="hq hr dt ce hs ht ju gw hv hw jv ha hy hz jw ib ic id jx if ig ih jy ij ik il eq">Proper Validation of Root CA Trust</h1><p id="a45a" class="gr gs dt gt b gu im gw gx gy in ha hb hc io he hf hg ip hi hj hk iq hm hn ho dl eq">Until recently, I had actually never considered the way in which the trust of certificates could be validated until version 2.60 of <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck" class="ck ir" rel="noopener">sigcheck</a> was released and the introduced the -v switch for use with -t or -tu:</p><pre class="is it iu iv iw ix iy bt"><span id="a018" class="eq iz hr dt ja b jb jc jd s je">-t[u][v]   Dump contents of specified certificate store (&#x27;*&#x27; for all stores). Specify -tu to query the user store (machine store is the default). Append &#x27;-v&#x27; to have Sigcheck download the trusted Microsoft root certificate list and only output valid certificates not rooted to a certificate on that list. If the site is not accessible, authrootstl.cab or authroot.stl in the current directory are used instead, if present.</span></pre><p id="cd25" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Here is some example output:</p><pre class="is it iu iv iw ix iy bt"><span id="e7c1" class="eq iz hr dt ja b jb jc jd s je">sigcheck64.exe -tuv -nobanner</span><span id="30f5" class="eq iz hr dt ja b jb kj kk kl km kn jd s je">User\Root:<br/>  Microsoft Root Certificate Authority 2010<br/>     Cert Status:    Valid<br/>     Valid Usage:    All<br/>     Cert Issuer:    Microsoft Root Certificate Authority 2010<br/>     Serial Number:  52 76 17 36 EE A4 45 81 42 45 3E 2D 73 FA 89 B2<br/>     Thumbprint:     1F3D38F280635F275BE92B87CF83E40E40458400<br/>     Algorithm:      sha256RSA<br/>     Valid from:     1:55 PM 12/1/2017<br/>     Valid to:       9:06 PM 11/30/2042</span></pre><p id="79f6" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So why should this entry not be trusted? What is Microsoft’s basis for trust? The answer to that is <a href="http://unmitigatedrisk.com/?p=259" class="ck ir" rel="noopener">authroot.stl</a> — a signed, ASN.1 encoded file consisting of the root certificates that Microsoft has deemed to be trustworthy. This is equivalent to the set of root CAs that come installed by default in the operating system. Occasionally, Microsoft may update this list though (whether through addition or revocation) and distribute updates via <a href="http://www.download.windowsupdate.com/msdownload/update/v3/static/trustedr/en/authrootstl.cab" class="ck ir" rel="noopener">this link</a>.</p><p id="2b47" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Wanting to understand the STL file format better and not necessarily wanting to rely upon sigcheck for performing root CA trust validation, I wrote a <a href="https://gist.github.com/mattifestation/c712e525109f786fbaf6ed576b8d2832" class="ck ir" rel="noopener">crude parser</a> that extracts all of the trusted certificate thumbprint values so that I could perform similar validation in a PowerShell script. In the screenshot below, you will see the “malicious” cloned root CA certificate highlighted:</p><figure class="is it iu iv iw jz cx cy paragraph-image"><div role="button" tabindex="0" class="kp kq kb kr aj ks"><div class="cx cy ld"><div class="ka s kb ky"><div class="le kd s"><div class="kt ku t u v kv aj bk kw kx"><img alt="" class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/1*fLrpueTtcZk_Gx5qOIxvsA.png?q=20" width="1596" height="523" role="presentation"/></div><img alt="" class="kt ku t u v kv aj c" width="1596" height="523" role="presentation"/><noscript><img alt="" class="t u v kv aj" src="https://miro.medium.com/max/3192/1*fLrpueTtcZk_Gx5qOIxvsA.png" width="1596" height="523" srcSet="https://miro.medium.com/max/552/1*fLrpueTtcZk_Gx5qOIxvsA.png 276w, https://miro.medium.com/max/1104/1*fLrpueTtcZk_Gx5qOIxvsA.png 552w, https://miro.medium.com/max/1280/1*fLrpueTtcZk_Gx5qOIxvsA.png 640w, https://miro.medium.com/max/1400/1*fLrpueTtcZk_Gx5qOIxvsA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="e1b3" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">It is also possible to parse authroot.stl with certutil.exe:</p><pre class="is it iu iv iw ix iy bt"><span id="c9e5" class="eq iz hr dt ja b jb jc jd s je">certutil -dump authroot.stl</span></pre><p id="5296" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Through parsing authroot.stl, you can also easily determine which Microsoft-specific roots are trustworthy for code signing:</p><pre class="is it iu iv iw ix iy bt"><span id="8cda" class="eq iz hr dt ja b jb jc jd s je">PS&gt; ls Cert:\LocalMachine\Root\ | Where-Object { ($TrustedRootHashes -contains $_.Thumbprint) -and ($_.Subject.StartsWith(&#x27;CN=Microsoft Root&#x27;)) }</span><span id="5886" class="eq iz hr dt ja b jb kj kk kl km kn jd s je">Thumbprint : CDD4EEAE6000AC7F40C3802C171E30148030C072<br/>Subject    : CN=Microsoft Root Certificate Authority, DC=microsoft, DC=com</span><span id="ed43" class="eq iz hr dt ja b jb kj kk kl km kn jd s je">Thumbprint : A43489159A520F0D93D032CCAF37E7FE20A8B419<br/>Subject    : CN=Microsoft Root Authority, OU=Microsoft Corporation, OU=Copyright (c) 1997 Microsoft Corp.</span><span id="c286" class="eq iz hr dt ja b jb kj kk kl km kn jd s je">Thumbprint : 8F43288AD272F3103B6FB1428485EA3014C0BCFE<br/>Subject    : CN=Microsoft Root Certificate Authority 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US</span><span id="ac59" class="eq iz hr dt ja b jb kj kk kl km kn jd s je">Thumbprint : 3B1EFD3A66EA28B16697394703A72CA340A05BD5<br/>Subject    : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US</span></pre><p id="af6b" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So the way in which Microsoft-signed code should ideally be validated (versus simply pulling the publisher name and validating that it chains to a “trusted” root) is to perform the following:</p><ol class=""><li id="c0a5" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho jf jg jh eq">Validate that the integrity of the binary has not been compromised.</li><li id="a4ad" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">Validate that each certificate in the chain is valid.</li><li id="9f90" class="gr gs dt gt b gu ji gw gx gy jj ha hb hc jk he hf hg jl hi hj hk jm hm hn ho jf jg jh eq">Validate that the root certificate has one of the trusted thumbprints present in authroot.stl (listed above). An alternative to validating against authroot.stl is to call the <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa377163(v=vs.85).aspx" class="ck ir" rel="noopener">CertVerifyCertificateChainPolicy</a> function passing it the CERT_CHAIN_POLICY_MICROSOFT_ROOT value. Deep inside this function is basically the same array of certificate thumbprints that the root certificate will be validated against.</li></ol><p id="bbb6" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">One notable omission from authroot.stl is the Microsoft flight root certificate (thumbprint: F8DB7E1C16F1FFD4AAAD4AAD8DFF0F2445184AEB) — the issuer of certificates for Windows Insider Preview builds. Worth noting is the absence of a timestamp countersignature meaning that the signature will fail to validate beyond the certificate validity period. This was likely an intentional decision on the part of Microsoft. The lack of a MSFT timestamp would potentially make the Microsoft flight certificate chain a more viable candidate for cloning assuming a defender isn’t aware of what would be considered a “trusted” root certificate thumbprint. Here’s an example of kernel32.dll signed by a certificate issued by the Microsoft flight root:</p><figure class="is it iu iv iw jz cx cy paragraph-image"><div role="button" tabindex="0" class="kp kq kb kr aj ks"><div class="cx cy lf"><div class="ka s kb ky"><div class="lg kd s"><div class="kt ku t u v kv aj bk kw kx"><img alt="" class="t u v kv aj la lb lc" src="https://miro.medium.com/max/34/1*3toLhPm3VGMpDEl36JE3dg.png?q=20" width="775" height="1379" role="presentation"/></div><img alt="" class="kt ku t u v kv aj c" width="775" height="1379" role="presentation"/><noscript><img alt="" class="t u v kv aj" src="https://miro.medium.com/max/1550/1*3toLhPm3VGMpDEl36JE3dg.png" width="775" height="1379" srcSet="https://miro.medium.com/max/552/1*3toLhPm3VGMpDEl36JE3dg.png 276w, https://miro.medium.com/max/1104/1*3toLhPm3VGMpDEl36JE3dg.png 552w, https://miro.medium.com/max/1280/1*3toLhPm3VGMpDEl36JE3dg.png 640w, https://miro.medium.com/max/1400/1*3toLhPm3VGMpDEl36JE3dg.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure></div></div></section><div class="n p er jn jo jp" role="separator"><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js"></span></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><h1 id="a2df" class="hq hr dt ce hs ht ju gw hv hw jv ha hy hz jw ib ic id jx if ig ih jy ij ik il eq">Conclusion</h1><p id="1a3b" class="gr gs dt gt b gu im gw gx gy in ha hb hc io he hf hg ip hi hj hk iq hm hn ho dl eq">Hopefully, by now you have a better appreciation of how attackers can appear to originate from the code signer of their choosing. This isn’t the only signing attack that would permit this, however. I’ve also published related research on how to <a href="https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf" class="ck ir" rel="noopener">hijack Subject Interface Packages</a> that effectively allows you to apply legitimate digital signatures to malicious code that passes integrity validation checks.</p><p id="e186" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">The purpose of all of this research is twofold: to help encourage defenders and security vendors to challenge assumptions made in their investigative processes but to also educate on the importance of proper code signing validation for the purposes of determining whether any given signed code <em class="hp">actually </em>originates from who it claims to originate from.</p><p id="4345" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Lastly, an astute reader will have noted that there may have been additional anomalies associated with the cloned certificate chain and signed code. I’ll leave discussion of these anomalies for another blog post. See you in 2018!</p></div></div></section></div></article><div class="kt dk li lp aj lq u ln lr" data-test-id="post-sidebar"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="ls n lt"><div class="dk"><div><div class="lu lv s"><a href="https://posts.specterops.io/?source=post_sidebar--------------------------post_sidebar-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><h2 class="ce hs jb cg ds eq dl">Posts By SpecterOps Team Members</h2></a><div class="lw lx s"><p class="ce b fa cg bk ly fe ff lz fh fi gd">Posts from SpecterOps team members on various topics…</p></div></div><div class="ma mb mc n"><div class="n o"><div class="s kb md me mf mg mh"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt%20Graeber&amp;userId=e8e64b89121&amp;source=post_sidebar-----6f98657fc6ec---------------------clap_sidebar-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><div class="ay mi mj mk ml mm mn mo r mp mq"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s mr ms mt mu mv mw mx"><div class="my"><p class="ce b fa cg gd"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl">225<!-- --> </button></p></div></div></div></div><div class="mb s"><button class="ml mj ay"><div class="na n o nb"><svg width="25" height="25" class="r mz ml mq" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s kb nc nd ne nf ng nh ni nj"><p class="ce b fa cg gd">2<!-- --> </p></div></div></button></div><div class="gp"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=post_sidebar-----6f98657fc6ec---------------------bookmark_sidebar-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div></div></div><div class="kt dk lh li lj lk ll lm ln lo"></div><div><div class="nk jz n lt p"><div class="n p"><div class="ab ac ae af ag dq ai aj"><div class="n nl"><div class="s"><p class="ce b cf cg gd">Thanks to <!-- -->Andy Robbins<!-- -->. </p></div></div><div class="n o nl"></div><div class="nm s"><ul class="ay az"><li class="gb bq gq nn"><a href="/tagged/security" class="ce b cf no gd np nq gc s iy">Security</a></li><li class="gb bq gq nn"><a href="/tagged/code-signing" class="ce b cf no gd np nq gc s iy">Code Signing</a></li></ul></div><div class="nm n es z"><div class="n o nb"><div class="nr s"><span class="s ns nt nu e d"><div class="n o"><div class="s kb md me mf mg mh"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt%20Graeber&amp;userId=e8e64b89121&amp;source=post_actions_footer-----6f98657fc6ec---------------------clap_footer-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><div class="ay mi mj mk ml mm mn mo r mp mq"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s mr ms mt mu mv mw mx"><div class="kb nv my"><p class="ce b fa cg eq"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl">225<span class="s h g f nw nx"> <!-- -->claps</span></button><span class="s h g f nw nx"></span></p></div></div></div></span><span class="s h g f nw nx"><div class="n o"><div class="s kb md me mf mg mh"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt%20Graeber&amp;userId=e8e64b89121&amp;source=post_actions_footer-----6f98657fc6ec---------------------clap_footer-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><div class="ay mi mj mk ml mm mn mo r mp mq"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s mr ms mt mu mv mw mx"><div class="my"><p class="ce b fa cg gd"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl">225<!-- --> </button></p></div></div></div></span></div><div class="s ny nz oa ob oc"></div><button class="ml mj ay"><div class="na n o nb"><span class="od s oe"><svg width="25" height="25" class="r mz ml mq" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span><div class="s kb of nd og nf oh nh oi oj ok ol"><p class="ce b fa cg gd">2<!-- --> </p></div></div></button></div><div class="n o"><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on twitter"><svg width="29" height="29" class="gp"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gp"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on facebook"><svg width="29" height="29" class="gp"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="om s ap"><div class="gp"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=post_actions_footer--------------------------bookmark_footer-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div></div><div><div class="n p"><div class="ab ac ae af ag dq ai aj"><div class="on oo op nm s oq z"><div class="s g"><div class="or os s kb"><span class="s ot am ou"><div class="s t ov ow"><a href="https://mattifestation.medium.com/?source=follow_footer-------------------------------------" rel="noopener"><img alt="Matt Graeber" class="s ew bx ox" src="https://miro.medium.com/fit/c/160/160/1*rzDEywT-rGMVud0vq03qfw.jpeg" width="80" height="80"/></a></div><span class="s"><div class="oy s oz"><p class="ce b cf pa pb gd ci">Written by</p></div><div class="oy pc n oz"><div class="aj n o es"><h2 class="ce hs pd pe ds eq"><a href="https://mattifestation.medium.com/?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Matt Graeber</a></h2><div class="s g"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8e64b89121%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt%20Graeber&amp;userId=e8e64b89121&amp;source=follow_footer-e8e64b89121-------------------------follow_footer-----------" class="ce b fa cg fn pf fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div></div></span></span><div class="oy pg s oz bi"><div class="ph s"><p class="ce b jb pi gd">Security Researcher, SpecterOps</p></div><div class="pj pk bi"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8e64b89121%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt%20Graeber&amp;userId=e8e64b89121&amp;source=follow_footer-e8e64b89121-------------------------follow_footer-----------" class="ce b fa cg fn pf fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div></div><div class="on s"></div><div class="or os s kb"><span class="s ot am ou"><div class="s t ov ow"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" rel="noopener"><img alt="Posts By SpecterOps Team Members" class="dd ox bx" src="https://miro.medium.com/fit/c/160/160/1*D-FDlfkqivRBQZoESrwtqw.png" width="80" height="80"/></a></div><span class="s"><div class="oy pc n oz"><div class="aj n o es"><h2 class="ce hs pd pe ds eq"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></h2><div class="s g"></div></div></div></span></span><div class="oy pl s oz bi"><div class="ph s"><p class="ce b jb pi gd">Posts from SpecterOps team members on various topics relating information security</p></div><div class="pj pk bi"></div></div></div></div><div class="pj bi"><div class="jo s"><div class="n nb"><div class="pm s"><a href="https://mattifestation.medium.com/?source=follow_footer-------------------------------------" rel="noopener"><img alt="Matt Graeber" class="s ew pn po" src="https://miro.medium.com/fit/c/80/80/1*rzDEywT-rGMVud0vq03qfw.jpeg" width="40" height="40"/></a></div><div class="ez s"><p class="ce b pp pq pr gd ci">Written by</p><div class="n nb"><h2 class="ce hs jb cg ds eq"><a href="https://mattifestation.medium.com/?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Matt Graeber</a></h2><div class="ez s"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8e64b89121%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt%20Graeber&amp;userId=e8e64b89121&amp;source=follow_footer-e8e64b89121-------------------------follow_footer-----------" class="ce b cf cg fn fo fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div><div class="ps s"><p class="ce b fa cg gd">Security Researcher, SpecterOps</p></div></div></div><div class="jo s"><div class="n nb"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" rel="noopener"><img alt="Posts By SpecterOps Team Members" class="dd po pn" src="https://miro.medium.com/fit/c/80/80/1*D-FDlfkqivRBQZoESrwtqw.png" width="40" height="40"/></a><div class="ez s"><div class="n nb"><h2 class="ce hs jb cg ds eq"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></h2><div class="ez s"></div></div><div class="ps s"><p class="ce b fa cg gd">Posts from SpecterOps team members on various topics relating information security</p></div></div></div></div></div></div></div></div></div><div class="s db z"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="pt pu s"><div class="pv lv pw pu s px py"><h2 class="ce hs pz qa hv qb qc hy qd qe ic qf qg ig qh qi ik eq">More From Medium</h2></div><div class="bu n nb nl qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx"><div class="qy qz ra rb rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs"><div class="rt ru s"><div class="aj kv"><div class="n es"><div class="s bp rv rw rx"><div class="ry s"><h2 class="ce hs rz sa hv sb sc hy sd se ic sf sg ig sh si ik eq"><a rel="noopener" href="/gathering-open-source-intelligence-bee58de48e05?source=post_internal_links---------0----------------------------">Gathering Open Source Intelligence</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cmaddy.medium.com/?source=post_internal_links---------0----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Christopher Maddalena</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------0----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sj sk"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/gathering-open-source-intelligence-bee58de48e05?source=post_internal_links---------0----------------------------"><div class="ka s kb ky"><div class="sl kd s"><div class="kt ku t u v kv aj bk kw kx"><img class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/1*dy7MvBD79mkCTajDbSssBw.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="kt ku sm sn so sp sq sr ss st su sv c" width="70" height="70" role="presentation"/><noscript><img class="sm sn so sp sq sr ss st su sv" src="https://miro.medium.com/fit/c/140/140/1*dy7MvBD79mkCTajDbSssBw.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*dy7MvBD79mkCTajDbSssBw.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*dy7MvBD79mkCTajDbSssBw.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qy qz ra rb rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs"><div class="rt ru s"><div class="aj kv"><div class="n es"><div class="s bp rv rw rx"><div class="ry s"><h2 class="ce hs rz sa hv sb sc hy sd se ic sf sg ig sh si ik eq"><a rel="noopener" href="/man-in-the-terminal-65476e6165b9?source=post_internal_links---------1----------------------------">Man in the Terminal</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@djhohnstein?source=post_internal_links---------1----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Dwight Hohnstein</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------1----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sj sk"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/man-in-the-terminal-65476e6165b9?source=post_internal_links---------1----------------------------"><div class="ka s kb ky"><div class="sl kd s"><div class="kt ku t u v kv aj bk kw kx"><img class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/1*GF6FdIDKpvQxjuNuPsX7kQ.png?q=20" width="70" height="70" role="presentation"/></div><img class="kt ku sm sn so sp sq sr ss st su sv c" width="70" height="70" role="presentation"/><noscript><img class="sm sn so sp sq sr ss st su sv" src="https://miro.medium.com/fit/c/140/140/1*GF6FdIDKpvQxjuNuPsX7kQ.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*GF6FdIDKpvQxjuNuPsX7kQ.png 48w, https://miro.medium.com/fit/c/140/140/1*GF6FdIDKpvQxjuNuPsX7kQ.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qy qz ra rb rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs"><div class="rt ru s"><div class="aj kv"><div class="n es"><div class="s bp rv rw rx"><div class="ry s"><h2 class="ce hs rz sa hv sb sc hy sd se ic sf sg ig sh si ik eq"><a rel="noopener" href="/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a?source=post_internal_links---------2----------------------------">Attacking Azure, Azure AD, and Introducing PowerZure</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@hausec?source=post_internal_links---------2----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Ryan Hausknecht</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------2----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sj sk"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a?source=post_internal_links---------2----------------------------"><div class="ka s kb ky"><div class="sl kd s"><div class="kt ku t u v kv aj bk kw kx"><img class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/0*GHniN9KHMioCdUW5?q=20" width="70" height="70" role="presentation"/></div><img class="kt ku sm sn so sp sq sr ss st su sv c" width="70" height="70" role="presentation"/><noscript><img class="sm sn so sp sq sr ss st su sv" src="https://miro.medium.com/fit/c/140/140/0*GHniN9KHMioCdUW5" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*GHniN9KHMioCdUW5 48w, https://miro.medium.com/fit/c/140/140/0*GHniN9KHMioCdUW5 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qy qz ra rb rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs"><div class="rt ru s"><div class="aj kv"><div class="n es"><div class="s bp rv rw rx"><div class="ry s"><h2 class="ce hs rz sa hv sb sc hy sd se ic sf sg ig sh si ik eq"><a rel="noopener" href="/threat-hunting-with-jupyter-notebooks-part-1-your-first-notebook-9a99a781fde7?source=post_internal_links---------3----------------------------">Threat Hunting with Jupyter Notebooks— Part 1: Your First Notebook 📓</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cyb3rward0g.medium.com/?source=post_internal_links---------3----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Roberto Rodriguez</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------3----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sj sk"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/threat-hunting-with-jupyter-notebooks-part-1-your-first-notebook-9a99a781fde7?source=post_internal_links---------3----------------------------"><div class="ka s kb ky"><div class="sl kd s"><div class="kt ku t u v kv aj bk kw kx"><img class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/1*ezJx8ZEu1Va14iscq_h5Gg.png?q=20" width="70" height="70" role="presentation"/></div><img class="kt ku sm sn so sp sq sr ss st su sv c" width="70" height="70" role="presentation"/><noscript><img class="sm sn so sp sq sr ss st su sv" src="https://miro.medium.com/fit/c/140/140/1*ezJx8ZEu1Va14iscq_h5Gg.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*ezJx8ZEu1Va14iscq_h5Gg.png 48w, https://miro.medium.com/fit/c/140/140/1*ezJx8ZEu1Va14iscq_h5Gg.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qy qz ra rb rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs"><div class="rt ru s"><div class="aj kv"><div class="n es"><div class="s bp rv rw rx"><div class="ry s"><h2 class="ce hs rz sa hv sb sc hy sd se ic sf sg ig sh si ik eq"><a rel="noopener" href="/cve-2018-8414-a-case-study-in-responsible-disclosure-ff74c39615ba?source=post_internal_links---------4----------------------------">CVE-2018–8414: A Case Study in Responsible Disclosure</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@enigma0x3?source=post_internal_links---------4----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Matt Nelson</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------4----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sj sk"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/cve-2018-8414-a-case-study-in-responsible-disclosure-ff74c39615ba?source=post_internal_links---------4----------------------------"><div class="ka s kb ky"><div class="sl kd s"><div class="kt ku t u v kv aj bk kw kx"><img class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/1*_yKdMthPwVpKYyHZnvrKJQ.png?q=20" width="70" height="70" role="presentation"/></div><img class="kt ku sm sn so sp sq sr ss st su sv c" width="70" height="70" role="presentation"/><noscript><img class="sm sn so sp sq sr ss st su sv" src="https://miro.medium.com/fit/c/140/140/1*_yKdMthPwVpKYyHZnvrKJQ.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*_yKdMthPwVpKYyHZnvrKJQ.png 48w, https://miro.medium.com/fit/c/140/140/1*_yKdMthPwVpKYyHZnvrKJQ.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qy qz ra rb rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs"><div class="rt ru s"><div class="aj kv"><div class="n es"><div class="s bp rv rw rx"><div class="ry s"><h2 class="ce hs rz sa hv sb sc hy sd se ic sf sg ig sh si ik eq"><a rel="noopener" href="/enter-mordor-pre-recorded-security-events-from-simulated-adversarial-techniques-fdf5555c9eb1?source=post_internal_links---------5----------------------------">Enter Mordor 😈: Pre-recorded Security Events from Simulated Adversarial Techniques 🛡</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cyb3rward0g.medium.com/?source=post_internal_links---------5----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Roberto Rodriguez</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------5----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sj sk"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/enter-mordor-pre-recorded-security-events-from-simulated-adversarial-techniques-fdf5555c9eb1?source=post_internal_links---------5----------------------------"><div class="ka s kb ky"><div class="sl kd s"><div class="kt ku t u v kv aj bk kw kx"><img class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/0*ji6keNd2kNMsDi-Z.png?q=20" width="70" height="70" role="presentation"/></div><img class="kt ku sm sn so sp sq sr ss st su sv c" width="70" height="70" role="presentation"/><noscript><img class="sm sn so sp sq sr ss st su sv" src="https://miro.medium.com/fit/c/140/140/0*ji6keNd2kNMsDi-Z.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*ji6keNd2kNMsDi-Z.png 48w, https://miro.medium.com/fit/c/140/140/0*ji6keNd2kNMsDi-Z.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qy qz ra rb rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs"><div class="rt ru s"><div class="aj kv"><div class="n es"><div class="s bp rv rw rx"><div class="ry s"><h2 class="ce hs rz sa hv sb sc hy sd se ic sf sg ig sh si ik eq"><a rel="noopener" href="/putting-sysmon-v9-0-and-or-grouping-logic-to-the-test-c3ec27263df8?source=post_internal_links---------6----------------------------">Putting Sysmon v9.0 AND/OR Grouping Logic to the Test</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cyb3rward0g.medium.com/?source=post_internal_links---------6----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Roberto Rodriguez</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------6----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sj sk"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/putting-sysmon-v9-0-and-or-grouping-logic-to-the-test-c3ec27263df8?source=post_internal_links---------6----------------------------"><div class="ka s kb ky"><div class="sl kd s"><div class="kt ku t u v kv aj bk kw kx"><img class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/1*YDlbuijY1qh1K0WhSIRFKw.png?q=20" width="70" height="70" role="presentation"/></div><img class="kt ku sm sn so sp sq sr ss st su sv c" width="70" height="70" role="presentation"/><noscript><img class="sm sn so sp sq sr ss st su sv" src="https://miro.medium.com/fit/c/140/140/1*YDlbuijY1qh1K0WhSIRFKw.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*YDlbuijY1qh1K0WhSIRFKw.png 48w, https://miro.medium.com/fit/c/140/140/1*YDlbuijY1qh1K0WhSIRFKw.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qy qz ra rb rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs"><div class="rt ru s"><div class="aj kv"><div class="n es"><div class="s bp rv rw rx"><div class="ry s"><h2 class="ce hs rz sa hv sb sc hy sd se ic sf sg ig sh si ik eq"><a rel="noopener" href="/malware-development-pt-1-dynamic-module-loading-in-go-1121f07f3a5a?source=post_internal_links---------7----------------------------">Malware Development Pt. 1: Dynamic Module Loading in Go</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@djhohnstein?source=post_internal_links---------7----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Dwight Hohnstein</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------7----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sj sk"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/malware-development-pt-1-dynamic-module-loading-in-go-1121f07f3a5a?source=post_internal_links---------7----------------------------"><div class="ka s kb ky"><div class="sl kd s"><div class="kt ku t u v kv aj bk kw kx"><img class="t u v kv aj la lb lc" src="https://miro.medium.com/max/60/0*8zXAta_r_VbLYM_k?q=20" width="70" height="70" role="presentation"/></div><img class="kt ku sm sn so sp sq sr ss st su sv c" width="70" height="70" role="presentation"/><noscript><img class="sm sn so sp sq sr ss st su sv" src="https://miro.medium.com/fit/c/140/140/0*8zXAta_r_VbLYM_k" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*8zXAta_r_VbLYM_k 48w, https://miro.medium.com/fit/c/140/140/0*8zXAta_r_VbLYM_k 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="sw s sx sy"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="sz ta or n es g"><div class="tb n es"><div class="tc s td"><div class="ry s"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba te tf bd tg th" rel="noopener"><h2 class="ce hs ti pi ds tj">Learn more.</h2></a></div><p class="ce b fa cg tk">Medium<!-- --> is an open platform where 170 million readers come to find insightful and dynamic thinking. Here, expert and undiscovered voices alike dive into the heart of any topic and bring new ideas to the surface.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba bd tg th ir" rel="noopener">Learn more</a></p></div><div class="tc s td"><div class="ry s"><a href="https://medium.com/topics?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba te tf bd tg th" rel="noopener"><h2 class="ce hs ti pi ds tj">Make <!-- -->Medium<!-- --> yours.</h2></a></div><p class="ce b fa cg tk">Follow the writers, publications, and topics that matter to you, and you’ll see them on your homepage and in your inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba bd tg th ir" rel="noopener">Explore</a></p></div><div class="tc s td"><div class="ry s"><a href="https://about.medium.com/creators/?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba te tf bd tg th" rel="noopener"><h2 class="ce hs ti pi ds tj">Share your thinking.</h2></a></div><p class="ce b fa cg tk">If you have a story to tell, knowledge to share, or a perspective to offer — welcome home. It’s easy and free to post your thinking on any topic.<!-- --> <a href="https://about.medium.com/creators/?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba bd tg th ir" rel="noopener">Write on <!-- -->Medium</a></p></div></div></div><div class="n lt"><div class="n o es"><a href="https://medium.com/?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba te tf bd tg th" rel="noopener"><svg viewBox="0 0 3940 610" class="fp tl"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="ps tm n es tn am"><p class="ce b jb pi tj"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba fj bd tg th" rel="noopener">About</a></p><p class="ce b jb pi tj"><a href="https://help.medium.com/hc/en-us?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba fj bd tg th" rel="noopener">Help</a></p><p class="ce b jb pi tj"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba fj bd tg th" rel="noopener">Legal</a></p></div></div><div class="pj to tp am"><p class="ce b jb pi tk">Get the Medium app</p></div><div class="pj to tq am tr"><div class="ts s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba te tf bd tg th" rel="noopener"><img alt="A button that says &#x27;Download on the App Store&#x27;, and if clicked it will lead you to the iOS App store" class="" src="https://miro.medium.com/max/270/1*Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"/></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----6f98657fc6ec--------------------------------" class="ck cl at au av aw ax ay az ba te tf bd tg th" rel="noopener"><img alt="A button that says &#x27;Get it on, Google Play&#x27;, and if clicked it will lead you to the Google Play store" class="" src="https://miro.medium.com/max/270/1*W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"/></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210521-194149-8205a38997"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":false},"bookReader":{"assets":{},"reader":{"currentAsset":null,"currentGFI":null,"settingsPanelIsOpen":false,"settings":{"fontFamily":"CHARTER","fontScale":"M","publisherStyling":true,"textAlignment":"start","theme":"White","lineSpacing":0,"wordSpacing":0,"letterSpacing":0},"internalNavCounter":0,"currentSelection":null,"highlights":[]}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-6f98657fc6ec","user-e8e64b89121","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true}},"debug":{"requestId":"6a878b3c-dc77-4398-8d90-3cfea32964d5","hybridDevServices":[],"showBookReaderDebugger":false,"originalSpanCarrier":{"ot-tracer-spanid":"22470665534fe34f","ot-tracer-traceid":"4f07356b692f440c","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false},"tracing":{},"config":{"nodeEnv":"production","version":"main-20210521-194149-8205a38997","isTaggedVersion":false,"target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210521-194149-8205a38997"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210521-194149-8205a38997","commit":"8205a389970795cdb2c37068f2062c807d740019"}},"datacenter":"us"},"googleAnalyticsCode":"UA-24232453-2","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium"},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl"},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","variantFlags":[{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"android_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"assign_default_topic_to_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"author_under_quota_fair_distribution","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"bane_add_user","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"bane_verify_domain","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"branch_seo_metadata","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"covid_19_cdc_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"default_seo_post_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_android_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_resume_reading_toast","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_mobile_featured_chunk","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_post_recommended_from_friends_provider","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_local_currency","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_annual_renewal_reminder_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_parse_expires_at","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_renewal_failure","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_about_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_general_admission","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_sticky_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_tag_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_autotier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automated_mission_control_triggers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_blogrolls","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_text_me_the_app","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding_fonts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cleansweep_double_writes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_client_error_tracking","valueType":{"__typename":"VariantFlagString","value":"none"}},{"__typename":"VariantFlag","name":"enable_confirm_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cta_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_custom_domain_v2_settings","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_feature_logging","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_generation_pipeline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_tagline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_earn_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_edit_alt_text","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_sign_in_captcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_embedding_based_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_end_of_post_cleanup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_evhead_com_to_ev_medium_com_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_expanded_feature_chunk_pool","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_by_resend_rules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_expire_processor","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_from_your_recent_follows_section","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_global_susi_modal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_cancelled","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_expired","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_in_grace_period","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_on_hold","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_renewed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hero_image_in_mps_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_highlander_member_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hightower_user_bonus","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hot_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_post_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_json_logs_trained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_app_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_notifications","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_homepage_for_selected_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_stories","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_unread_notification_count_mutation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_login_code_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_media_resource_try_catch","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_membership_remove_section_a","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_miro_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mission_control","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_digest_rendering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_welcome_digest_rendering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mute","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_collaborative_filtering_data","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_login_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_member_welcome_email_enhancement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_three_dot_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_user_onboarding_email_enhancement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_parsely","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_patronus_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_popularity_feature","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_page_nav_stickiness_removal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_settings_screen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_tax_status_clarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_primary_topic_for_mobile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_design_reminder","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_page_seo_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_publish_to_email_for_publication_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rank_v2_usage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_receipt_notes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_all","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_edit_and_delete","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_moderation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_follow_feed_cache","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rtr_channel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_save_to_medium","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_signup_friction","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace_ranker_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_feed_urls","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipalti_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trending_posts_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_triton_predictions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trumpland_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_twitter_auth_suggestions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_writer_management","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"entity_driven_subscription_milestone_1","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"entity_driven_subscription_milestone_2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound"}},{"__typename":"VariantFlag","name":"google_sign_in_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_generic_home_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_pub_follow_email_opt_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"is_not_medium_subscriber","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_fastrak","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_stripe_express","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"make_nav_sticky","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"new_transition_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"optimizely_holdback","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"post_edge_cache_enabled","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"posts_under_quota_fair_distribution","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"provider_for_credit_card_form","valueType":{"__typename":"VariantFlagString","value":"BRAINTREE"}},{"__typename":"VariantFlag","name":"pub_sidebar","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefine_average_post_reading_time","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_post_post_similarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"retrained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"sign_up_with_email_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"single_partition_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_sign_in_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"suppress_apple_missing_expires_date_alert","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"use_new_admin_topic_backend","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"viewer":null,"meterPost({\"postId\":\"6f98657fc6ec\",\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__ref":"MeteringInfo:{}"},"postResult({\"id\":\"6f98657fc6ec\"})":{"__ref":"Post:6f98657fc6ec"}},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":0},"UserViewerEdge:userId:e8e64b89121-viewerId:lo_6b0e03eab235":{"id":"userId:e8e64b89121-viewerId:lo_6b0e03eab235","__typename":"UserViewerEdge","isAllowEdsEnabled":false,"isFollowing":false,"readPostsCount":0,"createdAt":0,"lastPostCreatedAt":0,"isBlocking":false,"isUser":false},"User:e8e64b89121":{"id":"e8e64b89121","__typename":"User","viewerIsUser":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:e8e64b89121-viewerId:lo_6b0e03eab235"},"customStyleSheet":null,"isSuspended":false,"name":"Matt Graeber","hasCompletedProfile":false,"bio":"Security Researcher, SpecterOps","imageId":"1*rzDEywT-rGMVud0vq03qfw.jpeg","username":"mattifestation","customDomainState":{"__typename":"CustomDomainState","pending":null,"live":{"__typename":"CustomDomain","status":"ACTIVE","domain":"mattifestation.medium.com","isSubdomain":true}},"isAuroraVisible":true,"mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":459,"followingCount":2},"hasSubdomain":true,"allowNotes":true,"newsletterV3":null,"twitterScreenName":"","followedCollections":1,"atsQualifiedAt":1612205642497},"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"id":"1*D-FDlfkqivRBQZoESrwtqw.png","__typename":"ImageMetadata"},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_6b0e03eab235":{"id":"collectionId:f05f8696e3cc-viewerId:lo_6b0e03eab235","__typename":"CollectionViewerEdge","isEditor":false,"canEditOwnPosts":false,"canEditPosts":false,"isFollowing":false},"ImageMetadata:1*aa0HsXZL43r95TuTJlJNPw.png":{"id":"1*aa0HsXZL43r95TuTJlJNPw.png","__typename":"ImageMetadata","originalWidth":790,"originalHeight":187},"User:70f84c574024":{"id":"70f84c574024","__typename":"User","atsQualifiedAt":1612205406678},"Collection:f05f8696e3cc":{"id":"f05f8696e3cc","__typename":"Collection","domain":"posts.specterops.io","googleAnalyticsId":"UA-102239211-2","slug":"specter-ops-posts","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","isAuroraVisible":false,"favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"name":"Posts By SpecterOps Team Members","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}},"customStyleSheet":null,"tagline":"Posts from SpecterOps team members on various topics…","isAuroraEligible":false,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_6b0e03eab235"},"logo":{"__ref":"ImageMetadata:1*aa0HsXZL43r95TuTJlJNPw.png"},"navItems":[{"__typename":"NavItem","title":"About","url":"https:\u002F\u002Fposts.specterops.io\u002Fabout","type":"ABOUT_PAGE_NAV_ITEM"},{"__typename":"NavItem","title":"All Posts","url":"https:\u002F\u002Fposts.specterops.io\u002Farchive","type":"ARCHIVE_NAV_ITEM"},{"__typename":"NavItem","title":"specterops.io","url":"https:\u002F\u002Fwww.specterops.io","type":"EXTERNAL_LINK_NAV_ITEM"}],"creator":{"__ref":"User:70f84c574024"},"subscriberCount":3251,"avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"newsletterV3":null,"canToggleEmail":false,"description":"Posts from SpecterOps team members on various topics relating information security","ampEnabled":false,"twitterUsername":"specterops","facebookPageId":null,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","status":"ACTIVE","isSubdomain":false}},"ptsQualifiedAt":1616092933111},"PostViewerEdge:postId:6f98657fc6ec-viewerId:lo_6b0e03eab235":{"id":"postId:6f98657fc6ec-viewerId:lo_6b0e03eab235","__typename":"PostViewerEdge","readingList":"READING_LIST_NONE","clapCount":0,"creatorPartnerProgramEnrollmentStatus":"PERMISSION_DENIED","shareKey":null},"Paragraph:907ef7ba0dfe_0":{"id":"907ef7ba0dfe_0","__typename":"Paragraph","name":"2be8","text":"Code Signing Certificate Cloning Attacks and Defenses","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_1":{"id":"907ef7ba0dfe_1","__typename":"Paragraph","name":"5c00","text":"Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any vendor for that matter)?”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":71,"end":80,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_2":{"id":"907ef7ba0dfe_2","__typename":"Paragraph","name":"9410","text":"Introduction: SOC Analyst Autoruns Baselining Scenario","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_3":{"id":"907ef7ba0dfe_3","__typename":"Paragraph","name":"98e6","text":"Imagine you’re working in a SOC and you’re tasked with baselining persistence entries across 40,000 hosts. You’re tasked specifically with inspecting run key persistence. You have Sysinternals deployed across the enterprise, you run Autoruns across every system, and forward the results to a Splunk dashboard that allows you to easily interpret the results. The smart SOC analyst you are knows that signed Microsoft applications can be abused, so you make sure that “Microsoft” and “Windows” entries are not hidden when running autorunsc.exe. You cluster all of the common results together and start focusing on outliers in the data set. You find the following outlier on","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":180,"end":192,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsysinternals\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":233,"end":241,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsysinternals\u002Fdownloads\u002Fautoruns","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":429,"end":442,"type":"A","href":"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=AEmuhCwFL5I","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_4":{"id":"907ef7ba0dfe_4","__typename":"Paragraph","name":"53b1","text":"6 systems out of 40,000:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_5":{"id":"907ef7ba0dfe_5","__typename":"Paragraph","name":"436e","text":"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n   SecurityAudit\n     C:\\Windows Defender\\MpCmdRun.exe\n     Microsoft Malware Protection Command Line Utility\n     (Verified) Microsoft Corporation\n     4.12.16299.15\n     c:\\windows defender\\mpcmdrun.exe\n     11\u002F25\u002F1912 5:39 AM","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_6":{"id":"907ef7ba0dfe_6","__typename":"Paragraph","name":"7a02","text":"You apply the following process to determine whether the entry is benign or suspicious:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_7":{"id":"907ef7ba0dfe_7","__typename":"Paragraph","name":"3670","text":"You note that the binary is a verified “Microsoft Corporation” binary. Knowing that it is signed by Microsoft allows you to scrutinize it less since this particular signed binary is not known to have been abused by attackers.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_8":{"id":"907ef7ba0dfe_8","__typename":"Paragraph","name":"69e7","text":"You Google MpCmdRun.exe and confirm that it is indeed associated with Windows Defender.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_9":{"id":"907ef7ba0dfe_9","__typename":"Paragraph","name":"730d","text":"You enabled VirusTotal integration with Autoruns (assuming your organization has accepted that risk) and it comes back with 0 positive AV hits.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_10":{"id":"907ef7ba0dfe_10","__typename":"Paragraph","name":"2187","text":"You’re still unsure as to why it’s an outlier but your enterprise is a large, heterogenous environment where the concept of a baselined gold image does not exist.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_11":{"id":"907ef7ba0dfe_11","__typename":"Paragraph","name":"62be","text":"You accept that it’s an outlier but you are confident that MpCmdRun.exe isn’t being abused in the wild and you subsequently filter future hits of this hash. After all, you have many more outliers to wade through.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_12":{"id":"907ef7ba0dfe_12","__typename":"Paragraph","name":"f53f","text":"Does this scenario sound familiar to anyone? Unfortunately, as much as I hate to say it, that Autoruns entry was positive evidence of compromise and you overlooked it and decided to overlook it in the future as well.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_13":{"id":"907ef7ba0dfe_13","__typename":"Paragraph","name":"fa13","text":"Certificate Chain Cloning and Cloned Root Trust Attacks","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_14":{"id":"907ef7ba0dfe_14","__typename":"Paragraph","name":"1454","text":"What our SOC analyst failed to pick up on was the fact that MpCmdRun.exe was signed using a cloned Microsoft certificate chain where the attacker also trusted their cloned root certificate on the compromised victim systems. How might an attacker go about performing such an attack? The steps can be summarized as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_15":{"id":"907ef7ba0dfe_15","__typename":"Paragraph","name":"20aa","text":"Export all certificates in a legitimate certificate chain to disk. These certificates are what you’ll be using as a template for your own cloned certificate chain.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_16":{"id":"907ef7ba0dfe_16","__typename":"Paragraph","name":"30e7","text":"Build a cloned certificate chain using the chain that was exported to disk. The New-SelfSignedCertificate cmdlet in PowerShell has very convenient “-CloneCert” and “-Signer” parameters to enable this. Upon cloning the chain, you will be able to sign malicious code with the cloned certificate chain.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":80,"end":105,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fpowershell\u002Fmodule\u002Fpkiclient\u002Fnew-selfsignedcertificate?view=win10-ps","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_17":{"id":"907ef7ba0dfe_17","__typename":"Paragraph","name":"dd21","text":"You’ll also want to export the cloned root certificate as you will need to trust this certificate on the victim system in order for any of your signed, malicious code to verify properly and blend in with many security tools.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_18":{"id":"907ef7ba0dfe_18","__typename":"Paragraph","name":"c1e2","text":"The following video shows the manual process of exporting the certificate chain used to sign kernel32.dll:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_19":{"id":"907ef7ba0dfe_19","__typename":"Paragraph","name":"cefb","text":"Manually exporting a legitimate Microsoft certificate chain to disk to use as a template for cloning.","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:275b3e484a7237fec0d268e976cce2b8"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_20":{"id":"907ef7ba0dfe_20","__typename":"Paragraph","name":"68b9","text":"Now that the Microsoft certificate chain has been exported to disk, you can now use it as a template for building a spoofed Microsoft certificate chain. The following code was used to achieve this:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_21":{"id":"907ef7ba0dfe_21","__typename":"Paragraph","name":"d1a5","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:7c50d8732cdf14b30f33ba8b6b60767b"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_22":{"id":"907ef7ba0dfe_22","__typename":"Paragraph","name":"f3da","text":"The following video demonstrates running the code above:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_23":{"id":"907ef7ba0dfe_23","__typename":"Paragraph","name":"8968","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:999e8fd0af0d3fd8771ffa92bb19a3d7"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_24":{"id":"907ef7ba0dfe_24","__typename":"Paragraph","name":"f7d9","text":"So why does this attack work? Well, at a high level, digital signature validation relies upon the following:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_25":{"id":"907ef7ba0dfe_25","__typename":"Paragraph","name":"be56","text":"Integrity validation — Does the hash of the file match the signed hash in the signature? If not, the integrity of the file has been compromised and it should not be trusted.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_26":{"id":"907ef7ba0dfe_26","__typename":"Paragraph","name":"958f","text":"Certificate chain validation — Was each certificate in the chain properly issued by its parent?","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_27":{"id":"907ef7ba0dfe_27","__typename":"Paragraph","name":"b832","text":"Certificate validity check — If each certificate in the chain is not timestamped, is each certificate within its stated validity time frame? If the digital signature is timestamped, validate the timestamping certificate counter-signature chain.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_28":{"id":"907ef7ba0dfe_28","__typename":"Paragraph","name":"366f","text":"Revocation check — Are any of the certificates in the chain revoked or explicitly untrusted by an administrator?","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_29":{"id":"907ef7ba0dfe_29","__typename":"Paragraph","name":"da9e","text":"Root CA validation — Is the root certificate in the signer chain a trusted certificate?","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_30":{"id":"907ef7ba0dfe_30","__typename":"Paragraph","name":"3a76","text":"Technically, our cloned certificate chain passes all of these checks so any tool that performs signature validation (sigcheck, autoruns, procexp, AV?, etc.) will likely be fooled.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_31":{"id":"907ef7ba0dfe_31","__typename":"Paragraph","name":"172c","text":"You may have noticed in the video, upon installation of the root certificate in the “CurrentUser” certificate store, a dialog popped up asking if you trust the certificate. If running in an elevated context, that popup will not occur. Why non-admin users are able to trust root CA certificates is beyond my comprehension. That should not be permitted in any organization.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_32":{"id":"907ef7ba0dfe_32","__typename":"Paragraph","name":"8369","text":"Attack Weaponization","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_33":{"id":"907ef7ba0dfe_33","__typename":"Paragraph","name":"53dc","text":"The video above showed a demo of how to create and trust a cloned root certificate locally. Ideally, in a real-world attack scenario, you wouldn’t clone a certificate chain and sign your malicious file on a compromised system. Rather, you would build the cloned chain and sign your malicious code on an attacker system. Now, the problem remains however of how you would realistically trust the cloned CA certificate on the victim system. You could probably get away with dropping it to disk and installing it but if you wanted to be a bit stealthier, as an admin, you could install and trust the certificate directly in the registry. The following is an example of how you could use WMI to remotely install and trust a cloned root CA certificate:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_34":{"id":"907ef7ba0dfe_34","__typename":"Paragraph","name":"d4bd","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:7c9690ac8588ca4a9f1c5e276c999457"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_35":{"id":"907ef7ba0dfe_35","__typename":"Paragraph","name":"bdab","text":"In this example, $EncodedCertBlob is just the contents of the exported cloned root CA .cer file base64-encoded. $CertThumbprint is the thumbprint value (i.e. SHA1 hash of the certificate). So, upon installation of that certificate, any code signed with a certificate from that CA will properly validate. In this particular case, the code will additionally give the appearance of being Microsoft-signed code.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_36":{"id":"907ef7ba0dfe_36","__typename":"Paragraph","name":"8a63","text":"Detecting Malicious Root CA Certificate Installation","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_37":{"id":"907ef7ba0dfe_37","__typename":"Paragraph","name":"ffe9","text":"Considering the root of this attack involves installation of a root CA certificate, this action will be the focus of building a detection. The installation of root CAs should be sufficiently uncommon such that a high-fidelity alert should be possible by monitoring the registry. Sysmon serves this purpose really well and what follows is an ideal config for catching root certificate installation:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_38":{"id":"907ef7ba0dfe_38","__typename":"Paragraph","name":"bcc6","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:871f25e39be5a15e3421dd2158c2730e"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_39":{"id":"907ef7ba0dfe_39","__typename":"Paragraph","name":"cffb","text":"When an event fires, it would look like the following:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_40":{"id":"907ef7ba0dfe_40","__typename":"Paragraph","name":"db70","text":"Registry value set:\nEventType: SetValue\nUtcTime: 2017-12-20 17:12:11.999\nProcessGuid: {7ed59fb9-99eb-5a3a-0000-00102ab1af06}\nProcessId: 4404\nImage: C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\SystemCertificates\\ROOT\\Certificates\\1F3D38F280635F275BE92B87CF83E40E40458400\\Blob\nDetails: Binary Data","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_41":{"id":"907ef7ba0dfe_41","__typename":"Paragraph","name":"0f5c","text":"Using this rule set, you will likely get a lot of CreateKey event false positives. The high-fidelity events to pay attention to are SetValue events where the TargetObject property ends with “\u003CTHUMBPRINT_VALUE\u003E\\Blob” as this indicates the direct installation or modification of a root certificate binary blob. Unfortunately, as of this writing, Sysmon configurations don’t allow sufficient granularity to constrain a set of registry events to a specific EventType nor are wildcards permitted in rule entries.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_42":{"id":"907ef7ba0dfe_42","__typename":"Paragraph","name":"1095","text":"So the next question to ask yourself would be, “how do I know if this root certificate installation is ‘malicious’?” A logical first step would be to investigate the contents of the certificate to see if anything stands out. PowerShell makes inspecting certificates really easy.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_43":{"id":"907ef7ba0dfe_43","__typename":"Paragraph","name":"9f87","text":"Get-ChildItem -Path Cert:\\ -Recurse | Where-Object { $_.Thumbprint -eq '1F3D38F280635F275BE92B87CF83E40E40458400' } | For\nmat-List *","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_44":{"id":"907ef7ba0dfe_44","__typename":"Paragraph","name":"7e22","text":"The result of running this command might produce the following output:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_45":{"id":"907ef7ba0dfe_45","__typename":"Paragraph","name":"d60f","text":"PSPath                   : Microsoft.PowerShell.Security\\Certificate::LocalMachine\\Root\\1F3D38F280635F275BE92B87CF83E40E40458400\nPSParentPath             : Microsoft.PowerShell.Security\\Certificate::LocalMachine\\Root\nPSChildName              : 1F3D38F280635F275BE92B87CF83E40E40458400\nPSDrive                  : Cert\nPSProvider               : Microsoft.PowerShell.Security\\Certificate\nPSIsContainer            : False\nEnhancedKeyUsageList     : {}\nDnsNameList              : {Microsoft Root Certificate Authority 2010}\nSendAsTrustedIssuer      : False\nEnrollmentPolicyEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty\nEnrollmentServerEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty\nPolicyId                 :\nArchived                 : False\nExtensions               : {System.Security.Cryptography.Oid, System.Security.Cryptography.Oid,\n                           System.Security.Cryptography.Oid}\nFriendlyName             :\nIssuerName               : System.Security.Cryptography.X509Certificates.X500DistinguishedName\nNotAfter                 : 11\u002F30\u002F2042 9:06:37 PM\nNotBefore                : 12\u002F1\u002F2017 1:55:14 PM\nHasPrivateKey            : False\nPrivateKey               :\nPublicKey                : System.Security.Cryptography.X509Certificates.PublicKey\nRawData                  : {48, 130, 5, 219...}\nSerialNumber             : 52761736EEA4458142453E2D73FA89B2\nSubjectName              : System.Security.Cryptography.X509Certificates.X500DistinguishedName\nSignatureAlgorithm       : System.Security.Cryptography.Oid\nThumbprint               : 1F3D38F280635F275BE92B87CF83E40E40458400\nVersion                  : 3\nHandle                   : 1849876297952\nIssuer                   : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US\nSubject                  : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_46":{"id":"907ef7ba0dfe_46","__typename":"Paragraph","name":"e99d","text":"To any observer, this certificate definitely has the “look and feel” of a legitimate certificate but what is it exactly that makes a certificate “legitimate” or trusted? That process will be described in the last section of the post.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_47":{"id":"907ef7ba0dfe_47","__typename":"Paragraph","name":"74bb","text":"Preventing Malicious “CurrentUser” Root CA Certificate Installation","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_48":{"id":"907ef7ba0dfe_48","__typename":"Paragraph","name":"2041","text":"In the video demonstrating the root CA installation, it was performed in the current user context. While there may not be strong preventative mitigations for certificate installation as an admin, it is possible to prevent root certificate installation in the current user context by setting the following registry value:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_49":{"id":"907ef7ba0dfe_49","__typename":"Paragraph","name":"e49d","text":"HKLM\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\ProtectedRoots - Flags (REG_DWORD) - 1","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_50":{"id":"907ef7ba0dfe_50","__typename":"Paragraph","name":"42a8","text":"While this registry key is not well documented online, wincrypt.h in the Windows SDK provides some contextual clues regarding the options available to set in the “Flags” value. The following relevant flag values are documented in the header file:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":47,"end":53,"type":"A","href":"https:\u002F\u002Ftechnet.microsoft.com\u002Fen-us\u002Flibrary\u002Fcc783813(v=ws.10).aspx","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_51":{"id":"907ef7ba0dfe_51","__typename":"Paragraph","name":"1bd8","text":"\u002F\u002F Set the following flag to inhibit the opening of the CurrentUser's\n\u002F\u002F .Default physical store when opening the CurrentUser's \"Root\" system store.\n\u002F\u002F The .Default physical store open's the CurrentUser SystemRegistry \"Root\"\n\u002F\u002F store.\n#define CERT_PROT_ROOT_DISABLE_CURRENT_USER_FLAG    0x1","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_52":{"id":"907ef7ba0dfe_52","__typename":"Paragraph","name":"0cc6","text":"\u002F\u002F Set the following flag to inhibit the adding of roots from the\n\u002F\u002F CurrentUser SystemRegistry \"Root\" store to the protected root list\n\u002F\u002F when the \"Root\" store is initially protected.\n#define CERT_PROT_ROOT_INHIBIT_ADD_AT_INIT_FLAG     0x2","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_53":{"id":"907ef7ba0dfe_53","__typename":"Paragraph","name":"84b2","text":"After setting this key, you will get an access denied error when attempting to install a root CA to the CurrentUser Root certificate store.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_54":{"id":"907ef7ba0dfe_54","__typename":"Paragraph","name":"7bef","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Pe1OeWP-UySRMW4aWa4jJQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_55":{"id":"907ef7ba0dfe_55","__typename":"Paragraph","name":"5e6f","text":"So while not the most robust of preventative techniques, preventing non-admin users from trusting their own root CAs is certainly a strong policy to enforce in your organization.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_56":{"id":"907ef7ba0dfe_56","__typename":"Paragraph","name":"4f51","text":"As with any enforced preventative measure, an admin will need to consider “what might this break in my environment?” As with any preventative measure, it is important to roll them out in phases across an environment. If for whatever reason there is a business justification for permitting any user to trust a root certificate, you accept that an attacker or rogue software can trust arbitrary root certificates as well. Windows administrators will always have the ability to push trusted root certificates via Group Policy. A recent case where software installed its own root certificate without alerting the user was a Savitech audio driver. In this case, you would have needed to be admin to trust this root certificate but arbitrary root certificates have no basis for the establishment of trust compared to the arduous steps required to get your root certificate trusted by Microsoft.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":506,"end":522,"type":"A","href":"https:\u002F\u002Ftechnet.microsoft.com\u002Fen-us\u002Flibrary\u002Fcc754841(v=ws.11).aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":620,"end":641,"type":"A","href":"https:\u002F\u002Fwww.bleepingcomputer.com\u002Fnews\u002Fsecurity\u002Fpopular-usb-audio-driver-ships-with-root-certificate-big-security-no-no\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":867,"end":887,"type":"A","href":"https:\u002F\u002Ftechnet.microsoft.com\u002Fen-us\u002Flibrary\u002Fcc751157.aspx","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_57":{"id":"907ef7ba0dfe_57","__typename":"Paragraph","name":"f682","text":"Proper Validation of Root CA Trust","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_58":{"id":"907ef7ba0dfe_58","__typename":"Paragraph","name":"a45a","text":"Until recently, I had actually never considered the way in which the trust of certificates could be validated until version 2.60 of sigcheck was released and the introduced the -v switch for use with -t or -tu:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":132,"end":140,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsysinternals\u002Fdownloads\u002Fsigcheck","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_59":{"id":"907ef7ba0dfe_59","__typename":"Paragraph","name":"a018","text":"-t[u][v]   Dump contents of specified certificate store ('*' for all stores). Specify -tu to query the user store (machine store is the default). Append '-v' to have Sigcheck download the trusted Microsoft root certificate list and only output valid certificates not rooted to a certificate on that list. If the site is not accessible, authrootstl.cab or authroot.stl in the current directory are used instead, if present.","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_60":{"id":"907ef7ba0dfe_60","__typename":"Paragraph","name":"cd25","text":"Here is some example output:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_61":{"id":"907ef7ba0dfe_61","__typename":"Paragraph","name":"e7c1","text":"sigcheck64.exe -tuv -nobanner","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_62":{"id":"907ef7ba0dfe_62","__typename":"Paragraph","name":"30f5","text":"User\\Root:\n  Microsoft Root Certificate Authority 2010\n     Cert Status:    Valid\n     Valid Usage:    All\n     Cert Issuer:    Microsoft Root Certificate Authority 2010\n     Serial Number:  52 76 17 36 EE A4 45 81 42 45 3E 2D 73 FA 89 B2\n     Thumbprint:     1F3D38F280635F275BE92B87CF83E40E40458400\n     Algorithm:      sha256RSA\n     Valid from:     1:55 PM 12\u002F1\u002F2017\n     Valid to:       9:06 PM 11\u002F30\u002F2042","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_63":{"id":"907ef7ba0dfe_63","__typename":"Paragraph","name":"79f6","text":"So why should this entry not be trusted? What is Microsoft’s basis for trust? The answer to that is authroot.stl — a signed, ASN.1 encoded file consisting of the root certificates that Microsoft has deemed to be trustworthy. This is equivalent to the set of root CAs that come installed by default in the operating system. Occasionally, Microsoft may update this list though (whether through addition or revocation) and distribute updates via this link.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":100,"end":112,"type":"A","href":"http:\u002F\u002Funmitigatedrisk.com\u002F?p=259","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":443,"end":452,"type":"A","href":"http:\u002F\u002Fwww.download.windowsupdate.com\u002Fmsdownload\u002Fupdate\u002Fv3\u002Fstatic\u002Ftrustedr\u002Fen\u002Fauthrootstl.cab","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_64":{"id":"907ef7ba0dfe_64","__typename":"Paragraph","name":"2b47","text":"Wanting to understand the STL file format better and not necessarily wanting to rely upon sigcheck for performing root CA trust validation, I wrote a crude parser that extracts all of the trusted certificate thumbprint values so that I could perform similar validation in a PowerShell script. In the screenshot below, you will see the “malicious” cloned root CA certificate highlighted:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":150,"end":162,"type":"A","href":"https:\u002F\u002Fgist.github.com\u002Fmattifestation\u002Fc712e525109f786fbaf6ed576b8d2832","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_65":{"id":"907ef7ba0dfe_65","__typename":"Paragraph","name":"cb90","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fLrpueTtcZk_Gx5qOIxvsA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_66":{"id":"907ef7ba0dfe_66","__typename":"Paragraph","name":"e1b3","text":"It is also possible to parse authroot.stl with certutil.exe:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_67":{"id":"907ef7ba0dfe_67","__typename":"Paragraph","name":"c9e5","text":"certutil -dump authroot.stl","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_68":{"id":"907ef7ba0dfe_68","__typename":"Paragraph","name":"5296","text":"Through parsing authroot.stl, you can also easily determine which Microsoft-specific roots are trustworthy for code signing:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_69":{"id":"907ef7ba0dfe_69","__typename":"Paragraph","name":"8cda","text":"PS\u003E ls Cert:\\LocalMachine\\Root\\ | Where-Object { ($TrustedRootHashes -contains $_.Thumbprint) -and ($_.Subject.StartsWith('CN=Microsoft Root')) }","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_70":{"id":"907ef7ba0dfe_70","__typename":"Paragraph","name":"5886","text":"Thumbprint : CDD4EEAE6000AC7F40C3802C171E30148030C072\nSubject    : CN=Microsoft Root Certificate Authority, DC=microsoft, DC=com","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_71":{"id":"907ef7ba0dfe_71","__typename":"Paragraph","name":"ed43","text":"Thumbprint : A43489159A520F0D93D032CCAF37E7FE20A8B419\nSubject    : CN=Microsoft Root Authority, OU=Microsoft Corporation, OU=Copyright (c) 1997 Microsoft Corp.","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_72":{"id":"907ef7ba0dfe_72","__typename":"Paragraph","name":"c286","text":"Thumbprint : 8F43288AD272F3103B6FB1428485EA3014C0BCFE\nSubject    : CN=Microsoft Root Certificate Authority 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_73":{"id":"907ef7ba0dfe_73","__typename":"Paragraph","name":"ac59","text":"Thumbprint : 3B1EFD3A66EA28B16697394703A72CA340A05BD5\nSubject    : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_74":{"id":"907ef7ba0dfe_74","__typename":"Paragraph","name":"af6b","text":"So the way in which Microsoft-signed code should ideally be validated (versus simply pulling the publisher name and validating that it chains to a “trusted” root) is to perform the following:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_75":{"id":"907ef7ba0dfe_75","__typename":"Paragraph","name":"c0a5","text":"Validate that the integrity of the binary has not been compromised.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_76":{"id":"907ef7ba0dfe_76","__typename":"Paragraph","name":"a4ad","text":"Validate that each certificate in the chain is valid.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_77":{"id":"907ef7ba0dfe_77","__typename":"Paragraph","name":"9f90","text":"Validate that the root certificate has one of the trusted thumbprints present in authroot.stl (listed above). An alternative to validating against authroot.stl is to call the CertVerifyCertificateChainPolicy function passing it the CERT_CHAIN_POLICY_MICROSOFT_ROOT value. Deep inside this function is basically the same array of certificate thumbprints that the root certificate will be validated against.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":175,"end":207,"type":"A","href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Fwindows\u002Fdesktop\u002Faa377163(v=vs.85).aspx","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_78":{"id":"907ef7ba0dfe_78","__typename":"Paragraph","name":"bbb6","text":"One notable omission from authroot.stl is the Microsoft flight root certificate (thumbprint: F8DB7E1C16F1FFD4AAAD4AAD8DFF0F2445184AEB) — the issuer of certificates for Windows Insider Preview builds. Worth noting is the absence of a timestamp countersignature meaning that the signature will fail to validate beyond the certificate validity period. This was likely an intentional decision on the part of Microsoft. The lack of a MSFT timestamp would potentially make the Microsoft flight certificate chain a more viable candidate for cloning assuming a defender isn’t aware of what would be considered a “trusted” root certificate thumbprint. Here’s an example of kernel32.dll signed by a certificate issued by the Microsoft flight root:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_79":{"id":"907ef7ba0dfe_79","__typename":"Paragraph","name":"5ba6","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3toLhPm3VGMpDEl36JE3dg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_80":{"id":"907ef7ba0dfe_80","__typename":"Paragraph","name":"a2df","text":"Conclusion","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:907ef7ba0dfe_81":{"id":"907ef7ba0dfe_81","__typename":"Paragraph","name":"1a3b","text":"Hopefully, by now you have a better appreciation of how attackers can appear to originate from the code signer of their choosing. This isn’t the only signing attack that would permit this, however. I’ve also published related research on how to hijack Subject Interface Packages that effectively allows you to apply legitimate digital signatures to malicious code that passes integrity validation checks.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":245,"end":278,"type":"A","href":"https:\u002F\u002Fspecterops.io\u002Fassets\u002Fresources\u002FSpecterOps_Subverting_Trust_in_Windows.pdf","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_82":{"id":"907ef7ba0dfe_82","__typename":"Paragraph","name":"e186","text":"The purpose of all of this research is twofold: to help encourage defenders and security vendors to challenge assumptions made in their investigative processes but to also educate on the importance of proper code signing validation for the purposes of determining whether any given signed code actually originates from who it claims to originate from.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":294,"end":303,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:907ef7ba0dfe_83":{"id":"907ef7ba0dfe_83","__typename":"Paragraph","name":"4345","text":"Lastly, an astute reader will have noted that there may have been additional anomalies associated with the cloned certificate chain and signed code. I’ll leave discussion of these anomalies for another blog post. See you in 2018!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"MediaResource:275b3e484a7237fec0d268e976cce2b8":{"id":"275b3e484a7237fec0d268e976cce2b8","__typename":"MediaResource","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2F5rjJnxl50Dg%3Ffeature%3Doembed&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D5rjJnxl50Dg&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2F5rjJnxl50Dg%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=youtube","iframeHeight":480,"iframeWidth":854,"title":"Exporting a Certificate Chain to Disk"},"MediaResource:7c50d8732cdf14b30f33ba8b6b60767b":{"id":"7c50d8732cdf14b30f33ba8b6b60767b","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"The steps required to clone a legitimate certificate chain and sign code with it."},"MediaResource:999e8fd0af0d3fd8771ffa92bb19a3d7":{"id":"999e8fd0af0d3fd8771ffa92bb19a3d7","__typename":"MediaResource","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FqF6h2he5B7g%3Ffeature%3Doembed&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DqF6h2he5B7g&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FqF6h2he5B7g%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=youtube","iframeHeight":480,"iframeWidth":854,"title":"Cloning a Certificate Chain, Trusting the Cloned Root, and Signing Code"},"MediaResource:7c9690ac8588ca4a9f1c5e276c999457":{"id":"7c9690ac8588ca4a9f1c5e276c999457","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"An example weaponization of trusting a cloned MSFT root CA certificate by installing directly into the registry"},"MediaResource:871f25e39be5a15e3421dd2158c2730e":{"id":"871f25e39be5a15e3421dd2158c2730e","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"A sample Sysmon config to detect root CA installation in both the LocalMachine and CurrentUser contexts"},"ImageMetadata:1*Pe1OeWP-UySRMW4aWa4jJQ.png":{"id":"1*Pe1OeWP-UySRMW4aWa4jJQ.png","__typename":"ImageMetadata","originalHeight":491,"originalWidth":1197,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*fLrpueTtcZk_Gx5qOIxvsA.png":{"id":"1*fLrpueTtcZk_Gx5qOIxvsA.png","__typename":"ImageMetadata","originalHeight":523,"originalWidth":1596,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*3toLhPm3VGMpDEl36JE3dg.png":{"id":"1*3toLhPm3VGMpDEl36JE3dg.png","__typename":"ImageMetadata","originalHeight":1379,"originalWidth":775,"focusPercentX":null,"focusPercentY":null,"alt":null},"Tag:security":{"id":"security","__typename":"Tag","displayTitle":"Security","normalizedTagSlug":""},"Tag:code-signing":{"id":"code-signing","__typename":"Tag","displayTitle":"Code Signing","normalizedTagSlug":""},"ImageMetadata:1*dy7MvBD79mkCTajDbSssBw.jpeg":{"id":"1*dy7MvBD79mkCTajDbSssBw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:10eca8f7a844-viewerId:lo_6b0e03eab235":{"id":"userId:10eca8f7a844-viewerId:lo_6b0e03eab235","__typename":"UserViewerEdge","isFollowing":false},"User:10eca8f7a844":{"id":"10eca8f7a844","__typename":"User","name":"Christopher Maddalena","username":"cmaddy","bio":"A maker and a hacker","imageId":"1*HUuIXzzmiLidwQHi6Hd3nw.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"cmaddy.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:10eca8f7a844-viewerId:lo_6b0e03eab235"}},"Post:bee58de48e05":{"id":"bee58de48e05","__typename":"Post","title":"Gathering Open Source Intelligence","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fgathering-open-source-intelligence-bee58de48e05","previewImage":{"__ref":"ImageMetadata:1*dy7MvBD79mkCTajDbSssBw.jpeg"},"isPublished":true,"firstPublishedAt":1538499996353,"readingTime":18.150000000000002,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:10eca8f7a844"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*GF6FdIDKpvQxjuNuPsX7kQ.png":{"id":"1*GF6FdIDKpvQxjuNuPsX7kQ.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:3569e97b827d-viewerId:lo_6b0e03eab235":{"id":"userId:3569e97b827d-viewerId:lo_6b0e03eab235","__typename":"UserViewerEdge","isFollowing":false},"User:3569e97b827d":{"id":"3569e97b827d","__typename":"User","name":"Dwight Hohnstein","username":"djhohnstein","bio":"Operator at SpecterOps","imageId":"1*iMfl1D9YqDx5shwmuj9_YA.png","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:3569e97b827d-viewerId:lo_6b0e03eab235"}},"Post:65476e6165b9":{"id":"65476e6165b9","__typename":"Post","title":"Man in the Terminal","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fman-in-the-terminal-65476e6165b9","previewImage":{"__ref":"ImageMetadata:1*GF6FdIDKpvQxjuNuPsX7kQ.png"},"isPublished":true,"firstPublishedAt":1617627579035,"readingTime":5.583018867924529,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:3569e97b827d"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*GHniN9KHMioCdUW5":{"id":"0*GHniN9KHMioCdUW5","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:9689ed358206-viewerId:lo_6b0e03eab235":{"id":"userId:9689ed358206-viewerId:lo_6b0e03eab235","__typename":"UserViewerEdge","isFollowing":false},"User:9689ed358206":{"id":"9689ed358206","__typename":"User","name":"Ryan Hausknecht","username":"hausec","bio":"Security Consultant @ SpecterOps","imageId":"2*LFdW-NbzZFmNHuopdXF2Wg.png","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:9689ed358206-viewerId:lo_6b0e03eab235"}},"Post:ca70b330511a":{"id":"ca70b330511a","__typename":"Post","title":"Attacking Azure, Azure AD, and Introducing PowerZure","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fattacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a","previewImage":{"__ref":"ImageMetadata:0*GHniN9KHMioCdUW5"},"isPublished":true,"firstPublishedAt":1580226779379,"readingTime":13.778301886792454,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:9689ed358206"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*ezJx8ZEu1Va14iscq_h5Gg.png":{"id":"1*ezJx8ZEu1Va14iscq_h5Gg.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:996cb7f12ac1-viewerId:lo_6b0e03eab235":{"id":"userId:996cb7f12ac1-viewerId:lo_6b0e03eab235","__typename":"UserViewerEdge","isFollowing":false},"User:996cb7f12ac1":{"id":"996cb7f12ac1","__typename":"User","name":"Roberto Rodriguez","username":"cyb3rward0g","bio":"","imageId":"1*9WbXEpOxOhaMq99CwG1ESQ.png","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"cyb3rward0g.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:996cb7f12ac1-viewerId:lo_6b0e03eab235"}},"Post:9a99a781fde7":{"id":"9a99a781fde7","__typename":"Post","title":"Threat Hunting with Jupyter Notebooks— Part 1: Your First Notebook 📓","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fthreat-hunting-with-jupyter-notebooks-part-1-your-first-notebook-9a99a781fde7","previewImage":{"__ref":"ImageMetadata:1*ezJx8ZEu1Va14iscq_h5Gg.png"},"isPublished":true,"firstPublishedAt":1559236310322,"readingTime":11.361320754716981,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:996cb7f12ac1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*_yKdMthPwVpKYyHZnvrKJQ.png":{"id":"1*_yKdMthPwVpKYyHZnvrKJQ.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:1bb43103a9a9-viewerId:lo_6b0e03eab235":{"id":"userId:1bb43103a9a9-viewerId:lo_6b0e03eab235","__typename":"UserViewerEdge","isFollowing":false},"User:1bb43103a9a9":{"id":"1bb43103a9a9","__typename":"User","name":"Matt Nelson","username":"enigma0x3","bio":"Red Teamer | Security Researcher | Enjoys abusing features | Tweets are my own | http:\u002F\u002Fgithub.com\u002Fenigma0x3","imageId":"0*6mGXmQSDMYyKuVUK.jpg","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:1bb43103a9a9-viewerId:lo_6b0e03eab235"}},"Post:ff74c39615ba":{"id":"ff74c39615ba","__typename":"Post","title":"CVE-2018–8414: A Case Study in Responsible Disclosure","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fcve-2018-8414-a-case-study-in-responsible-disclosure-ff74c39615ba","previewImage":{"__ref":"ImageMetadata:1*_yKdMthPwVpKYyHZnvrKJQ.png"},"isPublished":true,"firstPublishedAt":1540307028000,"readingTime":11.366981132075471,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:1bb43103a9a9"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*ji6keNd2kNMsDi-Z.png":{"id":"0*ji6keNd2kNMsDi-Z.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:fdf5555c9eb1":{"id":"fdf5555c9eb1","__typename":"Post","title":"Enter Mordor 😈: Pre-recorded Security Events from Simulated Adversarial Techniques 🛡","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fenter-mordor-pre-recorded-security-events-from-simulated-adversarial-techniques-fdf5555c9eb1","previewImage":{"__ref":"ImageMetadata:0*ji6keNd2kNMsDi-Z.png"},"isPublished":true,"firstPublishedAt":1564940155801,"readingTime":12.004716981132075,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:996cb7f12ac1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*YDlbuijY1qh1K0WhSIRFKw.png":{"id":"1*YDlbuijY1qh1K0WhSIRFKw.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:c3ec27263df8":{"id":"c3ec27263df8","__typename":"Post","title":"Putting Sysmon v9.0 AND\u002FOR Grouping Logic to the Test","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fputting-sysmon-v9-0-and-or-grouping-logic-to-the-test-c3ec27263df8","previewImage":{"__ref":"ImageMetadata:1*YDlbuijY1qh1K0WhSIRFKw.png"},"isPublished":true,"firstPublishedAt":1550684529130,"readingTime":11.523584905660378,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:996cb7f12ac1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*8zXAta_r_VbLYM_k":{"id":"0*8zXAta_r_VbLYM_k","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:1121f07f3a5a":{"id":"1121f07f3a5a","__typename":"Post","title":"Malware Development Pt. 1: Dynamic Module Loading in Go","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fmalware-development-pt-1-dynamic-module-loading-in-go-1121f07f3a5a","previewImage":{"__ref":"ImageMetadata:0*8zXAta_r_VbLYM_k"},"isPublished":true,"firstPublishedAt":1598878741728,"readingTime":12.580503144654088,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:3569e97b827d"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"User:3acaeeececb0":{"id":"3acaeeececb0","__typename":"User","name":"Andy Robbins"},"Collaborator:6f98657fc6ec-3acaeeececb0":{"id":"6f98657fc6ec-3acaeeececb0","__typename":"Collaborator","user":{"__ref":"User:3acaeeececb0"},"state":"visible"},"Post:6f98657fc6ec":{"id":"6f98657fc6ec","__typename":"Post","creator":{"__ref":"User:e8e64b89121"},"canonicalUrl":"","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:907ef7ba0dfe_0"},{"__ref":"Paragraph:907ef7ba0dfe_1"},{"__ref":"Paragraph:907ef7ba0dfe_2"},{"__ref":"Paragraph:907ef7ba0dfe_3"},{"__ref":"Paragraph:907ef7ba0dfe_4"},{"__ref":"Paragraph:907ef7ba0dfe_5"},{"__ref":"Paragraph:907ef7ba0dfe_6"},{"__ref":"Paragraph:907ef7ba0dfe_7"},{"__ref":"Paragraph:907ef7ba0dfe_8"},{"__ref":"Paragraph:907ef7ba0dfe_9"},{"__ref":"Paragraph:907ef7ba0dfe_10"},{"__ref":"Paragraph:907ef7ba0dfe_11"},{"__ref":"Paragraph:907ef7ba0dfe_12"},{"__ref":"Paragraph:907ef7ba0dfe_13"},{"__ref":"Paragraph:907ef7ba0dfe_14"},{"__ref":"Paragraph:907ef7ba0dfe_15"},{"__ref":"Paragraph:907ef7ba0dfe_16"},{"__ref":"Paragraph:907ef7ba0dfe_17"},{"__ref":"Paragraph:907ef7ba0dfe_18"},{"__ref":"Paragraph:907ef7ba0dfe_19"},{"__ref":"Paragraph:907ef7ba0dfe_20"},{"__ref":"Paragraph:907ef7ba0dfe_21"},{"__ref":"Paragraph:907ef7ba0dfe_22"},{"__ref":"Paragraph:907ef7ba0dfe_23"},{"__ref":"Paragraph:907ef7ba0dfe_24"},{"__ref":"Paragraph:907ef7ba0dfe_25"},{"__ref":"Paragraph:907ef7ba0dfe_26"},{"__ref":"Paragraph:907ef7ba0dfe_27"},{"__ref":"Paragraph:907ef7ba0dfe_28"},{"__ref":"Paragraph:907ef7ba0dfe_29"},{"__ref":"Paragraph:907ef7ba0dfe_30"},{"__ref":"Paragraph:907ef7ba0dfe_31"},{"__ref":"Paragraph:907ef7ba0dfe_32"},{"__ref":"Paragraph:907ef7ba0dfe_33"},{"__ref":"Paragraph:907ef7ba0dfe_34"},{"__ref":"Paragraph:907ef7ba0dfe_35"},{"__ref":"Paragraph:907ef7ba0dfe_36"},{"__ref":"Paragraph:907ef7ba0dfe_37"},{"__ref":"Paragraph:907ef7ba0dfe_38"},{"__ref":"Paragraph:907ef7ba0dfe_39"},{"__ref":"Paragraph:907ef7ba0dfe_40"},{"__ref":"Paragraph:907ef7ba0dfe_41"},{"__ref":"Paragraph:907ef7ba0dfe_42"},{"__ref":"Paragraph:907ef7ba0dfe_43"},{"__ref":"Paragraph:907ef7ba0dfe_44"},{"__ref":"Paragraph:907ef7ba0dfe_45"},{"__ref":"Paragraph:907ef7ba0dfe_46"},{"__ref":"Paragraph:907ef7ba0dfe_47"},{"__ref":"Paragraph:907ef7ba0dfe_48"},{"__ref":"Paragraph:907ef7ba0dfe_49"},{"__ref":"Paragraph:907ef7ba0dfe_50"},{"__ref":"Paragraph:907ef7ba0dfe_51"},{"__ref":"Paragraph:907ef7ba0dfe_52"},{"__ref":"Paragraph:907ef7ba0dfe_53"},{"__ref":"Paragraph:907ef7ba0dfe_54"},{"__ref":"Paragraph:907ef7ba0dfe_55"},{"__ref":"Paragraph:907ef7ba0dfe_56"},{"__ref":"Paragraph:907ef7ba0dfe_57"},{"__ref":"Paragraph:907ef7ba0dfe_58"},{"__ref":"Paragraph:907ef7ba0dfe_59"},{"__ref":"Paragraph:907ef7ba0dfe_60"},{"__ref":"Paragraph:907ef7ba0dfe_61"},{"__ref":"Paragraph:907ef7ba0dfe_62"},{"__ref":"Paragraph:907ef7ba0dfe_63"},{"__ref":"Paragraph:907ef7ba0dfe_64"},{"__ref":"Paragraph:907ef7ba0dfe_65"},{"__ref":"Paragraph:907ef7ba0dfe_66"},{"__ref":"Paragraph:907ef7ba0dfe_67"},{"__ref":"Paragraph:907ef7ba0dfe_68"},{"__ref":"Paragraph:907ef7ba0dfe_69"},{"__ref":"Paragraph:907ef7ba0dfe_70"},{"__ref":"Paragraph:907ef7ba0dfe_71"},{"__ref":"Paragraph:907ef7ba0dfe_72"},{"__ref":"Paragraph:907ef7ba0dfe_73"},{"__ref":"Paragraph:907ef7ba0dfe_74"},{"__ref":"Paragraph:907ef7ba0dfe_75"},{"__ref":"Paragraph:907ef7ba0dfe_76"},{"__ref":"Paragraph:907ef7ba0dfe_77"},{"__ref":"Paragraph:907ef7ba0dfe_78"},{"__ref":"Paragraph:907ef7ba0dfe_79"},{"__ref":"Paragraph:907ef7ba0dfe_80"},{"__ref":"Paragraph:907ef7ba0dfe_81"},{"__ref":"Paragraph:907ef7ba0dfe_82"},{"__ref":"Paragraph:907ef7ba0dfe_83"}],"sections":[{"__typename":"Section","name":"3b1c","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"abc3","startIndex":13,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"d387","startIndex":32,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"ad8c","startIndex":36,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"4b6c","startIndex":47,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"5fe7","startIndex":57,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"5cae","startIndex":80,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"customStyleSheet":null,"firstPublishedAt":1513954240211,"isLocked":false,"isPublished":true,"isShortform":false,"layerCake":0,"primaryTopic":null,"viewerEdge":{"__ref":"PostViewerEdge:postId:6f98657fc6ec-viewerId:lo_6b0e03eab235"},"title":"Code Signing Certificate Cloning Attacks and Defenses","isMarkedPaywallOnly":false,"mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec","isLimitedState":false,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:security"},{"__ref":"Tag:code-signing"}],"topics":[{"__typename":"Topic","topicId":"d4e7f4144ac5","name":"Cybersecurity"},{"__typename":"Topic","topicId":"decb52b64abf","name":"Programming"}],"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","noIndex":null,"curationStatus":null,"metaDescription":"","latestPublishedAt":1570730737409,"readingTime":10.202830188679245,"previewContent":{"__typename":"PreviewContent","subtitle":"Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any…"},"previewImage":{"__ref":"ImageMetadata:1*fLrpueTtcZk_Gx5qOIxvsA.png"},"clapCount":225,"lockedSource":"LOCKED_POST_SOURCE_NONE","isSuspended":false,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":0,"responseDistribution":"NOT_DISTRIBUTED","internalLinks({\"paging\":{\"limit\":8}})":{"__typename":"InternalLinksConnection","items":[{"__ref":"Post:bee58de48e05"},{"__ref":"Post:65476e6165b9"},{"__ref":"Post:ca70b330511a"},{"__ref":"Post:9a99a781fde7"},{"__ref":"Post:ff74c39615ba"},{"__ref":"Post:fdf5555c9eb1"},{"__ref":"Post:c3ec27263df8"},{"__ref":"Post:1121f07f3a5a"}]},"collaborators":[{"__ref":"Collaborator:6f98657fc6ec-3acaeeececb0"}],"translationSourcePost":null,"inResponseToMediaResource":null,"audioVersionUrl":"","seoTitle":"","updatedAt":1570730737788,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":2},"latestPublishedVersion":"907ef7ba0dfe","isPublishToEmail":false,"voterCount":37,"recommenders":[]}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.32733017.js"></script><script src="https://cdn-client.medium.com/lite/static/js/6484.96815e61.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.23bdaf70.js"></script><script src="https://cdn-client.medium.com/lite/static/js/5573.159bf40f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/instrumentation.8ea15b6a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.65aadb14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1752.a348f767.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/953.19c0a4db.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3211.3e30b0d8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4586.0206cca1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9692.b4a02f3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5064.7974654b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9046.8e42140f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2846.012d369f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2176.958ba593.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2712.a43f33d4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9972.f6abd8ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5828.582128b9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2955.12744204.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7131.faa9f1cc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/664.68f7c552.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8751.a9b26c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2238.af816699.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5009.dbfd66e8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4803.15ea4361.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8127.7b79de8f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6371.bfa476ae.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8995.7ff30d72.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5435.7a0af391.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3874.3f41bcb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1794.574e0f73.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9454.d9a3a4a8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/Post.50144cfa.chunk.js"></script><script>window.main();</script></body></html>