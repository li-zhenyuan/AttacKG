<!doctype html><html lang="en"><head><script defer src="https://cdn.optimizely.com/js/16180790160.js"></script><title data-rh="true">Host-based Threat Modeling &amp; Indicator Design | by Jared Atkinson | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2017-07-18T13:39:13.182Z"/><meta data-rh="true" name="title" content="Host-based Threat Modeling &amp; Indicator Design | by Jared Atkinson | Posts By SpecterOps Team Members"/><meta data-rh="true" property="og:title" content="Host-based Threat Modeling &amp; Indicator Design"/><meta data-rh="true" property="twitter:title" content="Host-based Threat Modeling &amp; Indicator Design"/><meta data-rh="true" name="twitter:site" content="@specterops"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/a9dbbb53d5ea"/><meta data-rh="true" property="al:android:url" content="medium://p/a9dbbb53d5ea"/><meta data-rh="true" property="al:ios:url" content="medium://p/a9dbbb53d5ea"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Focused around malicious use of NTFS Extended Attributes, this post describes a methodology for understanding attack techniques and building behavioral detections for them."/><meta data-rh="true" property="og:description" content="Detecting Zeroaccess Trojan’s abuse of NTFS Extended Attributes… Behaviorally"/><meta data-rh="true" property="twitter:description" content="Detecting Zeroaccess Trojan’s abuse of NTFS Extended Attributes… Behaviorally"/><meta data-rh="true" property="og:url" content="https://posts.specterops.io/host-based-threat-modeling-indicator-design-a9dbbb53d5ea"/><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/host-based-threat-modeling-indicator-design-a9dbbb53d5ea"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/focal/1200/632/51/9/0*7fpGVXnGJQxwapSC."/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/focal/1200/632/51/9/0*7fpGVXnGJQxwapSC."/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@jaredcatkinson"/><meta data-rh="true" name="twitter:creator" content="@jaredcatkinson"/><meta data-rh="true" name="author" content="Jared Atkinson"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="14 min read"/><meta data-rh="true" name="parsely-post-id" content="a9dbbb53d5ea"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@jaredcatkinson"/><link data-rh="true" rel="canonical" href="https://posts.specterops.io/host-based-threat-modeling-indicator-design-a9dbbb53d5ea"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/a9dbbb53d5ea"/><link data-rh="true" rel="icon" href="https://miro.medium.com/fit/c/256/256/1*D-FDlfkqivRBQZoESrwtqw.png"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Ffocal\u002F1200\u002F675\u002F51\u002F9\u002F0*7fpGVXnGJQxwapSC.","https:\u002F\u002Fmiro.medium.com\u002Ffocal\u002F1200\u002F900\u002F51\u002F9\u002F0*7fpGVXnGJQxwapSC.","https:\u002F\u002Fmiro.medium.com\u002Ffocal\u002F1200\u002F1200\u002F51\u002F9\u002F0*7fpGVXnGJQxwapSC."],"url":"https:\u002F\u002Fposts.specterops.io\u002Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea","dateCreated":"2017-07-18T13:35:14.535Z","datePublished":"2017-07-18T13:35:14.535Z","dateModified":"2018-05-04T17:59:59.894Z","headline":"Host-based Threat Modeling & Indicator Design - Posts By SpecterOps Team Members","name":"Host-based Threat Modeling & Indicator Design - Posts By SpecterOps Team Members","description":"Focused around malicious use of NTFS Extended Attributes, this post describes a methodology for understanding attack techniques and building behavioral detections for them.","identifier":"a9dbbb53d5ea","keywords":["Lite:true","Tag:Threat Hunting","Tag:Dfir","Tag:Specterops","Tag:Powershell","Publication:specter-ops-posts","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:0"],"author":{"@type":"Person","name":"Jared Atkinson","url":"https:\u002F\u002Fposts.specterops.io\u002F@jaredcatkinson"},"creator":["Jared Atkinson"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":253,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F506\u002F1*aa0HsXZL43r95TuTJlJNPw.png"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea"}</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="553" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:25px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{position:absolute}.u{top:0}.v{left:0}.w{right:0}.x{z-index:500}.y{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ah{max-width:1192px}.ai{min-width:0}.aj{width:100%}.ak{height:65px}.an{flex:1 0 auto}.ao{fill:rgba(25, 25, 25, 1)}.ap{flex:0 0 auto}.aq{margin-left:16px}.ar{color:rgba(128, 128, 183, 1)}.as{fill:rgba(128, 128, 183, 1)}.at{font-size:inherit}.au{border:inherit}.av{font-family:inherit}.aw{letter-spacing:inherit}.ax{font-weight:inherit}.ay{padding:0}.az{margin:0}.bd:disabled{cursor:default}.be:disabled{color:rgba(163, 208, 162, 0.5)}.bf:disabled{fill:rgba(163, 208, 162, 0.5)}.bg{border-top:none}.bh{background-color:rgba(30, 24, 75, 1)}.bj{height:54px}.bk{overflow:hidden}.bl{margin-right:40px}.bm{height:36px}.bn{width:152px}.bo{overflow:auto}.bp{flex:0 1 auto}.bq{list-style-type:none}.br{line-height:40px}.bs{white-space:nowrap}.bt{overflow-x:auto}.bu{align-items:flex-start}.bv{margin-top:20px}.bw{padding-top:20px}.bx{height:80px}.by{height:20px}.bz{margin-right:15px}.ca{margin-left:15px}.cb:first-child{margin-left:0}.cc{min-width:1px}.cd{background-color:rgba(174, 174, 202, 1)}.ce{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.cf{font-size:13px}.cg{line-height:20px}.ch{color:rgba(235, 234, 250, 1)}.ci{text-transform:uppercase}.cj{letter-spacing:1px}.ck{color:inherit}.cl{fill:inherit}.co:disabled{color:rgba(195, 194, 219, 1)}.cp:disabled{fill:rgba(195, 194, 219, 1)}.cq{margin-bottom:0px}.cr{margin-top:0px}.cs{height:119px}.cv{padding-left:24px}.cw{padding-right:24px}.cx{margin-left:auto}.cy{margin-right:auto}.cz{max-width:728px}.da{box-sizing:border-box}.db{background:rgba(255, 255, 255, 1)}.dc{border:1px solid rgba(230, 230, 230, 1)}.dd{border-radius:4px}.de{box-shadow:0 1px 4px rgba(230, 230, 230, 1)}.df{max-height:100vh}.dg{overflow-y:auto}.dh{top:calc(100vh + 100px)}.di{bottom:calc(100vh + 100px)}.dj{width:10px}.dk{pointer-events:none}.dl{word-break:break-word}.dm{word-wrap:break-word}.dn:after{display:block}.do:after{content:""}.dp:after{clear:both}.dq{max-width:680px}.dr{line-height:1.23}.ds{letter-spacing:0}.dt{font-style:normal}.du{font-family:fell, Georgia, Cambria, "Times New Roman", Times, serif}.ep{margin-bottom:-0.27em}.eq{color:rgba(41, 41, 41, 1)}.er{margin-top:32px}.es{justify-content:space-between}.ew{border-radius:50%}.ex{height:48px}.ey{width:48px}.ez{margin-left:12px}.fa{font-size:14px}.fb{margin-bottom:2px}.fd{max-height:20px}.fe{text-overflow:ellipsis}.ff{display:-webkit-box}.fg{-webkit-line-clamp:1}.fh{-webkit-box-orient:vertical}.fk:disabled{color:rgba(117, 117, 117, 1)}.fl:disabled{fill:rgba(117, 117, 117, 1)}.fm{margin-left:8px}.fn{color:rgba(255, 255, 255, 1)}.fo{padding:0px 8px 1px}.fp{fill:rgba(255, 255, 255, 1)}.fq{background:rgba(128, 128, 183, 1)}.fr{border-color:rgba(128, 128, 183, 1)}.fu:disabled{cursor:inherit}.fv:disabled{opacity:0.3}.fw:disabled:hover{background:rgba(128, 128, 183, 1)}.fx:disabled:hover{border-color:rgba(128, 128, 183, 1)}.fy{border-radius:99em}.fz{border-width:1px}.ga{border-style:solid}.gb{display:inline-block}.gc{text-decoration:none}.gd{color:rgba(117, 117, 117, 1)}.ge{align-items:flex-end}.gm{padding-right:6px}.gp{fill:rgba(117, 117, 117, 1)}.gq{margin-right:8px}.gr{line-height:1.12}.gs{letter-spacing:-0.022em}.gt{font-weight:500}.ho{margin-bottom:-0.28em}.hp{line-height:1.58}.hq{letter-spacing:-0.004em}.hr{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.ik{margin-bottom:-0.46em}.il{text-decoration:underline}.ir{line-height:1.18}.jh{margin-bottom:-0.31em}.ji{font-style:italic}.jj{list-style-type:disc}.jk{margin-left:30px}.jl{padding-left:0px}.jr{max-width:646px}.jx{clear:both}.jy{opacity:0}.jz{transition:opacity 100ms 400ms}.ka{height:100%}.kb{will-change:transform}.kc{transform:translateZ(0)}.kd{margin:auto}.ke{position:relative}.kf{background-color:rgba(242, 242, 242, 1)}.kg{padding-bottom:52.631578947368425%}.kh{height:0}.ki{filter:blur(20px)}.kj{transform:scale(1.1)}.kk{visibility:visible}.kl{margin-top:10px}.km{text-align:center}.kp{max-width:1600px}.kr{cursor:zoom-in}.ks{z-index:auto}.ku{padding-bottom:76.1875%}.kv{padding-bottom:42%}.kw{padding-bottom:45.74999999999999%}.kx{padding-bottom:31.5%}.ky{max-width:1278px}.kz{padding-bottom:14.397496087636933%}.la{font-weight:700}.lb{max-width:1442px}.lc{padding-bottom:26.907073509015255%}.ld{max-width:1438px}.le{padding-bottom:18.08066759388039%}.lf{padding-bottom:39.75%}.lo{padding-bottom:5px}.lp{padding-top:5px}.lq{max-width:100%}.lr{height:auto}.ls{max-width:1534px}.lt{margin-bottom:14px}.lu{padding-top:24px}.lv{padding-bottom:10px}.lw{background-color:rgba(8, 8, 8, 1)}.lx{height:3px}.ly{width:3px}.lz{margin-right:20px}.mf{padding-bottom:NaN%}.mg{will-change:opacity}.mh{position:fixed}.mi{width:188px}.mj{left:50%}.mk{transform:translateX(406px)}.ml{top:calc(65px + 54px + 14px)}.mo{will-change:opacity, transform}.mp{transform:translateY(159px)}.mr{width:131px}.ms{flex-direction:column}.mt{font-size:16px}.mu{padding-bottom:28px}.mv{border-bottom:1px solid rgba(230, 230, 230, 1)}.mw{padding-bottom:20px}.mx{padding-top:2px}.my{max-height:120px}.mz{-webkit-line-clamp:6}.na{padding-top:28px}.nb{margin-bottom:19px}.nc{margin-left:-3px}.ni{outline:0}.nj{border:0}.nk{user-select:none}.nl{cursor:pointer}.nm> svg{pointer-events:none}.no{-webkit-user-select:none}.ny button{text-align:left}.nz{opacity:1}.oa{padding-right:4px}.ob{flex-direction:row}.ok{margin-top:40px}.ol{flex-wrap:wrap}.om{margin-top:25px}.on{margin-bottom:8px}.oo{line-height:22px}.op{border-radius:3px}.oq{padding:5px 10px}.or{background:rgba(242, 242, 242, 1)}.os{max-width:155px}.ow{top:1px}.pe{margin-left:-1px}.pn{padding-right:8px}.po{padding-top:32px}.pp{border-top:1px solid rgba(230, 230, 230, 1)}.pq{margin-bottom:25px}.ps{margin-bottom:32px}.pt{min-height:80px}.py{width:80px}.pz{padding-left:102px}.qb{line-height:18px}.qc{letter-spacing:0.077em}.qd{margin-bottom:6px}.qe{font-size:22px}.qf{line-height:28px}.qg{padding:4px 12px 6px}.qh{max-width:555px}.qi{max-width:450px}.qj{line-height:24px}.qk{display:none}.qm{max-width:550px}.qn{margin-top:5px}.qo{height:40px}.qp{width:40px}.qq{font-size:12px}.qr{line-height:16px}.qs{letter-spacing:0.083em}.qt{padding-top:8px}.qu{margin-bottom:40px}.qv{margin-top:24px}.qw{padding-bottom:16px}.qx{margin-bottom:24px}.sh{flex-grow:0}.si{padding-bottom:24px}.sj{max-width:500px}.sn{padding-bottom:8px}.ta{padding-bottom:100%}.tl{padding:60px 0}.tm{background-color:rgba(0, 0, 0, 0.9)}.to{padding-bottom:48px}.tp{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.tq{margin:0 -12px}.tr{margin:0 12px}.ts{flex:1 1 0}.tv:disabled{color:rgba(255, 255, 255, 0.7)}.tw:disabled{fill:rgba(255, 255, 255, 0.7)}.tx{font-size:20px}.ty{color:rgba(255, 255, 255, 0.98)}.tz{color:rgba(255, 255, 255, 0.7)}.ua{height:22px}.ub{width:200px}.uh{margin-right:16px}.ba:hover{cursor:pointer}.bb:hover{color:rgba(110, 110, 154, 1)}.bc:hover{fill:rgba(110, 110, 154, 1)}.cm:hover{color:rgba(245, 244, 253, 1)}.cn:hover{fill:rgba(245, 244, 253, 1)}.fj:hover{text-decoration:underline}.fs:hover{background:rgba(110, 110, 154, 1)}.ft:hover{border-color:rgba(110, 110, 154, 1)}.gn:hover{color:rgba(25, 25, 25, 1)}.go:hover{fill:rgba(25, 25, 25, 1)}.nq:hover{fill:rgba(117, 117, 117, 1)}.tt:hover{color:rgba(255, 255, 255, 0.99)}.tu:hover{fill:rgba(255, 255, 255, 0.99)}.kt:focus{transform:scale(1.01)}.np:focus{fill:rgba(117, 117, 117, 1)}.nn:active{border-style:none}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ag{margin:0 64px}.el{font-size:48px}.em{margin-top:0.55em}.en{line-height:60px}.eo{letter-spacing:-0.011em}.gl{margin-left:30px}.hk{font-size:30px}.hl{margin-top:1.95em}.hm{line-height:36px}.hn{letter-spacing:0}.ig{font-size:21px}.ih{margin-top:0.86em}.ii{line-height:32px}.ij{letter-spacing:-0.003em}.iq{margin-top:2em}.je{font-size:22px}.jf{margin-top:1.72em}.jg{line-height:28px}.jq{margin-top:1.05em}.jw{margin-top:56px}.ln{max-width:1192px}.me{margin-top:1.25em}.nh{margin-right:5px}.nx{margin-top:5px}.oj{padding-left:6px}.oy{display:inline-block}.pd{width:8px}.pl{padding-left:7px}.pm{top:3px}.rm{width:calc(100% + 32px)}.rn{margin-left:-16px}.ro{margin-right:-16px}.sd{padding-left:16px}.se{padding-right:16px}.sf{flex-basis:25%}.sg{max-width:25%}.sw{font-size:16px}.sx{line-height:20px}.tj{min-width:70px}.tk{min-height:70px}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.gk{margin-left:30px}.kn{margin-left:auto}.ko{text-align:center}.ng{margin-right:5px}.nw{margin-top:5px}.oi{padding-left:6px}.ox{display:inline-block}.pc{width:8px}.pj{padding-left:7px}.pk{top:3px}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.gj{margin-left:30px}.nf{margin-right:5px}.nv{margin-top:5px}.og{padding-left:6px}.oh{top:3px}.ov{display:inline-block}.pb{width:8px}.pi{padding-left:3px}.sm{margin-right:16px}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.al{height:56px}.am{display:flex}.bi{display:block}.ct{margin-bottom:0px}.cu{height:110px}.eu{margin-top:32px}.ev{flex-direction:column-reverse}.gh{margin-bottom:30px}.gi{margin-left:0px}.ne{margin-left:8px}.nt{margin-top:2px}.nu{margin-right:8px}.oe{padding-left:6px}.of{top:3px}.ou{display:inline-block}.pa{width:8px}.pf{margin-left:-4px}.ph{padding-left:3px}.pr{padding-top:0}.pu{margin-bottom:24px}.pv{align-items:center}.pw{width:102px}.px{position:relative}.qa{padding-left:0}.ql{margin-top:24px}.qy{padding-bottom:12px}.qz{margin-top:16px}.sl{margin-right:16px}.sy{margin-left:16px}.sz{margin-right:0px}.tn{padding:32px 0}.uc{width:140px}.ud{margin-bottom:16px}.ue{margin-top:30px}.uf{width:100%}.ug{flex-direction:row}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ab{margin:0 24px}.dv{font-size:34px}.dw{margin-top:0.56em}.dx{line-height:42px}.dy{letter-spacing:-0.016em}.et{margin-top:32px}.fc{margin-bottom:0px}.gf{margin-bottom:30px}.gg{margin-left:0px}.gu{font-size:22px}.gv{margin-top:1.2em}.gw{line-height:28px}.gx{letter-spacing:0}.hs{font-size:18px}.ht{margin-top:0.67em}.hu{letter-spacing:-0.003em}.im{margin-top:1.56em}.is{font-size:20px}.it{margin-top:1.23em}.iu{line-height:24px}.jm{margin-top:1.34em}.js{margin-top:40px}.lg{margin:0}.lh{max-width:100%}.ma{margin-top:0.93em}.nd{margin-left:8px}.nr{margin-top:2px}.ns{margin-right:8px}.oc{padding-left:6px}.od{top:3px}.ot{display:inline-block}.oz{width:8px}.pg{padding-left:3px}.ra{width:calc(100% + 24px)}.rb{margin-left:-12px}.rc{margin-right:-12px}.rp{padding-left:12px}.rq{padding-right:12px}.rr{flex-basis:100%}.sk{margin-right:16px}.so{font-size:16px}.sp{line-height:20px}.tb{min-width:48px}.tc{min-height:48px}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.af{margin:0 64px}.eh{font-size:48px}.ei{margin-top:0.55em}.ej{line-height:60px}.ek{letter-spacing:-0.011em}.hg{font-size:30px}.hh{margin-top:1.95em}.hi{line-height:36px}.hj{letter-spacing:0}.ic{font-size:21px}.id{margin-top:0.86em}.ie{line-height:32px}.if{letter-spacing:-0.003em}.ip{margin-top:2em}.jb{font-size:22px}.jc{margin-top:1.72em}.jd{line-height:28px}.jp{margin-top:1.05em}.jv{margin-top:56px}.lm{max-width:1192px}.md{margin-top:1.25em}.rj{width:calc(100% + 32px)}.rk{margin-left:-16px}.rl{margin-right:-16px}.rz{padding-left:16px}.sa{padding-right:16px}.sb{flex-basis:25%}.sc{max-width:25%}.su{font-size:16px}.sv{line-height:20px}.th{min-width:70px}.ti{min-height:70px}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.ae{margin:0 48px}.ed{font-size:48px}.ee{margin-top:0.55em}.ef{line-height:60px}.eg{letter-spacing:-0.011em}.hc{font-size:30px}.hd{margin-top:1.95em}.he{line-height:36px}.hf{letter-spacing:0}.hy{font-size:21px}.hz{margin-top:0.86em}.ia{line-height:32px}.ib{letter-spacing:-0.003em}.io{margin-top:2em}.iy{font-size:22px}.iz{margin-top:1.72em}.ja{line-height:28px}.jo{margin-top:1.05em}.ju{margin-top:56px}.lk{margin:0}.ll{max-width:100%}.mc{margin-top:1.25em}.rg{width:calc(100% + 28px)}.rh{margin-left:-14px}.ri{margin-right:-14px}.rv{padding-left:14px}.rw{padding-right:14px}.rx{flex-basis:50%}.ry{max-width:50%}.ss{font-size:16px}.st{line-height:20px}.tf{min-width:48px}.tg{min-height:48px}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ac{margin:0 24px}.dz{font-size:34px}.ea{margin-top:0.56em}.eb{line-height:42px}.ec{letter-spacing:-0.016em}.gy{font-size:22px}.gz{margin-top:1.2em}.ha{line-height:28px}.hb{letter-spacing:0}.hv{font-size:18px}.hw{margin-top:0.67em}.hx{letter-spacing:-0.003em}.in{margin-top:1.56em}.iv{font-size:20px}.iw{margin-top:1.23em}.ix{line-height:24px}.jn{margin-top:1.34em}.jt{margin-top:40px}.li{margin:0}.lj{max-width:100%}.mb{margin-top:0.93em}.rd{width:calc(100% + 24px)}.re{margin-left:-12px}.rf{margin-right:-12px}.rs{padding-left:12px}.rt{padding-right:12px}.ru{flex-basis:100%}.sq{font-size:16px}.sr{line-height:20px}.td{min-width:48px}.te{min-height:48px}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="print">.z{display:none}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.fi{max-height:none}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.kq{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.mm{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (max-width: 1230px)">.mn{display:none}</style><style type="text/css" data-fela-rehydration="553" data-fela-type="RULE" media="all and (max-width: 1198px)">.mq{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="s"><nav class="s t u v w c x y z"><div><div class="s c"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="ak n o al am"><div class="n o an x"><a href="https://medium.com/?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q ao"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div><div class="s ap x"><div class="n o"><div class="n o g"><div class="aq s"><span><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=post_page-----a9dbbb53d5ea---------------------nav_reg-----------" class="ar as at au av aw ax ay az ba bb bc bd be bf" rel="noopener">Sign in</a></span></div></div></div></div></div></div></div></div><div class="bg s bh bi"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="bj bk n o"><div class="bl s ap"><a href="https://posts.specterops.io/?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener"><div class="bm bn s"><img alt="Posts By SpecterOps Team Members" class="" src="https://miro.medium.com/max/304/1*aa0HsXZL43r95TuTJlJNPw.png" width="152" height="36"/></div></a></div><div class="bo s bp"><ul class="bq az br bs bt n bu g bv bw bx"><li class="n o by bz ca cb"><span class="ce b cf cg ch ci cj"><a href="https://posts.specterops.io/about?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba cm cn bd co cp" rel="noopener">About</a></span></li><li class="n o by bz ca cb"><span class="ce b cf cg ch ci cj"><a href="https://posts.specterops.io/archive?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba cm cn bd co cp" rel="noopener">All Posts</a></span></li><span class="by cc cd"></span><li class="n o by bz ca cb"><span class="ce b cf cg ch ci cj"><a href="https://www.specterops.io/?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba cm cn bd co cp" rel="noopener">specterops.io</a></span></li></ul></div></div></div></div></div></div></nav><div class="cq cr cs s ct cu"></div><article><section class="cv cw cx cy aj cz da s"></section><span class="s"></span><div><div class="t v dh di dj dk"></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><div class=""><h1 id="1a73" class="dr ds dt du b dv dw dx dy dz ea eb ec ed ee ef eg eh ei ej ek el em en eo ep eq">Host-based Threat Modeling &amp; Indicator Design</h1><div class="er"><div class="n es et eu ev"><div class="o n"><div><a href="https://medium.com/@jaredcatkinson?source=post_page-----a9dbbb53d5ea--------------------------------" rel="noopener"><img alt="Jared Atkinson" class="s ew ex ey" src="https://miro.medium.com/fit/c/96/96/1*sRu1zCJZ_h69U4RuksJhKQ@2x.jpeg" width="48" height="48"/></a></div><div class="ez aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="fb n o fc"><span class="ce b fa cg bk fd fe ff fg fh fi eq"><a href="https://medium.com/@jaredcatkinson?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Jared Atkinson</a></span><div class="fm s ap h"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb206c297df42&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared%20Atkinson&amp;userId=b206c297df42&amp;source=post_page-b206c297df42----a9dbbb53d5ea---------------------follow_byline-----------" class="ce b cf cg fn fo fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div></span></div></div><span class="ce b fa cg gd"><span class="ce b fa cg bk fd fe ff fg fh fi gd"><div><a class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener" href="/host-based-threat-modeling-indicator-design-a9dbbb53d5ea?source=post_page-----a9dbbb53d5ea--------------------------------">Jul 18, 2017</a> <!-- -->·<!-- --> <!-- -->14<!-- --> min read</div></span></span></div></div><div class="n ge gf gg gh gi gj gk gl z"><div class="n o"><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on twitter"><svg width="29" height="29" class="gp"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gp"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on facebook"><svg width="29" height="29" class="gp"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="gq s"><div class="gp"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=post_actions_header--------------------------bookmark_preview-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div><div class="s an"></div></div></div></div></div></div><h1 id="d4e5" class="gr gs dt ce gt gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho eq">Introduction and Background</h1><p id="9edc" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">Last week, my colleague Brian Reitz (<a href="https://twitter.com/brian_psu" class="ck il" rel="noopener">@brian_psu</a>) wrote a brilliant <a class="ck il" rel="noopener" href="/hiding-registry-keys-with-psreflect-b18ec5ac8353">post</a> about leveraging <a href="https://github.com/mattifestation/PSReflect" class="ck il" rel="noopener">PSReflect</a> to model malware techniques. This post builds upon his thought process and explicitly lays out SpecterOps’ methodology surrounding threat modeling and design of defensive indicators.</p><p id="a087" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Ultimately, this process is designed to facilitate researching a technique from the underlying technology all the way to specific implementations. We start by identifying the offensive technique we want to focus on. Once we have a technique, we identify the actual technology that the technique targets. This step forces us to look at the technique from the macro level, while still maintaining a technical perspective. For the next portion of the process we will build on the knowledge we gained to identify relevant data sets, understand how to collect it, and write a proof-of-concept (POC) for implementing the specific attack technique. With these tools we can then begin to understand the technology’s normal behavior and identify how the attack technique deviates from normal as well as validate any assumptions made along the way. Lastly, we will check how the scale of an enterprise environment challenges our assumption and adapt our detection based on this reality.</p><p id="c52b" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">In this post I will leverage the <a href="http://attack.mitre.org/" class="ck il" rel="noopener">MITRE ATT&amp;CK Framework</a> to identify post-exploitation techniques that we may want to focus on.</p><h1 id="dcf5" class="gr gs dt ce gt gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho eq">Methodology</h1><p id="05d4" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">Describing the methodology seems to make the most sense if I work through it using an actual example technique. For the remainder of the post, I will explain my thought process on detecting malicious use of NTFS Extended Attributes (<a href="https://attack.mitre.org/wiki/Technique/T1096" class="ck il" rel="noopener">ATT&amp;CK: T1096 — Defense Evasion/NTFS Extended Attributes</a>), a technique used by the Zeroaccess Trojan since at least 2012.</p><h2 id="5d85" class="ir gs dt ce gt is it iu gx iv iw ix hb iy iz ja hf jb jc jd hj je jf jg hn jh eq">Research Underlying Technology</h2><p id="135d" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">Developing a lasting behavioral detection requires a solid understanding not only of the possible attacker implementations of the technique, but of the underlying technology as well. In this case, how can we truly detect the malicious use of NTFS Extended Attributes (EA) if we don’t actually understand them?! A good place to start delving into this technology is the ATT&amp;CK Framework’s wiki entry for our chosen technique. If we refer to the technique’s wiki we can see the description of the attack and how adversaries leverage this technique to evade in-place defenses:</p><p id="70e7" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq"><em class="ji">“Data or executables may be stored in New Technology File System (NTFS) partition metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus.</em></p><p id="6a0e" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq"><em class="ji">The NTFS format has a feature called Extended Attributes (EA), which allows data to be stored as an attribute of a file or folder.”</em></p><p id="9dd6" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">After reading this, I walk away with some level of understanding, but I also have some questions. Let’s take a look at what we know after reading these sentences:</p><ul class=""><li id="b0c3" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik jj jk jl eq">Attackers are hiding data in NTFS metadata structures (namely Extended Attributes).</li><li id="d9f4" class="hp hq dt hr b hs jm gw hu hv jn ha hx hy jo ia ib ic jp ie if ig jq ii ij ik jj jk jl eq">Data is being hidden so the attacker can bypass AV and other automated scanning solutions.</li></ul><p id="6627" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Let’s take a peek at the questions I’ve come up with:</p><ul class=""><li id="49f9" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik jj jk jl eq">What are Extended Attributes?</li><li id="62d4" class="hp hq dt hr b hs jm gw hu hv jn ha hx hy jo ia ib ic jp ie if ig jq ii ij ik jj jk jl eq">Where are Extended Attributes stored?</li><li id="7c87" class="hp hq dt hr b hs jm gw hu hv jn ha hx hy jo ia ib ic jp ie if ig jq ii ij ik jj jk jl eq">Why are attackers using Extended Attributes?</li><li id="a71e" class="hp hq dt hr b hs jm gw hu hv jn ha hx hy jo ia ib ic jp ie if ig jq ii ij ik jj jk jl eq">Is there any particular advantage to this technique?</li><li id="c875" class="hp hq dt hr b hs jm gw hu hv jn ha hx hy jo ia ib ic jp ie if ig jq ii ij ik jj jk jl eq">How are the attackers interacting with the Extended Attributes (storing and retrieving data)?</li></ul><p id="3a23" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Ok! Lets see what we can do to answer these questions!</p><p id="8abb" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">First things first, we know that EAs are part of NTFS, so we should start by checking out some NTFS documentation. Technically speaking, NTFS is a proprietary file system, so we cannot simply find information about Extended Attributes on MSDN. Luckily, Richard Russon provides excellent <a href="https://flatcap.org/linux-ntfs/ntfs/index.html" class="ck il" rel="noopener">documentation</a> derived from the Linux NTFS driver project. While working on <a href="https://github.com/invoke-ir/powerforensics" class="ck il" rel="noopener">PowerForensics</a> development, this is my first stop when I have an NTFS related question. The page is a gold mine of information about NTFS, including the most niche details about the Master File Table (MFT) and its attributes.</p><p id="4560" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Upon arriving on the page, I searched for “Extended Attribute” and was directed to the <a href="https://flatcap.org/linux-ntfs/ntfs/attributes/ea.html" class="ck il" rel="noopener">$EA page</a>. The “Overview” section describes the $EA attribute as:</p><p id="929a" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">“<em class="ji">Used to implement the HPFS extended attribute under NTFS. This file attribute may be non-resident because its stream is likely to grow.</em></p><p id="0c98" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq"><em class="ji">As defined in </em><a href="https://flatcap.org/linux-ntfs/ntfs/files/attrdef.html" class="ck il" rel="noopener"><em class="ji">$AttrDef</em></a><em class="ji">, this attribute has a no minimum size but a maximum of 65536 bytes.</em>”</p><p id="ec2c" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">The documentation also provides a the $EA attribute data structure as shown below:</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div class="cx cy jr"><div class="kd s ke kf"><div class="kg kh s"><div class="jy jz t u v ka aj bk kb kc"><img alt="" class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/1*vd9kotlrDoDOzZeZ5hpNsQ.png?q=20" width="646" height="340" role="presentation"/></div><img alt="" class="jy jz t u v ka aj c" width="646" height="340" role="presentation"/><noscript><img alt="" class="t u v ka aj" src="https://miro.medium.com/max/1292/1*vd9kotlrDoDOzZeZ5hpNsQ.png" width="646" height="340" srcSet="https://miro.medium.com/max/552/1*vd9kotlrDoDOzZeZ5hpNsQ.png 276w, https://miro.medium.com/max/1104/1*vd9kotlrDoDOzZeZ5hpNsQ.png 552w, https://miro.medium.com/max/1280/1*vd9kotlrDoDOzZeZ5hpNsQ.png 640w, https://miro.medium.com/max/1292/1*vd9kotlrDoDOzZeZ5hpNsQ.png 646w" sizes="646px" role="presentation"/></noscript></div></div></div><figcaption class="kl km cz cx cy kn ko ce b fa cg gd">$EA attribute structure retrieved from <a href="https://flatcap.org/linux-ntfs/ntfs/attributes/ea.html" class="ck il" rel="noopener">https://flatcap.org/linux-ntfs/ntfs/attributes/ea.html</a></figcaption></figure><p id="e6a1" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Turns out Extended Attributes are Master File Table attributes, meaning it serves to provide some sort of metadata about a file. For some context, a few of the more well known attributes are the <a href="https://flatcap.org/linux-ntfs/ntfs/attributes/standard_information.html" class="ck il" rel="noopener">$STANDARD_INFORMATION</a> attribute (stores the timestamps we see in File Explorer), the <a href="https://flatcap.org/linux-ntfs/ntfs/attributes/file_name.html" class="ck il" rel="noopener">$FILE_NAME</a> attribute (keeps track of the file’s name), and the <a href="https://flatcap.org/linux-ntfs/ntfs/attributes/data.html" class="ck il" rel="noopener">$DATA</a> attribute (which contains or points to the file’s contents). It also looks like the $EA is used for compatibility with the High Performance File System (HPFS), which is a legacy file system that is unlikely to be used in conjunction with modern operating systems. I also see that a $EA is basically a name/value pair where the Value field can store arbitrary data (possibly code) with a maximum size of ~65536 bytes.</p><p id="21fc" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">With a generic concept of EA, we can look at the overarching concept of the Master File Table. The MFT is a metadata structure present on every NTFS formatted partition. The MFT maintains a record for every “file” (data files and directories) on the partition and each record contains file data and metadata. For a bit more understanding of how the MFT works, I’ve included a poster I made to break down the structure of a Master File Table record below:</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy kp"><div class="kd s ke kf"><div class="ku kh s"><div class="jy jz t u v ka aj bk kb kc"><img alt="" class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*7fpGVXnGJQxwapSC.?q=20" width="1600" height="1219" role="presentation"/></div><img alt="" class="jy jz t u v ka aj c" width="1600" height="1219" role="presentation"/><noscript><img alt="" class="t u v ka aj" src="https://miro.medium.com/max/3200/0*7fpGVXnGJQxwapSC." width="1600" height="1219" srcSet="https://miro.medium.com/max/552/0*7fpGVXnGJQxwapSC. 276w, https://miro.medium.com/max/1104/0*7fpGVXnGJQxwapSC. 552w, https://miro.medium.com/max/1280/0*7fpGVXnGJQxwapSC. 640w, https://miro.medium.com/max/1400/0*7fpGVXnGJQxwapSC. 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="29b8" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Notice that an MFT Record is composed of a header that describes the record’s place in the MFT itself and an array of “Attributes.” As mentioned earlier, there are numerous attribute types and some are more common than others. For instance, every MFT Record has a $STANDARD_INFORMATION attribute and at least one $FILE_NAME attribute, while a data file will also have at least one $DATA attribute (any additional $DATA attributes are what we all know as “Alternate Data Streams”). Other attributes are used in certain situations, including $EA attributes (Extended Attributes), which seem to be used rather infrequently.</p><p id="4df5" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">With this understanding of Extended Attributes and how they fit into the MFT picture, we can begin looking at how attackers leverage this technique to achieve their objectives.</p><h1 id="db01" class="gr gs dt ce gt gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho eq">Understand and Model Technique</h1><p id="709f" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">In the last section, we learned about NTFS, specifically the Master File Table and its $EA attribute. During our research, one thing stood out to me. You may have noticed that I mentioned Alternate Data Streams (ADS). ADS is a popular place for attackers to hide files, but the proliferation of this technique has led to the popularization of ADS detections. When we looked at the structure of the $EA attribute, it appears to be a good place to store arbitrary data that matches up with the description on the technique’s <a href="https://attack.mitre.org/wiki/Technique/T1096" class="ck il" rel="noopener">wiki page</a>. It appears we are dealing with a creative alternative to hiding data in ADS and banking on the idea that less tools/people are looking for Extended Attributes being used to store attacker-supplied data.</p><p id="2c95" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Our background of the Master File Table, and more specifically Extended Attributes, allows us to address detecting this technique behaviorally. This portion of the process focuses on modeling the technique. This includes identifying data relating to this technique, collecting said data, and writing a simple POC to confirm your understanding and to test your data collection.</p><h2 id="2c3c" class="ir gs dt ce gt is it iu gx iv iw ix hb iy iz ja hf jb jc jd hj je jf jg hn jh eq">Identify Related Data Set</h2><p id="23a0" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">First things first, we need to identify what data we need to collect. Some situations call for multiple data sets that must be compared to identify the malicious behavior, but in this case it appears that we only need to look for Extended Attributes throughout the file system.</p><h2 id="a75c" class="ir gs dt ce gt is it iu gx iv iw ix hb iy iz ja hf jb jc jd hj je jf jg hn jh eq">Implement Collection</h2><p id="7bc0" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">Before we begin analyzing behavior for detections, we need to understand how to collect relevant data (in this case NTFS Extended Attributes).</p><p id="f902" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">As the developer of PowerForensics, my initial thought was to add support for $EA attributes (something I need to do anyway) and then use my MFT parser to identify all $EA attributes on the file system. After considering this method for a bit, I decided I wanted to also provide a more lightweight option that leverages the Windows API to check a file for an Extended Attribute.</p><p id="9829" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Initially, I had no idea how to enumerate Extended Attributes through the Windows API, but the ATT&amp;CK wiki pointed me to a <a href="http://www.symantec.com/connect/blogs/trojanzeroaccessc-hidden-ntfs-ea" class="ck il" rel="noopener">blog post</a> by Symantec researcher Mircea Ciubotariu. Mircea finds that Zeroaccess Trojan used the <a href="https://msdn.microsoft.com/en-us/library/windows/hardware/ff961908(v=vs.85).aspx" class="ck il" rel="noopener">ZwSetEaFile</a> and <a href="https://msdn.microsoft.com/en-us/library/windows/hardware/ff961907(v=vs.85).aspx" class="ck il" rel="noopener">ZwQueryEaFile</a> functions to interact with the Extended Attributes. Awesome! We now know the API calls we need to implement to create and enumerate Extended Attributes.</p><p id="ab2e" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">NOTE: Since this is a post about methodology, I am not going to get into details about the code itself as I believe that will distract from the point of this post. I plan on writing a follow up post that will cover the specific implementation of the “Zw*EaFile” family of functions. For now, there will be a bit of hand waving just to get the point across.</p><p id="68c3" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Since this section is focusing on collection, let’s start with ZwQueryEaFile. I wrote an abstraction function for ZwQueryEaFile in PowerShell using <a href="https://github.com/mattifestation/PSReflect" class="ck il" rel="noopener">PSReflect</a>. Below you will find the MSDN C++ function definition for ZwQueryEaFile:</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy kp"><div class="kd s ke kf"><div class="kv kh s"><div class="jy jz t u v ka aj bk kb kc"><img alt="" class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*bCNHLLzKy8Dq5OLT.?q=20" width="1600" height="672" role="presentation"/></div><img alt="" class="jy jz t u v ka aj c" width="1600" height="672" role="presentation"/><noscript><img alt="" class="t u v ka aj" src="https://miro.medium.com/max/3200/0*bCNHLLzKy8Dq5OLT." width="1600" height="672" srcSet="https://miro.medium.com/max/552/0*bCNHLLzKy8Dq5OLT. 276w, https://miro.medium.com/max/1104/0*bCNHLLzKy8Dq5OLT. 552w, https://miro.medium.com/max/1280/0*bCNHLLzKy8Dq5OLT. 640w, https://miro.medium.com/max/1400/0*bCNHLLzKy8Dq5OLT. 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="8160" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">A couple of high level observations: the function appears to require multiple calls to enumerate ALL Extended Attributes (a file can have multiple $EA attributes). Also, ZwQueryEaFile requires a handle to the file you are querying, so we need to find a way to get that file handle. After a bit of Googling, I found that NtOpenFile did the trick; you can see the C++ function definition for NtOpenFile below:</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy kp"><div class="kd s ke kf"><div class="kw kh s"><div class="jy jz t u v ka aj bk kb kc"><img alt="" class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*49j6pX6xsRtHP79P.?q=20" width="1600" height="732" role="presentation"/></div><img alt="" class="jy jz t u v ka aj c" width="1600" height="732" role="presentation"/><noscript><img alt="" class="t u v ka aj" src="https://miro.medium.com/max/3200/0*49j6pX6xsRtHP79P." width="1600" height="732" srcSet="https://miro.medium.com/max/552/0*49j6pX6xsRtHP79P. 276w, https://miro.medium.com/max/1104/0*49j6pX6xsRtHP79P. 552w, https://miro.medium.com/max/1280/0*49j6pX6xsRtHP79P. 640w, https://miro.medium.com/max/1400/0*49j6pX6xsRtHP79P. 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="38ae" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Now that we presumably have all the code we need to enumerate a single file for Extended Attributes, we can wrap that functionality and recursively check every file on the file system. Our collection mechanism is now complete.</p><h2 id="aa43" class="ir gs dt ce gt is it iu gx iv iw ix hb iy iz ja hf jb jc jd hj je jf jg hn jh eq">Implement Technique POC or Malware Sample</h2><p id="1796" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">After implementing ZwQueryEaFile, ZwSetEaFile should be pretty straightforward. Again we write an abstracted function using PSReflect, so we can add custom Extended Attributes to any file of our choosing. This function is also simpler because you are choosing the file to write to instead of looking for every instance of a file that has Extended Attributes. Below is the C++ function definition for ZwSetEaFile:</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy kp"><div class="kd s ke kf"><div class="kx kh s"><div class="jy jz t u v ka aj bk kb kc"><img alt="" class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*dyq3jGGw9AQln0mO.?q=20" width="1600" height="504" role="presentation"/></div><img alt="" class="jy jz t u v ka aj c" width="1600" height="504" role="presentation"/><noscript><img alt="" class="t u v ka aj" src="https://miro.medium.com/max/3200/0*dyq3jGGw9AQln0mO." width="1600" height="504" srcSet="https://miro.medium.com/max/552/0*dyq3jGGw9AQln0mO. 276w, https://miro.medium.com/max/1104/0*dyq3jGGw9AQln0mO. 552w, https://miro.medium.com/max/1280/0*dyq3jGGw9AQln0mO. 640w, https://miro.medium.com/max/1400/0*dyq3jGGw9AQln0mO. 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="e334" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">In some cases, writing a POC could be a too big of an investment. In these situations, I like to find a malware sample that implements this technique and use that sample for testing purposes. Each technique’s wiki entry includes references to blog posts or white papers from which the technique’s knowledge was derived. These posts are often a great starting point for understanding the technique itself, as well as the way malware used it in the wild.</p><p id="8464" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Each technique wiki page includes examples of malware that leverage it. An example from the NTFS Extended Attribute entry is below:</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy ky"><div class="kd s ke kf"><div class="kz kh s"><div class="jy jz t u v ka aj bk kb kc"><img alt="" class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*MxEPq2geR6F7bxWO.?q=20" width="1278" height="184" role="presentation"/></div><img alt="" class="jy jz t u v ka aj c" width="1278" height="184" role="presentation"/><noscript><img alt="" class="t u v ka aj" src="https://miro.medium.com/max/2556/0*MxEPq2geR6F7bxWO." width="1278" height="184" srcSet="https://miro.medium.com/max/552/0*MxEPq2geR6F7bxWO. 276w, https://miro.medium.com/max/1104/0*MxEPq2geR6F7bxWO. 552w, https://miro.medium.com/max/1280/0*MxEPq2geR6F7bxWO. 640w, https://miro.medium.com/max/1400/0*MxEPq2geR6F7bxWO. 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="a186" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">What if we just get a copy of Regin or Zeroaccess Trojan and test it in a lab environment? If we refer back to the articles analyzing Zeroaccess and its use of Extended Attributes, we can look for a way to identify the specific version of Zeroaccess that implements this technique. When we review Corey Harrell’s <a href="http://journeyintoir.blogspot.com/2012/12/extracting-zeroaccess-from-ntfs.html" class="ck il" rel="noopener">post</a>, we find the hash for this version of the malware (ee14dcd20b2ee118618e3a28db72cce92ccd9e85dd8410e02479d9d624934b13). We can now use whatever means are available to us to download a copy of this file to use for testing (I found the sample on <a href="https://virusshare.com/" class="ck il" rel="noopener">VirusShare</a>).</p><p id="c638" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Always consider reimplementing the basic functionality involved in the attack technique, as a first priority. This allows threats to be modeled on a generic level without focusing on a specific tool’s implementation. For example, in his <a href="http://journeyintoir.blogspot.com/2012/12/extracting-zeroaccess-from-ntfs.html" class="ck il" rel="noopener">post</a> Corey Harrell provides the following description of Zeroaccess Trojan’s implementation of this technique:</p><p id="50ec" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">“<em class="ji">A large amount of binary data is also written to the NTFS Extended Attributes of services.exe. … ZeroAccess uses this feature to hide a whole PE file as well as shellcode that loads the PE file. The overwritten subroutine in services.exe reads in all the data from the Extended Attributes and executes it.”</em></p><p id="7749" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">If we only analyze ZeroAccess Trojan, we may mistakenly conclude that we only need to check services.exe for Extended Attributes which would obviously not solve the problem in the way we’d like.</p><h1 id="09cf" class="gr gs dt ce gt gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho eq">Detection</h1><p id="53da" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">With the ability to collect Extended Attributes and implement a POC “malicious EA,” we can work on identifying ways to detect malicious use specifically.</p><p id="18fc" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">The first step in building a detection is identifying normal. How normal are Extended Attributes on your average enterprise computer? Is there a different “normal” depending on the Operating System version? Do these normal instances follow an identifiable pattern? If we can answer these questions, then we can begin to wrap our heads around identifying the malicious use or more generically, deviations from normal.</p><p id="0381" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">One thing that is important to remember in this case is that attackers aren’t using Extended Attributes for their original purpose. Attackers are using them as data storage (often PE files) which is not consistent with the “key/value pair” concept we saw in documentation. This information can help us look for patterns when considering normal use versus malicious use.</p><p id="f2ab" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">I put together a couple PowerShell functions to recursively enumerate all files for Extended Attributes (details will be discussed in a future post). You can find my code at the end of the post.</p><p id="c69c" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">First, I ran the function on a stock Windows 7 VM which came back with exactly 0 EAs. This lines up with our original assumption that Extended Attributes are a legacy compatibility feature that is no longer used in modern operating systems. As I mentioned earlier, just because a stock Windows 7 image has no EAs does not mean that this is the default behavior on all OS’s. For this reason I decided to test a Windows 10 VM as well.</p><p id="e3d9" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Before running my Windows 10 test, I wrote an Extended Attribute named <strong class="hr la">TEST</strong> to a file located at C:\demo\ea.exe. I want to make sure the function detects my custom EA, as well as, any built in EAs.</p><p id="e917" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Next, I ran the function on my Windows 10 VM and found 35751 EAs! Either EAs made a come back, or I’m pwned! To get an idea of what is going on, I used PowerShell’s Group-Object cmdlet to group all EAs based on name to see if there is an identifiable pattern.</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy lb"><div class="kd s ke kf"><div class="lc kh s"><div class="jy jz t u v ka aj bk kb kc"><img alt="" class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*Gtx0Gz7-pa6s2xaG.?q=20" width="1442" height="388" role="presentation"/></div><img alt="" class="jy jz t u v ka aj c" width="1442" height="388" role="presentation"/><noscript><img alt="" class="t u v ka aj" src="https://miro.medium.com/max/2884/0*Gtx0Gz7-pa6s2xaG." width="1442" height="388" srcSet="https://miro.medium.com/max/552/0*Gtx0Gz7-pa6s2xaG. 276w, https://miro.medium.com/max/1104/0*Gtx0Gz7-pa6s2xaG. 552w, https://miro.medium.com/max/1280/0*Gtx0Gz7-pa6s2xaG. 640w, https://miro.medium.com/max/1400/0*Gtx0Gz7-pa6s2xaG. 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="10a7" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">35749 out of 35751 EAs are named either <strong class="hr la">$CI.CATALOGHINT</strong> or <strong class="hr la">$KERNEL.PURGE.ESBCACHE</strong>. The remaining two EAs are my “TEST” EA and one named <strong class="hr la">$KERNEL.PURGE.CATALOGHINT</strong> which appears related to the other built in EAs.</p><p id="39d9" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Now we want to see if we can understand the purpose of these EAs. I’ll start with the most prevalent EA <strong class="hr la">$CI.CATALOGHINT</strong>. Let’s take a look at one:</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy ld"><div class="kd s ke kf"><div class="le kh s"><div class="jy jz t u v ka aj bk kb kc"><img alt="" class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*tc7WOgfjnRi9dnMt.?q=20" width="1438" height="260" role="presentation"/></div><img alt="" class="jy jz t u v ka aj c" width="1438" height="260" role="presentation"/><noscript><img alt="" class="t u v ka aj" src="https://miro.medium.com/max/2876/0*tc7WOgfjnRi9dnMt." width="1438" height="260" srcSet="https://miro.medium.com/max/552/0*tc7WOgfjnRi9dnMt. 276w, https://miro.medium.com/max/1104/0*tc7WOgfjnRi9dnMt. 552w, https://miro.medium.com/max/1280/0*tc7WOgfjnRi9dnMt. 640w, https://miro.medium.com/max/1400/0*tc7WOgfjnRi9dnMt. 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="305b" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Upon further review, it appears that all <strong class="hr la">$CI.CATALOGHINT</strong> EAs have a value that is related to a .cat file or a “<a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/install/catalog-files" class="ck il" rel="noopener">digitally-signed catalog file</a>”. These are files that are used to verify the digital signature of other files as a collection and alternative to Authenticode signing each individual file.</p><p id="9e44" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">We can assume that the catalog referenced in the EA is the catalog file that would be used to validate our file’s signature (C:\Windows\bfsvc.exe), but it is best not to assume. We use PowerShell’s Get-AuthenticodeSignature cmdlet to check the digital signature of C:\Windows\bfsvc.exe and it tells us that the file is indeed “Catalog” signed.</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy kp"><div class="kd s ke kf"><div class="lf kh s"><div class="jy jz t u v ka aj bk kb kc"><img alt="" class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*h7o2AwsIBn3ax5qw.?q=20" width="1600" height="636" role="presentation"/></div><img alt="" class="jy jz t u v ka aj c" width="1600" height="636" role="presentation"/><noscript><img alt="" class="t u v ka aj" src="https://miro.medium.com/max/3200/0*h7o2AwsIBn3ax5qw." width="1600" height="636" srcSet="https://miro.medium.com/max/552/0*h7o2AwsIBn3ax5qw. 276w, https://miro.medium.com/max/1104/0*h7o2AwsIBn3ax5qw. 552w, https://miro.medium.com/max/1280/0*h7o2AwsIBn3ax5qw. 640w, https://miro.medium.com/max/1400/0*h7o2AwsIBn3ax5qw. 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="495e" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Next we check the catalog file’s digital signature and it turns out that the catalog file is Authenticode signed (the file itself contains an embedded signature).</p></div></div><div class="jx"><div class="n p"><div class="lg lh li lj lk ll af lm ag ln ai aj"><figure class="js jt ju jv jw jx lo lp paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy kp"><img alt="" class="aj lq lr" src="https://miro.medium.com/max/3200/0*ioo7Jq1cNCS7WBhQ." width="1600" height="450" role="presentation"/></div></div></figure></div></div></div><div class="n p"><div class="ab ac ae af ag dq ai aj"><p id="ffe8" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">One thing to notice is that both files have an identical Thumbprint. This proves that the catalog file referenced in the <strong class="hr la">$CI.CATALOGHINT </strong>EA is the catalog used to validate the base file’s digital signature. Another way to resolve what catalog to use for validating a file is to use <a href="https://technet.microsoft.com/en-us/sysinternals/bb897441.aspx" class="ck il" rel="noopener">sigcheck</a> sysinternals with the <strong class="hr la">-i</strong> parameter.</p><p id="766c" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">When I thought about why this EA is unique to Windows 10, it struck me that $CI likely stands for Code Integrity which is related to Device Guard. This is a security feature included in Windows 10, but unfortunately there is literally no documentation how Device Guard interacts with Extended Attributes. We can now make an educated guess as to the purpose of the <strong class="hr la">$CI.CATALOGHINT</strong>.</p><p id="cff6" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">I will leave the other two EAs as an exercise for the reader, but I’d recommend investigating the relationship between <strong class="hr la">$KERNEL.PURGE.ESBCACHE </strong>and the <a href="https://msdn.microsoft.com/en-us/library/aa475433(v=bts.10).aspx" class="ck il" rel="noopener">Enterprise Service Bus</a>. I also stumbled upon this <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/kernel-extended-attributes" class="ck il" rel="noopener">page</a> which describes the <strong class="hr la">$KERNEL.PURGE </strong>prefix with the statement below:</p><figure class="js jt ju jv jw jx cx cy paragraph-image"><div role="button" tabindex="0" class="kq kr ke ks aj kt"><div class="cx cy ls"><img alt="" class="aj lq lr" src="https://miro.medium.com/max/3068/0*DQfSQQ7YM49OZo06." width="1534" height="764" role="presentation"/></div></div></figure><p id="aa6f" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">I’m interested to hear what EAs you come across and how you think they are being used!</p><p id="9c56" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">Hopefully, this example demonstrated the process I like to follow to understand “normal” behavior on a system.</p><h2 id="7584" class="ir gs dt ce gt is it iu gx iv iw ix hb iy iz ja hf jb jc jd hj je jf jg hn jh eq">Test Detection at Scale</h2><p id="539c" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">It’s one thing to get a working detection on one machine in your test lab, but things can surprise you when you attempt to apply that detection at scale. Once we have identified a detection with fairly low false positive rates in the lab, we need to see how that detection works at scale.</p><p id="b702" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">In my testing, Extended Attributes seem to remain consistent in large environments. In order to not skip this section, I want to describe how to approach this portion of the methodology from the perspective of the <a href="https://adsecurity.org/?p=1640" class="ck il" rel="noopener">Golden Ticket</a> technique. When I think of detections that work in labs, but needed a little more thought after testing at scale, I think of some of the problems I faced with detections I use for Golden Tickets.</p><p id="4793" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">The original assumption was Kerberos tickets (both Ticket Granting Tickets and Service Tickets), in modern environments, should not use RC4 encryption. In our lab environment, this was true and a 100% detection. While an adversary could upgrade to AES encryption, any ticket with RC4 was in fact malicious. We decided to test this at scale and collect tickets across a fairly large environment, and were surprised when we saw TONS of RC4 and therefore, appeared to be TONS of Golden Tickets in the environment (fortunately this was not the case!). After some research and consulting with Sean Metcalf (<a href="https://twitter.com/PyroTek3" class="ck il" rel="noopener">@PyroTek3</a>) over at <a href="https://trimarcsecurity.com/" class="ck il" rel="noopener">Trimarc Security</a>, it turns out that cross-domain and cross-forest tickets use RC4 by default. I assume this is to maintain backward compatibility in cases where the domain being requested is not functional level 2008. Testing this detection at scale can prevent a large amount of effort on trying to address false positives in the future.</p><p id="6f41" class="hp hq dt hr b hs im gw hu hv in ha hx hy io ia ib ic ip ie if ig iq ii ij ik dl eq">This step of the process should also be catered to your environment. For example, many organizations have very few WMI Permanent Event Subscriptions, but maybe someone in your organization has found a useful way to leverage this technology. In most companies, you are unlikely to learn about that just by asking around. Many organizations are too complex for any individual to know everything. The only true way to know how each technology/technique is used in your environment is to look yourself. Every network has its own unique quirks that are sure to surprise you.</p><h1 id="bad6" class="gr gs dt ce gt gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho eq">Conclusion</h1><p id="4601" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">So why go through this lengthy process to build detections? A mature threat hunting program continuously maps documented attack techniques (those found in the MITRE ATT&amp;CK Framework) to durable, behavior based detections. Target techniques should be identified based on your resources and you should cover as much of the attack chain as possible. An attacker must evade all detections throughout the chain to be successful. There is an implicit need to fully understand a technology in order to identify detections that are neither too tactical in nature (something an adversary can easily change) nor too broad (with a high false positive rate). Hopefully this methodology can help your organization work toward a more mature threat hunting program.</p></div></div></section><div class="n p er lt lu lv" role="separator"><span class="lw ew gb lx ly lz"></span><span class="lw ew gb lx ly lz"></span><span class="lw ew gb lx ly"></span></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><h1 id="0717" class="gr gs dt ce gt gu ma gw gx gy mb ha hb hc mc he hf hg md hi hj hk me hm hn ho eq">Code Snippet</h1><p id="2013" class="hp hq dt hr b hs ht gw hu hv hw ha hx hy hz ia ib ic id ie if ig ih ii ij ik dl eq">The following code is for demonstration purposes only. It is quite inefficient in how it recursively traverses the file system. Additionally, the code has a dependency on Matt Graeber’s <a href="https://github.com/mattifestation/psreflect" class="ck il" rel="noopener">PSReflect</a> project.</p><figure class="js jt ju jv jw jx"><div class="kd s ke"><div class="mf kh s"></div></div></figure></div></div></section></div></article><div class="jy dk mh mo aj mp u mm mq" data-test-id="post-sidebar"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="mr n ms"><div class="dk"><div><div class="mu mv s"><a href="https://posts.specterops.io/?source=post_sidebar--------------------------post_sidebar-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><h2 class="ce gt mt cg ds eq dl">Posts By SpecterOps Team Members</h2></a><div class="mw mx s"><p class="ce b fa cg bk my fe ff mz fh fi gd">Posts from SpecterOps team members on various topics…</p></div></div><div class="na nb nc n"><div class="n o"><div class="s ke nd ne nf ng nh"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared%20Atkinson&amp;userId=b206c297df42&amp;source=post_sidebar-----a9dbbb53d5ea---------------------clap_sidebar-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><div class="ay ni nj nk nl nm nn no r np nq"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s nr ns nt nu nv nw nx"><div class="ny"><p class="ce b fa cg gd"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl">75<!-- --> </button></p></div></div></div></div><div class="nb s"><button class="nl nj ay"><div class="oa n o ob"><svg width="25" height="25" class="r nz nl nq" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s ke oc od oe of og oh oi oj"></div></div></button></div><div class="gp"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=post_sidebar-----a9dbbb53d5ea---------------------bookmark_sidebar-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div></div></div><div class="jy dk mg mh mi mj mk ml mm mn"></div><div><div class="ok jx n ms p"><div class="n p"><div class="ab ac ae af ag dq ai aj"><div class="n ol"></div><div class="n o ol"></div><div class="om s"><ul class="ay az"><li class="gb bq gq on"><a href="/tagged/threat-hunting" class="ce b cf oo gd op oq gc s or">Threat Hunting</a></li><li class="gb bq gq on"><a href="/tagged/dfir" class="ce b cf oo gd op oq gc s or">Dfir</a></li><li class="gb bq gq on"><a href="/tagged/specterops" class="ce b cf oo gd op oq gc s or">Specterops</a></li><li class="gb bq gq on"><a href="/tagged/powershell" class="ce b cf oo gd op oq gc s or">Powershell</a></li></ul></div><div class="om n es z"><div class="n o ob"><div class="os s"><span class="s ot ou ov e d"><div class="n o"><div class="s ke nd ne nf ng nh"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared%20Atkinson&amp;userId=b206c297df42&amp;source=post_actions_footer-----a9dbbb53d5ea---------------------clap_footer-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><div class="ay ni nj nk nl nm nn no r np nq"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s nr ns nt nu nv nw nx"><div class="ke ow ny"><p class="ce b fa cg eq"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl">75<span class="s h g f ox oy"> <!-- -->claps</span></button><span class="s h g f ox oy"></span></p></div></div></div></span><span class="s h g f ox oy"><div class="n o"><div class="s ke nd ne nf ng nh"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared%20Atkinson&amp;userId=b206c297df42&amp;source=post_actions_footer-----a9dbbb53d5ea---------------------clap_footer-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><div class="ay ni nj nk nl nm nn no r np nq"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s nr ns nt nu nv nw nx"><div class="ny"><p class="ce b fa cg gd"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl">75<!-- --> </button></p></div></div></div></span></div><div class="s oz pa pb pc pd"></div><button class="nl nj ay"><div class="oa n o ob"><span class="pe s pf"><svg width="25" height="25" class="r nz nl nq" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span><div class="s ke pg od ph of pi oh pj pk pl pm"></div></div></button></div><div class="n o"><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on twitter"><svg width="29" height="29" class="gp"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gp"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on facebook"><svg width="29" height="29" class="gp"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="pn s ap"><div class="gp"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;source=post_actions_footer--------------------------bookmark_footer-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div></div><div><div class="n p"><div class="ab ac ae af ag dq ai aj"><div class="po pp pq om s pr z"><div class="s g"><div class="ps pt s ke"><span class="s pu am pv"><div class="s t pw px"><a href="https://medium.com/@jaredcatkinson?source=follow_footer-------------------------------------" rel="noopener"><img alt="Jared Atkinson" class="s ew bx py" src="https://miro.medium.com/fit/c/160/160/1*sRu1zCJZ_h69U4RuksJhKQ@2x.jpeg" width="80" height="80"/></a></div><span class="s"><div class="pz s qa"><p class="ce b cf qb qc gd ci">Written by</p></div><div class="pz qd n qa"><div class="aj n o es"><h2 class="ce gt qe qf ds eq"><a href="https://medium.com/@jaredcatkinson?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Jared Atkinson</a></h2><div class="s g"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb206c297df42%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared%20Atkinson&amp;userId=b206c297df42&amp;source=follow_footer-b206c297df42-------------------------follow_footer-----------" class="ce b fa cg fn qg fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div></div></span></span><div class="pz qh s qa bi"><div class="qi s"><p class="ce b mt qj gd"></p></div><div class="qk ql bi"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb206c297df42%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared%20Atkinson&amp;userId=b206c297df42&amp;source=follow_footer-b206c297df42-------------------------follow_footer-----------" class="ce b fa cg fn qg fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div></div><div class="po s"></div><div class="ps pt s ke"><span class="s pu am pv"><div class="s t pw px"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" rel="noopener"><img alt="Posts By SpecterOps Team Members" class="dd py bx" src="https://miro.medium.com/fit/c/160/160/1*D-FDlfkqivRBQZoESrwtqw.png" width="80" height="80"/></a></div><span class="s"><div class="pz qd n qa"><div class="aj n o es"><h2 class="ce gt qe qf ds eq"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></h2><div class="s g"></div></div></div></span></span><div class="pz qm s qa bi"><div class="qi s"><p class="ce b mt qj gd">Posts from SpecterOps team members on various topics relating information security</p></div><div class="qk ql bi"></div></div></div></div><div class="qk bi"><div class="lu s"><div class="n ob"><div class="qn s"><a href="https://medium.com/@jaredcatkinson?source=follow_footer-------------------------------------" rel="noopener"><img alt="Jared Atkinson" class="s ew qo qp" src="https://miro.medium.com/fit/c/80/80/1*sRu1zCJZ_h69U4RuksJhKQ@2x.jpeg" width="40" height="40"/></a></div><div class="ez s"><p class="ce b qq qr qs gd ci">Written by</p><div class="n ob"><h2 class="ce gt mt cg ds eq"><a href="https://medium.com/@jaredcatkinson?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Jared Atkinson</a></h2><div class="ez s"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb206c297df42%2Fa9dbbb53d5ea&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea&amp;user=Jared%20Atkinson&amp;userId=b206c297df42&amp;source=follow_footer-b206c297df42-------------------------follow_footer-----------" class="ce b cf cg fn fo fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div><div class="qt s"><p class="ce b fa cg gd"></p></div></div></div><div class="lu s"><div class="n ob"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" rel="noopener"><img alt="Posts By SpecterOps Team Members" class="dd qp qo" src="https://miro.medium.com/fit/c/80/80/1*D-FDlfkqivRBQZoESrwtqw.png" width="40" height="40"/></a><div class="ez s"><div class="n ob"><h2 class="ce gt mt cg ds eq"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></h2><div class="ez s"></div></div><div class="qt s"><p class="ce b fa cg gd">Posts from SpecterOps team members on various topics relating information security</p></div></div></div></div></div></div></div></div></div><div class="s db z"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="qu qv s"><div class="qw mv qx qv s qy qz"><h2 class="ce gt is iu gx iv ix hb iy ja hf jb jd hj je jg hn eq">More From Medium</h2></div><div class="bu n ob ol ra rb rc rd re rf rg rh ri rj rk rl rm rn ro"><div class="rp rq rr lh rs rt ru lj rv rw rx ry rz sa sb sc sd se sf sg sh"><div class="si sj s"><div class="aj ka"><div class="n es"><div class="s bp sk sl sm"><div class="sn s"><h2 class="ce gt so sp gx sq sr hb ss st hf su sv hj sw sx hn eq"><a rel="noopener" href="/gathering-open-source-intelligence-bee58de48e05?source=post_internal_links---------0----------------------------">Gathering Open Source Intelligence</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cmaddy.medium.com/?source=post_internal_links---------0----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Christopher Maddalena</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------0----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sy sz"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/gathering-open-source-intelligence-bee58de48e05?source=post_internal_links---------0----------------------------"><div class="kd s ke kf"><div class="ta kh s"><div class="jy jz t u v ka aj bk kb kc"><img class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/1*dy7MvBD79mkCTajDbSssBw.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="jy jz tb tc td te tf tg th ti tj tk c" width="70" height="70" role="presentation"/><noscript><img class="tb tc td te tf tg th ti tj tk" src="https://miro.medium.com/fit/c/140/140/1*dy7MvBD79mkCTajDbSssBw.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*dy7MvBD79mkCTajDbSssBw.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*dy7MvBD79mkCTajDbSssBw.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rp rq rr lh rs rt ru lj rv rw rx ry rz sa sb sc sd se sf sg sh"><div class="si sj s"><div class="aj ka"><div class="n es"><div class="s bp sk sl sm"><div class="sn s"><h2 class="ce gt so sp gx sq sr hb ss st hf su sv hj sw sx hn eq"><a rel="noopener" href="/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a?source=post_internal_links---------1----------------------------">Attacking Azure, Azure AD, and Introducing PowerZure</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@hausec?source=post_internal_links---------1----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Ryan Hausknecht</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------1----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sy sz"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a?source=post_internal_links---------1----------------------------"><div class="kd s ke kf"><div class="ta kh s"><div class="jy jz t u v ka aj bk kb kc"><img class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*GHniN9KHMioCdUW5?q=20" width="70" height="70" role="presentation"/></div><img class="jy jz tb tc td te tf tg th ti tj tk c" width="70" height="70" role="presentation"/><noscript><img class="tb tc td te tf tg th ti tj tk" src="https://miro.medium.com/fit/c/140/140/0*GHniN9KHMioCdUW5" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*GHniN9KHMioCdUW5 48w, https://miro.medium.com/fit/c/140/140/0*GHniN9KHMioCdUW5 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rp rq rr lh rs rt ru lj rv rw rx ry rz sa sb sc sd se sf sg sh"><div class="si sj s"><div class="aj ka"><div class="n es"><div class="s bp sk sl sm"><div class="sn s"><h2 class="ce gt so sp gx sq sr hb ss st hf su sv hj sw sx hn eq"><a rel="noopener" href="/man-in-the-terminal-65476e6165b9?source=post_internal_links---------2----------------------------">Man in the Terminal</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@djhohnstein?source=post_internal_links---------2----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Dwight Hohnstein</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------2----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sy sz"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/man-in-the-terminal-65476e6165b9?source=post_internal_links---------2----------------------------"><div class="kd s ke kf"><div class="ta kh s"><div class="jy jz t u v ka aj bk kb kc"><img class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/1*GF6FdIDKpvQxjuNuPsX7kQ.png?q=20" width="70" height="70" role="presentation"/></div><img class="jy jz tb tc td te tf tg th ti tj tk c" width="70" height="70" role="presentation"/><noscript><img class="tb tc td te tf tg th ti tj tk" src="https://miro.medium.com/fit/c/140/140/1*GF6FdIDKpvQxjuNuPsX7kQ.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*GF6FdIDKpvQxjuNuPsX7kQ.png 48w, https://miro.medium.com/fit/c/140/140/1*GF6FdIDKpvQxjuNuPsX7kQ.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rp rq rr lh rs rt ru lj rv rw rx ry rz sa sb sc sd se sf sg sh"><div class="si sj s"><div class="aj ka"><div class="n es"><div class="s bp sk sl sm"><div class="sn s"><h2 class="ce gt so sp gx sq sr hb ss st hf su sv hj sw sx hn eq"><a rel="noopener" href="/threat-hunting-with-jupyter-notebooks-part-1-your-first-notebook-9a99a781fde7?source=post_internal_links---------3----------------------------">Threat Hunting with Jupyter Notebooks— Part 1: Your First Notebook 📓</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cyb3rward0g.medium.com/?source=post_internal_links---------3----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Roberto Rodriguez</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------3----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sy sz"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/threat-hunting-with-jupyter-notebooks-part-1-your-first-notebook-9a99a781fde7?source=post_internal_links---------3----------------------------"><div class="kd s ke kf"><div class="ta kh s"><div class="jy jz t u v ka aj bk kb kc"><img class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/1*ezJx8ZEu1Va14iscq_h5Gg.png?q=20" width="70" height="70" role="presentation"/></div><img class="jy jz tb tc td te tf tg th ti tj tk c" width="70" height="70" role="presentation"/><noscript><img class="tb tc td te tf tg th ti tj tk" src="https://miro.medium.com/fit/c/140/140/1*ezJx8ZEu1Va14iscq_h5Gg.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*ezJx8ZEu1Va14iscq_h5Gg.png 48w, https://miro.medium.com/fit/c/140/140/1*ezJx8ZEu1Va14iscq_h5Gg.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rp rq rr lh rs rt ru lj rv rw rx ry rz sa sb sc sd se sf sg sh"><div class="si sj s"><div class="aj ka"><div class="n es"><div class="s bp sk sl sm"><div class="sn s"><h2 class="ce gt so sp gx sq sr hb ss st hf su sv hj sw sx hn eq"><a rel="noopener" href="/cve-2018-8414-a-case-study-in-responsible-disclosure-ff74c39615ba?source=post_internal_links---------4----------------------------">CVE-2018–8414: A Case Study in Responsible Disclosure</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@enigma0x3?source=post_internal_links---------4----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Matt Nelson</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------4----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sy sz"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/cve-2018-8414-a-case-study-in-responsible-disclosure-ff74c39615ba?source=post_internal_links---------4----------------------------"><div class="kd s ke kf"><div class="ta kh s"><div class="jy jz t u v ka aj bk kb kc"><img class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/1*_yKdMthPwVpKYyHZnvrKJQ.png?q=20" width="70" height="70" role="presentation"/></div><img class="jy jz tb tc td te tf tg th ti tj tk c" width="70" height="70" role="presentation"/><noscript><img class="tb tc td te tf tg th ti tj tk" src="https://miro.medium.com/fit/c/140/140/1*_yKdMthPwVpKYyHZnvrKJQ.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*_yKdMthPwVpKYyHZnvrKJQ.png 48w, https://miro.medium.com/fit/c/140/140/1*_yKdMthPwVpKYyHZnvrKJQ.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rp rq rr lh rs rt ru lj rv rw rx ry rz sa sb sc sd se sf sg sh"><div class="si sj s"><div class="aj ka"><div class="n es"><div class="s bp sk sl sm"><div class="sn s"><h2 class="ce gt so sp gx sq sr hb ss st hf su sv hj sw sx hn eq"><a rel="noopener" href="/enter-mordor-pre-recorded-security-events-from-simulated-adversarial-techniques-fdf5555c9eb1?source=post_internal_links---------5----------------------------">Enter Mordor 😈: Pre-recorded Security Events from Simulated Adversarial Techniques 🛡</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cyb3rward0g.medium.com/?source=post_internal_links---------5----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Roberto Rodriguez</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------5----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sy sz"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/enter-mordor-pre-recorded-security-events-from-simulated-adversarial-techniques-fdf5555c9eb1?source=post_internal_links---------5----------------------------"><div class="kd s ke kf"><div class="ta kh s"><div class="jy jz t u v ka aj bk kb kc"><img class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*ji6keNd2kNMsDi-Z.png?q=20" width="70" height="70" role="presentation"/></div><img class="jy jz tb tc td te tf tg th ti tj tk c" width="70" height="70" role="presentation"/><noscript><img class="tb tc td te tf tg th ti tj tk" src="https://miro.medium.com/fit/c/140/140/0*ji6keNd2kNMsDi-Z.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*ji6keNd2kNMsDi-Z.png 48w, https://miro.medium.com/fit/c/140/140/0*ji6keNd2kNMsDi-Z.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rp rq rr lh rs rt ru lj rv rw rx ry rz sa sb sc sd se sf sg sh"><div class="si sj s"><div class="aj ka"><div class="n es"><div class="s bp sk sl sm"><div class="sn s"><h2 class="ce gt so sp gx sq sr hb ss st hf su sv hj sw sx hn eq"><a rel="noopener" href="/putting-sysmon-v9-0-and-or-grouping-logic-to-the-test-c3ec27263df8?source=post_internal_links---------6----------------------------">Putting Sysmon v9.0 AND/OR Grouping Logic to the Test</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cyb3rward0g.medium.com/?source=post_internal_links---------6----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Roberto Rodriguez</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------6----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sy sz"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/putting-sysmon-v9-0-and-or-grouping-logic-to-the-test-c3ec27263df8?source=post_internal_links---------6----------------------------"><div class="kd s ke kf"><div class="ta kh s"><div class="jy jz t u v ka aj bk kb kc"><img class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/1*YDlbuijY1qh1K0WhSIRFKw.png?q=20" width="70" height="70" role="presentation"/></div><img class="jy jz tb tc td te tf tg th ti tj tk c" width="70" height="70" role="presentation"/><noscript><img class="tb tc td te tf tg th ti tj tk" src="https://miro.medium.com/fit/c/140/140/1*YDlbuijY1qh1K0WhSIRFKw.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*YDlbuijY1qh1K0WhSIRFKw.png 48w, https://miro.medium.com/fit/c/140/140/1*YDlbuijY1qh1K0WhSIRFKw.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rp rq rr lh rs rt ru lj rv rw rx ry rz sa sb sc sd se sf sg sh"><div class="si sj s"><div class="aj ka"><div class="n es"><div class="s bp sk sl sm"><div class="sn s"><h2 class="ce gt so sp gx sq sr hb ss st hf su sv hj sw sx hn eq"><a rel="noopener" href="/malware-development-pt-1-dynamic-module-loading-in-go-1121f07f3a5a?source=post_internal_links---------7----------------------------">Malware Development Pt. 1: Dynamic Module Loading in Go</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@djhohnstein?source=post_internal_links---------7----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Dwight Hohnstein</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------7----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s sy sz"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/malware-development-pt-1-dynamic-module-loading-in-go-1121f07f3a5a?source=post_internal_links---------7----------------------------"><div class="kd s ke kf"><div class="ta kh s"><div class="jy jz t u v ka aj bk kb kc"><img class="t u v ka aj ki kj kk" src="https://miro.medium.com/max/60/0*8zXAta_r_VbLYM_k?q=20" width="70" height="70" role="presentation"/></div><img class="jy jz tb tc td te tf tg th ti tj tk c" width="70" height="70" role="presentation"/><noscript><img class="tb tc td te tf tg th ti tj tk" src="https://miro.medium.com/fit/c/140/140/0*8zXAta_r_VbLYM_k" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*8zXAta_r_VbLYM_k 48w, https://miro.medium.com/fit/c/140/140/0*8zXAta_r_VbLYM_k 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="tl s tm tn"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="to tp ps n es g"><div class="tq n es"><div class="tr s ts"><div class="sn s"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba tt tu bd tv tw" rel="noopener"><h2 class="ce gt tx qj ds ty">Learn more.</h2></a></div><p class="ce b fa cg tz">Medium<!-- --> is an open platform where 170 million readers come to find insightful and dynamic thinking. Here, expert and undiscovered voices alike dive into the heart of any topic and bring new ideas to the surface.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba bd tv tw il" rel="noopener">Learn more</a></p></div><div class="tr s ts"><div class="sn s"><a href="https://medium.com/topics?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba tt tu bd tv tw" rel="noopener"><h2 class="ce gt tx qj ds ty">Make <!-- -->Medium<!-- --> yours.</h2></a></div><p class="ce b fa cg tz">Follow the writers, publications, and topics that matter to you, and you’ll see them on your homepage and in your inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba bd tv tw il" rel="noopener">Explore</a></p></div><div class="tr s ts"><div class="sn s"><a href="https://about.medium.com/creators/?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba tt tu bd tv tw" rel="noopener"><h2 class="ce gt tx qj ds ty">Share your thinking.</h2></a></div><p class="ce b fa cg tz">If you have a story to tell, knowledge to share, or a perspective to offer — welcome home. It’s easy and free to post your thinking on any topic.<!-- --> <a href="https://about.medium.com/creators/?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba bd tv tw il" rel="noopener">Write on <!-- -->Medium</a></p></div></div></div><div class="n ms"><div class="n o es"><a href="https://medium.com/?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba tt tu bd tv tw" rel="noopener"><svg viewBox="0 0 3940 610" class="fp ua"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="qt ub n es uc am"><p class="ce b mt qj ty"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba fj bd tv tw" rel="noopener">About</a></p><p class="ce b mt qj ty"><a href="https://help.medium.com/hc/en-us?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba fj bd tv tw" rel="noopener">Help</a></p><p class="ce b mt qj ty"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba fj bd tv tw" rel="noopener">Legal</a></p></div></div><div class="qk ud ue am"><p class="ce b mt qj tz">Get the Medium app</p></div><div class="qk ud uf am ug"><div class="uh s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba tt tu bd tv tw" rel="noopener"><img alt="A button that says &#x27;Download on the App Store&#x27;, and if clicked it will lead you to the iOS App store" class="" src="https://miro.medium.com/max/270/1*Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"/></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----a9dbbb53d5ea--------------------------------" class="ck cl at au av aw ax ay az ba tt tu bd tv tw" rel="noopener"><img alt="A button that says &#x27;Get it on, Google Play&#x27;, and if clicked it will lead you to the Google Play store" class="" src="https://miro.medium.com/max/270/1*W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"/></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210521-194149-8205a38997"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":false},"bookReader":{"assets":{},"reader":{"currentAsset":null,"currentGFI":null,"settingsPanelIsOpen":false,"settings":{"fontFamily":"CHARTER","fontScale":"M","publisherStyling":true,"textAlignment":"start","theme":"White","lineSpacing":0,"wordSpacing":0,"letterSpacing":0},"internalNavCounter":0,"currentSelection":null,"highlights":[]}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-a9dbbb53d5ea","user-b206c297df42","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true}},"debug":{"requestId":"0f018324-3439-480b-87a8-27288bbf2d4a","hybridDevServices":[],"showBookReaderDebugger":false,"originalSpanCarrier":{"ot-tracer-spanid":"098769215e1c7e2a","ot-tracer-traceid":"6d28ae19cf58f8b7","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false},"tracing":{},"config":{"nodeEnv":"production","version":"main-20210521-194149-8205a38997","isTaggedVersion":false,"target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210521-194149-8205a38997"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210521-194149-8205a38997","commit":"8205a389970795cdb2c37068f2062c807d740019"}},"datacenter":"us"},"googleAnalyticsCode":"UA-24232453-2","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium"},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl"},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"meterPost({\"postId\":\"a9dbbb53d5ea\",\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__ref":"MeteringInfo:{}"},"variantFlags":[{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"android_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"assign_default_topic_to_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"author_under_quota_fair_distribution","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"bane_add_user","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"bane_verify_domain","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"branch_seo_metadata","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"covid_19_cdc_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"default_seo_post_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_android_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_resume_reading_toast","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_mobile_featured_chunk","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_post_recommended_from_friends_provider","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"eds_public_story_to_membership_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_local_currency","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_annual_renewal_reminder_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_parse_expires_at","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_renewal_failure","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_about_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_general_admission","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_sticky_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_tag_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_autotier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automated_mission_control_triggers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_blogrolls","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_text_me_the_app","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding_fonts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cleansweep_double_writes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_client_error_tracking","valueType":{"__typename":"VariantFlagString","value":"none"}},{"__typename":"VariantFlag","name":"enable_confirm_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cta_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_custom_domain_v2_settings","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_feature_logging","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_generation_pipeline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_tagline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_earn_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_edit_alt_text","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_sign_in_captcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_embedding_based_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_end_of_post_cleanup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_evhead_com_to_ev_medium_com_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_expanded_feature_chunk_pool","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_by_resend_rules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_expire_processor","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_global_susi_modal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_cancelled","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_expired","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_in_grace_period","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_on_hold","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_renewed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_highlander_member_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hightower_user_bonus","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hot_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_post_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_json_logs_trained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_app_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_notifications","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_homepage_for_selected_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_stories","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_unread_notification_count_mutation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_login_code_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_media_resource_try_catch","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_member_only_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_membership_remove_section_a","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_miro_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mission_control","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_digest_rendering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_welcome_digest_rendering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mute","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_collaborative_filtering_data","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_login_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_member_welcome_email_enhancement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_three_dot_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_user_onboarding_email_enhancement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_parsely","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_patronus_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_popularity_feature","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_page_nav_stickiness_removal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_settings_screen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_tax_status_clarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_primary_topic_for_mobile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_design_reminder","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_page_seo_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_publish_to_email_for_publication_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rank_v2_usage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_receipt_notes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_all","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_edit_and_delete","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_moderation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_follow_feed_cache","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rtr_channel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_save_to_medium","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_signup_friction","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace_ranker_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_feed_urls","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipalti_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trending_posts_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_triton_predictions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trumpland_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_twitter_auth_suggestions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_writer_management","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"entity_driven_subscription_milestone_2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound"}},{"__typename":"VariantFlag","name":"google_sign_in_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_generic_home_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_pub_follow_email_opt_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"is_not_medium_subscriber","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_fastrak","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_stripe_express","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"make_nav_sticky","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"new_transition_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"post_edge_cache_enabled","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"posts_under_quota_fair_distribution","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"provider_for_credit_card_form","valueType":{"__typename":"VariantFlagString","value":"BRAINTREE"}},{"__typename":"VariantFlag","name":"pub_sidebar","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefine_average_post_reading_time","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_post_post_similarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"retrained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"sign_up_with_email_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"single_partition_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_sign_in_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"suppress_apple_missing_expires_date_alert","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"syndicated_pubs_expiry_filter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"use_new_admin_topic_backend","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"postResult({\"id\":\"a9dbbb53d5ea\"})":{"__ref":"Post:a9dbbb53d5ea"}},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":0},"UserViewerEdge:userId:b206c297df42-viewerId:lo_981085450091":{"id":"userId:b206c297df42-viewerId:lo_981085450091","__typename":"UserViewerEdge","isAllowEdsEnabled":false,"isFollowing":false,"readPostsCount":0,"createdAt":0,"lastPostCreatedAt":0,"isBlocking":false,"isUser":false},"User:b206c297df42":{"id":"b206c297df42","__typename":"User","viewerIsUser":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:b206c297df42-viewerId:lo_981085450091"},"customStyleSheet":null,"isSuspended":false,"name":"Jared Atkinson","hasCompletedProfile":false,"bio":"","imageId":"1*sRu1zCJZ_h69U4RuksJhKQ@2x.jpeg","username":"jaredcatkinson","customDomainState":null,"isAuroraVisible":true,"mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":250,"followingCount":5},"hasSubdomain":false,"allowNotes":true,"newsletterV3":null,"twitterScreenName":"jaredcatkinson","followedCollections":2,"atsQualifiedAt":1612205283538},"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"id":"1*D-FDlfkqivRBQZoESrwtqw.png","__typename":"ImageMetadata"},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_981085450091":{"id":"collectionId:f05f8696e3cc-viewerId:lo_981085450091","__typename":"CollectionViewerEdge","isEditor":false,"canEditOwnPosts":false,"canEditPosts":false,"isFollowing":false},"ImageMetadata:1*aa0HsXZL43r95TuTJlJNPw.png":{"id":"1*aa0HsXZL43r95TuTJlJNPw.png","__typename":"ImageMetadata","originalWidth":790,"originalHeight":187},"User:70f84c574024":{"id":"70f84c574024","__typename":"User","atsQualifiedAt":1612205406678},"Collection:f05f8696e3cc":{"id":"f05f8696e3cc","__typename":"Collection","domain":"posts.specterops.io","googleAnalyticsId":"UA-102239211-2","slug":"specter-ops-posts","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","isAuroraVisible":false,"favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"name":"Posts By SpecterOps Team Members","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}},"customStyleSheet":null,"tagline":"Posts from SpecterOps team members on various topics…","isAuroraEligible":false,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_981085450091"},"logo":{"__ref":"ImageMetadata:1*aa0HsXZL43r95TuTJlJNPw.png"},"navItems":[{"__typename":"NavItem","title":"About","url":"https:\u002F\u002Fposts.specterops.io\u002Fabout","type":"ABOUT_PAGE_NAV_ITEM"},{"__typename":"NavItem","title":"All Posts","url":"https:\u002F\u002Fposts.specterops.io\u002Farchive","type":"ARCHIVE_NAV_ITEM"},{"__typename":"NavItem","title":"specterops.io","url":"https:\u002F\u002Fwww.specterops.io","type":"EXTERNAL_LINK_NAV_ITEM"}],"creator":{"__ref":"User:70f84c574024"},"subscriberCount":3251,"avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"newsletterV3":null,"canToggleEmail":false,"description":"Posts from SpecterOps team members on various topics relating information security","ampEnabled":false,"twitterUsername":"specterops","facebookPageId":null,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","status":"ACTIVE","isSubdomain":false}},"ptsQualifiedAt":1616092933111},"PostViewerEdge:postId:a9dbbb53d5ea-viewerId:lo_981085450091":{"id":"postId:a9dbbb53d5ea-viewerId:lo_981085450091","__typename":"PostViewerEdge","readingList":"READING_LIST_NONE","clapCount":0,"creatorPartnerProgramEnrollmentStatus":"PERMISSION_DENIED","shareKey":null},"Paragraph:b6654670b1e4_0":{"id":"b6654670b1e4_0","__typename":"Paragraph","name":"1a73","text":"Host-based Threat Modeling & Indicator Design","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_1":{"id":"b6654670b1e4_1","__typename":"Paragraph","name":"d4e5","text":"Introduction and Background","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_2":{"id":"b6654670b1e4_2","__typename":"Paragraph","name":"9edc","text":"Last week, my colleague Brian Reitz (@brian_psu) wrote a brilliant post about leveraging PSReflect to model malware techniques. This post builds upon his thought process and explicitly lays out SpecterOps’ methodology surrounding threat modeling and design of defensive indicators.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":37,"end":47,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002Fbrian_psu","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":67,"end":71,"type":"A","href":"https:\u002F\u002Fposts.specterops.io\u002Fhiding-registry-keys-with-psreflect-b18ec5ac8353","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":89,"end":98,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fmattifestation\u002FPSReflect","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_3":{"id":"b6654670b1e4_3","__typename":"Paragraph","name":"a087","text":"Ultimately, this process is designed to facilitate researching a technique from the underlying technology all the way to specific implementations. We start by identifying the offensive technique we want to focus on. Once we have a technique, we identify the actual technology that the technique targets. This step forces us to look at the technique from the macro level, while still maintaining a technical perspective. For the next portion of the process we will build on the knowledge we gained to identify relevant data sets, understand how to collect it, and write a proof-of-concept (POC) for implementing the specific attack technique. With these tools we can then begin to understand the technology’s normal behavior and identify how the attack technique deviates from normal as well as validate any assumptions made along the way. Lastly, we will check how the scale of an enterprise environment challenges our assumption and adapt our detection based on this reality.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_4":{"id":"b6654670b1e4_4","__typename":"Paragraph","name":"c52b","text":"In this post I will leverage the MITRE ATT&CK Framework to identify post-exploitation techniques that we may want to focus on.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":33,"end":55,"type":"A","href":"http:\u002F\u002Fattack.mitre.org\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_5":{"id":"b6654670b1e4_5","__typename":"Paragraph","name":"dcf5","text":"Methodology","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_6":{"id":"b6654670b1e4_6","__typename":"Paragraph","name":"05d4","text":"Describing the methodology seems to make the most sense if I work through it using an actual example technique. For the remainder of the post, I will explain my thought process on detecting malicious use of NTFS Extended Attributes (ATT&CK: T1096 — Defense Evasion\u002FNTFS Extended Attributes), a technique used by the Zeroaccess Trojan since at least 2012.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":233,"end":289,"type":"A","href":"https:\u002F\u002Fattack.mitre.org\u002Fwiki\u002FTechnique\u002FT1096","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_7":{"id":"b6654670b1e4_7","__typename":"Paragraph","name":"5d85","text":"Research Underlying Technology","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_8":{"id":"b6654670b1e4_8","__typename":"Paragraph","name":"135d","text":"Developing a lasting behavioral detection requires a solid understanding not only of the possible attacker implementations of the technique, but of the underlying technology as well. In this case, how can we truly detect the malicious use of NTFS Extended Attributes (EA) if we don’t actually understand them?! A good place to start delving into this technology is the ATT&CK Framework’s wiki entry for our chosen technique. If we refer to the technique’s wiki we can see the description of the attack and how adversaries leverage this technique to evade in-place defenses:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_9":{"id":"b6654670b1e4_9","__typename":"Paragraph","name":"70e7","text":"“Data or executables may be stored in New Technology File System (NTFS) partition metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":217,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_10":{"id":"b6654670b1e4_10","__typename":"Paragraph","name":"6a0e","text":"The NTFS format has a feature called Extended Attributes (EA), which allows data to be stored as an attribute of a file or folder.”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":131,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_11":{"id":"b6654670b1e4_11","__typename":"Paragraph","name":"9dd6","text":"After reading this, I walk away with some level of understanding, but I also have some questions. Let’s take a look at what we know after reading these sentences:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_12":{"id":"b6654670b1e4_12","__typename":"Paragraph","name":"b0c3","text":"Attackers are hiding data in NTFS metadata structures (namely Extended Attributes).","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_13":{"id":"b6654670b1e4_13","__typename":"Paragraph","name":"d9f4","text":"Data is being hidden so the attacker can bypass AV and other automated scanning solutions.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_14":{"id":"b6654670b1e4_14","__typename":"Paragraph","name":"6627","text":"Let’s take a peek at the questions I’ve come up with:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_15":{"id":"b6654670b1e4_15","__typename":"Paragraph","name":"49f9","text":"What are Extended Attributes?","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_16":{"id":"b6654670b1e4_16","__typename":"Paragraph","name":"62d4","text":"Where are Extended Attributes stored?","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_17":{"id":"b6654670b1e4_17","__typename":"Paragraph","name":"7c87","text":"Why are attackers using Extended Attributes?","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_18":{"id":"b6654670b1e4_18","__typename":"Paragraph","name":"a71e","text":"Is there any particular advantage to this technique?","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_19":{"id":"b6654670b1e4_19","__typename":"Paragraph","name":"c875","text":"How are the attackers interacting with the Extended Attributes (storing and retrieving data)?","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_20":{"id":"b6654670b1e4_20","__typename":"Paragraph","name":"3a23","text":"Ok! Lets see what we can do to answer these questions!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_21":{"id":"b6654670b1e4_21","__typename":"Paragraph","name":"8abb","text":"First things first, we know that EAs are part of NTFS, so we should start by checking out some NTFS documentation. Technically speaking, NTFS is a proprietary file system, so we cannot simply find information about Extended Attributes on MSDN. Luckily, Richard Russon provides excellent documentation derived from the Linux NTFS driver project. While working on PowerForensics development, this is my first stop when I have an NTFS related question. The page is a gold mine of information about NTFS, including the most niche details about the Master File Table (MFT) and its attributes.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":287,"end":300,"type":"A","href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Findex.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":362,"end":376,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Finvoke-ir\u002Fpowerforensics","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_22":{"id":"b6654670b1e4_22","__typename":"Paragraph","name":"4560","text":"Upon arriving on the page, I searched for “Extended Attribute” and was directed to the $EA page. The “Overview” section describes the $EA attribute as:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":87,"end":95,"type":"A","href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fea.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_23":{"id":"b6654670b1e4_23","__typename":"Paragraph","name":"929a","text":"“Used to implement the HPFS extended attribute under NTFS. This file attribute may be non-resident because its stream is likely to grow.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":1,"end":136,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_24":{"id":"b6654670b1e4_24","__typename":"Paragraph","name":"0c98","text":"As defined in $AttrDef, this attribute has a no minimum size but a maximum of 65536 bytes.”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":14,"end":22,"type":"A","href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Ffiles\u002Fattrdef.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":90,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_25":{"id":"b6654670b1e4_25","__typename":"Paragraph","name":"ec2c","text":"The documentation also provides a the $EA attribute data structure as shown below:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_26":{"id":"b6654670b1e4_26","__typename":"Paragraph","name":"950a","text":"$EA attribute structure retrieved from https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fea.html","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vd9kotlrDoDOzZeZ5hpNsQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":39,"end":93,"type":"A","href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fea.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_27":{"id":"b6654670b1e4_27","__typename":"Paragraph","name":"e6a1","text":"Turns out Extended Attributes are Master File Table attributes, meaning it serves to provide some sort of metadata about a file. For some context, a few of the more well known attributes are the $STANDARD_INFORMATION attribute (stores the timestamps we see in File Explorer), the $FILE_NAME attribute (keeps track of the file’s name), and the $DATA attribute (which contains or points to the file’s contents). It also looks like the $EA is used for compatibility with the High Performance File System (HPFS), which is a legacy file system that is unlikely to be used in conjunction with modern operating systems. I also see that a $EA is basically a name\u002Fvalue pair where the Value field can store arbitrary data (possibly code) with a maximum size of ~65536 bytes.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":195,"end":216,"type":"A","href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fstandard_information.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":280,"end":290,"type":"A","href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Ffile_name.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":343,"end":348,"type":"A","href":"https:\u002F\u002Fflatcap.org\u002Flinux-ntfs\u002Fntfs\u002Fattributes\u002Fdata.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_28":{"id":"b6654670b1e4_28","__typename":"Paragraph","name":"21fc","text":"With a generic concept of EA, we can look at the overarching concept of the Master File Table. The MFT is a metadata structure present on every NTFS formatted partition. The MFT maintains a record for every “file” (data files and directories) on the partition and each record contains file data and metadata. For a bit more understanding of how the MFT works, I’ve included a poster I made to break down the structure of a Master File Table record below:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_29":{"id":"b6654670b1e4_29","__typename":"Paragraph","name":"e9f3","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*7fpGVXnGJQxwapSC."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_30":{"id":"b6654670b1e4_30","__typename":"Paragraph","name":"29b8","text":"Notice that an MFT Record is composed of a header that describes the record’s place in the MFT itself and an array of “Attributes.” As mentioned earlier, there are numerous attribute types and some are more common than others. For instance, every MFT Record has a $STANDARD_INFORMATION attribute and at least one $FILE_NAME attribute, while a data file will also have at least one $DATA attribute (any additional $DATA attributes are what we all know as “Alternate Data Streams”). Other attributes are used in certain situations, including $EA attributes (Extended Attributes), which seem to be used rather infrequently.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_31":{"id":"b6654670b1e4_31","__typename":"Paragraph","name":"4df5","text":"With this understanding of Extended Attributes and how they fit into the MFT picture, we can begin looking at how attackers leverage this technique to achieve their objectives.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_32":{"id":"b6654670b1e4_32","__typename":"Paragraph","name":"db01","text":"Understand and Model Technique","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_33":{"id":"b6654670b1e4_33","__typename":"Paragraph","name":"709f","text":"In the last section, we learned about NTFS, specifically the Master File Table and its $EA attribute. During our research, one thing stood out to me. You may have noticed that I mentioned Alternate Data Streams (ADS). ADS is a popular place for attackers to hide files, but the proliferation of this technique has led to the popularization of ADS detections. When we looked at the structure of the $EA attribute, it appears to be a good place to store arbitrary data that matches up with the description on the technique’s wiki page. It appears we are dealing with a creative alternative to hiding data in ADS and banking on the idea that less tools\u002Fpeople are looking for Extended Attributes being used to store attacker-supplied data.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":523,"end":532,"type":"A","href":"https:\u002F\u002Fattack.mitre.org\u002Fwiki\u002FTechnique\u002FT1096","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_34":{"id":"b6654670b1e4_34","__typename":"Paragraph","name":"2c95","text":"Our background of the Master File Table, and more specifically Extended Attributes, allows us to address detecting this technique behaviorally. This portion of the process focuses on modeling the technique. This includes identifying data relating to this technique, collecting said data, and writing a simple POC to confirm your understanding and to test your data collection.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_35":{"id":"b6654670b1e4_35","__typename":"Paragraph","name":"2c3c","text":"Identify Related Data Set","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_36":{"id":"b6654670b1e4_36","__typename":"Paragraph","name":"23a0","text":"First things first, we need to identify what data we need to collect. Some situations call for multiple data sets that must be compared to identify the malicious behavior, but in this case it appears that we only need to look for Extended Attributes throughout the file system.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_37":{"id":"b6654670b1e4_37","__typename":"Paragraph","name":"a75c","text":"Implement Collection","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_38":{"id":"b6654670b1e4_38","__typename":"Paragraph","name":"7bc0","text":"Before we begin analyzing behavior for detections, we need to understand how to collect relevant data (in this case NTFS Extended Attributes).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_39":{"id":"b6654670b1e4_39","__typename":"Paragraph","name":"f902","text":"As the developer of PowerForensics, my initial thought was to add support for $EA attributes (something I need to do anyway) and then use my MFT parser to identify all $EA attributes on the file system. After considering this method for a bit, I decided I wanted to also provide a more lightweight option that leverages the Windows API to check a file for an Extended Attribute.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_40":{"id":"b6654670b1e4_40","__typename":"Paragraph","name":"9829","text":"Initially, I had no idea how to enumerate Extended Attributes through the Windows API, but the ATT&CK wiki pointed me to a blog post by Symantec researcher Mircea Ciubotariu. Mircea finds that Zeroaccess Trojan used the ZwSetEaFile and ZwQueryEaFile functions to interact with the Extended Attributes. Awesome! We now know the API calls we need to implement to create and enumerate Extended Attributes.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":123,"end":132,"type":"A","href":"http:\u002F\u002Fwww.symantec.com\u002Fconnect\u002Fblogs\u002Ftrojanzeroaccessc-hidden-ntfs-ea","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":220,"end":231,"type":"A","href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Fwindows\u002Fhardware\u002Fff961908(v=vs.85).aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":236,"end":249,"type":"A","href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Fwindows\u002Fhardware\u002Fff961907(v=vs.85).aspx","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_41":{"id":"b6654670b1e4_41","__typename":"Paragraph","name":"ab2e","text":"NOTE: Since this is a post about methodology, I am not going to get into details about the code itself as I believe that will distract from the point of this post. I plan on writing a follow up post that will cover the specific implementation of the “Zw*EaFile” family of functions. For now, there will be a bit of hand waving just to get the point across.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_42":{"id":"b6654670b1e4_42","__typename":"Paragraph","name":"68c3","text":"Since this section is focusing on collection, let’s start with ZwQueryEaFile. I wrote an abstraction function for ZwQueryEaFile in PowerShell using PSReflect. Below you will find the MSDN C++ function definition for ZwQueryEaFile:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":148,"end":157,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fmattifestation\u002FPSReflect","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_43":{"id":"b6654670b1e4_43","__typename":"Paragraph","name":"9ea9","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*bCNHLLzKy8Dq5OLT."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_44":{"id":"b6654670b1e4_44","__typename":"Paragraph","name":"8160","text":"A couple of high level observations: the function appears to require multiple calls to enumerate ALL Extended Attributes (a file can have multiple $EA attributes). Also, ZwQueryEaFile requires a handle to the file you are querying, so we need to find a way to get that file handle. After a bit of Googling, I found that NtOpenFile did the trick; you can see the C++ function definition for NtOpenFile below:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_45":{"id":"b6654670b1e4_45","__typename":"Paragraph","name":"cb7b","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*49j6pX6xsRtHP79P."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_46":{"id":"b6654670b1e4_46","__typename":"Paragraph","name":"38ae","text":"Now that we presumably have all the code we need to enumerate a single file for Extended Attributes, we can wrap that functionality and recursively check every file on the file system. Our collection mechanism is now complete.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_47":{"id":"b6654670b1e4_47","__typename":"Paragraph","name":"aa43","text":"Implement Technique POC or Malware Sample","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_48":{"id":"b6654670b1e4_48","__typename":"Paragraph","name":"1796","text":"After implementing ZwQueryEaFile, ZwSetEaFile should be pretty straightforward. Again we write an abstracted function using PSReflect, so we can add custom Extended Attributes to any file of our choosing. This function is also simpler because you are choosing the file to write to instead of looking for every instance of a file that has Extended Attributes. Below is the C++ function definition for ZwSetEaFile:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_49":{"id":"b6654670b1e4_49","__typename":"Paragraph","name":"5fa4","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*dyq3jGGw9AQln0mO."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_50":{"id":"b6654670b1e4_50","__typename":"Paragraph","name":"e334","text":"In some cases, writing a POC could be a too big of an investment. In these situations, I like to find a malware sample that implements this technique and use that sample for testing purposes. Each technique’s wiki entry includes references to blog posts or white papers from which the technique’s knowledge was derived. These posts are often a great starting point for understanding the technique itself, as well as the way malware used it in the wild.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_51":{"id":"b6654670b1e4_51","__typename":"Paragraph","name":"8464","text":"Each technique wiki page includes examples of malware that leverage it. An example from the NTFS Extended Attribute entry is below:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_52":{"id":"b6654670b1e4_52","__typename":"Paragraph","name":"673b","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*MxEPq2geR6F7bxWO."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_53":{"id":"b6654670b1e4_53","__typename":"Paragraph","name":"a186","text":"What if we just get a copy of Regin or Zeroaccess Trojan and test it in a lab environment? If we refer back to the articles analyzing Zeroaccess and its use of Extended Attributes, we can look for a way to identify the specific version of Zeroaccess that implements this technique. When we review Corey Harrell’s post, we find the hash for this version of the malware (ee14dcd20b2ee118618e3a28db72cce92ccd9e85dd8410e02479d9d624934b13). We can now use whatever means are available to us to download a copy of this file to use for testing (I found the sample on VirusShare).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":313,"end":317,"type":"A","href":"http:\u002F\u002Fjourneyintoir.blogspot.com\u002F2012\u002F12\u002Fextracting-zeroaccess-from-ntfs.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":560,"end":570,"type":"A","href":"https:\u002F\u002Fvirusshare.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_54":{"id":"b6654670b1e4_54","__typename":"Paragraph","name":"c638","text":"Always consider reimplementing the basic functionality involved in the attack technique, as a first priority. This allows threats to be modeled on a generic level without focusing on a specific tool’s implementation. For example, in his post Corey Harrell provides the following description of Zeroaccess Trojan’s implementation of this technique:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":237,"end":241,"type":"A","href":"http:\u002F\u002Fjourneyintoir.blogspot.com\u002F2012\u002F12\u002Fextracting-zeroaccess-from-ntfs.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_55":{"id":"b6654670b1e4_55","__typename":"Paragraph","name":"50ec","text":"“A large amount of binary data is also written to the NTFS Extended Attributes of services.exe. … ZeroAccess uses this feature to hide a whole PE file as well as shellcode that loads the PE file. The overwritten subroutine in services.exe reads in all the data from the Extended Attributes and executes it.”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":1,"end":307,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_56":{"id":"b6654670b1e4_56","__typename":"Paragraph","name":"7749","text":"If we only analyze ZeroAccess Trojan, we may mistakenly conclude that we only need to check services.exe for Extended Attributes which would obviously not solve the problem in the way we’d like.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_57":{"id":"b6654670b1e4_57","__typename":"Paragraph","name":"09cf","text":"Detection","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_58":{"id":"b6654670b1e4_58","__typename":"Paragraph","name":"53da","text":"With the ability to collect Extended Attributes and implement a POC “malicious EA,” we can work on identifying ways to detect malicious use specifically.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_59":{"id":"b6654670b1e4_59","__typename":"Paragraph","name":"18fc","text":"The first step in building a detection is identifying normal. How normal are Extended Attributes on your average enterprise computer? Is there a different “normal” depending on the Operating System version? Do these normal instances follow an identifiable pattern? If we can answer these questions, then we can begin to wrap our heads around identifying the malicious use or more generically, deviations from normal.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_60":{"id":"b6654670b1e4_60","__typename":"Paragraph","name":"0381","text":"One thing that is important to remember in this case is that attackers aren’t using Extended Attributes for their original purpose. Attackers are using them as data storage (often PE files) which is not consistent with the “key\u002Fvalue pair” concept we saw in documentation. This information can help us look for patterns when considering normal use versus malicious use.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_61":{"id":"b6654670b1e4_61","__typename":"Paragraph","name":"f2ab","text":"I put together a couple PowerShell functions to recursively enumerate all files for Extended Attributes (details will be discussed in a future post). You can find my code at the end of the post.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_62":{"id":"b6654670b1e4_62","__typename":"Paragraph","name":"c69c","text":"First, I ran the function on a stock Windows 7 VM which came back with exactly 0 EAs. This lines up with our original assumption that Extended Attributes are a legacy compatibility feature that is no longer used in modern operating systems. As I mentioned earlier, just because a stock Windows 7 image has no EAs does not mean that this is the default behavior on all OS’s. For this reason I decided to test a Windows 10 VM as well.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_63":{"id":"b6654670b1e4_63","__typename":"Paragraph","name":"e3d9","text":"Before running my Windows 10 test, I wrote an Extended Attribute named TEST to a file located at C:\\demo\\ea.exe. I want to make sure the function detects my custom EA, as well as, any built in EAs.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":71,"end":75,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_64":{"id":"b6654670b1e4_64","__typename":"Paragraph","name":"e917","text":"Next, I ran the function on my Windows 10 VM and found 35751 EAs! Either EAs made a come back, or I’m pwned! To get an idea of what is going on, I used PowerShell’s Group-Object cmdlet to group all EAs based on name to see if there is an identifiable pattern.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_65":{"id":"b6654670b1e4_65","__typename":"Paragraph","name":"ec3e","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*Gtx0Gz7-pa6s2xaG."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_66":{"id":"b6654670b1e4_66","__typename":"Paragraph","name":"10a7","text":"35749 out of 35751 EAs are named either $CI.CATALOGHINT or $KERNEL.PURGE.ESBCACHE. The remaining two EAs are my “TEST” EA and one named $KERNEL.PURGE.CATALOGHINT which appears related to the other built in EAs.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":40,"end":55,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":59,"end":81,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":136,"end":161,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_67":{"id":"b6654670b1e4_67","__typename":"Paragraph","name":"39d9","text":"Now we want to see if we can understand the purpose of these EAs. I’ll start with the most prevalent EA $CI.CATALOGHINT. Let’s take a look at one:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":104,"end":119,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_68":{"id":"b6654670b1e4_68","__typename":"Paragraph","name":"b7ad","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*tc7WOgfjnRi9dnMt."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_69":{"id":"b6654670b1e4_69","__typename":"Paragraph","name":"305b","text":"Upon further review, it appears that all $CI.CATALOGHINT EAs have a value that is related to a .cat file or a “digitally-signed catalog file”. These are files that are used to verify the digital signature of other files as a collection and alternative to Authenticode signing each individual file.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":111,"end":140,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Finstall\u002Fcatalog-files","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":41,"end":56,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_70":{"id":"b6654670b1e4_70","__typename":"Paragraph","name":"9e44","text":"We can assume that the catalog referenced in the EA is the catalog file that would be used to validate our file’s signature (C:\\Windows\\bfsvc.exe), but it is best not to assume. We use PowerShell’s Get-AuthenticodeSignature cmdlet to check the digital signature of C:\\Windows\\bfsvc.exe and it tells us that the file is indeed “Catalog” signed.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_71":{"id":"b6654670b1e4_71","__typename":"Paragraph","name":"a99e","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*h7o2AwsIBn3ax5qw."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_72":{"id":"b6654670b1e4_72","__typename":"Paragraph","name":"495e","text":"Next we check the catalog file’s digital signature and it turns out that the catalog file is Authenticode signed (the file itself contains an embedded signature).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_73":{"id":"b6654670b1e4_73","__typename":"Paragraph","name":"3e6b","text":"","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:0*ioo7Jq1cNCS7WBhQ."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_74":{"id":"b6654670b1e4_74","__typename":"Paragraph","name":"ffe8","text":"One thing to notice is that both files have an identical Thumbprint. This proves that the catalog file referenced in the $CI.CATALOGHINT EA is the catalog used to validate the base file’s digital signature. Another way to resolve what catalog to use for validating a file is to use sigcheck sysinternals with the -i parameter.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":282,"end":290,"type":"A","href":"https:\u002F\u002Ftechnet.microsoft.com\u002Fen-us\u002Fsysinternals\u002Fbb897441.aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":121,"end":137,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":313,"end":315,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_75":{"id":"b6654670b1e4_75","__typename":"Paragraph","name":"766c","text":"When I thought about why this EA is unique to Windows 10, it struck me that $CI likely stands for Code Integrity which is related to Device Guard. This is a security feature included in Windows 10, but unfortunately there is literally no documentation how Device Guard interacts with Extended Attributes. We can now make an educated guess as to the purpose of the $CI.CATALOGHINT.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":364,"end":379,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_76":{"id":"b6654670b1e4_76","__typename":"Paragraph","name":"cff6","text":"I will leave the other two EAs as an exercise for the reader, but I’d recommend investigating the relationship between $KERNEL.PURGE.ESBCACHE and the Enterprise Service Bus. I also stumbled upon this page which describes the $KERNEL.PURGE prefix with the statement below:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":150,"end":172,"type":"A","href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Faa475433(v=bts.10).aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":200,"end":204,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Fifs\u002Fkernel-extended-attributes","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":119,"end":142,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":225,"end":239,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_77":{"id":"b6654670b1e4_77","__typename":"Paragraph","name":"a69b","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*DQfSQQ7YM49OZo06."},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_78":{"id":"b6654670b1e4_78","__typename":"Paragraph","name":"aa6f","text":"I’m interested to hear what EAs you come across and how you think they are being used!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_79":{"id":"b6654670b1e4_79","__typename":"Paragraph","name":"9c56","text":"Hopefully, this example demonstrated the process I like to follow to understand “normal” behavior on a system.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_80":{"id":"b6654670b1e4_80","__typename":"Paragraph","name":"7584","text":"Test Detection at Scale","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_81":{"id":"b6654670b1e4_81","__typename":"Paragraph","name":"539c","text":"It’s one thing to get a working detection on one machine in your test lab, but things can surprise you when you attempt to apply that detection at scale. Once we have identified a detection with fairly low false positive rates in the lab, we need to see how that detection works at scale.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_82":{"id":"b6654670b1e4_82","__typename":"Paragraph","name":"b702","text":"In my testing, Extended Attributes seem to remain consistent in large environments. In order to not skip this section, I want to describe how to approach this portion of the methodology from the perspective of the Golden Ticket technique. When I think of detections that work in labs, but needed a little more thought after testing at scale, I think of some of the problems I faced with detections I use for Golden Tickets.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":214,"end":227,"type":"A","href":"https:\u002F\u002Fadsecurity.org\u002F?p=1640","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_83":{"id":"b6654670b1e4_83","__typename":"Paragraph","name":"4793","text":"The original assumption was Kerberos tickets (both Ticket Granting Tickets and Service Tickets), in modern environments, should not use RC4 encryption. In our lab environment, this was true and a 100% detection. While an adversary could upgrade to AES encryption, any ticket with RC4 was in fact malicious. We decided to test this at scale and collect tickets across a fairly large environment, and were surprised when we saw TONS of RC4 and therefore, appeared to be TONS of Golden Tickets in the environment (fortunately this was not the case!). After some research and consulting with Sean Metcalf (@PyroTek3) over at Trimarc Security, it turns out that cross-domain and cross-forest tickets use RC4 by default. I assume this is to maintain backward compatibility in cases where the domain being requested is not functional level 2008. Testing this detection at scale can prevent a large amount of effort on trying to address false positives in the future.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":602,"end":611,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002FPyroTek3","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":621,"end":637,"type":"A","href":"https:\u002F\u002Ftrimarcsecurity.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_84":{"id":"b6654670b1e4_84","__typename":"Paragraph","name":"6f41","text":"This step of the process should also be catered to your environment. For example, many organizations have very few WMI Permanent Event Subscriptions, but maybe someone in your organization has found a useful way to leverage this technology. In most companies, you are unlikely to learn about that just by asking around. Many organizations are too complex for any individual to know everything. The only true way to know how each technology\u002Ftechnique is used in your environment is to look yourself. Every network has its own unique quirks that are sure to surprise you.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_85":{"id":"b6654670b1e4_85","__typename":"Paragraph","name":"bad6","text":"Conclusion","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_86":{"id":"b6654670b1e4_86","__typename":"Paragraph","name":"4601","text":"So why go through this lengthy process to build detections? A mature threat hunting program continuously maps documented attack techniques (those found in the MITRE ATT&CK Framework) to durable, behavior based detections. Target techniques should be identified based on your resources and you should cover as much of the attack chain as possible. An attacker must evade all detections throughout the chain to be successful. There is an implicit need to fully understand a technology in order to identify detections that are neither too tactical in nature (something an adversary can easily change) nor too broad (with a high false positive rate). Hopefully this methodology can help your organization work toward a more mature threat hunting program.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_87":{"id":"b6654670b1e4_87","__typename":"Paragraph","name":"0717","text":"Code Snippet","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:b6654670b1e4_88":{"id":"b6654670b1e4_88","__typename":"Paragraph","name":"2013","text":"The following code is for demonstration purposes only. It is quite inefficient in how it recursively traverses the file system. Additionally, the code has a dependency on Matt Graeber’s PSReflect project.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":186,"end":195,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fmattifestation\u002Fpsreflect","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:b6654670b1e4_89":{"id":"b6654670b1e4_89","__typename":"Paragraph","name":"e177","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:45aacbbdc057affa6acd51c15b5187d3"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"ImageMetadata:1*vd9kotlrDoDOzZeZ5hpNsQ.png":{"id":"1*vd9kotlrDoDOzZeZ5hpNsQ.png","__typename":"ImageMetadata","originalHeight":340,"originalWidth":646,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*7fpGVXnGJQxwapSC.":{"id":"0*7fpGVXnGJQxwapSC.","__typename":"ImageMetadata","originalHeight":1219,"originalWidth":1600,"focusPercentX":51,"focusPercentY":9,"alt":null},"ImageMetadata:0*bCNHLLzKy8Dq5OLT.":{"id":"0*bCNHLLzKy8Dq5OLT.","__typename":"ImageMetadata","originalHeight":672,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*49j6pX6xsRtHP79P.":{"id":"0*49j6pX6xsRtHP79P.","__typename":"ImageMetadata","originalHeight":732,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*dyq3jGGw9AQln0mO.":{"id":"0*dyq3jGGw9AQln0mO.","__typename":"ImageMetadata","originalHeight":504,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*MxEPq2geR6F7bxWO.":{"id":"0*MxEPq2geR6F7bxWO.","__typename":"ImageMetadata","originalHeight":184,"originalWidth":1278,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*Gtx0Gz7-pa6s2xaG.":{"id":"0*Gtx0Gz7-pa6s2xaG.","__typename":"ImageMetadata","originalHeight":388,"originalWidth":1442,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*tc7WOgfjnRi9dnMt.":{"id":"0*tc7WOgfjnRi9dnMt.","__typename":"ImageMetadata","originalHeight":260,"originalWidth":1438,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*h7o2AwsIBn3ax5qw.":{"id":"0*h7o2AwsIBn3ax5qw.","__typename":"ImageMetadata","originalHeight":636,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*ioo7Jq1cNCS7WBhQ.":{"id":"0*ioo7Jq1cNCS7WBhQ.","__typename":"ImageMetadata","originalHeight":450,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*DQfSQQ7YM49OZo06.":{"id":"0*DQfSQQ7YM49OZo06.","__typename":"ImageMetadata","originalHeight":764,"originalWidth":1534,"focusPercentX":null,"focusPercentY":null,"alt":null},"MediaResource:45aacbbdc057affa6acd51c15b5187d3":{"id":"45aacbbdc057affa6acd51c15b5187d3","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"Get-ExtendedAttribute is a function to iterate through the C:\\ volume looking for files with Extended Attributes. This code is beta and meant only for the purpose of a blog post on detection methodology."},"Tag:threat-hunting":{"id":"threat-hunting","__typename":"Tag","displayTitle":"Threat Hunting","normalizedTagSlug":""},"Tag:dfir":{"id":"dfir","__typename":"Tag","displayTitle":"Dfir","normalizedTagSlug":""},"Tag:specterops":{"id":"specterops","__typename":"Tag","displayTitle":"Specterops","normalizedTagSlug":""},"Tag:powershell":{"id":"powershell","__typename":"Tag","displayTitle":"Powershell","normalizedTagSlug":""},"ImageMetadata:1*dy7MvBD79mkCTajDbSssBw.jpeg":{"id":"1*dy7MvBD79mkCTajDbSssBw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:10eca8f7a844-viewerId:lo_981085450091":{"id":"userId:10eca8f7a844-viewerId:lo_981085450091","__typename":"UserViewerEdge","isFollowing":false},"User:10eca8f7a844":{"id":"10eca8f7a844","__typename":"User","name":"Christopher Maddalena","username":"cmaddy","bio":"A maker and a hacker","imageId":"1*HUuIXzzmiLidwQHi6Hd3nw.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"cmaddy.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:10eca8f7a844-viewerId:lo_981085450091"}},"Post:bee58de48e05":{"id":"bee58de48e05","__typename":"Post","title":"Gathering Open Source Intelligence","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fgathering-open-source-intelligence-bee58de48e05","previewImage":{"__ref":"ImageMetadata:1*dy7MvBD79mkCTajDbSssBw.jpeg"},"isPublished":true,"firstPublishedAt":1538499996353,"readingTime":18.150000000000002,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:10eca8f7a844"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*GHniN9KHMioCdUW5":{"id":"0*GHniN9KHMioCdUW5","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:9689ed358206-viewerId:lo_981085450091":{"id":"userId:9689ed358206-viewerId:lo_981085450091","__typename":"UserViewerEdge","isFollowing":false},"User:9689ed358206":{"id":"9689ed358206","__typename":"User","name":"Ryan Hausknecht","username":"hausec","bio":"Security Consultant @ SpecterOps","imageId":"2*LFdW-NbzZFmNHuopdXF2Wg.png","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:9689ed358206-viewerId:lo_981085450091"}},"Post:ca70b330511a":{"id":"ca70b330511a","__typename":"Post","title":"Attacking Azure, Azure AD, and Introducing PowerZure","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fattacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a","previewImage":{"__ref":"ImageMetadata:0*GHniN9KHMioCdUW5"},"isPublished":true,"firstPublishedAt":1580226779379,"readingTime":13.778301886792454,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:9689ed358206"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*GF6FdIDKpvQxjuNuPsX7kQ.png":{"id":"1*GF6FdIDKpvQxjuNuPsX7kQ.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:3569e97b827d-viewerId:lo_981085450091":{"id":"userId:3569e97b827d-viewerId:lo_981085450091","__typename":"UserViewerEdge","isFollowing":false},"User:3569e97b827d":{"id":"3569e97b827d","__typename":"User","name":"Dwight Hohnstein","username":"djhohnstein","bio":"Operator at SpecterOps","imageId":"1*iMfl1D9YqDx5shwmuj9_YA.png","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:3569e97b827d-viewerId:lo_981085450091"}},"Post:65476e6165b9":{"id":"65476e6165b9","__typename":"Post","title":"Man in the Terminal","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fman-in-the-terminal-65476e6165b9","previewImage":{"__ref":"ImageMetadata:1*GF6FdIDKpvQxjuNuPsX7kQ.png"},"isPublished":true,"firstPublishedAt":1617627579035,"readingTime":5.583018867924529,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:3569e97b827d"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*ezJx8ZEu1Va14iscq_h5Gg.png":{"id":"1*ezJx8ZEu1Va14iscq_h5Gg.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:996cb7f12ac1-viewerId:lo_981085450091":{"id":"userId:996cb7f12ac1-viewerId:lo_981085450091","__typename":"UserViewerEdge","isFollowing":false},"User:996cb7f12ac1":{"id":"996cb7f12ac1","__typename":"User","name":"Roberto Rodriguez","username":"cyb3rward0g","bio":"","imageId":"1*9WbXEpOxOhaMq99CwG1ESQ.png","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"cyb3rward0g.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:996cb7f12ac1-viewerId:lo_981085450091"}},"Post:9a99a781fde7":{"id":"9a99a781fde7","__typename":"Post","title":"Threat Hunting with Jupyter Notebooks— Part 1: Your First Notebook 📓","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fthreat-hunting-with-jupyter-notebooks-part-1-your-first-notebook-9a99a781fde7","previewImage":{"__ref":"ImageMetadata:1*ezJx8ZEu1Va14iscq_h5Gg.png"},"isPublished":true,"firstPublishedAt":1559236310322,"readingTime":11.361320754716981,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:996cb7f12ac1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*_yKdMthPwVpKYyHZnvrKJQ.png":{"id":"1*_yKdMthPwVpKYyHZnvrKJQ.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:1bb43103a9a9-viewerId:lo_981085450091":{"id":"userId:1bb43103a9a9-viewerId:lo_981085450091","__typename":"UserViewerEdge","isFollowing":false},"User:1bb43103a9a9":{"id":"1bb43103a9a9","__typename":"User","name":"Matt Nelson","username":"enigma0x3","bio":"Red Teamer | Security Researcher | Enjoys abusing features | Tweets are my own | http:\u002F\u002Fgithub.com\u002Fenigma0x3","imageId":"0*6mGXmQSDMYyKuVUK.jpg","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:1bb43103a9a9-viewerId:lo_981085450091"}},"Post:ff74c39615ba":{"id":"ff74c39615ba","__typename":"Post","title":"CVE-2018–8414: A Case Study in Responsible Disclosure","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fcve-2018-8414-a-case-study-in-responsible-disclosure-ff74c39615ba","previewImage":{"__ref":"ImageMetadata:1*_yKdMthPwVpKYyHZnvrKJQ.png"},"isPublished":true,"firstPublishedAt":1540307028000,"readingTime":11.366981132075471,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:1bb43103a9a9"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*ji6keNd2kNMsDi-Z.png":{"id":"0*ji6keNd2kNMsDi-Z.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:fdf5555c9eb1":{"id":"fdf5555c9eb1","__typename":"Post","title":"Enter Mordor 😈: Pre-recorded Security Events from Simulated Adversarial Techniques 🛡","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fenter-mordor-pre-recorded-security-events-from-simulated-adversarial-techniques-fdf5555c9eb1","previewImage":{"__ref":"ImageMetadata:0*ji6keNd2kNMsDi-Z.png"},"isPublished":true,"firstPublishedAt":1564940155801,"readingTime":12.004716981132075,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:996cb7f12ac1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*YDlbuijY1qh1K0WhSIRFKw.png":{"id":"1*YDlbuijY1qh1K0WhSIRFKw.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:c3ec27263df8":{"id":"c3ec27263df8","__typename":"Post","title":"Putting Sysmon v9.0 AND\u002FOR Grouping Logic to the Test","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fputting-sysmon-v9-0-and-or-grouping-logic-to-the-test-c3ec27263df8","previewImage":{"__ref":"ImageMetadata:1*YDlbuijY1qh1K0WhSIRFKw.png"},"isPublished":true,"firstPublishedAt":1550684529130,"readingTime":11.523584905660378,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:996cb7f12ac1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*8zXAta_r_VbLYM_k":{"id":"0*8zXAta_r_VbLYM_k","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:1121f07f3a5a":{"id":"1121f07f3a5a","__typename":"Post","title":"Malware Development Pt. 1: Dynamic Module Loading in Go","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fmalware-development-pt-1-dynamic-module-loading-in-go-1121f07f3a5a","previewImage":{"__ref":"ImageMetadata:0*8zXAta_r_VbLYM_k"},"isPublished":true,"firstPublishedAt":1598878741728,"readingTime":12.580503144654088,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:3569e97b827d"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"Post:a9dbbb53d5ea":{"id":"a9dbbb53d5ea","__typename":"Post","creator":{"__ref":"User:b206c297df42"},"canonicalUrl":"","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:b6654670b1e4_0"},{"__ref":"Paragraph:b6654670b1e4_1"},{"__ref":"Paragraph:b6654670b1e4_2"},{"__ref":"Paragraph:b6654670b1e4_3"},{"__ref":"Paragraph:b6654670b1e4_4"},{"__ref":"Paragraph:b6654670b1e4_5"},{"__ref":"Paragraph:b6654670b1e4_6"},{"__ref":"Paragraph:b6654670b1e4_7"},{"__ref":"Paragraph:b6654670b1e4_8"},{"__ref":"Paragraph:b6654670b1e4_9"},{"__ref":"Paragraph:b6654670b1e4_10"},{"__ref":"Paragraph:b6654670b1e4_11"},{"__ref":"Paragraph:b6654670b1e4_12"},{"__ref":"Paragraph:b6654670b1e4_13"},{"__ref":"Paragraph:b6654670b1e4_14"},{"__ref":"Paragraph:b6654670b1e4_15"},{"__ref":"Paragraph:b6654670b1e4_16"},{"__ref":"Paragraph:b6654670b1e4_17"},{"__ref":"Paragraph:b6654670b1e4_18"},{"__ref":"Paragraph:b6654670b1e4_19"},{"__ref":"Paragraph:b6654670b1e4_20"},{"__ref":"Paragraph:b6654670b1e4_21"},{"__ref":"Paragraph:b6654670b1e4_22"},{"__ref":"Paragraph:b6654670b1e4_23"},{"__ref":"Paragraph:b6654670b1e4_24"},{"__ref":"Paragraph:b6654670b1e4_25"},{"__ref":"Paragraph:b6654670b1e4_26"},{"__ref":"Paragraph:b6654670b1e4_27"},{"__ref":"Paragraph:b6654670b1e4_28"},{"__ref":"Paragraph:b6654670b1e4_29"},{"__ref":"Paragraph:b6654670b1e4_30"},{"__ref":"Paragraph:b6654670b1e4_31"},{"__ref":"Paragraph:b6654670b1e4_32"},{"__ref":"Paragraph:b6654670b1e4_33"},{"__ref":"Paragraph:b6654670b1e4_34"},{"__ref":"Paragraph:b6654670b1e4_35"},{"__ref":"Paragraph:b6654670b1e4_36"},{"__ref":"Paragraph:b6654670b1e4_37"},{"__ref":"Paragraph:b6654670b1e4_38"},{"__ref":"Paragraph:b6654670b1e4_39"},{"__ref":"Paragraph:b6654670b1e4_40"},{"__ref":"Paragraph:b6654670b1e4_41"},{"__ref":"Paragraph:b6654670b1e4_42"},{"__ref":"Paragraph:b6654670b1e4_43"},{"__ref":"Paragraph:b6654670b1e4_44"},{"__ref":"Paragraph:b6654670b1e4_45"},{"__ref":"Paragraph:b6654670b1e4_46"},{"__ref":"Paragraph:b6654670b1e4_47"},{"__ref":"Paragraph:b6654670b1e4_48"},{"__ref":"Paragraph:b6654670b1e4_49"},{"__ref":"Paragraph:b6654670b1e4_50"},{"__ref":"Paragraph:b6654670b1e4_51"},{"__ref":"Paragraph:b6654670b1e4_52"},{"__ref":"Paragraph:b6654670b1e4_53"},{"__ref":"Paragraph:b6654670b1e4_54"},{"__ref":"Paragraph:b6654670b1e4_55"},{"__ref":"Paragraph:b6654670b1e4_56"},{"__ref":"Paragraph:b6654670b1e4_57"},{"__ref":"Paragraph:b6654670b1e4_58"},{"__ref":"Paragraph:b6654670b1e4_59"},{"__ref":"Paragraph:b6654670b1e4_60"},{"__ref":"Paragraph:b6654670b1e4_61"},{"__ref":"Paragraph:b6654670b1e4_62"},{"__ref":"Paragraph:b6654670b1e4_63"},{"__ref":"Paragraph:b6654670b1e4_64"},{"__ref":"Paragraph:b6654670b1e4_65"},{"__ref":"Paragraph:b6654670b1e4_66"},{"__ref":"Paragraph:b6654670b1e4_67"},{"__ref":"Paragraph:b6654670b1e4_68"},{"__ref":"Paragraph:b6654670b1e4_69"},{"__ref":"Paragraph:b6654670b1e4_70"},{"__ref":"Paragraph:b6654670b1e4_71"},{"__ref":"Paragraph:b6654670b1e4_72"},{"__ref":"Paragraph:b6654670b1e4_73"},{"__ref":"Paragraph:b6654670b1e4_74"},{"__ref":"Paragraph:b6654670b1e4_75"},{"__ref":"Paragraph:b6654670b1e4_76"},{"__ref":"Paragraph:b6654670b1e4_77"},{"__ref":"Paragraph:b6654670b1e4_78"},{"__ref":"Paragraph:b6654670b1e4_79"},{"__ref":"Paragraph:b6654670b1e4_80"},{"__ref":"Paragraph:b6654670b1e4_81"},{"__ref":"Paragraph:b6654670b1e4_82"},{"__ref":"Paragraph:b6654670b1e4_83"},{"__ref":"Paragraph:b6654670b1e4_84"},{"__ref":"Paragraph:b6654670b1e4_85"},{"__ref":"Paragraph:b6654670b1e4_86"},{"__ref":"Paragraph:b6654670b1e4_87"},{"__ref":"Paragraph:b6654670b1e4_88"},{"__ref":"Paragraph:b6654670b1e4_89"}],"sections":[{"__typename":"Section","name":"83c9","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"2d5e","startIndex":87,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"customStyleSheet":null,"firstPublishedAt":1500384914535,"isLocked":false,"isPublished":true,"isShortform":false,"layerCake":0,"primaryTopic":null,"viewerEdge":{"__ref":"PostViewerEdge:postId:a9dbbb53d5ea-viewerId:lo_981085450091"},"title":"Host-based Threat Modeling & Indicator Design","isMarkedPaywallOnly":false,"mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fhost-based-threat-modeling-indicator-design-a9dbbb53d5ea","isLimitedState":false,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:dfir"},{"__ref":"Tag:specterops"},{"__ref":"Tag:powershell"}],"topics":[{"__typename":"Topic","topicId":"d4e7f4144ac5","name":"Cybersecurity"}],"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","noIndex":null,"curationStatus":null,"metaDescription":"Focused around malicious use of NTFS Extended Attributes, this post describes a methodology for understanding attack techniques and building behavioral detections for them.","latestPublishedAt":1500385153182,"readingTime":13.89245283018868,"previewContent":{"__typename":"PreviewContent","subtitle":"Detecting Zeroaccess Trojan’s abuse of NTFS Extended Attributes… Behaviorally"},"previewImage":{"__ref":"ImageMetadata:0*7fpGVXnGJQxwapSC."},"clapCount":75,"lockedSource":"LOCKED_POST_SOURCE_NONE","isSuspended":false,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":0,"responseDistribution":"NOT_DISTRIBUTED","internalLinks({\"paging\":{\"limit\":8}})":{"__typename":"InternalLinksConnection","items":[{"__ref":"Post:bee58de48e05"},{"__ref":"Post:ca70b330511a"},{"__ref":"Post:65476e6165b9"},{"__ref":"Post:9a99a781fde7"},{"__ref":"Post:ff74c39615ba"},{"__ref":"Post:fdf5555c9eb1"},{"__ref":"Post:c3ec27263df8"},{"__ref":"Post:1121f07f3a5a"}]},"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"audioVersionUrl":"","seoTitle":"","updatedAt":1525456799894,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":0},"latestPublishedVersion":"b6654670b1e4","isPublishToEmail":false,"voterCount":23,"recommenders":[]}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.32733017.js"></script><script src="https://cdn-client.medium.com/lite/static/js/6484.96815e61.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.23bdaf70.js"></script><script src="https://cdn-client.medium.com/lite/static/js/5573.159bf40f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/instrumentation.8ea15b6a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.65aadb14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1752.a348f767.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/953.19c0a4db.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3211.3e30b0d8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4586.0206cca1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9692.b4a02f3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5064.7974654b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9046.8e42140f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2846.012d369f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2176.958ba593.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2712.a43f33d4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9972.f6abd8ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5828.582128b9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2955.12744204.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7131.faa9f1cc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/664.68f7c552.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8751.a9b26c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2238.af816699.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5009.dbfd66e8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4803.15ea4361.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8127.7b79de8f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6371.bfa476ae.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8995.7ff30d72.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5435.7a0af391.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3874.3f41bcb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1794.574e0f73.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9454.d9a3a4a8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/Post.50144cfa.chunk.js"></script><script>window.main();</script></body></html>