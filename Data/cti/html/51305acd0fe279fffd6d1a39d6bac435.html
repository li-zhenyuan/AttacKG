<!doctype html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="profile" href="https://gmpg.org/xfn/11">
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

<title>Ryuk in 5 Hours - The DFIR Report</title>
<link rel="canonical" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Ryuk in 5 Hours - The DFIR Report" />
<meta property="og:description" content="Intro The Ryuk threat actors went from a phishing email to domain wide ransomware in 5 hours. They escalated privileges using Zerologon (CVE-2020-1472), less than 2 hours after the initial &hellip; Read More" />
<meta property="og:url" content="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="article:published_time" content="2020-10-18T23:21:04+00:00" />
<meta property="article:modified_time" content="2021-01-24T23:24:09+00:00" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png" />
<meta property="og:image:width" content="1093" />
<meta property="og:image:height" content="587" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="editor">
<meta name="twitter:label2" content="Est. reading time">
<meta name="twitter:data2" content="13 minutes">
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://thedfirreport.com/#website","url":"https://thedfirreport.com/","name":"The DFIR Report","description":"Real Intrusions by Real Attackers, The Truth Behind the Intrusion","potentialAction":[{"@type":"SearchAction","target":"https://thedfirreport.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/#primaryimage","inLanguage":"en-US","url":"https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png","contentUrl":"https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png","width":1093,"height":587},{"@type":"WebPage","@id":"https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/#webpage","url":"https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/","name":"Ryuk in 5 Hours - The DFIR Report","isPartOf":{"@id":"https://thedfirreport.com/#website"},"primaryImageOfPage":{"@id":"https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/#primaryimage"},"datePublished":"2020-10-18T23:21:04+00:00","dateModified":"2021-01-24T23:24:09+00:00","author":{"@id":"https://thedfirreport.com/#/schema/person/b74bd4df805a2739b85903202f6b5838"},"breadcrumb":{"@id":"https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/"]}]},{"@type":"BreadcrumbList","@id":"https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://thedfirreport.com/","url":"https://thedfirreport.com/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/#webpage"}}]},{"@type":"Person","@id":"https://thedfirreport.com/#/schema/person/b74bd4df805a2739b85903202f6b5838","name":"editor","image":{"@type":"ImageObject","@id":"https://thedfirreport.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/9627d3871f13290c26ecf861f7715257?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/9627d3871f13290c26ecf861f7715257?s=96&d=mm&r=g","caption":"editor"},"sameAs":["https://thedfirreport.com"],"url":"https://thedfirreport.com/author/editor/"}]}</script>

<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/5.7.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='contact-form-7-css' href='https://thedfirreport.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=5.7.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/font-awesome.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='//fonts.googleapis.com/css?family=Heebo:300,400,700|Arimo&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/9.7/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css' href='https://c0.wp.com/p/jetpack/9.7/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' id='jetpack_related-posts-js-extra'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/related-posts/related-posts.min.js' id='jetpack_related-posts-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/jquery/jquery.min.js' id='jquery-core-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/jquery/jquery-migrate.min.js' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1' id='freenews-global-js'></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/1041" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://thedfirreport.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 5.7.2" />
<link rel='shortlink' href='https://thedfirreport.com/?p=1041' />
<link rel="alternate" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2020%2F10%2F18%2Fryuk-in-5-hours%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2020%2F10%2F18%2Fryuk-in-5-hours%2F&#038;format=xml" />

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1"></script>
<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>
<script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=280956B8BCED9A0B218BA9A736DFFCF9');
</script><style type='text/css'>img#wpstats{display:none}</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
<script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>
<body class="post-template-default single single-post postid-1041 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
<div id="page" class="site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header id="masthead" class="site-header">
<div id="main-header" class="main-header">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<div id="primary-menu" class="menu"><ul>
<li class="page_item page-item-24"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
<li class="page_item page-item-2160"><a href="https://thedfirreport.com/services/">Services</a></li>
</ul></div>
</nav>
</div>
</div>
</div>
<div class="main-header-brand">
<div class="header-brand">
<div class="wrap">
<div class="header-brand-content">
<div class="site-branding">
<div class="site-branding-text">
<p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
<p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
</div>
</div>
<div class="header-right">
<div class="header-banner">
</div>
</div>
</div>
</div>
</div>
<div id="nav-sticker">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<div id="primary-menu" class="menu"><ul>
<li class="page_item page-item-24"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
<li class="page_item page-item-2160"><a href="https://thedfirreport.com/services/">Services</a></li>
</ul></div>
</nav>
</div>
</div>
</div>
<div class="clock">
<div id="time"></div>
<div id="date">Sunday, May 23, 2021</div>
</div>
</div>
</div>
</div>
</header>
<div id="content" class="site-content">
<div class="site-content-cell">
<div class="wrap">
<div id="primary" class="content-area">
<main id="main" class="site-main">
<article id="post-1041" class="post-1041 post type-post status-publish format-standard hentry category-adfind category-bazar category-cobaltstrike category-ransomware category-rdp category-ryuk category-yara tag-adfind tag-bazar tag-cobalt-strike tag-kegtap tag-malspam tag-ryuk entry">
<div class="entry-content-holder">
<header class="entry-header">
<div class="entry-meta">
<span class="cat-links">
<a class="category-color-24" href="https://thedfirreport.com/category/adfind/">adfind</a>
<a class="category-color-27" href="https://thedfirreport.com/category/bazar/">bazar</a>
<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
<a class="category-color-3" href="https://thedfirreport.com/category/rdp/">rdp</a>
<a class="category-color-25" href="https://thedfirreport.com/category/ryuk/">ryuk</a>
<a class="category-color-19" href="https://thedfirreport.com/category/yara/">yara</a>
</span>
</div>
<h1 class="entry-title">Ryuk in 5 Hours</h1>
<div class="entry-meta">
<span class="posted-on"><a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" rel="bookmark"><time class="entry-date published" datetime="2020-10-18T23:21:04+00:00">October 18, 2020</time></a></span> </div>
</header>
<div class="entry-content">
<h3>Intro</h3>
<p>The Ryuk threat actors went from a phishing email to domain wide ransomware in 5 hours. They escalated privileges using Zerologon (CVE-2020-1472), less than 2 hours after the initial phish. They used tools such as Cobalt Strike, AdFind, WMI, and PowerShell to accomplish their objective.</p>
<p>Ryuk has been one of the most proficient ransomware gangs in the past few years, with the FBI claiming <a href="https://www.zdnet.com/article/fbi-ransomware-victims-have-paid-out-140-million-one-version-has-cost-them-the-most/" target="_blank" rel="noopener noreferrer">$61 million USD</a> having been paid to the group as of February 2020. Earlier in the year, the group grew a little quiet, but that seems to have changed in the past few weeks, with incidents like what occurred at <a href="https://www.bleepingcomputer.com/news/security/uhs-hospitals-hit-by-reported-country-wide-ryuk-ransomware-attack/" target="_blank" rel="noopener noreferrer">UHS hospitals</a>.</p>
<h3>Case Summary</h3>
<p>In our previous <a href="https://thedfirreport.com/2020/10/08/ryuks-return/" target="_blank" rel="noopener noreferrer">Ryuk case,</a> we saw the threat actors leverage access to an environment via the Bazar Loader malware. This time around, we saw them accomplish their objective faster, but the general tactics and techniques stayed similar between incidents.</p>
<p>Bazar was introduced to the environment again with the delivery via phishing emails. For an in depth breakdown on this loader, see <a href="https://www.advanced-intel.com/post/front-door-into-bazarbackdoor-stealthy-cybercrime-weapon" target="_blank" rel="noopener noreferrer">this analysis</a> by  Roman Marshanski &amp; <a href="https://twitter.com/VK_Intel" target="_blank" rel="noopener noreferrer">Vitali Kremez</a>. Bazar, once running, was seen again injecting into explorer.exe, svchost.exe, and spawning command shell processes.</p>
<p>From this loader we saw initial mapping of the domain, using built-in windows utilities such as Nltest. However, unlike the last case, the threat actors started at a lower privileged user and rather than proceed slowly or cautiously, they exploited the recently disclosed Zerologon vulnerability (CVE-2020-1472) to reset the machine password of the primary domain controller.</p>
<p>Lateral movement was initiated via SMB file transfers and WMI executions of Cobalt Strike Beacons. The network indicators align similarly to the prior campaign and were noted by <a href="https://twitter.com/kyleehmke/status/1315499593359122432" target="_blank" rel="noopener noreferrer">Kyle Ehmke</a> in response to our last post pivoting off the prior report&#8217;s intel. From memory analysis, we were also able to conclude the actors were using a trial version of Cobalt Strike with the EICAR string present in the network configuration for the beacon. Both portable executable and DLL beacons were used.</p>
<p>After moving laterally to the secondary domain controller, the threat actor started on more domain discovery via Net and the PowerShell Active Directory module. From there, the threat actors appeared to use the default named pipe privilege escalation module on the server. At this point, the threat actors used RDP to connect from the secondary domain controller, to the first domain controller, using the built in Administrator account.</p>
<p>Once on the main domain controller, another Cobalt Strike beacon was dropped and executed. Then more domain reconnaissance was performed using <a href="https://thedfirreport.com/2020/05/08/adfind-recon/" target="_blank" rel="noopener noreferrer">AdFind</a>. Once this completed, at the four hour mark, the threat actors were ready for their final objective.</p>
<p>Four hours and 10 minutes in, the threat actors used the pivot from the primary domain controller to RDP into the Backup server. Backup servers were again targeted first for deployment of the ransomware executable, followed by servers and then workstations.The threat actors finished their objective by executing the ransomware on the primary domain controller, and at the 5 hour mark, the attack completed.</p>
<p>While last time we commented on the lead time between the first and second day to aid detection and response activity, this case goes to show that you can&#8217;t count on that kind of timescale. You need to be ready to act in less than an hour, to make sure you can effectively disrupt the threat actor.</p>
<h3>Timeline</h3>
<p><a href="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3.png"><img loading="lazy" class="alignnone wp-image-1110 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3.png" alt width="938" height="2079" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3.png 938w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-135x300.png 135w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-462x1024.png 462w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-768x1702.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-693x1536.png 693w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-924x2048.png 924w" data-lazy-sizes="(max-width: 938px) 100vw, 938px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1110 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3.png" alt="" width="938" height="2079" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3.png 938w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-135x300.png 135w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-462x1024.png 462w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-768x1702.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-693x1536.png 693w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-in-5-hours-3-924x2048.png 924w" sizes="(max-width: 938px) 100vw, 938px" /></noscript></a></p>
<p>&nbsp;</p>
<h3>MITRE ATT&amp;CK</h3>
<h3><a>Initial Access</a></h3>
<p>Access was initiated by a phishing email leading to the Bazar Loader malware executable.</p>
<h3><a>Execution</a></h3>
<p>Bazar relies on user execution of an executable to run. This user was a Domain User and did not have any other permissions.</p>
<h3>Privilege Escalation</h3>
<p>CVE-2020-1472 was used to reset the credentials on one of the domain controllers in the environment. After resetting the password, the threat actors then targeted a different domain controller, potentially due to breaking services by use of their exploit.</p>
<p><img loading="lazy" class="alignnone wp-image-1055 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/netlogon.png" alt width="1890" height="723" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/netlogon.png 1890w, https://thedfirreport.com/wp-content/uploads/2020/10/netlogon-300x115.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/netlogon-1024x392.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/netlogon-768x294.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/netlogon-1536x588.png 1536w" data-lazy-sizes="(max-width: 1890px) 100vw, 1890px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/netlogon.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1055 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/netlogon.png" alt="" width="1890" height="723" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/netlogon.png 1890w, https://thedfirreport.com/wp-content/uploads/2020/10/netlogon-300x115.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/netlogon-1024x392.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/netlogon-768x294.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/netlogon-1536x588.png 1536w" sizes="(max-width: 1890px) 100vw, 1890px" /></noscript></p>
<p>Packet showing the zeroed out password.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1087 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/passwordset.png" alt width="618" height="165" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/passwordset.png 618w, https://thedfirreport.com/wp-content/uploads/2020/10/passwordset-300x80.png 300w" data-lazy-sizes="(max-width: 618px) 100vw, 618px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/passwordset.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1087" src="https://thedfirreport.com/wp-content/uploads/2020/10/passwordset.png" alt="" width="618" height="165" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/passwordset.png 618w, https://thedfirreport.com/wp-content/uploads/2020/10/passwordset-300x80.png 300w" sizes="(max-width: 618px) 100vw, 618px" /></noscript></p>
<p>On one of the domain controllers we saw use of the Cobalt Strike named pipe escalation.</p>
<pre>C:\Windows\system32\cmd.exe /c echo 92d8cc45954 &gt;; \\.\pipe\446b3c</pre>
<h3><a>Defense Evasion</a></h3>
<p>On the first domain controller that the treat actors connected to after their initial connection, they dropped a DLL and executed it via rundll32.</p>
<pre>C:\Windows\system32\cmd.exe /C rundll32 C:\Windows\system32\SQL.dll, StartW</pre>
<p>Dropped via RDP and executed via rundll32 on the second domain controller.</p>
<pre>rundll32 C:\PerfLogs\arti64.dll, rundll</pre>
<p>Shortly after, the DLL was called again via regsrv32.</p>
<pre>regsvr32 C:\PerfLogs\arti64.dll</pre>
<p>Then a 2nd DLL was dropped and executed in a similar manner on the 2nd DC.</p>
<pre>rundll32 C:\\PerfLogs\\socks64.dll, rundll</pre>
<h3><a>Discovery</a></h3>
<p>Ran on the beachhead.</p>
<pre>nltest /domain_trusts /all_trusts
nltest /dclist:DOMAIN
net group "Domain admins" /DOMAIN</pre>
<p>Ran on a domain controller.</p>
<pre>net group "enterprise admins" /domain
nltest /domain_trusts /all_trusts
nltest /dclist:"DOMAIN"
ping DOMAINCONTROLLER
cmd.exe /C time
net user administrator /domain</pre>
<p>Then they imported the PowerShell Active Directory module.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1061 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/actdirmodule.png" alt width="463" height="57" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/actdirmodule.png 463w, https://thedfirreport.com/wp-content/uploads/2020/10/actdirmodule-300x37.png 300w" data-lazy-sizes="(max-width: 463px) 100vw, 463px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/actdirmodule.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1061" src="https://thedfirreport.com/wp-content/uploads/2020/10/actdirmodule.png" alt="" width="463" height="57" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/actdirmodule.png 463w, https://thedfirreport.com/wp-content/uploads/2020/10/actdirmodule-300x37.png 300w" sizes="(max-width: 463px) 100vw, 463px" /></noscript></p>
<p>They then ran the following looking for host names, operating systems and last logon dates of all AD systems.</p>
<pre>C:\Windows\system32\cmd.exe /C Get-ADComputer -Filter {enabled -eq $true} -properties *|select Name, DNSHostName, OperatingSystem, LastLogonDate | Export-CSV C:\Users\AllWindows.csv -NoTypeInformation -Encoding UTF8</pre>
<p>After already completing the above discovery work and having already pivoted to their 2nd domain controller, the threat actors moved on to AdFind for further domain reconnaissance.</p>
<pre class="truncate-by-height">C:\Windows\Temp\adf\AdFind.exe
C:\Windows\Temp\adf\adf.bat</pre>
<div>Contents of the script ran the following with AdFind.</div>
<pre>adfind.exe -f "(objectcategory=person)"
adfind.exe -f "objectcategory=computer"
adfind.exe -f "(objectcategory=organizationalUnit)"
adfind.exe -sc trustdmp
adfind.exe -subnets -f (objectCategory=subnet)
adfind.exe -f "(objectcategory=group)"
adfind.exe -gcb -sc trustdmp</pre>
<div>The threat actor then ran this command a few times.</div>
<div>
<pre class="truncate-by-height">nltest /domain_trusts /all_trusts</pre>
</div>
<div></div>
<h3 class="tactic-cell" aria-describedby="cdk-describedby-message-28">Lateral Movement</h3>
<p>The first lateral movement occurred to the domain controller not affected by the use of CVE-2020-1472. An executable was transferred to it via SMB using a domain administrator account.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1103 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/servisess.png" alt width="808" height="74" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/servisess.png 808w, https://thedfirreport.com/wp-content/uploads/2020/10/servisess-300x27.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/servisess-768x70.png 768w" data-lazy-sizes="(max-width: 808px) 100vw, 808px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/servisess.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1103" src="https://thedfirreport.com/wp-content/uploads/2020/10/servisess.png" alt="" width="808" height="74" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/servisess.png 808w, https://thedfirreport.com/wp-content/uploads/2020/10/servisess-300x27.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/servisess-768x70.png 768w" sizes="(max-width: 808px) 100vw, 808px" /></noscript></p>
<p><img loading="lazy" class="alignnone size-full wp-image-1120 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-2.png" alt width="348" height="130" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-2.png 348w, https://thedfirreport.com/wp-content/uploads/2020/10/servisess-2-300x112.png 300w" data-lazy-sizes="(max-width: 348px) 100vw, 348px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1120" src="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-2.png" alt="" width="348" height="130" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-2.png 348w, https://thedfirreport.com/wp-content/uploads/2020/10/servisess-2-300x112.png 300w" sizes="(max-width: 348px) 100vw, 348px" /></noscript></p>
<p>After transferring the exe, the threat actors utilized WMI from the beachhead host to execute the file.</p>
<pre>C:\Windows\system32\cmd.exe /C WMIC/node:"DC.DOMAIN.local" process call create "cmd /c C:\PerfLogs\servisess.exe\"</pre>
<p>The presence of the EICAR strings point to the Cobalt Strike software being used as a <a href="https://blog.cobaltstrike.com/2015/10/14/the-cobalt-strike-trials-evil-bit/" target="_blank" rel="noopener noreferrer">trial version</a>.</p>
<p><img loading="lazy" class="alignnone wp-image-1089 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract.png" alt width="1059" height="277" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract.png 1059w, https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract-300x78.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract-1024x268.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract-768x201.png 768w" data-lazy-sizes="(max-width: 1059px) 100vw, 1059px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1089 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract.png" alt="" width="1059" height="277" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract.png 1059w, https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract-300x78.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract-1024x268.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/servisses-extract-768x201.png 768w" sizes="(max-width: 1059px) 100vw, 1059px" /></noscript></p>
<p>They accessed the GPO&#8217;s for the domain but none were modified or added.</p>
<pre>mmc.exe" "C:\Windows\System32\gpedit.msc"</pre>
<p>Shortly there after we saw a Cobalt Strike DLL transferred via the RDP connection.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1121 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-3.png" alt width="547" height="145" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-3.png 547w, https://thedfirreport.com/wp-content/uploads/2020/10/servisess-3-300x80.png 300w" data-lazy-sizes="(max-width: 547px) 100vw, 547px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-3.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1121" src="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-3.png" alt="" width="547" height="145" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/servisess-3.png 547w, https://thedfirreport.com/wp-content/uploads/2020/10/servisess-3-300x80.png 300w" sizes="(max-width: 547px) 100vw, 547px" /></noscript></p>
<p>RDP was used to pivot from the main domain controller and distribute the final ransomware payload enterprise wide.</p>
<h3><a>Command and Control</a></h3>
<p>After our previous report, <a href="https://twitter.com/kyleehmke" target="_blank" rel="noopener noreferrer"><span class="css-901oao css-16my406 r-1qd0xha r-ad9z0x r-bcqeeo r-qvutc0">@kyleehmke</span></a> pivoted off of our prior Ryuk report and used the network data to link several of these <a href="https://twitter.com/kyleehmke/status/1315499593359122432" target="_blank" rel="noopener noreferrer">domains</a> which we saw in this case.</p>
<p><strong>Bazar:</strong></p>
<p>Report_Print.exe</p>
<p>3.137.182.114:443</p>
<p>cstr3.com</p>
<p><strong>Cobalt Strike:</strong></p>
<p>servisses.exe</p>
<div class="truncate-by-height">88.119.171.94:443</div>
<div>Certificate [<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">86:77:d8:5e:51:69:ac:e2:08:07:2e:b0:dc:6c:10:9e:25:80:70:a6</span></a> </span></span>]</div>
<div>Not Before <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2020/10/06 13:33:55 UTC</span></a> </span></span></div>
<div>Not After <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2021/10/06 13:33:55 UTC</span></a> </span></span></div>
<div>Issuer Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span></div>
<div>Subject Common <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">havemosts.com</span></a> </span></span></div>
<div>Subject Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span></div>
<div>Public Algorithm <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">rsaEncryption</span></a></span></span></div>
<div>JA3: 57f3642b4e37e28f5cbe3020c9331b4c</div>
<div>JA3s: e35df3e00ca4ef31d42b34bebaa2f86e</div>
<div></div>
<div>SQL.dll</div>
<div></div>
<div>5.2.64.174:443</div>
<div>Certificate [<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">36:d5:68:f9:be:2a:34:e1:76:3d:89:78:e5:62:4d:fc:ae:02:97:ad</span></a> </span></span>]</div>
<div>Not Before <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2020/10/02 16:45:57 UTC</span></a> </span></span></div>
<div>Not After <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2021/10/02 16:45:57 UTC</span></a> </span></span></div>
<div>Issuer Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span></div>
<div>Subject Common <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">quwasd.com</span></a> </span></span></div>
<div>Subject Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span></div>
<div>Public Algorithm <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">rsaEncryption</span></a></span></span></div>
<div>JA3: a0e9f5d64349fb13191bc781f81f42e1</div>
<div>JA3s: ae4edc6faf64d08308082ad26be60767</div>
<div></div>
<h3><a>Impact</a></h3>
<p>Starting around 4.5 hours after the initial Bazar malware was executed, the Ryuk threat actors acted on their final objectives and initiated RDP connections from the domain controller previously exploited, to the rest of the environment. This time they initiated the ransomware first on the secondary domain controller (their 1st pivot) and transferred the Ryuk executable over the RDP connection.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1069 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Execution.png" alt width="771" height="783" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Execution.png 771w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Execution-295x300.png 295w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Execution-768x780.png 768w" data-lazy-sizes="(max-width: 771px) 100vw, 771px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Execution.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1069" src="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Execution.png" alt="" width="771" height="783" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Execution.png 771w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Execution-295x300.png 295w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Execution-768x780.png 768w" sizes="(max-width: 771px) 100vw, 771px" /></noscript></p>
<p>Enjoy our report? Please consider donating $1 or more to the project using <a href="https://www.patreon.com/thedfirreport" target="_blank" rel="noreferrer noopener">Patreon</a>. Thank you for your support!</p>
<p>We also have pcaps, files, memory images, Kape and Redline packages available <a href="https://thedfirreport.com/services/" target="_blank" rel="noopener">here</a>.</p>
<h2>IOCs</h2>
<p>https://misppriv.circl.lu/events/view/80223 &amp; https://otx.alienvault.com/pulse/5f8cce76f5614d9b220181b6</p>
<h3>Network</h3>
<pre>3.137.182.114:443
cstr3.com
88.119.171.94:443
<span class="detail-field" data-v-6144aac9=""><span data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">havemosts.com</span></a></span></span></span>
5.2.64.174:443
<span class="detail-field" data-v-6144aac9=""><span data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">quwasd.com</span></a></span></span></span></pre>
<h3>File</h3>
<pre>servisses.exe
d971827d974effedaeaf7d62b619b1dd
c3a846eb04e2fe765e56fa15a0d5c1eb650ccba3
1d8b7faf5f290465cc742e07abca78fac419135b191071cc77912263cd1dde1d
socks64.dll
890206f0c506366d480e02fc9fed988a
ba1542d9b55fff21bda9495ed884404b0436cff2
feb8c2bcb71da02dbbeecb999869e053cf96af8cce6f9705cadca4338133d3b5
SQL.dll
3785d87f6995b4b95d9b55f8d2556237
9b44a8f0bb2d65fb19e7ca7bbd85b36c176f3d60
d67461ba45a4edf3b2a69b3e64303fda8130bd1fc7a1173f35c1fe67b40c9639
arti64.dll
3785d87f6995b4b95d9b55f8d2556237
9b44a8f0bb2d65fb19e7ca7bbd85b36c176f3d60
d67461ba45a4edf3b2a69b3e64303fda8130bd1fc7a1173f35c1fe67b40c9639
xxx.exe
5b8b66ddbbf1fd67211e9a4bf78c1700
cdb042dd8e9dc17f677c991b386f4cd242f2628d
ccde47a0d315dcd4740fccfe8e8110fbb1fd85bb305734fec409f52051790c98
</pre>
<h2>Detections</h2>
<h3>Network</h3>
<pre class="c-mrkdwn__pre" data-stringify-type="pre">GPL NETBIOS SMB-DS IPC$ share access
ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement
ET POLICY SMB2 NT Create AndX Request For an Executable File</pre>
<h3>Sigma</h3>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/malware/win_mal_ryuk.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/malware/win_mal_ryuk.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_powershell_suspicious_parameter_variation.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_powershell_suspicious_parameter_variation.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_wmi_execution.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_wmi_execution.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_trust_discovery.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_trust_discovery.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml</a></p>
<p>Detects AdFind usage from a past case:</p>
<pre>title: AdFind Recon
description: Threat Actor using AdFind for reconnaissance. 
author: The DFIR Report
date: 2019/8/2
references:
    - https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/
tags:
    - attack.remote_system_discovery
    - attack.T1018
logsource:
    category: process_creation
    product: windows
detection:
    selection_1:
        CommandLine|contains:
            - adfind -f objectcategory=computer
    selection_2:
        CommandLine|contains:
            - adfind -gcb -sc trustdmp
    condition: selection_1 or selection_2 
falsepositives:
    - Legitimate Administrator using tool for Active Directory querying
level: medium
status: experimental</pre>
<h3>Yara</h3>
<pre>/*
YARA Rule Set
Author: The DFIR Report
Date: 2020-10-13
Identifier: Case 1006 Ryuk
Reference: https://thedfirreport.com
*/

/* Rule Set ----------------------------------------------------------------- */

import "pe"

rule ryuk_1006_servisses_procdump {
meta:
description = "files - file servisses-procdump.exe"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-13"
hash1 = "387894a0b404c67e722799308b12ff2be31d2e8ce798aa53d971f0c13805d54d"
strings:
$s1 = "c:/crossdev/src/winpthreads-svn6233/src/mutex.c" fullword ascii
$s2 = "mutex_global_shmem" fullword ascii
$s3 = "mutex_global_static_shmem" fullword ascii
$s4 = "_pthread_key_dest_shmem" fullword ascii
$s5 = "_pthread_key_sch_shmem" fullword ascii
$s6 = "_pthread_key_max_shmem" fullword ascii
$s7 = "_pthread_key_lock_shmem" fullword ascii
$s8 = "cannot find name of executable" fullword ascii
$s9 = "tiles32.png" fullword ascii
$s10 = "GetModuleFileName: %s" fullword ascii
$s11 = "IP_DEST_HOST_UNREACHABLE (11003)" fullword ascii
$s12 = "This program requires Windows NT!" fullword ascii
$s13 = "SNMP INVALID_SESSION" fullword ascii
$s14 = "SNMP TRAP_ERRORS" fullword ascii
$s15 = "SNMP SELECT_FDERRORS" fullword ascii
$s16 = "Some different radices: %d %x %o %#x %#o " fullword ascii
$s17 = "c:/crossdev/src/winpthreads-svn6233/src/rwlock.c" fullword ascii
$s18 = "_pthread_tls_shmem" fullword ascii
$s19 = "IP_DEST_PORT_UNREACHABLE (11005)" fullword ascii
$s20 = "pthr_root_shmem" fullword ascii
condition:
uint16(0) == 0x5a4d and filesize &lt; 2000KB and
( pe.imphash() == "a90d500745a1ce2417c01fecefbc2851" or 8 of them )
}

rule ryuk_1006_files_socks64 {
meta:
description = "files - file socks64.dll"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-13"
hash1 = "feb8c2bcb71da02dbbeecb999869e053cf96af8cce6f9705cadca4338133d3b5"
strings:
$x1 = "C:\\Users\\Izidu\\Desktop\\2019\\WindowsSDK7-Samples-master\\WindowsSDK7-Samples-master\\winui\\pictures\\acquisitionplugin\\x64" ascii
$s2 = "C:\\Users\\Izidu\\Desktop\\2019\\WindowsSDK7-Samples-master\\WindowsSDK7-Samples-master\\winui\\pictures\\acquisitionplugin\\x64" ascii
$s3 = "PluginSample.dll" fullword ascii
$s4 = "AppPolicyGetProcessTerminationMethod" fullword ascii
$s5 = "luginSample.pdb" fullword ascii
$s6 = "rundll" fullword ascii
$s7 = "AcquireSamplePlugin::DisplayConfigureDialog" fullword wide
$s8 = "AppPolicyGetThreadInitializationType" fullword ascii
$s9 = "`template-parameter-" fullword ascii
$s10 = "operator&lt;=&gt;" fullword ascii
$s11 = "operator co_await" fullword ascii
$s12 = "AppPolicyGetWindowingModel" fullword ascii
$s13 = "Transfer Completed Successfully!" fullword wide
$s14 = "AppPolicyGetShowDeveloperDiagnostic" fullword ascii
$s15 = "noexcept" fullword ascii
$s16 = "Read-Only Photo Acquire Plugin" fullword wide
$s17 = "api-ms-win-appmodel-runtime-l1-1-2" fullword wide
$s18 = "Software\\Microsoft\\Windows\\CurrentVersion\\Photo Acquisition\\Plugins\\%ws" fullword wide
$s19 = "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a38d9ce2f6eaf6d0c6d1eacdd3d6d7f0d7d1cacdc4e3">[email&#160;protected]</a>@" fullword ascii
$s20 = "g0DVNrB\"Rtf#" fullword ascii
condition:
uint16(0) == 0x5a4d and filesize &lt; 2000KB and
( pe.imphash() == "0fd22f187f22ab4ec2eb55f91ccefa7a" and ( pe.exports("SGeruIUrgVdfMaxMccIKRh") and pe.exports("rundll") ) or ( 1 of ($x*) and 4 of them ) )
}

rule ryuk_1006_Report_Print {
meta:
description = "files - file Report_Print.exe"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-13"
hash1 = "23ac461f9b5128841cafabb4282432252ea7b57874595cf6fe8457fc1ac65007"
strings:
$s1 = "kErNel32.Dll" fullword wide
$s2 = "DOOKOL.exe" fullword ascii
$s3 = "c:/crossdev/src/winpthreads-svn6233/src/mutex.c" fullword ascii
$s4 = "hmutex" fullword ascii
$s5 = "._FindPESectionExec" fullword ascii
$s6 = "mutex_global_shmem" fullword ascii
$s7 = "processthreadsapi.h" fullword ascii
$s8 = "mutex_global_static_shmem" fullword ascii
$s9 = "TargetIp" fullword ascii
$s10 = "c:\\crossdev\\gccmaster\\build-tdm64\\gcc\\x86_64-w64-mingw32\\libgcc" fullword ascii
$s11 = "h:\\crossdev\\gccmaster\\build-tdm64\\runtime\\mingw-w64-crt" fullword ascii
$s12 = "J__mingw_winmain_lpCmdLine" fullword ascii
$s13 = "GNU C 4.8.1 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector" fullword ascii
$s14 = "GNU C 4.8.1 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector -fno-exceptions" fullword ascii
$s15 = "GNU C 4.8.1 -m64 -mtune=generic -march=x86-64 -g -O2 -std=gnu99" fullword ascii
$s16 = "GNU C 4.8.1 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector -fexceptions" fullword ascii
$s17 = "9lpszCommandLine" fullword ascii
$s18 = "=__mingw_GetSectionForAddress" fullword ascii
$s19 = "__mingw_winmain_lpCmdLine" fullword ascii
$s20 = "%Target" fullword ascii
condition:
uint16(0) == 0x5a4d and filesize &lt; 3000KB and
( pe.imphash() == "8f0088451a1156246379abc67514cacf" and pe.exports("CSBhvSWCvFRvfCfAoJdoFuAUmK") or 8 of them )
}

rule ryuk_1006_files_xxx {
meta:
description = "files - file xxx.exe"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-13"
hash1 = "ccde47a0d315dcd4740fccfe8e8110fbb1fd85bb305734fec409f52051790c98"
strings:
$s1 = "DOOKOL.exe" fullword ascii
$s2 = "c:/crossdev/src/winpthreads-svn6233/src/mutex.c" fullword ascii
$s3 = "hmutex" fullword ascii
$s4 = "mutex_global_shmem" fullword ascii
$s5 = "processthreadsapi.h" fullword ascii
$s6 = "mutex_global_static_shmem" fullword ascii
$s7 = "fake_get_output_format" fullword ascii
$s8 = "&amp;rvaTarget" fullword ascii
$s9 = "h:\\crossdev\\gccmaster\\build-tdm64\\runtime\\mingw-w64-crt" fullword ascii
$s10 = "c:\\crossdev\\gccmaster\\build-tdm64\\gcc\\x86_64-w64-mingw32\\32\\libgcc" fullword ascii
$s11 = "E__mingw_winmain_lpCmdLine" fullword ascii
$s12 = "GNU C 4.8.1 -m32 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector" fullword ascii
$s13 = "GNU C 4.8.1 -m32 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector -fno-exceptions" fullword ascii
$s14 = "GNU C 4.8.1 -m32 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector -fexceptions" fullword ascii
$s15 = "GNU C 4.8.1 -m32 -mtune=generic -march=x86-64 -g -O2 -std=gnu99" fullword ascii
$s16 = "__mingw_winmain_lpCmdLine" fullword ascii
$s17 = "Npthread_getspecific" fullword ascii
$s18 = "__gthread_getspecific" fullword ascii
$s19 = "=__mingw_GetSectionForAddress" fullword ascii
$s20 = "4lpszCommandLine" fullword ascii
condition:
uint16(0) == 0x5a4d and filesize &lt; 2000KB and
( pe.imphash() == "00f3261b5b33a9b1e8b6003f4056a885" and pe.exports("CSBhvSWCvFRvfCfAoJdoFuAUmK") or 8 of them )
}

rule ryuk_1006_servisses {
meta:
description = "files - file servisses.exe"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-13"
hash1 = "1d8b7faf5f290465cc742e07abca78fac419135b191071cc77912263cd1dde1d"
strings:
$s1 = "DOOKOL.exe" fullword ascii
$s2 = "c:/crossdev/src/winpthreads-svn6233/src/mutex.c" fullword ascii
$s3 = "mutex_global_shmem" fullword ascii
$s4 = "mutex_global_static_shmem" fullword ascii
$s5 = "_pthread_key_dest_shmem" fullword ascii
$s6 = "_pthread_key_max_shmem" fullword ascii
$s7 = "_pthread_key_sch_shmem" fullword ascii
$s8 = "_pthread_key_lock_shmem" fullword ascii
$s9 = "cannot find name of executable" fullword ascii
$s10 = "tiles32.png" fullword ascii
$s11 = "GetModuleFileName: %s" fullword ascii
$s12 = "IP_DEST_HOST_UNREACHABLE (11003)" fullword ascii
$s13 = "This program requires Windows NT!" fullword ascii
$s14 = "SNMP INVALID_SESSION" fullword ascii
$s15 = "SNMP TRAP_ERRORS" fullword ascii
$s16 = "SNMP SELECT_FDERRORS" fullword ascii
$s17 = "Some different radices: %d %x %o %#x %#o " fullword ascii
$s18 = "c:/crossdev/src/winpthreads-svn6233/src/rwlock.c" fullword ascii
$s19 = "_pthread_tls_shmem" fullword ascii
$s20 = "IP_DEST_PORT_UNREACHABLE (11005)" fullword ascii
condition:
uint16(0) == 0x5a4d and filesize &lt; 2000KB and
( pe.imphash() == "a90d500745a1ce2417c01fecefbc2851" and pe.exports("KADWEGAFSTWUATQFFFFkxcEEF") or 8 of them )
}

rule ryuk_1006_files_SQL {
meta:
description = "files - file SQL.dll"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-13"
hash1 = "d67461ba45a4edf3b2a69b3e64303fda8130bd1fc7a1173f35c1fe67b40c9639"
strings:
$s1 = ".data$_ZN12_GLOBAL__N_110fake_mutexE" fullword ascii
$s2 = ".data$_ZZN12_GLOBAL__N_116get_static_mutexEvE4once" fullword ascii
$s3 = "DOOKOL.dll" fullword ascii
$s4 = "_ZN12_GLOBAL__N_110fake_mutexE" fullword ascii
$s5 = "_ZZN12_GLOBAL__N_116get_static_mutexEvE4once" fullword ascii
$s6 = ".data$_ZN12_GLOBAL__N_115emergency_mutexE" fullword ascii
$s7 = ".data$_ZN12_GLOBAL__N_1L12static_mutexE" fullword ascii
$s8 = "__shmem_winpthreads_grabber_mutex_global_shmem" fullword ascii
$s9 = "__shmem_winpthreads_init_mutex_global_shmem" fullword ascii
$s10 = "__shmem_winpthreads_ptr_mutex_global_shmem" fullword ascii
$s11 = "c:/crossdev/src/winpthreads-svn6233/src/mutex.c" fullword ascii
$s12 = "pthread_mutex_lock_intern" fullword ascii
$s13 = "__shmem_winpthreads_init_mutex_global_static_shmem" fullword ascii
$s14 = "__shmem_winpthreads_grabber_mutex_global_static_shmem" fullword ascii
$s15 = "__shmem_winpthreads_ptr_mutex_global_static_shmem" fullword ascii
$s16 = "_Z7ExecutePv" fullword ascii
$s17 = "hmutex" fullword ascii
$s18 = "._FindPESectionExec" fullword ascii
$s19 = "_ZN9__gnu_cxx17__recursive_mutex6unlockEv" fullword ascii
$s20 = ".text$_ZN9__gnu_cxx17__recursive_mutex6unlockEv" fullword ascii
condition:
uint16(0) == 0x5a4d and filesize &lt; 2000KB and
( pe.imphash() == "d16819dafefb97404d0d0e42adb82e5c" and ( pe.exports("CSBhvSWCvFRvfCfAoJdoFuAUmK") and pe.exports("StartW") ) or 8 of them )
}</pre>
<p>If you have detections you would like to add to this section, please contact us and we will credit you.</p>
<h2>MITRE</h2>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""><span title="" data-original-title=""> Spearphishing Link &#8211; T1192</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4442" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Remote Desktop Protocol &#8211; T1076</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4845" method="post" data-bitwarden-watching="1"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Remote File Copy &#8211; T1105</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4718" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Windows Management Instrumentation &#8211; T1047</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4618" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Command-Line Interface &#8211; T1059</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4504" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Domain Trust Discovery &#8211; T1482</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4927" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Remote System Discovery &#8211; T1018</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4842" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> System Time Discovery &#8211; T1124</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4519" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Data Encrypted for Impact &#8211; T1486</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4848" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Commonly Used Port &#8211; T1043</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4515" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Standard Application Layer Protocol &#8211; T1071</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4516" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Standard Cryptographic Protocol &#8211; T1032</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4633" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> User Execution &#8211; T1204</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4505" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Valid Accounts &#8211; T1078</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4715" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Exploitation for Privilege Escalation &#8211; T1068</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4909" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Signed Binary Proxy Execution &#8211; T1218</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/5130" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Rundll32 &#8211; T1085</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4617" method="post"></form>
<p><span class="bold blue" title="" data-original-title="ATT&amp;CK Tactic"><span class="bold blue expandContainer" title="" data-original-title=""> <span title="" data-original-title=""><i class="fas fa-globe-americas"></i> Regsvr32 &#8211; T1117</span>  </span></span></p>
<form id="viewForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80223/event/4916" method="post"></form>
<p>(internal case 1006)</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-1041" class="share-twitter sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/?share=twitter" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-1041" class="share-facebook sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/?share=facebook" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-1041" class="share-linkedin sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/?share=linkedin" target="_blank" title="Click to share on LinkedIn"><span></span><span class="sharing-screen-reader-text">Click to share on LinkedIn (Opens in new window)</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span><span class="sharing-screen-reader-text">Click to share on Reddit (Opens in new window)</span></a></li><li class="share-telegram"><a rel="nofollow noopener noreferrer" data-shared="" class="share-telegram sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/?share=telegram" target="_blank" title="Click to share on Telegram"><span></span><span class="sharing-screen-reader-text">Click to share on Telegram (Opens in new window)</span></a></li><li class="share-skype"><a rel="nofollow noopener noreferrer" data-shared="sharing-skype-1041" class="share-skype sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/?share=skype" target="_blank" title="Click to share on Skype"><span></span><span class="sharing-screen-reader-text">Click to share on Skype (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts'>
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
</div>
<footer class="entry-footer">
<div class="entry-meta">
<span class="tag-links"><a href="https://thedfirreport.com/tag/adfind/" rel="tag">adfind</a><a href="https://thedfirreport.com/tag/bazar/" rel="tag">bazar</a><a href="https://thedfirreport.com/tag/cobalt-strike/" rel="tag">cobalt strike</a><a href="https://thedfirreport.com/tag/kegtap/" rel="tag">kegtap</a><a href="https://thedfirreport.com/tag/malspam/" rel="tag">malspam</a><a href="https://thedfirreport.com/tag/ryuk/" rel="tag">ryuk</a></span> </div>
</footer>
</div>
</article>
<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2020/10/08/ryuks-return/" rel="prev">Ryuk&#8217;s Return</a></div><div class="nav-next"><a href="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/" rel="next">Ryuk Speed Run, 2 Hours to Ransom</a></div></div>
</nav>
</main>
</div>
<aside id="secondary" class="widget-area">
<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
</label>
<input type="submit" class="search-submit" value="Search" />
</form></section><section id="blog_subscription-2" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title">Subscribe to Blog via Email</h2>
<form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
<div id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
</div> <p id="subscribe-email">
<label id="jetpack-subscribe-label" class="screen-reader-text" for="subscribe-field-blog_subscription-2">
Email Address </label>
<input type="email" name="email" required="required" value="" id="subscribe-field-blog_subscription-2" placeholder="Email Address" />
</p>
<p id="subscribe-submit">
<input type="hidden" name="action" value="subscribe" />
<input type="hidden" name="source" value="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" />
<input type="hidden" name="sub-type" value="widget" />
<input type="hidden" name="redirect_fragment" value="blog_subscription-2" />
<button type="submit" name="jetpack_subscriptions_widget">
Subscribe </button>
</p>
</form>
</section><section id="twitter_timeline-3" class="widget widget_twitter_timeline"><h2 class="widget-title">Follow us on Twitter</h2><a class="twitter-timeline" data-width="220" data-theme="light" data-border-color="#e8e8e8" data-tweet-limit="5" data-lang="EN" data-partner="jetpack" data-chrome="noheader nofooter noborders transparent noscrollbar" href="https://twitter.com/@TheDFIRReport" href="https://twitter.com/@TheDFIRReport">My Tweets</a></section><section id="jetpack_display_posts_widget-2" class="widget widget_jetpack_display_posts_widget"><h2 class="widget-title">Recent Posts: The DFIR Report</h2><div class="jetpack-display-remote-posts"><h4><a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" target="_blank" rel="noopener">Ryuk in 5 Hours</a></h4>
<a title="Ryuk in 5 Hours" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" target="_blank" rel="noopener"><img src="https://i2.wp.com/thedfirreport.com/wp-content/uploads/2020/10/ryuk.png?fit=1093%2C587&ssl=1" alt="Ryuk in 5 Hours" /></a><p>Intro The Ryuk threat actors went from a phishing email to domain wide ransomware in 5 hours. They escalated privileges using Zerologon (CVE-2020-1472), less than 2 hours after the initial &hellip; <a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" class="more-link">Read More</a></p>
<h4><a href="https://thedfirreport.com/2020/10/08/ryuks-return/" target="_blank" rel="noopener">Ryuk&#8217;s Return</a></h4>
<a title="Ryuk&#8217;s Return" href="https://thedfirreport.com/2020/10/08/ryuks-return/" target="_blank" rel="noopener"><img src="https://i2.wp.com/thedfirreport.com/wp-content/uploads/2020/10/ryuk.png?fit=1093%2C587&ssl=1" alt="Ryuk&#8217;s Return" /></a><p>Intro The Ryuk group went from an email to domain wide ransomware in 29 hours and asked for over $6 million to unlock our systems. They used tools such as &hellip; <a href="https://thedfirreport.com/2020/10/08/ryuks-return/" class="more-link">Read More</a></p>
<h4><a href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" target="_blank" rel="noopener">NetWalker Ransomware in 1 Hour</a></h4>
<a title="NetWalker Ransomware in 1 Hour" href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" target="_blank" rel="noopener"><img src="https://i2.wp.com/thedfirreport.com/wp-content/uploads/2020/08/image-42.png?fit=639%2C709&ssl=1" alt="NetWalker Ransomware in 1 Hour" /></a><p>The threat actor logged in through RDP, attempted to run a Cobalt Strike Beacon, and then dumped memory using ProcDump and Mimikatz. Next, they RDPed into a Domain Controller, minutes &hellip; <a href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" class="more-link">Read More</a></p>
<h4><a href="https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/" target="_blank" rel="noopener">Dridex &#8211; From Word to Domain Dominance</a></h4>
<a title="Dridex &#8211; From Word to Domain Dominance" href="https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/" target="_blank" rel="noopener"><img src="https://i1.wp.com/thedfirreport.com/wp-content/uploads/2020/08/timeline.png?fit=544%2C608&ssl=1" alt="Dridex &#8211; From Word to Domain Dominance" /></a><h4><a href="https://thedfirreport.com/2020/07/13/ransomware-again-but-we-changed-the-rdp-port/" target="_blank" rel="noopener">Ransomware Again&#8230;But We Changed the RDP Port!?!?!</a></h4>
<a title="Ransomware Again&#8230;But We Changed the RDP Port!?!?!" href="https://thedfirreport.com/2020/07/13/ransomware-again-but-we-changed-the-rdp-port/" target="_blank" rel="noopener"><img src="https://i1.wp.com/thedfirreport.com/wp-content/uploads/2020/07/image-20.png?fit=1222%2C841&ssl=1" alt="Ransomware Again&#8230;But We Changed the RDP Port!?!?!" /></a><p>Here&#8217;s another example of threat actors brute forcing RDP to install ransomware, this time the brute forced system was not using the default RDP port. The threat actors installed ransomware &hellip; <a href="https://thedfirreport.com/2020/07/13/ransomware-again-but-we-changed-the-rdp-port/" class="more-link">Read More</a></p>
</div></section><section id="google_translate_widget-3" class="widget widget_google_translate_widget"><h2 class="widget-title">Translate</h2><div id="google_translate_element"></div></section></aside>
</div>
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="copyright-area">
<div class="wrap">
<div class="site-info">
<a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Theme: FreeNews <span class="sep"> | </span> By <a href="https://themespiral.com/">ThemeSpiral.com</a>. </div>
<div class="footer-right-info">
</div>
</div>
</div>
</footer>
<button href="#" class="back-to-top" type="button"><i class="fa fa-long-arrow-up"></i>Go Top</button>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2020\/10\/18\/ryuk-in-5-hours\/":1041};
	</script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/dist/vendor/wp-polyfill.min.js' id='wp-polyfill-js'></script>
<script type='text/javascript' id='wp-polyfill-js-after'>
( 'fetch' in window ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-fetch.min.js?ver=3.0.0"></scr' + 'ipt>' );( document.contains ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-node-contains.min.js?ver=3.42.0"></scr' + 'ipt>' );( window.DOMRect ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-dom-rect.min.js?ver=3.42.0"></scr' + 'ipt>' );( window.URL && window.URL.prototype && window.URLSearchParams ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-url.min.js?ver=3.6.4"></scr' + 'ipt>' );( window.FormData && window.FormData.prototype.keys ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-formdata.min.js?ver=3.0.12"></scr' + 'ipt>' );( Element.prototype.matches && Element.prototype.closest ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-element-closest.min.js?ver=2.0.2"></scr' + 'ipt>' );( 'objectFit' in document.documentElement.style ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-object-fit.min.js?ver=2.3.4"></scr' + 'ipt>' );
</script>
<script type='text/javascript' id='contact-form-7-js-extra'>
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/thedfirreport.com\/wp-json\/","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.4.1' id='contact-form-7-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=5.7.2' id='freenews-navigation-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=5.7.2' id='freenews-skip-link-focus-fix-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=5.7.2' id='ResizeSensor-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=5.7.2' id='theia-sticky-sidebar-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=5.7.2' id='slick-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=5.7.2' id='freenews-slick-settings-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=5.7.2' id='jquery-sticky-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=5.7.2' id='freenews-sticky-settings-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=5.7.2' id='marquee-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=5.7.2' id='freenews-marquee-settings-js'></script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/twitter-timeline.min.js' id='jetpack-twitter-timeline-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/src/js/intersectionobserver-polyfill.min.js?ver=1.1.2' id='jetpack-lazy-images-polyfill-intersectionobserver-js'></script>
<script type='text/javascript' id='jetpack-lazy-images-js-extra'>
/* <![CDATA[ */
var jetpackLazyImagesL10n = {"loading_warning":"Images are still loading. Please cancel your print and try again."};
/* ]]> */
</script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/src/js/lazy-images.min.js?ver=1.1.2' id='jetpack-lazy-images-js'></script>
<script type='text/javascript' id='wp_slimstat-js-extra'>
/* <![CDATA[ */
var SlimStatParams = {"ajaxurl":"https:\/\/thedfirreport.com\/wp-admin\/admin-ajax.php","baseurl":"\/","dnt":"noslimstat,ab-item","ci":"YTo0OntzOjEyOiJjb250ZW50X3R5cGUiO3M6NDoicG9zdCI7czo4OiJjYXRlZ29yeSI7czozNToiMjQsMjcsNiwyLDMsMjUsMTksMjYsMjgsMTQsMjksMTAsMzAiO3M6MTA6ImNvbnRlbnRfaWQiO2k6MTA0MTtzOjY6ImF1dGhvciI7czo2OiJlZGl0b3IiO30-.5bedb58680dc15fbff8534eeff1339aa"};
/* ]]> */
</script>
<script type='text/javascript' src='https://cdn.jsdelivr.net/wp/wp-slimstat/tags/4.8.8.1/wp-slimstat.min.js' id='wp_slimstat-js'></script>
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js?render=6LdT96QZAAAAAPgYNKKHOXJj40TDn4FL6KFdhViu&#038;ver=3.0' id='google-recaptcha-js'></script>
<script type='text/javascript' id='wpcf7-recaptcha-js-extra'>
/* <![CDATA[ */
var wpcf7_recaptcha = {"sitekey":"6LdT96QZAAAAAPgYNKKHOXJj40TDn4FL6KFdhViu","actions":{"homepage":"homepage","contactform":"contactform"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/contact-form-7/modules/recaptcha/index.js?ver=5.4.1' id='wpcf7-recaptcha-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>
<script type='text/javascript' id='google-translate-init-js-extra'>
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/widgets/google-translate/google-translate.min.js' id='google-translate-init-js'></script>
<script type='text/javascript' src='//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&#038;ver=5.7.2' id='google-translate-js'></script>
<script type='text/javascript' id='sharing-js-js-extra'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/sharedaddy/sharing.min.js' id='sharing-js-js'></script>
<script type='text/javascript' id='sharing-js-js-after'>
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-telegram' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-telegram' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtelegram', 'menubar=1,resizable=1,width=450,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-skype' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-skype' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomskype', 'menubar=1,resizable=1,width=305,height=665' );
						return false;
					}
				} );
			} )();
</script>
<script src='https://stats.wp.com/e-202120.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'175340963',post:'1041',tz:'0',srv:'thedfirreport.com'} ]);
	_stq.push([ 'clickTrackerInit', '175340963', '1041' ]);
</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"653aa91b4cfff90f","version":"2021.5.1","r":1,"token":"e6611380fbbe475a97dc9cf0a0e9fd2b","si":10}'></script>
</body>
</html>
