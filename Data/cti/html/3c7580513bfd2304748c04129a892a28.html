<!DOCTYPE html>
<html dir='ltr' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/1007218368-widget_css_bundle.css' rel='stylesheet' type='text/css'/>
<link href='http://www.pctools.com/security-news/' rel='canonical'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='http://blog.threatexpert.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="ThreatExpert Blog - Atom" href="http://blog.threatexpert.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="ThreatExpert Blog - RSS" href="http://blog.threatexpert.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="ThreatExpert Blog - Atom" href="https://www.blogger.com/feeds/7283598531036801098/posts/default" />

<link rel="alternate" type="application/atom+xml" title="ThreatExpert Blog - Atom" href="http://blog.threatexpert.com/feeds/4275133384442157516/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<meta content='http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html' property='og:url'/>
<meta content='Agent.btz - A Threat That Hit Pentagon' property='og:title'/>
<meta content='According to this publication , the senior military leaders reported the malware breach incident that affected the U.S. Central Command netw...' property='og:description'/>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>ThreatExpert Blog: Agent.btz - A Threat That Hit Pentagon</title>
<style id='page-skin-1' type='text/css'><!--
#navbar-iframe {
display: none !important;
}
body {
background:#fff;
margin:0;
padding:0px 25px 0px 25px;
color:#333;
font:x-small Georgia Serif;
font-size: .75em;
text-align: center;
}
a:link {
color:#369;
text-decoration:none;
}
a:visited {
color:#969;
text-decoration:none;
}
a:hover {
color:#c60;
text-decoration:underline;
}
a img {
border-width:0;
}
#header-wrapper {
width:900px;
margin:0px;
border:0px;
}
#header-inner {
background-position: center;
margin-left: auto;
margin-right: auto;
}
#header {
margin: 0px;
border: 0px;
text-align: center;
}
#outer-wrapper {
width: 900px;
margin:0 auto;
padding:0px;
text-align:left;
font: normal normal 100% Georgia, Serif;
}
#main-wrapper {
width: 650px;
float: left;
word-wrap: break-word;
overflow: hidden;
}
#sidebar-wrapper {
width: 250px;
float: right;
word-wrap: break-word;
overflow: hidden;
}
h2 {
margin:1.5em 0 .75em;
font:normal normal 78% 'Trebuchet MS',Trebuchet,Arial,Verdana,Sans-serif;
line-height: 1.4em;
text-transform:uppercase;
letter-spacing:.2em;
color:#999;
}
h2.date-header {
margin:1.5em 0 .5em;
}
.post {
margin:.5em 0 1.5em;
border-bottom:1px dotted #ccc;
padding-bottom:1.5em;
}
.post h3 {
margin:.25em 0 0;
padding:0 0 4px;
font-size:140%;
font-weight:normal;
line-height:1.4em;
color:#c60;
}
.post h3 a, .post h3 a:visited, .post h3 strong {
display:block;
text-decoration:none;
color:#c60;
font-weight:normal;
}
.post h3 strong, .post h3 a:hover {
color:#333;
}
.post p {
margin:0 0 .75em;
line-height:1.6em;
}
.post-footer {
margin: .75em 0;
color:#999;
text-transform:uppercase;
letter-spacing:.1em;
font: normal normal 78% 'Trebuchet MS', Trebuchet, Arial, Verdana, Sans-serif;
line-height: 1.4em;
}
.comment-link {
margin-left:.6em;
}
.post img {
padding:4px;
border:1px solid #ccc;
}
.post blockquote {
margin:1em 20px;
}
.post blockquote p {
margin:.75em 0;
}
/* Comments
----------------------------------------------- */
#comments h4 {
margin:1em 0;
font-weight: bold;
line-height: 1.4em;
text-transform:uppercase;
letter-spacing:.2em;
color: #999;
}
#comments-block {
margin:1em 0 1.5em;
line-height:1.6em;
}
#comments-block .comment-author {
margin:.5em 0;
}
#comments-block .comment-body {
margin:.25em 0 0;
}
#comments-block .comment-footer {
margin:-.25em 0 2em;
line-height: 1.4em;
text-transform:uppercase;
letter-spacing:.1em;
}
#comments-block .comment-body p {
margin:0 0 .75em;
}
.deleted-comment {
font-style:italic;
color:gray;
}
#blog-pager-newer-link {
float: left;
}
#blog-pager-older-link {
float: right;
}
#blog-pager {
text-align: center;
}
.feed-links {
clear: both;
line-height: 2.5em;
}
/* Sidebar Content
----------------------------------------------- */
.sidebar {
color: #555;
line-height: 1.5em;
}
.sidebar ul {
list-style:none;
margin:0 0 0;
padding:0 0 0;
}
.sidebar li {
margin:0;
padding-top:0;
padding-right:0;
padding-bottom:.25em;
padding-left:15px;
text-indent:-15px;
line-height:1.5em;
}
.sidebar .widget, .main .widget {
border-bottom:1px dotted #ccc;
margin:0 0 1.5em;
padding:0 0 1.5em;
}
.main .Blog {
border-bottom-width: 0;
}
.profile-img {
float: left;
margin-top: 0;
margin-right: 5px;
margin-bottom: 5px;
margin-left: 0;
padding: 4px;
border: 1px solid #ccc;
}
.profile-data {
margin:0;
text-transform:uppercase;
letter-spacing:.1em;
font: normal normal 78% 'Trebuchet MS', Trebuchet, Arial, Verdana, Sans-serif;
color: #999;
font-weight: bold;
line-height: 1.6em;
}
.profile-datablock {
margin:.5em 0 .5em;
}
.profile-textblock {
margin: 0.5em 0;
line-height: 1.6em;
}
.profile-link {
font: normal normal 78% 'Trebuchet MS', Trebuchet, Arial, Verdana, Sans-serif;
text-transform: uppercase;
letter-spacing: .1em;
}
/* Footer
----------------------------------------------- */
#footer {
width:900px;
clear:both;
margin:0 auto;
padding-top:15px;
line-height: 1.6em;
text-transform:uppercase;
letter-spacing:.1em;
text-align: center;
}
body#layout #header {
margin-left: 0px;
margin-right: 0px;
}

--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7283598531036801098&amp;zx=9f7b833b-52a3-4e0b-8583-9439268ea04a' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7283598531036801098&amp;zx=9f7b833b-52a3-4e0b-8583-9439268ea04a' rel='stylesheet'/></noscript>

</head>
<body>
<div class='navbar section' id='navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d7283598531036801098\x26blogName\x3dThreatExpert+Blog\x26publishMode\x3dPUBLISH_MODE_HOSTED\x26navbarType\x3dSILVER\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttp://blog.threatexpert.com/search\x26blogLocale\x3den_US\x26v\x3d2\x26homepageUrl\x3dhttp://blog.threatexpert.com/\x26targetPostID\x3d4275133384442157516\x26blogPostOrPageUrl\x3dhttp://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html\x26vt\x3d-691617552672948429',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div id='outer-wrapper'><div id='wrap2'>
<!-- skip links for text browsers -->
<span id='skiplinks' style='display:none;'>
<a href='#main'>skip to main </a> |
      <a href='#sidebar'>skip to sidebar</a>
</span>
<div id='header-wrapper'>
<div class='header section' id='header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<a href='http://blog.threatexpert.com/' style='display: block'>
<img alt='ThreatExpert Blog' height='150px; ' id='Header1_headerimg' src='http://2.bp.blogspot.com/_teq8tr511YQ/R7UhWPAyJZI/AAAAAAAAABo/jcljDoO-E08/S1600-R/banner.gif' style='display: block' width='900px; '/>
</a>
</div>
</div></div>
</div>
<div id='content-wrapper'>
<div id='crosscol-wrapper' style='text-align:center'>
<div class='crosscol section' id='crosscol'><div class='widget HTML' data-version='1' id='HTML1'>
<div class='widget-content'>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1490218-5");
pageTracker._initData();
pageTracker._trackPageview();
</script>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("HTML1"));' rel='nofollow' target='configHTML1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div></div>
</div>
<div id='main-wrapper'>
<div class='main section' id='main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Sunday, November 30, 2008</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='7283598531036801098' itemprop='blogId'/>
<meta content='4275133384442157516' itemprop='postId'/>
<a name='4275133384442157516'></a>
<h3 class='post-title entry-title' itemprop='name'>
Agent.btz - A Threat That Hit Pentagon
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-4275133384442157516' itemprop='description articleBody'>
<br/>According to this <a href="http://www.latimes.com/news/printedition/front/la-na-cyberattack28-2008nov28,0,1970897.story" target="_blank">publication</a>, the senior military leaders reported the malware breach incident that affected the U.S. Central Command network, including computers both in the headquarters and in the combat zones.<br /><br />The threat involved into this incident is referred as Agent.btz. This is a classification from <a href="http://www.f-secure.com/v-descs/worm_w32_agent_btz.shtml" target="_blank">F-Secure</a>. Other vendors name this threat mostly as <a href="http://vil.nai.com/vil/content/v_149448.htm" target="_blank">Autorun</a>. Some of the aliases assigned to this threat might seem confusing. There is even a clash with <a href="http://www.threatexpert.com/report.aspx?md5=b1009c175ed7ecdb132318840fd4ef3c" target="_blank">another</a> threat that is also detected as Agent.btz by another vendor &#8211; but that's a totally different threat with different functionality. This post is about F-Secure-classified Agent.btz &#8211; the one that was involved into the aforementioned incident.<br /><br />At the time of this writing, ThreatExpert system has received and processed several <a href="http://www.threatexpert.com/reports.aspx?find=update/img0008/" target="_blank">different samples</a> of this threat &#8211; further referred as Agent.btz. All these builds exhibit common functionality.<br /><br />Agent.btz is a DLL file. When loaded, its exported function DllEntryPoint() will be called automatically. Another exported function of this DLL, InstallM(),is called during the initial infection stage, via a command-line parameter for the system file rundll32.exe.<br /><br /><strong>Infection Vector</strong><br /><br />The infection normally occurs via a removable disk such as thumb drive (USB stick) or any other external hard drive. Once a removable disk is connected to a computer infected with Agent.btz, the active malware will detect a newly recognized drive. It will drop its copy on it and it will create autorun.inf file with an instruction to run that file. When a clean computer recognizes a newly connected removable drive, it will (by default) detect autorun.inf file on it, it will then open it and follow its instruction to load the malware.<br /><br />Another infection vector: when a clean computer attempts to map a drive letter to a shared network resource that has Agent.atz on it and the corresponding autorun.inf file, it will (by default) open autorun.inf file and follow its instruction to load the malware. Once infected, it will do the same with other removable drives connected to it or other computers in the network that attempt to map a drive letter to its shared drive infected with Agent.atz &#8211; hence, the replication.<br /><br />The autorun.inf file it creates contains the following command to run rundll32.exe:<br /><br /><span style="font-family:Courier New;font-size:2;color:#606090">rundll32.exe .\\[random_name].dll,InstallM</span><br /><br /><strong>Functionality</strong><br /><br />When Agent.btz DLL is loaded, it will decrypt some of the strings inside its body. Agent.btz file is not packed. The strings it decrypts are mostly filenames, API names, registry entries, etc.<br /><br />After decrypting its strings, Agent.btz dynamically retrieves function pointers to the following kernel32.dll APIs: WriteProcessMemory(), VirtualAllocEx(), VirtualProtectEx(). It will need these APIs later to inject malicious code into Internet Explorer process.<br /><br />Agent.btz spawns several threads and registers window class <span style="font-family:Courier New;font-size:2;color:#606090">"zQWwe2esf34356d"</span>.<br /><br />The first thread will try to query several parameters from the values under the registry key:<br /><br /><span style="font-family:Courier New;font-size:2;color:#606090">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\StrtdCfg</span><br /><br />Some of these parameters contain such details as time out periods, flags, or the name of the domain from which the additional components can be downloaded.<br /><br />The first thread will spawn 2 additional threads. One of them will wait for 5 minutes, and then it will attempt to download an encrypted binary from the domain specified in the parameters.<br /><br />For example, it may attempt to download the binaries from these locations:<br /><br /><span style="font-family:Courier New;font-size:2;color:#606090">http://biznews.podzone.org/update/img0008/[random digits].jpg</span><br /><br />or<br /><br /><span style="font-family:Courier New;font-size:2;color:#606090">http://worldnews.ath.cx/update/img0008/[random digits].jpg</span><br /><br />The downloaded binary will be saved under the file name $1F.dll into the temporary directory.<br /><br />Once the binary is saved, Agent.btz signals its threads with "wowmgr_is_loaded" event, saves new parameters into the registry values under the key "StrtdCfg", loads Internet Explorer process, decrypts the contents of the downloaded binary, injects it into the address space of Internet Explorer and then spawn a remote thread in it.<br /><br />At the time of this writing the contents of the binary is unknown as the links above are down. Thus, it&#8217;s not known what kind of code could have been injected into the browser process. The only assumption can be made here is that the remote thread was spawned inside Internet Explorer process in order to bypass firewalls in its attempt to communicate with the remote server.<br /><br /><strong>Installation</strong><br /><br />Agent.btz drops its copy into %system% directory by using a random name constructed from the parts of the names of the DLL files located in the %system% directory.<br /><br />It registers itself as an in-process server to have its DLL loaded with the system process explorer.exe. The CLSID for the in-process server is also random - it is produced by UuidCreate() API.<br /><br />This threat may also store some of its parameters by saving them into the values nParam, rParam or id under the system registry key below:<br /><br /><span style="font-family:Courier New;font-size:2;color:#606090">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CrashImage</span><br /><br />On top of that, Agent.btz carries some of its parameters in its own body &#8211; stored as an encrypted resource named CONFIG. Agent.btz locates this resource by looking for a marker 0xAA45F6F9 in its memory map.<br /><br /><strong>File wmcache.nld</strong><br /><br />The second spawned thread will wait for 10 seconds. Then, it&#8217;ll save its parameters and some system information it obtains in an XML file %system%\wmcache.nld.<br /><br />The contents of this file is encoded by XOR-ing it with the following mask:<br /><br /><span style="font-family:Courier New;font-size:2;color:#606090">1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6gs923HL34x2f5cvd0fk6c1a0s</span><br /><br />Below is the decoded fragment of the XML file, provided as example:<br /><span style="font-family:Courier New;font-size:2;color:#606090"><br />&lt;?xml version="1.0" encoding="unicode"?&gt;<br />&lt;Cfg&gt;<br />&lt;Ch&gt;<br />&lt;add key="Id" value="3024688254" /&gt;<br />&lt;add key="PVer" value="Ch 1.5" /&gt;<br />&lt;add key="Folder" value="img0008" /&gt;<br />&lt;add key="Time" value="29:11:2008 18:44:46" /&gt;<br />&lt;add key="Bias" value="4294967285" /&gt;<br />&lt;add key="PcName" value="%ComputerName%" /&gt;<br />&lt;add key="UserName" value="%UserName%" /&gt;<br />&lt;add key="WinDir" value="%windir%" /&gt;<br />&lt;add key="TempDir" value="%temp%" /&gt;<br />&lt;add key="WorkDir" value="%system32%" /&gt;<br />&lt;add key="Cndr" value="0" /&gt;<br />&lt;add key="List" value=""&gt;<br />&lt;add key="       0" value="2" /&gt;<br />&lt;/add&gt;<br />&lt;add key="NList" value=""&gt;<br />&lt;/add&gt;<br />&lt;/Ch&gt;<br />...<br />&lt;/Cfg&gt;<br /></span><br /><br />Besides the basic system information above, Agent.btz contains the code that calls GetAdaptersInfo() and GetPerAdapterInfo() APIs in order to query network adapter&#8217;s IP and MAC address, IP addresses of the network adapter&#8217;s default gateway, primary/secondary WINS, DHCP and DNS servers. The collected network details are also saved into the log file.<br /><br /><strong>File winview.ocx</strong><br /><br />The second spawned thread will log threat activity into the file %system32%\winview.ocx.<br /><br />This file is also encrypted with the same XOR mask. Here is the decrypted example contents of that file:<br /><span style="font-family:Courier New;font-size:2;color:#606090"><br />18:44:44 29.11.2008 Log begin:<br />18:44:44 Installing to C:\WINDOWS\system32\[random_name].dll<br />18:44:44 Copying c:\windows\system32\[threat_file_name].dll to C:\WINDOWS\system32\[random_name].dll (0)<br />18:44:44 ID: {7761F912-4D09-4F09-B7AF-95F4173120A6}<br />18:44:44 Creating Software\Classes\CLSID\{7761F912-4D09-4F09-B7AF-95F4173120A6}<br />18:44:44 Creating Software\Classes\CLSID\{7761F912-4D09-4F09-B7AF-95F4173120A6}\InprocServer32\<br />18:44:44 Set Value C:\WINDOWS\system32\[random_name].dll<br />18:44:44 Creating SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad\<br />18:44:44 Native Id: 00CD1A40<br />18:44:44 Log end.<br /></span><br /><br />The thread will be saving its parameters and system information into the aforementioned encrypted XML file in the loop &#8211; once in every 24 hours.<br /><br /><strong>File mswmpdat.tlb</strong><br /><br />The original thread will then attempt to start 2 processes: tapi32d.exe and typecli.exe &#8211; these attempts are logged. Whenever Agent.btz detects a newly connected removable disk, it will also log the device details into the same log file %system%\mswmpdat.tlb.<br /><br />The contents of this log file is encrypted the same way &#8211; here is the decrypted fragment of it:<br /><br /><span style="font-family:Courier New;font-size:2;color:#606090"><br />18:44:45 29.11.2008 Log begin:<br />18:44:45 Creating ps C:\WINDOWS\system32\tapi32d.exe (2)<br />18:44:45 Creating ps C:\WINDOWS\system32\typecli.exe (2)<br />18:44:45 Log end.<br />19:02:48 29.11.2008 Log begin:<br />19:02:49 Media arrived: "D:" Label:"" FS:FAT SN:00000000<br />19:02:49 Log end.<br /></span><br /><br />It is not clear what these 2 files are: tapi32d.exe and typecli.exe - the analyzed code does not create them. It is possible however that the missing link is in the unknown code it injects into Internet Explorer which can potentially download those files.<br /><br /><strong>Files thumb.db</strong><br /><br />When Agent.btz detects a new drive of the type DRIVE_REMOVABLE (a disk that can be removed from the drive), it attempts to create a copy of the file %system%\1055cf76.tmp in the root directory of that drive as thumb.db.<br /><br />In opposite, if the newly connected drive already contains file thumb.db, Agent.btz will create a copy of that file in the %system% directory under the same name. It will then run %system%\thumb.db as if it was an executable file and then delete the original thumb.db from the connected drive.<br /><br />The analyzed code does not create 1055cf76.tmp, but if it was an executable file downloaded by the code injected into Internet Explorer (as explained above), then it would have been passed into other computers under the name thumb.db. Note: an attempt to run a valid thumb.db file, which is an OLE-type container has no effect.<br /><br /><strong>Files thumb.dd and mssysmgr.ocx</strong><br /><br />Agent.btz is capable to create a binary file thumb.dd on a newly connected drive. The contents of this file starts from the marker 0xAAFF1290 and is followed with the individual CAB archives of the files winview.ocx (installation log), mswmpdat.tlb (activity log), and wmcache.nld (XML file with system information).<br /><br />When Agent.btz detects a new drive with the file thumb.dd on it (system info and logs collected from another computer), it will copy that file as %system%\mssysmgr.ocx.<br /><br />This way, the locally created files do not only contain system and network information collected from the local host, but from other compromised host (or hosts) as well.
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<span itemprop='name'>Sergei Shevchenko</span>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html' itemprop='url'/>
<a class='timestamp-link' href='http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2008-11-30T05:30:00-08:00'>5:30 AM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-156240951'>
<a href='https://www.blogger.com/post-edit.g?blogID=7283598531036801098&postID=4275133384442157516&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='http://blog.threatexpert.com/search/label/Agent.btz' rel='tag'>Agent.btz</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='http://blog.threatexpert.com/2008/12/beware-christmas-promotions-from-coca.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='http://blog.threatexpert.com/2008/11/srizbis-domain-calculator.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='http://blog.threatexpert.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
</div>
</div></div>
</div>
<div id='sidebar-wrapper'>
<div class='sidebar section' id='sidebar'><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2010/'>
2010
</a>
<span class='post-count' dir='ltr'>(7)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2010/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2010/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2010/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2010/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2010/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/'>
2009
</a>
<span class='post-count' dir='ltr'>(17)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/11/'>
November
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/05/'>
May
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/03/'>
March
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2009/01/'>
January
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/'>
2008
</a>
<span class='post-count' dir='ltr'>(41)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/12/'>
December
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/11/'>
November
</a>
<span class='post-count' dir='ltr'>(5)</span>
<ul class='posts'>
<li><a href='http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html'>Agent.btz - A Threat That Hit Pentagon</a></li>
<li><a href='http://blog.threatexpert.com/2008/11/srizbis-domain-calculator.html'>Srizbi&#39;s Domain Calculator</a></li>
<li><a href='http://blog.threatexpert.com/2008/11/morro-antivirus.html'>Morro Antivirus?</a></li>
<li><a href='http://blog.threatexpert.com/2008/11/mccolo-who-was-behind-it.html'>McColo - Who Was Behind It?</a></li>
<li><a href='http://blog.threatexpert.com/2008/11/one-tricky-banking-trojan.html'>One Tricky Banking Trojan</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/08/'>
August
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/07/'>
July
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/06/'>
June
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/05/'>
May
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/04/'>
April
</a>
<span class='post-count' dir='ltr'>(8)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='http://blog.threatexpert.com/2008/02/'>
February
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' rel='nofollow' target='configBlogArchive1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget Text' data-version='1' id='Text1'>
<h2 class='title'>About ThreatExpert&#8482;</h2>
<div class='widget-content'>
ThreatExpert is an advanced automated threat analysis system designed to analyze and report the behavior of computer viruses, worms, trojans, adware, spyware, and other security-related risks in a fully automated mode.<br/>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("Text1"));' rel='nofollow' target='configText1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div><div class='widget LinkList' data-version='1' id='LinkList1'>
<h2>Links</h2>
<div class='widget-content'>
<ul>
<li><a href='http://www.threatexpert.com/'>ThreatExpert</a></li>
<li><a href='http://www.pctools.com/'>PC Tools</a></li>
<li><a href='http://blog.threatfire.com/'>ThreatFire Blog</a></li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("LinkList1"));' rel='nofollow' target='configLinkList1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div></div>
</div>
<!-- spacer for skins that want sidebar and main to be the same height-->
<div class='clear'>&#160;</div>
</div>
<!-- end content-wrapper -->
<div id='footer-wrapper'>
<div class='footer no-items section' id='footer'></div>
</div>
</div></div>
<!-- end outer-wrapper -->

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3464975383-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY7X1ThjfyFn4wnfGM34czukagP0iQ:1621656860103';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d7283598531036801098','//blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html','7283598531036801098');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '7283598531036801098', 'title': 'ThreatExpert Blog', 'url': 'http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html', 'canonicalUrl': 'http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html', 'homepageUrl': 'http://blog.threatexpert.com/', 'searchUrl': 'http://blog.threatexpert.com/search', 'canonicalHomepageUrl': 'http://blog.threatexpert.com/', 'blogspotFaviconUrl': 'http://blog.threatexpert.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': false, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en-US', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22ThreatExpert Blog - Atom\x22 href\x3d\x22http://blog.threatexpert.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22ThreatExpert Blog - RSS\x22 href\x3d\x22http://blog.threatexpert.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22ThreatExpert Blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/7283598531036801098/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22ThreatExpert Blog - Atom\x22 href\x3d\x22http://blog.threatexpert.com/feeds/4275133384442157516/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/751ccdc09ff31f1f', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 300, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '4275133384442157516', 'pageName': 'Agent.btz - A Threat That Hit Pentagon', 'pageTitle': 'ThreatExpert Blog: Agent.btz - A Threat That Hit Pentagon'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Agent.btz - A Threat That Hit Pentagon', 'description': 'According to this publication , the senior military leaders reported the malware breach incident that affected the U.S. Central Command netw...', 'url': 'http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 4275133384442157516}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'crosscol', document.getElementById('HTML1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/840662228-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1050234869-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_TextView', new _WidgetInfo('Text1', 'sidebar', document.getElementById('Text1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList1', 'sidebar', document.getElementById('LinkList1'), {}, 'displayModeFull'));
</script>
</body>
</html>