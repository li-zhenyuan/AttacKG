<!DOCTYPE html>


















































<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Detect and remediate the Outlook rules and custom forms injections attacks. - Office 365" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack" />
			<meta property="og:description" content="Learn how to recognize and remediate the Outlook rules and custom forms injections attacks in Office 365" />
		<meta property="og:image" content="https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png" />
		<meta property="og:image:alt" content="Microsoft Logo" />

	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@docsmsft" />

	<meta name="color-scheme" content="light dark">


	<meta name="audience" content="ITPro" />
<meta name="author" content="MSFTTracyP" />
<meta name="breadcrumb_path" content="/microsoft-365/breadcrumb/toc.json" />
<meta name="depot_name" content="office.Microsoft-365-docs" />
<meta name="description" content="Learn how to recognize and remediate the Outlook rules and custom forms injections attacks in Office 365" />
<meta name="document_id" content="82d82939-8b5a-2d4c-6cc9-5a3443ee5b99" />
<meta name="document_version_independent_id" content="8d4fd954-0a92-67e8-f2fd-ca5ffaaacac2" />
<meta name="f1.keywords" content="NOCSH" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/microsoft-365-docs-pr/blob/e398467cb2d5a284ff8b30aa006e76e8cb034d68/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack.md" />
<meta name="locale" content="en-us" />
<meta name="localization_priority" content="Normal" />
<meta name="manager" content="dansimp" />
<meta name="monikers" content="o365-21vianet" />
<meta name="monikers" content="o365-germany" />
<meta name="monikers" content="o365-worldwide" />
<meta name="ms.author" content="tracyp" />
<meta name="ms.collection" content="o365_security_incident_response" />
<meta name="ms.collection" content="M365-security-compliance" />
<meta name="ms.custom" content="seo-marvel-apr2020" />
<meta name="ms.date" content="04/23/2018" />
<meta name="ms.prod" content="m365-security" />
<meta name="ms.technology" content="mdo" />
<meta name="ms.topic" content="article" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/microsoft-365-docs-pr/blob/live/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack.md" />
<meta name="schema" content="Conceptual" />
<meta name="search.appverid" content="MET150" />
<meta name="search.ms_docsetname" content="Microsoft-365-docs" />
<meta name="search.ms_product" content="office" />
<meta name="search.ms_sitename" content="Docs" />
<meta name="site_name" content="Docs" />
<meta name="uhfHeaderId" content="MSDocsHeader-M365-IT" />
<meta name="updated_at" content="2021-03-24 06:34 PM" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="toc.json" />
<meta name="pdf_url_template" content="https://docs.microsoft.com/pdfstore/en-us/office.Microsoft-365-docs/{branchName}{pdfName}" />
<meta name="word_count" content="2375" />


	<meta name="scope" content="D, e, f, e, n, d, e, r,  , f, o, r,  , O, f, f, i, c, e" />
<link href="https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack" rel="canonical">
	<title>Detect and remediate the Outlook rules and custom forms injections attacks. - Office 365 | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/8147a557.site-ltr.css ">

	


	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: true,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'GitHub',
			feedbackGitHubRepo: 'MicrosoftDocs/microsoft-365-docs',
			feedbackProductUrl: 'https://office365.uservoice.com/forums/289138-office-365-security-compliance',
			contentGitUrl: 'https://github.com/MicrosoftDocs/microsoft-365-docs/blob/public/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack.md',
			extendBreadcrumb: true,
			isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: false,
			contributors: [
						{ name: "MSFTTracyP", url: "https://github.com/MSFTTracyP" },
						{ name: "Dansimp", url: "https://github.com/Dansimp" },
						{ name: "chrfox", url: "https://github.com/chrfox" },
						{ name: "DaniHalfin", url: "https://github.com/DaniHalfin" },
						{ name: "chrisda", url: "https://github.com/chrisda" },
						{ name: "dariomws", url: "https://github.com/dariomws" },
						{ name: "Ajayan1008", url: "https://github.com/Ajayan1008" },
						{ name: "walsehgal", url: "https://github.com/walsehgal" },
						{ name: "jdmartinez36", url: "https://github.com/jdmartinez36" },
						{ name: "lhcole", url: "https://github.com/lhcole" },
						{ name: "pebaum", url: "https://github.com/pebaum" },
						{ name: "robmazz", url: "https://github.com/robmazz" },
						{ name: "mjcaparas", url: "https://github.com/mjcaparas" }
],
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-3.min.js"></script>
	<script>window.onedsAwa = window.awa; delete window.awa;</script>	
	<script src="/static/third-party/jsll/4.3.4/jsll-4.js"></script>
	<script nomodule src="/static/third-party/bluebird/3.5.0/bluebird.min.js" integrity="sha384-aD4BDeDGeLXLpPK4yKeqtZQa9dv4a/7mQ+4L5vwshIYH1Mc2BrXvHd32iHzYCQy5" crossorigin="anonymous"></script>
	<script nomodule src="/static/third-party/fetch/3.0.0/fetch.umd.min.js" integrity="sha384-EQIXrC5K2+7X8nGgLkB995I0/6jfAvvyG1ieZ+WYGxgJHFMD/alsG9fSDWvzb5Y1" crossorigin="anonymous"></script>
	<script nomodule src="/static/third-party/template/1.4.0/template.min.js" integrity="sha384-1zKzI6ldTVHMU7n0W2HpE/lhHI+UG4D9IIaxbj3kT2UhCWicdTuJkTtnKuu0CQzN" crossorigin="anonymous"></script>
	<script nomodule src="/static/third-party/url/0.5.7/url.min.js" integrity="sha384-vn7xBMtpSTfzaTRWxj0kVq0UcsbBrTOgZ/M1ISHqe1V358elYva+lfiEC+T8jLPc" crossorigin="anonymous"></script>
	<script src="/_themes/docs.theme/master/en-us/_themes/scripts/8a64e446.index-polyfills.js"></script>

		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/2777d474.index-docs.js"></script>
</head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 has-padding-medium has-text-centered has-body-background-medium" tabindex="1">Skip to main content</a>
		
		<div id="ignite-banner-holder" class="has-default-focus has-overflow-hidden"></div>
		<div id="build-banner-holder" class="has-default-focus has-overflow-hidden"></div>
		
		<div hidden id="cookie-consent-holder"></div>
		<!-- liquid-tag banners global -->
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
	<div class="nav-bar">
		<div class="nav-bar-brand">
			<a itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft" class="nav-bar-button">
				<div class="nav-bar-logo has-background-image theme-display is-light" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
				<div class="nav-bar-logo has-background-image theme-display is-dark is-high-contrast" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
			</a>
		</div>
	</div>
	<div class="nav-bar border-top is-hidden-mobile"></div>
</header>		</div>

						<div class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
					<nav class="breadcrumb-holder has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop flex-grow-1" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
						<ul id="page-breadcrumbs" class="breadcrumbs">
						</ul>
					</nav>
				<div class="content-header-controls">
					<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
				<div class="has-padding-none-tablet has-padding-medium font-size-s display-flex justify-content-space-between flex-grow-1 page-action-holder">
					<ul class="is-hidden-mobile action-list justify-content-flex-start has-flex-justify-content-end-tablet display-flex flex-wrap-wrap flex-grow-1 is-unstyled">
						<li hidden>
							<a id="lang-link" class="button is-text has-inner-focus is-small is-icon-only-touch" title="Read in English" data-bi-name="language-toggle">
								<span id="lang-link-icon" class="icon docon docon-locale-globe" aria-hidden="true"></span>
								<span id="lang-link-text" class="is-visually-hidden-touch is-hidden-portrait"></span>
							</a>
						</li>
						<li>
							<button type="button" class="collection button is-text has-inner-focus is-small is-icon-only-touch" data-list-type="collection" data-bi-name="collection" title="Add to collection">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-circle-addition has-text-primary"></span>
								</span>
								<span class="collection-status is-visually-hidden-touch is-hidden-portrait">Save</span>
							</button>
						</li>
							<li id="feedback-section-link">
								<a href="#feedback" class="button is-text has-inner-focus is-small is-icon-only-touch" data-bi-name="comments" title="Send feedback about this page">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-comment-lines"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
								</a>
							</li>
								<li id="contenteditbtn">
									<a href="https://github.com/MicrosoftDocs/microsoft-365-docs/blob/public/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack.md" class="button is-text has-inner-focus is-icon-only-touch is-small" title="Edit This Document" data-bi-name="edit" data-original_content_git_url="https://github.com/MicrosoftDocs/microsoft-365-docs-pr/blob/live/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack.md" data-original_content_git_url_template="{repo}/blob/{branch}/microsoft-365/security/office-365-security/detect-and-remediate-outlook-rules-forms-attack.md" data-pr_repo="" data-pr_branch="">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-edit-outline"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
								</a>
							</li>
						<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small is-icon-only-touch" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-twitter" data-bi-name="twitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-linkedin" data-bi-name="linkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-facebook" data-bi-name="facebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-email" data-bi-name="email">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>						</li>
					</ul>
					<button type="button" class="border contents-button button is-small is-text is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
						<span class="icon">
							<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
						</span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<div class="is-invisible"></div>
					<div class="is-hidden-tablet level-item is-flexible level-right">
						<button type="button" class="page-actions-button button is-small is-text is-hidden-tablet has-inner-focus border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
							<span class="icon">
								<span class="docon docon-more-vertical" aria-hidden="true"></span>
							</span>
						</button>
					</div>
				</div>
			</div>



		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="position-fixed display-flex flex-direction-column" role="navigation" aria-label="Primary"></nav>
			</div>

			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<div class="columns is-gapless-mobile has-large-gaps ">


				<div id="main-column" class="column  is-full is-four-fifths-desktop ">

					<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



						<h1 id="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks</h1>

						<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
							<li>
								<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2018-04-23T00:00:00.000Z" data-article-date-source="ms.date">04/23/2018</time>
							</li>
									<li class="readingTime">11 minutes to read</li>
								<li class="contributors-holder">
									<ul class="facepile has-margin-left-none is-small" data-bi-name="contributors">
														<li class="facepile-item">
															<a href="https://github.com/MSFTTracyP" title="MSFTTracyP" aria-label="MSFTTracyPGithub profile" data-src="https://github.com/MSFTTracyP.png?size=32" data-contributor-name="MSFTTracyP" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/MSFTTracyP.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">M</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/Dansimp" title="Dansimp" aria-label="DansimpGithub profile" data-src="https://github.com/Dansimp.png?size=32" data-contributor-name="Dansimp" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/Dansimp.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">D</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/chrfox" title="chrfox" aria-label="chrfoxGithub profile" data-src="https://github.com/chrfox.png?size=32" data-contributor-name="chrfox" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/chrfox.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-blue"aria-hidden="true">c</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/DaniHalfin" title="DaniHalfin" aria-label="DaniHalfinGithub profile" data-src="https://github.com/DaniHalfin.png?size=32" data-contributor-name="DaniHalfin" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/DaniHalfin.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">D</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/chrisda" title="chrisda" aria-label="chrisdaGithub profile" data-src="https://github.com/chrisda.png?size=32" data-contributor-name="chrisda" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/chrisda.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">c</span>
															</a>
														</li>
											<li class="facepile-item">
													<button aria-label="View all contributors" class="facepile-item-more" title="View all contributors">
														<div class="facepile-item-coin" aria-hidden="true">
															<span class="facepile-item-coin-text" aria-hidden="true">
																+8
															</span>
														</div>
													</button>
											</li>
									</ul>
								</li>
						</ul>

						<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
							<h3>In this article</h3>
						</nav>

						<!-- <content> -->
							<div class="IMPORTANT">
<p>Important</p>
<p>The improved <a href="https://security.microsoft.com" data-linktype="external">Microsoft 365 security center</a> is now available. This new experience brings Defender for Endpoint, Defender for Office 365, Microsoft 365 Defender, and more into the Microsoft 365 security center. <a href="/en-us/microsoft-365/security/mtp/overview-security-center" data-linktype="absolute-path">Learn what's new</a>.</p>
</div>
<p><strong>Summary</strong> Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</p>
<h2 id="what-is-the-outlook-rules-and-custom-forms-injection-attack">What is the Outlook Rules and Custom Forms injection attack?</h2>
<p>After an attacker gains access to your organization, they'll try to establish a foothold to stay in or get back in after they've been discovered. This activity is called <em>establishing a persistence mechanism</em>. There are two ways that an attacker can use Outlook to establish a persistence mechanism:</p>
<ul>
<li>By exploiting Outlook rules.</li>
<li>By injecting custom forms into Outlook.</li>
</ul>
<p>Reinstalling Outlook, or even giving the affected person a new computer won't help. When the fresh installation of Outlook connects to the mailbox, all rules and forms are synchronized from the cloud. The rules or forms are typically designed to run remote code and install malware on the local machine. The malware steals credentials or performs other illicit activity.</p>
<p>The good news is: if you keep your Outlook clients patched to the latest version, you aren't vulnerable to the threat as current Outlook client defaults block both mechanisms.</p>
<p>The attacks typically follow these patterns:</p>
<p><strong>The Rules Exploit</strong>:</p>
<ol>
<li><p>The attacker steals a user's credentials.</p>
</li>
<li><p>The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</p>
</li>
<li><p>The attacker creates a forwarding Inbox rule in the mailbox. The forwarding rule is triggered when the mailbox receives a specific message from the attacker that matches the conditions of the rule. The rule conditions and message format are tailor-made for each other.</p>
</li>
<li><p>The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</p>
</li>
<li><p>When the mailbox receives a message that matches the conditions of rule, the action of the rule is applied. Typically, the rule action is to launch an application on a remote (WebDAV) server.</p>
</li>
<li><p>Typically, the application installs malware on the user's machine (for example, <a href="https://www.powershellempire.com/" data-linktype="external">PowerShell Empire</a>).</p>
</li>
<li><p>The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</p>
</li>
</ol>
<p><strong>The Forms Exploit</strong>:</p>
<ol>
<li><p>The attacker steals a user's credentials.</p>
</li>
<li><p>The attacker signs in to that user's Exchange mailbox (Exchange Online or on-premises Exchange).</p>
</li>
<li><p>The attacker inserts a custom mail form template into the user's mailbox. The custom form is triggered when the mailbox receives a specific message from the attacker that requires the mailbox to load the custom form. The custom form and the message format are tailor-made for each other.</p>
</li>
<li><p>The attacker sends the trigger email to the compromised mailbox, which is still being used as normal by the unsuspecting user.</p>
</li>
<li><p>When the mailbox receives the message, the mailbox loads the required form. The form launches an application on a remote (WebDAV) server.</p>
</li>
<li><p>Typically, the application installs malware on the user's machine (for example, <a href="https://www.powershellempire.com/" data-linktype="external">PowerShell Empire</a>).</p>
</li>
<li><p>The malware allows the attacker to steal (or steal again) the user's username and password or other credentials from local machine and perform other malicious activities.</p>
</li>
</ol>
<h2 id="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365">What a Rules and Custom Forms Injection attack might look like Office 365?</h2>
<p>These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them. This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below. If you find any of these, you need to take remediation steps.</p>
<ul>
<li><p><strong>Indicators of the Rules compromise</strong>:</p>
<ul>
<li>Rule Action is to start an application.</li>
<li>Rule References an EXE, ZIP, or URL.</li>
<li>On the local machine, look for new process starts that originate from the Outlook PID.</li>
</ul>
</li>
<li><p><strong>Indicators of the Custom forms compromise</strong>:</p>
<ul>
<li>Custom forms present saved as their own message class.</li>
<li>Message class contains executable code.</li>
<li>Typically, malicious forms are stored in Personal Forms Library or Inbox folders.</li>
<li>Form is named IPM.Note.[custom name].</li>
</ul>
</li>
</ul>
<h2 id="steps-for-finding-signs-of-this-attack-and-confirming-it">Steps for finding signs of this attack and confirming it</h2>
<p>You can use either of the following methods to confirm the attack:</p>
<ul>
<li><p>Manually examine the rules and forms for each mailbox using the Outlook client. This method is thorough, but you can only check one mailbox at a time. This method can be very time consuming if you have many users to check, and might also infect the computer that you're using.</p>
</li>
<li><p>Use the <a href="https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1" data-linktype="external">Get-AllTenantRulesAndForms.ps1</a> PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy. This is the fastest and safest method with the least amount of overhead.</p>
</li>
</ul>
<h3 id="confirm-the-rules-attack-using-the-outlook-client">Confirm the Rules Attack Using the Outlook client</h3>
<ol>
<li><p>Open the users Outlook client as the user. The user may need your help in examining the rules on their mailbox.</p>
</li>
<li><p>Refer to <a href="https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59" data-linktype="external">Manage email messages by using rules</a> article for the procedures on how to open the rules interface in Outlook.</p>
</li>
<li><p>Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</p>
</li>
<li><p>Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</p>
</li>
<li><p>Look for any new processes that start using the Outlook process ID. Refer to <a href="/en-us/windows-hardware/drivers/debugger/finding-the-process-id" data-linktype="absolute-path">Find the Process ID</a>.</p>
</li>
</ol>
<h3 id="steps-to-confirm-the-forms-attack-using-the-outlook-client">Steps to confirm the Forms attack using the Outlook client</h3>
<ol>
<li><p>Open the user Outlook client as the user.</p>
</li>
<li><p>Follow the steps in, <a href="https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45" data-linktype="external">Show the Developer tab</a> for the user's version of Outlook.</p>
</li>
<li><p>Open the now visible developer tab in Outlook and click <strong>design a form</strong>.</p>
</li>
<li><p>Select the <strong>Inbox</strong> from the <strong>Look In</strong> list. Look for any custom forms. Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</p>
</li>
<li><p>Investigate any custom forms, especially those marked as hidden.</p>
</li>
<li><p>Open any custom forms and in the <strong>Form</strong> group click <strong>View Code</strong> to see what runs when the form is loaded.</p>
</li>
</ol>
<h3 id="steps-to-confirm-the-rules-and-forms-attack-using-powershell">Steps to confirm the Rules and Forms attack using PowerShell</h3>
<p>The simplest way to verify a rules or custom forms attack is to run the <a href="https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1" data-linktype="external">Get-AllTenantRulesAndForms.ps1</a> PowerShell script. This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</p>
<h4 id="pre-requisites">Pre-requisites</h4>
<p>You will need to have global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</p>
<ol>
<li><p>Sign in to the machine that you will run the script from with local administrator rights.</p>
</li>
<li><p>Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it. The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</p>
</li>
<li><p>Open a PowerShell instance as an administrator and open the folder you saved the script to.</p>
</li>
<li><p>Run this PowerShell command line as follows <code>.\Get-AllTenantRulesAndForms.ps1</code>.\Get-AllTenantRulesAndForms.ps1</p>
</li>
</ol>
<h4 id="interpreting-the-output">Interpreting the output</h4>
<ul>
<li><p><strong>MailboxRulesExport-<em>yyyy-mm-dd</em>.csv</strong>: Examine the rules (one per row) for action conditions that include applications or executables:</p>
<ul>
<li><p><strong>ActionType (column A)</strong>: If you see the value &quot;ID_ACTION_CUSTOM&quot;, the rule is likely malicious.</p>
</li>
<li><p><strong>IsPotentiallyMalicious (column D)</strong>: If this value is &quot;TRUE&quot;, the rule is likely malicious.</p>
</li>
<li><p><strong>ActionCommand (column G)</strong>: If this column lists an application or any file with .exe or .zip extensions, or an unknown entry that refers to a URL, the rule is likely malicious.</p>
</li>
</ul>
</li>
<li><p><strong>MailboxFormsExport-<em>yyyy-mm-dd</em>.csv</strong>: In general, the use of custom forms is rare. If you find any in this workbook, you open that user's mailbox and examine the form itself. If your organization did not put it there intentionally, it is likely malicious.</p>
</li>
</ul>
<h2 id="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack">How to stop and remediate the Outlook Rules and Forms attack</h2>
<p>If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox. You can do this with the Outlook client or using remote PowerShell to remove rules.</p>
<h3 id="using-outlook">Using Outlook</h3>
<ol>
<li><p>Identify all the devices that the user has used with Outlook. They will all need to be cleaned of potential malware. Do not allow the user to sign on and use email until all the devices are cleaned.</p>
</li>
<li><p>Follow the steps in <a href="https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f" data-linktype="external">Delete a rule</a> for each device.</p>
</li>
<li><p>If you are unsure about the presence of other malware, you can format and reinstall all the software on the device. For mobile devices, you can follow the manufacturers steps to reset the device to the factory image.</p>
</li>
<li><p>Install the most up-to-date versions of Outlook. Remember that the current version of Outlook blocks both types of this attack by default.</p>
</li>
<li><p>Once all offline copies of the mailbox have been removed, reset the user's password (use a high quality one) and follow the steps in <a href="../../admin/security-and-compliance/set-up-multi-factor-authentication?view=o365-worldwide" data-linktype="relative-path">Setup multi-factor authentication for users</a> if MFA has not already been enabled. This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</p>
</li>
</ol>
<h3 id="using-powershell">Using PowerShell</h3>
<p>There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules. Just follow the steps.</p>
<h4 id="steps-for-mailboxes-that-are-on-an-exchange-server">Steps for mailboxes that are on an Exchange server</h4>
<ol>
<li><p>Connect to the Exchange server using remote PowerShell. Follow the steps in <a href="/en-us/powershell/exchange/connect-to-exchange-servers-using-remote-powershell" data-linktype="absolute-path">Connect to Exchange servers using remote PowerShell</a>.</p>
</li>
<li><p>If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the <a href="/en-us/powershell/module/exchange/Remove-InboxRule" data-linktype="absolute-path">Remove-InboxRule</a> cmdlet.</p>
</li>
<li><p>If you want to retain the rule and its contents for further investigation use the <a href="/en-us/powershell/module/exchange/disable-inboxrule" data-linktype="absolute-path">Disable-InboxRule</a> cmdlet.</p>
</li>
</ol>
<h4 id="steps-for-mailboxes-in-exchange-online">Steps for mailboxes in Exchange Online</h4>
<ol>
<li><p>Follow the steps in <a href="/en-us/powershell/exchange/connect-to-exchange-online-powershell" data-linktype="absolute-path">Connect to Exchange Online using PowerShell</a>.</p>
</li>
<li><p>If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the <a href="/en-us/powershell/module/exchange/Remove-InboxRule" data-linktype="absolute-path">Remove-Inbox Rule</a> cmdlet.</p>
</li>
<li><p>If you want to retain the rule and its contents for further investigation use the <a href="/en-us/powershell/module/exchange/disable-inboxrule" data-linktype="absolute-path">Disable-InboxRule</a> cmdlet.</p>
</li>
</ol>
<h2 id="how-to-minimize-future-attacks">How to minimize future attacks</h2>
<h3 id="first-protect-your-accounts">First: protect your accounts</h3>
<p>The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user's accounts. So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts. Some of the most common ways that accounts are breached are through phishing or <a href="https://www.microsoft.com/security/blog/2020/04/23/protecting-organization-password-spray-attacks/" data-linktype="external">password spray attacks</a>.</p>
<p>The best way to protect your user accounts, and especially your administrator accounts, is to <a href="../../admin/security-and-compliance/set-up-multi-factor-authentication?view=o365-worldwide" data-linktype="relative-path">set up multi-factor authentication for users</a>. You should also:</p>
<ul>
<li><p>Monitor how your user accounts are <a href="/en-us/azure/active-directory/active-directory-view-access-usage-reports" data-linktype="absolute-path">accessed and used</a>. You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner. You can use these <a href="/en-us/cloud-app-security/what-is-cloud-app-security" data-linktype="absolute-path">Office 365 Cloud App Security policies</a> to monitor you accounts and alert on unusual activity:</p>
<ul>
<li><p><strong>Multiple failed login attempts</strong>: This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</p>
</li>
<li><p><strong>Impossible travel</strong>: This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations. This could indicate that a different user is using the same credentials. Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user's activity pattern.</p>
</li>
<li><p><strong>Unusual impersonated activity (by user)</strong>: This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</p>
</li>
</ul>
</li>
<li><p>Use a tool like <a href="https://securescore.office.com/" data-linktype="external">Office 365 Secure Score</a> to manage account security configurations and behaviors.</p>
</li>
</ul>
<h3 id="second-keep-your-outlook-clients-current">Second: Keep your Outlook clients current</h3>
<p>Fully updated and patched versions of Outlook 2013, and 2016 disable the &quot;Start Application&quot; rule/form action by default. This will ensure that even if an attacker breaches the account, the rule and form actions will be blocked. You can install the latest updates and security patches by following the steps in <a href="https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5" data-linktype="external">Install Office updates</a>.</p>
<p>Here are the patch versions for your Outlook 2013 and 2016 clients:</p>
<ul>
<li><p><strong>Outlook 2016</strong>: 16.0.4534.1001 or greater.</p>
</li>
<li><p><strong>Outlook 2013</strong>: 15.0.4937.1000 or greater.</p>
</li>
</ul>
<p>For more information on the individual security patches, see:</p>
<ul>
<li><p><a href="https://support.microsoft.com/help/3191883" data-linktype="external">Outlook 2016 Security Patch</a></p>
</li>
<li><p><a href="https://support.microsoft.com/help/3191938" data-linktype="external">Outlook 2013 Security Patch</a></p>
</li>
</ul>
<h3 id="third-monitor-your-outlook-clients">Third: Monitor your Outlook clients</h3>
<p>Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the &quot;Start Application&quot; behavior. You can use <a href="/en-us/microsoft-desktop-optimization-pack/agpm/" data-linktype="absolute-path">Advanced Group Policy Management</a> to monitor and enforce local machine policies on your clients.</p>
<p>You can see if &quot;Start Application&quot; has been re-enabled through an override in the registry by using the information in <a href="https://support.microsoft.com/help/305097" data-linktype="external">How to view the system registry by using 64-bit versions of Windows</a>. Check these subkeys:</p>
<ul>
<li><p><strong>Outlook 2016</strong>: <code>HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\</code></p>
</li>
<li><p><strong>Outlook 2013</strong>: <code>HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\</code></p>
</li>
</ul>
<p>Look for the key EnableUnsafeClientMailRules. If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack. If the value is 0, the &quot;Start Application&quot; action is disabled. If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</p>
<p>Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available. Details on this process can be found in the article <a href="/en-us/exchange/configure-outlook-client-blocking-exchange-2013-help" data-linktype="absolute-path">Configure Outlook client blocking</a>.</p>
<h2 id="secure-microsoft-365-like-a-cybersecurity-pro">Secure Microsoft 365 like a cybersecurity pro</h2>
<p>Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users. Use the <a href="security-roadmap?view=o365-worldwide" data-linktype="relative-path">Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond</a> to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</p>
<ul>
<li><p>Tasks to accomplish in the first 30 days. These have immediate effect and are low-impact to your users.</p>
</li>
<li><p>Tasks to accomplish in 90 days. These take a bit more time to plan and implement but greatly improve your security posture.</p>
</li>
<li><p>Beyond 90 days. These enhancements build in your first 90 days work.</p>
</li>
</ul>
<h2 id="see-also">See also:</h2>
<ul>
<li><p><a href="https://silentbreaksecurity.com/malicious-outlook-rules/" data-linktype="external">Malicious Outlook Rules</a> by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</p>
</li>
<li><p><a href="https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/" data-linktype="external">MAPI over HTTP and Mailrule Pwnage</a> on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</p>
</li>
<li><p><a href="https://sensepost.com/blog/2017/outlook-forms-and-shells/" data-linktype="external">Outlook forms and shells</a> on the Sensepost blog about Forms Threat Vector.</p>
</li>
<li><p><a href="https://github.com/sensepost/ruler" data-linktype="external">Ruler Codebase</a></p>
</li>
<li><p><a href="https://github.com/sensepost/notruler/blob/master/iocs.md" data-linktype="external">Ruler Indicators of Compromise</a></p>
</li>
</ul>

						<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop border-top has-margin-top-large has-padding-top-large binary-rating-holder">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-large has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small font-size-h4 has-margin-bottom-medium">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons is-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small border-none" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>									</div>
						<!-- end page rating section -->


						<!-- recommendations section -->
						<!-- end recommendations section -->

						<!-- feedback section -->
<section class="feedback-section position-relative" data-bi-name="feedback-section">

    <h2 id="feedback" class="title is-3 has-margin-top-large">Feedback</h2>

    <div class="alert choose-feedback-type">
        <p aria-hidden="true" id="send-feedback-about">Submit and view feedback for</p>

        <div class="choose-feedback-buttons margin-top-xs">
                <a class="button has-external-link-indicator feedback-type-product has-margin-bottom-small" aria-label="Send feedback about this product" href="https://office365.uservoice.com/forums/289138-office-365-security-compliance" data-bi-name="product-feedback">
                    <span>This product</span>
                </a>

			<a class="button feedback-type-product has-margin-bottom-small github-link" aria-label="Send feedback about this page" data-bi-name="create-issue-on-github">
				<span aria-hidden="true" class="docon docon-brand-github has-padding-right-extra-small"></span>
				<span>This page</span>
			</a>
        </div>
    </div>

    <div class="action-container display-flex justify-content-flex-end has-margin-top-small has-margin-bottom-small">
        <a class="view-on-github has-external-link-indicator" data-bi-name="view-on-github" href="https://github.com/MicrosoftDocs/microsoft-365-docs/issues">
            <span aria-hidden="true" class="docon docon-brand-github"></span>
            <span>View all page feedback</span>
        </a>
    </div>
</section>
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="border-top is-visible-interactive has-default-focus has-margin-top-large ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link flex-shrink-0" href="#" data-bi-name="select-locale"><span class="icon docon docon-world font-size-l has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text"></span></a>
		<div class="has-margin-left-medium has-margin-right-medium flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
						</div>
					</div>
					
					<div class="font-size-s right-container column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only" data-bi-name="pageactions" role="complementary" aria-label="Page Actions">
						<div id="affixed-right-container" class="doc-outline position-fixed is-vertically-scrollable">
								
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">

				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons is-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small border-none" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>							<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
								<h3>In this article</h3>
							</nav>
						</div>
					</div>

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
		</div>

		<!--end of .mainContainer -->
	</div>

	<section class="border-top has-default-focus is-hidden-interactive has-margin-top-large ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link flex-shrink-0" href="#" data-bi-name="select-locale"><span class="icon docon docon-world font-size-l has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text"></span></a>
		<div class="has-margin-left-medium has-margin-right-medium flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>
