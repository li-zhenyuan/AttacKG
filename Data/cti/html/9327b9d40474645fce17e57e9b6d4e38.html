<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Pierre-Marc Bureau',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole | WeLiveSecurity</title>
<meta name="description" content="Linux/Cdorked.A : New Apache backdoor being used in the wild to serve Blackhole"/>
<link rel="canonical" href="https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole | WeLiveSecurity" />
<meta property="og:description" content="Linux/Cdorked.A : New Apache backdoor being used in the wild to serve Blackhole" />
<meta property="og:url" content="https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:tag" content="Apache" />
<meta property="article:tag" content="backdoor" />
<meta property="article:tag" content="Blackhole" />
<meta property="article:tag" content="Linux" />
<meta property="article:tag" content="Linux/Cdorked" />
<meta property="article:tag" content="Malware" />
<meta property="article:tag" content="webserver" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2013-04-26T11:28:38+00:00" />
<meta property="article:modified_time" content="2013-05-03T20:11:43+00:00" />
<meta property="og:updated_time" content="2013-05-03T20:11:43+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2013/04/backdoor1.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2013/04/backdoor1.jpg" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="412" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Linux/Cdorked.A : New Apache backdoor being used in the wild to serve Blackhole" />
<meta name="twitter:title" content="Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2013/04/backdoor1.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single noimage">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-noimage">
	<div class="container promo-text">
		<div class="inner clearfix">
			<div class="col-md-11 col-sm-11 col-xs-12 no-padding">
				<h1>Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole</h1>
<div class="excerpt">Analysis of a malicious backdoor serving Blackhole exploit pack found on Linux Apache webserver compromised by malware dubbed Linux/Cdorked.A, together with remediation tool and techniques.</div>
<div class="post-meta">
    <div class="wls-authors">
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2013-04-26 11:28:38">26 Apr 2013 - 11:28AM</time>
		</span>
			</span>
</div>
			</div>
		</div>
	</div>
</div>	

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F04%2F26%2Flinuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F04%2F26%2Flinuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole%2F&text=Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F04%2F26%2Flinuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt noimage">
                                <p>Analysis of a malicious backdoor serving Blackhole exploit pack found on Linux Apache webserver compromised by malware dubbed Linux/Cdorked.A, together with remediation tool and techniques.</p>
                            </div>

                            <p>Last week, our friends at <a title="http://sucuri.net/" href="http://sucuri.net/" target="_blank">Sucuri</a> sent us a modified version of an Apache webserver redirecting some of its requests to the infamous Blackhole exploit packs. Sucuri has published a <a title="Apache Blackhole web server " href="http://blog.sucuri.net/?p=7057" target="_blank">blog post on this attack</a>. (You can find <a title="Blackhole exploit kit" href="/2011/12/04/carberp-blackhole-growing-fraud-incidents/" target="_blank">more about Blackhole here</a>.)</p>
<p>Our analysis of this malware, dubbed Linux/Cdorked.A, reveals that it is a sophisticated and stealthy backdoor meant to drive traffic to malicious websites. We urge system administrators to check their servers and verify that they are not affected by this threat. Detailed instructions to perform this check are provided below. (Update 5/1/2013: An improved <a title="Linux/Cdorked tool" href="/wp-content/uploads/2013/04/dump_cdorked_config.c" target="_blank">tool coded in C</a> replaced the Python script we originally published.)</p>
<p>In fact, Linux/Cdorked.A is one of the most sophisticated Apache backdoors we have seen so far. Although we are still processing the data, our Livegrid system reports hundreds of compromised servers. The backdoor leaves no traces of compromised hosts on the hard drive other than its modified httpd binary, thereby complicating forensics analysis. All of the information related to the backdoor is stored in shared memory. The configuration is pushed by the attacker through obfuscated HTTP requests that aren&#8217;t logged in normal Apache logs. This means that no command and control information is stored anywhere on the system.</p>
<h3>Technical analysis of Linux/Cdorked</h3>
<p>Here we provide the first technical analysis of Linux/Cdorked, which seems to be affecting hundreds of webservers right now. In the Linux/Cdorked binary all the important or suspicious strings are encrypted. As shown in the following image, a function is responsible for decrypting the strings on demand with a static XOR key.</p>
<p style="text-align: center;"><img class="aligncenter size-full wp-image-20580" title="cdork1" src="/wp-content/uploads/2013/04/cdork1.png" alt="" width="517" height="392" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork1.png 517w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork1-300x227.png 300w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork1-417x317.png 417w" sizes="(max-width: 517px) 100vw, 517px" /></p>
<p>The version of Linux/Cdorked that we have analyzed contains a total of 70 strings that are encoded this way. As shown in the following screenshot, the key used for encoding the data is 27A4E2DADAF183B51E3DA7F6C9E6239CDFC8A2E50A60E05F.<br />
<img class="aligncenter size-full wp-image-20581" title="cdork2" src="/wp-content/uploads/2013/04/cdork2.png" alt="" width="605" height="77" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork2.png 605w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork2-300x38.png 300w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork2-601x77.png 601w" sizes="(max-width: 605px) 100vw, 605px" /><br />
As mentioned before, Linux/Cdorked does not write any files on the disk. Instead, it allocates around six megabytes of shared memory to keep its state and configuration information. This memory block, a POSIX shared region of memory (shm), is used by all Apache subprocesses but can also be accessed by any other process since the malware authors didn&#8217;t limit its permission.  The following screenshot shows the (read, write for everyone) permission rights assigned to the shared memory region.</p>
<p style="text-align: center;"><img class="aligncenter size-full wp-image-20582" title="cdork3" src="/wp-content/uploads/2013/04/cdork3.png" alt="" width="308" height="151" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork3.png 308w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork3-300x147.png 300w" sizes="(max-width: 308px) 100vw, 308px" /></p>
<p>There are two ways the attacker can control the behavior of the backdoored server: through a reverse connect shell or through special commands, all of them are triggered via HTTP requests.</p>
<h3>The Linux/Cdorked.A backdoor</h3>
<p>The HTTP server is equipped with a reverse connect backdoor that can be triggered via a special HTTP GET request. It is invoked when a request to a special path is performed with a query string in a particular format, containing the hostname and port to connect. The client IP of the HTTP dialog is used as a key to decrypt the query string as a 4 byte XOR key. Additionally, IP specified in X-Real-IP or X-Forwarded-For headers will override the client IP as the XOR key. This means we can craft a X-Real-IP header that will in effect be a “\x00\x00\x00\x00” key. Query string also needs to be hex-encoded before sending.</p>
<p style="text-align: center;"><img class="aligncenter size-full wp-image-20583" title="cdork4" src="/wp-content/uploads/2013/04/cdork4.png" alt="" width="580" height="272" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork4.png 580w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork4-300x140.png 300w" sizes="(max-width: 580px) 100vw, 580px" /></p>
<p>While the shell is used by the attacker, the HTTP connection creating it is hung (the backdoor code does not implement forking). This implies that malicious shells can be found if one has access to the server and checks for long-running HTTP connections. On the other hand, the HTTP request does not appear in Apache&#8217;s log file due to the way the malicious code is hooked into Apache.</p>
<h3>Redirection in Linux/Cdorked.A</h3>
<p>When redirecting a client, the malware adds base64 encoded string to the query containing information like the original visited URL and whether or not the request was originally to a javascript file so the server could provide the right payload.</p>
<p style="text-align: center;"><img class="aligncenter size-full wp-image-20584" title="cdork5" src="/wp-content/uploads/2013/04/cdork5.png" alt="" width="365" height="181" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork5.png 365w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork5-300x148.png 300w" sizes="(max-width: 365px) 100vw, 365px" /></p>
<p>An example redirection looks like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a8a756b16e4452123639" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Location: hxxp://dcb84fc82e1f7b01. xxxxxxgsm.be/index.php?j=anM9MSZudmNiaW11Zj1jY3
Zja3FqdSZ0aW1lPTEzMDQxNjE4MjctMzYwNDUzNjUwJnNyYz0yMzImc3VybD13d3cuaW5mZWN0ZWRzZXJ2
ZXIuY29tJnNwb3J0PTgwJmtleT0xM0Q5MDk1MCZzdXJpPS9mb3J1bS93Y2YvanMvM3JkUGFydHkvcHJvdG
9hY3Vsb3VzLjEuOC4yLm1pbi5qcw==</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a8a756b16e4452123639-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16e4452123639-2">2</div><div class="crayon-num" data-line="crayon-60a8a756b16e4452123639-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16e4452123639-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a8a756b16e4452123639-1"><span class="crayon-v">Location</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//dcb84fc82e1f7b01. xxxxxxgsm.be/index.php?j=anM9MSZudmNiaW11Zj1jY3</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16e4452123639-2"><span class="crayon-e">Zja3FqdSZ0aW1lPTEzMDQxNjE4MjctMzYwNDUzNjUwJnNyYz0yMzImc3VybD13d3cuaW5mZWN0ZWRzZXJ2</span></div><div class="crayon-line" id="crayon-60a8a756b16e4452123639-3"><span class="crayon-i">ZXIuY29tJnNwb3J0PTgwJmtleT0xM0Q5MDk1MCZzdXJpPS9mb3J1bS93Y2YvanMvM3JkUGFydHkvcHJvdG</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16e4452123639-4"><span class="crayon-cn">9hY3Vsb3VzLjEuOC4yLm1pbi5qcw</span><span class="crayon-o">==</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>After decoding, the following parameters appear:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a8a756b16ea996938660" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
js=1&amp;amp;nvcbimuf=ccvckqju&amp;amp;time=1304161827-360453650&amp;amp;src=232&amp;amp;surl=www.infectedserver
.com&amp;amp;sport=80&amp;amp;key=13D90950&amp;amp;suri=/forum/wcf/js/3rdParty/protoaculous.1.8.2.min.js</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a8a756b16ea996938660-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ea996938660-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a8a756b16ea996938660-1"><span class="crayon-v">js</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-v">nvcbimuf</span><span class="crayon-o">=</span><span class="crayon-v">ccvckqju</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-v">time</span><span class="crayon-o">=</span><span class="crayon-cn">1304161827</span><span class="crayon-o">-</span><span class="crayon-cn">360453650</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-cn">232</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-v">surl</span><span class="crayon-o">=</span><span class="crayon-v">www</span><span class="crayon-sy">.</span><span class="crayon-i">infectedserver</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ea996938660-2"><span class="crayon-sy">.</span><span class="crayon-v">com</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-v">sport</span><span class="crayon-o">=</span><span class="crayon-cn">80</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-cn">13D90950</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-v">suri</span><span class="crayon-o">=</span><span class="crayon-o">/</span><span class="crayon-v">forum</span><span class="crayon-o">/</span><span class="crayon-v">wcf</span><span class="crayon-o">/</span><span class="crayon-v">js</span><span class="crayon-o">/</span><span class="crayon-cn">3rdParty</span><span class="crayon-o">/</span><span class="crayon-v">protoaculous</span><span class="crayon-sy">.</span><span class="crayon-cn">1.8.2.min.js</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The &#8220;surl&#8221; parameter shows the infected host and the &#8220;suri&#8221; indicates what the original requested resource was.</p>
<p>After the redirection, a web cookie is set on the client so it is not redirected again. This cookie is also set if a request is made to a page that looks like an administration page. The backdoor will check if the URL, the server name, or the referrer matches any of the following strings : &#8216;*adm*&#8217;, &#8216;*webmaster*&#8217;, &#8216;*submit*&#8217;, &#8216;*stat*&#8217;, &#8216;*mrtg*&#8217;, &#8216;*webmin*&#8217;, &#8216;*cpanel*&#8217;, &#8216;*memb*&#8217;, &#8216;*bucks*&#8217;, &#8216;*bill*&#8217;, &#8216;*host*&#8217;, &#8216;*secur*&#8217;, &#8216;*support*&#8217;.  This is probably done to avoid sending malicious content to administrators of the website, making the infection harder to spot. The following screenshot shows part of the code responsible for handling the web cookie.</p>
<p style="text-align: center;"><a href="/wp-content/uploads/2013/04/cdork6.png"><img class="aligncenter  wp-image-20585" title="cdork6" src="/wp-content/uploads/2013/04/cdork6.png" alt="" width="666" height="428" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork6.png 833w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork6-300x192.png 300w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork6-65x42.png 65w" sizes="(max-width: 666px) 100vw, 666px" /></a></p>
<p>A few other conditions must be met before redirection happens; for example, a check is done for the presence of the Accept-Language, Accept-Encoding, and Referrer header.</p>
<h3>Other Linux/Cdorked.A commands</h3>
<p>We found 23 commands in Linux/Cdorked.A that can be sent to the server via a POST to a specially crafted URL. The request must also contain a cookie header starting with &#8220;SECID=&#8221;. The query string value must hold 2 hex encoded bytes that are encrypted with the client IP, using the same technique as the shell. The SECID cookie data will be used as arguments to some of the commands. We believe that the URLs to redirect clients are sent to the backdoor using this method. The redirection information will be stored encrypted in the allocated shared memory region. We also believe that the conditions for redirection are set this way, for example, a white list of user agents to redirect can be preconfigured and a black list of IPs to avoid redirection.</p>
<p>This is the complete list of commands found in the binary we have analysed:  &#8216;DU&#8217;, &#8216;ST&#8217;, &#8216;T1&#8217;, &#8216;L1&#8217;, &#8216;D1&#8217;, &#8216;L2&#8217;, &#8216;D2&#8217;, &#8216;L3&#8217;, &#8216;D3&#8217;, &#8216;L4&#8217;, &#8216;D4&#8217;, &#8216;L5&#8217;, &#8216;D5&#8217;, &#8216;L6&#8217;, &#8216;D6&#8217;, &#8216;L7&#8217;, &#8216;D7&#8217;, &#8216;L8&#8217;, &#8216;D8&#8217;, &#8216;L9&#8217;, &#8216;D9&#8217;, &#8216;LA&#8217;, &#8216;DA&#8217;.</p>
<p>Finally, some information about the status of the backdoor is returned in the ETag HTTP header, as shown in the screenshot below. We are still investigating the purpose of each of the commands and will publish our results as soon as the analysis is completed. In short, they all either add content to, or remove it from, the configuration in the shared memory region.</p>
<p style="text-align: center;"><img class="aligncenter size-full wp-image-20586" title="cdork7" src="/wp-content/uploads/2013/04/cdork7.png" alt="" width="584" height="292" srcset="https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork7.png 584w, https://www.welivesecurity.com/wp-content/uploads/2013/04/cdork7-300x150.png 300w" sizes="(max-width: 584px) 100vw, 584px" /></p>
<h3>Linux/Cdorked.A Remediation</h3>
<p>As previously mentioned, the permissions on the shared memory allocation are loose. This allows other process to access to memory. We have made a free tool to allow systems administrators to verify the presence of the shared memory region and dump its content into a file (you can download <a title="Linux/Cdorked tool" href="/wp-content/uploads/2013/04/dump_cdorked_config.c" target="_blank">dump_cdorked_config.c</a> or copy and paste the code from the listing below).</p>
<p>We also recommend using <a title="http://manpages.ubuntu.com/manpages/natty/man1/debsums.1.html" href="http://manpages.ubuntu.com/manpages/natty/man1/debsums.1.html" target="_blank">debsums</a> for Debian or Ubuntu systems and <a title="http://linux.die.net/man/8/rpm" href="http://linux.die.net/man/8/rpm" target="_blank"><code>rpm --verify</code></a> for RPM based systems, to verify the integrity of your Apache web server package installation. (However, remember to temper this advice with the reality that the package manifest could have been altered by an attacker.) Checking for the presence of the shared memory is the recommended way to make sure you are not infected. We would be interested in receiving any memory dumps for further analysis.</p>
<p>At the time of writing, the ESET Livegrid monitoring system is showing hundreds of webservers that seem to be affected by this backdoor with thousands of visitors being redirected to malicious content. We will publish more information on the scale and complexity of this operation in the days to come.</p>
<p><strong>The following researchers contributed to this report: Olivier Bilodeau, François Chagnon, Alexis Dorais-Joncas, Sebastien Duquette and Marc-Étienne Léveillé.</strong></p>
<h3><strong>Resources:</strong></h3>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a8a756b16ec473821873" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
SHA1 of the analyzed binary: 24e3ebc0c5a28ba433dfa69c169a8dd90e05c429</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a8a756b16ec473821873-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a8a756b16ec473821873-1"><span class="crayon-e">SHA1 </span><span class="crayon-e">of </span><span class="crayon-e">the </span><span class="crayon-e">analyzed </span><span class="crayon-v">binary</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">24e3ebc0c5a28ba433dfa69c169a8dd90e05c429</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Code for the shared memory dump tool: <a title="Linux/Cdorked tool" href="/wp-content/uploads/2013/04/dump_cdorked_config.c" target="_blank">dump_cdorked_config.c</a></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a8a756b16ed279593704" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;span style="color: #3366ff;"&gt;// This program dumps the content of a shared memory block&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;// used by Linux/Cdorked.A into a file named httpd_cdorked_config.bin&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;// when the machine is infected.&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;//&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;// Some of the data is encrypted. If your server is infected and you&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;// would like to help, please send the httpd_cdorked_config.bin&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;// and your httpd executable to our lab for analysis. Thanks!&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;//&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;// Build with gcc -o dump_cdorked_config dump_cdorked_config.c&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;//&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;// Marc-Etienne M.Léveillé &amp;lt;leveille@eset.com&amp;gt;&lt;/span&gt;
&lt;span style="color: #3366ff;"&gt;//&lt;/span&gt;

#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;sys/shm.h&amp;gt;

#define CDORKED_SHM_SIZE (6118512)
#define CDORKED_OUTFILE "httpd_cdorked_config.bin"

int main (int argc, char *argv[]) {
    int maxkey, id, shmid, infected = 0;
    struct shm_info shm_info;
    struct shmid_ds shmds;
    void * cdorked_data;
    FILE * outfile;

    maxkey = shmctl(0, SHM_INFO, (void *) &amp;amp;shm_info);
    for(id = 0; id &amp;lt;= maxkey; id++) {
        shmid = shmctl(id, SHM_STAT, &amp;amp;shmds);
        if (shmid &amp;lt; 0)
            continue;

        if(shmds.shm_segsz == CDORKED_SHM_SIZE) {
            // We have a matching Cdorked memory segment
            infected++;
            printf("A shared memory matching Cdorked signature was found.\n");
            printf("You should check your HTTP server's executable file integrity.\n");

            cdorked_data = shmat(shmid, NULL, 0666);
            if(cdorked_data != NULL) {
                outfile = fopen(CDORKED_OUTFILE, "wb");
                if(outfile == NULL) {
                    printf("Could not open file %s for writing.", CDORKED_OUTFILE);
                }
                else {
                    fwrite(cdorked_data, CDORKED_SHM_SIZE, 1, outfile);
                    fclose(outfile);

                    printf("The Cdorked configuration was dumped in the %s file.\n\n", CDORKED_OUTFILE);
                }
            }
        }
    }
    if(infected == 0) {
        printf("No shared memory matching Cdorked signature was found.\n");
        printf("To further verify your server, run \"ipcs -m -p\" and look");
        printf(" for a memory segments created by your http server.\n");
    }
    else {
        printf("If you would like to help us in our research on Cdorked, ");
        printf("please send the httpd_cdorked_config.bin and your httpd executable file ");
        printf("to our lab for analysis at leveille@eset.com. Thanks!\n");
    }
    return infected;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-2">2</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-4">4</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-6">6</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-8">8</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-10">10</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-12">12</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-14">14</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-16">16</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-18">18</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-20">20</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-22">22</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-24">24</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-26">26</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-28">28</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-30">30</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-32">32</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-34">34</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-36">36</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-38">38</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-40">40</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-42">42</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-44">44</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-46">46</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-48">48</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-50">50</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-52">52</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-54">54</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-56">56</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-58">58</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-60">60</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-62">62</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a8a756b16ed279593704-64">64</div><div class="crayon-num" data-line="crayon-60a8a756b16ed279593704-65">65</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a8a756b16ed279593704-1"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">// This program dumps the content of a shared memory block&lt;/span&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-2"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">// used by Linux/Cdorked.A into a file named httpd_cdorked_config.bin&lt;/span&gt;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-3"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">// when the machine is infected.&lt;/span&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-4"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">//&lt;/span&gt;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-5"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">// Some of the data is encrypted. If your server is infected and you&lt;/span&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-6"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">// would like to help, please send the httpd_cdorked_config.bin&lt;/span&gt;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-7"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">// and your httpd executable to our lab for analysis. Thanks!&lt;/span&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-8"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">//&lt;/span&gt;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-9"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">// Build with gcc -o dump_cdorked_config dump_cdorked_config.c&lt;/span&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-10"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">//&lt;/span&gt;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-11"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">// Marc-Etienne M.Léveillé &amp;lt;leveille@eset.com&amp;gt;&lt;/span&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-12"><span class="crayon-o">&lt;</span><span class="crayon-e">span </span><span class="crayon-v">style</span><span class="crayon-o">=</span><span class="crayon-s">"color: #3366ff;"</span><span class="crayon-o">&gt;</span><span class="crayon-c">//&lt;/span&gt;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-14"><span class="crayon-p">#include &amp;lt;stdio.h&amp;gt;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-15"><span class="crayon-p">#include &amp;lt;sys/shm.h&amp;gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-16">&nbsp;</div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-17"><span class="crayon-p">#define CDORKED_SHM_SIZE (6118512)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-18"><span class="crayon-p">#define CDORKED_OUTFILE "httpd_cdorked_config.bin"</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-20"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">argc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">argv</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-21">   <span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">maxkey</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shmid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">infected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-22">   <span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">shm_info </span><span class="crayon-v">shm_info</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-23">   <span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">shmid_ds </span><span class="crayon-v">shmds</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-24">   <span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">cdorked_data</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-25">   <span class="crayon-h"> </span><span class="crayon-e ">FILE *</span><span class="crayon-h"> </span><span class="crayon-v">outfile</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-26">&nbsp;</div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-27">   <span class="crayon-h"> </span><span class="crayon-v">maxkey</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">shmctl</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">SHM_INFO</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-v">shm_info</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-28">   <span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">maxkey</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">id</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-29">       <span class="crayon-h"> </span><span class="crayon-v">shmid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">shmctl</span><span class="crayon-sy">(</span><span class="crayon-v">id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">SHM_STAT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-v">shmds</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-30">       <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">shmid</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-31">           <span class="crayon-h"> </span><span class="crayon-st">continue</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-32">&nbsp;</div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-33">       <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">shmds</span><span class="crayon-sy">.</span><span class="crayon-v">shm_segsz</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">CDORKED_SHM_SIZE</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-34">           <span class="crayon-h"> </span><span class="crayon-c">// We have a matching Cdorked memory segment</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-35">           <span class="crayon-h"> </span><span class="crayon-v">infected</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-36">           <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"A shared memory matching Cdorked signature was found.\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-37">           <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"You should check your HTTP server's executable file integrity.\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-38">&nbsp;</div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-39">           <span class="crayon-h"> </span><span class="crayon-v">cdorked_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">shmat</span><span class="crayon-sy">(</span><span class="crayon-v">shmid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">NULL</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0666</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-40">           <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">cdorked_data</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-t">NULL</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-41">               <span class="crayon-h"> </span><span class="crayon-v">outfile</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">fopen</span><span class="crayon-sy">(</span><span class="crayon-v">CDORKED_OUTFILE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"wb"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-42">               <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">outfile</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-t">NULL</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-43">                   <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"Could not open file %s for writing."</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">CDORKED_OUTFILE</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-44">               <span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-45">               <span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-46">                   <span class="crayon-h"> </span><span class="crayon-e">fwrite</span><span class="crayon-sy">(</span><span class="crayon-v">cdorked_data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">CDORKED_SHM_SIZE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outfile</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-47">                   <span class="crayon-h"> </span><span class="crayon-e">fclose</span><span class="crayon-sy">(</span><span class="crayon-v">outfile</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-48">&nbsp;</div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-49">                   <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"The Cdorked configuration was dumped in the %s file.\n\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">CDORKED_OUTFILE</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-50">               <span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-51">           <span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-52">       <span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-53">   <span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-54">   <span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">infected</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-55">       <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"No shared memory matching Cdorked signature was found.\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-56">       <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"To further verify your server, run \"ipcs -m -p\" and look"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-57">       <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">" for a memory segments created by your http server.\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-58">   <span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-59">   <span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-60">       <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"If you would like to help us in our research on Cdorked, "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-61">       <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"please send the httpd_cdorked_config.bin and your httpd executable file "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-62">       <span class="crayon-h"> </span><span class="crayon-e">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"to our lab for analysis at leveille@eset.com. Thanks!\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-63">   <span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a8a756b16ed279593704-64">   <span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">infected</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a8a756b16ed279593704-65"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                                            </div>
                                    <span class="strong">
								        <time datetime="2013-04-26 11:28:38">26 Apr 2013 - 11:28AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybersecurity/" class="category-tag-btn">Cybersecurity</a>                                                <a href="https://www.welivesecurity.com/2021/05/12/eset-research-rsa-conference-2021-presentations/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/05/eset-research-rsa2021-conference-preview-623x415.jpg"
                                                         alt="Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/05/12/eset-research-rsa-conference-2021-presentations/">
                                                    ESET Research goes to RSA Conference 2021 with two presentations                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/05/ousaban-banking-trojan-brazil-eset-research-623x415.jpg"
                                                         alt="Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/">
                                                    Ousaban: Private photo collection hidden in a CABinet                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/04/14/fbi-removes-malware-compromised-exchange-servers/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/fbi-removing-malware-exchange-server-623x415.jpg"
                                                         alt="Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/14/fbi-removes-malware-compromised-exchange-servers/">
                                                    FBI removes web shells from compromised Exchange servers                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/04/08/are-you-afreight-dark-watch-out-vyveva-new-lazarus-backdoor/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/lazarus-vyveva-backdoor-south-africa-623x432.jpg"
                                                         alt="Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/08/are-you-afreight-dark-watch-out-vyveva-new-lazarus-backdoor/">
                                                    (Are you) afreight of the dark? Watch out for Vyveva, new Lazarus backdoor                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F04%2F26%2Flinuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F04%2F26%2Flinuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2013%2F04%2F26%2Flinuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.2.0.adc7d1ec.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"20575 \/?p=20575","disqusShortname":"welivesecurity","disqusTitle":"Linux\/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole","disqusUrl":"https:\/\/www.welivesecurity.com\/2013\/04\/26\/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole\/","postId":"20575"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>