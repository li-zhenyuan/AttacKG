<!doctype html><html lang="en"><head><script defer src="https://cdn.optimizely.com/js/16180790160.js"></script><title data-rh="true">Reviving DDE: Using OneNote and Excel for Code Execution | by Matt Nelson | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2018-02-05T14:18:48.906Z"/><meta data-rh="true" name="title" content="Reviving DDE: Using OneNote and Excel for Code Execution | by Matt Nelson | Posts By SpecterOps Team Members"/><meta data-rh="true" property="og:title" content="Reviving DDE: Using OneNote and Excel for Code Execution"/><meta data-rh="true" property="twitter:title" content="Reviving DDE: Using OneNote and Excel for Code Execution"/><meta data-rh="true" name="twitter:site" content="@specterops"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/d7226864caee"/><meta data-rh="true" property="al:android:url" content="medium://p/d7226864caee"/><meta data-rh="true" property="al:ios:url" content="medium://p/d7226864caee"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="TL;DR: You can achieve DDE execution with Excel SpreadSheets embedded within OneNote. This bypasses the original Excel mitigation ruleset (Microsoft has released a patch to properly mitigate this) as…"/><meta data-rh="true" property="og:description" content="TL;DR: You can achieve DDE execution with Excel SpreadSheets embedded within OneNote. This bypasses the original Excel mitigation ruleset…"/><meta data-rh="true" property="twitter:description" content="TL;DR: You can achieve DDE execution with Excel SpreadSheets embedded within OneNote. This bypasses the original Excel mitigation ruleset…"/><meta data-rh="true" property="og:url" content="https://posts.specterops.io/reviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee"/><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/reviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/1*6u7RGKsRz1qMu-ep5OJjRw.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*6u7RGKsRz1qMu-ep5OJjRw.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@enigma0x3"/><meta data-rh="true" name="twitter:creator" content="@enigma0x3"/><meta data-rh="true" name="author" content="Matt Nelson"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="6 min read"/><meta data-rh="true" name="parsely-post-id" content="d7226864caee"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@enigma0x3"/><link data-rh="true" rel="canonical" href="https://enigma0x3.net/2018/01/29/reviving-dde-using-onenote-and-excel-for-code-execution/"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/d7226864caee"/><link data-rh="true" rel="icon" href="https://miro.medium.com/fit/c/256/256/1*D-FDlfkqivRBQZoESrwtqw.png"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*6u7RGKsRz1qMu-ep5OJjRw.png"],"url":"https:\u002F\u002Fposts.specterops.io\u002Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee","dateCreated":"2018-01-29T16:31:57.000Z","datePublished":"2018-01-29T16:31:57.000Z","dateModified":"2018-06-13T12:02:47.029Z","headline":"Reviving DDE: Using OneNote and Excel for Code Execution","name":"Reviving DDE: Using OneNote and Excel for Code Execution","description":"TL;DR: You can achieve DDE execution with Excel SpreadSheets embedded within OneNote. This bypasses the original Excel mitigation ruleset (Microsoft has released a patch to properly mitigate this) as…","identifier":"d7226864caee","keywords":["Lite:true","Tag:Excel","Tag:Red Team","Tag:Phishing","Tag:Office","Tag:Dde","Publication:specter-ops-posts","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:0"],"author":{"@type":"Person","name":"Matt Nelson","url":"https:\u002F\u002Fposts.specterops.io\u002F@enigma0x3"},"creator":["Matt Nelson"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":253,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F506\u002F1*aa0HsXZL43r95TuTJlJNPw.png"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee"}</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="507" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:25px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{position:absolute}.u{top:0}.v{left:0}.w{right:0}.x{z-index:500}.y{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ah{max-width:1192px}.ai{min-width:0}.aj{width:100%}.ak{height:65px}.an{flex:1 0 auto}.ao{fill:rgba(25, 25, 25, 1)}.ap{flex:0 0 auto}.aq{margin-left:16px}.ar{color:rgba(128, 128, 183, 1)}.as{fill:rgba(128, 128, 183, 1)}.at{font-size:inherit}.au{border:inherit}.av{font-family:inherit}.aw{letter-spacing:inherit}.ax{font-weight:inherit}.ay{padding:0}.az{margin:0}.bd:disabled{cursor:default}.be:disabled{color:rgba(163, 208, 162, 0.5)}.bf:disabled{fill:rgba(163, 208, 162, 0.5)}.bg{border-top:none}.bh{background-color:rgba(30, 24, 75, 1)}.bj{height:54px}.bk{overflow:hidden}.bl{margin-right:40px}.bm{height:36px}.bn{width:152px}.bo{overflow:auto}.bp{flex:0 1 auto}.bq{list-style-type:none}.br{line-height:40px}.bs{white-space:nowrap}.bt{overflow-x:auto}.bu{align-items:flex-start}.bv{margin-top:20px}.bw{padding-top:20px}.bx{height:80px}.by{height:20px}.bz{margin-right:15px}.ca{margin-left:15px}.cb:first-child{margin-left:0}.cc{min-width:1px}.cd{background-color:rgba(174, 174, 202, 1)}.ce{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.cf{font-size:13px}.cg{line-height:20px}.ch{color:rgba(235, 234, 250, 1)}.ci{text-transform:uppercase}.cj{letter-spacing:1px}.ck{color:inherit}.cl{fill:inherit}.co:disabled{color:rgba(195, 194, 219, 1)}.cp:disabled{fill:rgba(195, 194, 219, 1)}.cq{margin-bottom:0px}.cr{margin-top:0px}.cs{height:119px}.cv{padding-left:24px}.cw{padding-right:24px}.cx{margin-left:auto}.cy{margin-right:auto}.cz{max-width:728px}.da{box-sizing:border-box}.db{background:rgba(255, 255, 255, 1)}.dc{border:1px solid rgba(230, 230, 230, 1)}.dd{border-radius:4px}.de{box-shadow:0 1px 4px rgba(230, 230, 230, 1)}.df{max-height:100vh}.dg{overflow-y:auto}.dh{top:calc(100vh + 100px)}.di{bottom:calc(100vh + 100px)}.dj{width:10px}.dk{pointer-events:none}.dl{word-break:break-word}.dm{word-wrap:break-word}.dn:after{display:block}.do:after{content:""}.dp:after{clear:both}.dq{max-width:680px}.dr{line-height:1.23}.ds{letter-spacing:0}.dt{font-style:normal}.du{font-family:fell, Georgia, Cambria, "Times New Roman", Times, serif}.ep{margin-bottom:-0.27em}.eq{color:rgba(41, 41, 41, 1)}.er{margin-top:32px}.es{justify-content:space-between}.ew{border-radius:50%}.ex{height:48px}.ey{width:48px}.ez{margin-left:12px}.fa{font-size:14px}.fb{margin-bottom:2px}.fd{max-height:20px}.fe{text-overflow:ellipsis}.ff{display:-webkit-box}.fg{-webkit-line-clamp:1}.fh{-webkit-box-orient:vertical}.fk:disabled{color:rgba(117, 117, 117, 1)}.fl:disabled{fill:rgba(117, 117, 117, 1)}.fm{margin-left:8px}.fn{color:rgba(255, 255, 255, 1)}.fo{padding:0px 8px 1px}.fp{fill:rgba(255, 255, 255, 1)}.fq{background:rgba(128, 128, 183, 1)}.fr{border-color:rgba(128, 128, 183, 1)}.fu:disabled{cursor:inherit}.fv:disabled{opacity:0.3}.fw:disabled:hover{background:rgba(128, 128, 183, 1)}.fx:disabled:hover{border-color:rgba(128, 128, 183, 1)}.fy{border-radius:99em}.fz{border-width:1px}.ga{border-style:solid}.gb{display:inline-block}.gc{text-decoration:none}.gd{color:rgba(117, 117, 117, 1)}.ge{align-items:flex-end}.gm{padding-right:6px}.gp{fill:rgba(117, 117, 117, 1)}.gq{margin-right:8px}.gr{line-height:1.58}.gs{letter-spacing:-0.004em}.gt{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.ho{margin-bottom:-0.46em}.hp{text-decoration:underline}.hq{font-style:italic}.hr{max-width:1376px}.hx{clear:both}.hz{cursor:zoom-in}.ia{position:relative}.ib{z-index:auto}.id{max-width:100%}.ie{height:auto}.if{margin-top:10px}.ig{text-align:center}.ij{max-width:1022px}.ik{opacity:0}.il{transition:opacity 100ms 400ms}.im{height:100%}.in{will-change:transform}.io{transform:translateZ(0)}.ip{margin:auto}.iq{background-color:rgba(242, 242, 242, 1)}.ir{padding-bottom:33.268101761252446%}.is{height:0}.it{filter:blur(20px)}.iu{transform:scale(1.1)}.iv{visibility:visible}.iw{max-width:1196px}.ix{padding-bottom:57.85953177257525%}.iy{max-width:2448px}.iz{padding-bottom:38.48039215686275%}.ja{max-width:1412px}.jb{padding-bottom:55.949008498583574%}.jc{max-width:524px}.jd{padding-bottom:82.82442748091603%}.je{max-width:974px}.jf{padding-bottom:68.99383983572895%}.jg{max-width:1494px}.jh{padding-bottom:60.24096385542169%}.ji{max-width:1506px}.jj{padding-bottom:70.65073041168658%}.jk{max-width:800px}.jl{padding-bottom:62.5%}.jm{font-weight:700}.jn{margin-bottom:14px}.jo{padding-top:24px}.jp{padding-bottom:10px}.jq{background-color:rgba(8, 8, 8, 1)}.jr{height:3px}.js{width:3px}.jt{margin-right:20px}.ju{will-change:opacity}.jv{position:fixed}.jw{width:188px}.jx{left:50%}.jy{transform:translateX(406px)}.jz{top:calc(65px + 54px + 14px)}.kc{will-change:opacity, transform}.kd{transform:translateY(159px)}.kf{width:131px}.kg{flex-direction:column}.kh{font-weight:500}.ki{font-size:16px}.kj{padding-bottom:28px}.kk{border-bottom:1px solid rgba(230, 230, 230, 1)}.kl{padding-bottom:20px}.km{padding-top:2px}.kn{max-height:120px}.ko{-webkit-line-clamp:6}.kp{padding-top:28px}.kq{margin-bottom:19px}.kr{margin-left:-3px}.kx{outline:0}.ky{border:0}.kz{user-select:none}.la{cursor:pointer}.lb> svg{pointer-events:none}.ld{-webkit-user-select:none}.ln button{text-align:left}.lo{opacity:1}.lp{padding-right:4px}.lq{flex-direction:row}.lz{margin-top:40px}.ma{flex-wrap:wrap}.mb{margin-top:25px}.mc{margin-bottom:8px}.md{line-height:22px}.me{border-radius:3px}.mf{padding:5px 10px}.mg{background:rgba(242, 242, 242, 1)}.mh{max-width:155px}.ml{top:1px}.mt{margin-left:-1px}.nc{padding-right:8px}.nd{padding-top:32px}.ne{border-top:1px solid rgba(230, 230, 230, 1)}.nf{margin-bottom:25px}.nh{margin-bottom:32px}.ni{min-height:80px}.nn{width:80px}.no{padding-left:102px}.nq{line-height:18px}.nr{letter-spacing:0.077em}.ns{margin-bottom:6px}.nt{font-size:22px}.nu{line-height:28px}.nv{padding:4px 12px 6px}.nw{max-width:555px}.nx{max-width:450px}.ny{line-height:24px}.nz{display:none}.ob{max-width:550px}.oc{margin-top:5px}.od{height:40px}.oe{width:40px}.of{font-size:12px}.og{line-height:16px}.oh{letter-spacing:0.083em}.oi{padding-top:8px}.oj{margin-bottom:40px}.ok{margin-top:24px}.ol{padding-bottom:16px}.om{margin-bottom:24px}.qn{flex-grow:0}.qo{padding-bottom:24px}.qp{max-width:500px}.qt{padding-bottom:8px}.rg{padding-bottom:100%}.rr{padding:60px 0}.rs{background-color:rgba(0, 0, 0, 0.9)}.ru{padding-bottom:48px}.rv{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.rw{margin:0 -12px}.rx{margin:0 12px}.ry{flex:1 1 0}.sb:disabled{color:rgba(255, 255, 255, 0.7)}.sc:disabled{fill:rgba(255, 255, 255, 0.7)}.sd{font-size:20px}.se{color:rgba(255, 255, 255, 0.98)}.sf{color:rgba(255, 255, 255, 0.7)}.sg{height:22px}.sh{width:200px}.sn{margin-right:16px}.ba:hover{cursor:pointer}.bb:hover{color:rgba(110, 110, 154, 1)}.bc:hover{fill:rgba(110, 110, 154, 1)}.cm:hover{color:rgba(245, 244, 253, 1)}.cn:hover{fill:rgba(245, 244, 253, 1)}.fj:hover{text-decoration:underline}.fs:hover{background:rgba(110, 110, 154, 1)}.ft:hover{border-color:rgba(110, 110, 154, 1)}.gn:hover{color:rgba(25, 25, 25, 1)}.go:hover{fill:rgba(25, 25, 25, 1)}.lf:hover{fill:rgba(117, 117, 117, 1)}.rz:hover{color:rgba(255, 255, 255, 0.99)}.sa:hover{fill:rgba(255, 255, 255, 0.99)}.ic:focus{transform:scale(1.01)}.le:focus{fill:rgba(117, 117, 117, 1)}.lc:active{border-style:none}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ag{margin:0 64px}.el{font-size:48px}.em{margin-top:0.55em}.en{line-height:60px}.eo{letter-spacing:-0.011em}.gl{margin-left:30px}.hk{font-size:21px}.hl{margin-top:2em}.hm{line-height:32px}.hn{letter-spacing:-0.003em}.hw{margin-top:56px}.kw{margin-right:5px}.lm{margin-top:5px}.ly{padding-left:6px}.mn{display:inline-block}.ms{width:8px}.na{padding-left:7px}.nb{top:3px}.pb{font-size:22px}.pc{line-height:28px}.pd{letter-spacing:0}.pq{width:calc(100% + 32px)}.pr{margin-left:-16px}.ps{margin-right:-16px}.qj{padding-left:16px}.qk{padding-right:16px}.ql{flex-basis:25%}.qm{max-width:25%}.rc{font-size:16px}.rd{line-height:20px}.rp{min-width:70px}.rq{min-height:70px}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.gk{margin-left:30px}.ih{margin-left:auto}.ii{text-align:center}.kv{margin-right:5px}.ll{margin-top:5px}.lx{padding-left:6px}.mm{display:inline-block}.mr{width:8px}.my{padding-left:7px}.mz{top:3px}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.gj{margin-left:30px}.ku{margin-right:5px}.lk{margin-top:5px}.lv{padding-left:6px}.lw{top:3px}.mk{display:inline-block}.mq{width:8px}.mx{padding-left:3px}.qs{margin-right:16px}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.al{height:56px}.am{display:flex}.bi{display:block}.ct{margin-bottom:0px}.cu{height:110px}.eu{margin-top:32px}.ev{flex-direction:column-reverse}.gh{margin-bottom:30px}.gi{margin-left:0px}.kt{margin-left:8px}.li{margin-top:2px}.lj{margin-right:8px}.lt{padding-left:6px}.lu{top:3px}.mj{display:inline-block}.mp{width:8px}.mu{margin-left:-4px}.mw{padding-left:3px}.ng{padding-top:0}.nj{margin-bottom:24px}.nk{align-items:center}.nl{width:102px}.nm{position:relative}.np{padding-left:0}.oa{margin-top:24px}.on{padding-bottom:12px}.oo{margin-top:16px}.qr{margin-right:16px}.re{margin-left:16px}.rf{margin-right:0px}.rt{padding:32px 0}.si{width:140px}.sj{margin-bottom:16px}.sk{margin-top:30px}.sl{width:100%}.sm{flex-direction:row}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ab{margin:0 24px}.dv{font-size:34px}.dw{margin-top:0.56em}.dx{line-height:42px}.dy{letter-spacing:-0.016em}.et{margin-top:32px}.fc{margin-bottom:0px}.gf{margin-bottom:30px}.gg{margin-left:0px}.gu{font-size:18px}.gv{margin-top:1.56em}.gw{line-height:28px}.gx{letter-spacing:-0.003em}.hs{margin-top:40px}.ks{margin-left:8px}.lg{margin-top:2px}.lh{margin-right:8px}.lr{padding-left:6px}.ls{top:3px}.mi{display:inline-block}.mo{width:8px}.mv{padding-left:3px}.op{font-size:20px}.oq{line-height:24px}.or{letter-spacing:0}.pe{width:calc(100% + 24px)}.pf{margin-left:-12px}.pg{margin-right:-12px}.pt{padding-left:12px}.pu{padding-right:12px}.pv{flex-basis:100%}.pw{max-width:100%}.qq{margin-right:16px}.qu{font-size:16px}.qv{line-height:20px}.rh{min-width:48px}.ri{min-height:48px}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.af{margin:0 64px}.eh{font-size:48px}.ei{margin-top:0.55em}.ej{line-height:60px}.ek{letter-spacing:-0.011em}.hg{font-size:21px}.hh{margin-top:2em}.hi{line-height:32px}.hj{letter-spacing:-0.003em}.hv{margin-top:56px}.oy{font-size:22px}.oz{line-height:28px}.pa{letter-spacing:0}.pn{width:calc(100% + 32px)}.po{margin-left:-16px}.pp{margin-right:-16px}.qf{padding-left:16px}.qg{padding-right:16px}.qh{flex-basis:25%}.qi{max-width:25%}.ra{font-size:16px}.rb{line-height:20px}.rn{min-width:70px}.ro{min-height:70px}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.ae{margin:0 48px}.ed{font-size:48px}.ee{margin-top:0.55em}.ef{line-height:60px}.eg{letter-spacing:-0.011em}.hc{font-size:21px}.hd{margin-top:2em}.he{line-height:32px}.hf{letter-spacing:-0.003em}.hu{margin-top:56px}.ov{font-size:22px}.ow{line-height:28px}.ox{letter-spacing:0}.pk{width:calc(100% + 28px)}.pl{margin-left:-14px}.pm{margin-right:-14px}.qb{padding-left:14px}.qc{padding-right:14px}.qd{flex-basis:50%}.qe{max-width:50%}.qy{font-size:16px}.qz{line-height:20px}.rl{min-width:48px}.rm{min-height:48px}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ac{margin:0 24px}.dz{font-size:34px}.ea{margin-top:0.56em}.eb{line-height:42px}.ec{letter-spacing:-0.016em}.gy{font-size:18px}.gz{margin-top:1.56em}.ha{line-height:28px}.hb{letter-spacing:-0.003em}.ht{margin-top:40px}.os{font-size:20px}.ot{line-height:24px}.ou{letter-spacing:0}.ph{width:calc(100% + 24px)}.pi{margin-left:-12px}.pj{margin-right:-12px}.px{padding-left:12px}.py{padding-right:12px}.pz{flex-basis:100%}.qa{max-width:100%}.qw{font-size:16px}.qx{line-height:20px}.rj{min-width:48px}.rk{min-height:48px}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="print">.z{display:none}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.fi{max-height:none}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.hy{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.ka{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (max-width: 1230px)">.kb{display:none}</style><style type="text/css" data-fela-rehydration="507" data-fela-type="RULE" media="all and (max-width: 1198px)">.ke{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="s"><nav class="s t u v w c x y z"><div><div class="s c"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="ak n o al am"><div class="n o an x"><a href="https://medium.com/?source=post_page-----d7226864caee--------------------------------" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q ao"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div><div class="s ap x"><div class="n o"><div class="n o g"><div class="aq s"><span><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;source=post_page-----d7226864caee---------------------nav_reg-----------" class="ar as at au av aw ax ay az ba bb bc bd be bf" rel="noopener">Sign in</a></span></div></div></div></div></div></div></div></div><div class="bg s bh bi"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="bj bk n o"><div class="bl s ap"><a href="https://posts.specterops.io/?source=post_page-----d7226864caee--------------------------------" rel="noopener"><div class="bm bn s"><img alt="Posts By SpecterOps Team Members" class="" src="https://miro.medium.com/max/304/1*aa0HsXZL43r95TuTJlJNPw.png" width="152" height="36"/></div></a></div><div class="bo s bp"><ul class="bq az br bs bt n bu g bv bw bx"><li class="n o by bz ca cb"><span class="ce b cf cg ch ci cj"><a href="https://posts.specterops.io/about?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba cm cn bd co cp" rel="noopener">About</a></span></li><li class="n o by bz ca cb"><span class="ce b cf cg ch ci cj"><a href="https://posts.specterops.io/archive?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba cm cn bd co cp" rel="noopener">All Posts</a></span></li><span class="by cc cd"></span><li class="n o by bz ca cb"><span class="ce b cf cg ch ci cj"><a href="https://www.specterops.io/?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba cm cn bd co cp" rel="noopener">specterops.io</a></span></li></ul></div></div></div></div></div></div></nav><div class="cq cr cs s ct cu"></div><article><section class="cv cw cx cy aj cz da s"></section><span class="s"></span><div><div class="t v dh di dj dk"></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><div class=""><h1 id="c771" class="dr ds dt du b dv dw dx dy dz ea eb ec ed ee ef eg eh ei ej ek el em en eo ep eq">Reviving DDE: Using OneNote and Excel for Code Execution</h1><div class="er"><div class="n es et eu ev"><div class="o n"><div><a href="https://medium.com/@enigma0x3?source=post_page-----d7226864caee--------------------------------" rel="noopener"><img alt="Matt Nelson" class="s ew ex ey" src="https://miro.medium.com/fit/c/96/96/0*6mGXmQSDMYyKuVUK.jpg" width="48" height="48"/></a></div><div class="ez aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="fb n o fc"><span class="ce b fa cg bk fd fe ff fg fh fi eq"><a href="https://medium.com/@enigma0x3?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Matt Nelson</a></span><div class="fm s ap h"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;user=Matt%20Nelson&amp;userId=1bb43103a9a9&amp;source=post_page-1bb43103a9a9----d7226864caee---------------------follow_byline-----------" class="ce b cf cg fn fo fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div></span></div></div><span class="ce b fa cg gd"><span class="ce b fa cg bk fd fe ff fg fh fi gd"><div><a class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener" href="/reviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee?source=post_page-----d7226864caee--------------------------------">Jan 29, 2018</a> <!-- -->·<!-- --> <!-- -->6<!-- --> min read</div></span></span></div></div><div class="n ge gf gg gh gi gj gk gl z"><div class="n o"><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on twitter"><svg width="29" height="29" class="gp"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gp"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on facebook"><svg width="29" height="29" class="gp"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="gq s"><div class="gp"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7226864caee&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;source=post_actions_header--------------------------bookmark_preview-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div><div class="s an"></div></div></div></div></div></div><p id="8f08" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">TL;DR: You can achieve DDE execution with Excel SpreadSheets embedded within OneNote. This bypasses the original Excel mitigation ruleset (Microsoft has released a patch to properly mitigate this) as well as the Protected View sandbox 🙂</p><p id="7312" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq"><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms648774(v=vs.85).aspx" class="ck hp" rel="noopener">Dynamic Data Exchange (DDE)</a> has been a hot topic as of late. For those unfamiliar with DDE, it is designed to transfer data between two applications. In 2014, Contextis put out a nice blog post on <a href="https://www.contextis.com/blog/comma-separated-vulnerabilities" class="ck hp" rel="noopener">using DDE in Microsoft Excel</a> for code execution by utilizing the “=DDE()” formula.</p><p id="016e" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Then, on October 9th 2017, SensePost released a <a href="https://sensepost.com/blog/2017/macro-less-code-exec-in-msword/" class="ck hp" rel="noopener">really great blog</a> post on abusing the DDEAUTO field code in Microsoft Word to get code execution. Shortly after, various malware families adopted the technique and it was quickly seen in the wild.</p><p id="11e4" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">After seeing a spike in malicious use, Will Dormann (<a href="https://twitter.com/wdormann" class="ck hp" rel="noopener">@wdormann</a>) of US-CERT published some registry changes that would widely mitigate most DDE threats. These changes disabled DDE and prevented links from automatically updating for Word and Excel. Will added a OneNote block after sharing the details outlined below with him privately. Unfortunately the only fix was to completely kill embedded files, which is less than ideal. You can find these registry changes here: <a href="https://gist.github.com/wdormann/732bb88d9b5dd5a66c9f1e1498f31a1b" class="ck hp" rel="noopener">https://gist.github.com/wdormann/732bb88d9b5dd5a66c9f1e1498f31a1b</a></p><p id="1fee" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">This guidance was really helpful to those dealing with actors using DDE techniques more and more. Then, on November 8th 2017, Microsoft published <a href="https://docs.microsoft.com/en-us/security-updates/securityadvisories/2017/4053440" class="ck hp" rel="noopener">an official post</a> that outlines mitigating the DDE threat for those who don’t use the protocol in their environment, which was released under Advisory <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170021" class="ck hp" rel="noopener">ADV170021</a> with additional documentation <a href="https://docs.microsoft.com/en-us/security-updates/securityadvisories/2017/4053440" class="ck hp" rel="noopener">here</a>. These mitigations were largely just for Word and it involved preventing any execution entirely as opposed to stopping automatic link updating. In addition to this post, <a href="https://www.theregister.co.uk/2017/10/17/microsoft_dde_attacks/" class="ck hp" rel="noopener">Microsoft also stated</a> that <em class="hq">Protected View</em> will prevent automatic DDE execution and that users should open untrusted documents with caution.</p><p id="c464" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">After seeing these new DDE mitigation recommendations, I became curious how these were handled when executed from within a different Office application, such as Publisher or OneNote. At the time, Will Dormann’s <a href="https://gist.github.com/wdormann/732bb88d9b5dd5a66c9f1e1498f31a1b" class="ck hp" rel="noopener">gist </a>was the only source for mitigation options in other Office apps (such as Excel) as Microsoft only released official guidance for Word.</p><p id="d60e" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So, why OneNote? Well, it allows a user to embed Excel spreadsheets into a note document and then save it. This provides the end user the ability to reference or use Excel features directly within OneNote. As you may know, you can abuse DDE in Excel to get code execution! Ideally, Will’s Excel registry changes to stop DDE attacks would apply to any Excel sheets embedded in OneNote. Unfortunately, this wasn’t the case.</p><p id="e9ff" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">When implementing Will’s Excel registry change (specifically “DDEAllowed” set to DWORD 0), you will see something like this when opening a spreadsheet that contains a DDE formula:</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy hr"><img alt="" class="aj id ie" src="https://miro.medium.com/max/2752/1*1kKktvOkRD_LMxb4DGXI4w.png" width="1376" height="750" role="presentation"/></div></div><figcaption class="if ig cz cx cy ih ii ce b fa cg gd">Excel DDE Blocked via Registry Mitigations</figcaption></figure><p id="e92d" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So, the Excel DDE block is working as expected. Now, let’s look at OneNote. In order to utilize the Excel functionality in OneNote, you can go to “SpreadSheet” under the “Files” tab and either import an existing Excel Spreadsheet or create a new one.</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy ij"><div class="ip s ia iq"><div class="ir is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*vZlCAVYV2z9bF9prE2mXrw.png?q=20" width="1022" height="340" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="1022" height="340" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/2044/1*vZlCAVYV2z9bF9prE2mXrw.png" width="1022" height="340" srcSet="https://miro.medium.com/max/552/1*vZlCAVYV2z9bF9prE2mXrw.png 276w, https://miro.medium.com/max/1104/1*vZlCAVYV2z9bF9prE2mXrw.png 552w, https://miro.medium.com/max/1280/1*vZlCAVYV2z9bF9prE2mXrw.png 640w, https://miro.medium.com/max/1400/1*vZlCAVYV2z9bF9prE2mXrw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="aa18" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So, OneNote allows us to import an existing spreadsheet. What happens if we import a DDE-laced spreadsheet? First, we need to create it. Ryan Hanson (<a href="https://twitter.com/ryhanson" class="ck hp" rel="noopener">@ryhanson</a>) put out a tweet showing that you can manipulate the warning box during DDE execution and change the binary name. This can be helpful as you can change it to something like “MSEXCEL.exe” instead of displaying “cmd.exe” or “powershell.exe”.</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy iw"><div class="ip s ia iq"><div class="ix is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*VHmBQNv5soO5vOhu3u0Btw.png?q=20" width="1196" height="692" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="1196" height="692" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/2392/1*VHmBQNv5soO5vOhu3u0Btw.png" width="1196" height="692" srcSet="https://miro.medium.com/max/552/1*VHmBQNv5soO5vOhu3u0Btw.png 276w, https://miro.medium.com/max/1104/1*VHmBQNv5soO5vOhu3u0Btw.png 552w, https://miro.medium.com/max/1280/1*VHmBQNv5soO5vOhu3u0Btw.png 640w, https://miro.medium.com/max/1400/1*VHmBQNv5soO5vOhu3u0Btw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="if ig cz cx cy ih ii ce b fa cg gd">Source: <a href="https://twitter.com/ryHanson/status/918598525792935936" class="ck hp" rel="noopener">https://twitter.com/ryHanson/status/918598525792935936</a></figcaption></figure><p id="d2da" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">After adding that formula to an Excel spreadsheet and saving it, we can now test it to ensure it displays properly. To do so, I have removed the Excel DDE mitigation registry changes.</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy iy"><div class="ip s ia iq"><div class="iz is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*QREbLhYr6MZmd7czNEGzUA.png?q=20" width="2448" height="942" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="2448" height="942" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/4896/1*QREbLhYr6MZmd7czNEGzUA.png" width="2448" height="942" srcSet="https://miro.medium.com/max/552/1*QREbLhYr6MZmd7czNEGzUA.png 276w, https://miro.medium.com/max/1104/1*QREbLhYr6MZmd7czNEGzUA.png 552w, https://miro.medium.com/max/1280/1*QREbLhYr6MZmd7czNEGzUA.png 640w, https://miro.medium.com/max/1400/1*QREbLhYr6MZmd7czNEGzUA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="if ig cz cx cy ih ii ce b fa cg gd">Execution without registry mitigations applied</figcaption></figure><p id="bda8" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Great, so it works. Next, let’s test it with Will’s Excel registry changes applied:</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy ja"><div class="ip s ia iq"><div class="jb is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*Re5LS3slFzaw--sXC4UJ5w.png?q=20" width="1412" height="790" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="1412" height="790" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/2824/1*Re5LS3slFzaw--sXC4UJ5w.png" width="1412" height="790" srcSet="https://miro.medium.com/max/552/1*Re5LS3slFzaw--sXC4UJ5w.png 276w, https://miro.medium.com/max/1104/1*Re5LS3slFzaw--sXC4UJ5w.png 552w, https://miro.medium.com/max/1280/1*Re5LS3slFzaw--sXC4UJ5w.png 640w, https://miro.medium.com/max/1400/1*Re5LS3slFzaw--sXC4UJ5w.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="if ig cz cx cy ih ii ce b fa cg gd">Excel DDE Blocked via Registry Mitigations</figcaption></figure><p id="1933" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Awesome, so these changes do indeed block the Excel DDE POC that we have just created. Now that we have our DDE spreadsheet ready and tested, we can import it into OneNote by going to “Insert-&gt;SpreadSheet-&gt;Existing Excel SpreadSheet”</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy ij"><div class="ip s ia iq"><div class="ir is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*vZlCAVYV2z9bF9prE2mXrw.png?q=20" width="1022" height="340" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="1022" height="340" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/2044/1*vZlCAVYV2z9bF9prE2mXrw.png" width="1022" height="340" srcSet="https://miro.medium.com/max/552/1*vZlCAVYV2z9bF9prE2mXrw.png 276w, https://miro.medium.com/max/1104/1*vZlCAVYV2z9bF9prE2mXrw.png 552w, https://miro.medium.com/max/1280/1*vZlCAVYV2z9bF9prE2mXrw.png 640w, https://miro.medium.com/max/1400/1*vZlCAVYV2z9bF9prE2mXrw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="749a" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">OneNote will ask you to browse to the file you want to import, which will be the previously created DDE laced spreadsheet. Next, it will ask you if you want to attach the file or insert the spreadsheet. We will do “Insert SpreadSheet”</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div class="cx cy jc"><div class="ip s ia iq"><div class="jd is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*kbPKGu5tLDzEcPrDkBsSuQ.png?q=20" width="524" height="434" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="524" height="434" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/1048/1*kbPKGu5tLDzEcPrDkBsSuQ.png" width="524" height="434" srcSet="https://miro.medium.com/max/552/1*kbPKGu5tLDzEcPrDkBsSuQ.png 276w, https://miro.medium.com/max/1048/1*kbPKGu5tLDzEcPrDkBsSuQ.png 524w" sizes="524px" role="presentation"/></noscript></div></div></div></figure><p id="547d" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">OneNote will then import the spreadsheet and during that process, it will attempt to execute your DDE command. To prevent that, simply click “No”</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy je"><div class="ip s ia iq"><div class="jf is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*JoIxldlAIt5Vz9T9MXbSxg.png?q=20" width="974" height="672" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="974" height="672" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/1948/1*JoIxldlAIt5Vz9T9MXbSxg.png" width="974" height="672" srcSet="https://miro.medium.com/max/552/1*JoIxldlAIt5Vz9T9MXbSxg.png 276w, https://miro.medium.com/max/1104/1*JoIxldlAIt5Vz9T9MXbSxg.png 552w, https://miro.medium.com/max/1280/1*JoIxldlAIt5Vz9T9MXbSxg.png 640w, https://miro.medium.com/max/1400/1*JoIxldlAIt5Vz9T9MXbSxg.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="if ig cz cx cy ih ii ce b fa cg gd">Importing weaponized Excel Sheet</figcaption></figure><p id="c612" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Finally, save the OneNote file. At this point, that OneNote file has a DDE laced Excel SpreadSheet directly embedded in it. Now, let’s see what happens when the Excel SpreadSheet is accessed from within the OneNote file with the Excel DDE mitigation registry changes in place:</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy jg"><div class="ip s ia iq"><div class="jh is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*ZGaQiZnYAPwZgR4ukQLHEw.png?q=20" width="1494" height="900" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="1494" height="900" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/2988/1*ZGaQiZnYAPwZgR4ukQLHEw.png" width="1494" height="900" srcSet="https://miro.medium.com/max/552/1*ZGaQiZnYAPwZgR4ukQLHEw.png 276w, https://miro.medium.com/max/1104/1*ZGaQiZnYAPwZgR4ukQLHEw.png 552w, https://miro.medium.com/max/1280/1*ZGaQiZnYAPwZgR4ukQLHEw.png 640w, https://miro.medium.com/max/1400/1*ZGaQiZnYAPwZgR4ukQLHEw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="if ig cz cx cy ih ii ce b fa cg gd">DDE execution despite Excel registry changes</figcaption></figure><p id="da6f" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Clicking “Yes” results in the command being executed:</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy ji"><div class="ip s ia iq"><div class="jj is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*6u7RGKsRz1qMu-ep5OJjRw.png?q=20" width="1506" height="1064" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="1506" height="1064" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/3012/1*6u7RGKsRz1qMu-ep5OJjRw.png" width="1506" height="1064" srcSet="https://miro.medium.com/max/552/1*6u7RGKsRz1qMu-ep5OJjRw.png 276w, https://miro.medium.com/max/1104/1*6u7RGKsRz1qMu-ep5OJjRw.png 552w, https://miro.medium.com/max/1280/1*6u7RGKsRz1qMu-ep5OJjRw.png 640w, https://miro.medium.com/max/1400/1*6u7RGKsRz1qMu-ep5OJjRw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="if ig cz cx cy ih ii ce b fa cg gd">DDE execution despite Excel registry changes</figcaption></figure><p id="0bbf" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So, despite blocking DDE in Excel via “DDEAllowed”, the functionality is still there when accessed through OneNote. After chatting with Will Dormann, the only working mitigation is to set “DisableEmbeddedFiles” to 1. This obviously kills all file embedding functionality as a side-effect, which isn’t great for usability.</p><p id="240b" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">As mentioned above, one of Microsoft’s statements notes that <em class="hq">Protected View</em> will prevent the DDE vectors when originating from an untrusted source (such as the internet). This is the case for most Office applications as any content originating from an untrusted source is opened in a sandbox first. OneNote, however, is not enrolled in <em class="hq">Protected View </em>and will not trigger it when pulled from the internet.</p><p id="4343" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">If a user has OneNote installed, an attacker can embed a weaponized Excel spreadsheet into a OneNote file and send it to a victim via a weblink or an email attachment. When the user receives the OneNote file and opens the embedded spreadsheet, it will not open in <em class="hq">Protected View</em> and they will simply be presented with the DDE prompt (which you can tamper with as demonstrated above):</p><figure class="hs ht hu hv hw hx cx cy paragraph-image"><div role="button" tabindex="0" class="hy hz ia ib aj ic"><div class="cx cy jk"><div class="ip s ia iq"><div class="jl is s"><div class="ik il t u v im aj bk in io"><img alt="" class="t u v im aj it iu iv" src="https://miro.medium.com/freeze/max/60/1*Dj6BrDpvO9juS8lm88wrFA.gif?q=20" width="800" height="500" role="presentation"/></div><img alt="" class="ik il t u v im aj c" width="800" height="500" role="presentation"/><noscript><img alt="" class="t u v im aj" src="https://miro.medium.com/max/1600/1*Dj6BrDpvO9juS8lm88wrFA.gif" width="800" height="500" srcSet="https://miro.medium.com/max/552/1*Dj6BrDpvO9juS8lm88wrFA.gif 276w, https://miro.medium.com/max/1104/1*Dj6BrDpvO9juS8lm88wrFA.gif 552w, https://miro.medium.com/max/1280/1*Dj6BrDpvO9juS8lm88wrFA.gif 640w, https://miro.medium.com/max/1400/1*Dj6BrDpvO9juS8lm88wrFA.gif 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div><figcaption class="if ig cz cx cy ih ii ce b fa cg gd">Demo of DDE execution from the internet (bypassing Protected View sandbox)</figcaption></figure><p id="e7e2" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq"><strong class="gt jm">*It should be noted that the <em class="hq">Protected View</em> aspect was reported to MSRC on April 20th, 2017 and it was deemed not a security issue.</strong></p><p id="9b14" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">So, what can you do? Well, at the time, the only mitigation was to completely kill embedding in OneNote. This was reported to Microsoft on October 10th of 2017 and on January 9th, 2018 they pushed out an update to all Office versions going back to 2007. The Excel update was added to the already existing Advisory <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170021" class="ck hp" rel="noopener">ADV170021</a>, in which that advisory now details how to implement mitigations for both Excel and Word (since it was previously only Word that was available). Additional documentation can be found <a href="https://docs.microsoft.com/en-us/security-updates/securityadvisories/2017/4053440" class="ck hp" rel="noopener">here</a>.</p><p id="b8cd" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">This update created a value you can add under Microsoft Excel’s security options in the registry. By setting “DisableDDEServerLaunch” to DWORD 1, DDE will effectively be neutered for Excel. This is important because OneNote itself wasn’t entirely interesting. It was the embedded Excel functionality that made this attack work. By adding mitigation options for Excel, users can protect themselves from this attack.</p><p id="012a" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">Additionally, you can employ Attack Surface Reduction (ASR) rules in Windows 10 1709 to prevent not only DDE attacks, but other attacks where an Office program is spawning a child process. You can read more on ASR <a href="https://docs.microsoft.com/en-us/windows/threat-protection/windows-defender-exploit-guard/enable-attack-surface-reduction" class="ck hp" rel="noopener">here</a>.</p><p id="b622" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq">-Matt N.</p></div></div></section><div class="n p er jn jo jp" role="separator"><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js jt"></span><span class="jq ew gb jr js"></span></div><section class="dl dm dn do dp"><div class="n p"><div class="ab ac ae af ag dq ai aj"><p id="1090" class="gr gs dt gt b gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho dl eq"><em class="hq">Originally published at </em><a href="https://enigma0x3.net/2018/01/29/reviving-dde-using-onenote-and-excel-for-code-execution/" class="ck hp" rel="noopener"><em class="hq">enigma0x3.net</em></a><em class="hq"> on January 29, 2018.</em></p></div></div></section></div></article><div class="ik dk jv kc aj kd u ka ke" data-test-id="post-sidebar"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="kf n kg"><div class="dk"><div><div class="kj kk s"><a href="https://posts.specterops.io/?source=post_sidebar--------------------------post_sidebar-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><h2 class="ce kh ki cg ds eq dl">Posts By SpecterOps Team Members</h2></a><div class="kl km s"><p class="ce b fa cg bk kn fe ff ko fh fi gd">Posts from SpecterOps team members on various topics…</p></div></div><div class="kp kq kr n"><div class="n o"><div class="s ia ks kt ku kv kw"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fd7226864caee&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;user=Matt%20Nelson&amp;userId=1bb43103a9a9&amp;source=post_sidebar-----d7226864caee---------------------clap_sidebar-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><div class="ay kx ky kz la lb lc ld r le lf"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s lg lh li lj lk ll lm"><div class="ln"><p class="ce b fa cg gd"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl">95<!-- --> </button></p></div></div></div></div><div class="kq s"><button class="la ky ay"><div class="lp n o lq"><svg width="25" height="25" class="r lo la lf" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s ia lr ls lt lu lv lw lx ly"></div></div></button></div><div class="gp"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7226864caee&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;source=post_sidebar-----d7226864caee---------------------bookmark_sidebar-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div></div></div><div class="ik dk ju jv jw jx jy jz ka kb"></div><div><div class="lz hx n kg p"><div class="n p"><div class="ab ac ae af ag dq ai aj"><div class="n ma"></div><div class="n o ma"></div><div class="mb s"><ul class="ay az"><li class="gb bq gq mc"><a href="/tagged/excel" class="ce b cf md gd me mf gc s mg">Excel</a></li><li class="gb bq gq mc"><a href="/tagged/red-team" class="ce b cf md gd me mf gc s mg">Red Team</a></li><li class="gb bq gq mc"><a href="/tagged/phishing" class="ce b cf md gd me mf gc s mg">Phishing</a></li><li class="gb bq gq mc"><a href="/tagged/office" class="ce b cf md gd me mf gc s mg">Office</a></li><li class="gb bq gq mc"><a href="/tagged/dde" class="ce b cf md gd me mf gc s mg">Dde</a></li></ul></div><div class="mb n es z"><div class="n o lq"><div class="mh s"><span class="s mi mj mk e d"><div class="n o"><div class="s ia ks kt ku kv kw"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fd7226864caee&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;user=Matt%20Nelson&amp;userId=1bb43103a9a9&amp;source=post_actions_footer-----d7226864caee---------------------clap_footer-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><div class="ay kx ky kz la lb lc ld r le lf"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s lg lh li lj lk ll lm"><div class="ia ml ln"><p class="ce b fa cg eq"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl">95<span class="s h g f mm mn"> <!-- -->claps</span></button><span class="s h g f mm mn"></span></p></div></div></div></span><span class="s h g f mm mn"><div class="n o"><div class="s ia ks kt ku kv kw"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fd7226864caee&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;user=Matt%20Nelson&amp;userId=1bb43103a9a9&amp;source=post_actions_footer-----d7226864caee---------------------clap_footer-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><div class="ay kx ky kz la lb lc ld r le lf"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s lg lh li lj lk ll lm"><div class="ln"><p class="ce b fa cg gd"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl">95<!-- --> </button></p></div></div></div></span></div><div class="s mo mp mq mr ms"></div><button class="la ky ay"><div class="lp n o lq"><span class="mt s mu"><svg width="25" height="25" class="r lo la lf" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span><div class="s ia mv ls mw lu mx lw my mz na nb"></div></div></button></div><div class="n o"><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on twitter"><svg width="29" height="29" class="gp"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gp"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gm s ap"><button class="ck cl at au av aw ax ay az ba gn go bd fk fl" aria-label="Share on facebook"><svg width="29" height="29" class="gp"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="nc s ap"><div class="gp"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd7226864caee&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;source=post_actions_footer--------------------------bookmark_footer-----------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div></div><div><div class="n p"><div class="ab ac ae af ag dq ai aj"><div class="nd ne nf mb s ng z"><div class="s g"><div class="nh ni s ia"><span class="s nj am nk"><div class="s t nl nm"><a href="https://medium.com/@enigma0x3?source=follow_footer-------------------------------------" rel="noopener"><img alt="Matt Nelson" class="s ew bx nn" src="https://miro.medium.com/fit/c/160/160/0*6mGXmQSDMYyKuVUK.jpg" width="80" height="80"/></a></div><span class="s"><div class="no s np"><p class="ce b cf nq nr gd ci">Written by</p></div><div class="no ns n np"><div class="aj n o es"><h2 class="ce kh nt nu ds eq"><a href="https://medium.com/@enigma0x3?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Matt Nelson</a></h2><div class="s g"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9%2Fd7226864caee&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;user=Matt%20Nelson&amp;userId=1bb43103a9a9&amp;source=follow_footer-1bb43103a9a9-------------------------follow_footer-----------" class="ce b fa cg fn nv fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div></div></span></span><div class="no nw s np bi"><div class="nx s"><p class="ce b ki ny gd">Red Teamer | Security Researcher | Enjoys abusing features | Tweets are my own | http://github.com/enigma0x3</p></div><div class="nz oa bi"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9%2Fd7226864caee&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;user=Matt%20Nelson&amp;userId=1bb43103a9a9&amp;source=follow_footer-1bb43103a9a9-------------------------follow_footer-----------" class="ce b fa cg fn nv fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div></div><div class="nd s"></div><div class="nh ni s ia"><span class="s nj am nk"><div class="s t nl nm"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" rel="noopener"><img alt="Posts By SpecterOps Team Members" class="dd nn bx" src="https://miro.medium.com/fit/c/160/160/1*D-FDlfkqivRBQZoESrwtqw.png" width="80" height="80"/></a></div><span class="s"><div class="no ns n np"><div class="aj n o es"><h2 class="ce kh nt nu ds eq"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></h2><div class="s g"></div></div></div></span></span><div class="no ob s np bi"><div class="nx s"><p class="ce b ki ny gd">Posts from SpecterOps team members on various topics relating information security</p></div><div class="nz oa bi"></div></div></div></div><div class="nz bi"><div class="jo s"><div class="n lq"><div class="oc s"><a href="https://medium.com/@enigma0x3?source=follow_footer-------------------------------------" rel="noopener"><img alt="Matt Nelson" class="s ew od oe" src="https://miro.medium.com/fit/c/80/80/0*6mGXmQSDMYyKuVUK.jpg" width="40" height="40"/></a></div><div class="ez s"><p class="ce b of og oh gd ci">Written by</p><div class="n lq"><h2 class="ce kh ki cg ds eq"><a href="https://medium.com/@enigma0x3?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Matt Nelson</a></h2><div class="ez s"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F1bb43103a9a9%2Fd7226864caee&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee&amp;user=Matt%20Nelson&amp;userId=1bb43103a9a9&amp;source=follow_footer-1bb43103a9a9-------------------------follow_footer-----------" class="ce b cf cg fn fo fp fq fr fs ft ba fu fv fw fx fy fz ga da gb gc" rel="noopener">Follow</a></span></div></div><div class="oi s"><p class="ce b fa cg gd">Red Teamer | Security Researcher | Enjoys abusing features | Tweets are my own | http://github.com/enigma0x3</p></div></div></div><div class="jo s"><div class="n lq"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" rel="noopener"><img alt="Posts By SpecterOps Team Members" class="dd oe od" src="https://miro.medium.com/fit/c/80/80/1*D-FDlfkqivRBQZoESrwtqw.png" width="40" height="40"/></a><div class="ez s"><div class="n lq"><h2 class="ce kh ki cg ds eq"><a href="https://posts.specterops.io/?source=follow_footer-------------------------------------" class="ck cl at au av aw ax ay az ba gn go bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></h2><div class="ez s"></div></div><div class="oi s"><p class="ce b fa cg gd">Posts from SpecterOps team members on various topics relating information security</p></div></div></div></div></div></div></div></div></div><div class="s db z"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="oj ok s"><div class="ol kk om ok s on oo"><h2 class="ce kh op oq or os ot ou ov ow ox oy oz pa pb pc pd eq">More From Medium</h2></div><div class="bu n lq ma pe pf pg ph pi pj pk pl pm pn po pp pq pr ps"><div class="pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql qm qn"><div class="qo qp s"><div class="aj im"><div class="n es"><div class="s bp qq qr qs"><div class="qt s"><h2 class="ce kh qu qv or qw qx ou qy qz ox ra rb pa rc rd pd eq"><a rel="noopener" href="/gathering-open-source-intelligence-bee58de48e05?source=post_internal_links---------0----------------------------">Gathering Open Source Intelligence</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cmaddy.medium.com/?source=post_internal_links---------0----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Christopher Maddalena</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------0----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s re rf"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/gathering-open-source-intelligence-bee58de48e05?source=post_internal_links---------0----------------------------"><div class="ip s ia iq"><div class="rg is s"><div class="ik il t u v im aj bk in io"><img class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*dy7MvBD79mkCTajDbSssBw.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ik il rh ri rj rk rl rm rn ro rp rq c" width="70" height="70" role="presentation"/><noscript><img class="rh ri rj rk rl rm rn ro rp rq" src="https://miro.medium.com/fit/c/140/140/1*dy7MvBD79mkCTajDbSssBw.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*dy7MvBD79mkCTajDbSssBw.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*dy7MvBD79mkCTajDbSssBw.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql qm qn"><div class="qo qp s"><div class="aj im"><div class="n es"><div class="s bp qq qr qs"><div class="qt s"><h2 class="ce kh qu qv or qw qx ou qy qz ox ra rb pa rc rd pd eq"><a rel="noopener" href="/man-in-the-terminal-65476e6165b9?source=post_internal_links---------1----------------------------">Man in the Terminal</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@djhohnstein?source=post_internal_links---------1----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Dwight Hohnstein</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------1----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s re rf"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/man-in-the-terminal-65476e6165b9?source=post_internal_links---------1----------------------------"><div class="ip s ia iq"><div class="rg is s"><div class="ik il t u v im aj bk in io"><img class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*GF6FdIDKpvQxjuNuPsX7kQ.png?q=20" width="70" height="70" role="presentation"/></div><img class="ik il rh ri rj rk rl rm rn ro rp rq c" width="70" height="70" role="presentation"/><noscript><img class="rh ri rj rk rl rm rn ro rp rq" src="https://miro.medium.com/fit/c/140/140/1*GF6FdIDKpvQxjuNuPsX7kQ.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*GF6FdIDKpvQxjuNuPsX7kQ.png 48w, https://miro.medium.com/fit/c/140/140/1*GF6FdIDKpvQxjuNuPsX7kQ.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql qm qn"><div class="qo qp s"><div class="aj im"><div class="n es"><div class="s bp qq qr qs"><div class="qt s"><h2 class="ce kh qu qv or qw qx ou qy qz ox ra rb pa rc rd pd eq"><a rel="noopener" href="/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a?source=post_internal_links---------2----------------------------">Attacking Azure, Azure AD, and Introducing PowerZure</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@hausec?source=post_internal_links---------2----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Ryan Hausknecht</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------2----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s re rf"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a?source=post_internal_links---------2----------------------------"><div class="ip s ia iq"><div class="rg is s"><div class="ik il t u v im aj bk in io"><img class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/0*GHniN9KHMioCdUW5?q=20" width="70" height="70" role="presentation"/></div><img class="ik il rh ri rj rk rl rm rn ro rp rq c" width="70" height="70" role="presentation"/><noscript><img class="rh ri rj rk rl rm rn ro rp rq" src="https://miro.medium.com/fit/c/140/140/0*GHniN9KHMioCdUW5" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*GHniN9KHMioCdUW5 48w, https://miro.medium.com/fit/c/140/140/0*GHniN9KHMioCdUW5 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql qm qn"><div class="qo qp s"><div class="aj im"><div class="n es"><div class="s bp qq qr qs"><div class="qt s"><h2 class="ce kh qu qv or qw qx ou qy qz ox ra rb pa rc rd pd eq"><a rel="noopener" href="/threat-hunting-with-jupyter-notebooks-part-1-your-first-notebook-9a99a781fde7?source=post_internal_links---------3----------------------------">Threat Hunting with Jupyter Notebooks— Part 1: Your First Notebook 📓</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cyb3rward0g.medium.com/?source=post_internal_links---------3----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Roberto Rodriguez</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------3----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s re rf"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/threat-hunting-with-jupyter-notebooks-part-1-your-first-notebook-9a99a781fde7?source=post_internal_links---------3----------------------------"><div class="ip s ia iq"><div class="rg is s"><div class="ik il t u v im aj bk in io"><img class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*ezJx8ZEu1Va14iscq_h5Gg.png?q=20" width="70" height="70" role="presentation"/></div><img class="ik il rh ri rj rk rl rm rn ro rp rq c" width="70" height="70" role="presentation"/><noscript><img class="rh ri rj rk rl rm rn ro rp rq" src="https://miro.medium.com/fit/c/140/140/1*ezJx8ZEu1Va14iscq_h5Gg.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*ezJx8ZEu1Va14iscq_h5Gg.png 48w, https://miro.medium.com/fit/c/140/140/1*ezJx8ZEu1Va14iscq_h5Gg.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql qm qn"><div class="qo qp s"><div class="aj im"><div class="n es"><div class="s bp qq qr qs"><div class="qt s"><h2 class="ce kh qu qv or qw qx ou qy qz ox ra rb pa rc rd pd eq"><a rel="noopener" href="/cve-2018-8414-a-case-study-in-responsible-disclosure-ff74c39615ba?source=post_internal_links---------4----------------------------">CVE-2018–8414: A Case Study in Responsible Disclosure</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@enigma0x3?source=post_internal_links---------4----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Matt Nelson</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------4----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s re rf"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/cve-2018-8414-a-case-study-in-responsible-disclosure-ff74c39615ba?source=post_internal_links---------4----------------------------"><div class="ip s ia iq"><div class="rg is s"><div class="ik il t u v im aj bk in io"><img class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*_yKdMthPwVpKYyHZnvrKJQ.png?q=20" width="70" height="70" role="presentation"/></div><img class="ik il rh ri rj rk rl rm rn ro rp rq c" width="70" height="70" role="presentation"/><noscript><img class="rh ri rj rk rl rm rn ro rp rq" src="https://miro.medium.com/fit/c/140/140/1*_yKdMthPwVpKYyHZnvrKJQ.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*_yKdMthPwVpKYyHZnvrKJQ.png 48w, https://miro.medium.com/fit/c/140/140/1*_yKdMthPwVpKYyHZnvrKJQ.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql qm qn"><div class="qo qp s"><div class="aj im"><div class="n es"><div class="s bp qq qr qs"><div class="qt s"><h2 class="ce kh qu qv or qw qx ou qy qz ox ra rb pa rc rd pd eq"><a rel="noopener" href="/enter-mordor-pre-recorded-security-events-from-simulated-adversarial-techniques-fdf5555c9eb1?source=post_internal_links---------5----------------------------">Enter Mordor 😈: Pre-recorded Security Events from Simulated Adversarial Techniques 🛡</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cyb3rward0g.medium.com/?source=post_internal_links---------5----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Roberto Rodriguez</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------5----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s re rf"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/enter-mordor-pre-recorded-security-events-from-simulated-adversarial-techniques-fdf5555c9eb1?source=post_internal_links---------5----------------------------"><div class="ip s ia iq"><div class="rg is s"><div class="ik il t u v im aj bk in io"><img class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/0*ji6keNd2kNMsDi-Z.png?q=20" width="70" height="70" role="presentation"/></div><img class="ik il rh ri rj rk rl rm rn ro rp rq c" width="70" height="70" role="presentation"/><noscript><img class="rh ri rj rk rl rm rn ro rp rq" src="https://miro.medium.com/fit/c/140/140/0*ji6keNd2kNMsDi-Z.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*ji6keNd2kNMsDi-Z.png 48w, https://miro.medium.com/fit/c/140/140/0*ji6keNd2kNMsDi-Z.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql qm qn"><div class="qo qp s"><div class="aj im"><div class="n es"><div class="s bp qq qr qs"><div class="qt s"><h2 class="ce kh qu qv or qw qx ou qy qz ox ra rb pa rc rd pd eq"><a rel="noopener" href="/putting-sysmon-v9-0-and-or-grouping-logic-to-the-test-c3ec27263df8?source=post_internal_links---------6----------------------------">Putting Sysmon v9.0 AND/OR Grouping Logic to the Test</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://cyb3rward0g.medium.com/?source=post_internal_links---------6----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Roberto Rodriguez</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------6----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s re rf"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/putting-sysmon-v9-0-and-or-grouping-logic-to-the-test-c3ec27263df8?source=post_internal_links---------6----------------------------"><div class="ip s ia iq"><div class="rg is s"><div class="ik il t u v im aj bk in io"><img class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/1*YDlbuijY1qh1K0WhSIRFKw.png?q=20" width="70" height="70" role="presentation"/></div><img class="ik il rh ri rj rk rl rm rn ro rp rq c" width="70" height="70" role="presentation"/><noscript><img class="rh ri rj rk rl rm rn ro rp rq" src="https://miro.medium.com/fit/c/140/140/1*YDlbuijY1qh1K0WhSIRFKw.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*YDlbuijY1qh1K0WhSIRFKw.png 48w, https://miro.medium.com/fit/c/140/140/1*YDlbuijY1qh1K0WhSIRFKw.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql qm qn"><div class="qo qp s"><div class="aj im"><div class="n es"><div class="s bp qq qr qs"><div class="qt s"><h2 class="ce kh qu qv or qw qx ou qy qz ox ra rb pa rc rd pd eq"><a rel="noopener" href="/malware-development-pt-1-dynamic-module-loading-in-go-1121f07f3a5a?source=post_internal_links---------7----------------------------">Malware Development Pt. 1: Dynamic Module Loading in Go</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="ce b fa cg eq"><div class="cq n o fc"><span class="ce b cf cg eq"><a href="https://medium.com/@djhohnstein?source=post_internal_links---------7----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Dwight Hohnstein</a><span> <!-- -->in<!-- --> <a href="https://posts.specterops.io/?source=post_internal_links---------7----------------------------" class="ck cl at au av aw ax ay az ba fj bd fk fl" rel="noopener">Posts By SpecterOps Team Members</a></span></span></div></span></div></div></div></div></div><div class="ez gq s re rf"><a class="ck cl at au av aw ax ay az ba gn go bd fk fl s" rel="noopener" href="/malware-development-pt-1-dynamic-module-loading-in-go-1121f07f3a5a?source=post_internal_links---------7----------------------------"><div class="ip s ia iq"><div class="rg is s"><div class="ik il t u v im aj bk in io"><img class="t u v im aj it iu iv" src="https://miro.medium.com/max/60/0*8zXAta_r_VbLYM_k?q=20" width="70" height="70" role="presentation"/></div><img class="ik il rh ri rj rk rl rm rn ro rp rq c" width="70" height="70" role="presentation"/><noscript><img class="rh ri rj rk rl rm rn ro rp rq" src="https://miro.medium.com/fit/c/140/140/0*8zXAta_r_VbLYM_k" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*8zXAta_r_VbLYM_k 48w, https://miro.medium.com/fit/c/140/140/0*8zXAta_r_VbLYM_k 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="rr s rs rt"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="ru rv nh n es g"><div class="rw n es"><div class="rx s ry"><div class="qt s"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba rz sa bd sb sc" rel="noopener"><h2 class="ce kh sd ny ds se">Learn more.</h2></a></div><p class="ce b fa cg sf">Medium<!-- --> is an open platform where 170 million readers come to find insightful and dynamic thinking. Here, expert and undiscovered voices alike dive into the heart of any topic and bring new ideas to the surface.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba bd sb sc hp" rel="noopener">Learn more</a></p></div><div class="rx s ry"><div class="qt s"><a href="https://medium.com/topics?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba rz sa bd sb sc" rel="noopener"><h2 class="ce kh sd ny ds se">Make <!-- -->Medium<!-- --> yours.</h2></a></div><p class="ce b fa cg sf">Follow the writers, publications, and topics that matter to you, and you’ll see them on your homepage and in your inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba bd sb sc hp" rel="noopener">Explore</a></p></div><div class="rx s ry"><div class="qt s"><a href="https://about.medium.com/creators/?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba rz sa bd sb sc" rel="noopener"><h2 class="ce kh sd ny ds se">Share your thinking.</h2></a></div><p class="ce b fa cg sf">If you have a story to tell, knowledge to share, or a perspective to offer — welcome home. It’s easy and free to post your thinking on any topic.<!-- --> <a href="https://about.medium.com/creators/?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba bd sb sc hp" rel="noopener">Write on <!-- -->Medium</a></p></div></div></div><div class="n kg"><div class="n o es"><a href="https://medium.com/?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba rz sa bd sb sc" rel="noopener"><svg viewBox="0 0 3940 610" class="fp sg"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="oi sh n es si am"><p class="ce b ki ny se"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba fj bd sb sc" rel="noopener">About</a></p><p class="ce b ki ny se"><a href="https://help.medium.com/hc/en-us?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba fj bd sb sc" rel="noopener">Help</a></p><p class="ce b ki ny se"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba fj bd sb sc" rel="noopener">Legal</a></p></div></div><div class="nz sj sk am"><p class="ce b ki ny sf">Get the Medium app</p></div><div class="nz sj sl am sm"><div class="sn s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba rz sa bd sb sc" rel="noopener"><img alt="A button that says &#x27;Download on the App Store&#x27;, and if clicked it will lead you to the iOS App store" class="" src="https://miro.medium.com/max/270/1*Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"/></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----d7226864caee--------------------------------" class="ck cl at au av aw ax ay az ba rz sa bd sb sc" rel="noopener"><img alt="A button that says &#x27;Get it on, Google Play&#x27;, and if clicked it will lead you to the Google Play store" class="" src="https://miro.medium.com/max/270/1*W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"/></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210521-194149-8205a38997"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":false},"bookReader":{"assets":{},"reader":{"currentAsset":null,"currentGFI":null,"settingsPanelIsOpen":false,"settings":{"fontFamily":"CHARTER","fontScale":"M","publisherStyling":true,"textAlignment":"start","theme":"White","lineSpacing":0,"wordSpacing":0,"letterSpacing":0},"internalNavCounter":0,"currentSelection":null,"highlights":[]}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-d7226864caee","user-1bb43103a9a9","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true}},"debug":{"requestId":"35d910d3-32fb-472b-a880-c37643d84548","hybridDevServices":[],"showBookReaderDebugger":false,"originalSpanCarrier":{"ot-tracer-spanid":"7451b3135a911aae","ot-tracer-traceid":"67ce96b4f635b631","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false},"tracing":{},"config":{"nodeEnv":"production","version":"main-20210521-194149-8205a38997","isTaggedVersion":false,"target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210521-194149-8205a38997"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210521-194149-8205a38997","commit":"8205a389970795cdb2c37068f2062c807d740019"}},"datacenter":"us"},"googleAnalyticsCode":"UA-24232453-2","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium"},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl"},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"variantFlags":[{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"android_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"assign_default_topic_to_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"bane_add_user","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"bane_verify_domain","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"branch_seo_metadata","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"covid_19_cdc_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"default_seo_post_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_android_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_resume_reading_toast","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_mobile_featured_chunk","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_post_recommended_from_friends_provider","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"eds_public_story_to_membership_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_local_currency","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_annual_renewal_reminder_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_parse_expires_at","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_renewal_failure","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_about_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_general_admission","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_sticky_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_tag_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_autotier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automated_mission_control_triggers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_blogrolls","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_text_me_the_app","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding_fonts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cleansweep_double_writes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_client_error_tracking","valueType":{"__typename":"VariantFlagString","value":"none"}},{"__typename":"VariantFlag","name":"enable_confirm_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cta_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_custom_domain_v2_settings","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_feature_logging","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_generation_pipeline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_tagline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_earn_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_edit_alt_text","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_sign_in_captcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_embedding_based_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_end_of_post_cleanup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_evhead_com_to_ev_medium_com_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_expanded_feature_chunk_pool","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_by_resend_rules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_expire_processor","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_global_susi_modal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_cancelled","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_expired","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_in_grace_period","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_on_hold","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook_subscription_renewed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_highlander_member_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hightower_user_bonus","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hot_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_post_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_json_logs_trained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_app_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_notifications","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_homepage_for_selected_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_stories","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_unread_notification_count_mutation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_login_code_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_media_resource_try_catch","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_membership_remove_section_a","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_miro_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mission_control","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_digest_rendering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_welcome_digest_rendering","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mute","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_collaborative_filtering_data","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_login_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_member_welcome_email_enhancement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_three_dot_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_user_onboarding_email_enhancement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_parsely","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_patronus_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_popularity_feature","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_page_nav_stickiness_removal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_settings_screen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_tax_status_clarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_primary_topic_for_mobile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_design_reminder","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_page_seo_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_publish_to_email_for_publication_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rank_v2_usage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_receipt_notes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_all","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_edit_and_delete","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_moderation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_follow_feed_cache","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rtr_channel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_save_to_medium","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_signup_friction","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace_ranker_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_feed_urls","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipalti_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trending_posts_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_triton_predictions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trumpland_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_twitter_auth_suggestions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_writer_management","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"entity_driven_subscription_milestone_2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound"}},{"__typename":"VariantFlag","name":"google_sign_in_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_generic_home_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_pub_follow_email_opt_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"is_not_medium_subscriber","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_fastrak","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_stripe_express","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"make_nav_sticky","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"new_transition_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"optimizely_holdback","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"post_edge_cache_enabled","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"posts_under_quota_fair_distribution","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"provider_for_credit_card_form","valueType":{"__typename":"VariantFlagString","value":"BRAINTREE"}},{"__typename":"VariantFlag","name":"pub_sidebar","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefine_average_post_reading_time","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_post_post_similarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"retrained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"sign_up_with_email_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"single_partition_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_sign_in_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"suppress_apple_missing_expires_date_alert","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"use_new_admin_topic_backend","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"meterPost({\"postId\":\"d7226864caee\",\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__ref":"MeteringInfo:{}"},"postResult({\"id\":\"d7226864caee\"})":{"__ref":"Post:d7226864caee"}},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":0},"UserViewerEdge:userId:1bb43103a9a9-viewerId:lo_603a9889e34a":{"id":"userId:1bb43103a9a9-viewerId:lo_603a9889e34a","__typename":"UserViewerEdge","isAllowEdsEnabled":false,"isFollowing":false,"readPostsCount":0,"createdAt":0,"lastPostCreatedAt":0,"isBlocking":false,"isUser":false},"User:1bb43103a9a9":{"id":"1bb43103a9a9","__typename":"User","viewerIsUser":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:1bb43103a9a9-viewerId:lo_603a9889e34a"},"customStyleSheet":null,"isSuspended":false,"name":"Matt Nelson","hasCompletedProfile":false,"bio":"Red Teamer | Security Researcher | Enjoys abusing features | Tweets are my own | http:\u002F\u002Fgithub.com\u002Fenigma0x3","imageId":"0*6mGXmQSDMYyKuVUK.jpg","username":"enigma0x3","customDomainState":null,"isAuroraVisible":true,"mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":1461,"followingCount":56},"hasSubdomain":false,"allowNotes":true,"newsletterV3":null,"twitterScreenName":"enigma0x3","followedCollections":1,"atsQualifiedAt":1612205458328},"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"id":"1*D-FDlfkqivRBQZoESrwtqw.png","__typename":"ImageMetadata"},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_603a9889e34a":{"id":"collectionId:f05f8696e3cc-viewerId:lo_603a9889e34a","__typename":"CollectionViewerEdge","isEditor":false,"canEditOwnPosts":false,"canEditPosts":false,"isFollowing":false},"ImageMetadata:1*aa0HsXZL43r95TuTJlJNPw.png":{"id":"1*aa0HsXZL43r95TuTJlJNPw.png","__typename":"ImageMetadata","originalWidth":790,"originalHeight":187},"User:70f84c574024":{"id":"70f84c574024","__typename":"User","atsQualifiedAt":1612205406678},"Collection:f05f8696e3cc":{"id":"f05f8696e3cc","__typename":"Collection","domain":"posts.specterops.io","googleAnalyticsId":"UA-102239211-2","slug":"specter-ops-posts","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","isAuroraVisible":false,"favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"name":"Posts By SpecterOps Team Members","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}},"customStyleSheet":null,"tagline":"Posts from SpecterOps team members on various topics…","isAuroraEligible":false,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_603a9889e34a"},"logo":{"__ref":"ImageMetadata:1*aa0HsXZL43r95TuTJlJNPw.png"},"navItems":[{"__typename":"NavItem","title":"About","url":"https:\u002F\u002Fposts.specterops.io\u002Fabout","type":"ABOUT_PAGE_NAV_ITEM"},{"__typename":"NavItem","title":"All Posts","url":"https:\u002F\u002Fposts.specterops.io\u002Farchive","type":"ARCHIVE_NAV_ITEM"},{"__typename":"NavItem","title":"specterops.io","url":"https:\u002F\u002Fwww.specterops.io","type":"EXTERNAL_LINK_NAV_ITEM"}],"creator":{"__ref":"User:70f84c574024"},"subscriberCount":3251,"avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"newsletterV3":null,"canToggleEmail":false,"description":"Posts from SpecterOps team members on various topics relating information security","ampEnabled":false,"twitterUsername":"specterops","facebookPageId":null,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","status":"ACTIVE","isSubdomain":false}},"ptsQualifiedAt":1616092933111},"PostViewerEdge:postId:d7226864caee-viewerId:lo_603a9889e34a":{"id":"postId:d7226864caee-viewerId:lo_603a9889e34a","__typename":"PostViewerEdge","readingList":"READING_LIST_NONE","clapCount":0,"creatorPartnerProgramEnrollmentStatus":"PERMISSION_DENIED","shareKey":null},"Paragraph:8e7bd8096cbc_0":{"id":"8e7bd8096cbc_0","__typename":"Paragraph","name":"c771","text":"Reviving DDE: Using OneNote and Excel for Code Execution","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_1":{"id":"8e7bd8096cbc_1","__typename":"Paragraph","name":"8f08","text":"TL;DR: You can achieve DDE execution with Excel SpreadSheets embedded within OneNote. This bypasses the original Excel mitigation ruleset (Microsoft has released a patch to properly mitigate this) as well as the Protected View sandbox 🙂","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_2":{"id":"8e7bd8096cbc_2","__typename":"Paragraph","name":"7312","text":"Dynamic Data Exchange (DDE) has been a hot topic as of late. For those unfamiliar with DDE, it is designed to transfer data between two applications. In 2014, Contextis put out a nice blog post on using DDE in Microsoft Excel for code execution by utilizing the “=DDE()” formula.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":27,"type":"A","href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Fwindows\u002Fdesktop\u002Fms648774(v=vs.85).aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":197,"end":225,"type":"A","href":"https:\u002F\u002Fwww.contextis.com\u002Fblog\u002Fcomma-separated-vulnerabilities","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_3":{"id":"8e7bd8096cbc_3","__typename":"Paragraph","name":"016e","text":"Then, on October 9th 2017, SensePost released a really great blog post on abusing the DDEAUTO field code in Microsoft Word to get code execution. Shortly after, various malware families adopted the technique and it was quickly seen in the wild.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":48,"end":65,"type":"A","href":"https:\u002F\u002Fsensepost.com\u002Fblog\u002F2017\u002Fmacro-less-code-exec-in-msword\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_4":{"id":"8e7bd8096cbc_4","__typename":"Paragraph","name":"11e4","text":"After seeing a spike in malicious use, Will Dormann (@wdormann) of US-CERT published some registry changes that would widely mitigate most DDE threats. These changes disabled DDE and prevented links from automatically updating for Word and Excel. Will added a OneNote block after sharing the details outlined below with him privately. Unfortunately the only fix was to completely kill embedded files, which is less than ideal. You can find these registry changes here: https:\u002F\u002Fgist.github.com\u002Fwdormann\u002F732bb88d9b5dd5a66c9f1e1498f31a1b","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":53,"end":62,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002Fwdormann","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":469,"end":534,"type":"A","href":"https:\u002F\u002Fgist.github.com\u002Fwdormann\u002F732bb88d9b5dd5a66c9f1e1498f31a1b","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_5":{"id":"8e7bd8096cbc_5","__typename":"Paragraph","name":"1fee","text":"This guidance was really helpful to those dealing with actors using DDE techniques more and more. Then, on November 8th 2017, Microsoft published an official post that outlines mitigating the DDE threat for those who don’t use the protocol in their environment, which was released under Advisory ADV170021 with additional documentation here. These mitigations were largely just for Word and it involved preventing any execution entirely as opposed to stopping automatic link updating. In addition to this post, Microsoft also stated that Protected View will prevent automatic DDE execution and that users should open untrusted documents with caution.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":146,"end":162,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsecurity-updates\u002Fsecurityadvisories\u002F2017\u002F4053440","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":296,"end":305,"type":"A","href":"https:\u002F\u002Fportal.msrc.microsoft.com\u002Fen-US\u002Fsecurity-guidance\u002Fadvisory\u002FADV170021","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":336,"end":340,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsecurity-updates\u002Fsecurityadvisories\u002F2017\u002F4053440","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":511,"end":532,"type":"A","href":"https:\u002F\u002Fwww.theregister.co.uk\u002F2017\u002F10\u002F17\u002Fmicrosoft_dde_attacks\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":538,"end":552,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_6":{"id":"8e7bd8096cbc_6","__typename":"Paragraph","name":"c464","text":"After seeing these new DDE mitigation recommendations, I became curious how these were handled when executed from within a different Office application, such as Publisher or OneNote. At the time, Will Dormann’s gist was the only source for mitigation options in other Office apps (such as Excel) as Microsoft only released official guidance for Word.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":211,"end":216,"type":"A","href":"https:\u002F\u002Fgist.github.com\u002Fwdormann\u002F732bb88d9b5dd5a66c9f1e1498f31a1b","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_7":{"id":"8e7bd8096cbc_7","__typename":"Paragraph","name":"d60e","text":"So, why OneNote? Well, it allows a user to embed Excel spreadsheets into a note document and then save it. This provides the end user the ability to reference or use Excel features directly within OneNote. As you may know, you can abuse DDE in Excel to get code execution! Ideally, Will’s Excel registry changes to stop DDE attacks would apply to any Excel sheets embedded in OneNote. Unfortunately, this wasn’t the case.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_8":{"id":"8e7bd8096cbc_8","__typename":"Paragraph","name":"e9ff","text":"When implementing Will’s Excel registry change (specifically “DDEAllowed” set to DWORD 0), you will see something like this when opening a spreadsheet that contains a DDE formula:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_9":{"id":"8e7bd8096cbc_9","__typename":"Paragraph","name":"c060","text":"Excel DDE Blocked via Registry Mitigations","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*1kKktvOkRD_LMxb4DGXI4w.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_10":{"id":"8e7bd8096cbc_10","__typename":"Paragraph","name":"e92d","text":"So, the Excel DDE block is working as expected. Now, let’s look at OneNote. In order to utilize the Excel functionality in OneNote, you can go to “SpreadSheet” under the “Files” tab and either import an existing Excel Spreadsheet or create a new one.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_11":{"id":"8e7bd8096cbc_11","__typename":"Paragraph","name":"b07f","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vZlCAVYV2z9bF9prE2mXrw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_12":{"id":"8e7bd8096cbc_12","__typename":"Paragraph","name":"aa18","text":"So, OneNote allows us to import an existing spreadsheet. What happens if we import a DDE-laced spreadsheet? First, we need to create it. Ryan Hanson (@ryhanson) put out a tweet showing that you can manipulate the warning box during DDE execution and change the binary name. This can be helpful as you can change it to something like “MSEXCEL.exe” instead of displaying “cmd.exe” or “powershell.exe”.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":150,"end":159,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002Fryhanson","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_13":{"id":"8e7bd8096cbc_13","__typename":"Paragraph","name":"3706","text":"Source: https:\u002F\u002Ftwitter.com\u002FryHanson\u002Fstatus\u002F918598525792935936","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VHmBQNv5soO5vOhu3u0Btw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":8,"end":62,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002FryHanson\u002Fstatus\u002F918598525792935936","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_14":{"id":"8e7bd8096cbc_14","__typename":"Paragraph","name":"d2da","text":"After adding that formula to an Excel spreadsheet and saving it, we can now test it to ensure it displays properly. To do so, I have removed the Excel DDE mitigation registry changes.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_15":{"id":"8e7bd8096cbc_15","__typename":"Paragraph","name":"85ca","text":"Execution without registry mitigations applied","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QREbLhYr6MZmd7czNEGzUA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_16":{"id":"8e7bd8096cbc_16","__typename":"Paragraph","name":"bda8","text":"Great, so it works. Next, let’s test it with Will’s Excel registry changes applied:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_17":{"id":"8e7bd8096cbc_17","__typename":"Paragraph","name":"406d","text":"Excel DDE Blocked via Registry Mitigations","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Re5LS3slFzaw--sXC4UJ5w.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_18":{"id":"8e7bd8096cbc_18","__typename":"Paragraph","name":"1933","text":"Awesome, so these changes do indeed block the Excel DDE POC that we have just created. Now that we have our DDE spreadsheet ready and tested, we can import it into OneNote by going to “Insert-\u003ESpreadSheet-\u003EExisting Excel SpreadSheet”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_19":{"id":"8e7bd8096cbc_19","__typename":"Paragraph","name":"4822","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vZlCAVYV2z9bF9prE2mXrw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_20":{"id":"8e7bd8096cbc_20","__typename":"Paragraph","name":"749a","text":"OneNote will ask you to browse to the file you want to import, which will be the previously created DDE laced spreadsheet. Next, it will ask you if you want to attach the file or insert the spreadsheet. We will do “Insert SpreadSheet”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_21":{"id":"8e7bd8096cbc_21","__typename":"Paragraph","name":"9243","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*kbPKGu5tLDzEcPrDkBsSuQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_22":{"id":"8e7bd8096cbc_22","__typename":"Paragraph","name":"547d","text":"OneNote will then import the spreadsheet and during that process, it will attempt to execute your DDE command. To prevent that, simply click “No”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_23":{"id":"8e7bd8096cbc_23","__typename":"Paragraph","name":"fe92","text":"Importing weaponized Excel Sheet","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JoIxldlAIt5Vz9T9MXbSxg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_24":{"id":"8e7bd8096cbc_24","__typename":"Paragraph","name":"c612","text":"Finally, save the OneNote file. At this point, that OneNote file has a DDE laced Excel SpreadSheet directly embedded in it. Now, let’s see what happens when the Excel SpreadSheet is accessed from within the OneNote file with the Excel DDE mitigation registry changes in place:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_25":{"id":"8e7bd8096cbc_25","__typename":"Paragraph","name":"801a","text":"DDE execution despite Excel registry changes","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZGaQiZnYAPwZgR4ukQLHEw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_26":{"id":"8e7bd8096cbc_26","__typename":"Paragraph","name":"da6f","text":"Clicking “Yes” results in the command being executed:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_27":{"id":"8e7bd8096cbc_27","__typename":"Paragraph","name":"f737","text":"DDE execution despite Excel registry changes","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*6u7RGKsRz1qMu-ep5OJjRw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_28":{"id":"8e7bd8096cbc_28","__typename":"Paragraph","name":"0bbf","text":"So, despite blocking DDE in Excel via “DDEAllowed”, the functionality is still there when accessed through OneNote. After chatting with Will Dormann, the only working mitigation is to set “DisableEmbeddedFiles” to 1. This obviously kills all file embedding functionality as a side-effect, which isn’t great for usability.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_29":{"id":"8e7bd8096cbc_29","__typename":"Paragraph","name":"240b","text":"As mentioned above, one of Microsoft’s statements notes that Protected View will prevent the DDE vectors when originating from an untrusted source (such as the internet). This is the case for most Office applications as any content originating from an untrusted source is opened in a sandbox first. OneNote, however, is not enrolled in Protected View and will not trigger it when pulled from the internet.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":61,"end":75,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":336,"end":351,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_30":{"id":"8e7bd8096cbc_30","__typename":"Paragraph","name":"4343","text":"If a user has OneNote installed, an attacker can embed a weaponized Excel spreadsheet into a OneNote file and send it to a victim via a weblink or an email attachment. When the user receives the OneNote file and opens the embedded spreadsheet, it will not open in Protected View and they will simply be presented with the DDE prompt (which you can tamper with as demonstrated above):","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":264,"end":278,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_31":{"id":"8e7bd8096cbc_31","__typename":"Paragraph","name":"632a","text":"Demo of DDE execution from the internet (bypassing Protected View sandbox)","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Dj6BrDpvO9juS8lm88wrFA.gif"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_32":{"id":"8e7bd8096cbc_32","__typename":"Paragraph","name":"e7e2","text":"*It should be noted that the Protected View aspect was reported to MSRC on April 20th, 2017 and it was deemed not a security issue.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":131,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":29,"end":43,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_33":{"id":"8e7bd8096cbc_33","__typename":"Paragraph","name":"9b14","text":"So, what can you do? Well, at the time, the only mitigation was to completely kill embedding in OneNote. This was reported to Microsoft on October 10th of 2017 and on January 9th, 2018 they pushed out an update to all Office versions going back to 2007. The Excel update was added to the already existing Advisory ADV170021, in which that advisory now details how to implement mitigations for both Excel and Word (since it was previously only Word that was available). Additional documentation can be found here.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":314,"end":323,"type":"A","href":"https:\u002F\u002Fportal.msrc.microsoft.com\u002Fen-US\u002Fsecurity-guidance\u002Fadvisory\u002FADV170021","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":507,"end":511,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsecurity-updates\u002Fsecurityadvisories\u002F2017\u002F4053440","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_34":{"id":"8e7bd8096cbc_34","__typename":"Paragraph","name":"b8cd","text":"This update created a value you can add under Microsoft Excel’s security options in the registry. By setting “DisableDDEServerLaunch” to DWORD 1, DDE will effectively be neutered for Excel. This is important because OneNote itself wasn’t entirely interesting. It was the embedded Excel functionality that made this attack work. By adding mitigation options for Excel, users can protect themselves from this attack.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_35":{"id":"8e7bd8096cbc_35","__typename":"Paragraph","name":"012a","text":"Additionally, you can employ Attack Surface Reduction (ASR) rules in Windows 10 1709 to prevent not only DDE attacks, but other attacks where an Office program is spawning a child process. You can read more on ASR here.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":214,"end":218,"type":"A","href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fthreat-protection\u002Fwindows-defender-exploit-guard\u002Fenable-attack-surface-reduction","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8e7bd8096cbc_36":{"id":"8e7bd8096cbc_36","__typename":"Paragraph","name":"b622","text":"-Matt N.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8e7bd8096cbc_37":{"id":"8e7bd8096cbc_37","__typename":"Paragraph","name":"1090","text":"Originally published at enigma0x3.net on January 29, 2018.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":24,"end":37,"type":"A","href":"https:\u002F\u002Fenigma0x3.net\u002F2018\u002F01\u002F29\u002Freviving-dde-using-onenote-and-excel-for-code-execution\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":58,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"ImageMetadata:1*1kKktvOkRD_LMxb4DGXI4w.png":{"id":"1*1kKktvOkRD_LMxb4DGXI4w.png","__typename":"ImageMetadata","originalHeight":750,"originalWidth":1376,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*vZlCAVYV2z9bF9prE2mXrw.png":{"id":"1*vZlCAVYV2z9bF9prE2mXrw.png","__typename":"ImageMetadata","originalHeight":340,"originalWidth":1022,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*VHmBQNv5soO5vOhu3u0Btw.png":{"id":"1*VHmBQNv5soO5vOhu3u0Btw.png","__typename":"ImageMetadata","originalHeight":692,"originalWidth":1196,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*QREbLhYr6MZmd7czNEGzUA.png":{"id":"1*QREbLhYr6MZmd7czNEGzUA.png","__typename":"ImageMetadata","originalHeight":942,"originalWidth":2448,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*Re5LS3slFzaw--sXC4UJ5w.png":{"id":"1*Re5LS3slFzaw--sXC4UJ5w.png","__typename":"ImageMetadata","originalHeight":790,"originalWidth":1412,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*kbPKGu5tLDzEcPrDkBsSuQ.png":{"id":"1*kbPKGu5tLDzEcPrDkBsSuQ.png","__typename":"ImageMetadata","originalHeight":434,"originalWidth":524,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*JoIxldlAIt5Vz9T9MXbSxg.png":{"id":"1*JoIxldlAIt5Vz9T9MXbSxg.png","__typename":"ImageMetadata","originalHeight":672,"originalWidth":974,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*ZGaQiZnYAPwZgR4ukQLHEw.png":{"id":"1*ZGaQiZnYAPwZgR4ukQLHEw.png","__typename":"ImageMetadata","originalHeight":900,"originalWidth":1494,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*6u7RGKsRz1qMu-ep5OJjRw.png":{"id":"1*6u7RGKsRz1qMu-ep5OJjRw.png","__typename":"ImageMetadata","originalHeight":1064,"originalWidth":1506,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*Dj6BrDpvO9juS8lm88wrFA.gif":{"id":"1*Dj6BrDpvO9juS8lm88wrFA.gif","__typename":"ImageMetadata","originalHeight":500,"originalWidth":800,"focusPercentX":null,"focusPercentY":null,"alt":null},"Tag:excel":{"id":"excel","__typename":"Tag","displayTitle":"Excel","normalizedTagSlug":""},"Tag:red-team":{"id":"red-team","__typename":"Tag","displayTitle":"Red Team","normalizedTagSlug":""},"Tag:phishing":{"id":"phishing","__typename":"Tag","displayTitle":"Phishing","normalizedTagSlug":""},"Tag:office":{"id":"office","__typename":"Tag","displayTitle":"Office","normalizedTagSlug":""},"Tag:dde":{"id":"dde","__typename":"Tag","displayTitle":"Dde","normalizedTagSlug":""},"ImageMetadata:1*dy7MvBD79mkCTajDbSssBw.jpeg":{"id":"1*dy7MvBD79mkCTajDbSssBw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:10eca8f7a844-viewerId:lo_603a9889e34a":{"id":"userId:10eca8f7a844-viewerId:lo_603a9889e34a","__typename":"UserViewerEdge","isFollowing":false},"User:10eca8f7a844":{"id":"10eca8f7a844","__typename":"User","name":"Christopher Maddalena","username":"cmaddy","bio":"A maker and a hacker","imageId":"1*HUuIXzzmiLidwQHi6Hd3nw.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"cmaddy.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:10eca8f7a844-viewerId:lo_603a9889e34a"}},"Post:bee58de48e05":{"id":"bee58de48e05","__typename":"Post","title":"Gathering Open Source Intelligence","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fgathering-open-source-intelligence-bee58de48e05","previewImage":{"__ref":"ImageMetadata:1*dy7MvBD79mkCTajDbSssBw.jpeg"},"isPublished":true,"firstPublishedAt":1538499996353,"readingTime":18.150000000000002,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:10eca8f7a844"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*GF6FdIDKpvQxjuNuPsX7kQ.png":{"id":"1*GF6FdIDKpvQxjuNuPsX7kQ.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:3569e97b827d-viewerId:lo_603a9889e34a":{"id":"userId:3569e97b827d-viewerId:lo_603a9889e34a","__typename":"UserViewerEdge","isFollowing":false},"User:3569e97b827d":{"id":"3569e97b827d","__typename":"User","name":"Dwight Hohnstein","username":"djhohnstein","bio":"Operator at SpecterOps","imageId":"1*iMfl1D9YqDx5shwmuj9_YA.png","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:3569e97b827d-viewerId:lo_603a9889e34a"}},"Post:65476e6165b9":{"id":"65476e6165b9","__typename":"Post","title":"Man in the Terminal","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fman-in-the-terminal-65476e6165b9","previewImage":{"__ref":"ImageMetadata:1*GF6FdIDKpvQxjuNuPsX7kQ.png"},"isPublished":true,"firstPublishedAt":1617627579035,"readingTime":5.583018867924529,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:3569e97b827d"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*GHniN9KHMioCdUW5":{"id":"0*GHniN9KHMioCdUW5","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:9689ed358206-viewerId:lo_603a9889e34a":{"id":"userId:9689ed358206-viewerId:lo_603a9889e34a","__typename":"UserViewerEdge","isFollowing":false},"User:9689ed358206":{"id":"9689ed358206","__typename":"User","name":"Ryan Hausknecht","username":"hausec","bio":"Security Consultant @ SpecterOps","imageId":"2*LFdW-NbzZFmNHuopdXF2Wg.png","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:9689ed358206-viewerId:lo_603a9889e34a"}},"Post:ca70b330511a":{"id":"ca70b330511a","__typename":"Post","title":"Attacking Azure, Azure AD, and Introducing PowerZure","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fattacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a","previewImage":{"__ref":"ImageMetadata:0*GHniN9KHMioCdUW5"},"isPublished":true,"firstPublishedAt":1580226779379,"readingTime":13.778301886792454,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:9689ed358206"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*ezJx8ZEu1Va14iscq_h5Gg.png":{"id":"1*ezJx8ZEu1Va14iscq_h5Gg.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:996cb7f12ac1-viewerId:lo_603a9889e34a":{"id":"userId:996cb7f12ac1-viewerId:lo_603a9889e34a","__typename":"UserViewerEdge","isFollowing":false},"User:996cb7f12ac1":{"id":"996cb7f12ac1","__typename":"User","name":"Roberto Rodriguez","username":"cyb3rward0g","bio":"","imageId":"1*9WbXEpOxOhaMq99CwG1ESQ.png","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"cyb3rward0g.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:996cb7f12ac1-viewerId:lo_603a9889e34a"}},"Post:9a99a781fde7":{"id":"9a99a781fde7","__typename":"Post","title":"Threat Hunting with Jupyter Notebooks— Part 1: Your First Notebook 📓","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fthreat-hunting-with-jupyter-notebooks-part-1-your-first-notebook-9a99a781fde7","previewImage":{"__ref":"ImageMetadata:1*ezJx8ZEu1Va14iscq_h5Gg.png"},"isPublished":true,"firstPublishedAt":1559236310322,"readingTime":11.361320754716981,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:996cb7f12ac1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*_yKdMthPwVpKYyHZnvrKJQ.png":{"id":"1*_yKdMthPwVpKYyHZnvrKJQ.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:ff74c39615ba":{"id":"ff74c39615ba","__typename":"Post","title":"CVE-2018–8414: A Case Study in Responsible Disclosure","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fcve-2018-8414-a-case-study-in-responsible-disclosure-ff74c39615ba","previewImage":{"__ref":"ImageMetadata:1*_yKdMthPwVpKYyHZnvrKJQ.png"},"isPublished":true,"firstPublishedAt":1540307028000,"readingTime":11.366981132075471,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:1bb43103a9a9"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*ji6keNd2kNMsDi-Z.png":{"id":"0*ji6keNd2kNMsDi-Z.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:fdf5555c9eb1":{"id":"fdf5555c9eb1","__typename":"Post","title":"Enter Mordor 😈: Pre-recorded Security Events from Simulated Adversarial Techniques 🛡","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fenter-mordor-pre-recorded-security-events-from-simulated-adversarial-techniques-fdf5555c9eb1","previewImage":{"__ref":"ImageMetadata:0*ji6keNd2kNMsDi-Z.png"},"isPublished":true,"firstPublishedAt":1564940155801,"readingTime":12.004716981132075,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:996cb7f12ac1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*YDlbuijY1qh1K0WhSIRFKw.png":{"id":"1*YDlbuijY1qh1K0WhSIRFKw.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:c3ec27263df8":{"id":"c3ec27263df8","__typename":"Post","title":"Putting Sysmon v9.0 AND\u002FOR Grouping Logic to the Test","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fputting-sysmon-v9-0-and-or-grouping-logic-to-the-test-c3ec27263df8","previewImage":{"__ref":"ImageMetadata:1*YDlbuijY1qh1K0WhSIRFKw.png"},"isPublished":true,"firstPublishedAt":1550684529130,"readingTime":11.523584905660378,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:996cb7f12ac1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*8zXAta_r_VbLYM_k":{"id":"0*8zXAta_r_VbLYM_k","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Post:1121f07f3a5a":{"id":"1121f07f3a5a","__typename":"Post","title":"Malware Development Pt. 1: Dynamic Module Loading in Go","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fmalware-development-pt-1-dynamic-module-loading-in-go-1121f07f3a5a","previewImage":{"__ref":"ImageMetadata:0*8zXAta_r_VbLYM_k"},"isPublished":true,"firstPublishedAt":1598878741728,"readingTime":12.580503144654088,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f05f8696e3cc"},"creator":{"__ref":"User:3569e97b827d"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"Post:d7226864caee":{"id":"d7226864caee","__typename":"Post","creator":{"__ref":"User:1bb43103a9a9"},"canonicalUrl":"https:\u002F\u002Fenigma0x3.net\u002F2018\u002F01\u002F29\u002Freviving-dde-using-onenote-and-excel-for-code-execution\u002F","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:8e7bd8096cbc_0"},{"__ref":"Paragraph:8e7bd8096cbc_1"},{"__ref":"Paragraph:8e7bd8096cbc_2"},{"__ref":"Paragraph:8e7bd8096cbc_3"},{"__ref":"Paragraph:8e7bd8096cbc_4"},{"__ref":"Paragraph:8e7bd8096cbc_5"},{"__ref":"Paragraph:8e7bd8096cbc_6"},{"__ref":"Paragraph:8e7bd8096cbc_7"},{"__ref":"Paragraph:8e7bd8096cbc_8"},{"__ref":"Paragraph:8e7bd8096cbc_9"},{"__ref":"Paragraph:8e7bd8096cbc_10"},{"__ref":"Paragraph:8e7bd8096cbc_11"},{"__ref":"Paragraph:8e7bd8096cbc_12"},{"__ref":"Paragraph:8e7bd8096cbc_13"},{"__ref":"Paragraph:8e7bd8096cbc_14"},{"__ref":"Paragraph:8e7bd8096cbc_15"},{"__ref":"Paragraph:8e7bd8096cbc_16"},{"__ref":"Paragraph:8e7bd8096cbc_17"},{"__ref":"Paragraph:8e7bd8096cbc_18"},{"__ref":"Paragraph:8e7bd8096cbc_19"},{"__ref":"Paragraph:8e7bd8096cbc_20"},{"__ref":"Paragraph:8e7bd8096cbc_21"},{"__ref":"Paragraph:8e7bd8096cbc_22"},{"__ref":"Paragraph:8e7bd8096cbc_23"},{"__ref":"Paragraph:8e7bd8096cbc_24"},{"__ref":"Paragraph:8e7bd8096cbc_25"},{"__ref":"Paragraph:8e7bd8096cbc_26"},{"__ref":"Paragraph:8e7bd8096cbc_27"},{"__ref":"Paragraph:8e7bd8096cbc_28"},{"__ref":"Paragraph:8e7bd8096cbc_29"},{"__ref":"Paragraph:8e7bd8096cbc_30"},{"__ref":"Paragraph:8e7bd8096cbc_31"},{"__ref":"Paragraph:8e7bd8096cbc_32"},{"__ref":"Paragraph:8e7bd8096cbc_33"},{"__ref":"Paragraph:8e7bd8096cbc_34"},{"__ref":"Paragraph:8e7bd8096cbc_35"},{"__ref":"Paragraph:8e7bd8096cbc_36"},{"__ref":"Paragraph:8e7bd8096cbc_37"}],"sections":[{"__typename":"Section","name":"0048","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"9e0d","startIndex":37,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"customStyleSheet":null,"firstPublishedAt":1517243517000,"isLocked":false,"isPublished":true,"isShortform":false,"layerCake":0,"primaryTopic":null,"viewerEdge":{"__ref":"PostViewerEdge:postId:d7226864caee-viewerId:lo_603a9889e34a"},"title":"Reviving DDE: Using OneNote and Excel for Code Execution","isMarkedPaywallOnly":false,"mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Freviving-dde-using-onenote-and-excel-for-code-execution-d7226864caee","isLimitedState":false,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:excel"},{"__ref":"Tag:red-team"},{"__ref":"Tag:phishing"},{"__ref":"Tag:office"},{"__ref":"Tag:dde"}],"topics":[{"__typename":"Topic","topicId":"d4e7f4144ac5","name":"Cybersecurity"}],"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","noIndex":null,"curationStatus":null,"metaDescription":"","latestPublishedAt":1517840328906,"readingTime":5.775471698113208,"previewContent":{"__typename":"PreviewContent","subtitle":"TL;DR: You can achieve DDE execution with Excel SpreadSheets embedded within OneNote. This bypasses the original Excel mitigation ruleset…"},"previewImage":{"__ref":"ImageMetadata:1*6u7RGKsRz1qMu-ep5OJjRw.png"},"clapCount":95,"lockedSource":"LOCKED_POST_SOURCE_NONE","isSuspended":false,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":0,"responseDistribution":"NOT_DISTRIBUTED","internalLinks({\"paging\":{\"limit\":8}})":{"__typename":"InternalLinksConnection","items":[{"__ref":"Post:bee58de48e05"},{"__ref":"Post:65476e6165b9"},{"__ref":"Post:ca70b330511a"},{"__ref":"Post:9a99a781fde7"},{"__ref":"Post:ff74c39615ba"},{"__ref":"Post:fdf5555c9eb1"},{"__ref":"Post:c3ec27263df8"},{"__ref":"Post:1121f07f3a5a"}]},"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"audioVersionUrl":"","seoTitle":"","updatedAt":1528891367029,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":0},"latestPublishedVersion":"8e7bd8096cbc","isPublishToEmail":false,"voterCount":18,"recommenders":[]}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.32733017.js"></script><script src="https://cdn-client.medium.com/lite/static/js/6484.96815e61.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.23bdaf70.js"></script><script src="https://cdn-client.medium.com/lite/static/js/5573.159bf40f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/instrumentation.8ea15b6a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.65aadb14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1752.a348f767.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/953.19c0a4db.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3211.3e30b0d8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4586.0206cca1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9692.b4a02f3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5064.7974654b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9046.8e42140f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2846.012d369f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2176.958ba593.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2712.a43f33d4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9972.f6abd8ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5828.582128b9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2955.12744204.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7131.faa9f1cc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/664.68f7c552.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8751.a9b26c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2238.af816699.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5009.dbfd66e8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4803.15ea4361.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8127.7b79de8f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6371.bfa476ae.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8995.7ff30d72.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5435.7a0af391.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3874.3f41bcb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1794.574e0f73.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9454.d9a3a4a8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/Post.50144cfa.chunk.js"></script><script>window.main();</script></body></html>