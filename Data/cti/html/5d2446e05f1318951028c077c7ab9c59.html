<!DOCTYPE html>


















































<html class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="false" data-target="docs" x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Microsoft identity platform and OAuth 2.0 authorization code flow - Microsoft identity platform" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow" />
			<meta property="og:description" content="Build web applications using the Microsoft identity platform implementation of the OAuth 2.0 authentication protocol." />
		<meta property="og:image" content="https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png" />
		<meta property="og:image:alt" content="Microsoft Logo" />

	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@docsmsft" />

	<meta name="color-scheme" content="light dark">


	<meta name="author" content="hpsin" />
<meta name="breadcrumb_path" content="/azure/bread/toc.json" />
<meta name="depot_name" content="Azure.azure-documents" />
<meta name="description" content="Build web applications using the Microsoft identity platform implementation of the OAuth 2.0 authentication protocol." />
<meta name="document_id" content="13b44819-ed7b-84bc-f5d2-2b937029f7df" />
<meta name="document_version_independent_id" content="db9f8408-c234-90d0-4817-3516e5fc3ba0" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/azure-docs-pr/blob/afab8acc4fef6d5e093cfc832757d09bfb070405/articles/active-directory/develop/v2-oauth2-auth-code-flow.md" />
<meta name="learn_banner_products" content="azure" />
<meta name="locale" content="en-us" />
<meta name="manager" content="CelesteDG" />
<meta name="ms.author" content="hirsin" />
<meta name="ms.custom" content="aaddev, identityplatformtop40" />
<meta name="ms.date" content="03/29/2021" />
<meta name="ms.reviewer" content="hirsin" />
<meta name="ms.service" content="active-directory" />
<meta name="ms.subservice" content="develop" />
<meta name="ms.topic" content="conceptual" />
<meta name="ms.workload" content="identity" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/azure-docs-pr/blob/live/articles/active-directory/develop/v2-oauth2-auth-code-flow.md" />
<meta name="recommendations" content="true" />
<meta name="schema" content="Conceptual" />
<meta name="search.ms_docsetname" content="azure-documents" />
<meta name="search.ms_product" content="Azure" />
<meta name="search.ms_sitename" content="Docs" />
<meta name="services" content="active-directory" />
<meta name="site_name" content="Docs" />
<meta name="uhfHeaderId" content="azure" />
<meta name="updated_at" content="2021-04-29 11:03 AM" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="toc.json" />
<meta name="pdf_url_template" content="https://docs.microsoft.com/pdfstore/en-us/Azure.azure-documents/{branchName}{pdfName}" />
<meta name="word_count" content="4998" />


	<meta name="scope" content="Azure" />
<link href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow" rel="canonical">
	<title>Microsoft identity platform and OAuth 2.0 authorization code flow - Microsoft identity platform | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/8147a557.site-ltr.css ">

	


	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: 'azure',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: true,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'GitHub',
			feedbackGitHubRepo: 'MicrosoftDocs/azure-docs',
			feedbackProductUrl: 'https://feedback.azure.com/forums/169401-azure-active-directory',
			contentGitUrl: 'https://github.com/MicrosoftDocs/azure-docs/blob/master/articles/active-directory/develop/v2-oauth2-auth-code-flow.md',
			extendBreadcrumb: false,
			isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: true,
			contributors: [
						{ name: "hpsin", url: "https://github.com/hpsin" },
						{ name: "JamesTran-MSFT", url: "https://github.com/JamesTran-MSFT" },
						{ name: "msewaweru", url: "https://github.com/msewaweru" },
						{ name: "rolyon", url: "https://github.com/rolyon" },
						{ name: "amanmcse", url: "https://github.com/amanmcse" },
						{ name: "DCtheGeek", url: "https://github.com/DCtheGeek" },
						{ name: "mmacy", url: "https://github.com/mmacy" },
						{ name: "rwike77", url: "https://github.com/rwike77" },
						{ name: "shashishailaj", url: "https://github.com/shashishailaj" },
						{ name: "FrankHu-MSFT", url: "https://github.com/FrankHu-MSFT" },
						{ name: "CelesteDG", url: "https://github.com/CelesteDG" },
						{ name: "eric-urban", url: "https://github.com/eric-urban" },
						{ name: "nschonni", url: "https://github.com/nschonni" },
						{ name: "AllisonAm", url: "https://github.com/AllisonAm" },
						{ name: "TErenberger", url: "https://github.com/TErenberger" },
						{ name: "v-kents", url: "https://github.com/v-kents" },
						{ name: "JiayueHu", url: "https://github.com/JiayueHu" }
],
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-3.min.js"></script>
	<script>window.onedsAwa = window.awa; delete window.awa;</script>	
	<script src="/static/third-party/jsll/4.3.4/jsll-4.js"></script>
	<script nomodule src="/static/third-party/bluebird/3.5.0/bluebird.min.js" integrity="sha384-aD4BDeDGeLXLpPK4yKeqtZQa9dv4a/7mQ+4L5vwshIYH1Mc2BrXvHd32iHzYCQy5" crossorigin="anonymous"></script>
	<script nomodule src="/static/third-party/fetch/3.0.0/fetch.umd.min.js" integrity="sha384-EQIXrC5K2+7X8nGgLkB995I0/6jfAvvyG1ieZ+WYGxgJHFMD/alsG9fSDWvzb5Y1" crossorigin="anonymous"></script>
	<script nomodule src="/static/third-party/template/1.4.0/template.min.js" integrity="sha384-1zKzI6ldTVHMU7n0W2HpE/lhHI+UG4D9IIaxbj3kT2UhCWicdTuJkTtnKuu0CQzN" crossorigin="anonymous"></script>
	<script nomodule src="/static/third-party/url/0.5.7/url.min.js" integrity="sha384-vn7xBMtpSTfzaTRWxj0kVq0UcsbBrTOgZ/M1ISHqe1V358elYva+lfiEC+T8jLPc" crossorigin="anonymous"></script>
	<script src="/_themes/docs.theme/master/en-us/_themes/scripts/8a64e446.index-polyfills.js"></script>

		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/2777d474.index-docs.js"></script>
</head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 has-padding-medium has-text-centered has-body-background-medium" tabindex="1">Skip to main content</a>
		
		<div id="ignite-banner-holder" class="has-default-focus has-overflow-hidden"></div>
		<div id="build-banner-holder" class="has-default-focus has-overflow-hidden"></div>
		
		<div hidden id="cookie-consent-holder"></div>
		<!-- liquid-tag banners global -->
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
	<div class="nav-bar">
		<div class="nav-bar-brand">
			<a itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft" class="nav-bar-button">
				<div class="nav-bar-logo has-background-image theme-display is-light" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
				<div class="nav-bar-logo has-background-image theme-display is-dark is-high-contrast" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope"></div>
			</a>
		</div>
	</div>
	<div class="nav-bar border-top is-hidden-mobile"></div>
</header>		</div>

						<div class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
					<nav class="breadcrumb-holder has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop flex-grow-1" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
						<ul id="page-breadcrumbs" class="breadcrumbs">
						</ul>
					</nav>
				<div class="content-header-controls">
					<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
				<div class="has-padding-none-tablet has-padding-medium font-size-s display-flex justify-content-space-between flex-grow-1 page-action-holder">
					<ul class="is-hidden-mobile action-list justify-content-flex-start has-flex-justify-content-end-tablet display-flex flex-wrap-wrap flex-grow-1 is-unstyled">
						<li hidden>
							<a id="lang-link" class="button is-text has-inner-focus is-small is-icon-only-touch" title="Read in English" data-bi-name="language-toggle">
								<span id="lang-link-icon" class="icon docon docon-locale-globe" aria-hidden="true"></span>
								<span id="lang-link-text" class="is-visually-hidden-touch is-hidden-portrait"></span>
							</a>
						</li>
						<li>
							<button type="button" class="collection button is-text has-inner-focus is-small is-icon-only-touch" data-list-type="collection" data-bi-name="collection" title="Add to collection">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-circle-addition has-text-primary"></span>
								</span>
								<span class="collection-status is-visually-hidden-touch is-hidden-portrait">Save</span>
							</button>
						</li>
							<li id="feedback-section-link">
								<a href="#feedback" class="button is-text has-inner-focus is-small is-icon-only-touch" data-bi-name="comments" title="Send feedback about this page">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-comment-lines"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
								</a>
							</li>
								<li id="contenteditbtn">
									<a href="https://github.com/MicrosoftDocs/azure-docs/blob/master/articles/active-directory/develop/v2-oauth2-auth-code-flow.md" class="button is-text has-inner-focus is-icon-only-touch is-small" title="Edit This Document" data-bi-name="edit" data-original_content_git_url="https://github.com/MicrosoftDocs/azure-docs-pr/blob/live/articles/active-directory/develop/v2-oauth2-auth-code-flow.md" data-original_content_git_url_template="{repo}/blob/{branch}/articles/active-directory/develop/v2-oauth2-auth-code-flow.md" data-pr_repo="" data-pr_branch="">
									<span class="icon" aria-hidden="true">
										<span class="docon docon-edit-outline"></span>
									</span>
									<span class="is-visually-hidden-touch is-hidden-portrait">Edit</span>
								</a>
							</li>
						<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small is-icon-only-touch" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-twitter" data-bi-name="twitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-linkedin" data-bi-name="linkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-facebook" data-bi-name="facebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth justify-content-flex-start has-inner-focus is-small share-email" data-bi-name="email">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>						</li>
					</ul>
					<button type="button" class="border contents-button button is-small is-text is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
						<span class="icon">
							<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
						</span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<div class="is-invisible"></div>
					<div class="is-hidden-tablet level-item is-flexible level-right">
						<button type="button" class="page-actions-button button is-small is-text is-hidden-tablet has-inner-focus border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
							<span class="icon">
								<span class="docon docon-more-vertical" aria-hidden="true"></span>
							</span>
						</button>
					</div>
				</div>
			</div>



		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="position-fixed display-flex flex-direction-column" role="navigation" aria-label="Primary"></nav>
			</div>

			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<div class="columns is-gapless-mobile has-large-gaps ">


				<div id="main-column" class="column  is-full is-four-fifths-desktop ">

					<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



						<h1 id="microsoft-identity-platform-and-oauth-20-authorization-code-flow">Microsoft identity platform and OAuth 2.0 authorization code flow</h1>

						<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
							<li>
								<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2021-03-29T00:00:00.000Z" data-article-date-source="ms.date">03/29/2021</time>
							</li>
									<li class="readingTime">24 minutes to read</li>
								<li class="contributors-holder">
									<ul class="facepile has-margin-left-none is-small" data-bi-name="contributors">
														<li class="facepile-item">
															<a href="https://github.com/hpsin" title="hpsin" aria-label="hpsinGithub profile" data-src="https://github.com/hpsin.png?size=32" data-contributor-name="hpsin" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/hpsin.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">h</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/JamesTran-MSFT" title="JamesTran-MSFT" aria-label="JamesTran-MSFTGithub profile" data-src="https://github.com/JamesTran-MSFT.png?size=32" data-contributor-name="JamesTran-MSFT" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/JamesTran-MSFT.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">J</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/msewaweru" title="msewaweru" aria-label="msewaweruGithub profile" data-src="https://github.com/msewaweru.png?size=32" data-contributor-name="msewaweru" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/msewaweru.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-blue"aria-hidden="true">m</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/rolyon" title="rolyon" aria-label="rolyonGithub profile" data-src="https://github.com/rolyon.png?size=32" data-contributor-name="rolyon" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/rolyon.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal"aria-hidden="true">r</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/amanmcse" title="amanmcse" aria-label="amanmcseGithub profile" data-src="https://github.com/amanmcse.png?size=32" data-contributor-name="amanmcse" class="facepile-item-coin"
															>
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/amanmcse.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';"/>
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-red"aria-hidden="true">a</span>
															</a>
														</li>
											<li class="facepile-item">
													<button aria-label="View all contributors" class="facepile-item-more" title="View all contributors">
														<div class="facepile-item-coin" aria-hidden="true">
															<span class="facepile-item-coin-text" aria-hidden="true">
																+12
															</span>
														</div>
													</button>
											</li>
									</ul>
								</li>
						</ul>

						<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
							<h3>In this article</h3>
						</nav>

						<!-- <content> -->
							<p>The OAuth 2.0 authorization code grant can be used in apps that are installed on a device to gain access to protected resources, such as web APIs. Using the Microsoft identity platform implementation of OAuth 2.0, you can add sign in and API access to your mobile and desktop apps.</p>
<p>This article describes how to program directly against the protocol in your application using any language.  When possible, we recommend you use the supported Microsoft Authentication Libraries (MSAL) instead to <a href="authentication-flows-app-scenarios#scenarios-and-supported-authentication-flows" data-linktype="relative-path">acquire tokens and call secured web APIs</a>.  Also take a look at the <a href="sample-v2-code" data-linktype="relative-path">sample apps that use MSAL</a>.</p>
<p>The OAuth 2.0 authorization code flow is described in <a href="https://tools.ietf.org/html/rfc6749" data-linktype="external">section 4.1 of the OAuth 2.0 specification</a>. It's used to perform authentication and authorization in the majority of app types, including <a href="v2-app-types#single-page-apps-javascript" data-linktype="relative-path">single page apps</a>, <a href="v2-app-types#web-apps" data-linktype="relative-path">web apps</a>, and <a href="v2-app-types#mobile-and-native-apps" data-linktype="relative-path">natively installed apps</a>. The flow enables apps to securely acquire access_tokens that can be used to access resources secured by the Microsoft identity platform, as well as refresh tokens to get additional access_tokens, and ID tokens for the signed in user.</p>
<h2 id="protocol-diagram">Protocol diagram</h2>
<p>At a high level, the entire authentication flow for an application looks a bit like this:</p>
<p><img src="media/v2-oauth2-auth-code-flow/convergence-scenarios-native.svg" alt="OAuth Auth Code Flow" data-linktype="relative-path"/></p>
<h2 id="redirect-uri-setup-required-for-single-page-apps">Redirect URI setup required for single-page apps</h2>
<p>The authorization code flow for single page applications requires some additional setup.  Follow the instructions for <a href="scenario-spa-app-registration#redirect-uri-msaljs-20-with-auth-code-flow" data-linktype="relative-path">creating your single-page application</a> to correctly mark your redirect URI as enabled for CORS. To update an existing redirect URI to enable CORS, open the manifest editor and set the <code>type</code> field for your redirect URI to <code>spa</code> in the <code>replyUrlsWithType</code> section. You can also click on the redirect URI in the &quot;Web&quot; section of the Authentication tab, and select the URIs you want to migrate to using the authorization code flow.</p>
<p>The <code>spa</code> redirect type is backwards compatible with the implicit flow. Apps currently using the implicit flow to get tokens can move to the <code>spa</code> redirect URI type without issues and continue using the implicit flow.</p>
<p>If you attempt to use the authorization code flow and see this error:</p>
<p><code>access to XMLHttpRequest at 'https://login.microsoftonline.com/common/v2.0/oauth2/token' from origin 'yourApp.com' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.</code></p>
<p>Then, visit your app registration and update the redirect URI for your app to type <code>spa</code>.</p>
<p>Applications cannot use a <code>spa</code> redirect URI with non-SPA flows, for example native applications or client credential flows. To ensure security, Azure AD will return an error if you attempt to use use a <code>spa</code> redirect URI in these scenarios, e.g. from a native app that doesn't send an<code>Origin</code> header.</p>
<h2 id="request-an-authorization-code">Request an authorization code</h2>
<p>The authorization code flow begins with the client directing the user to the <code>/authorize</code> endpoint. In this request, the client requests the <code>openid</code>, <code>offline_access</code>, and <code>https://graph.microsoft.com/mail.read </code> permissions from the user.  Some permissions are admin-restricted, for example writing data to an organization's directory by using <code>Directory.ReadWrite.All</code>. If your application requests access to one of these permissions from an organizational user, the user receives an error message that says they're not authorized to consent to your app's permissions. To request access to admin-restricted scopes, you should request them directly from a Global Administrator.  For more information, read <a href="v2-permissions-and-consent#admin-restricted-permissions" data-linktype="relative-path">Admin-restricted permissions</a>.</p>
<pre><code>// Line breaks for legibility only

https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&amp;response_type=code
&amp;redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&amp;response_mode=query
&amp;scope=https%3A%2F%2Fgraph.microsoft.com%2Fmail.read%20api%3A%2F%2F
&amp;state=12345
&amp;code_challenge=YTFjNjI1OWYzMzA3MTI4ZDY2Njg5M2RkNmVjNDE5YmEyZGRhOGYyM2IzNjdmZWFhMTQ1ODg3NDcxY2Nl
&amp;code_challenge_method=S256
</code></pre>
<div class="TIP">
<p>Tip</p>
<p>Click the link below to execute this request! After signing in, your browser should be redirected to <code>https://localhost/myapp/</code> with a <code>code</code> in the address bar.
<a href="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&amp;response_type=code&amp;redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&amp;response_mode=query&amp;scope=openid%20offline_access%20https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&amp;state=12345" target="_blank" data-linktype="external">https://login.microsoftonline.com/common/oauth2/v2.0/authorize...</a></p>
</div>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required/optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tenant</code></td>
<td>required</td>
<td>The <code>{tenant}</code> value in the path of the request can be used to control who can sign into the application. The allowed values are <code>common</code>, <code>organizations</code>, <code>consumers</code>, and tenant identifiers. For more detail, see <a href="active-directory-v2-protocols#endpoints" data-linktype="relative-path">protocol basics</a>.</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td>required</td>
<td>The <strong>Application (client) ID</strong> that the <a href="https://go.microsoft.com/fwlink/?linkid=2083908" data-linktype="external">Azure portal – App registrations</a> experience assigned to your app.</td>
</tr>
<tr>
<td><code>response_type</code></td>
<td>required</td>
<td>Must include <code>code</code> for the authorization code flow. Can also include <code>id_token</code> or <code>token</code> if using the <a href="#request-an-id-token-as-well-hybrid-flow" data-linktype="self-bookmark">hybrid flow</a>.</td>
</tr>
<tr>
<td><code>redirect_uri</code></td>
<td>required</td>
<td>The redirect_uri of your app, where authentication responses can be sent and received by your app. It must exactly match one of the redirect_uris you registered in the portal, except it must be url encoded. For native &amp; mobile apps, you should use one of the recommended values -  <code>https://login.microsoftonline.com/common/oauth2/nativeclient</code> (for apps using embedded browsers) or <code>http://localhost</code> (for apps that use system browsers).</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>required</td>
<td>A space-separated list of <a href="v2-permissions-and-consent" data-linktype="relative-path">scopes</a> that you want the user to consent to.  For the <code>/authorize</code> leg of the request, this can cover multiple resources, allowing your app to get consent for multiple web APIs you want to call.</td>
</tr>
<tr>
<td><code>response_mode</code></td>
<td>recommended</td>
<td>Specifies the method that should be used to send the resulting token back to your app. Can be one of the following:<br/><br/>- <code>query</code><br/>- <code>fragment</code><br/>- <code>form_post</code><br/><br/><code>query</code> provides the code as a query string parameter on your redirect URI. If you're requesting an ID token using the implicit flow, you can't use <code>query</code> as specified in the <a href="https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html#Combinations" data-linktype="external">OpenID spec</a>. If you're requesting just the code, you can use <code>query</code>, <code>fragment</code>, or <code>form_post</code>. <code>form_post</code> executes a POST containing the code to your redirect URI.</td>
</tr>
<tr>
<td><code>state</code></td>
<td>recommended</td>
<td>A value included in the request that will also be returned in the token response. It can be a string of any content that you wish. A randomly generated unique value is typically used for <a href="https://tools.ietf.org/html/rfc6749#section-10.12" data-linktype="external">preventing cross-site request forgery attacks</a>. The value can also encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</td>
</tr>
<tr>
<td><code>prompt</code></td>
<td>optional</td>
<td>Indicates the type of user interaction that is required. The only valid values at this time are <code>login</code>, <code>none</code>, <code>consent</code>, and <code>select_account</code>.<br/><br/>- <code>prompt=login</code> will force the user to enter their credentials on that request, negating single-sign on.<br/>- <code>prompt=none</code> is the opposite - it will ensure that the user isn't presented with any interactive prompt whatsoever. If the request can't be completed silently via single-sign on, the Microsoft identity platform will return an <code>interaction_required</code> error.<br/>- <code>prompt=consent</code> will trigger the OAuth consent dialog after the user signs in, asking the user to grant permissions to the app.<br/>- <code>prompt=select_account</code> will interrupt single sign-on providing account selection experience listing all the accounts either in session or any remembered account or an option to choose to use a different account altogether.<br/></td>
</tr>
<tr>
<td><code>login_hint</code></td>
<td>optional</td>
<td>Can be used to pre-fill the username/email address field of the sign-in page for the user, if you know their username ahead of time. Often apps will use this parameter during re-authentication, having already extracted the username from a previous sign-in using the <code>preferred_username</code> claim.</td>
</tr>
<tr>
<td><code>domain_hint</code></td>
<td>optional</td>
<td>If included, it will skip the email-based discovery process that user goes through on the sign-in page, leading to a slightly more streamlined user experience - for example, sending them to their federated identity provider. Often apps will use this parameter during re-authentication, by extracting the <code>tid</code> from a previous sign-in. If the <code>tid</code> claim value is <code>9188040d-6c67-4c5b-b112-36a304b66dad</code>, you should use <code>domain_hint=consumers</code>. Otherwise, use <code>domain_hint=organizations</code>.</td>
</tr>
<tr>
<td><code>code_challenge</code></td>
<td>recommended / required</td>
<td>Used to secure authorization code grants via Proof Key for Code Exchange (PKCE). Required if <code>code_challenge_method</code> is included. For more information, see the <a href="https://tools.ietf.org/html/rfc7636" data-linktype="external">PKCE RFC</a>. This is now recommended for all application types - both public and confidential clients - and required by the Microsoft identity platform for <a href="reference-third-party-cookies-spas" data-linktype="relative-path">single page apps using the authorization code flow</a>.</td>
</tr>
<tr>
<td><code>code_challenge_method</code></td>
<td>recommended / required</td>
<td>The method used to encode the <code>code_verifier</code> for the <code>code_challenge</code> parameter. This <em>SHOULD</em> be <code>S256</code>, but the spec allows the use of <code>plain</code> if for some reason the client cannot support SHA256. <br/><br/>If excluded, <code>code_challenge</code> is assumed to be plaintext if <code>code_challenge</code> is included. The Microsoft identity platform supports both <code>plain</code> and <code>S256</code>. For more information, see the <a href="https://tools.ietf.org/html/rfc7636" data-linktype="external">PKCE RFC</a>. This is required for <a href="reference-third-party-cookies-spas" data-linktype="relative-path">single page apps using the authorization code flow</a>.</td>
</tr>
</tbody>
</table>
<p>At this point, the user will be asked to enter their credentials and complete the authentication. The Microsoft identity platform will also ensure that the user has consented to the permissions indicated in the <code>scope</code> query parameter. If the user has not consented to any of those permissions, it will ask the user to consent to the required permissions. Details of <a href="v2-permissions-and-consent" data-linktype="relative-path">permissions, consent, and multi-tenant apps are provided here</a>.</p>
<p>Once the user authenticates and grants consent, the Microsoft identity platform will return a response to your app at the indicated <code>redirect_uri</code>, using the method specified in the <code>response_mode</code> parameter.</p>
<h4 id="successful-response">Successful response</h4>
<p>A successful response using <code>response_mode=query</code> looks like:</p>
<pre><code class="lang-HTTP">GET http://localhost?
code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...
&amp;state=12345
</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>code</code></td>
<td>The authorization_code that the app requested. The app can use the authorization code to request an access token for the target resource. Authorization_codes are short lived, typically they expire after about 10 minutes.</td>
</tr>
<tr>
<td><code>state</code></td>
<td>If a state parameter is included in the request, the same value should appear in the response. The app should verify that the state values in the request and response are identical.</td>
</tr>
</tbody>
</table>
<p>You can also receive an ID token if you request one and have the implicit grant enabled in your application registration.  This is sometimes referred to as the <a href="#request-an-id-token-as-well-hybrid-flow" data-linktype="self-bookmark">&quot;hybrid flow&quot;</a>, and is used by frameworks like ASP.NET.</p>
<h4 id="error-response">Error response</h4>
<p>Error responses may also be sent to the <code>redirect_uri</code> so the app can handle them appropriately:</p>
<pre><code class="lang-HTTP">GET http://localhost?
error=access_denied
&amp;error_description=the+user+canceled+the+authentication
</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>error</code></td>
<td>An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</td>
</tr>
<tr>
<td><code>error_description</code></td>
<td>A specific error message that can help a developer identify the root cause of an authentication error.</td>
</tr>
</tbody>
</table>
<h4 id="error-codes-for-authorization-endpoint-errors">Error codes for authorization endpoint errors</h4>
<p>The following table describes the various error codes that can be returned in the <code>error</code> parameter of the error response.</p>
<table>
<thead>
<tr>
<th>Error Code</th>
<th>Description</th>
<th>Client Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>invalid_request</code></td>
<td>Protocol error, such as a missing required parameter.</td>
<td>Fix and resubmit the request. This is a development error typically caught during initial testing.</td>
</tr>
<tr>
<td><code>unauthorized_client</code></td>
<td>The client application isn't permitted to request an authorization code.</td>
<td>This error usually occurs when the client application isn't registered in Azure AD or isn't added to the user's Azure AD tenant. The application can prompt the user with instruction for installing the application and adding it to Azure AD.</td>
</tr>
<tr>
<td><code>access_denied</code></td>
<td>Resource owner denied consent</td>
<td>The client application can notify the user that it can't proceed unless the user consents.</td>
</tr>
<tr>
<td><code>unsupported_response_type</code></td>
<td>The authorization server does not support the response type in the request.</td>
<td>Fix and resubmit the request. This is a development error typically caught during initial testing. When seen in the <a href="#request-an-id-token-as-well-hybrid-flow" data-linktype="self-bookmark">hybrid flow</a>, signals that you must enable the ID token implicit grant setting on the client app registration.</td>
</tr>
<tr>
<td><code>server_error</code></td>
<td>The server encountered an unexpected error.</td>
<td>Retry the request. These errors can result from temporary conditions. The client application might explain to the user that its response is delayed  to a temporary error.</td>
</tr>
<tr>
<td><code>temporarily_unavailable</code></td>
<td>The server is temporarily too busy to handle the request.</td>
<td>Retry the request. The client application might explain to the user that its response is delayed because of a temporary condition.</td>
</tr>
<tr>
<td><code>invalid_resource</code></td>
<td>The target resource is invalid because it does not exist, Azure AD can't find it, or it's not correctly configured.</td>
<td>This error indicates the resource, if it exists, has not been configured in the tenant. The application can prompt the user with instruction for installing the application and adding it to Azure AD.</td>
</tr>
<tr>
<td><code>login_required</code></td>
<td>Too many or no users found</td>
<td>The client requested silent authentication (<code>prompt=none</code>), but a single user could not found. This may mean there are multiple users active in the session, or no users. This takes into account the tenant chosen (for example, if there are two Azure AD accounts active and one Microsoft account, and <code>consumers</code> is chosen, silent authentication will work).</td>
</tr>
<tr>
<td><code>interaction_required</code></td>
<td>The request requires user interaction.</td>
<td>An additional authentication step or consent is required. Retry the request without <code>prompt=none</code>.</td>
</tr>
</tbody>
</table>
<h3 id="request-an-id-token-as-well-hybrid-flow">Request an ID token as well (hybrid flow)</h3>
<p>To learn who the user is before redeeming an authorization code, it's common for applications to also request an ID token when they request the authorization code. This is called the <em>hybrid flow</em> because it mixes the implicit grant with the authorization code flow. The hybrid flow is commonly used in web apps that want to render a page for a user without blocking on code redemption, notably <a href="quickstart-v2-aspnet-core-webapp" data-linktype="relative-path">ASP.NET</a>. Both single-page apps and traditional web apps benefit from reduced latency in this model.</p>
<p>The hybrid flow is the same as the authorization code flow described earlier but with three additions, all of which are required to request an ID token: new scopes, a new response_type, and a new <code>nonce</code> query parameter.</p>
<pre><code>// Line breaks for legibility only

https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&amp;response_type=code%20id_token
&amp;redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&amp;response_mode=fragment
&amp;scope=openid%20offline_access%20https%3A%2F%2Fgraph.microsoft.com%2Fuser.read
&amp;state=12345
&amp;nonce=abcde
&amp;code_challenge=YTFjNjI1OWYzMzA3MTI4ZDY2Njg5M2RkNmVjNDE5YmEyZGRhOGYyM2IzNjdmZWFhMTQ1ODg3NDcxY2Nl
&amp;code_challenge_method=S256
</code></pre>
<table>
<thead>
<tr>
<th>Updated Parameter</th>
<th>Required/optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>response_type</code></td>
<td>Required</td>
<td>The addition of <code>id_token</code> indicates to the server that the application would like an ID token in the response from the <code>/authorize</code> endpoint.</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>Required</td>
<td>For ID tokens, must be updated to include the ID token scopes - <code>openid</code>, and optionally <code>profile</code> and <code>email</code>.</td>
</tr>
<tr>
<td><code>nonce</code></td>
<td>Required</td>
<td>A value included in the request, generated by the app, that will be included in the resulting id_token as a claim. The app can then verify this value to mitigate token replay attacks. The value is typically a randomized, unique string that can be used to identify the origin of the request.</td>
</tr>
<tr>
<td><code>response_mode</code></td>
<td>Recommended</td>
<td>Specifies the method that should be used to send the resulting token back to your app. Defaults to <code>query</code> for just an authorization code, but <code>fragment</code> if the request includes an id_token <code>response_type</code>.  However, apps are recommended to use <code>form_post</code>, especially when using <code>http:/localhost</code> as a redirect URI.</td>
</tr>
</tbody>
</table>
<p>The use of <code>fragment</code> as a response mode causes issues for web apps that read the code from the redirect, as browsers do not pass the fragment to the web server.  In these situations, apps should use the <code>form_post</code> response mode to ensure that all data is sent to the server.</p>
<h4 id="successful-response-1">Successful response</h4>
<p>A successful response using <code>response_mode=fragment</code> looks like:</p>
<pre><code class="lang-HTTP">GET https://login.microsoftonline.com/common/oauth2/nativeclient#
code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...
&amp;id_token=eYj...
&amp;state=12345
</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>code</code></td>
<td>The authorization code that the app requested. The app can use the authorization code to request an access token for the target resource. Authorization codes are short lived, typically expiring after about 10 minutes.</td>
</tr>
<tr>
<td><code>id_token</code></td>
<td>An ID token for the user, issued via <em>implicit grant</em>. Contains a special <code>c_hash</code> claim that is the hash of the <code>code</code> in the same request.</td>
</tr>
<tr>
<td><code>state</code></td>
<td>If a state parameter is included in the request, the same value should appear in the response. The app should verify that the state values in the request and response are identical.</td>
</tr>
</tbody>
</table>
<h2 id="redeem-a-code-for-an-access-token">Redeem a code for an access token</h2>
<p>All confidential clients have a choice of using client secrets (symmetric shared secrets generated by the Microsoft identity platform) and <a href="active-directory-certificate-credentials" data-linktype="relative-path">certificate credentials</a>(asymmetric keys uploaded by the developer).  For best security, we recommend using certificate credentials. Public clients (native applications and single page apps) must not use secrets or certificates when redeeming an authorization code - always ensure that your redirect URIs correctly indicate the type of application and <a href="reply-url#localhost-exceptions" data-linktype="relative-path">are unique</a>.</p>
<h3 id="request-an-access-token-with-a-client_secret">Request an access token with a client_secret</h3>
<p>Now that you've acquired an authorization_code and have been granted permission by the user, you can redeem the <code>code</code> for an <code>access_token</code> to the desired resource. Do this by sending a <code>POST</code> request to the <code>/token</code> endpoint:</p>
<pre><code class="lang-HTTP">// Line breaks for legibility only

POST /{tenant}/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&amp;scope=https%3A%2F%2Fgraph.microsoft.com%2Fmail.read
&amp;code=OAAABAAAAiL9Kn2Z27UubvWFPbm0gLWQJVzCTE9UkP3pSx1aXxUjq3n8b2JRLk4OxVXr...
&amp;redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&amp;grant_type=authorization_code
&amp;code_verifier=ThisIsntRandomButItNeedsToBe43CharactersLong 
&amp;client_secret=JqQX2PNo9bpM0uEihUPzyrh    // NOTE: Only required for web apps. This secret needs to be URL-Encoded.
</code></pre>
<div class="TIP">
<p>Tip</p>
<p>Try executing this request in Postman! (Don't forget to replace the <code>code</code>)
<a href="https://www.getpostman.com/collections/dba7e9c2e0870702dfc6" data-linktype="external"><img src="media/v2-oauth2-auth-code-flow/runinpostman.png" alt="Try running this request in Postman" data-linktype="relative-path"/></a></p>
</div>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required/optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tenant</code></td>
<td>required</td>
<td>The <code>{tenant}</code> value in the path of the request can be used to control who can sign into the application. The allowed values are <code>common</code>, <code>organizations</code>, <code>consumers</code>, and tenant identifiers. For more detail, see <a href="active-directory-v2-protocols#endpoints" data-linktype="relative-path">protocol basics</a>.</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td>required</td>
<td>The Application (client) ID that the <a href="https://go.microsoft.com/fwlink/?linkid=2083908" data-linktype="external">Azure portal – App registrations</a> page assigned to your app.</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>optional</td>
<td>A space-separated list of scopes. The scopes must all be from a single resource, along with OIDC scopes (<code>profile</code>, <code>openid</code>, <code>email</code>). For a more detailed explanation of scopes, refer to <a href="v2-permissions-and-consent" data-linktype="relative-path">permissions, consent, and scopes</a>. This is a Microsoft extension to the authorization code flow, intended to allow apps to declare the resource they want the token for during token redemption.</td>
</tr>
<tr>
<td><code>code</code></td>
<td>required</td>
<td>The authorization_code that you acquired in the first leg of the flow.</td>
</tr>
<tr>
<td><code>redirect_uri</code></td>
<td>required</td>
<td>The same redirect_uri value that was used to acquire the authorization_code.</td>
</tr>
<tr>
<td><code>grant_type</code></td>
<td>required</td>
<td>Must be <code>authorization_code</code> for the authorization code flow.</td>
</tr>
<tr>
<td><code>code_verifier</code></td>
<td>recommended</td>
<td>The same code_verifier that was used to obtain the authorization_code. Required if PKCE was used in the authorization code grant request. For more information, see the <a href="https://tools.ietf.org/html/rfc7636" data-linktype="external">PKCE RFC</a>.</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td>required for confidential web apps</td>
<td>The application secret that you created in the app registration portal for your app. You shouldn't use the application secret in a native app or single page app because client_secrets can't be reliably stored on devices or web pages. It's required for web apps and web APIs, which have the ability to store the client_secret securely on the server side.  Like all parameters discussed here, the client secret must be URL-encoded before being sent, a step usually performed by the SDK. For more information on uri encoding,  see the <a href="https://tools.ietf.org/html/rfc3986#page-12" data-linktype="external">URI Generic Syntax specification</a>.</td>
</tr>
</tbody>
</table>
<h3 id="request-an-access-token-with-a-certificate-credential">Request an access token with a certificate credential</h3>
<pre><code class="lang-HTTP">POST /{tenant}/oauth2/v2.0/token HTTP/1.1               // Line breaks for clarity
Host: login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&amp;scope=https%3A%2F%2Fgraph.microsoft.com%2Fmail.read
&amp;code=OAAABAAAAiL9Kn2Z27UubvWFPbm0gLWQJVzCTE9UkP3pSx1aXxUjq3n8b2JRLk4OxVXr...
&amp;redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&amp;grant_type=authorization_code
&amp;code_verifier=ThisIsntRandomButItNeedsToBe43CharactersLong
&amp;client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer
&amp;client_assertion=eyJhbGciOiJSUzI1NiIsIng1dCI6Imd4OHRHeXN5amNScUtqRlBuZDdSRnd2d1pJMCJ9.eyJ{a lot of characters here}M8U3bSUKKJDEg
</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required/optional</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tenant</code></td>
<td>required</td>
<td>The <code>{tenant}</code> value in the path of the request can be used to control who can sign into the application. The allowed values are <code>common</code>, <code>organizations</code>, <code>consumers</code>, and tenant identifiers. For more detail, see <a href="active-directory-v2-protocols#endpoints" data-linktype="relative-path">protocol basics</a>.</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td>required</td>
<td>The Application (client) ID that the <a href="https://go.microsoft.com/fwlink/?linkid=2083908" data-linktype="external">Azure portal – App registrations</a> page assigned to your app.</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>optional</td>
<td>A space-separated list of scopes. The scopes must all be from a single resource, along with OIDC scopes (<code>profile</code>, <code>openid</code>, <code>email</code>). For a more detailed explanation of scopes, refer to <a href="v2-permissions-and-consent" data-linktype="relative-path">permissions, consent, and scopes</a>. This is a Microsoft extension to the authorization code flow, intended to allow apps to declare the resource they want the token for during token redemption.</td>
</tr>
<tr>
<td><code>code</code></td>
<td>required</td>
<td>The authorization_code that you acquired in the first leg of the flow.</td>
</tr>
<tr>
<td><code>redirect_uri</code></td>
<td>required</td>
<td>The same redirect_uri value that was used to acquire the authorization_code.</td>
</tr>
<tr>
<td><code>grant_type</code></td>
<td>required</td>
<td>Must be <code>authorization_code</code> for the authorization code flow.</td>
</tr>
<tr>
<td><code>code_verifier</code></td>
<td>recommended</td>
<td>The same code_verifier that was used to obtain the authorization_code. Required if PKCE was used in the authorization code grant request. For more information, see the <a href="https://tools.ietf.org/html/rfc7636" data-linktype="external">PKCE RFC</a>.</td>
</tr>
<tr>
<td><code>client_assertion_type</code></td>
<td>required for confidential web apps</td>
<td>The value must be set to <code>urn:ietf:params:oauth:client-assertion-type:jwt-bearer</code> in order to use a certificate credential.</td>
</tr>
<tr>
<td><code>client_assertion</code></td>
<td>required for confidential web apps</td>
<td>An assertion (a JSON web token) that you need to create and sign with the certificate you registered as credentials for your application. Read about <a href="active-directory-certificate-credentials" data-linktype="relative-path">certificate credentials</a> to learn how to register your certificate and the format of the assertion.</td>
</tr>
</tbody>
</table>
<p>Notice that the parameters are same as in the case of the request by shared secret except that the <code>client_secret</code> parameter is replaced by two parameters: a <code>client_assertion_type</code> and <code>client_assertion</code>.</p>
<h3 id="successful-response-2">Successful response</h3>
<p>A successful token response will look like:</p>
<pre><code class="lang-json">{
    &quot;access_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...&quot;,
    &quot;token_type&quot;: &quot;Bearer&quot;,
    &quot;expires_in&quot;: 3599,
    &quot;scope&quot;: &quot;https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&quot;,
    &quot;refresh_token&quot;: &quot;AwABAAAAvPM1KaPlrEqdFSBzjqfTGAMxZGUTdM0t4B4...&quot;,
    &quot;id_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdWQiOiIyZDRkMTFhMi1mODE0LTQ2YTctOD...&quot;,
}
</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>access_token</code></td>
<td>The requested access token. The  app can use this token to authenticate to the secured resource, such as a web API.</td>
</tr>
<tr>
<td><code>token_type</code></td>
<td>Indicates the token type value. The only type that Azure AD supports is Bearer</td>
</tr>
<tr>
<td><code>expires_in</code></td>
<td>How long the access token is valid (in seconds).</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>The scopes that the access_token is valid for. Optional - this is non-standard, and if omitted the token will be for the scopes requested on the initial leg of the flow.</td>
</tr>
<tr>
<td><code>refresh_token</code></td>
<td>An OAuth 2.0 refresh token. The  app can use this token acquire additional access tokens after the current access token expires. Refresh_tokens are long-lived, and can be used to retain access to resources for extended periods of time. For more detail on refreshing an access token, refer to the <a href="#refresh-the-access-token" data-linktype="self-bookmark">section below</a>. <br> <strong>Note:</strong> Only provided if <code>offline_access</code> scope was requested.</td>
</tr>
<tr>
<td><code>id_token</code></td>
<td>A JSON Web Token (JWT). The  app can decode the segments of this token to request information about the user who signed in. The  app can cache the values and display them, and confidential clients can use this for authorization. For more information about id_tokens, see the <a href="id-tokens" data-linktype="relative-path"><code>id_token reference</code></a>. <br> <strong>Note:</strong> Only provided if <code>openid</code> scope was requested.</td>
</tr>
</tbody>
</table>
<h3 id="error-response-1">Error response</h3>
<p>Error responses will look like:</p>
<pre><code class="lang-json">{
  &quot;error&quot;: &quot;invalid_scope&quot;,
  &quot;error_description&quot;: &quot;AADSTS70011: The provided value for the input parameter 'scope' is not valid. The scope https://foo.microsoft.com/mail.read is not valid.\r\nTrace ID: 255d1aef-8c98-452f-ac51-23d051240864\r\nCorrelation ID: fb3d2015-bc17-4bb9-bb85-30c5cf1aaaa7\r\nTimestamp: 2016-01-09 02:02:12Z&quot;,
  &quot;error_codes&quot;: [
    70011
  ],
  &quot;timestamp&quot;: &quot;2016-01-09 02:02:12Z&quot;,
  &quot;trace_id&quot;: &quot;255d1aef-8c98-452f-ac51-23d051240864&quot;,
  &quot;correlation_id&quot;: &quot;fb3d2015-bc17-4bb9-bb85-30c5cf1aaaa7&quot;
}
</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>error</code></td>
<td>An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</td>
</tr>
<tr>
<td><code>error_description</code></td>
<td>A specific error message that can help a developer identify the root cause of an authentication error.</td>
</tr>
<tr>
<td><code>error_codes</code></td>
<td>A list of STS-specific error codes that can help in diagnostics.</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>The time at which the error occurred.</td>
</tr>
<tr>
<td><code>trace_id</code></td>
<td>A unique identifier for the request that can help in diagnostics.</td>
</tr>
<tr>
<td><code>correlation_id</code></td>
<td>A unique identifier for the request that can help in diagnostics across components.</td>
</tr>
</tbody>
</table>
<h3 id="error-codes-for-token-endpoint-errors">Error codes for token endpoint errors</h3>
<table>
<thead>
<tr>
<th>Error Code</th>
<th>Description</th>
<th>Client Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>invalid_request</code></td>
<td>Protocol error, such as a missing required parameter.</td>
<td>Fix the request or app registration and resubmit the request</td>
</tr>
<tr>
<td><code>invalid_grant</code></td>
<td>The authorization code or PKCE code verifier is invalid or has expired.</td>
<td>Try a new request to the <code>/authorize</code> endpoint and verify that the code_verifier parameter was correct.</td>
</tr>
<tr>
<td><code>unauthorized_client</code></td>
<td>The authenticated client isn't authorized to use this authorization grant type.</td>
<td>This usually occurs when the client application isn't registered in Azure AD or isn't added to the user's Azure AD tenant. The application can prompt the user with instruction for installing the application and adding it to Azure AD.</td>
</tr>
<tr>
<td><code>invalid_client</code></td>
<td>Client authentication failed.</td>
<td>The client credentials aren't valid. To fix, the application administrator updates the credentials.</td>
</tr>
<tr>
<td><code>unsupported_grant_type</code></td>
<td>The authorization server does not support the authorization grant type.</td>
<td>Change the grant type in the request. This type of error should occur only during development and be detected during initial testing.</td>
</tr>
<tr>
<td><code>invalid_resource</code></td>
<td>The target resource is invalid because it does not exist, Azure AD can't find it, or it's not correctly configured.</td>
<td>This indicates the resource, if it exists, has not been configured in the tenant. The application can prompt the user with instruction for installing the application and adding it to Azure AD.</td>
</tr>
<tr>
<td><code>interaction_required</code></td>
<td>Non-standard, as the OIDC specification calls for this only on the <code>/authorize</code> endpoint. The request requires user interaction. For example, an additional authentication step is required.</td>
<td>Retry the <code>/authorize</code> request with the same scopes.</td>
</tr>
<tr>
<td><code>temporarily_unavailable</code></td>
<td>The server is temporarily too busy to handle the request.</td>
<td>Retry the request after a small delay. The client application might explain to the user that its response is delayed because of a temporary condition.</td>
</tr>
<tr>
<td><code>consent_required</code></td>
<td>The request requires user consent. This error is non-standard, as it's usually only returned on the <code>/authorize</code> endpoint per OIDC specifications. Returned when a <code>scope</code> parameter was used on the code redemption flow that the client app does not have permission to request.</td>
<td>The client should send the user back to the <code>/authorize</code> endpoint with the correct scope in order to trigger consent.</td>
</tr>
<tr>
<td><code>invalid_scope</code></td>
<td>The scope requested by the app is invalid.</td>
<td>Update the value of the scope parameter in the authentication request to a valid value.</td>
</tr>
</tbody>
</table>
<div class="NOTE">
<p>Note</p>
<p>Single page apps may receive an <code>invalid_request</code> error indicating that cross-origin token redemption is permitted only for the 'Single-Page Application' client-type.  This indicates that the redirect URI used to request the token has not been marked as a <code>spa</code> redirect URI.  Review the <a href="#redirect-uri-setup-required-for-single-page-apps" data-linktype="self-bookmark">application registration steps</a> on how to enable this flow.</p>
</div>
<h2 id="use-the-access-token">Use the access token</h2>
<p>Now that you've successfully acquired an <code>access_token</code>, you can use the token in requests to web APIs by including it in the <code>Authorization</code> header:</p>
<div class="TIP">
<p>Tip</p>
<p>Execute this request in Postman! (Replace the <code>Authorization</code> header first)
<a href="https://app.getpostman.com/run-collection/f77994d794bab767596d" data-linktype="external"><img src="media/v2-oauth2-auth-code-flow/runinpostman.png" alt="Try running this request in Postman" data-linktype="relative-path"/></a></p>
</div>
<pre><code class="lang-HTTP">GET /v1.0/me/messages
Host: https://graph.microsoft.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
</code></pre>
<h2 id="refresh-the-access-token">Refresh the access token</h2>
<p>Access_tokens are short lived, and you must refresh them after they expire to continue accessing resources. You can do so by submitting another <code>POST</code> request to the <code>/token</code> endpoint, this time providing the <code>refresh_token</code> instead of the <code>code</code>.  Refresh tokens are valid for all permissions that your client has already received consent for - thus, a refresh token issued on a request for <code>scope=mail.read</code> can be used to request a new access token for <code>scope=api://contoso.com/api/UseResource</code>.</p>
<p>Refresh tokens for web apps and native apps do not have specified lifetimes. Typically, the lifetimes of refresh tokens are relatively long. However, in some cases, refresh tokens expire, are revoked, or lack sufficient privileges for the desired action. Your application needs to expect and handle <a href="#error-codes-for-token-endpoint-errors" data-linktype="self-bookmark">errors returned by the token issuance endpoint</a> correctly. Single page apps, however, get a token with a 24-hour lifetime, requiring a new authentication every day.  This can be done silently in an iframe when 3rd party cookies are enabled, but must be done in a top-level frame (either full page navigation or a popup) in browsers without 3rd party cookies such as Safari.</p>
<p>Although refresh tokens aren't revoked when used to acquire new access tokens, you are expected to discard the old refresh token. The <a href="https://tools.ietf.org/html/rfc6749#section-6" data-linktype="external">OAuth 2.0 spec</a> says: &quot;The authorization server MAY issue a new refresh token, in which case the client MUST discard the old refresh token and replace it with the new refresh token. The authorization server MAY revoke the old refresh token after issuing a new refresh token to the client.&quot;</p>
<div class="IMPORTANT">
<p>Important</p>
<p>For refresh tokens sent to a redirect URI registered as <code>spa</code>, the refresh token will expire after 24 hours. Additional refresh tokens acquired using the initial refresh token will carry over that expiration time, so apps must be prepared to re-run the authorization code flow using an interactive authentication to get a new refresh token every 24 hours. Users do not have to enter their credentials, and will usually not even see any UX, just a reload of your application - but the browser must visit the login page in a top level frame in order to see the login session.  This is due to <a href="reference-third-party-cookies-spas" data-linktype="relative-path">privacy features in browsers that block 3rd party cookies</a>.</p>
</div>
<pre><code class="lang-HTTP">
// Line breaks for legibility only

POST /{tenant}/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&amp;scope=https%3A%2F%2Fgraph.microsoft.com%2Fmail.read
&amp;refresh_token=OAAABAAAAiL9Kn2Z27UubvWFPbm0gLWQJVzCTE9UkP3pSx1aXxUjq...
&amp;grant_type=refresh_token
&amp;client_secret=JqQX2PNo9bpM0uEihUPzyrh      // NOTE: Only required for web apps. This secret needs to be URL-Encoded
</code></pre>
<div class="TIP">
<p>Tip</p>
<p>Try executing this request in Postman! (Don't forget to replace the <code>refresh_token</code>)
<a href="https://app.getpostman.com/run-collection/f77994d794bab767596d" data-linktype="external"><img src="media/v2-oauth2-auth-code-flow/runinpostman.png" alt="Try running this request in Postman" data-linktype="relative-path"/></a></p>
</div>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tenant</code></td>
<td>required</td>
<td>The <code>{tenant}</code> value in the path of the request can be used to control who can sign into the application. The allowed values are <code>common</code>, <code>organizations</code>, <code>consumers</code>, and tenant identifiers. For more detail, see <a href="active-directory-v2-protocols#endpoints" data-linktype="relative-path">protocol basics</a>.</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td>required</td>
<td>The <strong>Application (client) ID</strong> that the <a href="https://go.microsoft.com/fwlink/?linkid=2083908" data-linktype="external">Azure portal – App registrations</a> experience assigned to your app.</td>
</tr>
<tr>
<td><code>grant_type</code></td>
<td>required</td>
<td>Must be <code>refresh_token</code> for this leg of the authorization code flow.</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>required</td>
<td>A space-separated list of scopes. The scopes requested in this leg must be equivalent to or a subset of the scopes requested in the original authorization_code request leg. If the scopes specified in this request span multiple resource server, then the Microsoft identity platform will return a token for the resource specified in the first scope. For a more detailed explanation of scopes, refer to <a href="v2-permissions-and-consent" data-linktype="relative-path">permissions, consent, and scopes</a>.</td>
</tr>
<tr>
<td><code>refresh_token</code></td>
<td>required</td>
<td>The refresh_token that you acquired in the second leg of the flow.</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td>required for web apps</td>
<td>The application secret that you created in the app registration portal for your app. It should not be used in a native  app, because client_secrets can't be reliably stored on devices. It's required for web apps and web APIs, which have the ability to store the client_secret securely on the server side. This secret needs to be URL-Encoded. For more information, see the <a href="https://tools.ietf.org/html/rfc3986#page-12" data-linktype="external">URI Generic Syntax specification</a>.</td>
</tr>
</tbody>
</table>
<h4 id="successful-response-3">Successful response</h4>
<p>A successful token response will look like:</p>
<pre><code class="lang-json">{
    &quot;access_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...&quot;,
    &quot;token_type&quot;: &quot;Bearer&quot;,
    &quot;expires_in&quot;: 3599,
    &quot;scope&quot;: &quot;https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&quot;,
    &quot;refresh_token&quot;: &quot;AwABAAAAvPM1KaPlrEqdFSBzjqfTGAMxZGUTdM0t4B4...&quot;,
    &quot;id_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdWQiOiIyZDRkMTFhMi1mODE0LTQ2YTctOD...&quot;,
}
</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>access_token</code></td>
<td>The requested access token. The  app can use this token to authenticate to the secured resource, such as a web API.</td>
</tr>
<tr>
<td><code>token_type</code></td>
<td>Indicates the token type value. The only type that Azure AD supports is Bearer</td>
</tr>
<tr>
<td><code>expires_in</code></td>
<td>How long the access token is valid (in seconds).</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>The scopes that the access_token is valid for.</td>
</tr>
<tr>
<td><code>refresh_token</code></td>
<td>A new OAuth 2.0 refresh token. You should replace the old refresh token with this newly acquired refresh token to ensure your refresh tokens remain valid for as long as possible. <br> <strong>Note:</strong> Only provided if <code>offline_access</code> scope was requested.</td>
</tr>
<tr>
<td><code>id_token</code></td>
<td>An unsigned JSON Web Token (JWT). The  app can decode the segments of this token to request information about the user who signed in. The  app can cache the values and display them, but it should not rely on them for any authorization or security boundaries. For more information about id_tokens, see the <a href="id-tokens" data-linktype="relative-path"><code>id_token reference</code></a>. <br> <strong>Note:</strong> Only provided if <code>openid</code> scope was requested.</td>
</tr>
</tbody>
</table>
<h4 id="error-response-2">Error response</h4>
<pre><code class="lang-json">{
  &quot;error&quot;: &quot;invalid_scope&quot;,
  &quot;error_description&quot;: &quot;AADSTS70011: The provided value for the input parameter 'scope' is not valid. The scope https://foo.microsoft.com/mail.read is not valid.\r\nTrace ID: 255d1aef-8c98-452f-ac51-23d051240864\r\nCorrelation ID: fb3d2015-bc17-4bb9-bb85-30c5cf1aaaa7\r\nTimestamp: 2016-01-09 02:02:12Z&quot;,
  &quot;error_codes&quot;: [
    70011
  ],
  &quot;timestamp&quot;: &quot;2016-01-09 02:02:12Z&quot;,
  &quot;trace_id&quot;: &quot;255d1aef-8c98-452f-ac51-23d051240864&quot;,
  &quot;correlation_id&quot;: &quot;fb3d2015-bc17-4bb9-bb85-30c5cf1aaaa7&quot;
}
</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>error</code></td>
<td>An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</td>
</tr>
<tr>
<td><code>error_description</code></td>
<td>A specific error message that can help a developer identify the root cause of an authentication error.</td>
</tr>
<tr>
<td><code>error_codes</code></td>
<td>A list of STS-specific error codes that can help in diagnostics.</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>The time at which the error occurred.</td>
</tr>
<tr>
<td><code>trace_id</code></td>
<td>A unique identifier for the request that can help in diagnostics.</td>
</tr>
<tr>
<td><code>correlation_id</code></td>
<td>A unique identifier for the request that can help in diagnostics across components.</td>
</tr>
</tbody>
</table>
<p>For a description of the error codes and the recommended client action, see <a href="#error-codes-for-token-endpoint-errors" data-linktype="self-bookmark">Error codes for token endpoint errors</a>.</p>

						<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop border-top has-margin-top-large has-padding-top-large binary-rating-holder">
									
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-large has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small font-size-h4 has-margin-bottom-medium">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-desktop" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons is-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small border-none" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>									</div>
						<!-- end page rating section -->


						<!-- recommendations section -->
							<section id="recommendations-section" data-bi-name="recommendations"></section>
						<!-- end recommendations section -->

						<!-- feedback section -->
<section class="feedback-section position-relative" data-bi-name="feedback-section">

    <h2 id="feedback" class="title is-3 has-margin-top-large">Feedback</h2>

    <div class="alert choose-feedback-type">
        <p aria-hidden="true" id="send-feedback-about">Submit and view feedback for</p>

        <div class="choose-feedback-buttons margin-top-xs">
                <a class="button has-external-link-indicator feedback-type-product has-margin-bottom-small" aria-label="Send feedback about this product" href="https://feedback.azure.com/forums/169401-azure-active-directory" data-bi-name="product-feedback">
                    <span>This product</span>
                </a>

			<a class="button feedback-type-product has-margin-bottom-small github-link" aria-label="Send feedback about this page" data-bi-name="create-issue-on-github">
				<span aria-hidden="true" class="docon docon-brand-github has-padding-right-extra-small"></span>
				<span>This page</span>
			</a>
        </div>
    </div>

    <div class="action-container display-flex justify-content-flex-end has-margin-top-small has-margin-bottom-small">
        <a class="view-on-github has-external-link-indicator" data-bi-name="view-on-github" href="https://github.com/MicrosoftDocs/azure-docs/issues">
            <span aria-hidden="true" class="docon docon-brand-github"></span>
            <span>View all page feedback</span>
        </a>
    </div>
</section>
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="border-top is-visible-interactive has-default-focus has-margin-top-large ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link flex-shrink-0" href="#" data-bi-name="select-locale"><span class="icon docon docon-world font-size-l has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text"></span></a>
		<div class="has-margin-left-medium has-margin-right-medium flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
						</div>
					</div>
					
					<div class="font-size-s right-container column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only" data-bi-name="pageactions" role="complementary" aria-label="Page Actions">
						<div id="affixed-right-container" class="doc-outline position-fixed is-vertically-scrollable">
								
	
	

	<div class="feedback-verbatim border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">

				<h3 class="font-weight-semibold has-margin-top-none has-margin-bottom-small">Is this page helpful?</h3>
			<div>
                <button class="thumb-rating like has-inner-focus" title="Yes" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>Yes</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus" title="No" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>No</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box position-relative box-shadow-none border has-margin-top-small has-padding-extra-small font-size-xs">
                <label for="rating-textarea-mobile" class="visually-hidden">Any additional feedback?</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="Any additional feedback?" required class="textarea border-none box-shadow-none has-inner-focus"></textarea>
		    </div>
			<p class="font-size-xs has-line-height-reset">Feedback will be sent to Microsoft: By pressing the submit button, your feedback will be used to improve Microsoft products and services. <a href="https://privacy.microsoft.com/en-us/privacystatement">Privacy policy.</a></p>
            <div class="buttons is-right margin-top-xs has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small border-none" type="button">Skip</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled type="submit">Submit</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>Thank you.</p>
    </div>
</div>							<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
								<h3>In this article</h3>
							</nav>
						</div>
					</div>

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
		</div>

		<!--end of .mainContainer -->
	</div>

	<section class="border-top has-default-focus is-hidden-interactive has-margin-top-large ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link flex-shrink-0" href="#" data-bi-name="select-locale"><span class="icon docon docon-world font-size-l has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text"></span></a>
		<div class="has-margin-left-medium has-margin-right-medium flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light has-margin-right-small">
						<span
							class="theme-selector-icon css-variable-support border is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast has-margin-right-small">
						<span
							class="border theme-selector-icon css-variable-support is-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>&copy; Microsoft 2021</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>
