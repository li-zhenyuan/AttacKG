<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Grsecurity/The RBAC System - Wikibooks, open books for an open world</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":!1,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"1baab56c-f1a4-4ab6-8948-1574a5cf345b","wgCSPNonce":!1,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Grsecurity/The_RBAC_System","wgTitle":"Grsecurity/The RBAC System","wgCurRevisionId":3451562,"wgRevisionId":3451562,"wgArticleId":207563,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Book:Grsecurity"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Grsecurity/The_RBAC_System","wgRelevantArticleId":207563,"wgIsProbablyEditable":!0,"wgRelevantPageIsProbablyEditable":!0,"wgRestrictionEdit":[],"wgRestrictionMove":[],
"wgFlaggedRevsParams":{"tags":{"value":{"levels":3}}},"wgStableRevisionId":3451562,"wgMediaViewerOnClick":!0,"wgMediaViewerEnabledByDefault":!0,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgMFDisplayWikibaseDescriptions":{"search":!0,"nearby":!0,"watchlist":!0,"tagline":!1},"wgWMESchemaEditAttemptStepOversample":!1,"wgULSCurrentAutonym":"English","wgNoticeProject":"wikibooks","wgCentralAuthMobileDomain":!1,"wgEditSubmitButtonLabelPublish":!0,"wgULSPosition":"interlanguage","wgSiteNoticeId":"2.23"};RLSTATE={"ext.globalCssJs.user.styles":"ready","site.styles":"ready","noscript":"ready","user.styles":"ready","ext.globalCssJs.user":"ready","user":"ready","user.options":"loading","ext.flaggedRevs.icons":"ready","oojs-ui-core.styles":"ready","oojs-ui.styles.indicators":"ready","mediawiki.widgets.styles":"ready","oojs-ui-core.icons":"ready","skins.vector.styles.legacy":"ready","ext.flaggedRevs.basic":"ready",
"ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.interlanguage":"ready","ext.wikimediaBadges":"ready","wikibase.client.init":"ready","ext.dismissableSiteNotice.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js","ext.flaggedRevs.advanced","ext.gadget.wikidialog","ext.gadget.commons-file","ext.centralauth.centralautologin","mmv.head","mmv.bootstrap.autostart","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.eventLogging","ext.wikimediaEvents","ext.navigationTiming","ext.uls.compactlinks","ext.uls.interface","ext.centralNotice.geoIP","ext.centralNotice.startUp","ext.dismissableSiteNotice"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1hzgi",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=ext.dismissableSiteNotice.styles%7Cext.flaggedRevs.basic%2Cicons%7Cext.uls.interlanguage%7Cext.visualEditor.desktopArticleTarget.noscript%7Cext.wikimediaBadges%7Cmediawiki.widgets.styles%7Coojs-ui-core.icons%2Cstyles%7Coojs-ui.styles.indicators%7Cskins.vector.styles.legacy%7Cwikibase.client.init&amp;only=styles&amp;skin=vector"/>
<script async="" src="/w/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.37.0-wmf.6"/>
<meta name="referrer" content="origin"/>
<meta name="referrer" content="origin-when-crossorigin"/>
<meta name="referrer" content="origin-when-cross-origin"/>
<meta property="og:title" content="Grsecurity/The RBAC System - Wikibooks, open books for an open world"/>
<meta property="og:type" content="website"/>
<link rel="preconnect" href="//upload.wikimedia.org"/>
<link rel="alternate" media="only screen and (max-width: 720px)" href="//en.m.wikibooks.org/wiki/Grsecurity/The_RBAC_System"/>
<link rel="alternate" type="application/x-wiki" title="Edit" href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit"/>
<link rel="edit" title="Edit" href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit"/>
<link rel="shortcut icon" href="/static/favicon/wikibooks.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikibooks (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="//en.wikibooks.org/w/api.php?action=rsd"/>
<link rel="license" href="//creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="canonical" href="https://en.wikibooks.org/wiki/Grsecurity/The_RBAC_System"/>
<link rel="dns-prefetch" href="//login.wikimedia.org"/>
<link rel="dns-prefetch" href="//meta.wikimedia.org" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject mw-editable page-Grsecurity_The_RBAC_System rootpage-Grsecurity skin-vector action-view skin-vector-legacy"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"><!-- CentralNotice --><div id="mw-dismissablenotice-anonplace"></div><script>(function(){var node=document.getElementById("mw-dismissablenotice-anonplace");if(node){node.outerHTML="\u003Cdiv class=\"mw-dismissable-notice\"\u003E\u003Cdiv class=\"mw-dismissable-notice-close\"\u003E[\u003Ca tabindex=\"0\" role=\"button\"\u003Edismiss\u003C/a\u003E]\u003C/div\u003E\u003Cdiv class=\"mw-dismissable-notice-body\"\u003E\u003Cdiv id=\"localNotice\" lang=\"en\" dir=\"ltr\"\u003E\u003Cdiv style=\"background: #ffffff; border: solid 1px #48b; width: auto; padding-left:2px; padding-right:2px; margin-left:auto; margin-right:auto; vertical-align: top; display:table; color:black;\"\u003EThe Wikibooks community has accepted \u003Ca href=\"/wiki/Wikibooks:Reading_room/Proposals#Implementation\" title=\"Wikibooks:Reading room/Proposals\"\u003Evideo game strategy guides\u003C/a\u003E on this wiki! See \u003Ca href=\"/wiki/Wikibooks:Strategy_guides\" title=\"Wikibooks:Strategy guides\"\u003EWikibooks:Strategy guides\u003C/a\u003E for the newly-created policy on strategy games. We're looking forward to your contributions.\n\u003C/div\u003E\u003C/div\u003E\u003C/div\u003E\u003C/div\u003E";}}());</script></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading" >Grsecurity/The RBAC System</h1>
	<div id="bodyContent">
		<div id="siteSub" class="noprint">From Wikibooks, open books for an open world</div>
		<div id="contentSub"><span class="subpages">&lt; <a href="/wiki/Grsecurity" title="Grsecurity">Grsecurity</a></span></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><table class="noprint" style="margin:0.5em auto; border:0px; background:#aaaaaa; border-spacing:1px; text-align:center; width:90%;">

<tbody><tr>
<td style="padding:0.25em; background:#6699dd;" colspan="3"><b><a href="/wiki/Grsecurity" title="Grsecurity"><span style="color:#ddddff;">Grsecurity</span></a></b>
</td></tr>
<tr style="background:white;">
<td style="width:30%; padding:0.25em;"><b><a href="/wiki/Grsecurity/Troubleshooting" title="Grsecurity/Troubleshooting">Troubleshooting</a></b>
</td>
<td style="width:40%; padding:0.25em;"><b>The RBAC System</b>
</td>
<td style="width:30%; padding:0.25em;"><b><a href="/wiki/Grsecurity/Application-specific_Settings" title="Grsecurity/Application-specific Settings">Application-specific Settings</a></b>
</td></tr></tbody></table>
<p><br />
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#What_Is_an_RBAC_System?"><span class="tocnumber">1</span> <span class="toctext">What Is an RBAC System?</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Limitations_of_Any_Access_Control_System"><span class="tocnumber">2</span> <span class="toctext">Limitations of Any Access Control System</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Policy_Structure"><span class="tocnumber">3</span> <span class="toctext">Policy Structure</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Policy_Structure_in_a_Nutshell"><span class="tocnumber">3.1</span> <span class="toctext">Policy Structure in a Nutshell</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Rules_for_Policies"><span class="tocnumber">4</span> <span class="toctext">Rules for Policies</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Policy_generalization"><span class="tocnumber">4.1</span> <span class="toctext">Policy generalization</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Special_Cases"><span class="tocnumber">4.2</span> <span class="toctext">Special Cases</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Wildcarded_Objects"><span class="tocnumber">4.3</span> <span class="toctext">Wildcarded Objects</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Roles"><span class="tocnumber">5</span> <span class="toctext">Roles</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#User_Roles"><span class="tocnumber">5.1</span> <span class="toctext">User Roles</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Group_Roles"><span class="tocnumber">5.2</span> <span class="toctext">Group Roles</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Default_Role"><span class="tocnumber">5.3</span> <span class="toctext">Default Role</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Special_Roles"><span class="tocnumber">5.4</span> <span class="toctext">Special Roles</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#Domains"><span class="tocnumber">6</span> <span class="toctext">Domains</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Subjects"><span class="tocnumber">7</span> <span class="toctext">Subjects</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#Capability_Restrictions"><span class="tocnumber">8</span> <span class="toctext">Capability Restrictions</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Resource_Restrictions"><span class="tocnumber">9</span> <span class="toctext">Resource Restrictions</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#RES_CRASH"><span class="tocnumber">9.1</span> <span class="toctext">RES_CRASH</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19"><a href="#Socket_Policies"><span class="tocnumber">10</span> <span class="toctext">Socket Policies</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Per-interface_Socket_Policies"><span class="tocnumber">10.1</span> <span class="toctext">Per-interface Socket Policies</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Inverted_Socket_Policies"><span class="tocnumber">10.2</span> <span class="toctext">Inverted Socket Policies</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="#PaX_Flags"><span class="tocnumber">11</span> <span class="toctext">PaX Flags</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#Flow_of_Matches"><span class="tocnumber">12</span> <span class="toctext">Flow of Matches</span></a>
<ul>
<li class="toclevel-2 tocsection-24"><a href="#Role_Hierarchy"><span class="tocnumber">12.1</span> <span class="toctext">Role Hierarchy</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Subject/Object_Hierarchy"><span class="tocnumber">12.2</span> <span class="toctext">Subject/Object Hierarchy</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Capability_Hierarchy"><span class="tocnumber">12.3</span> <span class="toctext">Capability Hierarchy</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-27"><a href="#Policy_Recommendations"><span class="tocnumber">13</span> <span class="toctext">Policy Recommendations</span></a></li>
<li class="toclevel-1 tocsection-28"><a href="#Sample_Policies"><span class="tocnumber">14</span> <span class="toctext">Sample Policies</span></a></li>
</ul>
</div>

<h2><span id="What_Is_an_RBAC_System.3F"></span><span class="mw-headline" id="What_Is_an_RBAC_System?">What Is an RBAC System?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=1" class="mw-editsection-visualeditor" title="Edit section: What Is an RBAC System?">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=1" title="Edit section: What Is an RBAC System?">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>A <a href="https://en.wikipedia.org/wiki/Role-based_access_control" class="extiw" title="w:Role-based access control">role-based access control</a> (RBAC) system is an approach to restricting system access to authorized users. You need an RBAC system if you want to restrict access to files, capabilities, resources, or sockets to <i>all</i> users, including <a href="https://en.wikipedia.org/wiki/Superuser" class="extiw" title="w:Superuser">root</a>. This is similar to a <a href="https://en.wikipedia.org/wiki/Mandatory_Access_Control" class="extiw" title="w:Mandatory Access Control">Mandatory Access Control</a> (MAC) model. The other features of grsecurity are only effective at fending off attackers trying to gain root, so the RBAC system is used to fill in this gap. Least privilege can be granted to processes, which, in turn, forces attackers to reevaluate their methods of attack, since gaining access to the root account no longer means that they have full access to the system. Access can be explicitly granted to processes that need it, in such a way that root acts as any other user. Though grsecurity and its RBAC system are in no means perfect security, they greatly increase the difficulty of successfully compromising the system.
</p><p>In grsecurity, the RBAC system is managed through a <b>policy</b> file which is essentially a system-wide set of rules. When the RBAC system is activated with <tt>gradm</tt>, the policy file is parsed and checked for security holes, such as granting the default role access to certain sensitive devices and files like the policy file itself. If a security hole is found, <tt>gradm</tt> will refuse to enable the RBAC system, and will give the user a list of things that need to be fixed. The policy file is protected when the RBAC system is active, and only the admin role may access it during that time. To make it easier to create a secure policy, <tt>gradm</tt> has the ability to learn how the system functions, and build a least-privilege policy based on the collected data (see <a href="/wiki/Grsecurity/The_Administration_Utility#Learning_Mode" title="Grsecurity/The Administration Utility">Learning Mode</a>).
</p>
<h2><span class="mw-headline" id="Limitations_of_Any_Access_Control_System">Limitations of Any Access Control System</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=2" class="mw-editsection-visualeditor" title="Edit section: Limitations of Any Access Control System">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=2" title="Edit section: Limitations of Any Access Control System">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>So as not to contribute further to the false sense of security many have regarding access control systems (whether they be grsecurity's RBAC, <a href="https://en.wikipedia.org/wiki/Selinux" class="extiw" title="w:Selinux">SELinux</a>, <a href="https://en.wikipedia.org/wiki/Rsbac" class="extiw" title="w:Rsbac">RSBAC</a>, <a href="https://en.wikipedia.org/wiki/Simplified_Mandatory_Access_Control_Kernel" class="extiw" title="w:Simplified Mandatory Access Control Kernel">SMACK</a>, <a href="https://en.wikipedia.org/wiki/TOMOYO_Linux" class="extiw" title="w:TOMOYO Linux">TOMOYO</a>, <a href="https://en.wikipedia.org/wiki/AppArmor" class="extiw" title="w:AppArmor">AppArmor</a>, etc.) it's important first to describe the limitations of any access control system.
</p><p>There is a fundamental architectural limitation to the kind of guarantees an access control system can provide when the policy decision-making code resides alongside the Operating System's kernel.  A compromise of the Operating System can easily result in compromise of the access control system, and it is common practice for exploits which compromise the kernel to disable any active security systems.
</p><p>Grsecurity is in no way immune to this fundamental limitation, though it does contain several features to help prevent exploitation of the kernel in the first place and furthermore to make the kernel a more hostile environment to an attacker if they do manage to exploit certain types of bugs.  The project will continue to make adding similar protections one of its main goals.
</p><p>Specifically, the following features are involved in kernel self-protection and increasing the difficulty of kernel exploitation:
</p>
<pre>GRKERNSEC_MODHARDEN
GRKERNSEC_HIDESYM
GRKERNSEC_RANDSTRUCT
GRKERNSEC_KSTACKOVERFLOW
PAX_MEMORY_SANITIZE
PAX_MEMORY_UDEREF
PAX_MEMORY_STACKLEAK
PAX_MEMORY_STRUCTLEAK
PAX_CONSTIFY_PLUGIN
PAX_SIZE_OVERFLOW
PAX_KERNEXEC
PAX_RANDKSTACK
PAX_USERCOPY
PAX_REFCOUNT
PAX_RAP
</pre>
<p>There also exist some features of grsecurity which are always active (and thus have no configure-time option) which aid in the above goals.  These include the read-only and non-executable vsyscall page (and its shadow page) on amd64, hardening of the BPF interpreter buffers, and many more.
</p><p>Though these features have been successful at preventing previous vulnerabilities from being exploited (and surely will continue to do so) there have still been many vulnerabilities it did nothing to prevent exploitation of, and there are entire classes of vulnerabilities (such as missing capability checks, some race conditions, etc.) that it can likely never do anything to prevent exploitation of.
</p><p>It's partially due to this fundamental limitation of any access control system that grsecurity's RBAC system was designed as it was: to be as automated as possible, to provide a sufficient level of access control, to have easily editable human-readable configurations, and to enforce secure base policies to eliminate some administrator error.
</p><p>Neither grsecurity's RBAC system nor any other access control system should be used to separate classified information from unclassified information on the same machine.  There is no virtual replacement for a physical air-gap.
</p>
<h2><span class="mw-headline" id="Policy_Structure">Policy Structure</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=3" class="mw-editsection-visualeditor" title="Edit section: Policy Structure">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=3" title="Edit section: Policy Structure">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The policy is made up of roles, subjects and objects. <b>Role</b> is an abstraction that encompasses traditional users and groups that exist in Linux distributions and special roles, that are specific to grsecurity. <b>Subjects</b> are processes or directories, and <b>objects</b> are ﬁles, capabilities, resources, PaX flags, and IP <a href="https://en.wikipedia.org/wiki/Access_control_list" class="extiw" title="w:Access control list">ACLs</a>. The location of the main policy ﬁle is <i>/etc/grsec/policy</i>.
</p>
<h3><span class="mw-headline" id="Policy_Structure_in_a_Nutshell">Policy Structure in a Nutshell</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=4" class="mw-editsection-visualeditor" title="Edit section: Policy Structure in a Nutshell">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=4" title="Edit section: Policy Structure in a Nutshell">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>To see a small example policy, look at the default <i>/etc/grsec/policy</i> file that is installed with <tt>gradm</tt>.  In a nutshell, RBAC policies have the following structure:
</p>
<pre>

 role &lt;role1&gt; &lt;rolemode&gt;
 &lt;role attributes&gt;
 subject / &lt;subject mode&gt;
 &lt;subject attributes&gt;
     / &lt;object mode&gt;
     &lt;extra objects&gt;
     &lt;capability rules&gt;
     &lt;IP ACLs&gt;
     &lt;resource restrictions&gt;
 subject &lt;extra subject&gt; &lt;subject mode&gt;
 &lt;subject attributes&gt;
     / &lt;object mode&gt;
     &lt;extra objects&gt;
    ...
 role &lt;role2&gt; &lt;rolemode&gt;
...

</pre>
<p>Using the default policy as an example:
</p>
<pre>

 role admin sA
 subject / rvka
        / rwcdmlxi

 role default G
 role_transitions admin
 subject /
        /               r
        /opt            rx
        /home           rwxcd
        /mnt            rw
        /dev
        /dev/grsec      h
...

</pre>
<h2><span class="mw-headline" id="Rules_for_Policies">Rules for Policies</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=5" class="mw-editsection-visualeditor" title="Edit section: Rules for Policies">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=5" title="Edit section: Rules for Policies">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Policy_generalization">Policy generalization</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=6" class="mw-editsection-visualeditor" title="Edit section: Policy generalization">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=6" title="Edit section: Policy generalization">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There exist some features of the RBAC system to aid in simplification and generalization of policies.  One of these is the recently added "replace" rule.
The replace rule allows you to assign a string to a variable, and then use that variable within any subject or object pathname to have it replaced with the string.  The syntax of replace rules are:
</p>
<pre> replace &lt;variable name&gt; &lt;replace string&gt;
</pre>
<p>So for example:
</p>
<pre> replace CVSROOT /home/cvs
</pre>
<p>The defined variable can then be used as follows:
</p>
<pre> replace CVSROOT /home/cvs
 replace PUBHTML public_html

 subject $(CVSROOT)/bin/test o
       $(CVSROOT)/grsecurity r
       /home/spender/$(PUBHTML) r
      ...
</pre>
<p>The variables defined with replace rules can be reassigned at any location in the policy.  All rules in the policy until another redefinition of the variable will use that new assigned value for the variable.  For example:
</p>
<pre> replace CVSROOT /home/cvs
 $(CVSROOT)/grsecurity r
 replace CVSROOT /var/cvs
 $(CVSROOT)/test r
</pre>
<p>would cause the following object rules to be created:
</p>
<pre> /home/cvs/grsecurity r
 /var/cvs/test r
</pre>
<h3><span class="mw-headline" id="Special_Cases">Special Cases</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=7" class="mw-editsection-visualeditor" title="Edit section: Special Cases">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=7" title="Edit section: Special Cases">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There are some special cases you should know about when writing policies for the RBAC system.
</p><p>There exist some unique accesses to filesystem objects that require specific object modes.  For instance, a process that connects to a unix domain socket (<i>/dev/log</i> for example) will need "rw" set as the object mode for that socket.
</p><p>Adding the setgid or setuid flag to a path requires the "m" object mode.
</p><p>Creating a hard-link requires at minimum a "cl" object mode.  The remaining object flags must match on the target and the source.
So for instance, if a process is creating a hard-link from /bin/bash to /bin/bash2, example rules would be:
</p>
<pre> /bin/bash rx
 /bin/bash2 rxcl
</pre>
<p>Creating a symlink requires the "wc" object mode.
</p>
<h3><span class="mw-headline" id="Wildcarded_Objects">Wildcarded Objects</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=8" class="mw-editsection-visualeditor" title="Edit section: Wildcarded Objects">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=8" title="Edit section: Wildcarded Objects">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>One very useful feature of the RBAC system is the support of wildcards in objects. The "*" character matches zero or more characters, "?" matches exactly one character, and "[]" can be used to specify an inclusive or exclusive list or range of characters to match. Depending on how these wildcard characters are used, they have different effects. Here are four examples of the use of wildcards:
</p>
<pre>/dev/tty*      rw
/home/*/bin    rwx
/dev/tty[0-9]  rw
/dev/tty?      rw
</pre>
<p>The first example would match <i>/dev/ttya</i>, <i>/dev/tty0</i>, <i>/dev/ttyS0</i>, etc.  Since a '*' at the end of a path can match the '/' character as well, if a '/dev/tty/somefile' path existed, the first example would match it also.
</p><p>The second example would match <i>/home/user1/bin</i>, <i>/home/user2/bin</i>, etc.  Note that this rule would not match the path <i>/home/user1/test/bin</i> as the wildcard characters will not match '/' unless it appears at the end of a path.  To use the particular wildcarded object for this example, a <i>/home</i> object must exist as an "anchor" for the wildcarded object.  If you forget to add one, <b>gradm</b> will remind you.
</p><p>The third example would match <i>/dev/tty0</i>, <i>/dev/tty1</i>,..., <i>/dev/tty9</i> and nothing else.
</p><p>The fourth example would match <i>/dev/ttya</i> and <i>/dev/tty0</i> just like the first example, but would not match <i>/dev/ttyS0</i> since only one character can match the '?' wildcard.
</p><p>Wildcards are evaluated at run-time, providing a powerful way of specifying and simplifying policy.  Since wildcard matching is based off pathnames and not inode/device pairs though, they aren't intended to be used for objects which are known to be hardlinked at policy enable time.
</p>
<h2><span class="mw-headline" id="Roles">Roles</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=9" class="mw-editsection-visualeditor" title="Edit section: Roles">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=9" title="Edit section: Roles">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Roles exist essentially as a container for a set of subjects, put to use in specific scenarios.  There exist user roles, group roles, a default role, and special roles.  See <a href="/wiki/Grsecurity/The_RBAC_System#Flow_of_Matches" title="Grsecurity/The RBAC System">Flow of Matches</a> to see how a role gets matched with a particular process.
</p>
<h3><span class="mw-headline" id="User_Roles">User Roles</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=10" class="mw-editsection-visualeditor" title="Edit section: User Roles">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=10" title="Edit section: User Roles">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In a simplified form, user roles are roles that are automatically applied when a process either is executed by a user of a particular UID or the process changes to that particular UID.  In the RBAC system, the name of a user role must match up with the name of an actual user on the system.
</p><p>A user role looks like:
</p>
<pre>role user1 u
</pre>
<h3><span class="mw-headline" id="Group_Roles">Group Roles</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=11" class="mw-editsection-visualeditor" title="Edit section: Group Roles">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=11" title="Edit section: Group Roles">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>As with user roles, group roles pertain to a particular GID.  The name of the group role must match up with the name of an actual group on the system.  Note that this is tied only to the GID of a process, not to any supplemental groups a process may have.  Group roles are applied for a given process only if a user role does not match the process' UID.
</p><p>A group role looks like:
</p>
<pre>role group1 g
</pre>
<h3><span class="mw-headline" id="Default_Role">Default Role</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=12" class="mw-editsection-visualeditor" title="Edit section: Default Role">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=12" title="Edit section: Default Role">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>If neither a user or group role match a given process, then it is assigned the default role.  The default role should ideally be a role with nearly no access to the system.  It is configured in such a way if full system learning is used.
</p><p>A default role looks like:
</p>
<pre>role default
</pre>
<h3><span class="mw-headline" id="Special_Roles">Special Roles</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=13" class="mw-editsection-visualeditor" title="Edit section: Special Roles">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=13" title="Edit section: Special Roles">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Special roles are to be used for granting extra privilege to normal user accounts.  Some example uses of special roles are to provide an "admin" role that can restart services and edit system configuration files.  Special roles can also be provided for regular users to keep their accounts more secure.  If they have their own <i>public_html</i> directory, the user role for the user could keep this directory read-only, while a special role to which the user is allowed to transition could allow modification of the files in the directory.
</p><p>Special roles come in two flavors, ones that require authentication, and ones that do not.  On the side of special roles that require authentication, the RBAC system supports a flag that allows PAM authentication to be used for the special role.  See <a href="/wiki/Grsecurity/Appendix/Role_Modes" title="Grsecurity/Appendix/Role Modes">Role Modes</a> for a list of all these flags.
</p><p>Special roles by themselves won't do anything unless there exist non-special (user, group, or default) roles that can transition to them.  This transitioning is defined by the <b>role_transitions</b> rule, described in the <a href="/wiki/Grsecurity/Appendix/Role_Attributes" title="Grsecurity/Appendix/Role Attributes">Role Attributes</a> page.
</p><p>To authenticate to a special role, use <tt>gradm -a &lt;rolename&gt;</tt>.
To authenticate with PAM to a special role, use <tt>gradm -p &lt;rolename&gt;</tt>.
To transition to a special role that requires no authentication, use <tt>gradm -n &lt;rolename&gt;</tt>.
</p><p>Special roles look like:
</p>
<pre>role specialauth s

role specialnoauth sN

role specialpamauth sP
</pre>
<h2><span class="mw-headline" id="Domains">Domains</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=14" class="mw-editsection-visualeditor" title="Edit section: Domains">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=14" title="Edit section: Domains">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>With domains you can combine users that don't share a common group ID as well as groups so that they share a single policy. Domains work just like roles, with the only exception being that the line starting with "role" is replaced with one of the following:
</p>
<pre>domain somedomainname u user1 user2 user3 user4... usern
domain somedomainname g group1 group2 group3 group4... groupn
</pre>
<p>Example:
</p>
<pre>domain somedomain u daemon bin www-data
subject /
    /    h
</pre>
<p>As it is with user and group roles, all domain members must exist, and if they're not, an error is raised.
</p>
<h2><span class="mw-headline" id="Subjects">Subjects</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=15" class="mw-editsection-visualeditor" title="Edit section: Subjects">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=15" title="Edit section: Subjects">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Subjects can describe directories, binaries or scripts.  Regular expressions are currently not permitted for subjects.  The ability to place a subject on a script is unique, as it permits one to grant privilege to a specific script instead of generally to the associated script's interpreter.  For this to function properly, make sure the script's interpreter directive does not use <i>#!/usr/bin/env</i> but rather the full path to the interpreter.
</p>
<h2><span class="mw-headline" id="Capability_Restrictions">Capability Restrictions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=16" class="mw-editsection-visualeditor" title="Edit section: Capability Restrictions">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=16" title="Edit section: Capability Restrictions">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>When no capability restriction rules are used for a given subject, all capabilities that the system grants normally to processes within that subject are allowed to be used.  An exception to this is if the subject involved uses policy inheritance.  In that case, the capability restrictions would come from the subject(s) being inherited from.  Capability rules have the form +CAP_NAME or -CAP_NAME.  CAP_ALL is a pseudo-capability meant to describe the entire list of capabilities.  It's mainly used to remove all capability usage for a subject, or in conjunction with a small number of rules granting the ability to use individual capabilities.  Provided below are some example scenarios of capability restriction usage, along with an explanation of how the policy is interpreted.
</p><p><b>Scenario #1:</b>  In this scenario, we're removing all capabilities from <tt>su</tt> but CAP_SETUID and CAP_SETGID.
</p>
<pre> ...
  subject /bin/su o
   ...
    -CAP_ALL
    +CAP_SETUID
    +CAP_SETGID
</pre>
<p><b>Scenario #2:</b>  In this scenario, we're making use of policy inheritance.  Note that the default subject allows CAP_NET_BIND_SERVICE and CAP_NET_RAW.  In our <tt>ping</tt> subject, we're removing CAP_NET_BIND_SERVICE, but since we're inheriting from the default subject (note the lack of the <i>o</i> subject mode on the <tt>ping</tt> subject), we are still allowed CAP_NET_RAW.  Granting important capabilities to default subjects is not something allowed by the RBAC system, so this is just an example.
</p>
<pre> ...
  subject /
   ...
    -CAP_ALL
    +CAP_NET_RAW
    +CAP_NET_BIND_SERVICE
  subject /bin/ping
   ...
    -CAP_NET_BIND_SERVICE
</pre>
<p><b>Auditing and Suppression:</b>  Auditing of attempted capability use and suppression of denied capability usage is possible as well.  Capability auditing and suppression supports the same policy inheritance rules as normal capability rules.  The below example demonstrates auditing the use of CAP_NET_RAW and the suppression of CAP_NET_BIND_SERVICE denials:
</p>
<pre> ...
  subject /
   ...
    -CAP_ALL
    -CAP_NET_BIND_SERVICE suppress
    +CAP_NET_RAW audit
</pre>
<p>For a full listing of the capabilities available, see: <a href="/wiki/Grsecurity/Appendix/Capability_Names_and_Descriptions" title="Grsecurity/Appendix/Capability Names and Descriptions">Capability Names and Descriptions</a>.  Note that not all of the capabilities listed may be supported by your particular version of the Linux kernel.
</p>
<h2><span class="mw-headline" id="Resource_Restrictions">Resource Restrictions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=17" class="mw-editsection-visualeditor" title="Edit section: Resource Restrictions">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=17" title="Edit section: Resource Restrictions">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>One of the features of grsecurity's ACL system is process–based resource restrictions. Using this feature allows you to restrict things like how much memory a process can take up, how much CPU time, how many ﬁles it can open, and how many processes it can execute. Also in this section, we will discuss a "fake" resource implemented in grsecurity's ACL system called "RES_CRASH" that helps guard against bruteforce exploit attempts, which is necessary if you're using PaX.
</p><p>A single resource rule follows the following syntax:
</p>
<pre>&lt;resource name&gt; &lt;soft limit&gt; &lt;hard limit&gt;
</pre>
<p>An example of this syntax would be:
</p>
<pre>RES_NOFILE 3 3
</pre>
<p>This would allow the process to open a maximum of 3 ﬁles (all processes have 3 open ﬁle descriptors at some point: stdin (standard input), stdout (standard output), and stderr (standard error output)).
</p><p>To clarify what the soft limit and hard limit are, the soft limit is the limit assigned to the process when it is run. The hard limit is the maximum point to which a process can raise the limit via <tt>setrlimit(2)</tt>, unless they have CAP_SYS_RESOURCE. In the case of RES_CPU, when the soft limit is overstepped, a special signal is sent to the process continuously. When the hard limit is overstepped, the process is killed. 
</p><p>A person who is less familiar with Linux should stick to setting limits on the number of ﬁles, the address space limit, and number of processes. Of course, you can always use the <a href="/wiki/Grsecurity/The_Administration_Utility#Learning_Mode" title="Grsecurity/The Administration Utility">learning mode</a> of grsecurity to set the resource limits for you. The RES_CPU resource is the only one that accepts time as limits. The time defaults to units of milliseconds. You can also append a case sensitive unit to your limit.
</p><p>Some examples would be:
</p>
<ul><li>100s – 100 seconds</li>
<li>25m – 25 minutes</li>
<li>65h – 65 hours</li>
<li>2d – 2 days</li></ul>
<p>The other resources either operate on a number itself or on a size, in bytes. For these you can use the following units: K, M, and G, like:
</p>
<ul><li>2G – 2 billion</li>
<li>25M – 25 million</li>
<li>100K – 100 thousand</li></ul>
<p>If you don't want any restriction for the soft or hard limit for a resource, you can use "unlimited" as the limit. Here are some more examples to help you understand how this works:
</p>
<pre>subject /bin/bash
       /               r
       /opt            rx
       /home           rwxcd
       /mnt            rw
       /dev
       /dev/grsec      h

       RES_CPU 25m 30m
       RLIMIT_AS 5M 5M
       RLIMIT_NPROC 2 2
       RLIMIT_FSIZE 5K 10K
...
</pre>
<p>For a list of accepted resource names and units, see <a href="/wiki/Grsecurity/Appendix/System_Resources" title="Grsecurity/Appendix/System Resources">System Resources</a>. 
</p>
<h3><span class="mw-headline" id="RES_CRASH">RES_CRASH</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=18" class="mw-editsection-visualeditor" title="Edit section: RES CRASH">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=18" title="Edit section: RES CRASH">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This "fake" resource limit is expressed by using the name "RES_CRASH" and has the following syntax:
</p>
<pre>RES_CRASH &lt;number of crashes&gt; &lt;amt. of time&gt;
</pre>
<p>For example, if you wanted to allow the program to crash once every 30 minutes, you would use the following:
</p>
<pre>RES_CRASH 1 30m
</pre>
<p>What happens when this threshold is reached? Well, the only way to ensure that the process won't crash again is to keep it from being executed. If the process is a suid/sgid binary run by a regular user, we kill all processes of that regular user and keep them from logging in for the amount of time, speciﬁed as the second parameter to the RES_CRASH resource. So for the above example, the user would be locked out of the system for 30 minutes. If the process is not a suid/sguid binary, we simply keep the binary from being run again for the amount of time speciﬁed as the second parameter to the RES_CRASH resource, after killing all processes of that binary.
</p>
<h2><span class="mw-headline" id="Socket_Policies">Socket Policies</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=19" class="mw-editsection-visualeditor" title="Edit section: Socket Policies">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=19" title="Edit section: Socket Policies">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The RBAC system supports policies on what local IP addresses and ports can be reserved on the machine, as well as what remote hosts and ports can be communicated with.  These two different accesses are abstracted to <i>bind</i> and <i>connect</i> rules, respectively.  The syntax for the rules is:
</p>
<pre>  connect &lt;IP/host&gt;/&lt;netmask&gt;:&lt;port/portrange&gt; &lt;socket type 1&gt;... &lt;socket type n&gt; &lt;proto 1&gt;... &lt;proto n&gt;
  bind &lt;IP/host&gt;/&lt;netmask&gt;:&lt;port/portrange&gt; &lt;socket type 1&gt;... &lt;socket type n&gt; &lt;proto 1&gt;... &lt;proto n&gt;

  or:

  connect disabled
  bind disabled
</pre>
<p>"proto" can be any of the protocol names listed in <i>/etc/protocol</i> or "any_proto" to denote any protocol.
"socket type" is most commonly "ip", "dgram", or "stream", but can also be "raw_sock", "rdm", or "any_sock" to denote any socket type.
Most of the parameters for these rules are optional, particularly the netmask and port or port range.  If a port is supplied, then at least an IP address of 0.0.0.0/0 needs to be supplied.
</p><p>As with capability restrictions, resource restrictions, and many other RBAC features, if the socket policies are omitted for a given subject, then the subject is allowed to bind or connect to anything normally allowed by the system.  Note though that if a connect rule is given, then at least one bind rule must also be specified.  Older versions of <tt>gradm</tt> (before the 9/16/09 2.1.14 release) will treat the unspecified rule as a "disabled" rule, whereas new versions will generate an error on such policies.
</p>
<table style="padding:2px; margin:2px;">

<tbody><tr valign="top">
<td><a href="/wiki/File:Nuvola_apps_important.svg" class="image" title="Warning"><img alt="Warning" src="//upload.wikimedia.org/wikipedia/commons/thumb/f/f7/Nuvola_apps_important.svg/32px-Nuvola_apps_important.svg.png" decoding="async" width="32" height="27" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/f/f7/Nuvola_apps_important.svg/48px-Nuvola_apps_important.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/f/f7/Nuvola_apps_important.svg/64px-Nuvola_apps_important.svg.png 2x" data-file-width="600" data-file-height="500" /></a>
</td>
<td style="background-color:#fff0f0; border-left: 4px solid red; padding-left: 6px;">Unlike with file objects and capabilities, policy inheritance has not been implemented for socket policies.  Therefore, the socket policies for a given subject are solely determined by that subject alone.
</td></tr></tbody></table>
<p>Here are some example rules:
</p>
<pre>  subject /usr/bin/ssh o
 ...
  connect 192.168.0.0/24:22 stream tcp
  connect ourdnsserver.com:53 dgram udp
</pre>
<p>In this example, <tt>ssh</tt> is allowed to connect to ssh servers anywhere on the class C 192.168.0.X network.  It is also allowed to do DNS lookups through the host specified.  The hostname is resolved at the time the RBAC system is enabled.
</p>
<pre>  subject /usr/bin/nc o
 ...
  bind 0.0.0.0/0:1024-65535 stream tcp
  connect 22.22.22.22:5190 stream tcp
</pre>
<p>In this example, <tt>netcat</tt> is allowed to listen on ports 1024 through 65535 on any local interface for TCP connections.  It is also able to connect to TCP port 5190 of the 22.22.22.22 host.
</p>
<pre>  subject /bin/strange o
 ...
  bind disabled
  connect 192.168.1.5:6000-6006 stream tcp
</pre>
<p>This example illustrates how you can have bind disabled but still specify connect rules, or conversely, have connect disabled and only specify bind rules.
</p><p>As you can see from the examples above, you can have as many socket policies as you wish for a given subject, and as you'll read below there are some powerful extensions to the socket policies.
</p>
<h3><span class="mw-headline" id="Per-interface_Socket_Policies">Per-interface Socket Policies</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=20" class="mw-editsection-visualeditor" title="Edit section: Per-interface Socket Policies">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=20" title="Edit section: Per-interface Socket Policies">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Rules such as:
</p>
<pre>bind eth1:80 stream tcp
bind eth0#1:22 stream tcp
</pre>
<p>are allowed, giving you the ability to tie specific socket rules to a single interface (or by using the inverted rules mentioned below, all but one interface).  Virtual interfaces are specified by the &lt;ifname&gt;#&lt;vindex&gt; syntax.  If an interface is specified, no IP/netmask or host may be specified for the rule.
</p>
<h3><span class="mw-headline" id="Inverted_Socket_Policies">Inverted Socket Policies</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=21" class="mw-editsection-visualeditor" title="Edit section: Inverted Socket Policies">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=21" title="Edit section: Inverted Socket Policies">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Rules such as:
</p>
<pre>connect&#160;! www.google.com:80 stream tcp
</pre>
<p>are allowed, which allows you to specify that a process can connect to anything except to port 80 of www.google.com with a stream TCP socket.  The inverted socket matching also works on bind rules.
</p>
<h2><span class="mw-headline" id="PaX_Flags">PaX Flags</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=22" class="mw-editsection-visualeditor" title="Edit section: PaX Flags">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=22" title="Edit section: PaX Flags">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In more recent versions of the RBAC system, PaX flags have been changed from single-letter subject modes to more closely resemble how capabilities are handled within the policy.  Therefore, PaX flags can now be fully controlled on or off for any given subject by adding +PAX_&lt;feature&gt; or -PAX_&lt;feature&gt; within the scope of a subject.  For a full listing of the PaX flags available, see: <a href="/wiki/Grsecurity/Appendix/PaX_Flags" title="Grsecurity/Appendix/PaX Flags">PaX Flags</a>.
</p>
<h2><span class="mw-headline" id="Flow_of_Matches">Flow of Matches</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=23" class="mw-editsection-visualeditor" title="Edit section: Flow of Matches">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=23" title="Edit section: Flow of Matches">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Each process on the system has a role and a subject attached to it.  This section describes how a process is matched to a role and subject, and how matches are calculated against the objects and capabilities they use.  Understanding the flow of matches is necessary for manually creating policies.
</p>
<h3><span class="mw-headline" id="Role_Hierarchy">Role Hierarchy</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=24" class="mw-editsection-visualeditor" title="Edit section: Role Hierarchy">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=24" title="Edit section: Role Hierarchy">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>When determining a role for a process, the RBAC system matches based on the following role hierarchy, from most specific to least specific:
</p>
<pre> user -&gt; group -&gt; default
</pre>
<p>Both user and group roles are permitted to have the <tt>role_allow_ip</tt> attributes.  When checking the UID or GID against the user or group role, respectively, the <tt>role_allow_ip</tt> attributes come into play.  Imagine the following policy:
</p>
<pre>role user1 u
role_allow_ip 192.168.1.5
...
</pre>
<p>If someone attempted to log in to the machine as user1 from any IP address other than 192.168.1.5, they would not be assigned the user1 role.  The matching system would then fall back on trying to find an acceptable group role, or if one could not be found, fall back to the default role.
</p>
<h3><span id="Subject.2FObject_Hierarchy"></span><span class="mw-headline" id="Subject/Object_Hierarchy">Subject/Object Hierarchy</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=25" class="mw-editsection-visualeditor" title="Edit section: Subject/Object Hierarchy">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=25" title="Edit section: Subject/Object Hierarchy">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Hierarchy for subjects and objects involves matching a most specific pathname over a less specific pathname.  So, if a <i>/bin</i> object exists, and a <i>/bin/ping</i> object exists, and a process is attempting to read <i>/bin/ping</i>, the <i>/bin/ping</i> object would be the one matching.  If <i>/bin/su</i> were being accessed instead, then <i>/bin</i> would match.
</p><p>The path from most specific to least specific pathname isn't linear however, particularly in the case of subjects using policy inheritance.  Imagine the following policy:
</p>
<pre>role user1 u
  subject /
    / r
    /tmp rwcd
    /usr/bin rx
    /root r
    /root/test/blah r
   ...
  subject /usr/bin/specialbin
    /root/test rw
   ...
</pre>
<p>If <i>/root/test/blah</i> was being accessed by <i>/usr/bin/specialbin</i>, it would not be able to write to it.  The reason for this is that when going from most specific to least specific for a given path (which involves stripping off each trailing path component and attempting a match for the resulting pathname), the matching algorithm will look (in order from most specific to least specific) in each of the subjects the current subject inherits from.  In this case, the algorithm saw that no object existed for <i>/root/test/blah</i> in the <i>/usr/bin/specialbin</i> subject, so upon checking the subject for <i>/</i> it found a <i>/root/test/blah</i> object, thus resulting in the read-only permission.
</p><p>When going from most specific to least specific, a globbed object such as <i>/home/*</i> is treated as less specific than <i>/home/blah</i> (if the requested access is for <i>/home/blah</i>).  Globbed objects are matched in the order in which they're listed in the RBAC policy.  So in the following example:
</p>
<pre>role user1 u
  subject /
     / r
     /home r
     /home/* r
     /home/test* rw
    ...
</pre>
<p>If a process were accessing <i>/home/testing/somefile</i> it would only be allowed to read it, since the <i>/home/*</i> rule was listed first.  It was likely that the policy writer didn't intend this behavior (because the <i>/home/test*</i> rule would never match) so the <i>/home/test*</i> object should be swapped to the line the <i>/home/*</i> object is on.
</p>
<h3><span class="mw-headline" id="Capability_Hierarchy">Capability Hierarchy</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=26" class="mw-editsection-visualeditor" title="Edit section: Capability Hierarchy">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=26" title="Edit section: Capability Hierarchy">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>When determining whether a capability is granted or not, the RBAC system works from most specific subject to least specific (in the case of policy inheritance).  The first subject along that path that mentions the capability in question is the one that matches.  To illustrate:
</p>
<pre>role user1 u
  subject /
   ...
    -CAP_ALL
    +CAP_NET_BIND_SERVICE
  subject /bin
   ...
    -CAP_NET_BIND_SERVICE
  subject /bin/su
   ...
    +CAP_SETUID
    +CAP_SETGID
</pre>
<p>In this example, <i>/bin/su</i> is able to use only CAP_SETUID and CAP_SETGID.  A lookup on CAP_NET_BIND_SERVICE would fall back to the <i>/bin</i> subject, since <i>/bin/su</i> inherits from it and did not explicitly list a rule for CAP_NET_BIND_SERVICE.  The <i>/bin</i> subject specifies that CAP_NET_BIND_SERVICE be disallowed.  Matching against another capability, CAP_SYS_ADMIN for instance, would end up falling back to the <i>/</i> subject, where it would match -CAP_ALL and be denied.
</p>
<h2><span class="mw-headline" id="Policy_Recommendations">Policy Recommendations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=27" class="mw-editsection-visualeditor" title="Edit section: Policy Recommendations">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=27" title="Edit section: Policy Recommendations">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Try to remove as many capabilities from default subjects as possible. The more you remove, the closer root comes to acting as a regular user. The more capabilities you remove, however, the more subjects you will have to create for programs that need those capabilities.  The RBAC system will enforce that a minimum level of capabilities be removed from all default subjects.
</p><p>Use full system learning. It will generate a better policy than you would have generated by hand.  Make sure you're making full use of the <i>/etc/grsec/learn_config</i> file to specify the files and directories particular to your system that you want protected.  <tt>gradm</tt> will do all the heavy lifting of creating privilege boundaries for processes that access or modify important data.
</p><p>Administrative programs, such as shutdown or reboot, should require authentication instead of giving everyone the capabilities to run them.
</p><p>Always inspect your kernel logs.  The RBAC system provides a great amount of human-readable information in every kernel log.  Of particular importance is what role and subject were assigned to the process causing an alert.  If you think that the alert doesn't match up with what you expect from your policy, make sure that the role and subject actually match.  If they don't, then you may have issues with a <i>role_allow_ip</i> rule that's preventing the proper role from being applied.
</p><p>Familiarize yourself with Linux’s capabilities and what they cover.  A full listing of them is available here: 
<a href="/wiki/Grsecurity/Appendix/Capability_Names_and_Descriptions" title="Grsecurity/Appendix/Capability Names and Descriptions">Capability Names and Descriptions</a>.
</p><p>Avoid using policy inheritance until you understand fully how it forms the policy for a given subject.  Even then, use it sparingly, reserving it generally for cases where a default subject is configured least privilege, with no readable/writable/executable objects and no capabilities.
</p><p>Wherever possible, avoid granting both write and execute permission to objects.  This gives a potential attacker the ability to execute arbitrary code.  Similar to how PaX prevents arbitrary code execution within a given process' address space, one of your goals in creating policies is to prevent this on the file system as well.
</p><p>Be careful using the suppression ('s') object flag, especially when applying it to / to ignore accesses a program does not really need to operate correctly.  A change in glibc or another library the subject uses could cause the application to fail in a way that will be difficult to debug (unless your first step is to remove the suppression flag).
</p>
<h2><span class="mw-headline" id="Sample_Policies">Sample Policies</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit&amp;section=28" class="mw-editsection-visualeditor" title="Edit section: Sample Policies">edit</a><span class="mw-editsection-divider"> | </span><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit&amp;section=28" title="Edit section: Sample Policies">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Below is the sample policy provided with a <tt>gradm</tt> installation:
</p>
<pre>role admin sA
subject / rvka
        / rwcdmlxi

role default G
role_transitions admin
subject /
        /               r
        /opt            rx
        /home           rwxcd
        /mnt            rw
        /dev
        /dev/grsec      h
        /dev/urandom    r
        /dev/random     r
        /dev/zero       rw
        /dev/input      rw
        /dev/psaux      rw
        /dev/null       rw
        /dev/tty?       rw
        /dev/console    rw
        /dev/tty        rw
        /dev/pts        rw
        /dev/ptmx       rw
        /dev/dsp        rw
        /dev/mixer      rw
        /dev/initctl    rw
        /dev/fd0        r
        /dev/cdrom      r
        /dev/mem        h
        /dev/kmem       h
        /dev/port       h
        /bin            rx
        /sbin           rx
        /lib            rx
        /usr            rx
# compilation of kernel code should be done within the admin role
        /usr/src        h
        /etc            rx
        /proc           rwx
        /proc/slabinfo  h
        /proc/kcore     h
        /proc/modules   h
        /proc/sys       r
        /root           r
        /tmp            rwcd
        /var            rwxcd
        /var/tmp        rwcd
        /var/log        r
# hide the kernel images and modules
        /boot           h
        /lib/modules    h
        /etc/grsec      h
        /etc/ssh        h

# if sshd needs to be restarted, it can be done through the admin role
# restarting sshd should be followed immediately by a gradm -u
        /usr/sbin/sshd

        -CAP_KILL
        -CAP_SYS_TTY_CONFIG
        -CAP_LINUX_IMMUTABLE
        -CAP_NET_RAW
        -CAP_MKNOD
        -CAP_SYS_ADMIN
        -CAP_SYS_RAWIO
        -CAP_SYS_MODULE
        -CAP_SYS_PTRACE
        -CAP_NET_ADMIN
        -CAP_NET_BIND_SERVICE
        -CAP_NET_RAW
        -CAP_SYS_CHROOT
        -CAP_SYS_BOOT

#       RES_AS 100M 100M

#       connect 192.168.1.0/24:22 stream tcp
#       bind    0.0.0.0 stream dgram tcp udp

# the d flag protects /proc fd and mem entries for sshd
# all daemons should have 'p' in their subject mode to prevent
# an attacker from killing the service (and restarting it with trojaned
# config file or taking the port it reserved to run a trojaned service)

subject /usr/sbin/sshd dpo
        /               h
        /bin/bash       x
        /dev            h
        /dev/log        rw
        /dev/random     r
        /dev/urandom    r
        /dev/null       rw
        /dev/ptmx       rw
        /dev/pts        rw
        /dev/tty        rw
        /dev/tty?       rw
        /etc            r
        /etc/grsec      h
        /home
        /lib            rx
        /root
        /proc           r
        /proc/kcore     h
        /proc/sys       h
        /usr/lib        rx
        /usr/share/zoneinfo r
        /var/log
        /var/mail
        /var/log/lastlog        rw
        /var/log/wtmp           w
        /var/run/sshd
        /var/run/utmp           rw

        -CAP_ALL
        +CAP_CHOWN
        +CAP_SETGID
        +CAP_SETUID
        +CAP_SYS_CHROOT
        +CAP_SYS_RESOURCE
        +CAP_SYS_TTY_CONFIG

subject /usr/X11R6/bin/XFree86
        /dev/mem        rw

        +CAP_SYS_ADMIN
        +CAP_SYS_TTY_CONFIG
        +CAP_SYS_RAWIO

        -PAX_SEGMEXEC
        -PAX_PAGEEXEC
        -PAX_MPROTECT

subject /usr/bin/ssh
        /etc/ssh/ssh_config r

subject /sbin/klogd
        +CAP_SYS_ADMIN

subject /sbin/syslog-ng
        +CAP_SYS_ADMIN

subject /usr/sbin/cron
        /dev/log rw

subject /bin/login
        /dev/log rw
        /var/log/wtmp w
        /var/log/faillog rwcd

subject /sbin/getty
        /var/log/wtmp w

subject /sbin/init
        /var/log/wtmp w
</pre>
<p>Below is a full user role policy that covers the behavior of <tt>cvs-pserver</tt> when run as the non-root cvs user, providing anonymous read-only CVS repository access.
</p>
<pre>role cvs u
   subject /
      /     h
      -CAP_ALL
      connect   disabled
      bind      disabled

   subject /usr/bin/cvs
      /
      /etc/fstab         r
      /etc/mtab          r
      /etc/passwd        r
      /proc/meminfo      r
      /dev/urandom       r
      /dev/log           rw
      /dev/null          rw
      /home/cvs          r
      /home/cvs/CVSROOT/val-tags  rw
      /home/cvs/CVSROOT/history   ra
      /tmp               rwcd
      /var/lock/cvs      rwcd
      /var/run/.nscd_socket       rw
      /proc/sys/kernel   r
      /var/run
</pre>
<p>Here's all that's needed for an unprivileged sshd account:
</p>
<pre>role sshd u
   subject /
      /  h
      /var/run/sshd r
      -CAP_ALL
      bind disabled
      connect disabled
</pre>
<div class="noprint" style="margin-top: 2em; border-top: 1px solid black">
<p><i>Next Page: <a href="/wiki/Grsecurity/Application-specific_Settings" title="Grsecurity/Application-specific Settings">Application-specific Settings</a></i> | 
<small>Previous Page: <a href="/wiki/Grsecurity/Troubleshooting" title="Grsecurity/Troubleshooting">Troubleshooting</a></small>
</p><p><small>Home: <a href="/wiki/Grsecurity" title="Grsecurity">Grsecurity</a></small>
</p>
</div>
<!-- 
NewPP limit report
Parsed by mw1264
Cached time: 20210515010230
Cache expiry: 2592000
Reduced expiry: false
Complications: []
CPU time usage: 0.133 seconds
Real time usage: 0.168 seconds
Preprocessor visited node count: 707/1000000
Post‐expand include size: 2853/2097152 bytes
Template argument size: 2078/2097152 bytes
Highest expansion depth: 16/40
Expensive parser function count: 0/500
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 8534/5000000 bytes
Lua time usage: 0.042/10.000 seconds
Lua memory usage: 1369185/52428800 bytes
Number of Wikibase entities loaded: 0/400
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  112.065      1 -total
 66.14%   74.118      1 Template:Navigate
 43.69%   48.963      3 Template:BOOKCATEGORY
 37.43%   41.944      1 Template:BOOKNAME
 33.27%   37.284      1 Template:BOOKNAME/core
 25.36%   28.422      2 Template:BookCat
 24.17%   27.081      5 Template:Evalx
 21.76%   24.389      1 Template:BOOKSORTKEY
 21.72%   24.338      1 Template:Auto_navigation
 19.04%   21.333      2 Template:BOOKPAGENAME
-->

<!-- Saved in parser cache with key enwikibooks:pcache:idhash:207563-0!canonical and timestamp 20210515010230 and revision id 3451562. Serialized with JSON.
 -->
</div><noscript><img src="//en.wikibooks.org/wiki/Special:CentralAutoLogin/start?type=1x1" alt="" title="" width="1" height="1" style="border: none; position: absolute;" /></noscript>
<div class="printfooter">Retrieved from "<a dir="ltr" href="https://en.wikibooks.org/w/index.php?title=Grsecurity/The_RBAC_System&amp;oldid=3451562">https://en.wikibooks.org/w/index.php?title=Grsecurity/The_RBAC_System&amp;oldid=3451562</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/wiki/Category:Book:Grsecurity" title="Category:Book:Grsecurity">Book:Grsecurity</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label" role="navigation" 
	 >
	<h3 id="p-personal-label" class="vector-menu-heading">
		<span>Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"><li id="pt-anonuserpage">Not logged in</li><li id="pt-anontalk"><a href="/wiki/Special:MyTalk" title="Discussion about edits from this IP address [n]" accesskey="n">Discussion for this IP address</a></li><li id="pt-anoncontribs"><a href="/wiki/Special:MyContributions" title="A list of edits made from this IP address [y]" accesskey="y">Contributions</a></li><li id="pt-createaccount"><a href="/w/index.php?title=Special:CreateAccount&amp;returnto=Grsecurity%2FThe+RBAC+System" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Grsecurity%2FThe+RBAC+System" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu vector-menu-tabs" aria-labelledby="p-namespaces-label" role="navigation" 
	 >
	<h3 id="p-namespaces-label" class="vector-menu-heading">
		<span>Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected"><a href="/wiki/Grsecurity/The_RBAC_System" title="View the content page [c]" accesskey="c">Book</a></li><li id="ca-talk"><a href="/wiki/Talk:Grsecurity/The_RBAC_System" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li></ul>
		
	</div>
</nav>

			<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation" 
	 >
	<input type="checkbox" class="vector-menu-checkbox" aria-labelledby="p-variants-label" />
	<h3 id="p-variants-label" class="vector-menu-heading">
		<span>Variants</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu vector-menu-tabs" aria-labelledby="p-views-label" role="navigation" 
	 >
	<h3 id="p-views-label" class="vector-menu-heading">
		<span>Views</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected"><a href="/wiki/Grsecurity/The_RBAC_System">Read</a></li><li id="ca-ve-edit"><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;veaction=edit" title="Edit this page [v]" accesskey="v">Edit</a></li><li id="ca-edit" class="collapsible"><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=edit" title="Edit this page [e]" accesskey="e">Edit source</a></li><li id="ca-history"><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></li></ul>
		
	</div>
</nav>

			<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation" 
	 >
	<input type="checkbox" class="vector-menu-checkbox" aria-labelledby="p-cactions-label" />
	<h3 id="p-cactions-label" class="vector-menu-heading">
		<span>More</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			<div id="p-search" role="search" >
	<h3 >
		<label for="searchInput">Search</label>
	</h3>
	<form action="/w/index.php" id="searchform">
		<div id="simpleSearch" data-search-loc="header-navigation">
			<input type="search" name="search" placeholder="Search Wikibooks" autocapitalize="sentences" title="Search Wikibooks [f]" accesskey="f" id="searchInput"/>
			<input type="hidden" name="title" value="Special:Search"/>
			<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/>
			<input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>
		</div>
	</form>
</div>

		</div>
	</div>
	
<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="/wiki/Main_Page"
			title="Visit the main page"></a>
	</div>
	<nav id="p-Navigation" class="mw-portlet mw-portlet-Navigation vector-menu vector-menu-portal portal" aria-labelledby="p-Navigation-label" role="navigation" 
	 >
	<h3 id="p-Navigation-label" class="vector-menu-heading">
		<span>Navigation</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"><li id="n-mainpage"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main Page</a></li><li id="n-help"><a href="/wiki/Help:Contents" title="Find help on how to use and edit Wikibooks">Help</a></li><li id="n-Browse"><a href="/wiki/Wikibooks:Card_Catalog_Office" title="Check out what Wikibooks has to offer">Browse</a></li><li id="n-Cookbook"><a href="/wiki/Cookbook:Table_of_Contents" title="Learn recipes from around the world">Cookbook</a></li><li id="n-Wikijunior"><a href="/wiki/Wikijunior" title="Books for children">Wikijunior</a></li><li id="n-Featured-books"><a href="/wiki/Wikibooks:Featured_books" title="The best of Wikibooks">Featured books</a></li><li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-sitesupport"><a href="//donate.wikimedia.org/wiki/Special:FundraiserRedirector?utm_source=donate&amp;utm_medium=sidebar&amp;utm_campaign=C13_en.wikibooks.org&amp;uselang=en" title="Support Wikibooks">Donations</a></li><li id="n-randomrootpage"><a href="/wiki/Special:RandomInCategory/Book:Wikibooks_Stacks/Books">Random book</a></li><li id="n-Using-Wikibooks"><a href="/wiki/Using_Wikibooks">Using Wikibooks</a></li></ul>
		
	</div>
</nav>

	<nav id="p-Community" class="mw-portlet mw-portlet-Community vector-menu vector-menu-portal portal" aria-labelledby="p-Community-label" role="navigation" 
	 >
	<h3 id="p-Community-label" class="vector-menu-heading">
		<span>Community</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"><li id="n-Reading-room-forum"><a href="/wiki/Wikibooks:Reading_room">Reading room forum</a></li><li id="n-portal"><a href="/wiki/Wikibooks:Community_Portal" title="Find your way around the Wikibooks community">Community portal</a></li><li id="n-currentevents"><a href="/wiki/Wikibooks:Reading_room/Bulletin_Board" title="Important community news">Bulletin Board</a></li><li id="n-maintenance"><a href="/wiki/Wikibooks:Maintenance" title="Frequent tasks that you can help with">Help out!</a></li><li id="n-Policies-and-guidelines"><a href="/wiki/Wikibooks:Policies_and_guidelines" title="Pages detailing important rules and procedures">Policies and guidelines</a></li><li id="n-contact"><a href="/wiki/Wikibooks:Contact_us" title="Alternative methods of communication">Contact us</a></li></ul>
		
	</div>
</nav>
<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation" 
	 >
	<h3 id="p-tb-label" class="vector-menu-heading">
		<span>Tools</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Grsecurity/The_RBAC_System" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Grsecurity/The_RBAC_System" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-upload"><a href="//commons.wikimedia.org/wiki/Special:UploadWizard?uselang=en" title="Upload files [u]" accesskey="u">Upload file</a></li><li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-permalink"><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;oldid=3451562" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;action=info" title="More information about this page">Page information</a></li><li id="t-cite"><a href="/w/index.php?title=Special:CiteThisPage&amp;page=Grsecurity%2FThe_RBAC_System&amp;id=3451562&amp;wpFormIdentifier=titleform" title="Information on how to cite this page">Cite this page</a></li></ul>
		
	</div>
</nav>
<nav id="p-Sister_projects" class="mw-portlet mw-portlet-Sister_projects vector-menu vector-menu-portal portal" aria-labelledby="p-Sister_projects-label" role="navigation" 
	 >
	<h3 id="p-Sister_projects-label" class="vector-menu-heading">
		<span>Sister projects</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"><li id="n-Wikipedia"><a href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a></li><li id="n-Wikiversity"><a href="https://en.wikiversity.org/wiki/Wikiversity:Main_Page">Wikiversity</a></li><li id="n-Wiktionary"><a href="https://en.wiktionary.org/wiki/Wiktionary:Main_Page">Wiktionary</a></li><li id="n-Wikiquote"><a href="https://en.wikiquote.org/wiki/Main_Page">Wikiquote</a></li><li id="n-Wikisource"><a href="https://en.wikisource.org/wiki/Main_Page">Wikisource</a></li><li id="n-Wikinews"><a href="https://en.wikinews.org/wiki/Main_Page">Wikinews</a></li><li id="n-Wikivoyage"><a href="https://en.wikivoyage.org/wiki/Main_Page">Wikivoyage</a></li><li id="n-Commons"><a href="https://commons.wikimedia.org/wiki/Main_Page">Commons</a></li><li id="n-Wikidata"><a href="https://www.wikidata.org/wiki/Wikidata:Main_Page">Wikidata</a></li><li id="n-MediaWiki"><a href="https://www.mediawiki.org/wiki/Main_Page">MediaWiki</a></li><li id="n-Meta-Wiki"><a href="https://meta.wikimedia.org/wiki/Main_Page">Meta-Wiki</a></li></ul>
		
	</div>
</nav>
<nav id="p-coll-print_export" class="mw-portlet mw-portlet-coll-print_export vector-menu vector-menu-portal portal" aria-labelledby="p-coll-print_export-label" role="navigation" 
	 >
	<h3 id="p-coll-print_export-label" class="vector-menu-heading">
		<span>Print/export</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"><li id="coll-create_a_book"><a href="/w/index.php?title=Special:Book&amp;bookcmd=book_creator&amp;referer=Grsecurity%2FThe+RBAC+System">Create a collection</a></li><li id="coll-download-as-rl"><a href="/w/index.php?title=Special:DownloadAsPdf&amp;page=Grsecurity%2FThe_RBAC_System&amp;action=show-download-screen">Download as PDF</a></li><li id="t-print"><a href="/w/index.php?title=Grsecurity/The_RBAC_System&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</a></li></ul>
		
	</div>
</nav>

	<nav id="p-lang" class="mw-portlet mw-portlet-lang vector-menu vector-menu-portal portal" aria-labelledby="p-lang-label" role="navigation" 
	 >
	<h3 id="p-lang-label" class="vector-menu-heading">
		<span>In other languages</span>
	</h3>
	<div class="vector-menu-content">
		<ul class="vector-menu-content-list"></ul>
		<div class="after-portlet after-portlet-lang"><span class="uls-after-portlet-link"></span><span class="wb-langlinks-add wb-langlinks-link"><a href="https://www.wikidata.org/wiki/Special:NewItem?site=enwikibooks&amp;page=Grsecurity%2FThe+RBAC+System" title="Add interlanguage links" class="wbc-editpage">Add links</a></span></div>
	</div>
</nav>

</div>

</div>
<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info" >
	<li id="footer-info-lastmod"> This page was last edited on 19 August 2018, at 06:40.</li>
	<li id="footer-info-copyright">Text is available under the <a href="//creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike License.</a>; additional terms may apply.  By using this site, you agree to the <a href="//foundation.wikimedia.org/wiki/Terms_of_Use">Terms of Use</a> and <a href="//foundation.wikimedia.org/wiki/Privacy_policy">Privacy Policy.</a></li>
</ul>

	<ul id="footer-places" >
	<li id="footer-places-privacy"><a href="https://foundation.wikimedia.org/wiki/Privacy_policy" class="extiw" title="wmf:Privacy policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/Wikibooks:Welcome" title="Wikibooks:Welcome">About Wikibooks</a></li>
	<li id="footer-places-disclaimer"><a href="/wiki/Wikibooks:General_disclaimer" title="Wikibooks:General disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="//en.m.wikibooks.org/w/index.php?title=Grsecurity/The_RBAC_System&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
	<li id="footer-places-developers"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/How_to_contribute">Developers</a></li>
	<li id="footer-places-statslink"><a href="https://stats.wikimedia.org/#/en.wikibooks.org">Statistics</a></li>
	<li id="footer-places-cookiestatement"><a href="https://foundation.wikimedia.org/wiki/Cookie_statement">Cookie statement</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://wikimediafoundation.org/"><img src="/static/images/footer/wikimedia-button.png" srcset="/static/images/footer/wikimedia-button-1.5x.png 1.5x, /static/images/footer/wikimedia-button-2x.png 2x" width="88" height="31" alt="Wikimedia Foundation" loading="lazy" /></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="/static/images/footer/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/static/images/footer/poweredby_mediawiki_132x47.png 1.5x, /static/images/footer/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>


<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.133","walltime":"0.168","ppvisitednodes":{"value":707,"limit":1000000},"postexpandincludesize":{"value":2853,"limit":2097152},"templateargumentsize":{"value":2078,"limit":2097152},"expansiondepth":{"value":16,"limit":40},"expensivefunctioncount":{"value":0,"limit":500},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":8534,"limit":5000000},"entityaccesscount":{"value":0,"limit":400},"timingprofile":["100.00%  112.065      1 -total"," 66.14%   74.118      1 Template:Navigate"," 43.69%   48.963      3 Template:BOOKCATEGORY"," 37.43%   41.944      1 Template:BOOKNAME"," 33.27%   37.284      1 Template:BOOKNAME/core"," 25.36%   28.422      2 Template:BookCat"," 24.17%   27.081      5 Template:Evalx"," 21.76%   24.389      1 Template:BOOKSORTKEY"," 21.72%   24.338      1 Template:Auto_navigation"," 19.04%   21.333      2 Template:BOOKPAGENAME"]},"scribunto":{"limitreport-timeusage":{"value":"0.042","limit":"10.000"},"limitreport-memusage":{"value":1369185,"limit":52428800}},"cachereport":{"origin":"mw1264","timestamp":"20210515010230","ttl":2592000,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":195,"wgHostname":"mw1352"});});</script>
</body></html>