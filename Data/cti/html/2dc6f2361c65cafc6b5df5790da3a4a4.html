<!DOCTYPE html>
<html  lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# ">
  <head>
    <meta charset="utf-8" /><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={licenseKey:"877b02039c",applicationID:"628657512"};window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var i=t[n]={exports:{}};e[n][0].call(i.exports,function(t){var i=e[n][1][t];return r(i||t)},i,i.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t,n){function r(){}function i(e,t,n){return function(){return o(e,[u.now()].concat(c(arguments)),t?null:this,n),t?void 0:this}}var o=e("handle"),a=e(7),c=e(8),f=e("ee").get("tracer"),u=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],p="api-",l=p+"ixn-";a(d,function(e,t){s[t]=i(p+t,!0,"api")}),s.addPageAction=i(p+"addPageAction",!0),s.setCurrentRouteName=i(p+"routeName",!0),t.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,t){var n={},r=this,i="function"==typeof t;return o(l+"tracer",[u.now(),e,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return t.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],n),e}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,t){m[t]=i(l+t)}),newrelic.noticeError=function(e,t){"string"==typeof e&&(e=new Error(e)),o("err",[e,u.now(),!1,t])}},{}],2:[function(e,t,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=e(9);t.exports=r,t.exports.offset=a,t.exports.getLastTimestamp=i},{}],3:[function(e,t,n){function r(e){return!(!e||!e.protocol||"file:"===e.protocol)}t.exports=r},{}],4:[function(e,t,n){function r(e,t){var n=e.getEntries();n.forEach(function(e){"first-paint"===e.name?d("timing",["fp",Math.floor(e.startTime)]):"first-contentful-paint"===e.name&&d("timing",["fcp",Math.floor(e.startTime)])})}function i(e,t){var n=e.getEntries();n.length>0&&d("lcp",[n[n.length-1]])}function o(e){e.getEntries().forEach(function(e){e.hadRecentInput||d("cls",[e])})}function a(e){if(e instanceof m&&!g){var t=Math.round(e.timeStamp),n={type:e.type};t<=p.now()?n.fid=p.now()-t:t>p.offset&&t<=Date.now()?(t-=p.offset,n.fid=p.now()-t):t=p.now(),g=!0,d("timing",["fi",t,n])}}function c(e){d("pageHide",[p.now(),e])}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d=e("handle"),p=e("loader"),l=e(6),m=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){f=new PerformanceObserver(r);try{f.observe({entryTypes:["paint"]})}catch(v){}u=new PerformanceObserver(i);try{u.observe({entryTypes:["largest-contentful-paint"]})}catch(v){}s=new PerformanceObserver(o);try{s.observe({type:"layout-shift",buffered:!0})}catch(v){}}if("addEventListener"in document){var g=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(e){document.addEventListener(e,a,!1)})}l(c)}},{}],5:[function(e,t,n){function r(e,t){if(!i)return!1;if(e!==i)return!1;if(!t)return!0;if(!o)return!1;for(var n=o.split("."),r=t.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}t.exports={agent:i,version:o,match:r}},{}],6:[function(e,t,n){function r(e){function t(){e(a&&document[a]?document[a]:document[i]?"hidden":"visible")}"addEventListener"in document&&o&&document.addEventListener(o,t,!1)}t.exports=r;var i,o,a;"undefined"!=typeof document.hidden?(i="hidden",o="visibilitychange",a="visibilityState"):"undefined"!=typeof document.msHidden?(i="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(i="webkitHidden",o="webkitvisibilitychange",a="webkitVisibilityState")},{}],7:[function(e,t,n){function r(e,t){var n=[],r="",o=0;for(r in e)i.call(e,r)&&(n[o]=t(r,e[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],8:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,i=n-t||0,o=Array(i<0?0:i);++r<i;)o[r]=e[t+r];return o}t.exports=r},{}],9:[function(e,t,n){t.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,t,n){function r(){}function i(e){function t(e){return e&&e instanceof r?e:e?u(e,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){e&&a&&e(n,r,i);for(var c=t(i),f=v(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[h[n]];return p&&p.push([b,n,r,c]),c}}function o(e,t){y[e]=v(e).concat(t)}function m(e,t){var n=y[e];if(n)for(var r=0;r<n.length;r++)n[r]===t&&n.splice(r,1)}function v(e){return y[e]||[]}function g(e){return p[e]=p[e]||i(n)}function w(e,t){s(e,function(e,n){t=t||"feature",h[n]=t,t in d||(d[t]=[])})}var y={},h={},b={on:o,addEventListener:o,removeEventListener:m,emit:n,get:g,listeners:v,context:t,buffer:w,abort:c,aborted:!1};return b}function o(e){return u(e,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=e("gos"),s=e(7),d={},p={},l=t.exports=i();t.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(e,t,n){function r(e,t,n){if(i.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return e[t]=r,r}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){i.buffer([e],r),i.emit(e,t,n)}var i=e("ee").get("handle");t.exports=r,r.ee=i},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,o,function(){return i++})}var i=1,o="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!E++){var e=x.info=NREUM.info,t=l.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return u.abort();f(h,function(t,n){e[t]||(e[t]=n)});var n=a();c("mark",["onload",n+x.offset],null,"api"),c("timing",["load",n]);var r=l.createElement("script");r.src="https://"+e.agent,t.parentNode.insertBefore(r,t)}}function i(){"complete"===l.readyState&&o()}function o(){c("mark",["domContent",a()+x.offset],null,"api")}var a=e(2),c=e("handle"),f=e(7),u=e("ee"),s=e(5),d=e(3),p=window,l=p.document,m="addEventListener",v="attachEvent",g=p.XMLHttpRequest,w=g&&g.prototype;if(d(p.location)){NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:g,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var y=""+location,h={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1208.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=t.exports={offset:a.getLastTimestamp(),now:a,origin:y,features:{},xhrWrappable:b,userAgent:s};e(1),e(4),l[m]?(l[m]("DOMContentLoaded",o,!1),p[m]("load",r,!1)):(l[v]("onreadystatechange",i),p[v]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var E=0}},{}],"wrap-function":[function(e,t,n){function r(e,t){function n(t,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],e)}c(n+"start",[o,a,f],s,u);try{return p=t.apply(a,o)}catch(m){throw c(n+"err",[o,a,m],s,u),m}finally{c(n+"end",[o,a,p],s,u)}}return a(t)?t:(n||(n=""),nrWrapper[p]=t,o(t,nrWrapper,e),nrWrapper)}function r(e,t,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<t.length;u++)f=t[u],c=e[f],a(c)||(e[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!m||t){var c=m;m=!0;try{e.emit(n,r,o,t,a)}catch(f){i([f,n,r,o],e)}m=c}}return e||(e=s),n.inPlace=r,n.flag=p,n}function i(e,t){t||(t=s);try{t.emit("internal-error",e)}catch(n){}}function o(e,t,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(e);return r.forEach(function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){return e[n]=t,t}})}),t}catch(o){i([o],n)}for(var a in e)l.call(e,a)&&(t[a]=e[a]);return t}function a(e){return!(e&&e instanceof Function&&e.apply&&!e[p])}function c(e,t){var n=t(e);return n[p]=e,o(e,n,s),n}function f(e,t,n){var r=e[t];e[t]=c(r,n)}function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;++n)t[n]=arguments[n];return t}var s=e("ee"),d=e(8),p="nr@original",l=Object.prototype.hasOwnProperty,m=!1;t.exports=r,t.exports.wrapFunction=c,t.exports.wrapInPlace=f,t.exports.argsToArray=u},{}]},{},["loader"]);</script>
<script async src="/sites/default/files/google_analytics/gtag.js?qtbwfo"></script>
<script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments)};gtag("js", new Date());gtag("config", "UA-34879253-1", {"groups":"default","anonymize_ip":true,"allow_ad_personalization_signals":false});</script>
<meta name="description" content="This Advisory uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&amp;CKÂ®) framework. See the ATT&amp;CK for Enterprise for all referenced threat actor tactics and techniques." />
<meta name="abstract" content="As part of its mission, CISA leads the effort to enhance the security, resiliency, and reliability of the Nation&#039;s cybersecurity and communications infrastructure." />
<meta name="keywords" content="uscert, csirt, cert, cybersecurity, cyber security, computer security, U. S. Computer Emergency Readiness, cyber risks" />
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="/sites/default/files/images/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="canonical" href="https://us-cert.cisa.gov/ncas/alerts/aa21-008a" />
<link rel="shortlink" href="https://us-cert.cisa.gov/node/15902" />
<link rel="revision" href="https://us-cert.cisa.gov/ncas/alerts/aa21-008a" />

    <title>Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments   | CISA</title>
    <link rel="stylesheet" media="all" href="/sites/default/files/css/css_-w-jQbIWIO0ZERqyQMFp9m1ddgDjs5ZGsor0ebo5CG4.css" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_OtQ9QHAYVZDqM__uuCDStHUt38Nwh_1MHX1vxg5dE5c.css" />

    
    <!-- Google Font -->
    <style type="text/css">
/* source-sans-pro-regular - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: normal;
  font-weight: 400;
  src: url('/profiles/uscertd8_gov/themes/custom/cert/fonts/source-sans-pro-v12-latin-regular.eot'); /* IE9 Compat Modes */
  src: local('Source Sans Pro Regular'), local('SourceSansPro-Regular'),
  url('/profiles/uscertd8_gov/themes/custom/cert/fonts/source-sans-pro-v12-latin-regular.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
  url('/profiles/uscertd8_gov/themes/custom/cert/fonts/source-sans-pro-v12-latin-regular.woff2') format('woff2'), /* Super Modern Browsers */
  url('/profiles/uscertd8_gov/themes/custom/cert/fonts/source-sans-pro-v12-latin-regular.woff') format('woff'), /* Modern Browsers */
  url('/profiles/uscertd8_gov/themes/custom/cert/fonts/source-sans-pro-v12-latin-regular.ttf') format('truetype'), /* Safari, Android, iOS */
  url('/profiles/uscertd8_gov/themes/custom/cert/fonts/source-sans-pro-v12-latin-regular.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
    </style>
    <!--link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet"--> 
    <!-- Google Font -->
  </head>
  <body class="path-node page-node-type-activity-alert has-glyphicons">
    <a href="#main-content" class="visually-hidden focusable skip-link">
      Skip to main content
    </a>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    


<div class="container-fluid top-top">
      <aside role="complementary">
        <div class="region region-top">
    <section id="block-certtoptop" class="block block-block-content block-block-content4d95ffde-0818-4e6b-bd79-d1547b08c0c0 clearfix">
  
    

      
            <div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"><div class="container">
<div id="top">
<div class="row">
<div class="col-sm-12 flag"><img alt="United States Flag" data-entity-type="" data-entity-uuid="" src="/sites/default/files/cert/flag.png" style="position: absolute;" /><p style="padding-left: 35px; font-family: Arial; font-size: 11px;">An official website of the United States government <a href="#" id="here-is-how-u-know">Here's how you know <span class="arrow down"> </span></a></p>
</div>
</div>
</div>
</div>

<div class="usa-banner-content usa-grid usa-accordion-content hidden container" id="gov-banner">
<div class="usa-banner-guidance-gov usa-width-one-half col-sm-6"><img alt="Dot gov" class="usa-banner-icon usa-media_block-img" data-entity-type="" data-entity-uuid="" src="/sites/default/files/images/icon-dot-gov.svg" /><div class="usa-media_block-body"><strong>Official websites use .gov</strong><br />
A <b>.gov</b> website belongs to an official government organization in the United States.</div>
</div>

<div class="usa-banner-guidance-ssl usa-width-one-half col-sm-6"><img alt="SSL" class="usa-banner-icon usa-media_block-img" data-entity-type="" data-entity-uuid="" src="/sites/default/files/images/icon-https.svg" /><div class="usa-media_block-body"><strong>Secure .gov websites use HTTPS</strong> A <b>lock (<img alt="lock icon" src="/sites/default/files/icons/lock.svg" style="width:15px;" />)</b> or <b>https://</b> means you've safely connected to the .gov website. Share sensitive information only on official, secure websites.</div>
</div>
</div>
</div>
      
  </section>


  </div>

    </aside>
  </div>



<div class="container-fluid hidden-xs hidden-sm banner-region">
<div class="container">
<div class="row">


  

<section class="col-sm-9">

      <a id="logo-section"></a>
        <div class="region region-logo">
    <section id="block-certlogo" class="block block-block-content block-block-content4639a667-debe-4642-bc69-7839662c0187 clearfix">
  
    

      
            <div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"><div class="hidden-xs hidden-sm"><a href="/"><img alt="Cybersecurity and Infrastructure Security Agency CISA" data-entity-type="" data-entity-uuid="" src="/sites/default/files/cert/logo_verbose.png" title="Cybersecurity and Infrastructure Security Agency CISA" /></a></div>
</div>
      
  </section>


  </div>

    </aside>
  </section>



      <aside class="col-sm-3" role="complementary">
        <div class="region region-search">
    <section id="block-certsearch" class="block block-block-content block-block-contentc33bd875-6ea6-42cc-b1ab-348a4e4bdff7 clearfix">
  
    

      
            <div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"><form accept-charset="UTF-8" action="https://search.us-cert.gov/search" class="hidden-xs searchbox" method="get"><input name="utf8" type="hidden" value="â" /><input id="affiliate-desktop" name="affiliate" type="hidden" value="us-cert" /><div class="form-group"><label class="sr-only" for="query-desktop">Enter Search Terms(s):</label>
<div class="input-group"><input autocomplete="off" class="form-control form-control-custom input-lg" id="query-desktop" name="query" placeholder="Search" type="text" /><div class="input-group-addon input-group-addon-custom"><button class="submit input-lg"><img alt="search icon" data-entity-type="" data-entity-uuid="" src="/sites/default/files/cert/search-icon.png" title="search icon" /></button></div>
</div>
</div>
</form>
<style type="text/css">
<!--/*--><![CDATA[/* ><!--*/
.navbar-default ul.navbar-nav > li.last a{
display: none;

/*--><!]]>*/
</style><div style="padding: 16px 12px 8px 12px"><a class="btn btn-primary" href="/services" type="button" style="font-weight: bold; width: 40%">Services</a><a class="btn btn-primary pull-right" href="/report" type="button" style="font-weight: bold; width: 40%">Report</a></div>
</div>
      
  </section>


  </div>

    </aside>
  </div>
</div>
<hr class="hidden-xs nav-top-line">
</div>



          <header class="navbar navbar-default container-fluid" id="navbar" role="banner">
        <div class="container ">
      <div class="navbar-header">
        
                          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
            <div class="hidden-lg hidden-md mobile-nav">
        <a class="" href="/">
            <img src="/sites/default/files/cert/logo3.png"  alt="US Department of Homeland Security CISA Cyber + Infrastructure" title="US Department of Homeland Security CISA Cyber + Infrastructure">
          </a>
        </div>
      </div>

              <div id="navbar-collapse" class="navbar-collapse collapse">
            <div class="region region-navigation-collapsible">
    <section id="block-certsearchmobile" class="block block-block-content block-block-content0da6361c-e31a-4a58-b455-f9ebde1ba544 clearfix">
  
    

      
            <div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"><form accept-charset="UTF-8" action="https://search.us-cert.gov/search" class="hidden-lg hidden-md searchbox" method="get"><input name="utf8" type="hidden" value="â" /><input id="affiliate-mobile" name="affiliate" type="hidden" value="us-cert" /><div class="form-group"><label class="sr-only" for="query-mobile">Enter Search Terms(s):</label>
<div class="input-group"><input autocomplete="off" class="form-control form-control-custom input-lg" id="query-mobile" name="query" placeholder="Search" type="text" /><div class="input-group-addon input-group-addon-custom"><button class="submit input-lg"><img alt="search icon" data-entity-type="" data-entity-uuid="" src="/sites/default/files/cert/search-icon.png" title="search icon" /></button></div>
</div>
</div>
</form>
<div class="hidden-md hidden-lg" style="padding: 8px"><a class="btn btn-primary btn-block" href="/services" role="button" style="font-weight: bold">Services</a></div>

<div class="hidden-md hidden-lg" style="padding: 8px"><a class="btn btn-primary btn-block" href="/report" role="button" style="font-weight: bold">Report</a></div></div>
      
  </section>

<nav role="navigation" aria-labelledby="block-certmainmenu-menu" id="block-certmainmenu">
            
  <h2 class="visually-hidden" id="block-certmainmenu-menu">CertMain Menu</h2>
  

        
      <ul class="menu menu--certmain-menu nav navbar-nav">
                      <li class="first">
                                        <a href="/ncas" title="Alerts and Tips" data-drupal-link-system-path="node/5">Alerts and Tips</a>
              </li>
                      <li>
                                        <a href="/resources" title="Resources" data-drupal-link-system-path="node/12436">Resources</a>
              </li>
                      <li>
                                        <a href="/ics" title="Industrial Control Systems" data-drupal-link-system-path="node/14614">Industrial Control Systems</a>
              </li>
                      <li class="last">
                                        <a href="/report" title="Report" data-drupal-link-system-path="node/5745">Report</a>
              </li>
        </ul>
  

  </nav>

  </div>

        </div>
                </header>
  <hr class="hidden-xs hidden-sm nav-bottom-line">
<div class="visible-xs visible-sm mobile-border"></div>


<div class="container">
    <div id="print-logo"><img alt="US Department of Homeland Security CISA Cyber + Infrastructure" src="/sites/default/files/cert/logo2.png"/></div>
    <div id="tlp-header"><svg height="30" width="120"> <rect fill="black" height="30" width="120" x="0" y="0"></rect> <text fill="#ffffff" font-size="18px" x="10" y="20">TLP:WHITE</text> </svg></div>
    <div id="tlp-footer"><svg height="30" width="120"> <rect fill="black" height="30" width="120" x="0" y="0"></rect> <text fill="#ffffff" font-size="18px" x="10" y="20">TLP:WHITE</text> </svg></div>
</div>












  <div role="main" class="main-container container js-quickedit-main-content">
    <div class="row">

                              <div class="col-sm-12" role="heading" aria-level="1">
              <div class="region region-header">
      <div class="container-fluid hidden-xs">
  <ol class="breadcrumb">
          <li >
                  <a href="/ncas">National Cyber Awareness System</a>&nbsp;&nbsp;&nbsp;&nbsp;&gt;
              </li>
          <li >
                  <a href="/ncas/alerts">Alerts</a>&nbsp;&nbsp;&nbsp;&nbsp;&gt;
              </li>
          <li  class="active">
                  Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments  
              </li>
      </ol>
</div>



  </div>

          </div>
              

            
            
                        

            
                  <section class="col-sm-12">

                              <div class="highlighted">  <div class="region region-highlighted">
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>
</div>
              
                                      
                  
                          <a id="main-content"></a>
            <div class="region region-content">
                  <div id="ncas-header">
            <div id="alerts-archive">
                <a title="View Archives" href="/ncas/alerts/">More Alerts</a>
            </div>
            <h1 id="page-title">Alert (AA21-008A)</h1>
            <h2 id="page-sub-title">Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments  </h2>
            <div class="submitted meta-text">
                                Original release date: January 08, 2021  | Last <a href="#revisions">revised</a>: April 15, 2021
                                            </div>
            <div id="social-options">
	<!-- START PRINT BUTTON -->
		<div id="print-button">
			<span id="custom-print-button">
				<a rel="nofollow" href="javascript:window.print();" title="Click to print."><img src="/sites/default/files/icons/print-button.png" alt="Click to print." /></a>
			</span>
		</div>
    <!-- END PRINT BUTTON -->
	<!-- START TWEET BUTTON -->
	<div id="tweet-button">
		<span id="custom-tweet-button">
			<a rel="nofollow" target="_blank" href="https://twitter.com/share?url=https%3A%2F%2Fus-cert.cisa.gov%2Fncas%2Falerts%2Faa21-008a" class="popup-twitter" title="Click to Tweet."><img src="/sites/default/files/icons/tweet-button.png" alt="Click to Tweet." /></a>
		</span>
	</div>
	<!-- END TWEET BUTTON -->

	<!-- START FACEBOOK BUTTON -->
	<div id="facebook-button">
		<span id="custom-facebook-button">
		<a rel="nofollow" target="_blank" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fus-cert.cisa.gov%2Fncas%2Falerts%2Faa21-008a" class="popup-facebook" title="Click to send to Facebook."><img src="/sites/default/files/icons/facebook-send-button.png" alt="Click to send to Facebook." /></a>
		</span>
	</div>
	<!-- END FACEBOOK BUTTON -->

	<!-- START SHARE BUTTON -->
	<div id="share-button">
		<span id="custom-share-button">
			<a rel="nofollow" target="_blank" href="http://www.addthis.com/bookmark.php?url=https%3A%2F%2Fus-cert.cisa.gov%2Fncas%2Falerts%2Faa21-008a" class="popup-share" title="Click to Share." ><img src="/sites/default/files/icons/share-button.png" alt="Click to Share." /></a>
		</span>
	</div>
	<!-- END SHARE BUTTON -->

</div>
        </div>
    
  
<article role="article" about="/ncas/alerts/aa21-008a" class="activity-alert full clearfix">

  
    

  
  <div class="content">
	<div id="ncas-content">
        		<a id="summary"></a>
		<h3>Summary</h3>
        
            <div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"><p class="tip-intro" style="font-size: 15px;"><em>This Advisory uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&amp;CKÂ®) framework. See the <a href="https://attack.mitre.org/versions/v7/techniques/enterprise/">ATT&amp;CK for Enterprise</a> for all referenced threat actor tactics and techniques.</em></p>

<p><em><strong>Updated April 15, 2021: The U.S. Government attributes this activity to the Russian Foreign Intelligence Service (SVR). Additional information may be found in a <a href="https://www.whitehouse.gov/briefing-room/statements-releases/2021/04/15/fact-sheet-imposing-costs-for-harmful-foreign-activities-by-the-russian-government/">statement from the White House</a>. For more information on SolarWinds-related activity, go to <a href="https://us-cert.cisa.gov/remediating-apt-compromised-networks">https://us-cert.cisa.gov/remediating-apt-compromised-networks</a> and <a href="https://www.cisa.gov/supply-chain-compromise">https://www.cisa.gov/supply-chain-compromise</a>.</strong></em></p>

<p>This Alert is a companion alert to <a href="https://us-cert.cisa.gov/ncas/alerts/aa20-352a">AA20-352A: Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations</a>. AA20-352A primarily focuses on an advanced persistent threat (APT) actorâs compromise of SolarWinds Orion products as an initial access vector into networks of U.S. Government agencies, critical infrastructure entities, and private network organizations. As noted in AA20-352A, the Cybersecurity and Infrastructure Security Agency (CISA) has evidence of initial access vectors in addition to the compromised SolarWinds Orion products.</p>

<p>This Alert also addresses activityâirrespective of the initial access vector leveragedâthat CISA attributes to an APT actor. Specifically, CISA has seen an APT actor using compromised applications in a victimâs Microsoft 365 (M365)/Azure environment. CISA has also seen this APT actor utilizing additional credentials and Application Programming Interface (API) access to cloud resources of private and public sector organizations. These tactics, techniques, and procedures (TTPs) feature three key components:</p>

<ul><li>Compromising or bypassing federated identity solutions;</li>
	<li>Using forged authentication tokens to move laterally to Microsoft cloud environments; and</li>
	<li>Using privileged access to a victimâs cloud environment to establish difficult-to-detect persistence mechanisms for Application Programming Interface (API)-based access.</li>
</ul><p>This Alert describes these TTPs and offers an overview of, and guidance on, available open-source toolsâincluding a CISA-developed tool, Sparrowâfor network defenders to analyze their Microsoft Azure Active Directory (AD), Office 365 (O365), and M365 environments to detect potentially malicious activity.</p>

<p><strong>Note</strong>: this Alert describes artifactsâpresented by these attacksâfrom which CISA has identified detectable evidence of the threat actorâs initial objectives. CISA continues to analyze the threat actorâs follow-on objectives.</p>
</div>
      
        
        
        		    <a id="technical-details"></a>
		    <h3>Technical Details</h3>
            
            <div class="field field--name-field-aa-technical-details field--type-text-long field--label-hidden field--item"><p>Frequently, CISA has observed the APT actor gaining <em>Initial Access</em> [<a href="https://attack.mitre.org/versions/v8/tactics/TA0001/">TA0001</a>] to victimsâ enterprise networks via compromised SolarWinds Orion products (e.g., Solorigate, Sunburst).<a href="https://www.zdnet.com/article/a-second-hacking-group-has-targeted-solarwinds-systems/ ">[1]</a> However, CISA is investigating instances in which the threat actor may have obtained initial access by <em>Password Guessing</em> [<a href="https://attack.mitre.org/versions/v8/techniques/T1110/001/">T1110.001</a>], <em>Password Spraying</em> [<a href="https://attack.mitre.org/versions/v8/techniques/T1110/003">T1110.003</a>], and/or exploiting inappropriately secured administrative or service credentials (<em>Unsecured Credentials </em>[<a href="https://attack.mitre.org/versions/v8/techniques/T1552/">T1552</a>]) instead of utilizing the compromised SolarWinds Orion products.</p>

<p>CISA observed this threat actor moving from user context to administrator rights for <em>Privilege Escalation</em> [<a href="https://attack.mitre.org/versions/v8/tactics/TA0004/">TA0004</a>] within a compromised network and using native Windows tools and techniques, such as Windows Management Instrumentation (WMI), to enumerate the Microsoft Active Directory Federated Services (ADFS) certificate-signing capability. This enumeration allows threat actors to forge authentication tokens (OAuth) to issue claims to service providersâwithout having those claims checked against the identity providerâand then to move laterally to Microsoft Cloud environments (<em>Lateral Movement </em>[<a href="https://attack.mitre.org/versions/v8/tactics/TA0008/">TA0008</a>]).</p>

<p>The threat actor has also used on-premises access to manipulate and bypass identity controls and multi-factor authentication. This activity demonstrates how sophisticated adversaries can use credentials from one portion of an organization to move laterally (<em>Lateral Movement</em> [<a href="https://attack.mitre.org/versions/v8/tactics/TA0008/">TA0008</a>]) through trust boundaries, evade defenses and detection (<em>Defense Evasion</em> [<a href="https://attack.mitre.org/versions/v8/tactics/TA0005/">TA0005</a>]), and steal sensitive data (<em>Collection </em>[<a href="https://attack.mitre.org/versions/v8/tactics/TA0009/">TA0009</a>]).</p>

<p>This level of compromise is challenging to remediate and requires a rigorous multi-disciplinary effort to regain administrative control before recovering.</p>
</div>
      
        
        		    <a id="mitigations"></a>
		    <h3>Mitigations</h3>
            
            <div class="field field--name-field-aa-mitigations field--type-text-long field--label-hidden field--item"><h4>Detection</h4>

<p>Guidance on identifying affected SolarWinds software is well documented.[<a href="https://www.cisa.gov/supply-chain-compromise ">2</a>] Howeverâonce an organization identifies a compromise via SolarWinds Orion products or other threat actor TTPsâidentifying follow-on activity for on-premises networks requires fine-tuned network and host-based forensics.</p>

<p>The nature of cloud forensics is unique due to the growing and rapidly evolving technology footprints of major vendors. Microsoft's O365 and M365 environments have built-in capabilities for detecting unusual activity. Microsoft also provides premium services (Advanced Threat Protection [ATP] and Azure Sentinel), which enable network defenders to investigate TTPs specific to the Solorigate activity.<a href="https://techcommunity.microsoft.com/t5/azure-sentinel/solarwinds-post-compromise-hunting-with-azure-sentinel/ba-p/1995095 ">[3]</a></p>

<h4>Detection Tools</h4>

<p><em>CISA is providing examples of detection tools for informational purposes only. CISA does not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services does not constitute or imply their endorsement, recommendation, or favoring by CISA.</em></p>

<p>There are a number of open-source tools available to investigate adversary activity in Microsoft cloud environments and to detect unusual activity, service principals, and application activity.<a href="https://msrc-blog.microsoft.com/2020/12/21/december-21st-2020-solorigate-resource-center/ ">[4]</a> Publicly available PowerShell tools that network defenders can use to investigate M365 and Microsoft Azure include:</p>

<ul><li>CISA's Sparrow,</li>
	<li>Open-source utility Hawk, and</li>
	<li>CrowdStrike's Azure Reporting Tool (CRT).</li>
</ul><p>Additionally, Microsoft's Office 365 Management API and Graph API provide an open interface for ingesting telemetry and evaluating service configurations for signs of anomalous activity and intrusion.</p>

<p><strong>Note</strong>: these open-source tools are highlighted and explained to assist with on-site investigation and remediation in cloud environments but are not all-encompassing. Open source tools can be complemented by services such as Azure Sentinel, a Microsoft premium service that provides comprehensive analysis tools, including custom detections for the activity indicated.</p>

<h4>General Guidance on Using Detection Tools</h4>

<ol><li>Audit the creation and use of service principal credentials. Look for unusual application usage, such as use of dormant applications.</li>
	<li>Audit the assignment of credentials to applications that allow non-interactive sign-in by the application. Look for unexpected trust relationships added to the Azure Active Directory.</li>
	<li>Download the interactive sign-ins from the Azure admin portal or use the Microsoft Sentinel product. Review new token validation time periods with high values and investigate whether it was a legitimate change or an attempt to gain persistence by a threat actor.</li>
</ol><h4>Sparrow</h4>

<p>CISA created <a href="https://github.com/cisagov/Sparrow">Sparrow</a> to help network defenders detect possible compromised accounts and applications in the Azure/M365 environment. The tool focuses on the narrow scope of user and application activity endemic to identity- and authentication-based attacks seen recently in multiple sectors. It is neither comprehensive nor exhaustive of available data. It is intended to narrow a larger set of available investigation modules and telemetry to those specific to recent attacks on federated identity sources and applications.</p>

<p><em>(Updated April 8, 2021):</em> CISA hasÂ also created "Aviary," which is a companion Splunk dashboard that can assist in visualizing and reviewing the output of Sparrow. Network defenders can find Aviary on <a href="https://github.com/cisagov/Sparrow">CISA's Sparrow GitHub page</a>.Â CISA advises network defenders to perform the following actions to use Sparrow:</p>

<ol><li>Use Sparrow to detect any recent domain authentication or federation modifications.
	<ol type="a"><li>Domain and federation modification operations are uncommon and should be investigated.</li>
	</ol></li>
	<li>Examine logs for new and modified credentials applied to applications and service principals; delineate for the credential type. Sparrow can be used to detect the modification of service principals and application credentials.
	<ol type="a"><li>Create a timeline for all credential changes, focusing on recent wholesale changes.</li>
		<li>Review the âtop actorsâ for activity in the environment and the number of credential modifications performed.</li>
		<li>Monitor changes in application and service principal credentials.</li>
		<li>Investigate any instances of excessive permissions being granted, including, but not limited to, Exchange Online, Microsoft Graph, and Azure AD Graph.</li>
	</ol></li>
	<li>Use Sparrow to detect privilege escalation, such as adding a service principal, user, or group to a privileged role.</li>
	<li>Use Sparrow to detect <code>OAuth</code> consent and usersâ consent to applications, which is useful for interpreting changes in adversary TTPs.</li>
	<li>Use Sparrow to identify anomalous Security Assertion Markup Language (SAML) token sign-ins by pivoting on the unified audit log UserAuthenticationValue of 16457, which is an indicator of how a SAML token was built and is a potential indicator for forged SAML tokens.
	<ol type="a"><li>Note that this TTP has not been the subject of significant published security research but may indicate an unusual usage of a token, such as guest access for external partners to M365 resources.</li>
	</ol></li>
	<li>Review the PowerShell logs that Sparrow exports.
	<ol type="a"><li>Review PowerShell mailbox sign-ins and validate that the logins are legitimate actions.</li>
		<li>Review PowerShell usage for users with PowerShell in the environment.</li>
	</ol></li>
	<li>Use Sparrow to check the Graph API application permissions of all service principals and applications in M365/Azure AD.
	<ol type="a"><li>Investigate unusual activity regarding Microsoft Graph API permissions (using either the legacy <a href="https://graph.windows.net/">https://graph.windows.net/ </a>or <a href="https://graph.microsoft.com">https://graph.microsoft.com</a>). Graph is used frequently as part of these TTPs, often to access and manipulate mailbox resources.</li>
	</ol></li>
	<li>Review Sparrowâs listed tenantâs Azure AD domains, to see if the domains have been modified.</li>
	<li>For customers with G5 or E5 licensing levels, review MailItemsAccessed for insight into what application identification (ID) was used for accessing usersâ mailboxes. Use Sparrow to query for a specific application ID using the app id investigation capability, which will check to see if it is accessing mail or file items.
	<ol type="a"><li>The MailItemsAccessed event provides audibility for mailbox data accessed via mail protocols or clients.</li>
		<li>By analyzing the MailItemsAccessed action, incident responders can determine which user mailbox items have been accessed and potentially exfiltrated by a threat actor. This event will be recorded even in some situations where the message was not necessarily read interactively (e.g., bind or sync).<a href="https://docs.microsoft.com/en-us/microsoft-365/compliance/advanced-audit?view=o365-worldwide">[5]</a></li>
		<li>The resulting suspicious application ID can provide incident responders with a pivot to detect other suspicious applications that require additional analysis.</li>
		<li>Check for changes to applications with regards to the accessing of resources such as mail or file items.</li>
	</ol></li>
</ol><p><em>(Updated April 8, 2021): </em>Aviary can be used to assist with performing the above tasks. To install Aviary, after running Sparrow:</p>

<ol><li>Ingest comma separated values (CSV) output from the Sparrow PowerShell script into Splunk.
	<ol type="a"><li>Sparrow output will have the following default filenames, which should not be modified: <code>AppUpdate_Operations_Export.csv</code>, <code>AppRoleAssignment_Operations_Export.csv</code>, <code>Consent_Operations_Export.csv</code>, <code>Domain_List.csv</code>, <code>Domain_Operations_Export.csv</code>, <code>FileItems_Operations_Export.csv</code>, <code>MailItems_Operations_Export.csv</code>, <code>PSLogin_Operations_Export.csv</code>, <code>PSMailbox_Operations_Export.csv</code>, <code>SAMLToken_Operations_Export.csv</code>, <code>ServicePrincipal_Operations_Export.csv</code></li>
	</ol></li>
	<li>Copy and paste the contents of the .xml file (aviary.xml in the root directory) into a new dashboard.</li>
	<li>Use the data selection filters to point to the indexed Sparrow data (see figure 1)</li>
</ol><p><img alt="" data-entity-type="file" data-entity-uuid="be5966f9-c2de-490f-83e6-11abf1b92b8f" height="114" src="/sites/default/files/publications/Figure%201%20Data%20Selection%20Filters.png" width="944" loading="lazy" /></p>

<p>Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Figure 1: Data Selection Filters</p>

<p class="text-align-center">Â </p>

<h4>Hawk</h4>

<p>Hawk is an open-source, PowerShell-driven, community-developed tool network defenders can use to quickly and easily gather data from O365 and Azure for security investigations. Incident responders and network defenders can investigate specific user principals or the entire tenant. Data it provides include IP addresses and sign-in data. Additionally, Hawk can track IP usage for concurrent login situations.</p>

<p>Hawk users should review login details for administrator accounts and take the following steps.</p>

<h4>CrowdStrike Azure Reporting Tool</h4>

<p><a href="https://github.com/CrowdStrike/CRT">CrowdStrike's Azure Reporting Tool </a>(CRT) can help network defenders analyze their Microsoft Azure AD and M365 environment to help organizations analyze permissions in their Azure AD tenant and service configuration. This tool has minor overlap with Sparrow; it shows unique items, but it does not cover the same areas. CISA is highlighting this tool because it is one of the only free, open-source tools available to investigate this activity and could be used to complement Sparrow.</p>

<h4>Detection Tool Distinctions</h4>

<h4>Detection Methods</h4>

<p>Microsoft breaks the threat actorâs recent activity into four primary stages, which are described below along with associated detection methods. Microsoft describes these stages as beginning with all activity after the compromise of the on-premises identity solution, such as ADFS.<a href="https://techcommunity.microsoft.com/t5/azure-active-directory-identity/understanding-quot-solorigate-quot-s-identity-iocs-for-identity/ba-p/2007610 ">[6]</a></p>

<p>Note: this step provides an entry vector to cloud technology environments, and is unnecessary when the threat actor has compromised an identity solution or credential that allows the APT direct access to the cloud(e.g., without leveraging the SolarWinds Orion vulnerability).</p>

<p><strong>Stage 1: Forging a trusted authentication token used to access resources that trust the on-premises identity provider</strong></p>

<p>These attacks (often referred to as âGolden Security Assertion Markup Languageâ attacks) can be analyzed using a combination of cloud-based and standard on-premises techniques.<a href="https://www.sygnia.co/golden-saml-advisory">[7]</a> For example, network defenders can use <code>OAuth</code> claims for specific principals made at the Azure AD level and compare them to the on-premises identity.</p>

<p>Export sign-in logs from the Azure AD portal and look at the Authentication Method field.</p>

<p><strong>Note</strong>: at portal.azure.com, click on a user and review the authentication details (e.g., date, method, result). Without Sentinel, this is the only way to get these logs, which are critical for this effort.</p>

<p><strong><em>Detection Method 1: Correlating service provider login events with corresponding authentication events in Active Directory Federation Services (ADFS) and Domain Controllers</em></strong></p>

<p>Using SAML single sign-on, search for any logins to service providers that do not have corresponding event IDs 4769, 1200, and 1202 in the domain.</p>

<p><strong><em>Detection Method 2: Identifying certificate export events in ADFS</em></strong></p>

<p>Look for:</p>

<p><strong><em>Detection Method 3: Customizing SAML response to identify irregular access</em></strong></p>

<p>This method serves as prevention for the future (and would only detect future, not past, activity), as it helps identify irregularities from the point of the change forward. Organizations can modify SAML responses to include custom elements for each service provider to monitor and detect any anomalous requests.<a href="https://www.sygnia.co/golden-saml-advisory">[8]</a></p>

<p><strong><em>Detection Method 4: Detecting malicious ADFS trust modification</em></strong></p>

<p>A threat actor who gains administrative access to ADFS can add a new, trusted ADFS rather than extracting the certificate and private key as part of a standard Golden SAML attack.<a href="https://www.sygnia.co/golden-saml-advisory">[9]</a><br />
Network defenders should look for:</p>

<p><strong>Stage 2: Using the forged authentication token to create configuration changes in the Service Provider, such as Azure AD (establishing a foothold)</strong></p>

<p>After the threat actor has compromised the on-premises identity provider, they identify their next series of objectives by reviewing activity in the Microsoft Cloud activity space (Microsoft Azure and M365 tenants).</p>

<p>The threat actor uses the ability to forge authentication tokens to establish a presence in the cloud environment. The actor adds additional credentials to an existing service principal. Once the threat actor has impersonated a privileged Azure AD account, they are likely to further manipulate the Azure/M365 environment (action on objectives in the cloud).</p>

<p>Network defenders should take the following steps.</p>

<p><strong>Stage 3: Acquiring an <code>OAuth</code> access token for the application using the forged credentials added to an existing application or service principal and calling APIs with the permissions assigned to that application</strong></p>

<p>In some cases, the threat actor has been observed adding permissions to existing applications or service principals. Additionally the actor has been seen establishing new applications or service principals briefly and using them to add permissions to the existing applications or service principals, possibly to add a layer of indirection (e.g., using it to add a credential to another service principal, and then deleting it).<a href="https://techcommunity.microsoft.com/t5/azure-active-directory-identity/understanding-quot-solorigate-quot-s-identity-iocs-for-identity/ba-p/2007610 ">[11]</a></p>

<p>Network defenders should use Sparrow to:</p>

<p><strong>Stage 4: Once access has been established, the threat actor Uses Microsoft Graph API to conduct action on objectives from an external RESTful API (queries impersonating existing applications).</strong></p>

<p>Network defenders should:</p>

<h4>Microsoft Telemetry Nuances</h4>

<p>The existing tools and techniques used to evaluate cloud-based telemetry sources present challenges not represented in traditional forensic techniques. Primarily, the amount of telemetry retention is far less than the traditional logging facilities of on-premises data sources. Threat actor activity that is more than 90 days old is unlikely to have been saved by traditional sources or be visible with the Microsoft M365 Management API or in the UAL.</p>

<p>Service principal logging is available using the Azure Portal via the "Service Principal Sign-ins" feature. Enable settings in the Azure Portal (see âDiagnostic Settingâ) to ingest logs into Sentinel or a third-party security information and event management (SIEM) tool. An Azure Premium P1 or Premium P2 license is necessary to access this setting as well as other features, such as a log analytics workspace, storage account, or event hub.<a href="https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-all-sign-ins ">[12]</a> These logs must be downloaded manually if not ingested by one of the methods listed in the Detection Methods section.</p>

<p>Global Administrator rights are often required by tools other than Hawk and Sparrow to evaluate M365 cloud security posture. Logging capability and visibility of data varies by licensing models and subscription to premium services, such as Microsoft Defender for O365 and Azure Sentinel. According to CrowdStrike, "There was an inability to audit via API, and there is the requirement for global admin rights to view important information which we found to be excessive. Key information should be easily accessible."<a href="https://www.crowdstrike.com/blog/crowdstrike-launches-free-tool-to-identify-and-help-mitigate-risks-in-azure-active-directory/">[13]</a></p>

<p>Documentation for specific event codes, such as UserAuthenticationMethod 16457, which may indicate a suspicious SAML token forgery, is no longer available in the M365 Unified Access Log. Auditing narratives on some events no longer exist as part of core Microsoft documentation sources.</p>

<p>The use of industry-standard SIEMs for log detection is crucial for providing historical context for threat hunting in Microsoft cloud environments. Standard G3/E3 licenses only provide 90 days of auditing; with the advanced auditing license that is provided with a G5/E5 license, audit logs can be extended to retain information for a year. CISA notes that this license change is proactive, rather than reactive: it allows enhanced visibility and features for telemetry from the moment of integration but does not provide retroactive visibility on previous events or historical context.</p>

<p>A properly configured SIEM can provide:</p>

<p>Built-in tools, such as Microsoft Cloud Services and M365 applications, provide much of the same visibility available from custom tools and are mapped to the MITRE ATT&amp;CK framework and easy-to-understand dashboards.<a href="https://splunkbase.splunk.com/app/3786/">[14]</a> However, these tools often do not have the ability to pull historical data older than seven days. Therefore, storage solutions that appropriately meet governance standards and usability metrics for analysts for the SIEM must be carefully planned and arranged.</p>

<ol><li>Ingest comma separated values (CSV) output from the Sparrow PowerShell script into Splunk.
	<ol type="a"><li>Sparrow output will have the following default filenames, which should not be modified: <code>AppUpdate_Operations_Export.csv</code>,<code>AppRoleAssignment_Operations_Export.csv</code>, <code>Consent_Operations_Export.csv</code>, <code>Domain_List.csv</code>, <code>Domain_Operations_Export.csv</code>, <code>FileItems_Operations_Export.csv</code>, <code>MailItems_Operations_Export.csv</code>, <code>PSLogin_Operations_Export.csv</code>, <code>PSMailbox_Operations_Export.csv</code>, <code>SAMLToken_Operations_Export.csv</code>, <code>ServicePrincipal_Operations_Export.csv</code></li>
	</ol></li>
	<li>Copy and paste the contents of the .xml file (aviary.xml in the root directory) into a new dashboard.</li>
	<li>Use the data selection filters to point to the indexed Sparrow data (see figure 1)</li>
	<li>Â 
	<ol><li>Â Investigate high-value administrative accounts to detect anomalous or unusual activity (Global Admins).</li>
		<li>Enable PowerShell logging, and evaluate PowerShell activity in the environment not used for traditional or expected purposes.
		<ol type="a"><li>PowerShell logging does not reveal the exact <code>cmdlet</code> that was run on the tenant.</li>
		</ol></li>
		<li>Look for users with unusual sign-in locations, dates, and times.</li>
		<li>Check permissions of service principals and applications in M365/Azure AD.</li>
		<li>Detect the frequency of resource access from unusual places. Use the tool to pivot to a trusted application and see if it is accessing mail or file items.</li>
		<li>Review mailbox rules and recent mailbox rule changes.</li>
	</ol><ul><li>Sparrow differs from CRT by looking for specific indicators of compromise associated with the recent attacks.</li>
		<li>CRT focuses on the tenantâs Azure AD permissions and Exchange Online configuration settings instead of the unified audit log, which gives it a different output from Sparrow or Hawk.</li>
		<li>CRT returns the same broad scope of application/delegated permissions for service principals and applications as Hawk.</li>
		<li>As part of its investigation, Sparrow homes in on a narrow set of application permissions given to the Graph API, which is common to the recent attacks.</li>
		<li>CRT looks at Exchange Online federation configuration and federation trust, while Sparrow focuses on listing Azure AD domains.</li>
		<li>Among the items network defenders can use CRT to review are delegated permissions and application permissions, federation configurations, federation trusts, mail forwarding rules, service principals, and objects with KeyCredentials.</li>
	</ul><ol><li>The IP address and Activity_ID in EventCode 410 and the Activity_ID and Instance_ID in EventCode 500.</li>
		<li>Export-PfxCertificate or certutil-exportPFX in Event IDs 4103 and 4104, which may include detection of a certificate extraction technique.</li>
		<li>Deleted certificate extraction with ADFSdump performed using Sysmon Event ID 18 with the pipe name \microsoft##wid\tsql\query (exclude processes regularly making this pipe connection on the machine).</li>
		<li>Event ID 307 (The Federation Service configuration was changed), which can be correlated to relevant Event ID 510 with the same instance ID for change details (Event ID 510 with the same Instance ID could be more than one event per single Event ID 307 event).</li>
		<li>Event ID 307 (The Federation Service configuration was changed), which can be correlated to relevant Event ID 510 with the same Instance ID for change details. (Event ID 510 with the same Instance ID could be more than one event per single Event ID 307 event.)
		<ol><li>Review events, particularly searching for Configuration: Type: IssuanceAuthority where Property Value references an unfamiliar domain.</li>
		</ol></li>
		<li>Possible activity of an interrogating ADFS host by using ADFS PowerShell plugins. Look for changes in the federation trust environment that would indicate new ADFS sources.</li>
		<li>Audit the creation and use of service principal and application credentials. Sparrow will detect modifications to these credentials.
		<ol type="a"><li>Look for unusual application usage, such as dormant or forgotten applications being used again.</li>
			<li>Audit the assignment of credentials to applications that allow non-interactive sign-in by the application.</li>
		</ol></li>
		<li>Look for unexpected trust relationships that have been added to Azure AD. (Download the last 30 days of non-interactive sign-ins from the Azure portal or use Azure Sentinel.).<a href="https://docs.microsoft.com/en-us/azure/azure-monitor/reference/tables/aadserviceprincipalsigninlogs ">[10]</a></li>
		<li>Use Hawk (and any sub-modules available) to run an investigation on a specific user. Hawk will provide IP addresses, sign-in data, and other data. Hawk can also track IP usage in concurrent login situations.</li>
		<li>Review login details for administrator accounts (e.g., high-value administrative accounts, such as Global Admins). Look for unusual sign-in locations, dates, and times.</li>
		<li>Review new token validation time periods with high values and investigate whether the changes are legitimate or a threat actorâs attempts to gain persistence.</li>
		<li>Examine highly privileged accounts; specifically using sign-in logs, look for unusual sign-in locations, dates, and times.</li>
		<li>Create a timeline for all credential changes.</li>
		<li>Monitor changes in application credentials (the script will export into csv named AppUpdate_Operations_Export).</li>
		<li>Detect service principal credentials change and service principal change (e.g., if an actor adds new permissions or expands existing permissions).
		<ol type="a"><li>Export and view this activity via the ServicePrincipal_Operations_Export.</li>
		</ol></li>
		<li>Record <code>OAuth</code> consent and consent to applications
		<ol type="a"><li>Export and view this record via the Consent_Operations_Export file.</li>
		</ol></li>
		<li>Investigate instances of excessive high permissions, including, but not limited to Exchange Online, Microsoft Graph, and Azure AD Graph.
		<ol type="a"><li>Review Microsoft Graph API permissions granted to service principals.</li>
			<li>Export and view this activity via the ApplicationGraphPermissions csv file.
			<ol type="i"><li><strong>Note:</strong> Hawk can also return the full list of service principal permissions for further investigation.</li>
			</ol></li>
			<li>Review top actors and the amount of credential modifications performed.</li>
			<li>Monitor changes in application credentials.</li>
		</ol></li>
		<li>Identify manipulation of custom or third-party applications.
		<ol type="a"><li>Network defenders should review the catalog of custom or third-party vendors with applications in the Microsoft tenant and perform the above interrogation principles on those applications and trusts.</li>
		</ol></li>
		<li>Review modifications to federation trust settings.
		<ol type="a"><li>Review new token validation time periods with high values and investigate whether this was a legitimate change or an attempt to gain persistence by the threat actor.
			<ol type="i"><li>The script detects the escalation of privileges, including the addition of Service Principals (SP) to privileged roles. Export this data into csv called AppRoleAssignment_Operations_Export.</li>
			</ol></li>
		</ol></li>
		<li>In MailItemsAccessed operations, found within the Unified Audit Log (UAL), review the application ID used (requires G5 or E5 license for this specific detail).</li>
		<li>Query the specific application ID, using the Sparrow scriptâs app ID investigation capability to interrogate mail and file items accessed for that applicationID (Use the application ID utility for any other suspicious apps that require additional analysis.).</li>
		<li>Check the permissions of an application in M365/Azure AD using Sparrow.
		<ol type="a"><li>Hawk will return Azure_Application_Audit, and Sparrow will return ApplicationGraphPermissions.</li>
			<li>Network defenders will see the IP address that Graph API uses.</li>
			<li>Note: the Microsoft IP address may not show up as a virtual private server/anonymized endpoint.</li>
		</ol></li>
		<li>Investigate a specific service principal, if it is a user-specific user account, in Hawk. This activity is challenging to see without Azure Sentinel or manually downloading and reviewing logs from the sign-in portal.</li>
		<li>Longer term storage of log data.</li>
		<li>Cross correlation of log data with endpoint data and network data (such as those produced by ADFS servers), endpoint detection and response data, and identity provider information.</li>
		<li>Ability to query use of application connectors in Azure.</li>
	</ol></li>
</ol></div>
      
        
        		    <a id="contact-information"></a>
		    <h3>Contact Information</h3>
            
            <div class="field field--name-field-aa-contact-info field--type-text-long field--label-hidden field--item"><p>CISA encourages recipients of this report to contribute any additional information that they may have related to this threat. For any questions related to this report, please contact CISA at</p>

<ul><li>1-888-282-0870 (From outside the United States: +1-703-235-8832)</li>
	<li><a href="mailto:central@cisa.dhs.gov">central@cisa.dhs.gov </a>(UNCLASS)</li>
	<li>us-cert@dhs.sgov.gov (SIPRNET)</li>
	<li>us-cert@dhs.ic.gov (JWICS)</li>
</ul><p>CISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams. Reporting forms can be found on the CISA/US-CERT homepage at <a href="http://www.us-cert.cisa.gov/">http://www.us-cert.cisa.gov/</a>.</p>

<h3>Resources</h3>

<p>Azure Active Directory Workbook to Assess Solorigate Risk: <a href="https://techcommunity.microsoft.com/t5/azure-active-directory-identity/azure-ad-workbook-to-help-you-assess-solorigate-risk/ba-p/2010718">https://techcommunity.microsoft.com/t5/azure-active-directory-identity/azure-ad-workbook-to-help-you-assess-solorigate-risk/ba-p/2010718</a></p>

<p>Volexity - Dark Halo Leverages SolarWinds Compromise to Breach Organizations: <a href="https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/">https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/</a></p>

<p>How to Find Activity with Sentinel:<a href="https://www.verboon.info/2020/10/monitoring-service-principal-sign-ins-with-azuread-and-azure-sentinel/"> https://www.verboon.info/2020/10/monitoring-service-principal-sign-ins-with-azuread-and-azure-sentinel/</a></p>

<p>Third-Party Walkthrough of the Attack: <a href="https://dirkjanm.io/azure-ad-privilege-escalation-application-admin/">https://dirkjanm.io/azure-ad-privilege-escalation-application-admin/</a></p>

<p>National Security Agency Advisory on Detecting Abuse of Authentication Mechanisms: <a href="https://media.defense.gov/2020/Dec/17/2002554125/-1/-1/0/AUTHENTICATION_MECHANISMS_CSA_U_OO_198854_20.PDF">https://media.defense.gov/2020/Dec/17/2002554125/-1/-1/0/AUTHENTICATION_MECHANISMS_CSA_U_OO_198854_20.PDF</a></p>

<p>Microsoft 365 App for Splunk: <a href="https://splunkbase.splunk.com/app/3786/">https://splunkbase.splunk.com/app/3786/</a></p>

<p>CISA Remediation Guidance: <a href="https://us-cert.cisa.gov/ncas/alerts/aa20-352a">https://us-cert.cisa.gov/ncas/alerts/aa20-352a</a></p>
</div>
      
        
        		    <a id="references"></a>
		    <h3>References</h3>
            
      <div class="field field--name-field-aa-references field--type-link field--label-hidden field--items">
              <div class="field--item"><a href="https://www.zdnet.com/article/a-second-hacking-group-has-targeted-solarwinds-systems/">[1] ZDNet: A Second Hacking Group has Targeted SolarWinds Systems </a></div>
              <div class="field--item"><a href="https://www.cisa.gov/supply-chain-compromise">[2] CISA: Supply Chain Compromise </a></div>
              <div class="field--item"><a href="https://techcommunity.microsoft.com/t5/azure-sentinel/solarwinds-post-compromise-hunting-with-azure-sentinel/ba-p/1995095">[3] Microsoft SolarWinds Post-Compromise Hunting with Azure Sentinel </a></div>
              <div class="field--item"><a href="https://msrc-blog.microsoft.com/2020/12/21/december-21st-2020-solorigate-resource-center/">[4] Microsoft Solorigate Resource Center </a></div>
              <div class="field--item"><a href="https://docs.microsoft.com/en-us/microsoft-365/compliance/advanced-audit?view=o365-worldwide">[5] Advanced Audit in Microsoft 365 </a></div>
              <div class="field--item"><a href="https://techcommunity.microsoft.com/t5/azure-active-directory-identity/understanding-quot-solorigate-quot-s-identity-iocs-for-identity/ba-p/2007610">[6] Microsoft: Understanding âSolorigateâsâ Identity IOCs </a></div>
              <div class="field--item"><a href="https://www.sygnia.co/golden-saml-advisory">[7] Detection and Hunting of Golden SAML Attack: </a></div>
              <div class="field--item"><a href="https://www.sygnia.co/golden-saml-advisory">[8] Ibid</a></div>
              <div class="field--item"><a href="https://www.sygnia.co/golden-saml-advisory">[9] Ibid</a></div>
              <div class="field--item"><a href="https://docs.microsoft.com/en-us/azure/azure-monitor/reference/tables/aadserviceprincipalsigninlogs">[10] Microsoft: AADServicePrincipalSignInLogs</a></div>
              <div class="field--item"><a href="https://techcommunity.microsoft.com/t5/azure-active-directory-identity/understanding-quot-solorigate-quot-s-identity-iocs-for-identity/ba-p/2007610">[11] Microsoft: Understanding âSolorigateâsâ Identity IOCs </a></div>
              <div class="field--item"><a href="https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-all-sign-ins">[12] Azure Active Directory Sign-in Activity Reports</a></div>
              <div class="field--item"><a href="https://www.crowdstrike.com/blog/crowdstrike-launches-free-tool-to-identify-and-help-mitigate-risks-in-azure-active-directory/">[13] CrowdStrike: CrowdStrike Launches Free Tool to Identify and Help Mitigate â¦</a></div>
              <div class="field--item"><a href="https://splunkbase.splunk.com/app/3786/">[14] Microsoft 365 App for Splunk </a></div>
          </div>
  
        
        		    <a id="revisions"></a>
		    <h3>Revisions</h3>
            
      <div class="field field--name-field-aa-revisions field--type-string field--label-hidden field--items">
              <div class="field--item">Initial version: January 8, 2021</div>
              <div class="field--item">February 4, 2021: Removed link and section for outdated product feedback form</div>
              <div class="field--item">April 8, 2021: Added Aviary Dashboard information</div>
              <div class="field--item">April 15, 2021: Added Attribution Statement</div>
          </div>
  
        
        
            <div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"><p class="privacy-and-terms">This product is provided subject to this <a href="/privacy/notification">Notification</a> and this <a href="https://www.dhs.gov/privacy-policy">Privacy &amp; Use</a> policy.</p>
</div>
      

	</div>
                        <div id="document-feedback">
	<div class="inner-document-feedback center-center">
        <p><b>Please share your thoughts.</b></p>
		<p>We recently updated our anonymous <a href="https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/alerts/aa21-008a">product survey</a>; we'd welcome your feedback.</p>
	</div>
</div>

              </div>

</article>


  </div>

              </section>


                      </div>
  </div>






      <footer class="footer container-fluid" role="contentinfo">
        <div class="region region-footer">
    <section id="block-certsignup" class="block block-block-content block-block-contentc5846d10-2e2b-4822-aa59-7a5c3262f671 clearfix">
  
    

      
            <div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"><div class="container-fluid signup">
<div class="container">
<div class="row">
<div class="col-lg-3 contact-icons">
<h3>Contact Us</h3>

<p class="phone-text"><img alt="phone icon" data-entity-type="" data-entity-uuid="" src="/sites/default/files/images/Icon-Phone.png" />(888)282-0870</p>

<p><img alt="email icon" data-entity-type="" data-entity-uuid="" src="/sites/default/files/images/Icon-Email.png" /><a class="mailto" href="mailto:central@cisa.dhs.gov" title="General questions or suggestions">Send us email</a></p>

<p><img alt="lock icon" data-entity-type="" data-entity-uuid="" src="/sites/default/files/images/Icon-Lock.png" /><a href="/contact-us/" title="Download PGP/GPG keys">Download PGP/GPG keys</a></p>

<p><img alt="feedback icon" data-entity-type="" data-entity-uuid="" height="32" src="/sites/default/files/images/icon-feedback.png" /><a href="/forms/website-feedback" title="Website Feedback">Submit website feedback</a></p>
</div>

<div class="col-lg-6 sub-alert">
<h3>Subscribe to Alerts</h3>

<p>Receive security alerts, tips, and other updates.</p>

<form action="https://public.govdelivery.com/accounts/USDHSCISA/subscribers/qualify"><label class="visually-hidden" for="email-address-field">Enter your email address</label> <input class="signup-form" id="email-address-field" name="email" placeholder=" Enter your email address" title="Enter your email address" type="text" /><br /><input class="btn btn-primary" name="submit" title="Sign up for alerts" type="submit" value="Sign Up" />Â </form>

<div class="pull-right signup-icon-one"><a href="https://twitter.com/uscert_gov" title="US-CERT Twitter Feed"><img alt="twitter icon" data-entity-type="" data-entity-uuid="" src="/sites/default/files/images/twitter-button.png" /></a></div>

<div class="pull-right signup-icon-two"><a href="/mailing-lists-and-feeds" title="Mailing Lists and Feeds"><img alt="rss icon" data-entity-type="" data-entity-uuid="" src="/sites/default/files/images/rss-button-bottom.png" /></a></div>

<div class="pull-right signup-icon-three"><a href="/hsin" class="btn btn-cert-report" name="button" type="button" id="button">HSIN</a></div>
</div>

<div class="col-lg-3 cert-report"><a class="btn btn-cert-report btn-lg" href="/report" name="button" type="button" id="button">Report</a></div>
</div>
</div>
</div>
</div>
      
  </section>

<section id="block-certcertfooter" class="block block-block-content block-block-contentd5b85bd2-62d1-485a-b9ae-f040b1ca1a45 clearfix">
  
    

      
            <div class="field field--name-body field--type-text-with-summary field--label-hidden field--item"><div class="container">
<hr /><div class="text-center"><a href="/" title="Home">Home</a> Â  <a href="/sitemap" title="Site Map">Site Map</a> Â  <a href="/faq/" title="Frequently Asked Questions">FAQ</a> Â  <a href="/contact-us/" title="Contact Us">Contact Us</a> Â  <a href="/tlp/" title="Traffic Light Protocol">Traffic Light Protocol</a> Â  <a href="/pcii" title="PCII">PCII</a> Â  <a href="https://www.dhs.gov" title="Accountability">Accountability</a> Â  <a href="/disclaimer" title="Disclaimer">Disclaimer</a> Â  <a href="/privacy-policy" title="Privacy Policy">Privacy Policy</a> Â  <a href="https://www.dhs.gov/freedom-information-act-foia" title="FOIA">FOIA</a> Â  <a href="https://www.dhs.gov/homeland-security-no-fear-act-reporting" title="No Fear Act">No Fear Act</a> Â  <a href="/accessibility/" title="Accessibility">Accessibility</a><a href="https://www.dhs.gov/plain-writing-dhs" title="Plain Writing">Plain Writing</a><a href="https://www.dhs.gov/plug-information" title="Plug-ins">Plug-ins</a> Â  <a href="https://www.oig.dhs.gov/" title="Office of the Inspector General">Inspector General</a> Â  <a href="https://www.whitehouse.gov/" title="The White House">The White House</a> Â  <a href="https://www.usa.gov/" title="USA.gov">USA.gov</a><br />
Â 
<p>CISA is part of the <a href="https://www.dhs.gov/" title="Department of Homeland Security">Department of Homeland Security</a></p>
</div>
<script type="text/javascript">
<!--//--><![CDATA[// ><!--

    window.onload = function(){
            jQuery('body.page-node-type-us-cert-events div#ncas-header').find('img').each(function(){
                    var $src=jQuery(this).prop('src');
                    if($src.indexOf('default/files/') == -1)jQuery(this).remove();
                    });
            if('Privacy Data Breach' == jQuery('#uscert-utilities-irf-form #item-info-impact option:selected').text()){ 
                jQuery('#item-info-impact-block').removeClass('collapsed'); 
            }
jQuery('#print-logo img').removeAttr('width').removeAttr('height');
if(jQuery('body.path-frontpage').length > 0)
{   
    jQuery('.main-container').find('.col-sm-12').removeAttr('role');
}
jQuery('#map area').each(function(){ jQuery(this).click(function(){var idstr=jQuery(this).attr('clickthis'); if(jQuery(idstr).hasClass('open') == false){jQuery(idstr).click();}});});  
if(jQuery('#document-feedback').length > 0)
{ 
    var $url    = window.location.href
    //var str ='Your feedback is very important to us. Please take a moment to complete this <a href="https://surveymonkey.com/r/G8STDRY?product=' + $url + '">survey.';
    //var $p = jQuery('#document-feedback div p').html(str);
}
    };

//--><!]]>
</script></div>
<style type="text/css">
<!--/*--><![CDATA[/* ><!--*/
#views-bootstrap-carousel-block-2 .carousel-inner > .item > a > img {
  margin:auto;
}
button#product-feedback-next {
    margin-bottom: 10px;
}
/*
.mobile-nav {
border-bottom: 3px solid #112e51;
}
*/
.cma-banner-container {
    display: none;
}
@media (max-width: 991px) {
.navbar .navbar-header {
background: #fff;
}
}
div.banner-region { background: #fff; }

.accordion_fold {
    padding-bottom: 25px;
}

h2.accordion.open {
    background: #f2f2f2;
}

a { color: #2b72af;}

.navbar-default .navbar-nav > li > a { color: #767676; }
/* andi */
.sidebar-widget-orange .orange {
    background-color: #e77431;
}
#block-views-block-ics-announcements-block-1 .views-field-created {
    color: #565656;
}
a#sort-bulletin {
color: #000;
background: white;
position: absolute;
right: 150px;
padding: 1px 12px;
}

/*--><!]]>*/
</style></div>
      
  </section>


  </div>

    </footer>
  
  </div>

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/15902","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"google_analytics":{"account":"UA-34879253-1","trackOutbound":true,"trackMailto":true,"trackDownload":true,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"},"data":{"extlink":{"extTarget":false,"extTargetNoOverride":false,"extNofollow":false,"extNoreferrer":false,"extFollowNoOverride":false,"extClass":"ext","extLabel":"(link is external)","extImgClass":false,"extSubdomains":true,"extExclude":"(\\.gov|\\.mil|\\.org.*|twitter\\.com\\\/share\\?url\\=.*|www\\.facebook\\.com\\\/sharer\\.php\\?u\\=.*|www\\.addthis\\.com\\\/bookmark\\.php\\?url\\=.*|javascript\\:window\\.print\\(\\)\\;)","extInclude":"","extCssExclude":"","extCssExplicit":"","extAlert":true,"extAlertText":"You are now leaving an official website of the United States Government (USG), the Department of Homeland Security (DHS), and the Cybersecurity and Infrastructure Security Agency (CISA). Links to non-USG, non-DHS, and non-CISA sites are provided for the visitor\u0027s convenience and do not represent an endorsement by USG, DHS, or CISA of any commercial or private issues, products, or services. Note that the privacy policy of the linked site may differ from that of USG, DHS, and CISA.","mailtoClass":"mailto","mailtoLabel":"(link sends email)","extUseFontAwesome":false,"extIconPlacement":"append","extFaLinkClasses":"fa fa-external-link","extFaMailtoClasses":"fa fa-envelope-o","whitelistedDomains":null}},"bootstrap":{"forms_has_error_value_toggle":1,"popover_enabled":1,"popover_animation":1,"popover_auto_close":1,"popover_container":"body","popover_content":"","popover_delay":"0","popover_html":0,"popover_placement":"right","popover_selector":"","popover_title":"","popover_trigger":"click","tooltip_enabled":1,"tooltip_animation":1,"tooltip_container":"body","tooltip_delay":"0","tooltip_html":0,"tooltip_placement":"auto left","tooltip_selector":"","tooltip_trigger":"hover"},"user":{"uid":0,"permissionsHash":"5ac3ae468050ddd0aa4ecea12c34a32977a23244239ed53eb7226f296aed658f"}}</script>
<script src="/sites/default/files/js/js_xhqBHziEDyCKWlB5IUseaFAGh1B08TPFGmxCf6RvFnM.js"></script>
<script src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DHS&amp;subagency=US-CERT&amp;pua=0" id="_fed_an_ua_tag"></script>
<script src="/sites/default/files/js/js_m5CHELy9XHlAx2jnhaYdT2XVeN916TnZL5U2ha7Ln94.js"></script>

  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"877b02039c","applicationID":"628657512,979282327","transactionName":"ZFYHMhZSXUpRUkcKDF0cJAUQWlxXH0FSBAZsUAQFDFY=","queueTime":0,"applicationTime":20,"atts":"SBEERF5ITkQ=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
