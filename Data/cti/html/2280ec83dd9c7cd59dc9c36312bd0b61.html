<!doctype html>
<html lang="en-US"  class="no-js">
<head>
	
	<script>
		var cookie_free_page = 'https://www.sentinelone.com/global-services/get-support-now/';
		if ( cookie_free_page.substr( 0, 2 ) == '//' ) {
			cookie_free_page = window.location.protocol + cookie_free_page;
		}
		var privacy_policy_page = 'https://www.sentinelone.com/legal/';
		if ( privacy_policy_page.substr( 0, 2 ) == '//' ) {
			privacy_policy_page = window.location.protocol + privacy_policy_page;
		}
		var cookies_rejected = document.cookie.includes( 's1CookiePolicyV2=rejected' );
		var is_cookie_free_page = window.location == cookie_free_page;
		var is_legal_page = window.location.toString().indexOf( privacy_policy_page ) != -1;
		console.log(cookies_rejected, is_cookie_free_page,is_legal_page)
		if ( cookies_rejected && ( is_cookie_free_page == false && is_legal_page == false ) ) {
			console.log( "redirecting to: " + cookie_free_page );
			window.location = cookie_free_page;
			document.write( '<!--' );
		}
	</script>
	
	<meta charset="UTF-8">	
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRJS-7f7a0b93139dcf56f90",applicationID:"773889139"};window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var i=t[n]={exports:{}};e[n][0].call(i.exports,function(t){var i=e[n][1][t];return r(i||t)},i,i.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t,n){function r(){}function i(e,t,n){return function(){return o(e,[u.now()].concat(c(arguments)),t?null:this,n),t?void 0:this}}var o=e("handle"),a=e(7),c=e(8),f=e("ee").get("tracer"),u=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],p="api-",l=p+"ixn-";a(d,function(e,t){s[t]=i(p+t,!0,"api")}),s.addPageAction=i(p+"addPageAction",!0),s.setCurrentRouteName=i(p+"routeName",!0),t.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,t){var n={},r=this,i="function"==typeof t;return o(l+"tracer",[u.now(),e,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return t.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],n),e}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,t){m[t]=i(l+t)}),newrelic.noticeError=function(e,t){"string"==typeof e&&(e=new Error(e)),o("err",[e,u.now(),!1,t])}},{}],2:[function(e,t,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=e(9);t.exports=r,t.exports.offset=a,t.exports.getLastTimestamp=i},{}],3:[function(e,t,n){function r(e){return!(!e||!e.protocol||"file:"===e.protocol)}t.exports=r},{}],4:[function(e,t,n){function r(e,t){var n=e.getEntries();n.forEach(function(e){"first-paint"===e.name?d("timing",["fp",Math.floor(e.startTime)]):"first-contentful-paint"===e.name&&d("timing",["fcp",Math.floor(e.startTime)])})}function i(e,t){var n=e.getEntries();n.length>0&&d("lcp",[n[n.length-1]])}function o(e){e.getEntries().forEach(function(e){e.hadRecentInput||d("cls",[e])})}function a(e){if(e instanceof m&&!g){var t=Math.round(e.timeStamp),n={type:e.type};t<=p.now()?n.fid=p.now()-t:t>p.offset&&t<=Date.now()?(t-=p.offset,n.fid=p.now()-t):t=p.now(),g=!0,d("timing",["fi",t,n])}}function c(e){d("pageHide",[p.now(),e])}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d=e("handle"),p=e("loader"),l=e(6),m=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){f=new PerformanceObserver(r);try{f.observe({entryTypes:["paint"]})}catch(v){}u=new PerformanceObserver(i);try{u.observe({entryTypes:["largest-contentful-paint"]})}catch(v){}s=new PerformanceObserver(o);try{s.observe({type:"layout-shift",buffered:!0})}catch(v){}}if("addEventListener"in document){var g=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(e){document.addEventListener(e,a,!1)})}l(c)}},{}],5:[function(e,t,n){function r(e,t){if(!i)return!1;if(e!==i)return!1;if(!t)return!0;if(!o)return!1;for(var n=o.split("."),r=t.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}t.exports={agent:i,version:o,match:r}},{}],6:[function(e,t,n){function r(e){function t(){e(a&&document[a]?document[a]:document[i]?"hidden":"visible")}"addEventListener"in document&&o&&document.addEventListener(o,t,!1)}t.exports=r;var i,o,a;"undefined"!=typeof document.hidden?(i="hidden",o="visibilitychange",a="visibilityState"):"undefined"!=typeof document.msHidden?(i="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(i="webkitHidden",o="webkitvisibilitychange",a="webkitVisibilityState")},{}],7:[function(e,t,n){function r(e,t){var n=[],r="",o=0;for(r in e)i.call(e,r)&&(n[o]=t(r,e[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],8:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,i=n-t||0,o=Array(i<0?0:i);++r<i;)o[r]=e[t+r];return o}t.exports=r},{}],9:[function(e,t,n){t.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,t,n){function r(){}function i(e){function t(e){return e&&e instanceof r?e:e?u(e,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){e&&a&&e(n,r,i);for(var c=t(i),f=v(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[h[n]];return p&&p.push([b,n,r,c]),c}}function o(e,t){y[e]=v(e).concat(t)}function m(e,t){var n=y[e];if(n)for(var r=0;r<n.length;r++)n[r]===t&&n.splice(r,1)}function v(e){return y[e]||[]}function g(e){return p[e]=p[e]||i(n)}function w(e,t){s(e,function(e,n){t=t||"feature",h[n]=t,t in d||(d[t]=[])})}var y={},h={},b={on:o,addEventListener:o,removeEventListener:m,emit:n,get:g,listeners:v,context:t,buffer:w,abort:c,aborted:!1};return b}function o(e){return u(e,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=e("gos"),s=e(7),d={},p={},l=t.exports=i();t.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(e,t,n){function r(e,t,n){if(i.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return e[t]=r,r}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){i.buffer([e],r),i.emit(e,t,n)}var i=e("ee").get("handle");t.exports=r,r.ee=i},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,o,function(){return i++})}var i=1,o="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!E++){var e=x.info=NREUM.info,t=l.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return u.abort();f(h,function(t,n){e[t]||(e[t]=n)});var n=a();c("mark",["onload",n+x.offset],null,"api"),c("timing",["load",n]);var r=l.createElement("script");r.src="https://"+e.agent,t.parentNode.insertBefore(r,t)}}function i(){"complete"===l.readyState&&o()}function o(){c("mark",["domContent",a()+x.offset],null,"api")}var a=e(2),c=e("handle"),f=e(7),u=e("ee"),s=e(5),d=e(3),p=window,l=p.document,m="addEventListener",v="attachEvent",g=p.XMLHttpRequest,w=g&&g.prototype;if(d(p.location)){NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:g,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var y=""+location,h={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1208.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=t.exports={offset:a.getLastTimestamp(),now:a,origin:y,features:{},xhrWrappable:b,userAgent:s};e(1),e(4),l[m]?(l[m]("DOMContentLoaded",o,!1),p[m]("load",r,!1)):(l[v]("onreadystatechange",i),p[v]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var E=0}},{}],"wrap-function":[function(e,t,n){function r(e,t){function n(t,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],e)}c(n+"start",[o,a,f],s,u);try{return p=t.apply(a,o)}catch(m){throw c(n+"err",[o,a,m],s,u),m}finally{c(n+"end",[o,a,p],s,u)}}return a(t)?t:(n||(n=""),nrWrapper[p]=t,o(t,nrWrapper,e),nrWrapper)}function r(e,t,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<t.length;u++)f=t[u],c=e[f],a(c)||(e[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!m||t){var c=m;m=!0;try{e.emit(n,r,o,t,a)}catch(f){i([f,n,r,o],e)}m=c}}return e||(e=s),n.inPlace=r,n.flag=p,n}function i(e,t){t||(t=s);try{t.emit("internal-error",e)}catch(n){}}function o(e,t,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(e);return r.forEach(function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){return e[n]=t,t}})}),t}catch(o){i([o],n)}for(var a in e)l.call(e,a)&&(t[a]=e[a]);return t}function a(e){return!(e&&e instanceof Function&&e.apply&&!e[p])}function c(e,t){var n=t(e);return n[p]=e,o(e,n,s),n}function f(e,t,n){var r=e[t];e[t]=c(r,n)}function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;++n)t[n]=arguments[n];return t}var s=e("ee"),d=e(8),p="nr@original",l=Object.prototype.hasOwnProperty,m=!1;t.exports=r,t.exports.wrapFunction=c,t.exports.wrapInPlace=f,t.exports.argsToArray=u},{}]},{},["loader"]);</script>
	<meta name="viewport" content="width=device-width,initial-scale=1">
	
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5b0fde">
	<meta name="msapplication-TileColor" content="#5b0fde">
	<meta name="theme-color" content="#ffffff">
	
	<link href="//ajax.googleapis.com" rel="dns-prefetch">
	
	<link rel="alternate" href="https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/" hreflang="en" />
	
	<title>How Offensive Actors Use AppleScript For Attacking macOS - SentinelOne</title>

<!-- This site is optimized with the Yoast SEO Premium plugin v11.8 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="AppleScript is widely used by threat actors and yet widely ignored by security researchers. Here&#039;s why we need to rethink our attitude to this unique tool."/>
<link rel="canonical" href="https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How Offensive Actors Use AppleScript For Attacking macOS - SentinelOne" />
<meta property="og:description" content="AppleScript is widely used by threat actors and yet widely ignored by security researchers. Here&#039;s why we need to rethink our attitude to this unique tool." />
<meta property="og:url" content="https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/" />
<meta property="og:site_name" content="SentinelOne" />
<meta property="article:tag" content="applescript" />
<meta property="article:tag" content="macOS" />
<meta property="article:tag" content="Malware" />
<meta property="article:tag" content="red team" />
<meta property="article:tag" content="Researcher" />
<meta property="article:section" content="Security" />
<meta property="article:published_time" content="2020-03-16T17:34:31-07:00" />
<meta property="article:modified_time" content="2021-01-12T20:14:03-08:00" />
<meta property="og:updated_time" content="2021-01-12T20:14:03-08:00" />
<meta property="og:image" content="https://www.sentinelone.com/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-1.jpg" />
<meta property="og:image:secure_url" content="https://www.sentinelone.com/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-1.jpg" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="628" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="AppleScript is widely used by threat actors and yet widely ignored by security researchers. Here&#039;s why we need to rethink our attitude to this unique tool." />
<meta name="twitter:title" content="How Offensive Actors Use AppleScript For Attacking macOS - SentinelOne" />
<meta name="twitter:image" content="https://www.sentinelone.com/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-1.jpg" />
<script type='application/ld+json' class='yoast-schema-graph yoast-schema-graph--main'>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.sentinelone.com/#website","url":"https://www.sentinelone.com/","name":"SentinelOne","potentialAction":{"@type":"SearchAction","target":"https://www.sentinelone.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/#primaryimage","url":"https://www.sentinelone.com/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-2.jpg","width":1200,"height":628},{"@type":"WebPage","@id":"https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/#webpage","url":"https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/","inLanguage":"en-US","name":"How Offensive Actors Use AppleScript For Attacking macOS - SentinelOne","isPartOf":{"@id":"https://www.sentinelone.com/#website"},"primaryImageOfPage":{"@id":"https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/#primaryimage"},"datePublished":"2020-03-16T17:34:31-07:00","dateModified":"2021-01-12T20:14:03-08:00","author":{"@id":"https://www.sentinelone.com/#/schema/person/489520f5d53975db6b6f292dee001a87"},"description":"AppleScript is widely used by threat actors and yet widely ignored by security researchers. Here's why we need to rethink our attitude to this unique tool."},{"@type":["Person"],"@id":"https://www.sentinelone.com/#/schema/person/489520f5d53975db6b6f292dee001a87","name":"Phil Stokes","image":{"@type":"ImageObject","@id":"https://www.sentinelone.com/#authorlogo","url":"https://secure.gravatar.com/avatar/988f7b3ecd37145cc3e640511359a285?s=96&d=mm&r=g","caption":"Phil Stokes"},"sameAs":[]}]}</script>
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//www.sentinelone.com' />
<link rel='dns-prefetch' href='//go.sentinelone.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//cloud.typography.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//899029.smushcdn.com' />
<link rel="alternate" type="application/rss+xml" title="SentinelOne &raquo; Feed" href="https://www.sentinelone.com/feed/" />
<link rel='stylesheet' id='carbine-font-body-css'  href='https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,400i,700,700i' type='text/css' media='all' />
<link rel='stylesheet' id='carbine-font-heading-css'  href='https://cloud.typography.com/7197018/6979812/css/fonts.css' type='text/css' media='all' />
<link rel='stylesheet' id='carbine-style-css'  href='https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/css/style.min.css?ver=1621675641' type='text/css' media='all' />
<script type='text/javascript' src='https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/js/jquery-3.5.1.min.js' id='jquery-core-js'></script>
<script type='text/javascript' src='//go.sentinelone.com/js/forms2/js/forms2.min.js' id='marketo-forms-js'></script>
<script type='text/javascript' src='https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/js/header.min.js?ver=1621675641' id='carbine-script-header-js'></script>
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.sentinelone.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://www.sentinelone.com/?p=29053' />
<style>
.mega .panel img {
    max-width: 285px;
}
#menu-item-40019 {
    margin-bottom: 50px;
}
#menu-item-40015 > .mega > .container > .panel > a:nth-child(even) {
    font-size: 14px;
    padding: 12px 50px 12px 26px;
    background-color: #6b0aea;
    border-radius: 2px;
    letter-spacing: .15em;
    text-transform: uppercase;
    font-weight: 500;
    line-height: 15px;
    background-position: 86%;
    transition: color .3s,padding-right .3s;
    margin-top: .5rem;
}
#menu-item-40015 > .mega > .container > .panel > a:nth-child(even):hover {
    padding: 12px 60px 12px 26px;
    color: #fff;
}
.rev_slider .dione.tparrows:hover {
    background: none !important;
}
.rev_slider .dione.tparrows:hover {
    background: none !important;
}
#content .text-blog .inverted {
    font-weight: 400;
    background: #7e4aac;
    padding: 15px;
    border-radius: 6px;
    color: #fff !important;
    display: block;
}
#content .text-blog .inverted a {
    color: #fff !important;
    text-decoration: underline;
}
#content .text-blog .inverted a:hover {
    color: #fff !important;
    text-decoration: underline;
}
.page-id-23924 .xup_blocks.simple-gotham .entries, .xup_blocks.simple .entries {
    justify-content: center;
}
.code-wrap table {
		width: 100%;
		border-collapse: collapse;
		border: 1px solid #ddd;
		border-radius: 0;
		background: #fff;
		box-shadow: 3px 3px 0px 0px rgba(0,0,0,0.03);
}
.code-wrap td, .code-wrap th {
			border: 1px solid #dee2e6;
			padding: 10px;
}
</style>

<!-- Begin TVSquared Tracking Code -->
<script type="text/javascript">
	var _tvq = window._tvq = window._tvq || [];
	(function() {
		var u = (("https:" == document.location.protocol) ? "https://collector-5527.tvsquared.com/" : "http://collector-5527.tvsquared.com/");
		_tvq.push(['setSiteId', "TV-45457227-1"]);
		_tvq.push(['setTrackerUrl', u + 'tv2track.php']);
		_tvq.push([function() {
			this.deleteCustomVariable(5, 'page')
		}]);
		_tvq.push(['trackPageView']);
		var d = document,
			g = d.createElement('script'),
			s = d.getElementsByTagName('script')[0];
		g.type = 'text/javascript';
		g.defer = true;
		g.async = true;
		g.src = u + 'tv2track.js';
		s.parentNode.insertBefore(g, s);
	})();
</script>
<!-- End TVSquared Tracking Code -->

<!-- Start 6 Sense Code -->
<script>
	window._6si = window._6si || [];
	window._6si.push(['enableEventTracking', true]);
	window._6si.push(['setToken', '3576c97e67a9b7f8553a44ff1cc54791']);
	window._6si.push(['setEndpoint', 'b.6sc.co']);
	(function() {
		var gd = document.createElement('script');
		gd.type = 'text/javascript';gd.async = true;
		gd.src = '//j.6sc.co/6si.min.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(gd, s);
	})();
</script>
<!-- End 6 Sense Code -->
      <meta name="onesignal" content="wordpress-plugin"/>
            <script>

      window.OneSignal = window.OneSignal || [];

      OneSignal.push( function() {
        OneSignal.SERVICE_WORKER_UPDATER_PATH = "OneSignalSDKUpdaterWorker.js.php";
                      OneSignal.SERVICE_WORKER_PATH = "OneSignalSDKWorker.js.php";
                      OneSignal.SERVICE_WORKER_PARAM = { scope: "/" };
        OneSignal.setDefaultNotificationUrl("https://www.sentinelone.com");
        var oneSignal_options = {};
        window._oneSignalInitOptions = oneSignal_options;

        oneSignal_options['wordpress'] = true;
oneSignal_options['appId'] = 'acaf2329-c613-4dbe-a651-1ed5a45c3762';
oneSignal_options['allowLocalhostAsSecureOrigin'] = true;
oneSignal_options['welcomeNotification'] = { };
oneSignal_options['welcomeNotification']['disable'] = true;
oneSignal_options['path'] = "https://www.sentinelone.com/wp-content/plugins/onesignal-free-web-push-notifications/sdk_files/";
oneSignal_options['persistNotification'] = true;
oneSignal_options['promptOptions'] = { };
                OneSignal.init(window._oneSignalInitOptions);
                OneSignal.showSlidedownPrompt();      });

      function documentInitOneSignal() {
        var oneSignal_elements = document.getElementsByClassName("OneSignal-prompt");

        var oneSignalLinkClickHandler = function(event) { OneSignal.push(['registerForPushNotifications']); event.preventDefault(); };        for(var i = 0; i < oneSignal_elements.length; i++)
          oneSignal_elements[i].addEventListener('click', oneSignalLinkClickHandler, false);
      }

      if (document.readyState === 'complete') {
           documentInitOneSignal();
      }
      else {
           window.addEventListener("load", function(event){
               documentInitOneSignal();
          });
      }
    </script>
	
		<!-- Google Tag Manager -->
	<script>
		(function($) {
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KGGXSJ');
		})(jQuery);
	</script>
	<!-- End Google Tag Manager -->
		
				
		
		
	<script>
		var $ = jQuery.noConflict();
	</script>
	
</head>
<body class="post-template-default single single-post postid-29053 single-format-standard site-www">
	
		<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KGGXSJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
		
		<header class="header hasbanner">
		
				<div class="banner">
			<div class="container">
				<div class="wide">
					<span>SentinelOne Named a Leader in the 2021 Gartner Magic Quadrant for Endpoint Protection Platforms</span>
					<a class="" href="https://www.sentinelone.com/lp/gartnermq/" target="_blank">
						Learn More					</a>
				</div>
				<div class="narrow">
					<a class="" href="https://www.sentinelone.com/lp/gartnermq/" target="_blank">
						SentinelOne Named a Leader in the 2021 Gartner Magic Quadrant for Endpoint Protection Platforms					</a>
				</div>
			</div>
		</div>
				
		<div class="top-bar">
			<div class="container">
				<div class="container-inner">
					<div class="top-bar-wrap">
												<span class="breach">Experiencing a Breach?</span>
						<div class="menu-top-bar-container"><ul id="menu-top-bar" class="menu"><li id="menu-item-16921" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16921"><a href="#s1phone">1-855-868-3733</a></li>
<li id="menu-item-25727" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25727"><a href="/contact/">Contact</a></li>
<li id="menu-item-16923" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-16923"><a href="https://www.sentinelone.com/blog/">Blog</a></li>
</ul></div>						<button class="search">
							<span class="light">
								<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/search-icon-white.svg" />
							</span>
							<span class="dark">
								<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/search-icon.svg" />
							</span>
						</button>
						<div class="search-form">
							<form autocomplete="off" method="get" action="https://www.sentinelone.com" >
								<fieldset>
									<input type="search" name="s" placeholder="Search ..." value="" />
									<button class="search" type="submit">
										<span class="light">
											<img class="icon-search" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/search-icon-white.svg" />
											<img class="icon-down" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/navigation-close.svg" />
										</span>
										<span class="dark">
											<img class="icon-search" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/search-icon.svg" />
											<img class="icon-down" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/navigation-close-dark.svg" />
										</span>
									</button>
								</fieldset>
							</form>
						</div>
											</div>
				</div>
									<div class="lang-select">
		<span class="label">en</span>
		<ul>
	<li class="current"><span href="https://www.sentinelone.com//">English</span></li><li class=""><a href="https://jp.sentinelone.com//">日本語</a></li><li class=""><a href="https://de.sentinelone.com//">Deutsch</a></li><li class=""><a href="https://es.sentinelone.com//">Español</a></li><li class=""><a href="https://fr.sentinelone.com//">Français</a></li><li class=""><a href="https://it.sentinelone.com//">Italiano</a></li><li class=""><a href="https://nl.sentinelone.com//">Dutch</a></li><li class=""><a href="https://kr.sentinelone.com//">한국어</a></li>		</ul>
	</div>
								</div>
		</div>
			
		<div class="navigation">
			<div class="container">
				<div class="logo fadein animated">
					<a href="/">
						<img class="light" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/s1-logo-color-light.svg" />
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/s1-logo-color.svg" />
												<span class="tag wow fadeIn">blog</span>
											</a>
				</div>
				<div class="nav-holder">
										<a class="demo fadein animated" href="/request-demo/">Get a Demo</a>
															<div class="menu-toggle"><a href="#"><span></span></a></div>
										<div class="nav-frame fadein animated delay-1s">
												<div class="menu-carbine-primary-container"><ul id="menu-carbine-primary" class="menu"><li id="menu-item-34979" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-34979"><a href="https://www.sentinelone.com/platform/">Platform</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2017/06/singularity-white.svg" /><div class="blurb">The SentinelOne platform delivers the defenses you need to prevent, detect, and undo—known and unknown—threats.</div><a href="https://www.sentinelone.com/platform/">Platform Overview</a><a href="https://www.sentinelone.com/platform-packages/" target="">Platform Packages</a><a href="https://www.sentinelone.com/vs/crowdstrike/" target="">SentinelOne vs CrowdStrike</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp6"><div class="subtitle">Platform Products</div>
<ul class="sub-menu">
	<li id="menu-item-35909" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35909"><a href="https://www.sentinelone.com/platform/singularity-complete/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-complete/"></a><a class="combined d-0" href="https://www.sentinelone.com/platform/singularity-complete/"><strong>Singularity</strong> Complete</a><span class="subtitle">The Future's Enterprise Security Platform</span><div class="bg"></div></li>
	<li id="menu-item-35912" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35912"><a href="https://www.sentinelone.com/platform/singularity-control/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-control/"></a><a class="combined d-1" href="https://www.sentinelone.com/platform/singularity-control/"><strong>Singularity</strong> Control</a><span class="subtitle">Security with Suite Features</span><div class="bg"></div></li>
	<li id="menu-item-35913" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35913"><a href="https://www.sentinelone.com/platform/singularity-core/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-core/"></a><a class="combined d-2" href="https://www.sentinelone.com/platform/singularity-core/"><strong>Singularity</strong> Core</a><span class="subtitle">Cloud-Native NGAV</span><div class="bg"></div></li>
	<li id="menu-item-41497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41497"><a href="/singularity-xdr/">Singularity</a><a class="link-wrap" href="/singularity-xdr/"></a><a class="combined d-3" href="/singularity-xdr/"><strong>Singularity</strong> XDR</a><span class="subtitle">Extended Detection & Response</span><div class="bg"></div></li>
	<li id="menu-item-35911" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35911"><a href="https://www.sentinelone.com/platform/singularity-ranger-iot/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-ranger-iot/"></a><a class="combined d-4" href="https://www.sentinelone.com/platform/singularity-ranger-iot/"><strong>Singularity</strong> Ranger IoT</a><span class="subtitle">Network Visibility & Control</span><div class="bg"></div></li>
	<li id="menu-item-35910" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35910"><a href="https://www.sentinelone.com/platform/singularity-cloud/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-cloud/"></a><a class="combined d-5" href="https://www.sentinelone.com/platform/singularity-cloud/"><strong>Singularity</strong> Cloud</a><span class="subtitle">Container & Cloud Workload Security</span><div class="bg"></div></li>
</ul></div><div class="menu-wrap secondary"><div class="subtitle">Platform Verticals</div><ul class="sub-menu">	<li id="menu-item-37383" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37383"><a href="https://www.sentinelone.com/platform/energy/">Energy</a></li>
	<li id="menu-item-37384" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37384"><a href="https://www.sentinelone.com/platform/finance/">Finance</a></li>
	<li id="menu-item-37387" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37387"><a href="https://www.sentinelone.com/platform/healthcare/">Healthcare</a></li>
	<li id="menu-item-37385" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37385"><a href="https://www.sentinelone.com/platform/highereducation/">Higher Education</a></li>
	<li id="menu-item-37386" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37386"><a href="https://www.sentinelone.com/platform/retail/">Retail</a></li>
	<li id="menu-item-41084" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41084"><a href="https://www.sentinelone.com/platform/manufacturing/">Manufacturing</a></li>
</ul>
</div></div></div></div></li>
<li id="menu-item-30696" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-30696"><a href="https://www.sentinelone.com/customer-page/">Our Customers</a></li>
<li id="menu-item-40015" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-40015"><a href="/global-services/services-overview/">Services</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2021/02/global_services-1.svg" /><div class="blurb">Augment leading technology with trusted expertise, and get set up for success with hands-on support and training.</div><a href="/global-services/services-overview/">Services Overview</a><a href="https://www.sentinelone.com/global-services/get-support-now/" target="">Get Help Now</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp"><div class="subtitle">Global Support & Services</div>
<ul class="sub-menu">
	<li id="menu-item-40017" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40017"><a href="https://www.sentinelone.com/global-services/vigilance-respond-pro/">Vigilance Respond Pro MDR + DFIR</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/vigilance-respond-pro/"></a><a class="combined d-0" href="https://www.sentinelone.com/global-services/vigilance-respond-pro/"><strong>Vigilance Respond Pro MDR + DFIR</strong> </a><span class="subtitle">24x7 MDR with Full-Scale<br/>Investigation and Response</span><div class="bg"></div></li>
	<li id="menu-item-40018" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40018"><a href="https://www.sentinelone.com/global-services/vigilance-respond">Vigilance Respond MDR</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/vigilance-respond"></a><a class="combined d-1" href="https://www.sentinelone.com/global-services/vigilance-respond"><strong>Vigilance Respond MDR</strong> </a><span class="subtitle">Dedicated SOC Expertise and Analysis</span><div class="bg"></div></li>
	<li id="menu-item-40019" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40019"><a href="https://www.sentinelone.com/global-services/watchtower/">WatchTower</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/watchtower/"></a><a class="combined d-2" href="https://www.sentinelone.com/global-services/watchtower/"><strong>WatchTower</strong> </a><span class="subtitle">Intelligence-Driven Threat Hunting</span><div class="bg"></div></li>
	<li id="menu-item-40020" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40020"><a href="https://www.sentinelone.com/global-services/readiness/">Readiness</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/readiness/"></a><a class="combined d-3" href="https://www.sentinelone.com/global-services/readiness/"><strong>Readiness</strong> </a><span class="subtitle">Best-Practice Deployment and<br/>Quarterly Health Checks</span><div class="bg"></div></li>
	<li id="menu-item-40021" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40021"><a href="https://www.sentinelone.com/global-services/support-services/">Support Services</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/support-services/"></a><a class="combined d-4" href="https://www.sentinelone.com/global-services/support-services/"><strong>Support Services</strong> </a><span class="subtitle">Tiered Support Options<br/>for Every Organisation</span><div class="bg"></div></li>
	<li id="menu-item-40022" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40022"><a href="https://www.sentinelone.com/global-services/technical-account-management/">Technical Account Management</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/technical-account-management/"></a><a class="combined d-5" href="https://www.sentinelone.com/global-services/technical-account-management/"><strong>Technical Account Management</strong> </a><span class="subtitle">Customer Success with<br/>Personalised Service </span><div class="bg"></div></li>
	<li id="menu-item-40025" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40025"><a href="https://www.sentinelone.com/global-services/university/">SentinelOne University</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/university/"></a><a class="combined d-6" href="https://www.sentinelone.com/global-services/university/"><strong>SentinelOne University</strong> </a><span class="subtitle">Live and On-Demand Training</span><div class="bg"></div></li>
</ul>
</div></div></div></div></li>
<li id="menu-item-24944" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-24944"><a href="https://www.sentinelone.com/partners/partner-overview/">Partners</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2021/01/partnertext.svg" /><div class="blurb">See how SentinelOne works with 
trusted names worldwide to enhance 
programs, process, and technology.</div><a href="https://www.sentinelone.com/partners/partner-overview/">Program Overview</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp"><div class="subtitle">OUR NETWORK</div>
<ul class="sub-menu">
	<li id="menu-item-38777" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38777"><a href="https://www.sentinelone.com/partners/singularity-marketplace/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/partners/singularity-marketplace/"></a><a class="combined d-0" href="https://www.sentinelone.com/partners/singularity-marketplace/"><strong>Singularity</strong> Marketplace</a><span class="subtitle">Extend the Power of S1 Technology</span><div class="bg"></div></li>
	<li id="menu-item-38780" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38780"><a href="https://www.sentinelone.com/partners/technology-alliance/">Technology</a><a class="link-wrap" href="https://www.sentinelone.com/partners/technology-alliance/"></a><a class="combined d-1" href="https://www.sentinelone.com/partners/technology-alliance/"><strong>Technology</strong> Alliances </a><span class="subtitle">See Integrated, Enterprise-Scale Solutions</span><div class="bg"></div></li>
	<li id="menu-item-24945" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24945"><a href="https://partners.sentinelone.com/English/">Channel</a><a class="link-wrap" href="https://partners.sentinelone.com/English/"></a><a class="combined d-2" href="https://partners.sentinelone.com/English/"><strong>Channel</strong> Partners</a><span class="subtitle">Deliver the Right Solutions. Together</span><div class="bg"></div></li>
	<li id="menu-item-36742" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36742"><a href="https://www.sentinelone.com/partners/cyber-risk-partners/">Cyber Risk</a><a class="link-wrap" href="https://www.sentinelone.com/partners/cyber-risk-partners/"></a><a class="combined d-3" href="https://www.sentinelone.com/partners/cyber-risk-partners/"><strong>Cyber Risk</strong> Partners</a><span class="subtitle">Enlist Pro Response and Advisory Terms</span><div class="bg"></div></li>
	<li id="menu-item-41076" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41076"><a href="https://www.sentinelone.com/sentinelone-for-aws/">SentinelOne</a><a class="link-wrap" href="https://www.sentinelone.com/sentinelone-for-aws/"></a><a class="combined d-4" href="https://www.sentinelone.com/sentinelone-for-aws/"><strong>SentinelOne</strong> for AWS</a><span class="subtitle">SentinelOne hosted in AWS regions around the world.</span><div class="bg"></div></li>
</ul>
</div></div></div></div></li>
<li id="menu-item-24695" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-24695"><a href="/resources/">Resources</a>
<ul class="sub-menu">
	<li id="menu-item-24696" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24696"><a href="/resources/category/ebooks/">eBooks</a></li>
	<li id="menu-item-24697" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24697"><a href="/resources/category/white-paper/">White Papers</a></li>
	<li id="menu-item-24698" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24698"><a href="/resources/category/datasheet/">Datasheets</a></li>
	<li id="menu-item-24699" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24699"><a href="/resources/category/case-study/">Case Studies</a></li>
	<li id="menu-item-24700" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24700"><a href="/resources/category/webinars/">Webinars</a></li>
	<li id="menu-item-24701" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24701"><a href="/resources/category/video/">Videos</a></li>
	<li id="menu-item-24702" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24702"><a href="/resources/category/report/">Reports</a></li>
	<li id="menu-item-27940" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-27940"><a href="/events/">Events</a></li>
</ul>
</li>
<li id="menu-item-24852" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-24852"><a href="https://www.sentinelone.com/company/">Company</a>
<ul class="sub-menu">
	<li id="menu-item-24704" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-24704"><a href="https://www.sentinelone.com/blog/">Blog</a></li>
	<li id="menu-item-26985" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26985"><a href="https://labs.sentinelone.com">Labs</a></li>
	<li id="menu-item-39169" class="menu-item menu-item-type-post_type menu-item-object-landing_page menu-item-39169"><a href="https://www.sentinelone.com/lp/hackchat/">Hack Chat</a></li>
	<li id="menu-item-24705" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24705"><a href="/press/">Press</a></li>
	<li id="menu-item-30279" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-30279"><a href="/news/">News</a></li>
	<li id="menu-item-32436" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32436"><a href="https://www.sentinelone.com/faq/">FAQ</a></li>
	<li id="menu-item-24853" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24853"><a href="https://www.sentinelone.com/company/">About Us</a></li>
	<li id="menu-item-24708" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24708"><a href="/careers/">Careers</a></li>
</ul>
</li>
</ul></div>											</div>
				</div>
				<div class="nav-bg"></div>
								<div class="nav-drawer">
					<div class="upper">
						<div class="toolbar">
							<a class="back"><img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/navigation-arrow-left.svg" /><span>Back</span></a>
							<a class="close"><img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/navigation-close.svg" /></a>
						</div>
						<div class="menu-wrapper">
							<div class="menu-carbine-primary-container"><ul id="menu-carbine-primary-1" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-34979"><a href="https://www.sentinelone.com/platform/">Platform</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2017/06/singularity-white.svg" /><div class="blurb">The SentinelOne platform delivers the defenses you need to prevent, detect, and undo—known and unknown—threats.</div><a href="https://www.sentinelone.com/platform/">Platform Overview</a><a href="https://www.sentinelone.com/platform-packages/" target="">Platform Packages</a><a href="https://www.sentinelone.com/vs/crowdstrike/" target="">SentinelOne vs CrowdStrike</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp6"><div class="subtitle">Platform Products</div>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35909"><a href="https://www.sentinelone.com/platform/singularity-complete/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-complete/"></a><a class="combined d-0" href="https://www.sentinelone.com/platform/singularity-complete/"><strong>Singularity</strong> Complete</a><span class="subtitle">The Future's Enterprise Security Platform</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35912"><a href="https://www.sentinelone.com/platform/singularity-control/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-control/"></a><a class="combined d-1" href="https://www.sentinelone.com/platform/singularity-control/"><strong>Singularity</strong> Control</a><span class="subtitle">Security with Suite Features</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35913"><a href="https://www.sentinelone.com/platform/singularity-core/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-core/"></a><a class="combined d-2" href="https://www.sentinelone.com/platform/singularity-core/"><strong>Singularity</strong> Core</a><span class="subtitle">Cloud-Native NGAV</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41497"><a href="/singularity-xdr/">Singularity</a><a class="link-wrap" href="/singularity-xdr/"></a><a class="combined d-3" href="/singularity-xdr/"><strong>Singularity</strong> XDR</a><span class="subtitle">Extended Detection & Response</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35911"><a href="https://www.sentinelone.com/platform/singularity-ranger-iot/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-ranger-iot/"></a><a class="combined d-4" href="https://www.sentinelone.com/platform/singularity-ranger-iot/"><strong>Singularity</strong> Ranger IoT</a><span class="subtitle">Network Visibility & Control</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35910"><a href="https://www.sentinelone.com/platform/singularity-cloud/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-cloud/"></a><a class="combined d-5" href="https://www.sentinelone.com/platform/singularity-cloud/"><strong>Singularity</strong> Cloud</a><span class="subtitle">Container & Cloud Workload Security</span><div class="bg"></div></li>
</ul></div><div class="menu-wrap secondary"><div class="subtitle">Platform Verticals</div><ul class="sub-menu">	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37383"><a href="https://www.sentinelone.com/platform/energy/">Energy</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37384"><a href="https://www.sentinelone.com/platform/finance/">Finance</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37387"><a href="https://www.sentinelone.com/platform/healthcare/">Healthcare</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37385"><a href="https://www.sentinelone.com/platform/highereducation/">Higher Education</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37386"><a href="https://www.sentinelone.com/platform/retail/">Retail</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41084"><a href="https://www.sentinelone.com/platform/manufacturing/">Manufacturing</a></li>
</ul>
</div></div></div></div></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-30696"><a href="https://www.sentinelone.com/customer-page/">Our Customers</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-40015"><a href="/global-services/services-overview/">Services</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2021/02/global_services-1.svg" /><div class="blurb">Augment leading technology with trusted expertise, and get set up for success with hands-on support and training.</div><a href="/global-services/services-overview/">Services Overview</a><a href="https://www.sentinelone.com/global-services/get-support-now/" target="">Get Help Now</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp"><div class="subtitle">Global Support & Services</div>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40017"><a href="https://www.sentinelone.com/global-services/vigilance-respond-pro/">Vigilance Respond Pro MDR + DFIR</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/vigilance-respond-pro/"></a><a class="combined d-0" href="https://www.sentinelone.com/global-services/vigilance-respond-pro/"><strong>Vigilance Respond Pro MDR + DFIR</strong> </a><span class="subtitle">24x7 MDR with Full-Scale<br/>Investigation and Response</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40018"><a href="https://www.sentinelone.com/global-services/vigilance-respond">Vigilance Respond MDR</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/vigilance-respond"></a><a class="combined d-1" href="https://www.sentinelone.com/global-services/vigilance-respond"><strong>Vigilance Respond MDR</strong> </a><span class="subtitle">Dedicated SOC Expertise and Analysis</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40019"><a href="https://www.sentinelone.com/global-services/watchtower/">WatchTower</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/watchtower/"></a><a class="combined d-2" href="https://www.sentinelone.com/global-services/watchtower/"><strong>WatchTower</strong> </a><span class="subtitle">Intelligence-Driven Threat Hunting</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40020"><a href="https://www.sentinelone.com/global-services/readiness/">Readiness</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/readiness/"></a><a class="combined d-3" href="https://www.sentinelone.com/global-services/readiness/"><strong>Readiness</strong> </a><span class="subtitle">Best-Practice Deployment and<br/>Quarterly Health Checks</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40021"><a href="https://www.sentinelone.com/global-services/support-services/">Support Services</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/support-services/"></a><a class="combined d-4" href="https://www.sentinelone.com/global-services/support-services/"><strong>Support Services</strong> </a><span class="subtitle">Tiered Support Options<br/>for Every Organisation</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40022"><a href="https://www.sentinelone.com/global-services/technical-account-management/">Technical Account Management</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/technical-account-management/"></a><a class="combined d-5" href="https://www.sentinelone.com/global-services/technical-account-management/"><strong>Technical Account Management</strong> </a><span class="subtitle">Customer Success with<br/>Personalised Service </span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40025"><a href="https://www.sentinelone.com/global-services/university/">SentinelOne University</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/university/"></a><a class="combined d-6" href="https://www.sentinelone.com/global-services/university/"><strong>SentinelOne University</strong> </a><span class="subtitle">Live and On-Demand Training</span><div class="bg"></div></li>
</ul>
</div></div></div></div></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-24944"><a href="https://www.sentinelone.com/partners/partner-overview/">Partners</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2021/01/partnertext.svg" /><div class="blurb">See how SentinelOne works with 
trusted names worldwide to enhance 
programs, process, and technology.</div><a href="https://www.sentinelone.com/partners/partner-overview/">Program Overview</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp"><div class="subtitle">OUR NETWORK</div>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38777"><a href="https://www.sentinelone.com/partners/singularity-marketplace/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/partners/singularity-marketplace/"></a><a class="combined d-0" href="https://www.sentinelone.com/partners/singularity-marketplace/"><strong>Singularity</strong> Marketplace</a><span class="subtitle">Extend the Power of S1 Technology</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38780"><a href="https://www.sentinelone.com/partners/technology-alliance/">Technology</a><a class="link-wrap" href="https://www.sentinelone.com/partners/technology-alliance/"></a><a class="combined d-1" href="https://www.sentinelone.com/partners/technology-alliance/"><strong>Technology</strong> Alliances </a><span class="subtitle">See Integrated, Enterprise-Scale Solutions</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24945"><a href="https://partners.sentinelone.com/English/">Channel</a><a class="link-wrap" href="https://partners.sentinelone.com/English/"></a><a class="combined d-2" href="https://partners.sentinelone.com/English/"><strong>Channel</strong> Partners</a><span class="subtitle">Deliver the Right Solutions. Together</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36742"><a href="https://www.sentinelone.com/partners/cyber-risk-partners/">Cyber Risk</a><a class="link-wrap" href="https://www.sentinelone.com/partners/cyber-risk-partners/"></a><a class="combined d-3" href="https://www.sentinelone.com/partners/cyber-risk-partners/"><strong>Cyber Risk</strong> Partners</a><span class="subtitle">Enlist Pro Response and Advisory Terms</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41076"><a href="https://www.sentinelone.com/sentinelone-for-aws/">SentinelOne</a><a class="link-wrap" href="https://www.sentinelone.com/sentinelone-for-aws/"></a><a class="combined d-4" href="https://www.sentinelone.com/sentinelone-for-aws/"><strong>SentinelOne</strong> for AWS</a><span class="subtitle">SentinelOne hosted in AWS regions around the world.</span><div class="bg"></div></li>
</ul>
</div></div></div></div></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-24695"><a href="/resources/">Resources</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24696"><a href="/resources/category/ebooks/">eBooks</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24697"><a href="/resources/category/white-paper/">White Papers</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24698"><a href="/resources/category/datasheet/">Datasheets</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24699"><a href="/resources/category/case-study/">Case Studies</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24700"><a href="/resources/category/webinars/">Webinars</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24701"><a href="/resources/category/video/">Videos</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24702"><a href="/resources/category/report/">Reports</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-27940"><a href="/events/">Events</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-24852"><a href="https://www.sentinelone.com/company/">Company</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-24704"><a href="https://www.sentinelone.com/blog/">Blog</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26985"><a href="https://labs.sentinelone.com">Labs</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-landing_page menu-item-39169"><a href="https://www.sentinelone.com/lp/hackchat/">Hack Chat</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24705"><a href="/press/">Press</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-30279"><a href="/news/">News</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32436"><a href="https://www.sentinelone.com/faq/">FAQ</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24853"><a href="https://www.sentinelone.com/company/">About Us</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24708"><a href="/careers/">Careers</a></li>
</ul>
</li>
</ul></div>						</div>
					</div>
					<div class="lower">
						<div class="secondary-links">
							<div class="menu-top-bar-container"><ul id="menu-top-bar-1" class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16921"><a href="#s1phone">1-855-868-3733</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25727"><a href="/contact/">Contact</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-16923"><a href="https://www.sentinelone.com/blog/">Blog</a></li>
</ul></div>							<span class="breach">Experiencing a Breach?</span>
						</div>
						<a class="demo" href="/request-demo/">Get a Demo</a>
					</div>
				</div>
							</div>
		</div>
	</header>
		
	<div class="main  ">
	

<div class="section-wrap header block-0">
	<section class="blog_head" style="">
		<div class="underlay"></div>
		<div class="container">
			<div class="inner">
				<div class="graphic wow fadeIn" data-wow-delay="1s">
					<img src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-2.jpg?lossy=0&strip=1&webp=0" />
				</div>
				<div class="context wow fadeInRight">
					<div class="flourish"></div>
					<div class="heading">
						<h1 class="entry-title">How Offensive Actors Use AppleScript For Attacking macOS</h1>					</div>
					<div class="meta">
						<div class="post-meta">
													<a href="https://www.sentinelone.com/blog/2020/03/" rel="bookmark">
								<time datetime="2020-03-16">March 16, 2020</time>
							</a>
																			<div class="author">
								<span>by </span>
								<a href="https://www.sentinelone.com/blog/author/macoswriter/">
									Phil Stokes								</a>
							</div>
												</div>
						<div class="meta-share">
	<div><a class="socicon socicon-facebook" href="http://www.facebook.com/sharer.php?u=https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/" target="_blank"></a></div><div><a class="socicon socicon-twitter" href="https://twitter.com/intent/tweet?url=https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/&#038;text=How%20Offensive%20Actors%20Use%20AppleScript%20For%20Attacking%20macOS" target="_blank"></a></div><div><a class="socicon socicon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&#038;url=https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/" target="_blank"></a></div><div><a class="socicon socicon-reddit" href="http://reddit.com/submit?url=https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/" target="_blank"></div><div><a class="socicon socicon-mail" href="mailto:?subject=How%20Offensive%20Actors%20Use%20AppleScript%20For%20Attacking%20macOS&#038;body=https%3A%2F%2Fwww.sentinelone.com%2Fblog%2Fhow-offensive-actors-use-applescript-for-attacking-macos%2F"></a></div><div id="share-item-sms"><a class="socicon socicon-sharethis" href="sms:?body=How%20Offensive%20Actors%20Use%20AppleScript%20For%20Attacking%20macOS%20-%20https%3A%2F%2Fwww.sentinelone.com%2Fblog%2Fhow-offensive-actors-use-applescript-for-attacking-macos%2F"></a></div></div>
<script>if ( typeof window.orientation === 'undefined' ) { document.getElementById( 'share-item-sms' ).style.display = "none"; }</script>					</div>
				</div>
			</div>
		</div>
	</section>
</div>

<div class="section-wrap block-1">
	<section class="archive-single-post" style="">
		<div class="container">
			<div class="inner">
				<div class="primary-wrap">
					<div id="primary" class="content-area">
						<div class="primary-inner">
							<article id="post-29053" class="post-29053 post type-post status-publish format-standard has-post-thumbnail hentry category-security tag-applescript tag-macos-security-sentinelone tag-malware tag-red-team tag-researcher">
								<div class="entry-content">
									
					<table id="amazon-polly-audio-table">
						<tr>
						<td id="amazon-polly-audio-tab">
							<div id="amazon-ai-player-label"></div>
							<div id="amazon-ai-player-container">
			<audio class="amazon-ai-player" id="amazon-ai-player" preload="none" controls   controlsList="nodownload" >
				<source type="audio/mpeg" src="https://s3.us-east-1.amazonaws.com/audio-for-wordpress-45086892059684b045a4189d91d52199e7d604f2/2020/03/amazon_polly_29053.mp3?version=1610482543">
			</audio>
		</div>
							<div id="amazon-polly-subscribe-tab"></div>
							<div id="amazon-polly-by-tab"></div>
						</td>
						</tr>
					</table><p><span style="font-weight: 400;">When we think about security on macOS and the tools used by offensive actors, whether those are real in the wild attacks or <a href="https://www.sentinelone.com/blog/macos-red-team-spoofing-privileged-helpers-and-others-to-gain-root/" target="_blank" rel="noopener noreferrer">red team exercises</a>, we tend to think of things like python scripts, <a href="https://www.sentinelone.com/blog/scripting-macs-with-malice-how-shlayer-and-other-malware-installers-infect-macos/" target="_blank" rel="noopener noreferrer">shell scripts</a>, malicious documents, <a href="https://www.sentinelone.com/blog/adware-apple-google-extensions-put-users-at-risk/" target="_blank" rel="noopener noreferrer">shady extensions</a> and of course, the <a href="https://www.sentinelone.com/blog/weakest-link-admins-get-phished-macos-osx-dummy-malware/" target="_blank" rel="noopener noreferrer">fake</a>, <a href="https://www.sentinelone.com/blog/macos-malware-2019-first-six-months/" target="_blank" rel="noopener noreferrer">doctored</a> or <a href="https://www.sentinelone.com/blog/mac-malware-osx-dok-is-back-actively-infecting-victims/" target="_blank" rel="noopener noreferrer">trojan</a> application bundle. There is much less attention in the security field on AppleScript &#8211; a built-in macOS technology &#8211; despite the fact it&#8217;s been around for as long as Python and predates macOS 10 itself by 8 or 9 years.</span></p>
<p><span style="font-weight: 400;">As I&#8217;ll show in this post, AppleScript is widely used by offensive actors. This includes its use in adware, its use for tasks such as <a href="https://attack.mitre.org/software/S0281/" target="_blank" rel="noopener noreferrer">persistence</a>, <a href="https://www.virustotal.com/gui/file/ab4596d3f8347d447051eb4e4075e04c37ce161514b4ce3fae91010aac7ae97f/content/strings" target="_blank" rel="noopener noreferrer">anti-analysis</a>, browser hijacking, <a href="https://www.sentinelone.com/blog/macos-red-team-spoofing-privileged-helpers-and-others-to-gain-root/" target="_blank" rel="noopener noreferrer">spoofing</a> and more. Worryingly, given the lack of attention paid to AppleScript in the research community, that is all without even leveraging some of AppleScript&#8217;s most powerful or unique features, some of which we&#8217;ll cover below (others I&#8217;ve written about before <a href="https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/" target="_blank" rel="noopener noreferrer">here</a>).</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29086" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-1.jpg?lossy=0&strip=1&webp=0" alt="" width="1200" height="628" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-1.jpg?lossy=0&amp;strip=1&amp;webp=0 1200w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-1-300x157.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-1-1024x536.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/How-Offensive-Actors-Use-AppleScript-For-Attacking-macOS-1-768x402.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1200px) 100vw, 1200px" /></p>
<h2>Why Have the Good Guys Ignored AppleScript?</h2>
<p><span style="font-weight: 400;">Unlike <a href="https://www.sentinelone.com/blog/scripting-macs-with-malice-how-shlayer-and-other-malware-installers-infect-macos/" target="_blank" rel="noopener noreferrer">Bash and other shell</a> languages, and unlike Python, a cross-platform, beginner-friendly scripting language that has achieved widespread adoption and praise, AppleScript is a language peculiar to macOS; not only can you NOT use it on other Desktop operating systems like Windows and Linux, you can&#8217;t even use it on Apple&#8217;s other operating systems like iOS and iPadOS.</span></p>
<p><span style="font-weight: 400;">As a language, AppleScript has a reputation for being quirky, slow and difficult to develop even simple scripts with. It&#8217;s quirky because it attempts to use &#8220;natural language&#8221; but in a grammar that is entirely artificial, often inconsistent and frustratingly unintuitive. It&#8217;s also incredibly verbose. Compare the code for the simple task of counting the number of items in <code>/usr/bin</code> directory. As ever, a shell script will always be the most concise:</span></p>
<pre>ls -l /usr/bin | wc -l</pre>
<p><span style="font-weight: 400;">Python is a little more verbose, but still fairly clean and familiar:</span></p>
<pre>#!/usr/bin/python
import os
path, dirs, files = next(os.walk("/usr/bin"))
print len(files)
</pre>
<p><span style="font-weight: 400;">The AppleScript version, however, is something of an entirely different nature.</span></p>
<pre>tell application "System Events"
	set theFiles to name of every file of folder "bin" of folder "usr" of startup disk
	count of theFiles
end tell
</pre>
<p><span style="font-weight: 400;">AppleScript is also slow in execution because, among other things, the underlying technology involves constructing and sending Apple Events through an archaic interface called the Apple Event Manager that was written for Apple&#8217;s System 7 operating system (released in 1991) and not optimized for performance even back then.</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29056" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-17.52.35.jpg?lossy=0&strip=1&webp=0" alt="" width="1499" height="617" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-17.52.35.jpg?lossy=0&amp;strip=1&amp;webp=0 1499w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-17.52.35-300x123.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-17.52.35-1024x421.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-17.52.35-768x316.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1499px) 100vw, 1499px" /><br />
<span style="font-weight: 400; font-size: 0.8em;">Source: AppleScript Overview,  © 2002, 2007 Apple Inc.</span></p>
<p><span style="font-weight: 400;">And it&#8217;s historically been difficult to develop scripts with AppleScript because most people who come to it will attempt to use the free, built-in but notoriously spartan (Apple)Script Editor.app, which lacks almost every and any feature developers normally expect and need. There&#8217;s no debugger, there&#8217;s no variable introspection, there&#8217;s no code snippets or effective code completion, to name just a few missing features.</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29057" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.03.43.jpg?lossy=0&strip=1&webp=0" alt="" width="1226" height="806" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.03.43.jpg?lossy=0&amp;strip=1&amp;webp=0 1226w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.03.43-300x197.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.03.43-1024x673.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.03.43-768x505.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1226px) 100vw, 1226px" /></p>
<p><span style="font-weight: 400;">Until recently, the only 3rd party alternative to Script Editor was priced at $200 and had a time-limited, 20-day demo period.</span></p>
<p><span style="font-weight: 400;">In short, the investment in time, effort and money required to produce something that still, after all that, can only be used on the macOS Desktop, effectively puts AppleScript at the bottom of the list for most people when it comes to choosing a useful or productive programming language. As a result, despite being with us for nearly 30 years, AppleScript is barely used by the majority of Mac admins, Mac developers or Mac end users. Indeed, AppleScript may have a good claim to being the Most Unloved and Unlovable Programming Language Ever.</span></p>
<h2>So Why Do the Bad Guys Love Using AppleScript?</h2>
<p><span style="font-weight: 400;">AppleScript was designed for automation and interapplication communication: the goal being to allow ordinary users to chain together repetitive tasks and execute them without further user interaction. For example, you can have Mail.app automatically trigger a script when it receives an email from a certain sender, or with a particular keyword in the subject line or content, extract whatever details you want from the email, and then populate a database in Excel or Numbers with the desired information, formatted and sorted on-the-fly as the data comes in. There&#8217;s no need for the user to be involved in any of this once the script is set up.</span></p>
<p><span style="font-weight: 400;">And as it turns out, automating interapplication communication and sidestepping user interaction is a godsend for malware authors. What could be more useful than bending popular applications like email clients, web browsers and the Microsoft Office suite to your will without needing to involve the user (<em>aka</em> in this scenario, <strong>the victim</strong>)?</span></p>
<p><span style="font-weight: 400;">And so, despite its general lack of appeal in almost all possible audiences for a scripting or programming language, there is one audience that does use AppleScript widely, if not particularly artfully or cleverly, and that is <a href="https://www.sentinelone.com/blog/threat-actor-basics-understanding-5-main-threat-types/" target="_blank" rel="noopener noreferrer">threat actors</a>. Let&#8217;s look at some examples.</span></p>

<div class="post-cta wow fadeInLeft image">
		<div class="inner" style="background-image: url('https://899029.smushcdn.com/2131410/wp-content/uploads/2020/02/Waves_BG-copy.jpg?lossy=0&strip=1&webp=0');">
			<div class="context">
				<div class="context-inner">
					<div class="title">How Shlayer and Other Malware Trojans Infect macOS</div>
					<div class="blurb">Learn from Phil Stokes how to tell real Adobe Flash Players from fake ones</div>
					<div class="cta boxed_right_arrow wow fadeInRight">
						<a href="https://assets.sentinelone.com/macos-reverse/how-shlayer-and-othe-1" 
						data-lookbook-overlay-href="https://assets.sentinelone.com/macos-reverse/how-shlayer-and-othe-1"
						
						>
							<span>Watch Now</span> 
							<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/cta_left_left_purple.svg" />
						</a>
					</div>
				</div>
			</div>
			<div class="graphic" style="background-image: url('https://899029.smushcdn.com/2131410/wp-content/uploads/2017/06/Phil-macos.jpg?lossy=0&strip=1&webp=0');"></div>
		</div>
	</div>
<h2>Recent Examples of AppleScript in macOS malware</h2>
<p><span style="font-weight: 400;">A recent browser hijacker targeting Safari installs a hidden LaunchAgent that, via a shell script, loads, compiles and executes AppleScript.</span></p>
<p><span style="font-weight: 400;">It starts with a shell installer script packaged inside a DMG that&#8217;s supposed to contain an application called &#8216;PDFConverter4u&#8217;. But in a hidden <code>.assets</code> folder on the disk image is a first stage shell script:</span></p>
<p><code>5f198e82c0cf9a9f7d7a8d01273a6ad75a17a95960d8996dcdd028922b3d97bc</code></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29068" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.37.56.jpg?lossy=0&strip=1&webp=0" alt="" width="1062" height="185" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.37.56.jpg?lossy=0&amp;strip=1&amp;webp=0 1062w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.37.56-300x52.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.37.56-1024x178.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.37.56-768x134.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1062px) 100vw, 1062px" /></p>
<p><span style="font-weight: 400;">This unpacks and executes a second stage shell script:</span></p>
<p><code>55529224e9f70f5cab007e2ca98f6aec5cf31eb923fdfc09f60c01cc45c80666</code></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29069" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.38.15.jpg?lossy=0&strip=1&webp=0" alt="" width="1992" height="384" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.38.15.jpg?lossy=0&amp;strip=1&amp;webp=0 1992w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.38.15-300x58.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.38.15-1024x197.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.38.15-768x148.jpg?lossy=0&amp;strip=1&amp;webp=0 768w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-21.38.15-1536x296.jpg?lossy=0&amp;strip=1&amp;webp=0 1536w" sizes="(max-width: 1992px) 100vw, 1992px" /></p>
<p><span style="font-weight: 400;">Which eventually produces the hidden launch agent that executes another shell script containing the following AppleScript code, launched via <code>osascript</code>.</span></p>
<p><code>cdaa2121d79031cf39159198dfe64d3695a9c99ff7c3478a0b8953ade9052ecc</code></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29058" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.20.06.jpg?lossy=0&strip=1&webp=0" alt="" width="1707" height="946" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.20.06.jpg?lossy=0&amp;strip=1&amp;webp=0 1707w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.20.06-300x166.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.20.06-1024x567.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.20.06-768x426.jpg?lossy=0&amp;strip=1&amp;webp=0 768w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.20.06-1536x851.jpg?lossy=0&amp;strip=1&amp;webp=0 1536w" sizes="(max-width: 1707px) 100vw, 1707px" /></p>
<p><span style="font-weight: 400;">The purpose of the AppleScript is to replace the user&#8217;s search query on popular search engines google, bing and yahoo, with one provided by the attacker&#8217;s shell script. It&#8217;s a quick and easy way for bad actors to make money out of clicks which negatively impacts the victim&#8217;s productivity.</span></p>
<p><span style="font-weight: 400;">While this particular sample comes packed in a separate file, many others write their AppleScript directly into a MachO binary, either in plain text strings or in obfuscated <a href="https://www.sentinelone.com/blog/guide-encode-decoded-base64/" target="_blank" rel="noopener noreferrer">base64</a> or similar encoding.</span></p>
<p><span style="font-weight: 400;">The following strings extracted from a Bundlore installer show that the code tries to force enable JavaScript execution in Google Chrome, then uses AppleScript to execute it in the active tab of the browser&#8217;s front window.</span></p>
<p><span style="font-weight: 400;">Strings from <code>41e0d31d52cb93f6a5020a278e8f360a6e134e6cc7092b4a5e575ac8b96a8d74</code></span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29059" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.47.39.jpg?lossy=0&strip=1&webp=0" alt="" width="1658" height="610" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.47.39.jpg?lossy=0&amp;strip=1&amp;webp=0 1658w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.47.39-300x110.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.47.39-1024x377.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.47.39-768x283.jpg?lossy=0&amp;strip=1&amp;webp=0 768w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-18.47.39-1536x565.jpg?lossy=0&amp;strip=1&amp;webp=0 1536w" sizes="(max-width: 1658px) 100vw, 1658px" /></p>
<p><span style="font-weight: 400;">The next sample is a variant of a Pirrit malware.</span></p>
<p><code>21331ccee215801ca682f1764f3e37ff806e7510ded5576c0fb4d514b4cf2b7c</code></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29061" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.08.47.jpg?lossy=0&strip=1&webp=0" alt="" width="2216" height="554" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.08.47.jpg?lossy=0&amp;strip=1&amp;webp=0 2216w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.08.47-300x75.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.08.47-1024x256.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.08.47-768x192.jpg?lossy=0&amp;strip=1&amp;webp=0 768w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.08.47-1536x384.jpg?lossy=0&amp;strip=1&amp;webp=0 1536w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.08.47-2048x512.jpg?lossy=0&amp;strip=1&amp;webp=0 2048w" sizes="(max-width: 2216px) 100vw, 2216px" /></p>
<p><span style="font-weight: 400;">The authors use both plain text AppleScript and base64 encoded AppleScript, targeting Safari, Chrome and Firefox browsers.</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29063" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.27.03.jpg?lossy=0&strip=1&webp=0" alt="" width="1598" height="848" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.27.03.jpg?lossy=0&amp;strip=1&amp;webp=0 1598w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.27.03-300x159.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.27.03-1024x543.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.27.03-768x408.jpg?lossy=0&amp;strip=1&amp;webp=0 768w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.27.03-1536x815.jpg?lossy=0&amp;strip=1&amp;webp=0 1536w" sizes="(max-width: 1598px) 100vw, 1598px" /></p>
<p><span style="font-weight: 400;">Here&#8217;s some of the decoded base64 targeting Firefox and attempting to perform automated keystrokes to copy the current URL to the user&#8217;s clipboard before replacing the URL to that of the attacker&#8217;s choice:</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29062" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.25.32.jpg?lossy=0&strip=1&webp=0" alt="" width="1001" height="665" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.25.32.jpg?lossy=0&amp;strip=1&amp;webp=0 1001w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.25.32-300x199.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.25.32-768x510.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1001px) 100vw, 1001px" /></p>
<h2>Using AppleScript Without Apple Events</h2>
<p><span style="font-weight: 400;">Speaking of base64, the next example illustrates something that many ordinary users and developers have overlooked about AppleScript, but which offensive actors have not: you can use AppleScript to execute any other kind of script, including python scripts like this one which drops the Empire exploit kit.</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29064" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.32.35.jpg?lossy=0&strip=1&webp=0" alt="" width="1046" height="436" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.32.35.jpg?lossy=0&amp;strip=1&amp;webp=0 1046w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.32.35-300x125.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.32.35-1024x427.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.32.35-768x320.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1046px) 100vw, 1046px" /></p>
<p><span style="font-weight: 400;">And what&#8217;s true of AppleScript and Python, is true of AppleScript and Perl, AppleScript and Bash and indeed AppleScript and absolutely any command line tool at all: you can call them all and bring their functionality into your AppleScript and combine that with other utilities.</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29070" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-02-17-at-18.02.26.jpg?lossy=0&strip=1&webp=0" alt="" width="2098" height="826" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-02-17-at-18.02.26.jpg?lossy=0&amp;strip=1&amp;webp=0 2098w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-02-17-at-18.02.26-300x118.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-02-17-at-18.02.26-1024x403.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-02-17-at-18.02.26-768x302.jpg?lossy=0&amp;strip=1&amp;webp=0 768w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-02-17-at-18.02.26-1536x605.jpg?lossy=0&amp;strip=1&amp;webp=0 1536w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-02-17-at-18.02.26-2048x806.jpg?lossy=0&amp;strip=1&amp;webp=0 2048w" sizes="(max-width: 2098px) 100vw, 2098px" /></p>
<p><span style="font-weight: 400;">The examples above all use what we might call &#8216;vanilla AppleScript&#8217;. That is, the native AppleScript language that&#8217;s been around since the early days of the platform. But starting in Yosemite, 10.10 and continuing up to and including the most recent version of macOS, AppleScript has been given increasing power through access to Cocoa frameworks, and this opens up the possibility of creating full-blown, powerful programs and applications with nothing other than AppleScript itself. Objective C executed through AppleScript is, speed-wise, more or less on a par with Objective C executed in a <a href="https://www.sentinelone.com/blog/how-to-reverse-macos-malware-part-two/" target="_blank" rel="noopener noreferrer">MachO</a> binary.</span></p>
<p><span style="font-weight: 400;">And interestingly, although we haven&#8217;t seen threat actors making use of these powerful capabilities so far, there&#8217;s at least two reasons why we may well do so in the future: first to avoid detection, and second, because of the easy availability of a good development environment.</span></p>

<div class="post-cta wow fadeInLeft image">
		<div class="inner" style="background-image: url('https://899029.smushcdn.com/2131410/wp-content/uploads/2020/02/Waves_BG-copy.jpg?lossy=0&strip=1&webp=0');">
			<div class="context">
				<div class="context-inner">
					<div class="title">How Shlayer and Other Malware Trojans Infect macOS</div>
					<div class="blurb">Learn from Phil Stokes how to tell real Adobe Flash Players from fake ones</div>
					<div class="cta boxed_right_arrow wow fadeInRight">
						<a href="https://assets.sentinelone.com/macos-reverse/how-shlayer-and-othe-1" 
						data-lookbook-overlay-href="https://assets.sentinelone.com/macos-reverse/how-shlayer-and-othe-1"
						
						>
							<span>Watch Now</span> 
							<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/cta_left_left_purple.svg" />
						</a>
					</div>
				</div>
			</div>
			<div class="graphic" style="background-image: url('https://899029.smushcdn.com/2131410/wp-content/uploads/2017/06/Phil-macos.jpg?lossy=0&strip=1&webp=0');"></div>
		</div>
	</div>
<h2>Using AppleScript to Avoid Detection</h2>
<p><span style="font-weight: 400;">Avoiding detection on execution is a primary objective for all malware (even <a href="https://www.sentinelone.com/blog/what-is-the-true-cost-of-a-ransomware-attack-6-factors-to-consider/" target="_blank" rel="noopener noreferrer">ransomware</a>, which doesn&#8217;t want to get noticed until after execution). AppleScript offers offensive actors a plethora of ways to execute. In addition to simply executing a <code>.scrpt</code> file, you can run AppleScripts from <a href="https://www.n00py.io/2016/10/using-email-for-persistence-on-os-x/" target="_blank" rel="noopener noreferrer">Mail rules</a>, from a shell script, in memory, from the command line, from within a MachO, in a plain text, uncompiled file, from an Automator workflow, from a <a href="https://posts.specterops.io/folder-actions-for-persistence-on-macos-8923f222343d" target="_blank" rel="noopener noreferrer">Folder Action</a>, a Finder Service or from a Calendar event.</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29065" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.59.03.jpg?lossy=0&strip=1&webp=0" alt="" width="1084" height="724" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.59.03.jpg?lossy=0&amp;strip=1&amp;webp=0 1084w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.59.03-300x200.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.59.03-1024x684.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-19.59.03-768x513.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1084px) 100vw, 1084px" /></p>
<p><span style="font-weight: 400;">Because of AppleScript&#8217;s ability to execute Objective C code without needing a compiled binary, this opens up a number of interesting attack possibilities. It also potentially opens up the ability to bypass detection tools based on Apple&#8217;s new kextless security framework introduced in <a href="https://www.sentinelone.com/blog/7-big-security-surprises-coming-to-macos-10-15-catalina/" target="_blank" rel="noopener noreferrer">macOS Catalina 10.15</a>.</span></p>
<p><span style="font-weight: 400;">In an excellent post by Cedric Owens called <a href="https://medium.com/red-teaming-with-a-blue-team-mentaility/taking-the-macos-endpoint-security-framework-for-a-quick-spin-802a462dba06" target="_blank" rel="noopener noreferrer">Taking the macOS Endpoint Security Framework For A Quick Spin</a>, Owens sets out to test what can and cannot be detected using three recently developed 3rd-party security tools that leverage the new <a href="https://developer.apple.com/documentation/endpointsecurity" target="_blank" rel="noopener noreferrer">Apple Endpoint Security framework</a>.</span></p>
<p><span style="font-weight: 400;">One of the interesting things that Owens found was that if you tried capturing the user&#8217;s clipboard via <code>osascript</code> and vanilla AppleScript, this activity would be easily picked up by all the tools he was testing.</span></p>
<pre>osascript -e 'the clipboard'</pre>
<p><span style="font-weight: 400;">However, when using the native Cocoa API, NSPasteboard, none of the Endpoint Security framework-powered tools Owens tested appeared to capture that activity. But now, of course, we can execute NSPasteboard natively from AppleScript, too!</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29066" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-20.16.41.jpg?lossy=0&strip=1&webp=0" alt="" width="1417" height="535" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-20.16.41.jpg?lossy=0&amp;strip=1&amp;webp=0 1417w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-20.16.41-300x113.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-20.16.41-1024x387.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-16-at-20.16.41-768x290.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1417px) 100vw, 1417px" /></p>
<p><span style="font-weight: 400;">Notice that our one line, simple but also detectable <code>osascript</code> has turned into about 14 lines of complex-looking AppleScript-ObjC. Few people, certainly not I, would want to try and construct that kind of code in Script Editor.</span></p>
<p><span style="font-weight: 400;">However, the problem of developing complex AppleScripts is now more or less a thing of the past. The <a href="https://latenightsw.com" target="_blank" rel="noopener noreferrer">3rd party alternative</a> mentioned earlier in this post now has an unlimited free trial version and retails at half of its old price; more importantly, it also allows you to drag and drop a great deal of boilerplate code like that used in the script above straight into your scripts. And it provides developer-friendly functionality like code completion and API lookups that really take the pain out of developing AppleScript code.</span></p>
<p><span style="font-weight: 400;">Let&#8217;s look at another example. A lot of offensive operations want to avoid targets that are running particular software. Little Snitch is a prime example, various VM software is another. We can easily get a list of running apps by name and test for those, again directly by calling into Cocoa APIs, this time via NSWorkspace.</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29071" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-03-at-21.39.22.jpg?lossy=0&strip=1&webp=0" alt="" width="1146" height="794" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-03-at-21.39.22.jpg?lossy=0&amp;strip=1&amp;webp=0 1146w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-03-at-21.39.22-300x208.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-03-at-21.39.22-1024x709.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-03-at-21.39.22-768x532.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1146px) 100vw, 1146px" /></p>
<p><span style="font-weight: 400;">If we just want a true/false test for the existence of specific apps, we can just put the app names in a list and return true on the first hit.</span></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-29072" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-03-at-21.50.54.jpg?lossy=0&strip=1&webp=0" alt="" width="869" height="512" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-03-at-21.50.54.jpg?lossy=0&amp;strip=1&amp;webp=0 869w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-03-at-21.50.54-300x177.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2020/03/Screenshot-2020-03-03-at-21.50.54-768x452.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 869px) 100vw, 869px" /></p>
<p><span style="font-weight: 400;">In other words, by leveraging AppleScript&#8217;s hook into Cocoa frameworks, we can execute native code without the overhead of building MachO binaries or MachO apps (although you can do both of those with AppleScript, too!). We can do this filelessly so that we don&#8217;t get caught by new &#8216;kextless&#8217; tools such as those tested by Owens, and we can execute this code in far more ways than any other kind of code available on macOS, whether that&#8217;s shell scripts, Python scripts or native macOS bundles. </span></p>
<h2>Conclusion</h2>
<p><span style="font-weight: 400;">The upshot here is that the main reasons why the good guys have typically eschewed AppleScript are in fact no longer relevant or true. Since we&#8217;ve already seen threat actors taking advantage of AppleScript despite those obstacles in the past, it&#8217;s only reasonable to assume that they may delve deeper into what this unique language has to offer in the future. Thanks to the native hook into Objective C and the powerful Cocoa frameworks, the variety of execution methods and now the availability of an excellent, free-to-use IDE, AppleScript has become a tool that is powerful, versatile and easy-to-develop with.</span></p>
<p><span style="font-weight: 400;">Attackers will always look to exploit the things defenders ignore, and to say that AppleScript has been ignored by the security community thus far is an understatement. I have <a href="https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/" target="_blank" rel="noopener noreferrer">elsewhere</a> described AppleScript as &#8220;the PowerShell of macOS&#8221;. Certainly, it&#8217;s time we stopped thinking of AppleScript as the Most Unlovable Programming Language Ever and recognize that it may actually be the One macOS Programming Language to Rule Them All.</span></p>
<hr />
<p><strong>Like this article? Follow us on <a href="https://www.linkedin.com/company/2886771/" target="_blank" rel="noopener noreferrer">LinkedIn</a>, <a href="https://twitter.com/SentinelOne" target="_blank" rel="noopener noreferrer">Twitter</a>, <a href="https://goo.gl/e5C9f4" target="_blank" rel="noopener noreferrer">YouTube</a> or <a href="https://www.facebook.com/SentinelOne" target="_blank" rel="noopener noreferrer">Facebook</a> to see the content we post.</strong></p>
<h3>Read more about Cyber Security</h3>
<ul>
<li><a href="https://www.sentinelone.com/blog/covid-19-outbreak-defending-against-the-psychology-of-fear-uncertainty-and-doubt/" target="_blank" rel="noopener noreferrer">COVID-19 Outbreak | Defending Against the Psychology of Fear, Uncertainty and Doubt</a></li>
<li><a href="https://www.sentinelone.com/blog/macos-malware-researchers-how-to-bypass-xprotect-on-catalina/" target="_blank" rel="noopener noreferrer">macOS Malware Researchers | How To Bypass XProtect on Catalina</a></li>
<li><a href="https://www.sentinelone.com/blog/covid-19-outbreak-employees-working-from-home-its-time-to-prepare/" target="_blank" rel="noopener noreferrer">COVID-19 Outbreak | Employees Working from Home? It&#8217;s Time to Prepare</a></li>
<li><a href="https://www.sentinelone.com/blog/mind-games-the-evolving-psychology-of-ransom-notes/" target="_blank" rel="noopener noreferrer">Mind Games | The Evolving Psychology of Ransom Notes</a></li>
<li><a href="https://www.sentinelone.com/blog/business-email-compromise-what-is-bec-and-how-can-you-defend-against-it/" target="_blank" rel="noopener noreferrer">Business Email Compromise | What is BEC (And How Can You Defend Against It)?</a></li>
<li><a href="https://www.sentinelone.com/blog/what-is-hacktivism-and-why-should-enterprise-care/" target="_blank" rel="noopener noreferrer">What is Hacktivism? And Why Should Enterprise Care?</a></li>
</ul>
								</div>
							</article>
						</div>
						
<div class="featured-items">
	<h2>What's New</h2>
	<div class="featured-items-after-post">
			<div class="featured-item">
			<div class="fi-content">
							<img src="https://899029.smushcdn.com/2131410/wp-content/uploads/2021/03/Blog_CTA_01.jpg?lossy=0&strip=1&webp=0" />
						
			
									<p class="featured-type">
						Hack Chat					</p>
							
							<p class="featured-title">
					Hack Chat: Conversations with cybersecurity experts				</p>
										<div class="featured-content">
					<p>Tune in every week and learn how Cybersecurity community leaders are transforming the industry.</p>
				</div>
						
			</div>
							<div class="cta boxed purple">
					<a href="https://www.sentinelone.com/lp/hackchat/" target="_blank">
						<span>Watch Now</span>
					</a>
				</div>
					</div>
			<div class="featured-item">
			<div class="fi-content">
							<img src="https://899029.smushcdn.com/2131410/wp-content/uploads/2021/04/MITRE-Results-Blog-Image-395x263_update.png?lossy=0&strip=1&webp=0" />
						
			
									<p class="featured-type">
						Carbanak & Fin7 results					</p>
							
							<p class="featured-title">
					MITRE Engenuity ATT&CK Evaluation Results				</p>
										<div class="featured-content">
					<p>Record Performance. Watch our MITRE webinar to see SentinelOne’s victorious performance against Carbanak & Fin7.</p>
				</div>
						
			</div>
							<div class="cta boxed purple">
					<a href="https://www.sentinelone.com/lp/mitre/" target="_blank">
						<span>LEARN MORE</span>
					</a>
				</div>
					</div>
			<div class="featured-item">
			<div class="fi-content">
							<img src="https://899029.smushcdn.com/2131410/wp-content/uploads/2021/03/Blog_CTA_03.jpg?lossy=0&strip=1&webp=0" />
						
			
									<p class="featured-type">
						Get a demo					</p>
							
							<p class="featured-title">
					Defeat every attack, at every stage of the threat lifecycle with SentinelOne				</p>
										<div class="featured-content">
					<p>Book a demo and see the world’s most advanced cybersecurity platform in action. </p>
				</div>
						
			</div>
							<div class="cta boxed purple">
					<a href="https://www.sentinelone.com/request-demo/" target="_blank">
						<span>Get Demo</span>
					</a>
				</div>
					</div>
		</div>
</div>
					</div>
						<aside id="sidebar" class="widget-area">
		<section id="search-3" class="widget widget_search"><h2 class="widget-title">Search</h2><form role="search" method="get" class="search-form" action="https://www.sentinelone.com/">
	<label>
		<span class="screen-reader-text">Search ...</span>
		<input type="search" class="search-field" placeholder="Search ..." value="" name="s">
	</label>
	<input type="submit" class="search-submit" value="Search">
</form></section><section id="amazon_polly_player-2" class="widget widget_amazon_polly_player"><h2 class="widget-title">Listen to this Post</h2>


			<table id="amazon-polly-audio-table"><tbody><tr><td id="amazon-polly-audio-tab">
			<div id="amazon-ai-player-label"></div>
			<div id="amazon-ai-player-container">
			<audio class="amazon-ai-player" id="amazon-ai-player" preload="none" controls="" controlslist="nodownload">
			<source type="audio/mpeg" src="https://s3.us-east-1.amazonaws.com/audio-for-wordpress-45086892059684b045a4189d91d52199e7d604f2/2020/03/amazon_polly_29053.mp3?version=1610482543">
			</audio>
			</div>
			<div id="amazon-polly-subscribe-tab"></div>
			<div id="amazon-polly-by-tab"></div>
			</td></tr></tbody></table>

</section><section id="s1_signup-2" class="widget widget_s1_signup"><h2 class="widget-title">Sign Up</h2>
<div class="marketo-blog-subscribe">
	<div class="context">
		<p>Keep up to date with our weekly digest of articles.</p>
	</div>
	<form id="mktoForm_1985"></form>
	<div class="context" style="display:none">
		<p>Thanks!  Keep an eye out for new content!</p>
	</div>
	<script>
		MktoForms2.loadForm("//go.sentinelone.com", "327-MNM-087", 1985, function(form){
			form.onSuccess(function(values, followUpUrl) {
				form.getFormElem().hide();
				form.getFormElem().prev().hide();
				form.getFormElem().next().show();
				return false;
			});
		});
	</script>
</div>

</section><section id="srpw_widget-2" class="widget widget_smart_recent_entries smart_recent_posts"><h2 class="widget-title">Recent Posts</h2><div class="srpw-block srpw-default-style "><style>.srpw-thumbnail{
width: 60px;
height: 60px;
}</style><ul class="srpw-ul"><li class="srpw-li srpw-clearfix"><div class="srpw-content"><a class="srpw-title" href="https://www.sentinelone.com/blog/the-good-the-bad-and-the-ugly-in-cybersecurity-week-21-2/" target="_self">The Good, the Bad and the Ugly in Cybersecurity &#8211; Week 21</a><div class="srpw-meta"><time class="srpw-time published" datetime="2021-05-21T08:00:45-07:00">May 21, 2021</time></div></div></li><li class="srpw-li srpw-clearfix"><div class="srpw-content"><a class="srpw-title" href="https://www.sentinelone.com/blog/how-to-achieve-full-endpoint-security-with-your-current-team-and-resources/" target="_self">How To Achieve Full Endpoint Security With Your Current Team And Resources </a><div class="srpw-meta"><time class="srpw-time published" datetime="2021-05-17T09:47:02-07:00">May 17, 2021</time></div></div></li><li class="srpw-li srpw-clearfix"><div class="srpw-content"><a class="srpw-title" href="https://www.sentinelone.com/blog/the-good-the-bad-and-the-ugly-in-cybersecurity-week-20-2/" target="_self">The Good, the Bad and the Ugly in Cybersecurity &#8211; Week 20</a><div class="srpw-meta"><time class="srpw-time published" datetime="2021-05-14T08:00:53-07:00">May 14, 2021</time></div></div></li></ul></div><!-- Generated by http://wordpress.org/plugins/smart-recent-posts-widget/ --></section><section id="categories-3" class="widget widget_categories"><h2 class="widget-title">Blog Categories</h2>
			<ul>
					<li class="cat-item cat-item-1"><a href="https://www.sentinelone.com/blog/category/company/">Company</a>
</li>
	<li class="cat-item cat-item-4988"><a href="https://www.sentinelone.com/blog/category/spotlight/">Feature Spotlight</a>
</li>
	<li class="cat-item cat-item-4493"><a href="https://www.sentinelone.com/blog/category/life-at-s1/">Life @ S1</a>
</li>
	<li class="cat-item cat-item-138"><a href="https://www.sentinelone.com/blog/category/producttechnology/">Product/Technology</a>
</li>
	<li class="cat-item cat-item-115"><a href="https://www.sentinelone.com/blog/category/security/">Security</a>
</li>
	<li class="cat-item cat-item-114"><a href="https://www.sentinelone.com/blog/category/security-research/">Security Research</a>
</li>
	<li class="cat-item cat-item-116"><a href="https://www.sentinelone.com/blog/category/sentinelone-intelligence-reports/">SentinelOne Intelligence Reports</a>
</li>
	<li class="cat-item cat-item-9033"><a href="https://www.sentinelone.com/blog/category/the-good-the-bad-and-the-ugly/">The Good, the Bad and the Ugly</a>
</li>
			</ul>

			</section>	</aside>
				</div>
			</div>
		</div>
	</section>
</div>


	

	</div>
	

	<footer class="footer">
		<div class="container-wide">
			<div class="links">
				<div class="site-nav-holder"><div class="column"><strong class="opener-footer">Company</strong><ul class="slide"><li><a href="https://www.sentinelone.com/customer-page/">Our Customers</a></li><li><a href="/why-sentinelone/">Why SentinelOne</a></li><li><a href="/platform/">Platform</a></li><li><a href="/company/">About</a></li><li><a href="/partners/partner-overview/">Partners</a></li><li><a href="/support/">Support</a></li><li><a href="/careers/">Careers</a></li><li><a href="https://www.sentinelone.com/legal/">Legal &#038; Compliance</a></li><li><a href="https://www.sentinelone.com/security-compliance/">Security & Compliance</a></li><li><a href="/contact/">Contact Us</a></li></ul></div><div class="column"><strong class="opener-footer">Resources</strong><ul class="slide"><li><a href="/blog/">Blog</a></li><li><a href="https://labs.sentinelone.com">Labs</a></li><li><a href="https://www.sentinelone.com/lp/hackchat/">Hack Chat</a></li><li><a href="/press/">Press</a></li><li><a href="/news/">News</a></li><li><a href="https://www.sentinelone.com/faq/">FAQ</a></li><li><a href="/resources/">Resources</a></li></ul></div></div>			</div>
			<div class="about">
				<strong>Global Headquarters</strong>
<div class="blurb">
	<p>
		444 Castro Street
		<br />
		Suite 400
		<br />
		Mountain View, CA 94041
	</p>
	<p class="phone">+1-855-868-3733</p>
	<p><a href="mailto:sales@sentinelone.com">sales@sentinelone.com</a></p>
</div>			</div>
			<div class="signup">
				<div class="form-holder">
					<strong class="heading">Sign Up For Our Newsletter</strong>
					<form id="mktoForm_2816"></form>
					<div style="display:none">
						Thank you! You will now receive our weekly newsletter with all recent blog posts.  See you soon!					</div>
					<script>
						MktoForms2.loadForm( "//go.sentinelone.com", "327-MNM-087", 2816, function( form ){
							form.onSuccess( function( values, followUpUrl ) {
								form.getFormElem().hide();
								form.getFormElem().next().show();
								return false;
							} );
						} );
					</script>
				</div>
				<div class="icons">
					<a href="https://twitter.com/SentinelOne" target="_blank">
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/social-twitter.svg" />
					</a>
					<a href="https://www.facebook.com/SentinelOne/" target="_blank">
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/social-facebook.svg" />
					</a>
					<a href="https://www.linkedin.com/company/sentinelone/" target="_blank">
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/social-linkedin.svg" />
					</a>
					<a href="https://goo.gl/e5C9f4" target="_blank">
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/social-youtube.svg" />
					</a>
				</div>
					<div class="lang-select">
		<span class="label">English</span>
		<ul>
	<li class="current"><span href="https://www.sentinelone.com//">English</span></li><li class=""><a href="https://jp.sentinelone.com//">日本語</a></li><li class=""><a href="https://de.sentinelone.com//">Deutsch</a></li><li class=""><a href="https://es.sentinelone.com//">Español</a></li><li class=""><a href="https://fr.sentinelone.com//">Français</a></li><li class=""><a href="https://it.sentinelone.com//">Italiano</a></li><li class=""><a href="https://nl.sentinelone.com//">Dutch</a></li><li class=""><a href="https://kr.sentinelone.com//">한국어</a></li>		</ul>
	</div>
				</div>
		</div>
	</footer>	
	
	<footer class="copyright">
		<div class="container-wide">
			<div class="links">
				<a href="/legal/privacy-policy/">Privacy Policy</a>
<a href="/legal/terms-of-service/">Terms of Service</a>			</div>
			<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/footer-logo.svg" />
			<div class="copy">
				©2021 SentinelOne, All Rights Reserved.			</div>
		</div>
	</footer>
	

		
		<div id="cookie-message-panel">
		<div class="container">
			<div class="blurb">
				SentinelOne and its service providers use browser cookies or similar technologies as specified in the SentinelOne Privacy Policy.  You can consent to the use of such technologies and browse the SentinelOne website by clicking the Accept button.			</div>
			<a class="btn" href="javascript:void(0);" id="continue-cookies">Accept</a>
			<a class="btn secondary" href="https://www.sentinelone.com/global-services/get-support-now/" id="reject-cookies">Reject</a>
		</div>
	</div>
	<script>
		MktoForms2.onFormRender(function( form ) {
			var button_row = form.getFormElem().find( '.mktoButtonRow' );
			var label      = button_row.find( 'button' ).html();
			var legalese   = 'By clicking {{LABEL}}, I agree to the use of my personal data in accordance with SentinelOne <a href=\"/legal/privacy-policy/\">Privacy Policy</a>. SentinelOne will not sell, trade, lease, or rent your personal data to third parties.';
			if ( button_row.data( 'inited' ) ) {
				return;
			}
			button_row.data( 'inited', true );
			button_row.after( '<div class="marketo-legal">' + legalese.split( '{{LABEL}}' ).join( label )  + '</div>' );
		} );
	</script>
		
	<div id="global-video-player">
		<div class="underlay"></div>
		<div class="close"><img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/testimonial_icon_close.svg" /></div>
		<video controls>
			<source src="" type="video/mp4">
		</video> 
	</div>
	
	<!-- https://linkedin.com/ -- added 06/09/20 by hypergeneric -->
<script type="text/javascript">
_linkedin_partner_id = "2225260";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://px.ads.linkedin.com/collect/?pid=2225260&fmt=gif" />
</noscript>


<!-- https://optinmonster.com/ -- added 07/17/20 by hypergeneric -->
<!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com-->
<script type="text/javascript" src="https://a.omappapi.com/app/js/api.min.js" data-account="87916" data-user="78190" async></script>
<!-- / OptinMonster -->	<script>
	jQuery( document ).ready( function() {
		jQuery( 'pre' ).each( function ( i, block ) {
			hljs.highlightBlock( block );
		} );
	} );
	</script>
<script type='text/javascript' src='https://www.sentinelone.com/wp-includes/js/clipboard.min.js?ver=e99a8f3f6c9445ffcaf2f405e4d583b9' id='clipboard-js'></script>
<script type='text/javascript' src='https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/js/footer.min.js?ver=1621675641' id='carbine-script-footer-js'></script>
<script type='text/javascript' src='https://cdn.onesignal.com/sdks/OneSignalSDK.js?ver=e99a8f3f6c9445ffcaf2f405e4d583b9' async='async' id='remote_sdk-js'></script>
	
					
		
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"NRJS-7f7a0b93139dcf56f90","applicationID":"773889139","transactionName":"ZlwDMkMCWxJQUkdYXF8WIAVFCloPHkJaX1RdXA==","queueTime":0,"applicationTime":502,"atts":"ShsARAsYSBw=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
