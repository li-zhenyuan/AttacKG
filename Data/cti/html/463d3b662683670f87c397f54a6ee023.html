<!doctype html>
<!--[if lt IE 7 ]> <html class="ie6 no-flexbox"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7 no-flexbox"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8 no-flexbox"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie9 no-flexbox"> <![endif]-->
<!--[if IE 10 ]>    <html class="ie10 no-flexbox"> <![endif]-->
<!--[if (gt IE 10)|!(IE)]><!--> <html class="modern wf-loading" lang="en"> <!--<![endif]-->
  <head>
  <link rel="preload" href="https://use.typekit.net/osg6paw.css" as="style" crossorigin />
  <link rel="stylesheet" href="https://use.typekit.net/osg6paw.css" crossorigin />

  <script>
    var searchDomain = 'https://developer.okta.com';
    var isProduction = window.location.hostname === 'developer.okta.com';
    if (isProduction) {

      // START Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-KXMLV58');
      // END Google Tag Manager

    }
  </script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   

  <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.10081/5/css/CoveoFullSearch.min.css" integrity="sha512-c6ZA0d3XVIG36GHJHX+TRBINlF4+k4cDAngeqQmWzEcPys5FWvLCD/IVaUJsdmNchM+4YuCcYpaXsNsb2B8bWQ==" crossorigin="anonymous">

  <link type="text/css" rel="stylesheet" href="/assets-jekyll/animate-ec43d72c3ed45e08a460b8a2966d8dba6006aebfa0530935c3973fa493a8771f.css">
  <link type="text/css" rel="stylesheet" href="/assets-jekyll/okta-1a7207d8f7c63dd3d7e003db1514474df858b7c72081618ece9619090b5d1efc.css">
  
  
  <title>What Happens If Your JWT Is Stolen? | Okta Developer</title>
  <meta name="description" content="What happens if a JSON Web Token is stolen or compromised? What are the security considerations you need to understand? In this post, we'll look at what JWTs are, and what happens when they're stolen or compromised.">
  <link rel="alternate" type="application/rss+xml" title="Okta Developer" href="https://developer.okta.com/feed.xml"><!-- GA -->
  
  <link rel="apple-touch-icon" sizes="180x180" href="/assets-jekyll/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets-jekyll/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets-jekyll/favicon/favicon-16x16.png">
  <link rel="manifest" href="/assets-jekyll/favicon/manifest.json">
  <link rel="mask-icon" href="/assets-jekyll/favicon/safari-pinned-tab.svg" color="#21313a">
  <meta name="msapplication-config" content="/assets-jekyll/favicon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
  <link rel="canonical" href="https://developer.okta.com/blog/2018/06/20/what-happens-if-your-jwt-is-stolen" />
  
  <meta property="og:type"               content="article" />
  <meta property="og:url"                content="https://developer.okta.com/blog/2018/06/20/what-happens-if-your-jwt-is-stolen" />
  <meta property="og:title"              content="What Happens If Your JWT Is Stolen?" />
  <meta property="og:description"        content="What happens if a JSON Web Token is stolen or compromised? What are the security considerations you need to understand? In this post, we'll look at what JWTs are, and what happens when they're stolen or compromised." />

  <!-- Add BlogPosting schema -->
  
  <meta property="og:site_name" content="Okta Developer" />
  <!-- twitter will use the og: tags to show a preview -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@oktadev" />
  <meta name="twitter:creator" content="@oktadev" />
  
  <!-- START VWO Tracking -->
  <script type='text/javascript'>
  var _vwo_code=(function(){
    var account_id=342490,
    settings_tolerance=2000,
    library_tolerance=2500,
    use_existing_jquery=false,
    /* DO NOT EDIT BELOW THIS LINE */
    f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
  </script>
  <!-- END VWO Tracking -->
</head>

  
    <body id="blog" class="">
	





<nav class="navigation is-fixed">

    <div class="nav-wrapper flex-row align-center">
        <a class="logo" href="https://developer.okta.com">
            <svg viewBox="0 0 157 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M56.0156 0.407593H61.1882C65.9798 0.407593 69.0472 3.65742 69.0472 8.65403C69.0472 13.7725 66.1802 16.9817 61.0879 16.9817H56.0357V0.407593H56.0156ZM60.727 15.4177C65.1177 15.4177 67.303 13.0007 67.303 8.65403C67.303 4.59174 65.1578 1.97157 60.8473 1.97157H57.6396V15.4177H60.727Z" fill="white"></path>
                <path d="M71.25 11.0711C71.25 7.25254 73.4554 4.97766 76.2421 4.97766C79.4499 4.97766 81.4948 7.69939 81.134 11.4367H72.7937C72.894 14.8287 74.6182 15.9052 76.4025 15.9052C78.4074 15.9052 79.4098 14.3818 79.7506 13.4475L81.1941 13.9959C80.4724 16.0068 78.668 17.2864 76.3624 17.2864C73.2749 17.2864 71.25 15.174 71.25 11.0711ZM79.5702 10.1164C79.5702 7.55721 77.9863 6.2979 76.2421 6.2979C74.3776 6.2979 72.9541 7.86188 72.8138 10.1164H79.5702Z" fill="white"></path>
                <path d="M82.6992 5.30261H84.3432L86.6087 11.9851L87.8316 15.5396L89.0346 12.0054L91.1998 5.30261H92.8037L88.794 16.9817H86.8292L82.6992 5.30261Z" fill="white"></path>
                <path d="M94.3281 11.0711C94.3281 7.25254 96.5335 4.97766 99.3202 4.97766C102.528 4.97766 104.573 7.69939 104.212 11.4367H95.8719C95.9721 14.8287 97.6963 15.9052 99.4606 15.9052C101.465 15.9052 102.468 14.3818 102.809 13.4475L104.252 13.9959C103.53 16.0068 101.726 17.2864 99.4205 17.2864C96.3731 17.2864 94.3281 15.174 94.3281 11.0711ZM102.648 10.1164C102.648 7.55721 101.064 6.2979 99.3202 6.2979C97.4557 6.2979 96.0323 7.86188 95.8919 10.1164H102.648Z" fill="white"></path>
                <path d="M108.802 0.407593H107.238V16.9817H108.802V0.407593Z" fill="white"></path>
                <path d="M111.688 11.1523C111.688 7.41503 114.093 4.97766 117.02 4.97766C119.947 4.97766 122.353 7.41503 122.353 11.1523C122.353 14.8896 119.867 17.2864 117.02 17.2864C114.174 17.2864 111.688 14.8896 111.688 11.1523ZM120.729 11.1726C120.729 8.00406 119.065 6.39946 117.02 6.39946C114.955 6.39946 113.311 8.00406 113.311 11.1726C113.311 14.3412 114.975 15.8849 117.02 15.8849C119.085 15.8849 120.729 14.3615 120.729 11.1726Z" fill="white"></path>
                <path d="M125.242 5.30269H126.766V7.33383C127.327 6.19639 128.57 4.9574 130.595 4.9574C133.141 4.9574 135.307 7.0901 135.307 11.1118C135.307 15.1334 133.141 17.2661 130.595 17.2661C128.49 17.2661 127.327 16.0068 126.806 14.9303V17.2052V21.5924H125.242V5.30269ZM133.743 11.1118C133.743 7.69944 132.199 6.39951 130.294 6.39951C128.29 6.39951 126.746 7.88224 126.746 11.1118C126.746 14.3413 128.29 15.8849 130.294 15.8849C132.199 15.8849 133.743 14.5444 133.743 11.1118Z" fill="white"></path>
                <path d="M137.395 11.0711C137.395 7.25254 139.6 4.97766 142.387 4.97766C145.594 4.97766 147.639 7.69939 147.278 11.4367H138.938C139.039 14.8287 140.763 15.9052 142.547 15.9052C144.552 15.9052 145.554 14.3818 145.895 13.4475L147.339 13.9959C146.617 16.0068 144.813 17.2864 142.507 17.2864C139.439 17.2864 137.395 15.174 137.395 11.0711ZM145.715 10.1164C145.715 7.55721 144.131 6.2979 142.387 6.2979C140.522 6.2979 139.099 7.86188 138.958 10.1164H145.715Z" fill="white"></path>
                <path d="M150.305 5.30263H151.848V7.88218C152.189 6.78536 153.432 5.14014 155.618 5.14014C156.279 5.14014 156.7 5.24169 157.001 5.30263V6.90723C156.66 6.82598 156.179 6.76505 155.598 6.76505C152.931 6.76505 151.868 8.75557 151.868 11.6195V16.9614H150.325V5.30263H150.305Z" fill="white"></path>
                <path d="M6.0341 4.83545C2.70604 4.83545 0.0195312 7.55718 0.0195312 10.9289C0.0195312 14.3006 2.70604 17.0223 6.0341 17.0223C9.36216 17.0223 12.0487 14.3006 12.0487 10.9289C12.0487 7.57749 9.36216 4.83545 6.0341 4.83545ZM6.0341 13.9756C4.37007 13.9756 3.02681 12.6147 3.02681 10.9289C3.02681 9.24303 4.37007 7.88216 6.0341 7.88216C7.69813 7.88216 9.04138 9.24303 9.04138 10.9289C9.04138 12.6147 7.69813 13.9756 6.0341 13.9756Z" fill="white"></path>
                <path d="M16.5987 12.9804C16.5987 12.4929 17.1801 12.2695 17.5009 12.5945C19.0045 14.1585 21.4905 16.7989 21.5106 16.8193C21.5507 16.8599 21.5707 16.9208 21.7311 16.9614C21.7913 16.9818 21.8915 16.9818 21.9917 16.9818H24.6983C25.1795 16.9818 25.3399 16.413 25.0993 16.1287L20.6084 11.457L20.3678 11.2133C19.8666 10.604 19.9067 10.3602 20.4881 9.73058L24.0768 5.70891C24.3174 5.42456 24.157 4.85584 23.6558 4.85584H21.1898C21.0896 4.85584 21.0094 4.85584 20.9492 4.87615C20.8089 4.91677 20.7487 4.9777 20.7086 5.01833C20.6886 5.03864 18.7238 7.19165 17.5009 8.51189C17.16 8.8775 16.5786 8.63376 16.5786 8.14628V1.2404C16.5786 0.89511 16.298 0.75293 16.0574 0.75293H14.0525C13.7117 0.75293 13.5312 0.996667 13.5312 1.19978V16.5349C13.5312 16.8802 13.832 16.9818 14.0525 16.9818H16.0574C16.3781 16.9818 16.5786 16.7583 16.5786 16.5146V16.3521V12.9804H16.5987Z" fill="white"></path>
                <path d="M32.9993 16.4537L32.7787 14.4225C32.7587 14.1382 32.498 13.9553 32.2174 13.996C32.057 14.0163 31.9166 14.0366 31.7562 14.0366C30.1524 14.0366 28.8492 12.757 28.769 11.1524C28.769 11.0914 28.769 11.0508 28.769 10.9899V8.49158C28.769 8.1666 29.0096 7.90255 29.3304 7.90255H32.0169C32.2174 7.90255 32.498 7.74006 32.498 7.37445V5.44487C32.498 5.07926 32.2575 4.87615 32.057 4.87615H29.3504C29.0296 4.87615 28.7891 4.65272 28.7891 4.32774V1.2404C28.7891 1.0576 28.6487 0.75293 28.2678 0.75293H26.2629C26.0023 0.75293 25.7617 0.915421 25.7617 1.22009C25.7617 1.22009 25.7617 11.0914 25.7617 11.1321C25.8419 14.4225 28.5084 17.063 31.7763 17.063C32.057 17.063 32.3176 17.0427 32.5782 17.0021C32.8389 16.9817 33.0393 16.7177 32.9993 16.4537Z" fill="white"></path>
                <path d="M47.4939 13.8944C45.7898 13.8944 45.5291 13.285 45.5291 10.9695V10.9492V5.4042C45.5291 5.22139 45.3888 4.89641 45.0079 4.89641H43.003C42.7424 4.89641 42.4818 5.09952 42.4818 5.4042V5.66824C41.5996 5.16046 40.5972 4.8761 39.5146 4.8761C36.1865 4.8761 33.5 7.59783 33.5 10.9695C33.5 14.3412 36.1865 17.0629 39.5146 17.0629C40.9982 17.0629 42.3615 16.5145 43.424 15.6005C43.9854 16.4739 44.9076 17.0426 46.311 17.0629C46.5516 17.0629 47.8347 17.1036 47.8347 16.4942V14.3006C47.8347 14.0975 47.6944 13.8944 47.4939 13.8944ZM39.5146 13.9756C37.8505 13.9756 36.5073 12.6147 36.5073 10.9289C36.5073 9.24305 37.8505 7.88219 39.5146 7.88219C41.1786 7.88219 42.5218 9.24305 42.5218 10.9289C42.5218 12.6147 41.1786 13.9756 39.5146 13.9756Z" fill="white"></path>
            </svg>
        </a>

        
            <div class="search-wrapper menu-dropdown-wrapper mobile-search-container" data-search-bar>
                <!-- Search box  -->
                <div class="SearchBox search-box flex" data-pipeline="developer-okta-com">
                    <div class="CoveoOmnibox"></div>
                    <div class="CoveoSearchButton hide">Search</div>
                    <div class="CoveoAnalytics"></div>

                    







    <svg class="search-icon hide-for-small" width="15" height="15" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M7.47328 8.65339C6.81369 9.09025 6.02272 9.34466 5.17233 9.34466C2.86802 9.34466 1 7.47665 1 5.17233C1 2.86802 2.86802 1 5.17233 1C7.47665 1 9.34466 2.86802 9.34466 5.17233C9.34466 6.02272 9.09025 6.81369 8.65339 7.47328L10.7556 9.57548C11.0815 9.90136 11.0815 10.4297 10.7556 10.7556C10.4297 11.0815 9.90136 11.0815 9.57548 10.7556L7.47328 8.65339ZM7.67573 5.17233C7.67573 6.55492 6.55492 7.67573 5.17233 7.67573C3.78974 7.67573 2.66893 6.55492 2.66893 5.17233C2.66893 3.78974 3.78974 2.66893 5.17233 2.66893C6.55492 2.66893 7.67573 3.78974 7.67573 5.17233Z" fill="#14222A" stroke="white" stroke-width="0.25"/>
    </svg>



                </div>
                <!-- end Search box  -->
            </div>
        

        <div class="flex-row space-between align-center full-width hide-for-small">
            <ul class="menu flex-row align-center flex-auto">
                <li class="menu-item has-children">
                    <span class="nav-link active">Community <i class="fa fa-angle-down"></i></span>

                    <ul class="sub-menu">
                        <li class="menu-item">
                            <a href="https://devforum.okta.com/" class="nav-link">Forum</a>
                        </li>
                        <li class="menu-item active">
                            <a href="/blog" class="nav-link">Blog</a>
                        </li>
                        <li class="menu-item">
                            <a href="https://toolkit.okta.com/" class="nav-link">Toolkit</a>
                        </li>
                        <li class="menu-item">
                            <div class="social-links flex-row space-between align-center">
                                <a href="http://github.com/oktadev" class="social">
                                    
    <!-- Github icon -->
    <svg class="" width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M20.9406 6.21364C19.937 4.45098 18.5757 3.05547 16.8563 2.02682C15.1367 0.99811 13.2593 0.483887 11.2229 0.483887C9.18683 0.483887 7.30888 0.998267 5.58959 2.02682C3.87005 3.05542 2.50879 4.45098 1.50519 6.21364C0.501747 7.97625 0 9.90103 0 11.9879C0 14.4948 0.713491 16.749 2.14083 18.7512C3.56802 20.7535 5.41173 22.139 7.67182 22.9079C7.9349 22.958 8.12965 22.9228 8.25628 22.8032C8.38295 22.6835 8.44622 22.5335 8.44622 22.354C8.44622 22.324 8.44371 22.0545 8.43885 21.5451C8.43383 21.0357 8.43148 20.5913 8.43148 20.2121L8.09536 20.2717C7.88105 20.312 7.61071 20.329 7.28431 20.3242C6.95807 20.3195 6.61939 20.2845 6.26874 20.2193C5.91793 20.1547 5.59164 20.005 5.28961 19.7703C4.98773 19.5356 4.77343 19.2284 4.64675 18.8492L4.50062 18.5045C4.40322 18.275 4.24988 18.02 4.04039 17.7406C3.83089 17.4609 3.61905 17.2713 3.40474 17.1715L3.30243 17.0964C3.23425 17.0465 3.17099 16.9863 3.11249 16.9165C3.05404 16.8466 3.01028 16.7767 2.98105 16.7068C2.95177 16.6367 2.97603 16.5793 3.05409 16.5342C3.13214 16.4891 3.2732 16.4673 3.47788 16.4673L3.77004 16.512C3.96489 16.552 4.20591 16.6716 4.49341 16.8715C4.78075 17.0711 5.01696 17.3307 5.20209 17.6502C5.42627 18.0597 5.69636 18.3718 6.01313 18.5865C6.32965 18.8013 6.64877 18.9085 6.9702 18.9085C7.29163 18.9085 7.56925 18.8835 7.80315 18.8338C8.0368 18.7839 8.25602 18.7088 8.4607 18.609C8.54838 17.9396 8.7871 17.4254 9.17665 17.0659C8.62142 17.0061 8.12223 16.916 7.67883 16.7963C7.23569 16.6763 6.77775 16.4817 6.30533 16.2118C5.83266 15.9423 5.44055 15.6076 5.12889 15.2083C4.81719 14.8088 4.56138 14.2844 4.36181 13.6354C4.16215 12.9862 4.06229 12.2373 4.06229 11.3885C4.06229 10.1799 4.44719 9.15149 5.21683 8.30259C4.85629 7.39397 4.89033 6.37539 5.31904 5.24694C5.60157 5.15696 6.02055 5.22449 6.57579 5.4491C7.13112 5.67381 7.53772 5.86631 7.79599 6.02591C8.05426 6.18546 8.26119 6.32067 8.41709 6.43032C9.32329 6.17077 10.2585 6.04097 11.2228 6.04097C12.1872 6.04097 13.1226 6.17077 14.0288 6.43032L14.5841 6.07098C14.9639 5.83121 15.4123 5.61148 15.9283 5.41174C16.4446 5.21211 16.8395 5.15712 17.1124 5.2471C17.5506 6.3756 17.5896 7.39413 17.229 8.30274C17.9986 9.15165 18.3836 10.1804 18.3836 11.3887C18.3836 12.2375 18.2834 12.9887 18.0841 13.6429C17.8845 14.2972 17.6264 14.8212 17.3099 15.2158C16.9931 15.6104 16.5984 15.9425 16.126 16.2119C15.6535 16.4816 15.1954 16.6763 14.7523 16.7962C14.3089 16.9162 13.8097 17.0063 13.2545 17.0662C13.7609 17.5154 14.0142 18.2245 14.0142 19.1931V22.3536C14.0142 22.5331 14.0751 22.683 14.197 22.8028C14.3187 22.9223 14.511 22.9576 14.7741 22.9074C17.0345 22.1387 18.8782 20.7531 20.3054 18.7507C21.7323 16.7486 22.4461 14.4944 22.4461 11.9875C22.4456 9.90087 21.9436 7.97625 20.9406 6.21364Z" fill="#DD2864"/>
    </svg>










                                </a>
                                <a href="http://twitter.com/OktaDev" class="social">
                                    


    <!-- Twitter icon -->
    <svg class="" width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M11.223 0.483887C5.02568 0.483887 0 5.50956 0 11.7069C0 17.9043 5.02568 22.93 11.223 22.93C17.4204 22.93 22.4461 17.9043 22.4461 11.7069C22.4461 5.50956 17.4204 0.483887 11.223 0.483887ZM16.3474 9.23442C16.3523 9.34488 16.3547 9.45585 16.3547 9.56734C16.3547 12.9713 13.7637 16.8965 9.02539 16.8967C7.57062 16.8967 6.21689 16.4703 5.07688 15.7395C5.27844 15.7633 5.4836 15.7752 5.69133 15.7752C6.8983 15.7752 8.00902 15.3635 8.89079 14.6725C7.76311 14.6516 6.81233 13.9068 6.48421 12.8833C6.64125 12.9134 6.80274 12.9298 6.96834 12.9298C7.20346 12.9298 7.43123 12.8981 7.64769 12.8391C6.46897 12.6031 5.58104 11.5614 5.58104 10.314C5.58104 10.3023 5.58104 10.2919 5.58138 10.2811C5.92851 10.4741 6.32547 10.5902 6.74811 10.6032C6.05643 10.1417 5.60176 9.35276 5.60176 8.459C5.60176 7.98704 5.72934 7.54487 5.9506 7.16418C7.22093 8.7229 9.11941 9.748 11.2604 9.85572C11.2162 9.667 11.1934 9.47041 11.1934 9.26833C11.1934 7.84627 12.3471 6.69256 13.7697 6.69256C14.5107 6.69256 15.18 7.00578 15.65 7.50651C16.2369 7.39075 16.788 7.17634 17.2858 6.88128C17.0932 7.48254 16.6849 7.98704 16.153 8.30608C16.6741 8.24374 17.1707 8.10554 17.6323 7.90039C17.2875 8.41705 16.8503 8.87086 16.3474 9.23442Z" fill="#DD2864"/>
    </svg>








                                </a>
                                <a href="https://www.youtube.com/channel/UC5AMiWqFVFxF1q9Ya1FuZ_Q/featured" class="social">
                                    





    <!-- Youtube icon -->
    <svg class="" width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M9.35156 13.8143L13.0376 11.6913L9.35156 9.56836V13.8143Z" fill="#DD2864"/>
        <path d="M11.223 0.484375C5.02568 0.484375 0 5.51005 0 11.7074C0 17.9048 5.02568 22.9305 11.223 22.9305C17.4204 22.9305 22.4461 17.9048 22.4461 11.7074C22.4461 5.51005 17.4204 0.484375 11.223 0.484375ZM18.2357 11.7189C18.2357 11.7189 18.2357 13.995 17.947 15.0925C17.7852 15.6933 17.3115 16.1669 16.7108 16.3286C15.6132 16.6175 11.223 16.6175 11.223 16.6175C11.223 16.6175 6.84435 16.6175 5.73534 16.3171C5.13459 16.1555 4.66091 15.6816 4.49908 15.0809C4.21018 13.995 4.21018 11.7074 4.21018 11.7074C4.21018 11.7074 4.21018 9.43151 4.49908 8.33397C4.66074 7.73322 5.14607 7.2479 5.73534 7.08624C6.83288 6.79734 11.223 6.79734 11.223 6.79734C11.223 6.79734 15.6132 6.79734 16.7108 7.09771C17.3115 7.25937 17.7852 7.73322 17.947 8.33397C18.2474 9.43151 18.2357 11.7189 18.2357 11.7189Z" fill="#DD2864"/>
    </svg>





                                </a>
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="menu-item ">
                    <a href="https://developer.okta.com/pricing/" class="nav-link">Pricing</a>
                </li>
            </ul>
            <ul class="menu external-links flex-row align-center">
                <li class="menu-item">
                    <a href="https://www.okta.com/" class="nav-link" target="_blank" rel="noopener noreferrer">
                        Okta.com









    <!-- External link icon -->
    <svg fill="none" height="11" viewBox="0 0 10 11" width="10" xmlns="http://www.w3.org/2000/svg">
        <g fill="#fff" opacity=".3">
            <path d="m9.38307.75h-3.3122c-.33988 0-.71428.37444-.71428.71429 0 .33984.3744.71428.71428.71428h1.78572l-3.21507 3.05766c-.11648.11641-.18058.27117-.18058.43586 0 .1647.06406.31942.18051.43572.11644.11655.27116.18069.43585.18069.16463 0 .31942-.06411.4359-.18058l3.05767-3.21506v1.78571c0 .33985.37444.71429.71429.71429s.71428-.37444.71428-.71429v-3.3122c0-.33985-.27652-.61637-.61637-.61637z"/><path d="m7.14289 9.32144h-5.71432v-5.71428h2.14286l1.42857-1.42857h-4.285714c-.29177 0-.714286.42251-.714286.71429v7.14282c0 .3572.357143.7143.714286.7143h7.142894c.35714 0 .71429-.3571.71429-.7143l-.00004-4.28568-1.42854 1.42857z"/>
        </g>
    </svg>

                    </a>
                </li>
                <li class="menu-item">
                    <a href="https://login.okta.com/" class="nav-link" target="_blank" rel="noopener noreferrer">
                        Admin Console









    <!-- External link icon -->
    <svg fill="none" height="11" viewBox="0 0 10 11" width="10" xmlns="http://www.w3.org/2000/svg">
        <g fill="#fff" opacity=".3">
            <path d="m9.38307.75h-3.3122c-.33988 0-.71428.37444-.71428.71429 0 .33984.3744.71428.71428.71428h1.78572l-3.21507 3.05766c-.11648.11641-.18058.27117-.18058.43586 0 .1647.06406.31942.18051.43572.11644.11655.27116.18069.43585.18069.16463 0 .31942-.06411.4359-.18058l3.05767-3.21506v1.78571c0 .33985.37444.71429.71429.71429s.71428-.37444.71428-.71429v-3.3122c0-.33985-.27652-.61637-.61637-.61637z"/><path d="m7.14289 9.32144h-5.71432v-5.71428h2.14286l1.42857-1.42857h-4.285714c-.29177 0-.714286.42251-.714286.71429v7.14282c0 .3572.357143.7143.714286.7143h7.142894c.35714 0 .71429-.3571.71429-.7143l-.00004-4.28568-1.42854 1.42857z"/>
        </g>
    </svg>

                    </a>
                </li>
                <li class="menu-item">
                    <a href="https://developer.okta.com/signup/" class="cta flex align-center justify-center">
                        Sign up
                    </a>
                </li>
            </ul>
        </div>

        <div class="flex-row space-between align-center full-width show-for-small">
            <div class="mobile-controls flex-row align-center">
                
                    <div class="search-toggle">
                        







    <svg class="search-icon " width="15" height="15" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M7.47328 8.65339C6.81369 9.09025 6.02272 9.34466 5.17233 9.34466C2.86802 9.34466 1 7.47665 1 5.17233C1 2.86802 2.86802 1 5.17233 1C7.47665 1 9.34466 2.86802 9.34466 5.17233C9.34466 6.02272 9.09025 6.81369 8.65339 7.47328L10.7556 9.57548C11.0815 9.90136 11.0815 10.4297 10.7556 10.7556C10.4297 11.0815 9.90136 11.0815 9.57548 10.7556L7.47328 8.65339ZM7.67573 5.17233C7.67573 6.55492 6.55492 7.67573 5.17233 7.67573C3.78974 7.67573 2.66893 6.55492 2.66893 5.17233C2.66893 3.78974 3.78974 2.66893 5.17233 2.66893C6.55492 2.66893 7.67573 3.78974 7.67573 5.17233Z" fill="#14222A" stroke="white" stroke-width="0.25"/>
    </svg>



                    </div>
                

                <div class="hamburger">
                    <div class="lines">
                        <div class="lines_part"></div>
                        <div class="lines_part"></div>
                        <div class="lines_part"></div>
                    </div>
                </div>
            </div>

            <ul class="mobile-menu menu-dropdown-wrapper">
                <li class="menu-item separator flex-row justify-center">
                    <a href="https://developer.okta.com/signup/" class="cta flex align-center justify-center">
                        Sign up
                    </a>
                </li>
                <li class="menu-item has-children">
                    <a href="#" class="nav-link flex-row align-center space-between">
                        Community <i class="fa fa-angle-right"></i>
                    </a>

                    <ul class="sub-menu">
                        <li class="menu-item">
                            <a href="https://devforum.okta.com/" class="nav-link">Forum</a>
                        </li>
                        <li class="menu-item active">
                            <a href="/blog" class="nav-link">Blog</a>
                        </li>
                        <li class="menu-item">
                            <a href="https://toolkit.okta.com/" class="nav-link">Toolkit</a>
                        </li>
                        <li class="menu-item">
                            <div class="social-links flex-row align-center">
                                <a href="http://github.com/oktadev" class="social">
                                    
    <!-- Github icon -->
    <svg class="" width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M20.9406 6.21364C19.937 4.45098 18.5757 3.05547 16.8563 2.02682C15.1367 0.99811 13.2593 0.483887 11.2229 0.483887C9.18683 0.483887 7.30888 0.998267 5.58959 2.02682C3.87005 3.05542 2.50879 4.45098 1.50519 6.21364C0.501747 7.97625 0 9.90103 0 11.9879C0 14.4948 0.713491 16.749 2.14083 18.7512C3.56802 20.7535 5.41173 22.139 7.67182 22.9079C7.9349 22.958 8.12965 22.9228 8.25628 22.8032C8.38295 22.6835 8.44622 22.5335 8.44622 22.354C8.44622 22.324 8.44371 22.0545 8.43885 21.5451C8.43383 21.0357 8.43148 20.5913 8.43148 20.2121L8.09536 20.2717C7.88105 20.312 7.61071 20.329 7.28431 20.3242C6.95807 20.3195 6.61939 20.2845 6.26874 20.2193C5.91793 20.1547 5.59164 20.005 5.28961 19.7703C4.98773 19.5356 4.77343 19.2284 4.64675 18.8492L4.50062 18.5045C4.40322 18.275 4.24988 18.02 4.04039 17.7406C3.83089 17.4609 3.61905 17.2713 3.40474 17.1715L3.30243 17.0964C3.23425 17.0465 3.17099 16.9863 3.11249 16.9165C3.05404 16.8466 3.01028 16.7767 2.98105 16.7068C2.95177 16.6367 2.97603 16.5793 3.05409 16.5342C3.13214 16.4891 3.2732 16.4673 3.47788 16.4673L3.77004 16.512C3.96489 16.552 4.20591 16.6716 4.49341 16.8715C4.78075 17.0711 5.01696 17.3307 5.20209 17.6502C5.42627 18.0597 5.69636 18.3718 6.01313 18.5865C6.32965 18.8013 6.64877 18.9085 6.9702 18.9085C7.29163 18.9085 7.56925 18.8835 7.80315 18.8338C8.0368 18.7839 8.25602 18.7088 8.4607 18.609C8.54838 17.9396 8.7871 17.4254 9.17665 17.0659C8.62142 17.0061 8.12223 16.916 7.67883 16.7963C7.23569 16.6763 6.77775 16.4817 6.30533 16.2118C5.83266 15.9423 5.44055 15.6076 5.12889 15.2083C4.81719 14.8088 4.56138 14.2844 4.36181 13.6354C4.16215 12.9862 4.06229 12.2373 4.06229 11.3885C4.06229 10.1799 4.44719 9.15149 5.21683 8.30259C4.85629 7.39397 4.89033 6.37539 5.31904 5.24694C5.60157 5.15696 6.02055 5.22449 6.57579 5.4491C7.13112 5.67381 7.53772 5.86631 7.79599 6.02591C8.05426 6.18546 8.26119 6.32067 8.41709 6.43032C9.32329 6.17077 10.2585 6.04097 11.2228 6.04097C12.1872 6.04097 13.1226 6.17077 14.0288 6.43032L14.5841 6.07098C14.9639 5.83121 15.4123 5.61148 15.9283 5.41174C16.4446 5.21211 16.8395 5.15712 17.1124 5.2471C17.5506 6.3756 17.5896 7.39413 17.229 8.30274C17.9986 9.15165 18.3836 10.1804 18.3836 11.3887C18.3836 12.2375 18.2834 12.9887 18.0841 13.6429C17.8845 14.2972 17.6264 14.8212 17.3099 15.2158C16.9931 15.6104 16.5984 15.9425 16.126 16.2119C15.6535 16.4816 15.1954 16.6763 14.7523 16.7962C14.3089 16.9162 13.8097 17.0063 13.2545 17.0662C13.7609 17.5154 14.0142 18.2245 14.0142 19.1931V22.3536C14.0142 22.5331 14.0751 22.683 14.197 22.8028C14.3187 22.9223 14.511 22.9576 14.7741 22.9074C17.0345 22.1387 18.8782 20.7531 20.3054 18.7507C21.7323 16.7486 22.4461 14.4944 22.4461 11.9875C22.4456 9.90087 21.9436 7.97625 20.9406 6.21364Z" fill="#DD2864"/>
    </svg>










                                </a>
                                <a href="http://twitter.com/OktaDev" class="social">
                                    


    <!-- Twitter icon -->
    <svg class="" width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M11.223 0.483887C5.02568 0.483887 0 5.50956 0 11.7069C0 17.9043 5.02568 22.93 11.223 22.93C17.4204 22.93 22.4461 17.9043 22.4461 11.7069C22.4461 5.50956 17.4204 0.483887 11.223 0.483887ZM16.3474 9.23442C16.3523 9.34488 16.3547 9.45585 16.3547 9.56734C16.3547 12.9713 13.7637 16.8965 9.02539 16.8967C7.57062 16.8967 6.21689 16.4703 5.07688 15.7395C5.27844 15.7633 5.4836 15.7752 5.69133 15.7752C6.8983 15.7752 8.00902 15.3635 8.89079 14.6725C7.76311 14.6516 6.81233 13.9068 6.48421 12.8833C6.64125 12.9134 6.80274 12.9298 6.96834 12.9298C7.20346 12.9298 7.43123 12.8981 7.64769 12.8391C6.46897 12.6031 5.58104 11.5614 5.58104 10.314C5.58104 10.3023 5.58104 10.2919 5.58138 10.2811C5.92851 10.4741 6.32547 10.5902 6.74811 10.6032C6.05643 10.1417 5.60176 9.35276 5.60176 8.459C5.60176 7.98704 5.72934 7.54487 5.9506 7.16418C7.22093 8.7229 9.11941 9.748 11.2604 9.85572C11.2162 9.667 11.1934 9.47041 11.1934 9.26833C11.1934 7.84627 12.3471 6.69256 13.7697 6.69256C14.5107 6.69256 15.18 7.00578 15.65 7.50651C16.2369 7.39075 16.788 7.17634 17.2858 6.88128C17.0932 7.48254 16.6849 7.98704 16.153 8.30608C16.6741 8.24374 17.1707 8.10554 17.6323 7.90039C17.2875 8.41705 16.8503 8.87086 16.3474 9.23442Z" fill="#DD2864"/>
    </svg>








                                </a>
                                <a href="https://www.youtube.com/channel/UC5AMiWqFVFxF1q9Ya1FuZ_Q/featured" class="social">
                                    





    <!-- Youtube icon -->
    <svg class="" width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M9.35156 13.8143L13.0376 11.6913L9.35156 9.56836V13.8143Z" fill="#DD2864"/>
        <path d="M11.223 0.484375C5.02568 0.484375 0 5.51005 0 11.7074C0 17.9048 5.02568 22.9305 11.223 22.9305C17.4204 22.9305 22.4461 17.9048 22.4461 11.7074C22.4461 5.51005 17.4204 0.484375 11.223 0.484375ZM18.2357 11.7189C18.2357 11.7189 18.2357 13.995 17.947 15.0925C17.7852 15.6933 17.3115 16.1669 16.7108 16.3286C15.6132 16.6175 11.223 16.6175 11.223 16.6175C11.223 16.6175 6.84435 16.6175 5.73534 16.3171C5.13459 16.1555 4.66091 15.6816 4.49908 15.0809C4.21018 13.995 4.21018 11.7074 4.21018 11.7074C4.21018 11.7074 4.21018 9.43151 4.49908 8.33397C4.66074 7.73322 5.14607 7.2479 5.73534 7.08624C6.83288 6.79734 11.223 6.79734 11.223 6.79734C11.223 6.79734 15.6132 6.79734 16.7108 7.09771C17.3115 7.25937 17.7852 7.73322 17.947 8.33397C18.2474 9.43151 18.2357 11.7189 18.2357 11.7189Z" fill="#DD2864"/>
    </svg>





                                </a>
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="menu-item">
                    <a href="https://developer.okta.com/pricing/" class="nav-link">Pricing</a>
                </li>
                <li class="menu-item">
                    <a href="https://login.okta.com/" class="nav-link" target="_blank" rel="noopener noreferrer">Admin Console</a>
                </li>
                <li class="menu-item">
                    <a href="#" class="nav-link" target="_blank" rel="noopener noreferrer">Guides</a>
                </li>
                <li class="menu-item">
                    <a href="#" class="nav-link" target="_blank" rel="noopener noreferrer">Concept</a>
                </li>
                <li class="menu-item">
                    <a href="#" class="nav-link" target="_blank" rel="noopener noreferrer">Reference</a>
                </li>
                <li class="menu-item">
                    <a href="#" class="nav-link" target="_blank" rel="noopener noreferrer">Languages & SDKs</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<!-- START Promo banner -->





<!-- END Promo banner -->

	<div class="page-content">
		
		

<section class="Blog is-single">
  <div class="Blog-social"><a href="https://github.com/rdegges" target="_blank"><i class="fa fa-github"></i></a><a href="https://twitter.com/rdegges" target="_blank"><i class="fa fa-twitter"></i></a><a href="https://www.rdegges.com" target="_blank"><i class="fa fa-external-link"></i></a></div>
  

<article class="BlogPost">

    <header class="BlogPost-header">

        <time class="BlogPost-date" datetime="2018-06-20">June 20, 2018</time>
        <h1 class="BlogPost-title">
            
            What Happens If Your JWT Is Stolen?
            
        </h1>
        <div class="BlogPost-attribution">
            
            <a href="/blog/authors/randall-degges/"><img src="https://d33wubrfki0l68.cloudfront.net/0c518106404053632aa012eccc795c458593e704/73ffb/assets-jekyll/avatar-rdegges-f10ebb56de914b1b153c3c14d3058a8969ef84d06eebacfa7b92759a62550686.jpg" alt="avatar-rdegges.jpg" class="BlogPost-avatar"></a>
            
            <span class="BlogPost-author"><a href="/blog/authors/randall-degges/">Randall Degges</a></span>
        </div>
    </header>

    <div class="BlogPost-content">
        
        
  <p><img src="https://d33wubrfki0l68.cloudfront.net/746c5467430de460750e7fc19963f462d120e018/b1f80/assets-jekyll/blog/what-happens-if-your-jwt-is-stolen/stolen-jwt-e0fbf1b4e58f692decd4f046ac66f1daca94a369bfa6375e7837509e15317c43.png" alt="Stolen JWT" width="700" class="center-image" /></p>

<p>All of us know what happens if our user credentials (email and password) are discovered by an attacker: they can log into our account and wreak havoc. But a lot of modern applications are using JSON Web Tokens (JWTs) to manage user sessions—what happens if a JWT is compromised? Because more and more applications are using token-based authentication, this question is increasingly relevant to developers and critical to understand if you’re building any sort of application that uses token-based authentication.</p>

<p>To help explain the concepts fully, I’ll walk you through what tokens are, how they’re used, and what happens when they’re stolen. Finally: I’ll cover what you should actually do if your token has been stolen, and how to prevent this in the future.</p>

<p>This post was inspired by this <a href="https://stackoverflow.com/questions/34259248/what-if-jwt-is-stolen">StackOverflow question</a>. My response to that question has become one of my most popular responses on StackOverflow to date!</p>

<h2 id="what-is-a-token">What is a Token?</h2>

<p><img src="https://d33wubrfki0l68.cloudfront.net/881a2a014649fbd7389a1be766894120aeedf0aa/8aae3/assets-jekyll/blog/what-happens-if-your-jwt-is-stolen/shrug-1ad78de3fb2a4efbec8eb87a486bb48914454a642a4fb4d3d55dfe83db8a3d93.jpg" alt="Shrug" width="600" class="center-image" /></p>

<p>A token in the context of web development is nothing more than an arbitrary value that represents a session. Tokens can be strings like “abc123” or randomly generated IDs like “48ff796e-8c8a-46b9-9f25-f883c14734ea”.</p>

<p>A token’s purpose is to help a server remember who somebody is. Take API services, for example: if you have an API key that lets you talk to an API service from your server-side application, that API key is what the API service uses to “remember” who you are, look up your account details, and allow (or disallow) you from making a request. In this example, your API key is your “token”, and it allows you to access the API.</p>

<p>However, when most people talk about tokens today, they’re actually referring to JWTs (for better or <a href="https://developer.okta.com/blog/2017/08/17/why-jwts-suck-as-session-tokens">worse</a>).</p>

<h2 id="what-is-a-json-web-token-jwt">What is a JSON Web Token (JWT)?</h2>

<p><img src="https://d33wubrfki0l68.cloudfront.net/73ef9c28948508cb7cb90136e35b411e1db3fb1d/f004f/assets-jekyll/blog/what-happens-if-your-jwt-is-stolen/jwt-890a72bad09ee9b30b9b81eda836f648c30daf3dc74ddede12da2829d79b3567.png" alt="JSON Web Token" width="300" class="center-image" /></p>

<p><a href="https://tools.ietf.org/html/rfc7519">JSON Web Tokens</a> are special types of tokens that are structured in such a way that makes them convenient to use over the web. They have a handful of defining traits:</p>

<ul>
  <li><strong>They are represented as normal strings.</strong> Here’s a real JWT:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlJhbmRhbGwgRGVnZ2VzIiwiaWF0IjoxNTE2MjM5MDIyfQ.sNMELyC8ohN8WF_WRnRtdHMItOVizcscPiWsQJX9hmw
</code></pre></div>    </div>
    <p>Because JWTs are just URL safe strings, they’re easy to pass around via URL parameters, etc.</p>
  </li>
  <li><strong>They contain JSON-encoded data.</strong> This means you can have your JWT store as much JSON data as you want, and you can decode your token string into a JSON object. This makes them convenient for embedding information.</li>
  <li><strong>They’re cryptographically signed.</strong> Understanding how this works is a <a href="https://en.wikipedia.org/wiki/Digital_signature">topic unto itself</a>. For now, just know that it means any trusted party who has a JWT can tell whether or not the token has been modified or changed. This means if your application or API service generates a token that says someone is a “free” user and someone later alters the token to say they are an “admin” user, you’ll be able to detect this and act accordingly. This property makes JWTs useful for sharing information between parties over the web where trust is difficult to come by.</li>
</ul>

<p>Here’s a small code snippet which creates and validates a JWT in JavaScript using the <a href="https://github.com/jwtk/njwt">njwt</a> library. This example is purely here to show you at a glance how to create a JWT, embed some JSON data in it, and validate it.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">njwt</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">njwt</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">secureRandom</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">secure-random</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// This is a "secret key" that the creator of the JWT must keep private.</span>
<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">secureRandom</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Buffer</span><span class="dl">"</span> <span class="p">});</span>

<span class="c1">// This is the JSON data embedded in the token.</span>
<span class="kd">var</span> <span class="nx">claims</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">iss</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://api.com</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">sub</span><span class="p">:</span> <span class="dl">"</span><span class="s2">someuserid</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">scope</span><span class="p">:</span> <span class="dl">"</span><span class="s2">freeUser</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">favoriteColor</span><span class="p">:</span> <span class="dl">"</span><span class="s2">black</span><span class="dl">"</span>
<span class="p">};</span>

<span class="c1">// Create a JWT</span>
<span class="kd">var</span> <span class="nx">jwt</span> <span class="o">=</span> <span class="nx">njwt</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">claims</span><span class="p">,</span> <span class="nx">key</span><span class="p">);</span>

<span class="c1">// Log the JWT</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jwt</span><span class="p">);</span>
<span class="c1">// Jwt {</span>
<span class="c1">//  header: JwtHeader { typ: 'JWT', alg: 'HS256' },</span>
<span class="c1">//  body:</span>
<span class="c1">//   JwtBody {</span>
<span class="c1">//     iss: 'https://api.com',</span>
<span class="c1">//     sub: 'someuserid',</span>
<span class="c1">//     scope: 'freeUser',</span>
<span class="c1">//     favoriteColor: 'black',</span>
<span class="c1">//     jti: '903c5447-ebfd-43e8-8f4d-b7cc5922f5ec',</span>
<span class="c1">//     iat: 1528824349,</span>
<span class="c1">//     exp: 1528827949 },</span>
<span class="c1">//  signingKey: &lt;Buffer 9c e9 48 a7 b3 c9 87 be 5f 59 90 a5 08 02 9b 98 5c 5e 1c 29 3f b0 33 c5 8c c8 f9 c8 3e 35 f0 7c 20 a0 aa 65 cc 98 47 b6 31 c5 5c d6 4e 6e 25 29 2b d3 ... &gt; }</span>

<span class="c1">// The JWT in compacted form (ready for sending over the network)</span>
<span class="kd">var</span> <span class="nx">token</span> <span class="o">=</span>  <span class="nx">jwt</span><span class="p">.</span><span class="nx">compact</span><span class="p">();</span>

<span class="c1">// Log the compacted JWT</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jwt</span><span class="p">.</span><span class="nx">compact</span><span class="p">());</span>
<span class="c1">// eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwczovL2FwaS5jb20iLCJzdWIiOiJzb21ldXNlcmlkIiwic2NvcGUiOiJmcmVlVXNlciIsImZhdm9yaXRlQ29sb3IiOiJibGFjayIsImp0aSI6IjkwM2M1NDQ3LWViZmQtNDNlOC04ZjRkLWI3Y2M1OTIyZjVlYyIsImlhdCI6MTUyODgyNDM0OSwiZXhwIjoxNTI4ODI3OTQ5fQ.y7ad-nUsHAkI8a5bixYnr_v0vStRqnzsT4bbWGAM2vw</span>

<span class="c1">// Verify the JWT using the secret key</span>
<span class="nx">njwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">verifiedJwt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">The JWT has been verified and can be trusted!</span><span class="dl">"</span><span class="p">);</span>
  <span class="c1">// The JWT has been verified and can be trusted!</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="how-are-json-web-tokens-used">How are JSON Web Tokens Used?</h2>

<p><img src="https://d33wubrfki0l68.cloudfront.net/59d97976e0dd43ebbbc25c16e981eff8f252b3a7/c6482/assets-jekyll/blog/what-happens-if-your-jwt-is-stolen/how-are-jwts-used-916bd87556468089f02086c3900c8f30db0e48231272a374e7537b6eeca80338.jpg" alt="How are JSON Web Tokens used?" width="400" class="center-image" /></p>

<p>JWTs are typically used as session identifiers for web applications, mobile applications, and API services. But, unlike traditional session identifiers which act as nothing more than a pointer to actual user data on the server-side, JWTs typically contain user data directly.</p>

<p>The principal reason JWTs have become popular in recent years (having only been around since 2014) is that they can contain arbitrary JSON data. The touted benefit of a JWT over a traditional session ID is that:</p>

<ul>
  <li>JWTs are stateless and can contain user data directly</li>
  <li>Because JWTs are stateless, no server-side session needs to be implemented (no session database, session cache, etc.)</li>
</ul>

<p>Because JWTs are stateless, when a server-side application receives a JWT, it can validate it using only the “secret key” that was used to create it — thereby avoiding the performance penalty of talking to a database or cache on the backend, which adds latency to each request.</p>

<p>With that said, let’s take a look at how a JWT would typically be used in a modern web application.</p>

<ol>
  <li>A client (a browser or mobile client, typically) will visit some sort of login page</li>
  <li>The client will send their credentials to the server-side application</li>
  <li>The server-side application will validate the user’s credentials, typically an email address and password, then generate a JWT that contains the user’s information. The information embedded in the JWT will typically be:</li>
  <li>The user’s first and last name</li>
  <li>The user’s email address or username</li>
  <li>The user’s ID (for server-side lookups, if necessary)</li>
  <li>The user’s permissions (what are they allowed to do?)</li>
  <li>Any other data that is relevant to the application being used</li>
  <li>The server-side application will return this token to the client</li>
  <li>The client will then store this token so that it can be used to identify itself in the future. For web applications, this might mean the client stores the token in <a href="https://www.rdegges.com/2018/please-stop-using-local-storage/">HTML5 Local Storage</a>. For server-side API clients, this might mean storing the token on disk or in a secret store.</li>
  <li>When the client makes requests to the server in the future, it will embed the JWT in the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization">HTTP Authorization header</a> to identify itself</li>
  <li>When the server-side application receives a new incoming request, it will check to see if an HTTP Authorization header exists, and if so, it will parse out the token and validate it using the “secret key”</li>
  <li>Finally, the server-side application will process the request if the token is valid and the cycle will be complete</li>
</ol>

<p>In short: JWTs are used to identify a client. They are keys to the kingdom as far as the client is concerned.</p>

<h2 id="what-happens-if-your-json-web-token-is-stolen">What Happens if Your JSON Web Token is Stolen?</h2>

<p><img src="https://d33wubrfki0l68.cloudfront.net/b7ca59371dc33a3217c1ef36cddaed04b6a11020/d4361/assets-jekyll/blog/what-happens-if-your-jwt-is-stolen/angry-rage-face-d4aaf0a3fc43525ac85c9b65d5073158ed27d429fa8718a2ac5a3b5fb28520c4.png" alt="Angry Rage Face" width="200" class="center-image" /></p>

<p>In short: it’s bad, <em>real bad</em>.</p>

<p>Because JWTs are used to identify the client, if one is stolen or compromised, an attacker has full access to the user’s account in the same way they would if the attacker had instead compromised the user’s username and password.</p>

<p>For instance, if an attacker gets ahold of your JWT, they could start sending requests to the server identifying themselves as you and do things like make service changes, user account updates, etc. Once an attacker has your JWT it is game over.</p>

<p><strong>BUT</strong>, there is one thing that makes a stolen JWT slightly less bad than a stolen username and password: <em>timing</em>. Because JWTs can be configured to automatically expire after a set amount of time (a minute, an hour, a day, whatever), attackers can only use your JWT to access the service until it expires.</p>

<p>In theory, that sounds great, right? One of the ways token authentication is said to make authentication more “secure” is via short-lived tokens. That’s one of the core reasons token-based authentication has really taken off in recent years: you can automatically expire tokens and mitigate the risk of relying on forever-cached “stateless” tokens.</p>

<p>In the security world, after all, relying on cached data to make sensitive decisions like who can log into a service and what they can do is considered a bad thing. Because tokens are stateless and allow for some speed improvements over traditional session authentication, the only way in which they can remain somewhat “secure” is by limiting their lifespan so they don’t cause too much harm when compromised.</p>

<p>The only problem here is that if an attacker was able to steal your token in the first place, they’re likely able to do it once you get a new token as well. The most common ways this happens is by man-in-the-middling (MITM) your connection or getting access to the client or server directly. And unfortunately, in these scenarios, even the shortest-lived JWTs won’t help you at all.</p>

<p>In general, tokens should be treated like passwords and protected as such. They should never be publicly shared and should be kept in secure data stores. For browser-based applications, this means never storing your tokens in <a href="https://www.rdegges.com/2018/please-stop-using-local-storage/">HTML5 Local Storage</a> and instead storing tokens in server-side cookies that are not accessible to JavaScript.</p>

<p>In general, token-based authentication does not provide any additional security over typical session-based authentication relying on opaque session identifiers. While there are certainly a good number of use cases for token-based authentication, knowing how the technology works and where your weak spots are is essential.</p>

<p>Another interesting thing to consider is that <strong>in some cases, a stolen JWT can actually be <em>worse</em> than a stolen username and password</strong>.</p>

<p>Let’s pretend, for a moment, that your username and password have been compromised. In this scenario, if the app you’re logging into is protected with multi-factor authentication, an attacker needs to bypass additional identity proofing mechanisms in order to gain access to your account.</p>

<p>While guessing or brute-forcing a username and password is a very realistic scenario, being able to compromise a user’s mutli-factor authentication setup can be quite difficult. Bypassing factors like app-based authorization, SMS verification, face ID, touch ID, etc., is a significantly more challenging than guessing a user’s password.</p>

<p>Because of this, <em>a compromised JWT can actually be a greater security risk than a compromised username and password</em>. Imagine the scenario above where the app a user logs into is protected by multi-factor authentication. Once the user logs in and verifies themselves via multi-factor, they are assigned a JWT to prove who they are. If that JWT is stolen, the attacker no longer needs to bypass MFA directly (like they would have to if they only had the user’s username and password)—they can now directly make requests as the user without additional identity proofing. Quite a big risk.</p>

<h2 id="what-to-do-if-your-jwt-is-stolen">What to Do if Your JWT is Stolen</h2>

<p><img src="https://d33wubrfki0l68.cloudfront.net/88bde691a2075abc4465bd754a039c042b192225/1755f/assets-jekyll/blog/what-happens-if-your-jwt-is-stolen/what-do-i-do-d0f98ce43a73a34edca20f7d7f2a3f84bf2a1a47bb06e5fbb0d69b2b8b5762fa.jpg" alt="My JWT was stolen, what do I do?" width="300" class="center-image" /></p>

<p>Once a JWT has been stolen, you’ll be in a bad situation: an attacker can now impersonate a client and access your service without the client’s consent. But, even though you’re in a bad situation, you’ve still got to make the most out of it.</p>

<p>Here are a number of steps to take if a client’s token has been stolen. These recommendations are not suitable for every type of app, but should provide you with some good ideas to help you recover from this security incident:</p>

<ul>
  <li><strong>Revoke compromised tokens immediately.</strong> If you’re using a revocation list on your server to invalidate tokens, revoking a token can instantly boot the attacker out of your system until they get hold of a new token. While it is a temporary solution, it will make the attacker’s life slightly more difficult.</li>
  <li><strong>Force your client to change their password immediately.</strong> In the context of a web or mobile app, force your user to reset their password immediately, preferably through some sort of multi-factor authentication flow like the ones <a href="https://www.okta.com/products/adaptive-multi-factor-authentication/">Okta provides</a>. Forcing a user to change their password can potentially keep attackers out of their account in the event that an attacker tries to use a compromised token to modify user login credentials. By requiring multi-factor authentication, you can have more confidence that the user resetting their credentials is who they say they are and not an attacker.</li>
  <li><strong>Inspect the client’s environment.</strong> Was the user’s phone stolen so an attacker has access to their pre-authenticated mobile app? Was the client accessing your service from a compromised device like a mobile phone or infected computer? Discovering how the attacker got a hold of the token is the only way to fully understand what went wrong.</li>
  <li><strong>Inspect your server-side environment.</strong> Was an attacker able to compromise the token from your end? If so, this might involve a lot more work to fix, but the earlier you get started the better.</li>
</ul>

<p>Once you’ve gone through these steps, you should hopefully have a better understanding of how the token was compromised and what needs to be done to prevent it from happening in the future.</p>

<h2 id="how-to-detect-token-compromise">How to Detect Token Compromise</h2>

<p><img src="https://d33wubrfki0l68.cloudfront.net/8a9011695cc160a30d9b5485382a54d3c8fcf4f8/3f651/assets-jekyll/blog/what-happens-if-your-jwt-is-stolen/magnifying-glass-53d11122ddbf27f5802a7ebbe5dab660a03e2764f14db9c28a4cfb9a4048b71a.jpg" alt="Magnifying glass" width="200" class="center-image" /></p>

<p>When token compromise does happen, it can cause major problems. Particularly if you (as a service provider) aren’t able to quickly detect that an attacker has compromised a client’s token.</p>

<p>What if you were able to automatically identify when a token was compromised? That would dramatically improve your service’s security, as you could proactively prevent suspicious requests from being fulfilled, thereby protecting your service and your users.</p>

<p>While not easy, this is absolutely possible. Modern machine learning toolkits like <a href="https://www.tensorflow.org/">TensorFlow</a> allow you to build functional (although complex) pipelines to detect unusual patterns and proactively take charge of the situation.</p>

<p>For example, you could use machine learning to detect unusual client locations. Let’s say you run a website, and your user has logged in from San Francisco and has been making requests for several hours. If you notice that requests start coming from a different geographical region a short time later, you can immediately prevent those requests from being fulfilled, revoke the tokens, and reach out to the user to reset their password, etc.</p>

<p>In a similar manner, you could use machine learning to detect unusual client behavior. If a token is compromised, it’s likely that an attacker will take steps to abuse your service in some way. If you have a user who typically makes five requests per minute on your site, but all of a sudden you notice a massive uptick where the user is making 50+ requests per minute, that might be a good indicator that an attacker has gotten a hold of a user’s token, so you can revoke the tokens and reach out to the user to reset their password.</p>

<p>Pattern detection and recognition through machine learning is a fantastic, modern way to handle some of these more complicated problems.</p>

<p>This is precisely what we do here at <a href="https://developer.okta.com/">Okta</a> — we run an <a href="https://developer.okta.com/signup/">API service</a> that allows you to store user accounts in our service, and we provide developer libraries to handle things like authentication, authorization, social login, single sign-on, multi-factor authentication, etc. When users log into apps powered by Okta, we analyze a number of data points to detect if an account has been compromised, prompt for multi-factor authentication, perform user outreach, etc.</p>

<p>There’s a lot of complexity involved in being proactive about your security, but it’s far better to be prepared than unprepared.</p>

<p><strong>Shameless Plug</strong>: If you haven’t checked out our API service, it’s free to use and really fun! You can create an account here: <a href="https://developer.okta.com/signup/">https://developer.okta.com/signup/</a>. And… If you do happen to give it a go, I’d love to hear your thoughts, so please <a href="mailto:randall.degges@okta.com">hit me up</a> with any feedback about Okta, token authentication, or JSON Web Tokens. And finally, please <a href="https://twitter.com/oktadev">follow @oktadev Twitter</a> — we tweet about a lot of interesting security related topics like this.</p>

<p>Happy hacking,</p>

<p>-Randall</p>

<p><strong>PS</strong>: Since writing this article, we’ve built a new <a href="https://sec.okta.com/">security site</a> where we’re writing about all sorts of in-depth security topics. If that sounds interesting, please check it out.</p>

</div>

    
        <div class="BlogPost-author-bio">
            <div class="BlogPost-attribution">
                
                <a href="/blog/authors/randall-degges/"><img src="https://d33wubrfki0l68.cloudfront.net/0c518106404053632aa012eccc795c458593e704/73ffb/assets-jekyll/avatar-rdegges-f10ebb56de914b1b153c3c14d3058a8969ef84d06eebacfa7b92759a62550686.jpg" alt="avatar-rdegges.jpg" class="BlogPost-avatar"></a>
                
                <span class="BlogPost-author"><a href="/blog/authors/randall-degges/">Randall Degges</a></span>
            </div>

            <p>Randall Degges runs Evangelism at Okta where he works on security research, development, and education. In his spare time, Randall <a href='https://www.rdegges.com'>writes articles</a> and <a href='https://speakerdeck.com/rdegges'>gives talks</a> advocating for security best practices. Randall also builds and contributes to various open-source security tools. <p>Randall's realm of expertise include Python, JavaScript, and Go development, web security, cryptography, and infrastructure security. Randall has been writing software for ~20 years and has built some of the most-used API services on the internet.</p>
        </div>
    

    
    <div id="disqus">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_title = "What Happens If Your JWT Is Stolen?";
            var disqus_url = 'https://developer.okta.com/blog/2018/06/20/what-happens-if-your-jwt-is-stolen';

            (function () {
                var dsq = document.createElement('script');
                dsq.async = true;
                dsq.type = 'text/javascript';
                dsq.src = '//oktadevblog.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
          </script>
          <noscript>
              Please enable JavaScript to view the
              <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus</a>.
         </noscript>
    </div>
    
</article>

</section>

<script>
  // NOTE: The eventData object is being used by Google Tag Manager to fire off
  // custom events that track which type of content was being viewed so we can
  // track content on a more fine-grained level.
  //
  // This data is all anonymized (obviously) and contains no sensitive data.
  var eventData = {};

  
    eventData.type = 'awareness';
  

  
    eventData.by = 'advocate';
  

  eventData.communities = [];
  
    eventData.communities.push('security');
  
</script>

		
	</div>
	<footer class="footer">
    <div class="row first-row">
        <p><i>Need support?</i> Ask on the <a href="https://devforum.okta.com/" class="anchor-highlight">forum.</a></p>
    </div>
    <div class="row flex-justify">
        <div class="column social-links">
            <h4 class="column-header">Social</h4>
            <ul class="footer-links footer-links--social">
                <li><a class="footer-link github" target="_blank" rel="noopener noreferrer" href="http://github.com/oktadev">GitHub</a></li>
                <li><a class="footer-link twitter" target="_blank" rel="noopener noreferrer" href="http://twitter.com/OktaDev">Twitter</a></li>
                <li><a class="footer-link youtube" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/oktadev">YouTube</a></li>
                <li><a class="footer-link forum" target="_blank" rel="noopener noreferrer" href="https://devforum.okta.com/">Forum</a></li>
                <li><a class="footer-link rss" target="_blank" rel="noopener noreferrer" href="https://developer.okta.com/feed.xml">Blog RSS</a></li>
            </ul>
        </div>

        <div class="social-links-small-only">
            <ul class="footer-links footer-links--social">
                <li><a class="footer-link github" target="_blank" rel="noopener noreferrer" href="http://github.com/oktadev"></a></li>
                <li><a class="footer-link twitter" target="_blank" rel="noopener noreferrer" href="http://twitter.com/OktaDev"></a></li>
                <li><a class="footer-link youtube" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/oktadev"></a></li>
                <li><a class="footer-link forum" target="_blank" rel="noopener noreferrer" href="https://devforum.okta.com/"></a></li>
                <li><a class="footer-link rss" target="_blank" rel="noopener noreferrer" href="https://developer.okta.com/feed.xml"></a></li>
            </ul>
        </div>

        <div class="column contact-links">
            <h4 class="column-header">Contact & Legal</h4>
            <ul class="footer-links">
                <li><a class="footer-link" href="https://www.okta.com/contact/">Contact our team</a></li>
                <li><a class="footer-link" href="https://www.okta.com/contact-sales/">Contact sales</a></li>
                <li><a class="footer-link" href="https://developer.okta.com/terms/">Terms & conditions</a></li>
                <li><a class="footer-link" href="https://www.okta.com/privacy-policy/">Privacy policy</a></li>
            </ul>
        </div>

        <div class="column info-links">
            <h4 class="column-header">More Info</h4>
            <ul class="footer-links">
                <li><a class="footer-link" href="/pricing/">Pricing</a></li>
                <li><a class="footer-link" target="_blank" rel="noopener noreferrer" href="https://developer.okta.com/okta-integration-network/">Integrate with Okta</a></li>
                <li><a class="footer-link" href="/docs/change-log/">Change Log</a></li>
                <li><a class="footer-link" href="/3rd_party_notices/">3rd-party notes</a></li>
                <li><a class="footer-link" target="_blank" rel="noopener noreferrer" href="https://auth0.com/developers/">Auth0 platform</a></li>
            </ul>
        </div>

        <div class="column external-links">
            <div class="external-url">
                <a class="anchor-highlight secondary-font small bold new-tab" href="http://www.okta.com/" target="_blank" rel="noopener noreferrer">OKTA.COM</a>
                <p>Products, case studies, resources</p>
            </div>
            <div class="external-url">
                <a class="anchor-highlight secondary-font small bold new-tab" href="http://help.okta.com/" target="_blank" rel="noopener noreferrer">HELP CENTER</a>
                <p>Knowledgebase, roadmaps, and more</p>
            </div>
            <div class="external-url">
                <a class="anchor-highlight secondary-font small bold new-tab" href="http://trust.okta.com/" target="_blank" rel="noopener noreferrer">TRUST</a>
                <p>System status, security, compliance</p>
            </div>
        </div>

        <div class="column copyright">
            <p>Copyright © 2021 Okta.</p>
        </div>
    </div>
</footer>

    <script type="text/javascript" src="/assets-jekyll/master-d89184dd2780ebbeacd00092fb900176edd5a8879b330c035b13638e869d0db9.js"></script>
    <script type="text/javascript" src="/assets-jekyll/navigation-51d545a94f4873fd3e8d3c70529c90238c4120fe81cb8770c841bd1c6c32b973.js"></script>

    <!-- Coveo -->
    <script src="https://www.okta.com/sites/all/modules/okta_coveo_search_developer/js/lib/CoveoJsSearch.Lazy.min.js"></script>
    <script src="https://www.okta.com/sites/all/modules/okta_coveo_search_developer/js/okta_coveo_search_developer.js"></script>

    
    
    
    
      <script type="text/javascript" src="/assets-jekyll/blog-6e32dad27404131cc8630a5282264bed2ab4c08c91ac86fa496b75c53aa4f681.js"></script>
    
    <!-- Fix <details> for IE/Edge -->
    <script src="//cdn.jsdelivr.net/npm/details-polyfill@1/index.min.js" async></script>

  <!-- START Post Footer -->
  
  <!-- START Google Tag Manager -->
  <!-- https://support.google.com/tagmanager/answer/6103696?hl=en -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- END Google Tag Manager -->
  <!-- END Post Footer -->
</body>
</html>
