<!doctype html><html lang="en"><head><script defer src="https://cdn.optimizely.com/js/16180790160.js"></script><title data-rh="true">VBA Stomping — Advanced Maldoc Techniques | by Carrie Roberts | Walmart Global Tech Blog | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-04-11T17:13:42.190Z"/><meta data-rh="true" name="title" content="VBA Stomping — Advanced Maldoc Techniques | by Carrie Roberts | Walmart Global Tech Blog | Medium"/><meta data-rh="true" property="og:title" content="VBA Stomping — Advanced Maldoc Techniques"/><meta data-rh="true" property="twitter:title" content="VBA Stomping — Advanced Maldoc Techniques"/><meta data-rh="true" name="twitter:site" content="@walmarttech"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/612c484ab278"/><meta data-rh="true" property="al:android:url" content="medium://p/612c484ab278"/><meta data-rh="true" property="al:ios:url" content="medium://p/612c484ab278"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="There are powerful malicious document (maldoc) generation techniques that are effective at bypassing anti-virus detection. A technique which we refer to as VBA stomping was originally brought to our…"/><meta data-rh="true" property="og:description" content="Authors: Kirk Sayre (@bigmacjpg), Harold Ogden (@haroldogden) and Carrie Roberts (@OrOneEqualsOne)"/><meta data-rh="true" property="twitter:description" content="Authors: Kirk Sayre (@bigmacjpg), Harold Ogden (@haroldogden) and Carrie Roberts (@OrOneEqualsOne)"/><meta data-rh="true" property="og:url" content="https://medium.com/walmartglobaltech/vba-stomping-advanced-maldoc-techniques-612c484ab278"/><meta data-rh="true" property="al:web:url" content="https://medium.com/walmartglobaltech/vba-stomping-advanced-maldoc-techniques-612c484ab278"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/624/1*15XLHrfFRP4PcFoTSX1GCA.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/624/1*15XLHrfFRP4PcFoTSX1GCA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@clr2of8"/><meta data-rh="true" name="author" content="Carrie Roberts"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="8 min read"/><meta data-rh="true" name="parsely-post-id" content="612c484ab278"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" rel="preconnect" href="https://logx.optimizely.com"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@clr2of8"/><link data-rh="true" rel="canonical" href="https://medium.com/walmartglobaltech/vba-stomping-advanced-maldoc-techniques-612c484ab278"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/612c484ab278"/><link data-rh="true" rel="icon" href="https://miro.medium.com/1*m-R_BkNf1Qjr1YbyOIJY2w.png"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*15XLHrfFRP4PcFoTSX1GCA.png"],"url":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech\u002Fvba-stomping-advanced-maldoc-techniques-612c484ab278","dateCreated":"2018-10-05T21:57:39.506Z","datePublished":"2018-10-05T21:57:39.506Z","dateModified":"2020-04-11T18:55:15.676Z","headline":"VBA Stomping — Advanced Maldoc Techniques - Walmart Global Tech Blog - Medium","name":"VBA Stomping — Advanced Maldoc Techniques - Walmart Global Tech Blog - Medium","description":"There are powerful malicious document (maldoc) generation techniques that are effective at bypassing anti-virus detection. A technique which we refer to as VBA stomping was originally brought to our…","identifier":"612c484ab278","keywords":["Lite:true","Tag:Maldoc","Tag:Infosec","Publication:walmartglobaltech","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:4"],"author":{"@type":"Person","name":"Carrie Roberts","url":"https:\u002F\u002Fmedium.com\u002F@clr2of8"},"creator":["Carrie Roberts"],"publisher":{"@type":"Organization","name":"Walmart Global Tech Blog","url":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech","logo":{"@type":"ImageObject","width":325,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F650\u002F1*8BhtOzg5TgZmRkRbzP05Jw.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech\u002Fvba-stomping-advanced-maldoc-techniques-612c484ab278"}</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="505" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:25px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{position:absolute}.u{top:0}.v{left:0}.w{right:0}.x{z-index:500}.y{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ah{max-width:1192px}.ai{min-width:0}.aj{width:100%}.ak{height:65px}.an{flex:1 0 auto}.ao{fill:rgba(25, 25, 25, 1)}.ap{flex:0 0 auto}.aq{border-top:1px solid rgba(230, 230, 230, 1)}.as{height:54px}.at{overflow:hidden}.au{margin-right:40px}.av{height:36px}.aw{width:196px}.ax{overflow:auto}.ay{flex:0 1 auto}.az{list-style-type:none}.ba{margin:0}.bb{line-height:40px}.bc{white-space:nowrap}.bd{overflow-x:auto}.be{align-items:flex-start}.bf{margin-top:20px}.bg{padding-top:20px}.bh{height:80px}.bi{height:20px}.bj{margin-right:15px}.bk{margin-left:15px}.bl:first-child{margin-left:0}.bm{min-width:1px}.bn{background-color:rgba(168, 168, 168, 1)}.bo{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bp{font-size:13px}.bq{line-height:20px}.br{color:rgba(117, 117, 117, 1)}.bs{text-transform:uppercase}.bt{letter-spacing:1px}.bu{color:inherit}.bv{fill:inherit}.bw{font-size:inherit}.bx{border:inherit}.by{font-family:inherit}.bz{letter-spacing:inherit}.ca{font-weight:inherit}.cb{padding:0}.cf:disabled{cursor:default}.cg:disabled{color:rgba(117, 117, 117, 1)}.ch:disabled{fill:rgba(117, 117, 117, 1)}.ci{margin-bottom:0px}.cj{margin-top:0px}.ck{height:119px}.cn{padding-left:24px}.co{padding-right:24px}.cp{margin-left:auto}.cq{margin-right:auto}.cr{max-width:728px}.cs{box-sizing:border-box}.ct{background:rgba(255, 255, 255, 1)}.cu{border:1px solid rgba(230, 230, 230, 1)}.cv{border-radius:4px}.cw{box-shadow:0 1px 4px rgba(230, 230, 230, 1)}.cx{max-height:100vh}.cy{overflow-y:auto}.cz{top:calc(100vh + 100px)}.da{bottom:calc(100vh + 100px)}.db{width:10px}.dc{pointer-events:none}.dd{word-break:break-word}.de{word-wrap:break-word}.df:after{display:block}.dg:after{content:""}.dh:after{clear:both}.di{max-width:680px}.dj{line-height:1.23}.dk{letter-spacing:0}.dl{font-style:normal}.dm{font-family:fell, Georgia, Cambria, "Times New Roman", Times, serif}.eh{margin-bottom:-0.27em}.ei{color:rgba(41, 41, 41, 1)}.ej{margin-top:32px}.ek{justify-content:space-between}.eo{border-radius:50%}.ep{height:48px}.eq{width:48px}.er{margin-left:12px}.es{font-size:14px}.et{margin-bottom:2px}.ev{max-height:20px}.ew{text-overflow:ellipsis}.ex{display:-webkit-box}.ey{-webkit-line-clamp:1}.ez{-webkit-box-orient:vertical}.fc{margin-left:8px}.fd{color:rgba(255, 255, 255, 1)}.fe{padding:0px 8px 1px}.ff{fill:rgba(255, 255, 255, 1)}.fg{background:rgba(26, 137, 23, 1)}.fh{border-color:rgba(26, 137, 23, 1)}.fk:disabled{cursor:inherit}.fl:disabled{opacity:0.3}.fm:disabled:hover{background:rgba(26, 137, 23, 1)}.fn:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fo{border-radius:99em}.fp{border-width:1px}.fq{border-style:solid}.fr{display:inline-block}.fs{text-decoration:none}.ft{align-items:flex-end}.gb{padding-right:6px}.gc{fill:rgba(117, 117, 117, 1)}.gd{margin-right:8px}.ge{line-height:1.58}.gf{letter-spacing:-0.004em}.gg{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.hb{margin-bottom:-0.46em}.hc{text-decoration:underline}.hd{line-height:1.12}.he{letter-spacing:-0.022em}.hf{font-weight:500}.hy{margin-bottom:-0.28em}.ie{font-style:italic}.if{max-width:352px}.il{clear:both}.im{opacity:0}.in{transition:opacity 100ms 400ms}.io{height:100%}.ip{will-change:transform}.iq{transform:translateZ(0)}.ir{margin:auto}.is{position:relative}.it{background-color:rgba(242, 242, 242, 1)}.iu{padding-bottom:46.02272727272727%}.iv{height:0}.iw{filter:blur(20px)}.ix{transform:scale(1.1)}.iy{visibility:visible}.iz{max-width:617px}.jb{cursor:zoom-in}.jc{z-index:auto}.je{padding-bottom:34.52188006482982%}.jf{max-width:613px}.jg{padding-bottom:34.58401305057097%}.jh{font-weight:700}.ji{max-width:624px}.jj{padding-bottom:22.756410256410255%}.jk{padding-bottom:28.846153846153847%}.jl{max-width:513px}.jm{padding-bottom:78.55750487329435%}.jn{max-width:572px}.jo{padding-bottom:50%}.jp{max-width:441px}.jq{padding-bottom:50.11337868480726%}.jr{padding-bottom:27.243589743589745%}.js{max-width:623px}.jt{padding-bottom:25.20064205457464%}.ju{padding-bottom:49.42903752039151%}.jv{max-width:950px}.jw{padding-bottom:24.210526315789476%}.jx{padding-bottom:70.1923076923077%}.jy{padding-bottom:38.782051282051285%}.jz{max-width:461px}.ka{padding-bottom:75.05422993492408%}.kb{padding-bottom:59.29487179487179%}.kc{will-change:opacity}.kd{position:fixed}.ke{width:188px}.kf{left:50%}.kg{transform:translateX(406px)}.kh{top:calc(65px + 54px + 14px)}.kk{will-change:opacity, transform}.kl{transform:translateY(159px)}.kn{width:131px}.ko{flex-direction:column}.kp{font-size:16px}.kq{padding-bottom:28px}.kr{border-bottom:1px solid rgba(230, 230, 230, 1)}.ks{padding-bottom:20px}.kt{padding-top:2px}.ku{max-height:120px}.kv{-webkit-line-clamp:6}.kw{padding-top:28px}.kx{margin-bottom:19px}.ky{margin-left:-3px}.le{outline:0}.lf{border:0}.lg{user-select:none}.lh{cursor:pointer}.li> svg{pointer-events:none}.lk{-webkit-user-select:none}.lu button{text-align:left}.lv{opacity:1}.lw{padding-right:9px}.lx{flex-direction:row}.mg{margin-top:40px}.mh{flex-wrap:wrap}.mi{margin-top:25px}.mj{margin-bottom:8px}.mk{line-height:22px}.ml{border-radius:3px}.mm{padding:5px 10px}.mn{background:rgba(242, 242, 242, 1)}.mo{max-width:155px}.ms{top:1px}.na{margin-left:-1px}.nj{padding-right:8px}.nk{padding-top:32px}.nl{margin-bottom:25px}.nn{margin-bottom:32px}.no{min-height:80px}.nt{width:80px}.nu{padding-left:102px}.nv{margin-bottom:6px}.nx{font-size:22px}.ny{line-height:28px}.nz{max-width:550px}.oa{max-width:450px}.ob{line-height:24px}.oc{display:none}.oe{padding-top:24px}.of{margin-top:5px}.og{height:40px}.oh{width:40px}.oi{font-size:12px}.oj{line-height:16px}.ok{letter-spacing:0.083em}.ol{padding-top:8px}.om{margin-bottom:40px}.on{margin-top:24px}.oo{padding-bottom:16px}.op{margin-bottom:24px}.ql{flex-grow:0}.qm{padding-bottom:24px}.qn{max-width:500px}.qr{padding-bottom:8px}.re{padding-bottom:100%}.rp{padding:60px 0}.rq{background-color:rgba(0, 0, 0, 0.9)}.rs{padding-bottom:48px}.rt{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.ru{margin:0 -12px}.rv{margin:0 12px}.rw{flex:1 1 0}.rz:disabled{color:rgba(255, 255, 255, 0.7)}.sa:disabled{fill:rgba(255, 255, 255, 0.7)}.sb{font-size:20px}.sc{color:rgba(255, 255, 255, 0.98)}.sd{color:rgba(255, 255, 255, 0.7)}.se{height:22px}.sf{width:200px}.sl{margin-right:16px}.cc:hover{cursor:pointer}.cd:hover{color:rgba(25, 25, 25, 1)}.ce:hover{fill:rgba(25, 25, 25, 1)}.fb:hover{text-decoration:underline}.fi:hover{background:rgba(15, 115, 12, 1)}.fj:hover{border-color:rgba(15, 115, 12, 1)}.lm:hover{fill:rgba(117, 117, 117, 1)}.rx:hover{color:rgba(255, 255, 255, 0.99)}.ry:hover{fill:rgba(255, 255, 255, 0.99)}.jd:focus{transform:scale(1.01)}.ll:focus{fill:rgba(117, 117, 117, 1)}.lj:active{border-style:none}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ag{margin:0 64px}.ed{font-size:48px}.ee{margin-top:0.55em}.ef{line-height:60px}.eg{letter-spacing:-0.011em}.ga{margin-left:30px}.gx{font-size:21px}.gy{margin-top:2em}.gz{line-height:32px}.ha{letter-spacing:-0.003em}.hu{font-size:30px}.hv{margin-top:1.95em}.hw{line-height:36px}.hx{letter-spacing:0}.id{margin-top:0.86em}.ik{margin-top:56px}.ld{margin-right:5px}.lt{margin-top:5px}.mf{padding-left:6px}.mu{display:inline-block}.mz{width:8px}.nh{padding-left:7px}.ni{top:3px}.pa{font-size:22px}.pb{line-height:28px}.po{width:calc(100% + 32px)}.pp{margin-left:-16px}.pq{margin-right:-16px}.qh{padding-left:16px}.qi{padding-right:16px}.qj{flex-basis:25%}.qk{max-width:25%}.ra{font-size:16px}.rb{line-height:20px}.rn{min-width:70px}.ro{min-height:70px}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.fz{margin-left:30px}.lc{margin-right:5px}.ls{margin-top:5px}.me{padding-left:6px}.mt{display:inline-block}.my{width:8px}.nf{padding-left:7px}.ng{top:3px}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.fy{margin-left:30px}.lb{margin-right:5px}.lr{margin-top:5px}.mc{padding-left:6px}.md{top:3px}.mr{display:inline-block}.mx{width:8px}.ne{padding-left:3px}.qq{margin-right:16px}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.al{height:56px}.am{display:flex}.ar{display:block}.cl{margin-bottom:0px}.cm{height:110px}.em{margin-top:32px}.en{flex-direction:column-reverse}.fw{margin-bottom:30px}.fx{margin-left:0px}.la{margin-left:8px}.lp{margin-top:2px}.lq{margin-right:8px}.ma{padding-left:6px}.mb{top:3px}.mq{display:inline-block}.mw{width:8px}.nb{margin-left:-4px}.nd{padding-left:3px}.nm{padding-top:0}.np{margin-bottom:24px}.nq{align-items:center}.nr{width:102px}.ns{position:relative}.nw{padding-left:0}.od{margin-top:24px}.oq{padding-bottom:12px}.or{margin-top:16px}.qp{margin-right:16px}.rc{margin-left:16px}.rd{margin-right:0px}.rr{padding:32px 0}.sg{width:140px}.sh{margin-bottom:16px}.si{margin-top:30px}.sj{width:100%}.sk{flex-direction:row}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ab{margin:0 24px}.dn{font-size:34px}.do{margin-top:0.56em}.dp{line-height:42px}.dq{letter-spacing:-0.016em}.el{margin-top:32px}.eu{margin-bottom:0px}.fu{margin-bottom:30px}.fv{margin-left:0px}.gh{font-size:18px}.gi{margin-top:1.56em}.gj{line-height:28px}.gk{letter-spacing:-0.003em}.hg{font-size:22px}.hh{margin-top:1.2em}.hi{letter-spacing:0}.hz{margin-top:0.67em}.ig{margin-top:40px}.kz{margin-left:8px}.ln{margin-top:2px}.lo{margin-right:8px}.ly{padding-left:6px}.lz{top:3px}.mp{display:inline-block}.mv{width:8px}.nc{padding-left:3px}.os{font-size:20px}.ot{line-height:24px}.pc{width:calc(100% + 24px)}.pd{margin-left:-12px}.pe{margin-right:-12px}.pr{padding-left:12px}.ps{padding-right:12px}.pt{flex-basis:100%}.pu{max-width:100%}.qo{margin-right:16px}.qs{font-size:16px}.qt{line-height:20px}.rf{min-width:48px}.rg{min-height:48px}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.af{margin:0 64px}.dz{font-size:48px}.ea{margin-top:0.55em}.eb{line-height:60px}.ec{letter-spacing:-0.011em}.gt{font-size:21px}.gu{margin-top:2em}.gv{line-height:32px}.gw{letter-spacing:-0.003em}.hq{font-size:30px}.hr{margin-top:1.95em}.hs{line-height:36px}.ht{letter-spacing:0}.ic{margin-top:0.86em}.ij{margin-top:56px}.oy{font-size:22px}.oz{line-height:28px}.pl{width:calc(100% + 32px)}.pm{margin-left:-16px}.pn{margin-right:-16px}.qd{padding-left:16px}.qe{padding-right:16px}.qf{flex-basis:25%}.qg{max-width:25%}.qy{font-size:16px}.qz{line-height:20px}.rl{min-width:70px}.rm{min-height:70px}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.ae{margin:0 48px}.dv{font-size:48px}.dw{margin-top:0.55em}.dx{line-height:60px}.dy{letter-spacing:-0.011em}.gp{font-size:21px}.gq{margin-top:2em}.gr{line-height:32px}.gs{letter-spacing:-0.003em}.hm{font-size:30px}.hn{margin-top:1.95em}.ho{line-height:36px}.hp{letter-spacing:0}.ib{margin-top:0.86em}.ii{margin-top:56px}.ow{font-size:22px}.ox{line-height:28px}.pi{width:calc(100% + 28px)}.pj{margin-left:-14px}.pk{margin-right:-14px}.pz{padding-left:14px}.qa{padding-right:14px}.qb{flex-basis:50%}.qc{max-width:50%}.qw{font-size:16px}.qx{line-height:20px}.rj{min-width:48px}.rk{min-height:48px}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ac{margin:0 24px}.dr{font-size:34px}.ds{margin-top:0.56em}.dt{line-height:42px}.du{letter-spacing:-0.016em}.gl{font-size:18px}.gm{margin-top:1.56em}.gn{line-height:28px}.go{letter-spacing:-0.003em}.hj{font-size:22px}.hk{margin-top:1.2em}.hl{letter-spacing:0}.ia{margin-top:0.67em}.ih{margin-top:40px}.ou{font-size:20px}.ov{line-height:24px}.pf{width:calc(100% + 24px)}.pg{margin-left:-12px}.ph{margin-right:-12px}.pv{padding-left:12px}.pw{padding-right:12px}.px{flex-basis:100%}.py{max-width:100%}.qu{font-size:16px}.qv{line-height:20px}.rh{min-width:48px}.ri{min-height:48px}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="print">.z{display:none}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.fa{max-height:none}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ja{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.ki{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (max-width: 1230px)">.kj{display:none}</style><style type="text/css" data-fela-rehydration="505" data-fela-type="RULE" media="all and (max-width: 1198px)">.km{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="s"><nav class="s t u v w c x y z"><div><div class="s c"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="ak n o al am"><div class="n o an x"><a href="https://medium.com/?source=post_page-----612c484ab278--------------------------------" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="q ao"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div><div class="s ap x"></div></div></div></div></div><div class="aq s c ar"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="as at n o"><div class="au s ap"><a href="/walmartglobaltech?source=post_page-----612c484ab278--------------------------------" rel="noopener"><div class="av aw s"><img alt="Walmart Global Tech Blog" class="" src="https://miro.medium.com/max/392/1*8BhtOzg5TgZmRkRbzP05Jw.jpeg" width="196" height="36"/></div></a></div><div class="ax s ay"><ul class="az ba bb bc bd n be g bf bg bh"><li class="n o bi bj bk bl"><span class="bo b bp bq br bs bt"><a href="https://medium.com/walmartglobaltech/tagged/engineering?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener">Engineering</a></span></li><li class="n o bi bj bk bl"><span class="bo b bp bq br bs bt"><a href="https://medium.com/walmartglobaltech/tagged/data-science?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener">Data Science</a></span></li><li class="n o bi bj bk bl"><span class="bo b bp bq br bs bt"><a href="https://medium.com/walmartglobaltech/tagged/infosec?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener">InfoSec</a></span></li><li class="n o bi bj bk bl"><span class="bo b bp bq br bs bt"><a href="https://medium.com/walmartglobaltech/tagged/ux-design?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener">UX Design</a></span></li><li class="n o bi bj bk bl"><span class="bo b bp bq br bs bt"><a href="https://medium.com/walmartglobaltech/tagged/leadership?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener">Leadership</a></span></li><span class="bi bm bn"></span><li class="n o bi bj bk bl"><span class="bo b bp bq br bs bt"><a href="https://www.linkedin.com/company/walmartglobaltech/?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener nofollow">About </a></span></li></ul></div></div></div></div></div></div></nav><div class="ci cj ck s cl cm"></div><article><section class="cn co cp cq aj cr cs s"></section><span class="s"></span><div><div class="t v cz da db dc"></div><section class="dd de df dg dh"><div class="n p"><div class="ab ac ae af ag di ai aj"><div class=""><h1 id="d712" class="dj dk dl dm b dn do dp dq dr ds dt du dv dw dx dy dz ea eb ec ed ee ef eg eh ei">VBA Stomping — Advanced Maldoc Techniques</h1><div class="ej"><div class="n ek el em en"><div class="o n"><div><a rel="noopener" href="/@clr2of8?source=post_page-----612c484ab278--------------------------------"><img alt="Carrie Roberts" class="s eo ep eq" src="https://miro.medium.com/fit/c/96/96/0*XlMl43vEsM_t3qV_" width="48" height="48"/></a></div><div class="er aj s"><div class="n"><div style="flex:1"><span class="bo b es bq ei"><div class="et n o eu"><span class="bo b es bq at ev ew ex ey ez fa ei"><a class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener" href="/@clr2of8?source=post_page-----612c484ab278--------------------------------">Carrie Roberts</a></span><div class="fc s ap h"><span><button class="bo b bp bq fd fe ff fg fh fi fj cc fk fl fm fn fo fp fq cs fr fs">Follow</button></span></div></div></span></div></div><span class="bo b es bq br"><span class="bo b es bq at ev ew ex ey ez fa br"><div><a class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener" href="/walmartglobaltech/vba-stomping-advanced-maldoc-techniques-612c484ab278?source=post_page-----612c484ab278--------------------------------">Oct 5, 2018</a> <!-- -->·<!-- --> <!-- -->8<!-- --> min read</div></span></span></div></div><div class="n ft fu fv fw fx fy fz ga z"><div class="n o"><div class="gb s ap"><button class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" aria-label="Share on twitter"><svg width="29" height="29" class="gc"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gb s ap"><button class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gc"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gb s ap"><button class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" aria-label="Share on facebook"><svg width="29" height="29" class="gc"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="gd s"></div><div class="s an"></div></div></div></div></div></div><p id="1914" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">Authors: Kirk Sayre (<a href="https://twitter.com/bigmacjpg" class="bu hc" rel="noopener nofollow">@bigmacjpg</a>), Harold Ogden (<a href="https://twitter.com/haroldogden" class="bu hc" rel="noopener nofollow">@haroldogden</a>) and Carrie Roberts (<a href="https://twitter.com/OrOneEqualsOne" class="bu hc" rel="noopener nofollow">@OrOneEqualsOne</a>)</p><h1 id="e118" class="hd he dl bo hf hg hh gj hi hj hk gn hl hm hn ho hp hq hr hs ht hu hv hw hx hy ei">Introduction</h1><p id="7a43" class="ge gf dl gg b gh hz gj gk gl ia gn go gp ib gr gs gt ic gv gw gx id gz ha hb dd ei">There are powerful malicious document (maldoc) generation techniques that are effective at bypassing anti-virus detection. A technique which we refer to as <em class="ie">VBA stomping</em> was originally brought to our attention by Dr. Vesselin Bontchev (see <a href="https://github.com/bontchev/pcodedmp" class="bu hc" rel="noopener nofollow">here</a>). VBA stomping refers to destroying the VBA source code in a Microsoft Office document, leaving only a compiled version of the macro code known as p-code in the document file. Maldoc detection based only on the VBA source code fails in this scenario. In this blog post we will demonstrate detailed examples of VBA stomping as well as introduce some additional techniques.</p><h1 id="66cc" class="hd he dl bo hf hg hh gj hi hj hk gn hl hm hn ho hp hq hr hs ht hu hv hw hx hy ei">VBA Stomping</h1><p id="abf5" class="ge gf dl gg b gh hz gj gk gl ia gn go gp ib gr gs gt ic gv gw gx id gz ha hb dd ei">First, we will demonstrate VBA stomping on a simple, non-malicious macro. This document simply displays a message box with the text “ABC” when the document is opened. The VBA source code and resulting message box is shown below.</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq if"><div class="ir s is it"><div class="iu iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*P_mM0Ffo9kzzhtMM1O7oCg.png?q=20" width="352" height="162" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="352" height="162" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/704/1*P_mM0Ffo9kzzhtMM1O7oCg.png" width="352" height="162" srcSet="https://miro.medium.com/max/552/1*P_mM0Ffo9kzzhtMM1O7oCg.png 276w, https://miro.medium.com/max/704/1*P_mM0Ffo9kzzhtMM1O7oCg.png 352w" sizes="352px" role="presentation"/></noscript></div></div></div></figure><p id="d441" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">Now we are interested in modifying the VBA source code shown above, while leaving the intermediate p-code unchanged. For the purposes of this blog post we will concentrate on the current .docx/.xlsx/.docm/.xlsm (Office 2007+) format. However, the techniques discussed here can easily be applied to the older .doc/.xls format. In Office 2007+ files the VBA source code and p-code is typically located in a file called vbaProject.bin. Note that this is the default filename but it can be renamed. To manually modify this file, we need to first unzip the compressed .docm/.xlsm file and then open vbaProject.bin file in a hex editor. In this example, we will change “ABC” to “XYZ”, but only within the VBA source code storage location, not the p-code section. The VBA source code is stored in a compressed form which explains the unprintable or odd characters you see in the following image.</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div role="button" tabindex="0" class="ja jb is jc aj jd"><div class="cp cq iz"><div class="ir s is it"><div class="je iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*KGc1XphbyNT5Dws5W8lOPQ.png?q=20" width="617" height="213" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="617" height="213" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1234/1*KGc1XphbyNT5Dws5W8lOPQ.png" width="617" height="213" srcSet="https://miro.medium.com/max/552/1*KGc1XphbyNT5Dws5W8lOPQ.png 276w, https://miro.medium.com/max/1104/1*KGc1XphbyNT5Dws5W8lOPQ.png 552w, https://miro.medium.com/max/1234/1*KGc1XphbyNT5Dws5W8lOPQ.png 617w" sizes="617px" role="presentation"/></noscript></div></div></div></div></figure><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq jf"><div class="ir s is it"><div class="jg iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*iHWUB-LOeGuw_8K02Gixpg.png?q=20" width="613" height="212" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="613" height="212" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1226/1*iHWUB-LOeGuw_8K02Gixpg.png" width="613" height="212" srcSet="https://miro.medium.com/max/552/1*iHWUB-LOeGuw_8K02Gixpg.png 276w, https://miro.medium.com/max/1104/1*iHWUB-LOeGuw_8K02Gixpg.png 552w, https://miro.medium.com/max/1226/1*iHWUB-LOeGuw_8K02Gixpg.png 613w" sizes="613px" role="presentation"/></noscript></div></div></div></figure><p id="0fc1" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">Now that we have manually edited the VBA source to change “ABC” to “XYZ”, we will open the document and inspect the VBA source code <strong class="gg jh"><em class="ie">BEFORE</em></strong> the “Enable Content” button is clicked.</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq ji"><div class="ir s is it"><div class="jj iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*jqYto7TMBR3MUZPqzdhogw.png?q=20" width="624" height="142" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="624" height="142" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1248/1*jqYto7TMBR3MUZPqzdhogw.png" width="624" height="142" srcSet="https://miro.medium.com/max/552/1*jqYto7TMBR3MUZPqzdhogw.png 276w, https://miro.medium.com/max/1104/1*jqYto7TMBR3MUZPqzdhogw.png 552w, https://miro.medium.com/max/1248/1*jqYto7TMBR3MUZPqzdhogw.png 624w" sizes="624px" role="presentation"/></noscript></div></div></div></figure><p id="92dc" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">The document has been opened but macros are not enabled. Inspecting the macro in the code editor indicates that a message box with the text “XYZ” will be displayed but this is not the case. In fact, as soon as the content is enabled, a message box showing “ABC” is displayed and the source code in the code editor is updated to match!</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq ji"><div class="ir s is it"><div class="jk iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*VE19x2i45U7r6FXDxov1UA.png?q=20" width="624" height="180" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="624" height="180" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1248/1*VE19x2i45U7r6FXDxov1UA.png" width="624" height="180" srcSet="https://miro.medium.com/max/552/1*VE19x2i45U7r6FXDxov1UA.png 276w, https://miro.medium.com/max/1104/1*VE19x2i45U7r6FXDxov1UA.png 552w, https://miro.medium.com/max/1248/1*VE19x2i45U7r6FXDxov1UA.png 624w" sizes="624px" role="presentation"/></noscript></div></div></div></figure><p id="b8d7" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">Well, that surely was misleading. The source code said that “XYZ” was going to be displayed in the message box but instead “ABC” was displayed. What is going on?</p><p id="256b" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">As Dr. Bontchev explains, the p-code stored in the document is what actually executes, as long as it is compatible with the current VBA version on the system. In addition, what gets displayed in the macro editor (once content is enabled) is not the decompressed VBA source, but instead it is the decompiled p-code. Interesting!</p><p id="609a" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">If we open the document in a different version of Word (which uses a different VBA version) the p-code will not be reusable. This will force the VBA source code to be decompressed and recompiled to p-code, resulting in the display of “XYZ” in the message box. So now we have a single document, which on one version of Office displays “ABC”, but on another version displays “XYZ”.</p><p id="a386" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">Note that this is an important caveat. <strong class="gg jh">A VBA stomped maldoc can only be executed using the same VBA version used to create the document.</strong> This limitation can be addressed by doing reconnaissance on a target prior to maldoc generation to determine the appropriate Office version to use or by generating maldocs with multiple Office versions and spraying them against the target.</p><p id="9913" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">What is the effect of VBA stomping from a defensive standpoint? Maldoc detection is often based solely on the VBA source. Even many of the tools available for analyzing documents fail to identify the discrepancy between the VBA source and the p-code. The analysis of the tampered document by the <a href="https://github.com/decalage2/oletools/wiki/olevba" class="bu hc" rel="noopener nofollow">olevba script</a>, by Philippe Lagadec, shows the decompressed source only and lacks the p-code detail.</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq jl"><div class="ir s is it"><div class="jm iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*TIq1-TyPn5gxopcr88-U9A.png?q=20" width="513" height="403" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="513" height="403" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1026/1*TIq1-TyPn5gxopcr88-U9A.png" width="513" height="403" srcSet="https://miro.medium.com/max/552/1*TIq1-TyPn5gxopcr88-U9A.png 276w, https://miro.medium.com/max/1026/1*TIq1-TyPn5gxopcr88-U9A.png 513w" sizes="513px" role="presentation"/></noscript></div></div></div></figure><p id="5d23" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">The Python script <a href="https://blog.didierstevens.com/programs/oledump-py/" class="bu hc" rel="noopener nofollow">oledump.py</a>, by Didier Stevens, gives similar results unless run with the p-code dumper plugin. The output in this case gives some indication that the p-code will result in a message box display of “ABC” as shown in the image below.</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq jn"><div class="ir s is it"><div class="jo iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*ZmBHbwFxuqbZB9JZzN4yrw.png?q=20" width="572" height="286" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="572" height="286" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1144/1*ZmBHbwFxuqbZB9JZzN4yrw.png" width="572" height="286" srcSet="https://miro.medium.com/max/552/1*ZmBHbwFxuqbZB9JZzN4yrw.png 276w, https://miro.medium.com/max/1104/1*ZmBHbwFxuqbZB9JZzN4yrw.png 552w, https://miro.medium.com/max/1144/1*ZmBHbwFxuqbZB9JZzN4yrw.png 572w" sizes="572px" role="presentation"/></noscript></div></div></div></figure><p id="d998" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">Dr. Bontchev released a Python script called <a href="https://github.com/bontchev/pcodedmp" class="bu hc" rel="noopener nofollow">pcodedmp.py</a> for displaying p-code as shown in the image below. The output has the added benefit of showing operation names instead of op-codes as above.</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq jp"><div class="ir s is it"><div class="jq iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*1jU7iSKRyTb93EK5WfIZ3Q.png?q=20" width="441" height="221" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="441" height="221" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/882/1*1jU7iSKRyTb93EK5WfIZ3Q.png" width="441" height="221" srcSet="https://miro.medium.com/max/552/1*1jU7iSKRyTb93EK5WfIZ3Q.png 276w, https://miro.medium.com/max/882/1*1jU7iSKRyTb93EK5WfIZ3Q.png 441w" sizes="441px" role="presentation"/></noscript></div></div></div></figure><p id="9225" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">Instead of just modifying the VBA source code, we could completely wipe it out (“stomp” it) by overwriting it with zero’s or random bytes. The following screenshot shows how to do this manually in a hex editor.</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq ji"><div class="ir s is it"><div class="jr iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*xCsSmTV9k0qFMjUWfQDWuQ.png?q=20" width="624" height="170" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="624" height="170" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1248/1*xCsSmTV9k0qFMjUWfQDWuQ.png" width="624" height="170" srcSet="https://miro.medium.com/max/552/1*xCsSmTV9k0qFMjUWfQDWuQ.png 276w, https://miro.medium.com/max/1104/1*xCsSmTV9k0qFMjUWfQDWuQ.png 552w, https://miro.medium.com/max/1248/1*xCsSmTV9k0qFMjUWfQDWuQ.png 624w" sizes="624px" role="presentation"/></noscript></div></div></div></figure><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq js"><div class="ir s is it"><div class="jt iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*XLiGHjipu6lk7JU8rNxzXw.png?q=20" width="623" height="157" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="623" height="157" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1246/1*XLiGHjipu6lk7JU8rNxzXw.png" width="623" height="157" srcSet="https://miro.medium.com/max/552/1*XLiGHjipu6lk7JU8rNxzXw.png 276w, https://miro.medium.com/max/1104/1*XLiGHjipu6lk7JU8rNxzXw.png 552w, https://miro.medium.com/max/1246/1*XLiGHjipu6lk7JU8rNxzXw.png 623w" sizes="623px" role="presentation"/></noscript></div></div></div></figure><p id="0089" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">The result in this case is a VBA editor that shows no macro code at all, yet the message box with the text “ABC” still appears after enabling content. Now we re-run olevba on this file and no VBA source code is displayed and the statement “No suspicious keyword or IOC found” is displayed instead of the table that previously highlighted our use of a suspicious keyword (AutoOpen).</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq jf"><div class="ir s is it"><div class="ju iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*3t0jKe01yE0ydhE2pFXvxA.png?q=20" width="613" height="303" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="613" height="303" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1226/1*3t0jKe01yE0ydhE2pFXvxA.png" width="613" height="303" srcSet="https://miro.medium.com/max/552/1*3t0jKe01yE0ydhE2pFXvxA.png 276w, https://miro.medium.com/max/1104/1*3t0jKe01yE0ydhE2pFXvxA.png 552w, https://miro.medium.com/max/1226/1*3t0jKe01yE0ydhE2pFXvxA.png 613w" sizes="613px" role="presentation"/></noscript></div></div></div></figure><h1 id="e0f3" class="hd he dl bo hf hg hh gj hi hj hk gn hl hm hn ho hp hq hr hs ht hu hv hw hx hy ei">How Big of a Problem Is This?</h1><p id="6622" class="ge gf dl gg b gh hz gj gk gl ia gn go gp ib gr gs gt ic gv gw gx id gz ha hb dd ei">We will now dive a little deeper into the how Office uses the compressed VBA source code and p-code. This will come into play later when we go over how to abuse Office functionality to easily modify maldocs to fool many AV scanners.</p><p id="bc4b" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">Office documents contain two places from which to pull the VBA, the compressed VBA source code and the p-code. The following table details which VBA data source is used when:</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div role="button" tabindex="0" class="ja jb is jc aj jd"><div class="cp cq jv"><div class="ir s is it"><div class="jw iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*Eh5SA794dEMFOlkqR8ThDQ.png?q=20" width="950" height="230" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="950" height="230" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1900/1*Eh5SA794dEMFOlkqR8ThDQ.png" width="950" height="230" srcSet="https://miro.medium.com/max/552/1*Eh5SA794dEMFOlkqR8ThDQ.png 276w, https://miro.medium.com/max/1104/1*Eh5SA794dEMFOlkqR8ThDQ.png 552w, https://miro.medium.com/max/1280/1*Eh5SA794dEMFOlkqR8ThDQ.png 640w, https://miro.medium.com/max/1400/1*Eh5SA794dEMFOlkqR8ThDQ.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="0607" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">From this table we see that if we have valid p-code, the compressed VBA source code is ignored when macros are enabled. All macro functionality is performed by running the p-code. As an attacker this tells us that we can completely ruin or modify the compressed VBA source code and still have our maldoc perform its desired task.</p><h1 id="afbf" class="hd he dl bo hf hg hh gj hi hj hk gn hl hm hn ho hp hq hr hs ht hu hv hw hx hy ei">Real World Example</h1><p id="e502" class="ge gf dl gg b gh hz gj gk gl ia gn go gp ib gr gs gt ic gv gw gx id gz ha hb dd ei">Showing that this works on a toy example is all well and good, but is this really a legitimate threat? Let’s take this to the next level by working with a known malicious document. In this case, we will start with a recent <a href="https://www.cyber.nj.gov/threat-profiles/trojan-variants/emotet" class="bu hc" rel="noopener nofollow">Emotet</a> maldoc that is currently detected as malicious by 36/59 vendors on Virus total.</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq ji"><div class="ir s is it"><div class="jx iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*vhePAlQl6xO7TLdXXW1mCg.png?q=20" width="624" height="438" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="624" height="438" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1248/1*vhePAlQl6xO7TLdXXW1mCg.png" width="624" height="438" srcSet="https://miro.medium.com/max/552/1*vhePAlQl6xO7TLdXXW1mCg.png 276w, https://miro.medium.com/max/1104/1*vhePAlQl6xO7TLdXXW1mCg.png 552w, https://miro.medium.com/max/1248/1*vhePAlQl6xO7TLdXXW1mCg.png 624w" sizes="624px" role="presentation"/></noscript></div></div></div></figure><p id="40f1" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">If we take this document and simply stomp the VBA source code as described above, the detection rate goes down to 7 out of 58 anti-virus solutions!</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq ji"><div class="ir s is it"><div class="jy iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*15XLHrfFRP4PcFoTSX1GCA.png?q=20" width="624" height="242" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="624" height="242" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1248/1*15XLHrfFRP4PcFoTSX1GCA.png" width="624" height="242" srcSet="https://miro.medium.com/max/552/1*15XLHrfFRP4PcFoTSX1GCA.png 276w, https://miro.medium.com/max/1104/1*15XLHrfFRP4PcFoTSX1GCA.png 552w, https://miro.medium.com/max/1248/1*15XLHrfFRP4PcFoTSX1GCA.png 624w" sizes="624px" role="presentation"/></noscript></div></div></div></figure><p id="a6a5" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">As you can see, this creates a serious problem for network defenders. Even manual analysis of such documents could be problematic. The obvious question at this point is “<em class="ie">Can VBA stomping be performed automatically by a tool or do we always have to manually edit the Office document?</em>” The answer to this question is <strong class="gg jh"><em class="ie">yes, it certainly is possible to stomp VBA automatically</em></strong> with a tool. We have developed a POC utility to automatically stomp the compressed VBA source code in any Office document (this was used to VBA stomp the example Emotet document and no, we will not be releasing this utility). Given how easy it is to automate VBA stomping this is a real threat.</p><h1 id="b89d" class="hd he dl bo hf hg hh gj hi hj hk gn hl hm hn ho hp hq hr hs ht hu hv hw hx hy ei">Making It Worse</h1><p id="cb34" class="ge gf dl gg b gh hz gj gk gl ia gn go gp ib gr gs gt ic gv gw gx id gz ha hb dd ei">Consider the case where the maldoc is designed to close MS Word immediately after executing the malicious payload. In combination with VBA stomping, no offline VBA source extraction tools will display the VBA source and the VBA source will not even be displayed in the Office macro editor window until the macro is enabled. But enabling the macro causes Word to immediately exit without providing an opportunity to view the decompiled source. While we have shown that the “assembly-like” p-code is extractable, the p-code is difficult to interpret and cannot be analyzed in the VBA debugger. In addition, the pcode only runs on a specific VBA version. For these reasons, access to the VBA source code would be a great benefit to the analyst. But how can this be done for such a document?</p><p id="821e" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">After some experimentation, we determined a simple solution to stop MS Word from executing any method as soon as macros are enabled. Note that this solution works for Office 2007+ documents, additional research is being performed to address older document formats. The 2007+ solution is to delete the vbaData.xml file from the “word” directory of the .docm file as shown below (this is easily done with the 7-Zip program without having to manually unzip and re-zip the document).</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq jz"><div class="ir s is it"><div class="ka iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*j953lLi4vkji5nySs3YPeg.png?q=20" width="461" height="346" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="461" height="346" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/922/1*j953lLi4vkji5nySs3YPeg.png" width="461" height="346" srcSet="https://miro.medium.com/max/552/1*j953lLi4vkji5nySs3YPeg.png 276w, https://miro.medium.com/max/922/1*j953lLi4vkji5nySs3YPeg.png 461w" sizes="461px" role="presentation"/></noscript></div></div></div></figure><p id="bc36" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">The document can now be opened and the content can be enabled, resulting in the display of the decompiled p-code in the VBA code editor but no code execution. This could be a life saver in the event that the malware author has taken steps to prevent the analyst from having access to the VBA source code.</p><p id="d19e" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">An interesting side effect of erasing vbaData.xml is that it causes MS Word to erroneously list no Macros in the Macros dialog (see image below).</p><figure class="ig ih ii ij ik il cp cq paragraph-image"><div class="cp cq ji"><div class="ir s is it"><div class="kb iv s"><div class="im in t u v io aj at ip iq"><img alt="" class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*KIhYa2asfDGRAIWXERhXug.png?q=20" width="624" height="370" role="presentation"/></div><img alt="" class="im in t u v io aj c" width="624" height="370" role="presentation"/><noscript><img alt="" class="t u v io aj" src="https://miro.medium.com/max/1248/1*KIhYa2asfDGRAIWXERhXug.png" width="624" height="370" srcSet="https://miro.medium.com/max/552/1*KIhYa2asfDGRAIWXERhXug.png 276w, https://miro.medium.com/max/1104/1*KIhYa2asfDGRAIWXERhXug.png 552w, https://miro.medium.com/max/1248/1*KIhYa2asfDGRAIWXERhXug.png 624w" sizes="624px" role="presentation"/></noscript></div></div></div></figure><h1 id="7737" class="hd he dl bo hf hg hh gj hi hj hk gn hl hm hn ho hp hq hr hs ht hu hv hw hx hy ei">Detection</h1><p id="de2f" class="ge gf dl gg b gh hz gj gk gl ia gn go gp ib gr gs gt ic gv gw gx id gz ha hb dd ei">We have written an open source tool for detecting VBA stomping in Office documents called “VBA Seismograph”. This tool has been tested under Ubuntu 16.04 and detects differences between the declared function/variable names, string literals, and comment lines that appear in the compiled p-code and the VBA source code of an Office document. The tool is available at <a href="https://github.com/kirk-sayre-work/VBASeismograph" class="bu hc" rel="noopener nofollow">https://github.com/kirk-sayre-work/VBASeismograph</a>.</p><h1 id="f455" class="hd he dl bo hf hg hh gj hi hj hk gn hl hm hn ho hp hq hr hs ht hu hv hw hx hy ei">Conclusion</h1><p id="87fe" class="ge gf dl gg b gh hz gj gk gl ia gn go gp ib gr gs gt ic gv gw gx id gz ha hb dd ei">In this blog post we have demonstrated how the compressed VBA source code in an Office document can be modified or destroyed to defeat AV scanning solutions and make manual analysis of maldocs more difficult. Defense against this technique involves detecting and flagging documents with valid p-code but invalid or missing VBA source code, or more generally, checking for discrepancies between the compressed VBA source code and the decompiled p-code. At this point in time we are not aware of any commercial AV solutions that do this check, so this is a potential area where AV scanning solutions can improve.</p><p id="bea9" class="ge gf dl gg b gh gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb dd ei">See <a href="http://vbastomp.com" class="bu hc" rel="noopener nofollow">vbastomp.com</a> for the most up to date information on VBA stomping.</p></div></div></section></div></article><div class="im dc kd kk aj kl u ki km" data-test-id="post-sidebar"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="kn n ko"><div class="dc"><div><div class="kq kr s"><a href="/walmartglobaltech?source=post_sidebar--------------------------post_sidebar-----------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener"><h2 class="bo hf kp bq dk ei dd">Walmart Global Tech Blog</h2></a><div class="ks kt s"><p class="bo b es bq at ku ew ex kv ez fa br">We’re powering the next great retail disruption.</p></div></div><div class="kw kx ky n"><div class="n o"><div class="s is kz la lb lc ld"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fwalmartglobaltech%2F612c484ab278&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fwalmartglobaltech%2Fvba-stomping-advanced-maldoc-techniques-612c484ab278&amp;user=Carrie%20Roberts&amp;userId=90501148e467&amp;source=post_sidebar-----612c484ab278---------------------clap_sidebar-----------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener"><div class="cb le lf lg lh li lj lk r ll lm"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s ln lo lp lq lr ls lt"><div class="lu"><p class="bo b es bq br"><button class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch">191<!-- --> </button></p></div></div></div></div><div class="kx s"><button class="lh lf cb"><div class="lw n o lx"><svg width="25" height="25" class="r lv lh lm" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s is ly lz ma mb mc md me mf"><p class="bo b es bq br">1<!-- --> </p></div></div></button></div></div></div></div></div></div></div><div class="im dc kc kd ke kf kg kh ki kj"></div><div><div class="mg il n ko p"><div class="n p"><div class="ab ac ae af ag di ai aj"><div class="n mh"></div><div class="n o mh"></div><div class="mi s"><ul class="cb ba"><li class="fr az gd mj"><a href="https://medium.com/walmartglobaltech/tagged/maldoc" class="bo b bp mk br ml mm fs s mn">Maldoc</a></li><li class="fr az gd mj"><a href="https://medium.com/walmartglobaltech/tagged/infosec" class="bo b bp mk br ml mm fs s mn">Infosec</a></li></ul></div><div class="mi n ek z"><div class="n o lx"><div class="mo s"><span class="s mp mq mr e d"><div class="n o"><div class="s is kz la lb lc ld"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fwalmartglobaltech%2F612c484ab278&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fwalmartglobaltech%2Fvba-stomping-advanced-maldoc-techniques-612c484ab278&amp;user=Carrie%20Roberts&amp;userId=90501148e467&amp;source=post_actions_footer-----612c484ab278---------------------clap_footer-----------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener"><div class="cb le lf lg lh li lj lk r ll lm"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s ln lo lp lq lr ls lt"><div class="is ms lu"><p class="bo b es bq ei"><button class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch">191<span class="s h g f mt mu"> <!-- -->claps</span></button><span class="s h g f mt mu"></span></p></div></div></div></span><span class="s h g f mt mu"><div class="n o"><div class="s is kz la lb lc ld"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fwalmartglobaltech%2F612c484ab278&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fwalmartglobaltech%2Fvba-stomping-advanced-maldoc-techniques-612c484ab278&amp;user=Carrie%20Roberts&amp;userId=90501148e467&amp;source=post_actions_footer-----612c484ab278---------------------clap_footer-----------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener"><div class="cb le lf lg lh li lj lk r ll lm"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="s ln lo lp lq lr ls lt"><div class="lu"><p class="bo b es bq br"><button class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch">191<!-- --> </button></p></div></div></div></span></div><div class="s mv mw mx my mz"></div><button class="lh lf cb"><div class="lw n o lx"><span class="na s nb"><svg width="25" height="25" class="r lv lh lm" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span><div class="s is nc lz nd mb ne md nf ng nh ni"><p class="bo b es bq br">1<!-- --> </p></div></div></button></div><div class="n o"><div class="gb s ap"><button class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" aria-label="Share on twitter"><svg width="29" height="29" class="gc"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="gb s ap"><button class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="gc"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="gb s ap"><button class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" aria-label="Share on facebook"><svg width="29" height="29" class="gc"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="nj s ap"></div></div></div></div></div><div><div class="n p"><div class="ab ac ae af ag di ai aj"><div class="nk aq nl mi s nm z"><div class="s g"><div class="nk s"></div><div class="nn no s is"><span class="s np am nq"><div class="s t nr ns"><a href="/walmartglobaltech?source=follow_footer-------------------------------------" rel="noopener"><img alt="Walmart Global Tech Blog" class="cv nt bh" src="https://miro.medium.com/fit/c/160/160/1*quUoN1GMDA3fwyaPGdTYFQ.jpeg" width="80" height="80"/></a></div><span class="s"><div class="nu nv n nw"><div class="aj n o ek"><h2 class="bo hf nx ny dk ei"><a href="/walmartglobaltech?source=follow_footer-------------------------------------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener">Walmart Global Tech Blog</a></h2><div class="s g"></div></div></div></span></span><div class="nu nz s nw ar"><div class="oa s"><p class="bo b kp ob br">We’re powering the next great retail disruption. Learn more about us — https://www.linkedin.com/company/walmartglobaltech/</p></div><div class="oc od ar"></div></div></div></div><div class="oc ar"><div class="oe s"><div class="n lx"><div class="of s"><a rel="noopener" href="/@clr2of8?source=follow_footer-------------------------------------"><img alt="Carrie Roberts" class="s eo og oh" src="https://miro.medium.com/fit/c/80/80/0*XlMl43vEsM_t3qV_" width="40" height="40"/></a></div><div class="er s"><p class="bo b oi oj ok br bs">Written by</p><div class="n lx"><h2 class="bo hf kp bq dk ei"><a class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener" href="/@clr2of8?source=follow_footer-------------------------------------">Carrie Roberts</a></h2><div class="er s"><span><button class="bo b bp bq fd fe ff fg fh fi fj cc fk fl fm fn fo fp fq cs fr fs">Follow</button></span></div></div><div class="ol s"><p class="bo b es bq br">Developer turned Red Team . . . then Blue. SANS STI Grad. GSE Certification Holder. Dynamic Defense Engineer at Walmart.</p></div></div></div><div class="oe s"><div class="n lx"><a href="/walmartglobaltech?source=follow_footer-------------------------------------" rel="noopener"><img alt="Walmart Global Tech Blog" class="cv oh og" src="https://miro.medium.com/fit/c/80/80/1*quUoN1GMDA3fwyaPGdTYFQ.jpeg" width="40" height="40"/></a><div class="er s"><div class="n lx"><h2 class="bo hf kp bq dk ei"><a href="/walmartglobaltech?source=follow_footer-------------------------------------" class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch" rel="noopener">Walmart Global Tech Blog</a></h2><div class="er s"></div></div><div class="ol s"><p class="bo b es bq br">We’re powering the next great retail disruption. Learn more about us — https://www.linkedin.com/company/walmartglobaltech/</p></div></div></div></div></div></div></div></div></div><div class="s ct z"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="om on s"><div class="oo kr op on s oq or"><h2 class="bo hf os ot hi ou ov hl ow ox hp oy oz ht pa pb hx ei">More From Medium</h2></div><div class="be n lx mh pc pd pe pf pg ph pi pj pk pl pm pn po pp pq"><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="qm qn s"><div class="aj io"><div class="n ek"><div class="s ay qo qp qq"><div class="qr s"><h2 class="bo hf qs qt hi qu qv hl qw qx hp qy qz ht ra rb hx ei"><a rel="noopener" href="/swlh/tryhackme-internal-walkthrough-fdc6c4b569bd?source=post_internal_links---------0----------------------------">TryHackMe — Internal Walkthrough</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="bo b es bq ei"><div class="ci n o eu"><span class="bo b bp bq ei"><a href="https://0xaniket.medium.com/?source=post_internal_links---------0----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">Aniket Badami</a><span> <!-- -->in<!-- --> <a href="/swlh?source=post_internal_links---------0----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">The Startup</a></span></span></div></span></div></div></div></div></div><div class="er gd s rc rd"><a class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch s" rel="noopener" href="/swlh/tryhackme-internal-walkthrough-fdc6c4b569bd?source=post_internal_links---------0----------------------------"><div class="ir s is it"><div class="re iv s"><div class="im in t u v io aj at ip iq"><img class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*IS1pmlSGaNsUhzx5GCPDqA.png?q=20" width="70" height="70" role="presentation"/></div><img class="im in rf rg rh ri rj rk rl rm rn ro c" width="70" height="70" role="presentation"/><noscript><img class="rf rg rh ri rj rk rl rm rn ro" src="https://miro.medium.com/fit/c/140/140/1*IS1pmlSGaNsUhzx5GCPDqA.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*IS1pmlSGaNsUhzx5GCPDqA.png 48w, https://miro.medium.com/fit/c/140/140/1*IS1pmlSGaNsUhzx5GCPDqA.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="qm qn s"><div class="aj io"><div class="n ek"><div class="s ay qo qp qq"><div class="qr s"><h2 class="bo hf qs qt hi qu qv hl qw qx hp qy qz ht ra rb hx ei"><a rel="noopener" href="/pcmag-access/how-to-use-a-random-password-generator-fd8cf716b93e?source=post_internal_links---------1----------------------------">How to Use a Random Password Generator</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="bo b es bq ei"><div class="ci n o eu"><span class="bo b bp bq ei"><a href="https://pcmagazine.medium.com/?source=post_internal_links---------1----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">PCMag</a><span> <!-- -->in<!-- --> <a href="/pcmag-access?source=post_internal_links---------1----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">PC Magazine</a></span></span></div></span></div></div></div></div></div><div class="er gd s rc rd"><a class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch s" rel="noopener" href="/pcmag-access/how-to-use-a-random-password-generator-fd8cf716b93e?source=post_internal_links---------1----------------------------"><div class="ir s is it"><div class="re iv s"><div class="im in t u v io aj at ip iq"><img class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/0*cJu7ISRVgv6IpCl3?q=20" width="70" height="70" role="presentation"/></div><img class="im in rf rg rh ri rj rk rl rm rn ro c" width="70" height="70" role="presentation"/><noscript><img class="rf rg rh ri rj rk rl rm rn ro" src="https://miro.medium.com/fit/c/140/140/0*cJu7ISRVgv6IpCl3" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*cJu7ISRVgv6IpCl3 48w, https://miro.medium.com/fit/c/140/140/0*cJu7ISRVgv6IpCl3 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="qm qn s"><div class="aj io"><div class="n ek"><div class="s ay qo qp qq"><div class="qr s"><h2 class="bo hf qs qt hi qu qv hl qw qx hp qy qz ht ra rb hx ei"><a rel="noopener" href="/swlh/detecting-lateral-movement-data-analysis-fd6cecc6bff0?source=post_internal_links---------2----------------------------">Detecting Lateral Movement Data Analysis</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="bo b es bq ei"><div class="ci n o eu"><span class="bo b bp bq ei"><a href="https://ensarseker1.medium.com/?source=post_internal_links---------2----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">Ensar Seker</a><span> <!-- -->in<!-- --> <a href="/swlh?source=post_internal_links---------2----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">The Startup</a></span></span></div></span></div></div></div></div></div><div class="er gd s rc rd"><a class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch s" rel="noopener" href="/swlh/detecting-lateral-movement-data-analysis-fd6cecc6bff0?source=post_internal_links---------2----------------------------"><div class="ir s is it"><div class="re iv s"><div class="im in t u v io aj at ip iq"><img class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*Y_jB_va-Wn4zqMWv8CGbAw.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="im in rf rg rh ri rj rk rl rm rn ro c" width="70" height="70" role="presentation"/><noscript><img class="rf rg rh ri rj rk rl rm rn ro" src="https://miro.medium.com/fit/c/140/140/1*Y_jB_va-Wn4zqMWv8CGbAw.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*Y_jB_va-Wn4zqMWv8CGbAw.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*Y_jB_va-Wn4zqMWv8CGbAw.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="qm qn s"><div class="aj io"><div class="n ek"><div class="s ay qo qp qq"><div class="qr s"><h2 class="bo hf qs qt hi qu qv hl qw qx hp qy qz ht ra rb hx ei"><a rel="noopener" href="/swlh/is-netflix-changing-our-perception-of-cybersecurity-fcf76b49c2ba?source=post_internal_links---------3----------------------------">Is Netflix Changing Our Perception of Cybersecurity?</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="bo b es bq ei"><div class="ci n o eu"><span class="bo b bp bq ei"><a href="https://stephen-chapendama.medium.com/?source=post_internal_links---------3----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">Stephen Chapendama</a><span> <!-- -->in<!-- --> <a href="/swlh?source=post_internal_links---------3----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">The Startup</a></span></span></div></span></div></div></div></div></div><div class="er gd s rc rd"><a class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch s" rel="noopener" href="/swlh/is-netflix-changing-our-perception-of-cybersecurity-fcf76b49c2ba?source=post_internal_links---------3----------------------------"><div class="ir s is it"><div class="re iv s"><div class="im in t u v io aj at ip iq"><img class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/0*H_O-zVjwC_j7gzC1.jpg?q=20" width="70" height="70" role="presentation"/></div><img class="im in rf rg rh ri rj rk rl rm rn ro c" width="70" height="70" role="presentation"/><noscript><img class="rf rg rh ri rj rk rl rm rn ro" src="https://miro.medium.com/fit/c/140/140/0*H_O-zVjwC_j7gzC1.jpg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*H_O-zVjwC_j7gzC1.jpg 48w, https://miro.medium.com/fit/c/140/140/0*H_O-zVjwC_j7gzC1.jpg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="qm qn s"><div class="aj io"><div class="n ek"><div class="s ay qo qp qq"><div class="qr s"><h2 class="bo hf qs qt hi qu qv hl qw qx hp qy qz ht ra rb hx ei"><a rel="noopener" href="/wottsecurity/the-devsecops-iceberg-fd1518ea12cd?source=post_internal_links---------4----------------------------">The DevSecOps Iceberg</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="bo b es bq ei"><div class="ci n o eu"><span class="bo b bp bq ei"><a href="https://vpetersson.medium.com/?source=post_internal_links---------4----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">Viktor Petersson</a><span> <!-- -->in<!-- --> <a href="/wottsecurity?source=post_internal_links---------4----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">WoTTsecurity</a></span></span></div></span></div></div></div></div></div><div class="er gd s rc rd"><a class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch s" rel="noopener" href="/wottsecurity/the-devsecops-iceberg-fd1518ea12cd?source=post_internal_links---------4----------------------------"><div class="ir s is it"><div class="re iv s"><div class="im in t u v io aj at ip iq"><img class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/0*PH683lKBT0b3GwO3.png?q=20" width="70" height="70" role="presentation"/></div><img class="im in rf rg rh ri rj rk rl rm rn ro c" width="70" height="70" role="presentation"/><noscript><img class="rf rg rh ri rj rk rl rm rn ro" src="https://miro.medium.com/fit/c/140/140/0*PH683lKBT0b3GwO3.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*PH683lKBT0b3GwO3.png 48w, https://miro.medium.com/fit/c/140/140/0*PH683lKBT0b3GwO3.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="qm qn s"><div class="aj io"><div class="n ek"><div class="s ay qo qp qq"><div class="qr s"><h2 class="bo hf qs qt hi qu qv hl qw qx hp qy qz ht ra rb hx ei"><a rel="noopener" href="/@shayrapaport/web-3-0-reclaiming-our-online-selves-fdd49223e693?source=post_internal_links---------5----------------------------">Web 3.0: Reclaiming Our Online Selves</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="bo b es bq ei"><div class="ci n o eu"><span class="bo b bp bq ei"><a class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener" href="/@shayrapaport?source=post_internal_links---------5----------------------------">Shay Rapaport</a></span></div></span></div></div></div></div></div><div class="er gd s rc rd"><a class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch s" rel="noopener" href="/@shayrapaport/web-3-0-reclaiming-our-online-selves-fdd49223e693?source=post_internal_links---------5----------------------------"><div class="ir s is it"><div class="re iv s"><div class="im in t u v io aj at ip iq"><img class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*hn4v1tCaJy7cWMyb0bpNpQ.png?q=20" width="70" height="70" role="presentation"/></div><img class="im in rf rg rh ri rj rk rl rm rn ro c" width="70" height="70" role="presentation"/><noscript><img class="rf rg rh ri rj rk rl rm rn ro" src="https://miro.medium.com/fit/c/140/140/1*hn4v1tCaJy7cWMyb0bpNpQ.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*hn4v1tCaJy7cWMyb0bpNpQ.png 48w, https://miro.medium.com/fit/c/140/140/1*hn4v1tCaJy7cWMyb0bpNpQ.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="qm qn s"><div class="aj io"><div class="n ek"><div class="s ay qo qp qq"><div class="qr s"><h2 class="bo hf qs qt hi qu qv hl qw qx hp qy qz ht ra rb hx ei"><a rel="noopener" href="/mit-technology-review/for-safetys-sake-we-must-slow-innovation-in-internet-connected-things-fdb529ca76ab?source=post_internal_links---------6----------------------------">For Safety’s Sake, We Must Slow Innovation in Internet-Connected Things</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="bo b es bq ei"><div class="ci n o eu"><span class="bo b bp bq ei"><a class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener" href="/@MITTechReview?source=post_internal_links---------6----------------------------">MIT Technology Review</a><span> <!-- -->in<!-- --> <a href="/mit-technology-review?source=post_internal_links---------6----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">MIT Technology Review</a></span></span></div></span></div></div></div></div></div><div class="er gd s rc rd"><a class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch s" rel="noopener" href="/mit-technology-review/for-safetys-sake-we-must-slow-innovation-in-internet-connected-things-fdb529ca76ab?source=post_internal_links---------6----------------------------"><div class="ir s is it"><div class="re iv s"><div class="im in t u v io aj at ip iq"><img class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*EroijenwpLVmNHw6XOtaEw.png?q=20" width="70" height="70" role="presentation"/></div><img class="im in rf rg rh ri rj rk rl rm rn ro c" width="70" height="70" role="presentation"/><noscript><img class="rf rg rh ri rj rk rl rm rn ro" src="https://miro.medium.com/focal/140/140/51/30/1*EroijenwpLVmNHw6XOtaEw.png" width="70" height="70" srcSet="https://miro.medium.com/focal/96/140/51/30/1*EroijenwpLVmNHw6XOtaEw.png 48w, https://miro.medium.com/focal/140/140/51/30/1*EroijenwpLVmNHw6XOtaEw.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="pr ps pt pu pv pw px py pz qa qb qc qd qe qf qg qh qi qj qk ql"><div class="qm qn s"><div class="aj io"><div class="n ek"><div class="s ay qo qp qq"><div class="qr s"><h2 class="bo hf qs qt hi qu qv hl qw qx hp qy qz ht ra rb hx ei"><a rel="noopener" href="/purple-team/the-wolds-most-widely-used-web-app-scanner-owasp-zap-fe128bdcb85b?source=post_internal_links---------7----------------------------">The wold’s most widely used web application scanner OWASP ZAP</a></h2></div><div class="o n"><div></div><div class="aj s"><div class="n"><div style="flex:1"><span class="bo b es bq ei"><div class="ci n o eu"><span class="bo b bp bq ei"><a href="https://david-artykov.medium.com/?source=post_internal_links---------7----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">David Artykov</a><span> <!-- -->in<!-- --> <a href="/purple-team?source=post_internal_links---------7----------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf cg ch" rel="noopener">Purple TEAM</a></span></span></div></span></div></div></div></div></div><div class="er gd s rc rd"><a class="bu bv bw bx by bz ca cb ba cc cd ce cf cg ch s" rel="noopener" href="/purple-team/the-wolds-most-widely-used-web-app-scanner-owasp-zap-fe128bdcb85b?source=post_internal_links---------7----------------------------"><div class="ir s is it"><div class="re iv s"><div class="im in t u v io aj at ip iq"><img class="t u v io aj iw ix iy" src="https://miro.medium.com/max/60/1*ddg2Fxgbz4ApydkfmfVLRA.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="im in rf rg rh ri rj rk rl rm rn ro c" width="70" height="70" role="presentation"/><noscript><img class="rf rg rh ri rj rk rl rm rn ro" src="https://miro.medium.com/fit/c/140/140/1*ddg2Fxgbz4ApydkfmfVLRA.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*ddg2Fxgbz4ApydkfmfVLRA.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*ddg2Fxgbz4ApydkfmfVLRA.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="rp s rq rr"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="rs rt nn n ek g"><div class="ru n ek"><div class="rv s rw"><div class="qr s"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc rx ry cf rz sa" rel="noopener"><h2 class="bo hf sb ob dk sc">Learn more.</h2></a></div><p class="bo b es bq sd">Medium<!-- --> is an open platform where 170 million readers come to find insightful and dynamic thinking. Here, expert and undiscovered voices alike dive into the heart of any topic and bring new ideas to the surface.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc cf rz sa hc" rel="noopener">Learn more</a></p></div><div class="rv s rw"><div class="qr s"><a href="https://medium.com/topics?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc rx ry cf rz sa" rel="noopener"><h2 class="bo hf sb ob dk sc">Make <!-- -->Medium<!-- --> yours.</h2></a></div><p class="bo b es bq sd">Follow the writers, publications, and topics that matter to you, and you’ll see them on your homepage and in your inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc cf rz sa hc" rel="noopener">Explore</a></p></div><div class="rv s rw"><div class="qr s"><a href="https://about.medium.com/creators/?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc rx ry cf rz sa" rel="noopener"><h2 class="bo hf sb ob dk sc">Share your thinking.</h2></a></div><p class="bo b es bq sd">If you have a story to tell, knowledge to share, or a perspective to offer — welcome home. It’s easy and free to post your thinking on any topic.<!-- --> <a href="https://about.medium.com/creators/?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc cf rz sa hc" rel="noopener">Write on <!-- -->Medium</a></p></div></div></div><div class="n ko"><div class="n o ek"><a href="https://medium.com/?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc rx ry cf rz sa" rel="noopener"><svg viewBox="0 0 3940 610" class="ff se"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="ol sf n ek sg am"><p class="bo b kp ob sc"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf rz sa" rel="noopener">About</a></p><p class="bo b kp ob sc"><a href="https://help.medium.com/hc/en-us?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf rz sa" rel="noopener">Help</a></p><p class="bo b kp ob sc"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc fb cf rz sa" rel="noopener">Legal</a></p></div></div><div class="oc sh si am"><p class="bo b kp ob sd">Get the Medium app</p></div><div class="oc sh sj am sk"><div class="sl s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc rx ry cf rz sa" rel="noopener nofollow"><img alt="A button that says &#x27;Download on the App Store&#x27;, and if clicked it will lead you to the iOS App store" class="" src="https://miro.medium.com/max/270/1*Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"/></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----612c484ab278--------------------------------" class="bu bv bw bx by bz ca cb ba cc rx ry cf rz sa" rel="noopener nofollow"><img alt="A button that says &#x27;Get it on, Google Play&#x27;, and if clicked it will lead you to the Google Play store" class="" src="https://miro.medium.com/max/270/1*W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"/></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210521-194149-8205a38997"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":false},"bookReader":{"assets":{},"reader":{"currentAsset":null,"currentGFI":null,"settingsPanelIsOpen":false,"settings":{"fontFamily":"CHARTER","fontScale":"M","publisherStyling":true,"textAlignment":"start","theme":"White","lineSpacing":0,"wordSpacing":0,"letterSpacing":0},"internalNavCounter":0,"currentSelection":null,"highlights":[]}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-612c484ab278","user-90501148e467","collection-905ea2b3d4d1"],"serverVariantState":"b31ff0a75df8d148e9d8063a215e864688b6b432ca901806e33e3e245bd91ebf","middlewareEnabled":true,"cacheStatus":"DYNAMIC"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":true,"routingEntity":{"type":"DEFAULT","explicit":false}},"debug":{"requestId":"1af32cc2-30c4-4c77-b2cd-1bb879bffba3","hybridDevServices":[],"showBookReaderDebugger":false,"originalSpanCarrier":{"ot-tracer-spanid":"39b12d747cf49e5f","ot-tracer-traceid":"1bad444fe1048245","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech\u002Fvba-stomping-advanced-maldoc-techniques-612c484ab278","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"queryString":"","currentHash":""},"tracing":{},"config":{"nodeEnv":"production","version":"main-20210521-194149-8205a38997","isTaggedVersion":false,"target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210521-194149-8205a38997"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210521-194149-8205a38997","commit":"8205a389970795cdb2c37068f2062c807d740019"}},"datacenter":"us"},"googleAnalyticsCode":"UA-24232453-2","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium"},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl"},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","meterPost({\"postId\":\"612c484ab278\",\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__ref":"MeteringInfo:{}"},"postResult({\"id\":\"612c484ab278\"})":{"__ref":"Post:612c484ab278"}},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":0},"UserViewerEdge:userId:90501148e467-viewerId:lo_e22e58c8aaae":{"id":"userId:90501148e467-viewerId:lo_e22e58c8aaae","__typename":"UserViewerEdge","isAllowEdsEnabled":false,"isFollowing":false,"readPostsCount":0,"createdAt":0,"lastPostCreatedAt":0,"isBlocking":false,"isUser":false},"User:90501148e467":{"id":"90501148e467","__typename":"User","viewerIsUser":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:90501148e467-viewerId:lo_e22e58c8aaae"},"customStyleSheet":null,"isSuspended":false,"name":"Carrie Roberts","hasCompletedProfile":false,"bio":"Developer turned Red Team . . . then Blue. SANS STI Grad. GSE Certification Holder. Dynamic Defense Engineer at Walmart.","imageId":"0*XlMl43vEsM_t3qV_","username":"clr2of8","customDomainState":null,"isAuroraVisible":true,"mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":194,"followingCount":1},"hasSubdomain":false,"allowNotes":true,"newsletterV3":null,"twitterScreenName":"","followedCollections":0,"atsQualifiedAt":1612205328187},"ImageMetadata:":{"id":"","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"CollectionViewerEdge:collectionId:905ea2b3d4d1-viewerId:lo_e22e58c8aaae":{"id":"collectionId:905ea2b3d4d1-viewerId:lo_e22e58c8aaae","__typename":"CollectionViewerEdge","isEditor":false,"canEditOwnPosts":false,"canEditPosts":false,"isFollowing":false},"ImageMetadata:1*8BhtOzg5TgZmRkRbzP05Jw.jpeg":{"id":"1*8BhtOzg5TgZmRkRbzP05Jw.jpeg","__typename":"ImageMetadata","originalWidth":4167,"originalHeight":767},"User:c884135151a4":{"id":"c884135151a4","__typename":"User","atsQualifiedAt":1612205367508},"ImageMetadata:1*quUoN1GMDA3fwyaPGdTYFQ.jpeg":{"id":"1*quUoN1GMDA3fwyaPGdTYFQ.jpeg","__typename":"ImageMetadata"},"Collection:905ea2b3d4d1":{"id":"905ea2b3d4d1","__typename":"Collection","domain":null,"googleAnalyticsId":null,"slug":"walmartglobaltech","colorBehavior":"ACCENT_COLOR","isAuroraVisible":false,"favicon":{"__ref":"ImageMetadata:"},"name":"Walmart Global Tech Blog","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"customStyleSheet":null,"tagline":"We’re powering the next great retail disruption.","isAuroraEligible":false,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:905ea2b3d4d1-viewerId:lo_e22e58c8aaae"},"logo":{"__ref":"ImageMetadata:1*8BhtOzg5TgZmRkRbzP05Jw.jpeg"},"navItems":[{"__typename":"NavItem","title":"Engineering","url":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech\u002Ftagged\u002Fengineering","type":"TAG_NAV_ITEM"},{"__typename":"NavItem","title":"Data Science","url":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech\u002Ftagged\u002Fdata-science","type":"TAG_NAV_ITEM"},{"__typename":"NavItem","title":"InfoSec","url":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech\u002Ftagged\u002Finfosec","type":"TAG_NAV_ITEM"},{"__typename":"NavItem","title":"UX Design","url":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech\u002Ftagged\u002Fux-design","type":"TAG_NAV_ITEM"},{"__typename":"NavItem","title":"Leadership","url":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech\u002Ftagged\u002Fleadership","type":"TAG_NAV_ITEM"},{"__typename":"NavItem","title":"About ","url":"https:\u002F\u002Fwww.linkedin.com\u002Fcompany\u002Fwalmartglobaltech\u002F","type":"EXTERNAL_LINK_NAV_ITEM"}],"creator":{"__ref":"User:c884135151a4"},"subscriberCount":13283,"avatar":{"__ref":"ImageMetadata:1*quUoN1GMDA3fwyaPGdTYFQ.jpeg"},"newsletterV3":null,"canToggleEmail":false,"description":"We’re powering the next great retail disruption. Learn more about us — https:\u002F\u002Fwww.linkedin.com\u002Fcompany\u002Fwalmartglobaltech\u002F","ampEnabled":false,"twitterUsername":"walmarttech","facebookPageId":null,"customDomainState":null,"ptsQualifiedAt":1616092813504},"PostViewerEdge:postId:612c484ab278-viewerId:lo_e22e58c8aaae":{"id":"postId:612c484ab278-viewerId:lo_e22e58c8aaae","__typename":"PostViewerEdge","readingList":"READING_LIST_NONE","clapCount":0,"creatorPartnerProgramEnrollmentStatus":"PERMISSION_DENIED","shareKey":null},"Paragraph:316096d4251f_0":{"id":"316096d4251f_0","__typename":"Paragraph","name":"d712","text":"VBA Stomping — Advanced Maldoc Techniques","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_1":{"id":"316096d4251f_1","__typename":"Paragraph","name":"1914","text":"Authors: Kirk Sayre (@bigmacjpg), Harold Ogden (@haroldogden) and Carrie Roberts (@OrOneEqualsOne)","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":21,"end":31,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002Fbigmacjpg","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":48,"end":60,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002Fharoldogden","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":82,"end":97,"type":"A","href":"https:\u002F\u002Ftwitter.com\u002FOrOneEqualsOne","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_2":{"id":"316096d4251f_2","__typename":"Paragraph","name":"e118","text":"Introduction","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_3":{"id":"316096d4251f_3","__typename":"Paragraph","name":"7a43","text":"There are powerful malicious document (maldoc) generation techniques that are effective at bypassing anti-virus detection. A technique which we refer to as VBA stomping was originally brought to our attention by Dr. Vesselin Bontchev (see here). VBA stomping refers to destroying the VBA source code in a Microsoft Office document, leaving only a compiled version of the macro code known as p-code in the document file. Maldoc detection based only on the VBA source code fails in this scenario. In this blog post we will demonstrate detailed examples of VBA stomping as well as introduce some additional techniques.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":239,"end":243,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fbontchev\u002Fpcodedmp","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":156,"end":168,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_4":{"id":"316096d4251f_4","__typename":"Paragraph","name":"66cc","text":"VBA Stomping","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_5":{"id":"316096d4251f_5","__typename":"Paragraph","name":"abf5","text":"First, we will demonstrate VBA stomping on a simple, non-malicious macro. This document simply displays a message box with the text “ABC” when the document is opened. The VBA source code and resulting message box is shown below.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_6":{"id":"316096d4251f_6","__typename":"Paragraph","name":"e80c","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*P_mM0Ffo9kzzhtMM1O7oCg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_7":{"id":"316096d4251f_7","__typename":"Paragraph","name":"d441","text":"Now we are interested in modifying the VBA source code shown above, while leaving the intermediate p-code unchanged. For the purposes of this blog post we will concentrate on the current .docx\u002F.xlsx\u002F.docm\u002F.xlsm (Office 2007+) format. However, the techniques discussed here can easily be applied to the older .doc\u002F.xls format. In Office 2007+ files the VBA source code and p-code is typically located in a file called vbaProject.bin. Note that this is the default filename but it can be renamed. To manually modify this file, we need to first unzip the compressed .docm\u002F.xlsm file and then open vbaProject.bin file in a hex editor. In this example, we will change “ABC” to “XYZ”, but only within the VBA source code storage location, not the p-code section. The VBA source code is stored in a compressed form which explains the unprintable or odd characters you see in the following image.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_8":{"id":"316096d4251f_8","__typename":"Paragraph","name":"7948","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KGc1XphbyNT5Dws5W8lOPQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_9":{"id":"316096d4251f_9","__typename":"Paragraph","name":"1e1d","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*iHWUB-LOeGuw_8K02Gixpg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_10":{"id":"316096d4251f_10","__typename":"Paragraph","name":"0fc1","text":"Now that we have manually edited the VBA source to change “ABC” to “XYZ”, we will open the document and inspect the VBA source code BEFORE the “Enable Content” button is clicked.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":132,"end":138,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":132,"end":138,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_11":{"id":"316096d4251f_11","__typename":"Paragraph","name":"87e3","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jqYto7TMBR3MUZPqzdhogw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_12":{"id":"316096d4251f_12","__typename":"Paragraph","name":"92dc","text":"The document has been opened but macros are not enabled. Inspecting the macro in the code editor indicates that a message box with the text “XYZ” will be displayed but this is not the case. In fact, as soon as the content is enabled, a message box showing “ABC” is displayed and the source code in the code editor is updated to match!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_13":{"id":"316096d4251f_13","__typename":"Paragraph","name":"30bb","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VE19x2i45U7r6FXDxov1UA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_14":{"id":"316096d4251f_14","__typename":"Paragraph","name":"b8d7","text":"Well, that surely was misleading. The source code said that “XYZ” was going to be displayed in the message box but instead “ABC” was displayed. What is going on?","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_15":{"id":"316096d4251f_15","__typename":"Paragraph","name":"256b","text":"As Dr. Bontchev explains, the p-code stored in the document is what actually executes, as long as it is compatible with the current VBA version on the system. In addition, what gets displayed in the macro editor (once content is enabled) is not the decompressed VBA source, but instead it is the decompiled p-code. Interesting!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_16":{"id":"316096d4251f_16","__typename":"Paragraph","name":"609a","text":"If we open the document in a different version of Word (which uses a different VBA version) the p-code will not be reusable. This will force the VBA source code to be decompressed and recompiled to p-code, resulting in the display of “XYZ” in the message box. So now we have a single document, which on one version of Office displays “ABC”, but on another version displays “XYZ”.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_17":{"id":"316096d4251f_17","__typename":"Paragraph","name":"a386","text":"Note that this is an important caveat. A VBA stomped maldoc can only be executed using the same VBA version used to create the document. This limitation can be addressed by doing reconnaissance on a target prior to maldoc generation to determine the appropriate Office version to use or by generating maldocs with multiple Office versions and spraying them against the target.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":39,"end":136,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_18":{"id":"316096d4251f_18","__typename":"Paragraph","name":"9913","text":"What is the effect of VBA stomping from a defensive standpoint? Maldoc detection is often based solely on the VBA source. Even many of the tools available for analyzing documents fail to identify the discrepancy between the VBA source and the p-code. The analysis of the tampered document by the olevba script, by Philippe Lagadec, shows the decompressed source only and lacks the p-code detail.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":296,"end":309,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fdecalage2\u002Foletools\u002Fwiki\u002Folevba","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_19":{"id":"316096d4251f_19","__typename":"Paragraph","name":"366b","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*TIq1-TyPn5gxopcr88-U9A.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_20":{"id":"316096d4251f_20","__typename":"Paragraph","name":"5d23","text":"The Python script oledump.py, by Didier Stevens, gives similar results unless run with the p-code dumper plugin. The output in this case gives some indication that the p-code will result in a message box display of “ABC” as shown in the image below.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":18,"end":28,"type":"A","href":"https:\u002F\u002Fblog.didierstevens.com\u002Fprograms\u002Foledump-py\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_21":{"id":"316096d4251f_21","__typename":"Paragraph","name":"5f96","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZmBHbwFxuqbZB9JZzN4yrw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_22":{"id":"316096d4251f_22","__typename":"Paragraph","name":"d998","text":"Dr. Bontchev released a Python script called pcodedmp.py for displaying p-code as shown in the image below. The output has the added benefit of showing operation names instead of op-codes as above.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":45,"end":56,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fbontchev\u002Fpcodedmp","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_23":{"id":"316096d4251f_23","__typename":"Paragraph","name":"54b9","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*1jU7iSKRyTb93EK5WfIZ3Q.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_24":{"id":"316096d4251f_24","__typename":"Paragraph","name":"9225","text":"Instead of just modifying the VBA source code, we could completely wipe it out (“stomp” it) by overwriting it with zero’s or random bytes. The following screenshot shows how to do this manually in a hex editor.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_25":{"id":"316096d4251f_25","__typename":"Paragraph","name":"8762","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xCsSmTV9k0qFMjUWfQDWuQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_26":{"id":"316096d4251f_26","__typename":"Paragraph","name":"e3e3","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XLiGHjipu6lk7JU8rNxzXw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_27":{"id":"316096d4251f_27","__typename":"Paragraph","name":"0089","text":"The result in this case is a VBA editor that shows no macro code at all, yet the message box with the text “ABC” still appears after enabling content. Now we re-run olevba on this file and no VBA source code is displayed and the statement “No suspicious keyword or IOC found” is displayed instead of the table that previously highlighted our use of a suspicious keyword (AutoOpen).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_28":{"id":"316096d4251f_28","__typename":"Paragraph","name":"0b12","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3t0jKe01yE0ydhE2pFXvxA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_29":{"id":"316096d4251f_29","__typename":"Paragraph","name":"e0f3","text":"How Big of a Problem Is This?","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_30":{"id":"316096d4251f_30","__typename":"Paragraph","name":"6622","text":"We will now dive a little deeper into the how Office uses the compressed VBA source code and p-code. This will come into play later when we go over how to abuse Office functionality to easily modify maldocs to fool many AV scanners.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_31":{"id":"316096d4251f_31","__typename":"Paragraph","name":"bc4b","text":"Office documents contain two places from which to pull the VBA, the compressed VBA source code and the p-code. The following table details which VBA data source is used when:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_32":{"id":"316096d4251f_32","__typename":"Paragraph","name":"06e5","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Eh5SA794dEMFOlkqR8ThDQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_33":{"id":"316096d4251f_33","__typename":"Paragraph","name":"0607","text":"From this table we see that if we have valid p-code, the compressed VBA source code is ignored when macros are enabled. All macro functionality is performed by running the p-code. As an attacker this tells us that we can completely ruin or modify the compressed VBA source code and still have our maldoc perform its desired task.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_34":{"id":"316096d4251f_34","__typename":"Paragraph","name":"afbf","text":"Real World Example","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_35":{"id":"316096d4251f_35","__typename":"Paragraph","name":"e502","text":"Showing that this works on a toy example is all well and good, but is this really a legitimate threat? Let’s take this to the next level by working with a known malicious document. In this case, we will start with a recent Emotet maldoc that is currently detected as malicious by 36\u002F59 vendors on Virus total.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":223,"end":229,"type":"A","href":"https:\u002F\u002Fwww.cyber.nj.gov\u002Fthreat-profiles\u002Ftrojan-variants\u002Femotet","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_36":{"id":"316096d4251f_36","__typename":"Paragraph","name":"d233","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vhePAlQl6xO7TLdXXW1mCg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_37":{"id":"316096d4251f_37","__typename":"Paragraph","name":"40f1","text":"If we take this document and simply stomp the VBA source code as described above, the detection rate goes down to 7 out of 58 anti-virus solutions!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_38":{"id":"316096d4251f_38","__typename":"Paragraph","name":"cea4","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*15XLHrfFRP4PcFoTSX1GCA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_39":{"id":"316096d4251f_39","__typename":"Paragraph","name":"a6a5","text":"As you can see, this creates a serious problem for network defenders. Even manual analysis of such documents could be problematic. The obvious question at this point is “Can VBA stomping be performed automatically by a tool or do we always have to manually edit the Office document?” The answer to this question is yes, it certainly is possible to stomp VBA automatically with a tool. We have developed a POC utility to automatically stomp the compressed VBA source code in any Office document (this was used to VBA stomp the example Emotet document and no, we will not be releasing this utility). Given how easy it is to automate VBA stomping this is a real threat.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":315,"end":371,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":170,"end":282,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":315,"end":371,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_40":{"id":"316096d4251f_40","__typename":"Paragraph","name":"b89d","text":"Making It Worse","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_41":{"id":"316096d4251f_41","__typename":"Paragraph","name":"cb34","text":"Consider the case where the maldoc is designed to close MS Word immediately after executing the malicious payload. In combination with VBA stomping, no offline VBA source extraction tools will display the VBA source and the VBA source will not even be displayed in the Office macro editor window until the macro is enabled. But enabling the macro causes Word to immediately exit without providing an opportunity to view the decompiled source. While we have shown that the “assembly-like” p-code is extractable, the p-code is difficult to interpret and cannot be analyzed in the VBA debugger. In addition, the pcode only runs on a specific VBA version. For these reasons, access to the VBA source code would be a great benefit to the analyst. But how can this be done for such a document?","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_42":{"id":"316096d4251f_42","__typename":"Paragraph","name":"821e","text":"After some experimentation, we determined a simple solution to stop MS Word from executing any method as soon as macros are enabled. Note that this solution works for Office 2007+ documents, additional research is being performed to address older document formats. The 2007+ solution is to delete the vbaData.xml file from the “word” directory of the .docm file as shown below (this is easily done with the 7-Zip program without having to manually unzip and re-zip the document).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_43":{"id":"316096d4251f_43","__typename":"Paragraph","name":"6138","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*j953lLi4vkji5nySs3YPeg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_44":{"id":"316096d4251f_44","__typename":"Paragraph","name":"bc36","text":"The document can now be opened and the content can be enabled, resulting in the display of the decompiled p-code in the VBA code editor but no code execution. This could be a life saver in the event that the malware author has taken steps to prevent the analyst from having access to the VBA source code.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_45":{"id":"316096d4251f_45","__typename":"Paragraph","name":"d19e","text":"An interesting side effect of erasing vbaData.xml is that it causes MS Word to erroneously list no Macros in the Macros dialog (see image below).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_46":{"id":"316096d4251f_46","__typename":"Paragraph","name":"25a7","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KIhYa2asfDGRAIWXERhXug.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_47":{"id":"316096d4251f_47","__typename":"Paragraph","name":"7737","text":"Detection","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_48":{"id":"316096d4251f_48","__typename":"Paragraph","name":"de2f","text":"We have written an open source tool for detecting VBA stomping in Office documents called “VBA Seismograph”. This tool has been tested under Ubuntu 16.04 and detects differences between the declared function\u002Fvariable names, string literals, and comment lines that appear in the compiled p-code and the VBA source code of an Office document. The tool is available at https:\u002F\u002Fgithub.com\u002Fkirk-sayre-work\u002FVBASeismograph.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":366,"end":415,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fkirk-sayre-work\u002FVBASeismograph","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:316096d4251f_49":{"id":"316096d4251f_49","__typename":"Paragraph","name":"f455","text":"Conclusion","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_50":{"id":"316096d4251f_50","__typename":"Paragraph","name":"87fe","text":"In this blog post we have demonstrated how the compressed VBA source code in an Office document can be modified or destroyed to defeat AV scanning solutions and make manual analysis of maldocs more difficult. Defense against this technique involves detecting and flagging documents with valid p-code but invalid or missing VBA source code, or more generally, checking for discrepancies between the compressed VBA source code and the decompiled p-code. At this point in time we are not aware of any commercial AV solutions that do this check, so this is a potential area where AV scanning solutions can improve.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:316096d4251f_51":{"id":"316096d4251f_51","__typename":"Paragraph","name":"bea9","text":"See vbastomp.com for the most up to date information on VBA stomping.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":4,"end":16,"type":"A","href":"http:\u002F\u002Fvbastomp.com","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"ImageMetadata:1*P_mM0Ffo9kzzhtMM1O7oCg.png":{"id":"1*P_mM0Ffo9kzzhtMM1O7oCg.png","__typename":"ImageMetadata","originalHeight":162,"originalWidth":352,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*KGc1XphbyNT5Dws5W8lOPQ.png":{"id":"1*KGc1XphbyNT5Dws5W8lOPQ.png","__typename":"ImageMetadata","originalHeight":213,"originalWidth":617,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*iHWUB-LOeGuw_8K02Gixpg.png":{"id":"1*iHWUB-LOeGuw_8K02Gixpg.png","__typename":"ImageMetadata","originalHeight":212,"originalWidth":613,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*jqYto7TMBR3MUZPqzdhogw.png":{"id":"1*jqYto7TMBR3MUZPqzdhogw.png","__typename":"ImageMetadata","originalHeight":142,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*VE19x2i45U7r6FXDxov1UA.png":{"id":"1*VE19x2i45U7r6FXDxov1UA.png","__typename":"ImageMetadata","originalHeight":180,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*TIq1-TyPn5gxopcr88-U9A.png":{"id":"1*TIq1-TyPn5gxopcr88-U9A.png","__typename":"ImageMetadata","originalHeight":403,"originalWidth":513,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*ZmBHbwFxuqbZB9JZzN4yrw.png":{"id":"1*ZmBHbwFxuqbZB9JZzN4yrw.png","__typename":"ImageMetadata","originalHeight":286,"originalWidth":572,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*1jU7iSKRyTb93EK5WfIZ3Q.png":{"id":"1*1jU7iSKRyTb93EK5WfIZ3Q.png","__typename":"ImageMetadata","originalHeight":221,"originalWidth":441,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*xCsSmTV9k0qFMjUWfQDWuQ.png":{"id":"1*xCsSmTV9k0qFMjUWfQDWuQ.png","__typename":"ImageMetadata","originalHeight":170,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*XLiGHjipu6lk7JU8rNxzXw.png":{"id":"1*XLiGHjipu6lk7JU8rNxzXw.png","__typename":"ImageMetadata","originalHeight":157,"originalWidth":623,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*3t0jKe01yE0ydhE2pFXvxA.png":{"id":"1*3t0jKe01yE0ydhE2pFXvxA.png","__typename":"ImageMetadata","originalHeight":303,"originalWidth":613,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*Eh5SA794dEMFOlkqR8ThDQ.png":{"id":"1*Eh5SA794dEMFOlkqR8ThDQ.png","__typename":"ImageMetadata","originalHeight":230,"originalWidth":950,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*vhePAlQl6xO7TLdXXW1mCg.png":{"id":"1*vhePAlQl6xO7TLdXXW1mCg.png","__typename":"ImageMetadata","originalHeight":438,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*15XLHrfFRP4PcFoTSX1GCA.png":{"id":"1*15XLHrfFRP4PcFoTSX1GCA.png","__typename":"ImageMetadata","originalHeight":242,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*j953lLi4vkji5nySs3YPeg.png":{"id":"1*j953lLi4vkji5nySs3YPeg.png","__typename":"ImageMetadata","originalHeight":346,"originalWidth":461,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*KIhYa2asfDGRAIWXERhXug.png":{"id":"1*KIhYa2asfDGRAIWXERhXug.png","__typename":"ImageMetadata","originalHeight":370,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Tag:maldoc":{"id":"maldoc","__typename":"Tag","displayTitle":"Maldoc","normalizedTagSlug":""},"Tag:infosec":{"id":"infosec","__typename":"Tag","displayTitle":"Infosec","normalizedTagSlug":""},"ImageMetadata:1*IS1pmlSGaNsUhzx5GCPDqA.png":{"id":"1*IS1pmlSGaNsUhzx5GCPDqA.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:f5af2b715248":{"id":"f5af2b715248","__typename":"Collection","name":"The Startup","domain":null,"slug":"swlh"},"UserViewerEdge:userId:81daf91cea25-viewerId:lo_e22e58c8aaae":{"id":"userId:81daf91cea25-viewerId:lo_e22e58c8aaae","__typename":"UserViewerEdge","isFollowing":false},"User:81daf91cea25":{"id":"81daf91cea25","__typename":"User","name":"Aniket Badami","username":"0xaniket","bio":"","imageId":"1*YDckbRTJQkUXR0fjmjBm1A.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"0xaniket.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:81daf91cea25-viewerId:lo_e22e58c8aaae"}},"Post:fdc6c4b569bd":{"id":"fdc6c4b569bd","__typename":"Post","title":"TryHackMe — Internal Walkthrough","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fswlh\u002Ftryhackme-internal-walkthrough-fdc6c4b569bd","previewImage":{"__ref":"ImageMetadata:1*IS1pmlSGaNsUhzx5GCPDqA.png"},"isPublished":true,"firstPublishedAt":1609412421161,"readingTime":15.10377358490566,"statusForCollection":"APPROVED","isLocked":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:f5af2b715248"},"creator":{"__ref":"User:81daf91cea25"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*cJu7ISRVgv6IpCl3":{"id":"0*cJu7ISRVgv6IpCl3","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:63505f63fad2":{"id":"63505f63fad2","__typename":"Collection","name":"PC Magazine","domain":null,"slug":"pcmag-access"},"UserViewerEdge:userId:b3ca0a39a185-viewerId:lo_e22e58c8aaae":{"id":"userId:b3ca0a39a185-viewerId:lo_e22e58c8aaae","__typename":"UserViewerEdge","isFollowing":false},"User:b3ca0a39a185":{"id":"b3ca0a39a185","__typename":"User","name":"PCMag","username":"pcmagazine","bio":"","imageId":"1*SLQXwWGHQ9WmCqtmk4Er4g.jpeg","mediumMemberAt":1555424317000,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"pcmagazine.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:b3ca0a39a185-viewerId:lo_e22e58c8aaae"}},"Post:fd8cf716b93e":{"id":"fd8cf716b93e","__typename":"Post","title":"How to Use a Random Password Generator","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fpcmag-access\u002Fhow-to-use-a-random-password-generator-fd8cf716b93e","previewImage":{"__ref":"ImageMetadata:0*cJu7ISRVgv6IpCl3"},"isPublished":true,"firstPublishedAt":1530535907264,"readingTime":6.663522012578616,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:63505f63fad2"},"creator":{"__ref":"User:b3ca0a39a185"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*Y_jB_va-Wn4zqMWv8CGbAw.jpeg":{"id":"1*Y_jB_va-Wn4zqMWv8CGbAw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:82e29aec1699-viewerId:lo_e22e58c8aaae":{"id":"userId:82e29aec1699-viewerId:lo_e22e58c8aaae","__typename":"UserViewerEdge","isFollowing":false},"User:82e29aec1699":{"id":"82e29aec1699","__typename":"User","name":"Ensar Seker","username":"ensarseker1","bio":"Cybersecurity | Artificial Intelligence | Blockchain","imageId":"2*qDL_LqQFrjOz6LafhxnyRQ.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"ensarseker1.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:82e29aec1699-viewerId:lo_e22e58c8aaae"}},"Post:fd6cecc6bff0":{"id":"fd6cecc6bff0","__typename":"Post","title":"Detecting Lateral Movement Data Analysis","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fswlh\u002Fdetecting-lateral-movement-data-analysis-fd6cecc6bff0","previewImage":{"__ref":"ImageMetadata:1*Y_jB_va-Wn4zqMWv8CGbAw.jpeg"},"isPublished":true,"firstPublishedAt":1591275661219,"readingTime":3.85188679245283,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f5af2b715248"},"creator":{"__ref":"User:82e29aec1699"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*H_O-zVjwC_j7gzC1.jpg":{"id":"0*H_O-zVjwC_j7gzC1.jpg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"UserViewerEdge:userId:f0493e7e1c22-viewerId:lo_e22e58c8aaae":{"id":"userId:f0493e7e1c22-viewerId:lo_e22e58c8aaae","__typename":"UserViewerEdge","isFollowing":false},"User:f0493e7e1c22":{"id":"f0493e7e1c22","__typename":"User","name":"Stephen Chapendama","username":"stephen-chapendama","bio":"Cyber Security & Africa | Technology Manager @ Foundervine.com & Senior Software Engineer in Cyber & Intelligence 🚀","imageId":"2*_gRCFa374DIjfBrbvPSH1A.jpeg","mediumMemberAt":1580591765913,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"stephen-chapendama.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:f0493e7e1c22-viewerId:lo_e22e58c8aaae"}},"Post:fcf76b49c2ba":{"id":"fcf76b49c2ba","__typename":"Post","title":"Is Netflix Changing Our Perception of Cybersecurity?","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fswlh\u002Fis-netflix-changing-our-perception-of-cybersecurity-fcf76b49c2ba","previewImage":{"__ref":"ImageMetadata:0*H_O-zVjwC_j7gzC1.jpg"},"isPublished":true,"firstPublishedAt":1580184061337,"readingTime":4.149056603773585,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:f5af2b715248"},"creator":{"__ref":"User:f0493e7e1c22"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:0*PH683lKBT0b3GwO3.png":{"id":"0*PH683lKBT0b3GwO3.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:8a5025beed1d":{"id":"8a5025beed1d","__typename":"Collection","name":"WoTTsecurity","domain":null,"slug":"wottsecurity"},"UserViewerEdge:userId:8c6b28f1fc99-viewerId:lo_e22e58c8aaae":{"id":"userId:8c6b28f1fc99-viewerId:lo_e22e58c8aaae","__typename":"UserViewerEdge","isFollowing":false},"User:8c6b28f1fc99":{"id":"8c6b28f1fc99","__typename":"User","name":"Viktor Petersson","username":"vpetersson","bio":"CEO and Co-founder of @WireLoad \u002F @ScreenlyApp. #DigitalNomad #Entrepreneur #Speaker #Geek #Cloud #DevOps","imageId":"1*OdbZXDf-SOU5gUILgBzLOA.jpeg","mediumMemberAt":0,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"vpetersson.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:8c6b28f1fc99-viewerId:lo_e22e58c8aaae"}},"Post:fd1518ea12cd":{"id":"fd1518ea12cd","__typename":"Post","title":"The DevSecOps Iceberg","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fwottsecurity\u002Fthe-devsecops-iceberg-fd1518ea12cd","previewImage":{"__ref":"ImageMetadata:0*PH683lKBT0b3GwO3.png"},"isPublished":true,"firstPublishedAt":1575118847762,"readingTime":4.358490566037736,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:8a5025beed1d"},"creator":{"__ref":"User:8c6b28f1fc99"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"UserViewerEdge:userId:514f0bbbb67b-viewerId:lo_e22e58c8aaae":{"id":"userId:514f0bbbb67b-viewerId:lo_e22e58c8aaae","__typename":"UserViewerEdge","isFollowing":false},"User:514f0bbbb67b":{"id":"514f0bbbb67b","__typename":"User","name":"Shay Rapaport","username":"shayrapaport","bio":"","imageId":"0*ZOqtD_3S63fnODrR.","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:514f0bbbb67b-viewerId:lo_e22e58c8aaae"}},"Post:fdd49223e693":{"id":"fdd49223e693","__typename":"Post","title":"Web 3.0: Reclaiming Our Online Selves","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@shayrapaport\u002Fweb-3-0-reclaiming-our-online-selves-fdd49223e693","previewImage":{"__ref":"ImageMetadata:"},"isPublished":true,"firstPublishedAt":1539710837368,"readingTime":19.162264150943397,"statusForCollection":null,"isLocked":false,"visibility":"PUBLIC","collection":null,"creator":{"__ref":"User:514f0bbbb67b"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*EroijenwpLVmNHw6XOtaEw.png":{"id":"1*EroijenwpLVmNHw6XOtaEw.png","__typename":"ImageMetadata","focusPercentX":51,"focusPercentY":30},"Collection:70f217fc23a8":{"id":"70f217fc23a8","__typename":"Collection","name":"MIT Technology Review","domain":null,"slug":"mit-technology-review"},"UserViewerEdge:userId:defe73a9b0ba-viewerId:lo_e22e58c8aaae":{"id":"userId:defe73a9b0ba-viewerId:lo_e22e58c8aaae","__typename":"UserViewerEdge","isFollowing":false},"User:defe73a9b0ba":{"id":"defe73a9b0ba","__typename":"User","name":"MIT Technology Review","username":"MITTechReview","bio":"Reporting on important technologies and innovators since 1899","imageId":"1*fRTAqrjmS6BLG1L49aq-dg.jpeg","mediumMemberAt":0,"customDomainState":null,"hasSubdomain":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:defe73a9b0ba-viewerId:lo_e22e58c8aaae"}},"Post:fdb529ca76ab":{"id":"fdb529ca76ab","__typename":"Post","title":"For Safety’s Sake, We Must Slow Innovation in Internet-Connected Things","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fmit-technology-review\u002Ffor-safetys-sake-we-must-slow-innovation-in-internet-connected-things-fdb529ca76ab","previewImage":{"__ref":"ImageMetadata:1*EroijenwpLVmNHw6XOtaEw.png"},"isPublished":true,"firstPublishedAt":1536259188600,"readingTime":6.594654088050315,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:70f217fc23a8"},"creator":{"__ref":"User:defe73a9b0ba"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*ddg2Fxgbz4ApydkfmfVLRA.jpeg":{"id":"1*ddg2Fxgbz4ApydkfmfVLRA.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:d208c28825c7":{"id":"d208c28825c7","__typename":"Collection","name":"Purple TEAM","domain":null,"slug":"purple-team"},"UserViewerEdge:userId:ab328574f533-viewerId:lo_e22e58c8aaae":{"id":"userId:ab328574f533-viewerId:lo_e22e58c8aaae","__typename":"UserViewerEdge","isFollowing":false},"User:ab328574f533":{"id":"ab328574f533","__typename":"User","name":"David Artykov","username":"david-artykov","bio":"Cybersecurity Professional, Penetration Testing Engineer","imageId":"1*lzIUsYK9MV_L8mOYszaC7A.jpeg","mediumMemberAt":1617019229000,"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"david-artykov.medium.com"}},"hasSubdomain":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:ab328574f533-viewerId:lo_e22e58c8aaae"}},"Post:fe128bdcb85b":{"id":"fe128bdcb85b","__typename":"Post","title":"The wold’s most widely used web application scanner OWASP ZAP","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fpurple-team\u002Fthe-wolds-most-widely-used-web-app-scanner-owasp-zap-fe128bdcb85b","previewImage":{"__ref":"ImageMetadata:1*ddg2Fxgbz4ApydkfmfVLRA.jpeg"},"isPublished":true,"firstPublishedAt":1617022729514,"readingTime":2.5339622641509436,"statusForCollection":"APPROVED","isLocked":true,"visibility":"LOCKED","collection":{"__ref":"Collection:d208c28825c7"},"creator":{"__ref":"User:ab328574f533"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"Post:612c484ab278":{"id":"612c484ab278","__typename":"Post","creator":{"__ref":"User:90501148e467"},"canonicalUrl":"","collection":{"__ref":"Collection:905ea2b3d4d1"},"content({\"postMeteringOptions\":{\"referrer\":\"\",\"sk\":null,\"source\":null}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:316096d4251f_0"},{"__ref":"Paragraph:316096d4251f_1"},{"__ref":"Paragraph:316096d4251f_2"},{"__ref":"Paragraph:316096d4251f_3"},{"__ref":"Paragraph:316096d4251f_4"},{"__ref":"Paragraph:316096d4251f_5"},{"__ref":"Paragraph:316096d4251f_6"},{"__ref":"Paragraph:316096d4251f_7"},{"__ref":"Paragraph:316096d4251f_8"},{"__ref":"Paragraph:316096d4251f_9"},{"__ref":"Paragraph:316096d4251f_10"},{"__ref":"Paragraph:316096d4251f_11"},{"__ref":"Paragraph:316096d4251f_12"},{"__ref":"Paragraph:316096d4251f_13"},{"__ref":"Paragraph:316096d4251f_14"},{"__ref":"Paragraph:316096d4251f_15"},{"__ref":"Paragraph:316096d4251f_16"},{"__ref":"Paragraph:316096d4251f_17"},{"__ref":"Paragraph:316096d4251f_18"},{"__ref":"Paragraph:316096d4251f_19"},{"__ref":"Paragraph:316096d4251f_20"},{"__ref":"Paragraph:316096d4251f_21"},{"__ref":"Paragraph:316096d4251f_22"},{"__ref":"Paragraph:316096d4251f_23"},{"__ref":"Paragraph:316096d4251f_24"},{"__ref":"Paragraph:316096d4251f_25"},{"__ref":"Paragraph:316096d4251f_26"},{"__ref":"Paragraph:316096d4251f_27"},{"__ref":"Paragraph:316096d4251f_28"},{"__ref":"Paragraph:316096d4251f_29"},{"__ref":"Paragraph:316096d4251f_30"},{"__ref":"Paragraph:316096d4251f_31"},{"__ref":"Paragraph:316096d4251f_32"},{"__ref":"Paragraph:316096d4251f_33"},{"__ref":"Paragraph:316096d4251f_34"},{"__ref":"Paragraph:316096d4251f_35"},{"__ref":"Paragraph:316096d4251f_36"},{"__ref":"Paragraph:316096d4251f_37"},{"__ref":"Paragraph:316096d4251f_38"},{"__ref":"Paragraph:316096d4251f_39"},{"__ref":"Paragraph:316096d4251f_40"},{"__ref":"Paragraph:316096d4251f_41"},{"__ref":"Paragraph:316096d4251f_42"},{"__ref":"Paragraph:316096d4251f_43"},{"__ref":"Paragraph:316096d4251f_44"},{"__ref":"Paragraph:316096d4251f_45"},{"__ref":"Paragraph:316096d4251f_46"},{"__ref":"Paragraph:316096d4251f_47"},{"__ref":"Paragraph:316096d4251f_48"},{"__ref":"Paragraph:316096d4251f_49"},{"__ref":"Paragraph:316096d4251f_50"},{"__ref":"Paragraph:316096d4251f_51"}],"sections":[{"__typename":"Section","name":"bdfd","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"customStyleSheet":null,"firstPublishedAt":1538776659506,"isLocked":false,"isPublished":true,"isShortform":false,"layerCake":4,"primaryTopic":null,"viewerEdge":{"__ref":"PostViewerEdge:postId:612c484ab278-viewerId:lo_e22e58c8aaae"},"title":"VBA Stomping — Advanced Maldoc Techniques","isMarkedPaywallOnly":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fwalmartglobaltech\u002Fvba-stomping-advanced-maldoc-techniques-612c484ab278","isLimitedState":false,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:maldoc"},{"__ref":"Tag:infosec"}],"topics":[{"__typename":"Topic","topicId":"d4e7f4144ac5","name":"Cybersecurity"}],"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","noIndex":null,"curationStatus":null,"metaDescription":"","latestPublishedAt":1586625222190,"readingTime":7.972641509433962,"previewContent":{"__typename":"PreviewContent","subtitle":"Authors: Kirk Sayre (@bigmacjpg), Harold Ogden (@haroldogden) and Carrie Roberts (@OrOneEqualsOne)"},"previewImage":{"__ref":"ImageMetadata:1*15XLHrfFRP4PcFoTSX1GCA.png"},"clapCount":191,"lockedSource":"LOCKED_POST_SOURCE_NONE","isSuspended":false,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":0,"responseDistribution":"NOT_DISTRIBUTED","internalLinks({\"paging\":{\"limit\":8}})":{"__typename":"InternalLinksConnection","items":[{"__ref":"Post:fdc6c4b569bd"},{"__ref":"Post:fd8cf716b93e"},{"__ref":"Post:fd6cecc6bff0"},{"__ref":"Post:fcf76b49c2ba"},{"__ref":"Post:fd1518ea12cd"},{"__ref":"Post:fdd49223e693"},{"__ref":"Post:fdb529ca76ab"},{"__ref":"Post:fe128bdcb85b"}]},"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"audioVersionUrl":"","seoTitle":"","updatedAt":1586631315676,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":1},"latestPublishedVersion":"316096d4251f","isPublishToEmail":false,"voterCount":44,"recommenders":[],"content({})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:316096d4251f_0"},{"__ref":"Paragraph:316096d4251f_1"},{"__ref":"Paragraph:316096d4251f_2"},{"__ref":"Paragraph:316096d4251f_3"},{"__ref":"Paragraph:316096d4251f_4"},{"__ref":"Paragraph:316096d4251f_5"},{"__ref":"Paragraph:316096d4251f_6"},{"__ref":"Paragraph:316096d4251f_7"},{"__ref":"Paragraph:316096d4251f_8"},{"__ref":"Paragraph:316096d4251f_9"},{"__ref":"Paragraph:316096d4251f_10"},{"__ref":"Paragraph:316096d4251f_11"},{"__ref":"Paragraph:316096d4251f_12"},{"__ref":"Paragraph:316096d4251f_13"},{"__ref":"Paragraph:316096d4251f_14"},{"__ref":"Paragraph:316096d4251f_15"},{"__ref":"Paragraph:316096d4251f_16"},{"__ref":"Paragraph:316096d4251f_17"},{"__ref":"Paragraph:316096d4251f_18"},{"__ref":"Paragraph:316096d4251f_19"},{"__ref":"Paragraph:316096d4251f_20"},{"__ref":"Paragraph:316096d4251f_21"},{"__ref":"Paragraph:316096d4251f_22"},{"__ref":"Paragraph:316096d4251f_23"},{"__ref":"Paragraph:316096d4251f_24"},{"__ref":"Paragraph:316096d4251f_25"},{"__ref":"Paragraph:316096d4251f_26"},{"__ref":"Paragraph:316096d4251f_27"},{"__ref":"Paragraph:316096d4251f_28"},{"__ref":"Paragraph:316096d4251f_29"},{"__ref":"Paragraph:316096d4251f_30"},{"__ref":"Paragraph:316096d4251f_31"},{"__ref":"Paragraph:316096d4251f_32"},{"__ref":"Paragraph:316096d4251f_33"},{"__ref":"Paragraph:316096d4251f_34"},{"__ref":"Paragraph:316096d4251f_35"},{"__ref":"Paragraph:316096d4251f_36"},{"__ref":"Paragraph:316096d4251f_37"},{"__ref":"Paragraph:316096d4251f_38"},{"__ref":"Paragraph:316096d4251f_39"},{"__ref":"Paragraph:316096d4251f_40"},{"__ref":"Paragraph:316096d4251f_41"},{"__ref":"Paragraph:316096d4251f_42"},{"__ref":"Paragraph:316096d4251f_43"},{"__ref":"Paragraph:316096d4251f_44"},{"__ref":"Paragraph:316096d4251f_45"},{"__ref":"Paragraph:316096d4251f_46"},{"__ref":"Paragraph:316096d4251f_47"},{"__ref":"Paragraph:316096d4251f_48"},{"__ref":"Paragraph:316096d4251f_49"},{"__ref":"Paragraph:316096d4251f_50"},{"__ref":"Paragraph:316096d4251f_51"}],"sections":[{"__typename":"Section","name":"bdfd","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}}}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.32733017.js"></script><script src="https://cdn-client.medium.com/lite/static/js/6484.96815e61.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.23bdaf70.js"></script><script src="https://cdn-client.medium.com/lite/static/js/5573.159bf40f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/instrumentation.8ea15b6a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.65aadb14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1752.a348f767.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/953.19c0a4db.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3211.3e30b0d8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4586.0206cca1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9692.b4a02f3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5064.7974654b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9046.8e42140f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2846.012d369f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2176.958ba593.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2712.a43f33d4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9972.f6abd8ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5828.582128b9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2955.12744204.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7131.faa9f1cc.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/664.68f7c552.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8751.a9b26c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2238.af816699.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5009.dbfd66e8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4803.15ea4361.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8127.7b79de8f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6371.bfa476ae.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8995.7ff30d72.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5435.7a0af391.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3874.3f41bcb9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1794.574e0f73.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9454.d9a3a4a8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/Post.50144cfa.chunk.js"></script><script>window.main();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"653abb0b6ce5567d","token":"0b5f665943484354a59c39c6833f7078","version":"2021.5.1","si":10}'></script>
</body></html>