<!DOCTYPE html><!--[if IE 7]>
<html class="ie ie7" lang="en-US" prefix="og: http://ogp.me/ns#">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US" prefix="og: http://ogp.me/ns#">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<!--<![endif]-->
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>How Attackers Use Kerberos Silver Tickets to Exploit Systems &#8211; Active Directory Security</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Feed" href="https://adsecurity.org/?feed=rss2" />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Comments Feed" href="https://adsecurity.org/?feed=comments-rss2" />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; How Attackers Use Kerberos Silver Tickets to Exploit Systems Comments Feed" href="https://adsecurity.org/?feed=rss2&#038;p=2011" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/adsecurity.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='https://adsecurity.org/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css'  href='https://adsecurity.org/wp-content/themes/graphene/bootstrap/css/bootstrap.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://adsecurity.org/wp-content/themes/graphene/fonts/font-awesome/css/font-awesome.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='graphene-css'  href='https://adsecurity.org/wp-content/themes/graphene/style.css?ver=2.8.4' type='text/css' media='screen' />
<link rel='stylesheet' id='graphene-responsive-css'  href='https://adsecurity.org/wp-content/themes/graphene/responsive.css?ver=2.8.4' type='text/css' media='all' />
<link rel='stylesheet' id='graphene-blocks-css'  href='https://adsecurity.org/wp-content/themes/graphene/blocks.css?ver=2.8.4' type='text/css' media='all' />
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/bootstrap/js/bootstrap.min.js?ver=2.8.4' id='bootstrap-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js?ver=2.8.4' id='bootstrap-hover-dropdown-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/bootstrap-submenu/bootstrap-submenu.min.js?ver=2.8.4' id='bootstrap-submenu-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/jquery.infinitescroll.min.js?ver=2.8.4' id='infinite-scroll-js'></script>
<script type='text/javascript' id='graphene-js-extra'>
/* <![CDATA[ */
var grapheneJS = {"siteurl":"https:\/\/adsecurity.org","ajaxurl":"https:\/\/adsecurity.org\/wp-admin\/admin-ajax.php","templateUrl":"https:\/\/adsecurity.org\/wp-content\/themes\/graphene","isSingular":"1","enableStickyMenu":"","shouldShowComments":"1","commentsOrder":"newest","sliderDisable":"","sliderInterval":"7000","infScrollBtnLbl":"Load more","infScrollOn":"","infScrollCommentsOn":"","totalPosts":"1","postsPerPage":"10","isPageNavi":"","infScrollMsgText":"Fetching window.grapheneInfScrollItemsPerPage of window.grapheneInfScrollItemsLeft items left ...","infScrollMsgTextPlural":"Fetching window.grapheneInfScrollItemsPerPage of window.grapheneInfScrollItemsLeft items left ...","infScrollFinishedText":"All loaded!","commentsPerPage":"50","totalComments":"1","infScrollCommentsMsg":"Fetching window.grapheneInfScrollCommentsPerPage of window.grapheneInfScrollCommentsLeft comments left ...","infScrollCommentsMsgPlural":"Fetching window.grapheneInfScrollCommentsPerPage of window.grapheneInfScrollCommentsLeft comments left ...","infScrollCommentsFinishedMsg":"All comments loaded!","disableLiveSearch":"1","txtNoResult":"No result found.","isMasonry":""};
/* ]]> */
</script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/graphene.js?ver=2.8.4' id='graphene-js'></script>
<link rel="https://api.w.org/" href="https://adsecurity.org/index.php?rest_route=/" /><link rel="alternate" type="application/json" href="https://adsecurity.org/index.php?rest_route=/wp/v2/posts/2011" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://adsecurity.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://adsecurity.org/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="https://adsecurity.org/?p=2011" />
<link rel='shortlink' href='https://adsecurity.org/?p=2011' />
<link rel="alternate" type="application/json+oembed" href="https://adsecurity.org/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2Fadsecurity.org%2F%3Fp%3D2011" />
<link rel="alternate" type="text/xml+oembed" href="https://adsecurity.org/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2Fadsecurity.org%2F%3Fp%3D2011&#038;format=xml" />
		<script type="text/javascript">
			var _statcounter = _statcounter || [];
			_statcounter.push({"tags": {"author": "SeanMetcalf"}});
		</script>
				<script>
		   WebFontConfig = {
		      google: { 
		      	families: ["Lato:400,400i,700,700i&display=swap"]		      }
		   };

		   (function(d) {
		      var wf = d.createElement('script'), s = d.scripts[0];
		      wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
		      wf.async = true;
		      s.parentNode.insertBefore(wf, s);
		   })(document);
		</script>
	<style type="text/css">
.header_title, .header_title a, .header_title a:visited, .header_title a:hover, .header_desc {color:#000000}.carousel, .carousel .item{height:400px}@media (max-width: 991px) {.carousel, .carousel .item{height:250px}}#header{max-height:198px}@media (min-width: 1200px) {.container {width:1280px}}
</style>
		<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":"https:\/\/adsecurity.org\/?p=2011","publisher":{"@type":"Organization","name":"Active Directory Security"},"headline":"How Attackers Use Kerberos Silver Tickets to Exploit Systems","datePublished":"2015-11-17T22:44:27+00:00","dateModified":"2017-12-30T00:19:53+00:00","description":"Usually Golden Tickets (forged Kerberos TGTs) get all the press, but this post is about Silver Tickets and how attackers use them to exploit systems. I have talked about how Silver Tickets can be used to persist and even re-exploit an Active Directory enterprise in presentations at security conferences this year. This post continues this ...","author":{"@type":"Person","name":"Sean Metcalf"},"image":["https:\/\/adsecurity.org\/wp-content\/uploads\/2015\/11\/Mimikatz-Sekurlsa-LogonPasswords.png","https:\/\/adsecurity.org\/wp-content\/uploads\/2015\/11\/SilverTicket-DC-LDAP-Exploit-DCSync.png","https:\/\/adsecurity.org\/wp-content\/uploads\/2015\/11\/SilverTicket-DC-CIFS.png"]}</script>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><meta property="og:type" content="article" />
<meta property="og:title" content="How Attackers Use Kerberos Silver Tickets to Exploit Systems" />
<meta property="og:url" content="https://adsecurity.org/?p=2011" />
<meta property="og:site_name" content="Active Directory Security" />
<meta property="og:description" content="Usually Golden Tickets (forged Kerberos TGTs) get all the press, but this post is about Silver Tickets and how attackers use them to exploit systems. I have talked about how Silver Tickets can be used to persist and even re-exploit an Active Directory enterprise in presentations at security conferences this year. This post continues this ..." />
<meta property="og:updated_time" content="2017-12-30T00:19:53+00:00" />
<meta property="article:modified_time" content="2017-12-30T00:19:53+00:00" />
<meta property="article:published_time" content="2015-11-17T22:44:27+00:00" />
<meta property="og:image" content="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-CIFS.png" />
<meta property="og:image:width" content="956" />
<meta property="og:image:height" content="275" />
    </head>
    <body class="post-template-default single single-post postid-2011 single-format-standard custom-background wp-embed-responsive layout-boxed two_col_left two-columns singular">
        
        <div class="container boxed-wrapper">
            
                            <div id="top-bar" class="row clearfix top-bar ">
                    
                                                    
                            <div class="col-md-12 top-bar-items">
                                
                                                                                                    	<ul class="social-profiles">
							
			            <li class="social-profile social-profile-rss">
			            	<a href="https://adsecurity.org/?feed=rss2" title="Subscribe to Tech, News, and Other Ideations&#039;s RSS feed" id="social-id-1" class="mysocial social-rss">
			            				                            <i class="fa fa-rss"></i>
		                        			            	</a>
			            </li>
		            
		    	    </ul>
                                    
                                                                    <button type="button" class="search-toggle navbar-toggle collapsed" data-toggle="collapse" data-target="#top_search">
                                        <span class="sr-only">Toggle search form</span>
                                        <i class="fa fa-search-plus"></i>
                                    </button>

                                    <div id="top_search" class="top-search-form">
                                        <form class="searchform" method="get" action="https://adsecurity.org">
	<div class="input-group">
		<div class="form-group live-search-input">
			<label for="s" class="screen-reader-text">Search for:</label>
		    <input type="text" id="s" name="s" class="form-control" placeholder="Search">
		    		</div>
	    <span class="input-group-btn">
	    	<button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button>
	    </span>
    </div>
    </form>                                                                            </div>
                                
                                                            </div>

                        
                                    </div>
            

            <div id="header" class="row">

                <img src="https://adsecurity.org/wp-content/themes/graphene/images/headers/fluid.jpg" alt="Active Directory Security" title="Active Directory Security" width="960" height="198" />                
                                                                </div>


                        <nav class="navbar row navbar-inverse">

                <div class="navbar-header align-center">
                		                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu-wrap, #secondary-menu-wrap">
	                        <span class="sr-only">Toggle navigation</span>
	                        <span class="icon-bar"></span>
	                        <span class="icon-bar"></span>
	                        <span class="icon-bar"></span>
	                    </button>
                	                    
                    
                                            <p class="header_title">
                            <a href="https://adsecurity.org" title="Go back to the front page">                                Active Directory Security                            </a>                        </p>
                    
                                                    <p class="header_desc">Active Directory &amp; Enterprise Security, Methods to Secure Active Directory, Attack Methods &amp; Effective Defenses, PowerShell, Tech Notes, &amp; Geek Trivia&#8230;</p>
                                            
                                    </div>

                                    <div class="collapse navbar-collapse" id="header-menu-wrap">

            			<ul class="nav navbar-nav flip"><li ><a href="https://adsecurity.org/">Home</a></li><li class="menu-item menu-item-8"><a href="https://adsecurity.org/?page_id=8" >About</a></li><li class="menu-item menu-item-41"><a href="https://adsecurity.org/?page_id=41" >AD Resources</a></li><li class="menu-item menu-item-4031"><a href="https://adsecurity.org/?page_id=4031" >Attack Defense &#038; Detection</a></li><li class="menu-item menu-item-293"><a href="https://adsecurity.org/?page_id=293" >Contact</a></li><li class="menu-item menu-item-1821"><a href="https://adsecurity.org/?page_id=1821" >Mimikatz</a></li><li class="menu-item menu-item-1352"><a href="https://adsecurity.org/?page_id=1352" >Presentations</a></li><li class="menu-item menu-item-195"><a href="https://adsecurity.org/?page_id=195" >Schema Versions</a></li><li class="menu-item menu-item-399"><a href="https://adsecurity.org/?page_id=399" >Security Resources</a></li><li class="menu-item menu-item-183"><a href="https://adsecurity.org/?page_id=183" >SPNs</a></li><li class="menu-item menu-item-2532"><a href="https://adsecurity.org/?page_id=2532" >Top Posts</a></li></ul>                        
            			                        
                                            </div>
                
                                    
                            </nav>

            
            <div id="content" class="clearfix hfeed row">
                
                    
                                        
                    <div id="content-main" class="clearfix content-main col-md-8">
                    
	
		<div class="post-nav post-nav-top clearfix">
			<p class="previous col-sm-6"><i class="fa fa-arrow-circle-left"></i> <a href="https://adsecurity.org/?p=1684" rel="prev">The Most Common Active Directory Security Issues and What You Can Do to Fix Them</a></p>			<p class="next-post col-sm-6"><a href="https://adsecurity.org/?p=2053" rel="next">Dump Clear-Text Passwords for All Admins in the Domain Using Mimikatz DCSync</a> <i class="fa fa-arrow-circle-right"></i></p>					</div>
		        
<div id="post-2011" class="clearfix post post-2011 type-post status-publish format-standard has-post-thumbnail hentry category-activedirectorysecurity category-microsoft-security category-technical-reading category-technical-reference tag-activedirectory tag-blackhat tag-cifs tag-computeraccountpassword tag-derbycon tag-disablepasswordchange tag-domaincontroller tag-goldenticket tag-host tag-http tag-kerberoast tag-kerberos tag-kerberosattack tag-kerberossilverticket tag-krbtgt tag-ldap tag-mimikatz tag-mimikatzdcsync tag-pacvalidation tag-powershellremoting tag-rpcss tag-rsat tag-scheduledtask tag-serviceaccount tag-servicetosilverticketreference tag-silverticket tag-silverticketdcsync tag-silverticketreference tag-tgs tag-tgt tag-windowsfileshare tag-winrm tag-wmi item-wrap">
		
	<div class="entry clearfix">
    	
                    	<div class="post-date date alpha with-year">
            <p class="default_date">
            	<span class="month">Nov</span>
                <span class="day">17</span>
                	                <span class="year">2015</span>
                            </p>
                    </div>
            
		        <h1 class="post-title entry-title">
			How Attackers Use Kerberos Silver Tickets to Exploit Systems			        </h1>
		
			    <ul class="post-meta entry-meta clearfix">
	    		        <li class="byline">
	        	By <span class="author"><a href="https://adsecurity.org/?author=2" rel="author">Sean Metcalf</a></span><span class="entry-cat"> in <span class="terms"><a class="term term-category term-565" href="https://adsecurity.org/?cat=565">ActiveDirectorySecurity</a>, <a class="term term-category term-11" href="https://adsecurity.org/?cat=11">Microsoft Security</a>, <a class="term term-category term-4" href="https://adsecurity.org/?cat=4">Technical Reading</a>, <a class="term term-category term-2" href="https://adsecurity.org/?cat=2">Technical Reference</a></span></span>	        </li>
	        	    </ul>
    
				
				<div class="entry-content clearfix">
							
										
						<p>Usually Golden Tickets (forged Kerberos TGTs) get all the press, but this post is about Silver Tickets and how attackers use them to exploit systems.<br />
I have talked about how Silver Tickets can be used to persist and even re-exploit an Active Directory enterprise in <a href="https://adsecurity.org/?page_id=1352">presentations at security conferences </a>this year. This post continues this research.</p>
<p><span style="text-decoration: underline;"><strong>Typical Kerberos Authentication Flow:</strong></span></p>
<p>User logs on with username &amp; password.</p>
<p>1a. Password converted to NTLM hash, a timestamp is encrypted with the hash and sent to the KDC as an authenticator in the authentication ticket (TGT) request (AS-REQ).<br />
1b. The Domain Controller (KDC) checks user information (logon restrictions, group membership, etc) &amp; creates Ticket-Granting Ticket (TGT).</p>
<p>2. The TGT is encrypted, signed, &amp; delivered to the user (AS-REP). <i>Only the Kerberos service (KRBTGT) in the domain can open and read TGT data.</i></p>
<p>3. The User presents the TGT to the DC when requesting a Ticket Granting Service (TGS) ticket (TGS-REQ). The DC opens the TGT &amp; validates PAC checksum – If the DC can open the ticket &amp; the checksum check out, TGT = valid. The data in the TGT is effectively copied to create the TGS ticket.</p>
<p>4. The TGS is encrypted using the target service accounts’ NTLM password hash and sent to the user (TGS-REP).</p>
<p>5.The user connects to the server hosting the service on the appropriate port &amp; presents the TGS (AP-REQ). The service opens the TGS ticket using its NTLM password hash.</p>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>Silver Ticket Overview:</strong></span></p>
<p>Silver Tickets are forged Kerberos Ticket Granting Service (TGS) tickets, also called service tickets.<br />
As shown in the following graphic, there is no AS-REQ / AS-REP (steps 1 &amp; 2) and no TGS-REQ / TGS-REP (steps 3 &amp; 4) communication with the Domain Controller. Since a Silver Ticket is a forged TGS, there is <strong>no</strong> communication with a Domain Controller.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/04/Visio-SilverTicket-Comms.png"><img loading="lazy" class="alignnone wp-image-1519" src="https://adsecurity.org/wp-content/uploads/2015/04/Visio-SilverTicket-Comms.png" alt="Visio-SilverTicket-Comms" width="855" height="426" srcset="https://adsecurity.org/wp-content/uploads/2015/04/Visio-SilverTicket-Comms.png 1197w, https://adsecurity.org/wp-content/uploads/2015/04/Visio-SilverTicket-Comms-300x150.png 300w, https://adsecurity.org/wp-content/uploads/2015/04/Visio-SilverTicket-Comms-1024x511.png 1024w" sizes="(max-width: 855px) 100vw, 855px" /></a></p>
<ul>
<li>Alluded to at BlackHat during the “Golden Ticket” presentation (Duckwall/Delpy) and discussed partly during Tim Medin’s DerbyCon 2014 talk. Skip &amp; Benjamin have provided additional information on Silver Tickets since, but confusion remains.</li>
<li>The Kerberos Silver Ticket is a valid Ticket Granting Service (TGS) Kerberos ticket since it is encrypted/signed by the service account configured with a <a href="https://adsecurity.org/?p=230">Service Principal Name</a> for each server the Kerberos-authenticating service runs on.</li>
<li>While a Golden ticket is a forged TGT valid for gaining access to any Kerberos service, the silver ticket is a forged TGS. This means the Silver Ticket scope is limited to whatever service is targeted on a specific server.</li>
<li>While a Golden ticket is encrypted/signed with the domain Kerberos service account (<a href="https://adsecurity.org/?p=483">KRBTGT)</a>, a Silver Ticket is encrypted/signed by the service account (computer account credential extracted from the computer’s local SAM or service account credential).</li>
<li>Most services don’t validate the PAC (by sending the PAC checksum to the Domain Controller for PAC validation), so a valid TGS generated with the service account password hash can include a PAC that is entirely fictitious – even claiming the user is a Domain Admin without challenge or correction.</li>
<li>The attacker needs the service account password hash</li>
<li>TGS is forged, so no associated TGT, meaning the DC is never contacted.</li>
<li>Any event logs are on the targeted server.</li>
</ul>
<p><em>In my opinion, Silver Tickets can be more dangerous than Golden Tickets – while the scope is more limited than Golden Tickets, the required hash is easier to get and there is no communication with a DC when using them, so detection is more difficult than Golden Tickets.</em></p>
<p><span id="more-2011"></span><br />
<span style="text-decoration: underline;"><strong>Creating Silver Tickets:</strong></span></p>
<p>In order to create or forge a Silver Ticket, the attacker has to gain knowledge of the password data (password hash) for the target service. If the target service is running under the context of a user account, like MS SQL, then the Service Account&#8217; password hash is required in order to create a Silver Ticket.</p>
<p>Cracking Service Account passwords with <a href="https://github.com/nidem/kerberoast">Kerberoast </a>is one potential method for identifying a target service&#8217;s associated password data.</p>
<p>Computers host services as well with the most common one being the Windows file share which leverages the &#8220;cifs&#8221; service. Since the computer itself hosts this service, the password data required to create a Silver Ticket is the associated computer account&#8217;s password hash. When a computer is joined to Active Directory, a new computer account object is created and linked to the computer. The password and associated hash is stored on the computer that owns the account and the NTLM password hash is stored in the Active Directory database on the Domain Controllers for the domain.</p>
<p>If an attacker can gain admin rights to the computer (to gain debug access) or be able to run code as local System, the attacker can dump the AD computer account password hash from the system using Mimikatz (the NTLM password hash is used to encrypt RC4 Kerberos tickets):</p>
<p><em>Mimikatz &#8220;privilege::debug&#8221; &#8220;sekurlsa::logonpasswords&#8221; exit</em></p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/Mimikatz-Sekurlsa-LogonPasswords1.png"><img loading="lazy" class="alignnone wp-image-2030" src="https://adsecurity.org/wp-content/uploads/2015/11/Mimikatz-Sekurlsa-LogonPasswords1.png" alt="Mimikatz-Sekurlsa-LogonPasswords" width="574" height="541" srcset="https://adsecurity.org/wp-content/uploads/2015/11/Mimikatz-Sekurlsa-LogonPasswords1.png 672w, https://adsecurity.org/wp-content/uploads/2015/11/Mimikatz-Sekurlsa-LogonPasswords1-300x283.png 300w" sizes="(max-width: 574px) 100vw, 574px" /></a></p>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>Mimikatz Silver Ticket Command Reference</strong></span></p>
<p>The Mimikatz command to create a golden or silver ticket is “kerberos::golden”</p>
<ul type="disc">
<li><strong>/domain</strong> &#8211; the fully qualified domain name. In this example: “lab.adsecurity.org”.</li>
<li><strong>/sid</strong> &#8211; the SID of the domain. In this example: “S-1-5-21-1473643419-774954089-2222329127”.</li>
<li><strong>/user</strong> &#8211; username to impersonate</li>
<li><strong>/groups</strong> (optional) – group RIDs the user is a member of (the first is the primary group)<br />
default: 513,512,520,518,519 for the well-known Administrator&#8217;s groups (listed below).</li>
<li><strong>/ticket</strong> (optional) – provide a path and name for saving the Golden Ticket file to for later use or use /ptt to immediately inject the golden ticket into memory for use.</li>
<li><strong>/ptt</strong> – as an alternate to /ticket – use this to immediately inject the forged ticket into memory for use.</li>
<li><strong>/id</strong> (optional) &#8211; user RID. Mimikatz default is 500 (the default Administrator account RID).</li>
<li><strong>/startoffset</strong> (optional) – the start offset when the ticket is available (generally set to –10 or 0 if this option is used). Mimikatz Default value is 0.</li>
<li><strong>/endin</strong> (optional) – ticket lifetime. Mimikatz Default value is 10 years (~5,262,480 minutes). Active Directory default Kerberos policy setting is 10 hours (600 minutes).</li>
<li><strong>/renewmax</strong> (optional) – maximum ticket lifetime with renewal. Mimikatz Default value is 10 years (~5,262,480 minutes). Active Directory default Kerberos policy setting is 7 days (10,080 minutes).</li>
</ul>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;">Silver Ticket Required Parameters:</span></p>
<ul type="disc">
<li><strong>/target</strong> – the target server’s FQDN.</li>
<li><strong>/service</strong> – the kerberos service running on the target server. This is the Service Principal Name class (or type) such as cifs, http, mssql.</li>
<li><strong>/rc4</strong> – the NTLM hash for the service (computer account or user account)</li>
</ul>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;">Silver Ticket Default Groups:</span></p>
<ul type="disc">
<li>Domain Users SID: S-1-5-21&lt;DOMAINID&gt;-513</li>
<li>Domain Admins SID: S-1-5-21&lt;DOMAINID&gt;-512</li>
<li>Schema Admins SID: S-1-5-21&lt;DOMAINID&gt;-518</li>
<li>Enterprise Admins SID: S-1-5-21&lt;DOMAINID&gt;-519</li>
<li>Group Policy Creator Owners SID: S-1-5-21&lt;DOMAINID&gt;-520</li>
</ul>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;">Example Mimikatz Command to Create a Silver Ticket:</span></p>
<p>The following Mimikatz command creates a Silver Ticket for the CIFS service on the server adsmswin2k8r2.lab.adsecurity.org. In order for this Silver Ticket to be successfully created, the AD computer account password hash for adsmswin2k8r2.lab.adsecurity.org needs to be discovered, either from an AD domain dump or by running Mimikatz on the local system as shown above (<em>Mimikatz &#8220;privilege::debug&#8221; &#8220;sekurlsa::logonpasswords&#8221; exit</em>). The NTLM password hash is used with the /rc4 paramteer. The service SPN type also needs to be identified in the /service parameter. Finally, the target computer&#8217;s fully-qualified domain name needs to be provided in the /target parameter. Don&#8217;t forget the domain SID in the /sid parameter.</p>
<p><em>mimikatz “kerberos::golden /admin:LukeSkywalker /id:1106 /domain:lab.adsecurity.org /sid:S-1-5-21-1473643419-774954089-2222329127 /target:adsmswin2k8r2.lab.adsecurity.org /rc4:d7e2b80507ea074ad59f152a1ba20458 /service:cifs /ptt” exit</em></p>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>Persistence With Computer Accounts</strong></span></p>
<p>Once the attacker has access to the computer account password hash, the account can be used as a &#8220;user&#8221; account to query Active Directory, but the more interesting use case is to create Silver Tickets to access computer hosted services with admin rights. Since the <a href="https://adsecurity.org/?p=280">Domain computer account password change policies</a> are more of a guideline since they aren&#8217;t forced to change by the Domain Controllers (set to 30 days by default but up to the computer to actually change the password), it&#8217;s possible that once an attacker gains knowledge of the computer account password, it could be used for a long time. Active Directory does not prevent a computer account from accessing AD resources even if the computer account password hasn&#8217;t changed in years.</p>
<p>The attacker could also prevent the computer account password from changing:</p>
<ol>
<li>the following registry key: <em>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\DisablePasswordChange = 1</em>.</li>
<li>There&#8217;s a client Group Policy setting to prevent the computer from changing the password most often used to support VDI (virtual desktops). Enabling the group policy setting &#8220;<a href="https://technet.microsoft.com/en-us/library/jj852191.aspx">Domain member: Disable machine account password changes</a>&#8221; stops computers applying this GPO from changing their AD computer account password.<br />
<em>&#8220;The Domain member: Disable machine account password changes policy setting determines whether a domain member periodically changes its computer account password. Setting its value to Enabled prevents the domain member from changing the computer account password. Setting it to Disabled allows the domain member to change the computer account password as specified by the value of the Domain member: Maximum machine account password age policy setting, which is every 30 days by default.&#8221;<br />
</em></li>
<li>The domain Group Policy &#8220;<a href="https://technet.microsoft.com/en-us/library/jj852252.aspx">Domain member: Maximum machine account password age</a>&#8221; which tells the domain joined computers how often they should change their computer account password (though this is <a href="https://adsecurity.org/?p=280">more of a guideline, than a rule</a>). By default, this value is set to &#8220;30&#8221;, but if it is set to &#8220;0&#8221;, computers are unable to change their passwords.</li>
<li> There&#8217;s a Domain Controller Group Policy setting &#8220;<a href="https://technet.microsoft.com/en-us/library/cc739351%28v=ws.10%29.aspx">Domain controller: Refuse machine account password changes</a>&#8221; that sets the Domain Controller to prevent clients from updating their computer account password in AD.<br />
<em>&#8220;This security setting determines whether domain controllers will refuse requests from member computers to change computer account passwords. By default, member computers change their computer account passwords every 30 days. If enabled, the domain controller will refuse computer account password change requests.</em><br />
<em>If it is enabled, this setting does not allow a domain controller to accept any changes to a computer account&#8217;s password.&#8221;<br />
</em></li>
</ol>
<p>This is a valid (and current) method for an attacker to persist access even after all the user, admin, and service account passwords are changed.</p>
<p>In normal Kerberos operations, the authentication ticket (TGT) is used to request service tickets (TGS) for each Kerberos enabled service. Silver Tickets bypass this normal process by injecting the forged Kerberos TGS tickets directly. Multiple Silver Tickets may be required to access the target service(s).</p>
<p>The most useful computer-hosted services and the associated silver ticket services required is in the table below.</p>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>Detecting Silver Tickets:</strong></span></p>
<p>The best chance of detecting Silver Tickets is to monitor Windows security events on workstations, servers, and Domain Controllers for <a href="https://adsecurity.org/?p=1515">logon/logoff events with anomalies in the domain field including the field being blank or null</a>.</p>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>Service to Silver Ticket Reference:</strong></span></p>
<p>&nbsp;</p>
<div>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td><span style="text-decoration: underline;"><strong>Service Type<br />
</strong></span></td>
<td><span style="text-decoration: underline;"><strong>Service Silver Tickets</strong></span></td>
</tr>
<tr>
<td>WMI</td>
<td>HOST<br />
RPCSS</td>
</tr>
<tr>
<td>PowerShell Remoting</td>
<td>HOST<br />
HTTP</p>
<p>Depending on OS version may also need:<br />
WSMAN<br />
RPCSS</td>
</tr>
<tr>
<td>WinRM</td>
<td>HOST<br />
HTTP</td>
</tr>
<tr>
<td>Scheduled Tasks</td>
<td>HOST</td>
</tr>
<tr>
<td>Windows File Share (CIFS)</td>
<td>CIFS</td>
</tr>
<tr>
<td>LDAP operations including Mimikatz DCSync</td>
<td>LDAP</td>
</tr>
<tr>
<td>Windows Remote Server Administration Tools</td>
<td>RPCSS<br />
LDAP<br />
CIFS</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>Silver Ticket Exploit Examples:</strong></span></p>
<p>In these examples, the attacker has gained knowledge of the computer account&#8217;s password hash and uses it to create a Silver Ticket to gain admin rights to different services hosted by the computer. If the attacker has dumped the Active Directory database or gained knowledge of a Domain Controller&#8217;s computer account password, the attacker can use Silver Tickets to target the DC&#8217;s services as an admin and persist in Active Directory.<strong><br />
</strong></p>
<p><strong><br />
Silver Ticket for Windows Share (CIFS) Admin Access</strong></p>
<p>Create a Silver Ticket for the &#8220;<a href="https://adsecurity.org/?page_id=183">cifs</a>&#8221; service to gain admin rights to any Windows share on the target computer.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-CIFS.png"><img loading="lazy" class="alignnone size-full wp-image-2014" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-CIFS.png" alt="SilverTicket-DC-CIFS" width="956" height="275" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-CIFS.png 956w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-CIFS-300x86.png 300w" sizes="(max-width: 956px) 100vw, 956px" /></a></p>
<p>After injecting the CIFS Silver Ticket, we can now access any share on the target computer including the c$ share enabling us to copy files to or from the share. If we use a fake name in the Silver Ticket, we can make it look like someone else accessed the data.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-CIFS-Exploit.png"><img loading="lazy" class="alignnone size-full wp-image-2015" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-CIFS-Exploit.png" alt="SilverTicket-DC-CIFS-Exploit" width="792" height="324" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-CIFS-Exploit.png 792w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-CIFS-Exploit-300x123.png 300w" sizes="(max-width: 792px) 100vw, 792px" /></a></p>
<p><strong><br />
Silver Ticket for the Windows computer (HOST) with Admin Access</strong></p>
<p>Create a Silver Ticket to gain admin rights to any Windows service covered by &#8220;<a href="https://adsecurity.org/?page_id=183">host</a>&#8221; on the target computer. This includes the ability to modify and create scheduled tasks.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST.png"><img loading="lazy" class="alignnone size-full wp-image-2016" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST.png" alt="SilverTicket-DC-HOST" width="968" height="292" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST.png 968w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-300x90.png 300w" sizes="(max-width: 968px) 100vw, 968px" /></a></p>
<p>Leveraging the HOST Silver Ticket, we can create a new scheduled task.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit01.png"><img loading="lazy" class="alignnone size-full wp-image-2017" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit01.png" alt="SilverTicket-DC-HOST-Exploit01" width="967" height="178" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit01.png 967w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit01-300x55.png 300w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit01-960x178.png 960w" sizes="(max-width: 967px) 100vw, 967px" /></a></p>
<p>Or by leveraging the HOST Silver Ticket, we can <em>modify</em> an exist scheduled task.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit02.png"><img loading="lazy" class="alignnone size-full wp-image-2018" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit02.png" alt="SilverTicket-DC-HOST-Exploit02" width="966" height="56" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit02.png 966w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit02-300x17.png 300w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit02-960x56.png 960w" sizes="(max-width: 966px) 100vw, 966px" /></a></p>
<p>Check to see if the scheduled task was set. Yes, it&#8217;s there!</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit03.png"><img loading="lazy" class="alignnone size-full wp-image-2019" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit03.png" alt="SilverTicket-DC-HOST-Exploit03" width="646" height="84" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit03.png 646w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HOST-Exploit03-300x39.png 300w" sizes="(max-width: 646px) 100vw, 646px" /></a></p>
<p><strong><br />
Silver Ticket to Connect to PowerShell Remoting on Windows Computer with Admin Access</strong></p>
<p>Create a Silver Ticket for the &#8220;<a href="https://adsecurity.org/?page_id=183">http</a>&#8221; service and &#8220;<a href="https://adsecurity.org/?page_id=183">wsman</a>&#8221; service to gain admin rights to WinRM and/or PowerShell Remoting on the target system.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HTTP.png"><img loading="lazy" class="alignnone size-full wp-image-2020" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HTTP.png" alt="SilverTicket-DC-HTTP" width="958" height="251" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HTTP.png 958w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-HTTP-300x79.png 300w" sizes="(max-width: 958px) 100vw, 958px" /></a></p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-WSMAN.png"><img loading="lazy" class="alignnone size-full wp-image-2025" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-WSMAN.png" alt="SilverTicket-DC-WSMAN" width="965" height="252" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-WSMAN.png 965w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-WSMAN-300x78.png 300w" sizes="(max-width: 965px) 100vw, 965px" /></a></p>
<p>After injecting the two Silver Tickets, <a href="https://adsecurity.org/?page_id=183">http </a>&amp; <a href="https://adsecurity.org/?page_id=183">wsman</a>, we can use PowerShell Remoting (or WinRM) to open a a shell to the target system (assuming it&#8217;s configured with PowerShell Remoting and/or WinRM). New-PSSession is the PowerShell cmdlet for creating a session to a remote system using PowerShell and Enter-PSSession opens the remote shell.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/PowerShell-Remoting-Connect-To-ADSDC02.jpg"><img loading="lazy" class="alignnone size-full wp-image-2027" src="https://adsecurity.org/wp-content/uploads/2015/11/PowerShell-Remoting-Connect-To-ADSDC02.jpg" alt="PowerShell-Remoting-Connect-To-ADSDC02" width="691" height="381" srcset="https://adsecurity.org/wp-content/uploads/2015/11/PowerShell-Remoting-Connect-To-ADSDC02.jpg 691w, https://adsecurity.org/wp-content/uploads/2015/11/PowerShell-Remoting-Connect-To-ADSDC02-300x165.jpg 300w" sizes="(max-width: 691px) 100vw, 691px" /></a></p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-PSRemotingExploit2.png"><img loading="lazy" class="alignnone size-full wp-image-2024" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-PSRemotingExploit2.png" alt="SilverTicket-DC-PSRemotingExploit2" width="644" height="277" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-PSRemotingExploit2.png 644w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-PSRemotingExploit2-300x129.png 300w" sizes="(max-width: 644px) 100vw, 644px" /></a></p>
<p><strong><br />
Silver Ticket to Connect to LDAP on Windows Computer with Admin Access</strong></p>
<p>Create a Silver Ticket for the &#8220;<a href="https://adsecurity.org/?page_id=183">ldap</a>&#8221; service to gain admin rights to LDAP services on the target system (including Active Directory).</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-LDAP.png"><img loading="lazy" class="alignnone size-full wp-image-2021" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-LDAP.png" alt="SilverTicket-DC-LDAP" width="838" height="248" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-LDAP.png 838w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-LDAP-300x89.png 300w" sizes="(max-width: 838px) 100vw, 838px" /></a></p>
<p>Leveraging the LDAP Silver Ticket, we can use Mimikatz and run DCSync to &#8220;replicate&#8221; credentials from the DC.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-LDAP-Exploit-DCSync.png"><img loading="lazy" class="alignnone size-full wp-image-2022" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-LDAP-Exploit-DCSync.png" alt="SilverTicket-DC-LDAP-Exploit-DCSync" width="776" height="590" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-LDAP-Exploit-DCSync.png 776w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-DC-LDAP-Exploit-DCSync-300x228.png 300w" sizes="(max-width: 776px) 100vw, 776px" /></a></p>
<p><strong><br />
Silver Ticket to Run Commands Remotely on a Windows Computer with WMI as an admin<br />
</strong></p>
<p>Create a Silver Ticket for the &#8220;<a href="https://adsecurity.org/?page_id=183">host</a>&#8221; service and &#8220;<a href="https://adsecurity.org/?page_id=183">rpcss</a>&#8221; service to remotely execute commands on the target system using WMI.</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-Host.jpg"><img loading="lazy" class="alignnone size-full wp-image-2035" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-Host.jpg" alt="SilverTicket-adsdc02-Host" width="847" height="393" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-Host.jpg 847w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-Host-300x139.jpg 300w" sizes="(max-width: 847px) 100vw, 847px" /></a> <a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-rpcss.jpg"><img loading="lazy" class="alignnone size-full wp-image-2036" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-rpcss.jpg" alt="SilverTicket-adsdc02-rpcss" width="844" height="396" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-rpcss.jpg 844w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-rpcss-300x141.jpg 300w" sizes="(max-width: 844px) 100vw, 844px" /></a></p>
<p>After injecting these Silver Tickets, we can confirm that the Kerberos TGS tickets are in memory by running &#8220;klist&#8221;</p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-klist.jpg"><img loading="lazy" class="alignnone size-full wp-image-2037" src="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-klist.jpg" alt="SilverTicket-adsdc02-klist" width="501" height="301" srcset="https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-klist.jpg 501w, https://adsecurity.org/wp-content/uploads/2015/11/SilverTicket-adsdc02-klist-300x180.jpg 300w" sizes="(max-width: 501px) 100vw, 501px" /></a></p>
<p>After injecting the Silver Tickets, we can call WMIC or Invoke-WmiMethod by &#8220;passing the ticket&#8221; to run a command on the target system.<br />
<em>Invoke-WmiMethod win32_process -ComputerName $Computer -Credential $Creds -name create -argumentlist &#8220;$RunCommand&#8221;</em></p>
<p><a href="https://adsecurity.org/wp-content/uploads/2015/11/WMIC-PTT-Remote-VSS-Copy-NTDSdit.png"><img loading="lazy" class="alignnone size-full wp-image-2038" src="https://adsecurity.org/wp-content/uploads/2015/11/WMIC-PTT-Remote-VSS-Copy-NTDSdit.png" alt="WMIC-PTT-Remote-VSS-Copy-NTDSdit" width="803" height="128" srcset="https://adsecurity.org/wp-content/uploads/2015/11/WMIC-PTT-Remote-VSS-Copy-NTDSdit.png 803w, https://adsecurity.org/wp-content/uploads/2015/11/WMIC-PTT-Remote-VSS-Copy-NTDSdit-300x48.png 300w" sizes="(max-width: 803px) 100vw, 803px" /></a></p>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>References:</strong></span></p>
<ul>
<li><a href="https://www.youtube.com/watch?v=-IMrNGPZTl0&amp;index=4&amp;list=UUbbgnifxfH-nqx6z9XQ963Q">Abusing Microsoft Kerberos Sorry You Guys Don’t Get It  (aka the Mimikatz Golden Ticket Presentation) – Skip Duckwall &amp; Benjamin Delpy</a></li>
<li><a href="http://passing-the-hash.blogspot.com/2014/09/pac-validation-20-minute-rule-and.html">PAC Validation issue aka the Silver Ticket description from the Passing the Hash Blog</a></li>
<li>Kerberoast: Tim Medin&#8217;s <a href="http://www.irongeek.com/i.php?page=videos/derbycon4/t120-attacking-microsoft-kerberos-kicking-the-guard-dog-of-hades-tim-medin">Attacking Microsoft Kerberos: Kicking the Guard Dog of Hades</a>” presentation at DerbyCon 2014. [Slides: <a href="https://www.dropbox.com/s/1j6v6zbtsdg1kam/Kerberoast.pdf?dl=0">https://www.dropbox.com/s/1j6v6zbtsdg1kam/Kerberoast.pdf?dl=0</a> ]</li>
<li><a href="https://adsecurity.org/?p=556">Mimikatz and Active Directory Kerberos Attacks </a></li>
<li><a href="https://adsecurity.org/?p=1515">Detecting Forged Kerberos Ticket (Golden Ticket &amp; Silver Ticket) Use in Active Directory </a></li>
<li><a href="https://adsecurity.org/?page_id=183">Service Principal Name Reference (SPN) Guide</a></li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="tptn_counter" id="tptn_counter_2011">(Visited 58,115 times, 19 visits today)</div>								</div>
		
			    <ul class="entry-footer">
	    		        <li class="post-tags col-sm-8"><i class="fa fa-tags" title="Tags"></i> <span class="terms"><a class="term term-tagpost_tag term-20" href="https://adsecurity.org/?tag=activedirectory">ActiveDirectory</a>, <a class="term term-tagpost_tag term-397" href="https://adsecurity.org/?tag=blackhat">BlackHat</a>, <a class="term term-tagpost_tag term-456" href="https://adsecurity.org/?tag=cifs">CIFS</a>, <a class="term term-tagpost_tag term-675" href="https://adsecurity.org/?tag=computeraccountpassword">ComputerAccountPassword</a>, <a class="term term-tagpost_tag term-133" href="https://adsecurity.org/?tag=derbycon">DerbyCon</a>, <a class="term term-tagpost_tag term-672" href="https://adsecurity.org/?tag=disablepasswordchange">DisablePasswordChange</a>, <a class="term term-tagpost_tag term-101" href="https://adsecurity.org/?tag=domaincontroller">DomainController</a>, <a class="term term-tagpost_tag term-303" href="https://adsecurity.org/?tag=goldenticket">GoldenTicket</a>, <a class="term term-tagpost_tag term-668" href="https://adsecurity.org/?tag=host">host</a>, <a class="term term-tagpost_tag term-670" href="https://adsecurity.org/?tag=http">http</a>, <a class="term term-tagpost_tag term-673" href="https://adsecurity.org/?tag=kerberoast">Kerberoast</a>, <a class="term term-tagpost_tag term-81" href="https://adsecurity.org/?tag=kerberos">Kerberos</a>, <a class="term term-tagpost_tag term-290" href="https://adsecurity.org/?tag=kerberosattack">KerberosAttack</a>, <a class="term term-tagpost_tag term-206" href="https://adsecurity.org/?tag=kerberossilverticket">KerberosSilverTicket</a>, <a class="term term-tagpost_tag term-394" href="https://adsecurity.org/?tag=krbtgt">KRBTGT</a>, <a class="term term-tagpost_tag term-671" href="https://adsecurity.org/?tag=ldap">ldap</a>, <a class="term term-tagpost_tag term-207" href="https://adsecurity.org/?tag=mimikatz">mimikatz</a>, <a class="term term-tagpost_tag term-599" href="https://adsecurity.org/?tag=mimikatzdcsync">MimikatzDCSync</a>, <a class="term term-tagpost_tag term-314" href="https://adsecurity.org/?tag=pacvalidation">PACValidation</a>, <a class="term term-tagpost_tag term-477" href="https://adsecurity.org/?tag=powershellremoting">PowerShellRemoting</a>, <a class="term term-tagpost_tag term-669" href="https://adsecurity.org/?tag=rpcss">rpcss</a>, <a class="term term-tagpost_tag term-680" href="https://adsecurity.org/?tag=rsat">RSAT</a>, <a class="term term-tagpost_tag term-677" href="https://adsecurity.org/?tag=scheduledtask">ScheduledTask</a>, <a class="term term-tagpost_tag term-674" href="https://adsecurity.org/?tag=serviceaccount">ServiceAccount</a>, <a class="term term-tagpost_tag term-676" href="https://adsecurity.org/?tag=servicetosilverticketreference">ServiceToSilverTicketReference</a>, <a class="term term-tagpost_tag term-304" href="https://adsecurity.org/?tag=silverticket">SilverTicket</a>, <a class="term term-tagpost_tag term-679" href="https://adsecurity.org/?tag=silverticketdcsync">SilverTicketDCSync</a>, <a class="term term-tagpost_tag term-667" href="https://adsecurity.org/?tag=silverticketreference">SilverTicketReference</a>, <a class="term term-tagpost_tag term-528" href="https://adsecurity.org/?tag=tgs">TGS</a>, <a class="term term-tagpost_tag term-529" href="https://adsecurity.org/?tag=tgt">TGT</a>, <a class="term term-tagpost_tag term-678" href="https://adsecurity.org/?tag=windowsfileshare">WindowsFileShare</a>, <a class="term term-tagpost_tag term-476" href="https://adsecurity.org/?tag=winrm">WinRM</a>, <a class="term term-tagpost_tag term-546" href="https://adsecurity.org/?tag=wmi">WMI</a></span></li>
	        	        <li class="addthis col-sm-8"><div class="add-this"></div></li>
	        	    </ul>
    	</div>

</div>

    <div class="entry-author">
        <div class="row">
            <div class="author-avatar col-sm-3">
            	<a href="https://adsecurity.org/?author=2" rel="author">
					<img alt='' src='https://secure.gravatar.com/avatar/1f3ad5e878e5d0e6096c5a33718a04d0?s=200&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f3ad5e878e5d0e6096c5a33718a04d0?s=400&#038;d=mm&#038;r=g 2x' class='avatar avatar-200 photo' height='200' width='200' loading='lazy'/>                </a>
            </div>

            <div class="author-bio col-sm-9">
                <h3 class="section-title-sm">Sean Metcalf</h3>
                <p>I improve security for enterprises around the world working for TrimarcSecurity.com<br />
Read the About page (top left) for information about me. :)<br />
https://adsecurity.org/?page_id=8</p>
    <ul class="author-social">
    	        
			        <li><a href="mailto:sean@adsecurity.org"><i class="fa fa-envelope-o"></i></a></li>
            </ul>
                </div>
        </div>
    </div>
    









<div id="comments" class="clearfix no-ping">
        	<h4 class="comments current">
            <i class="fa fa-comments-o"></i> 2 comments        </h4>
	        
    
	
	    <div class="comments-list-wrapper">
        <ol class="clearfix comments-list" id="comments_list">
            		<li id="comment-9729" class="comment even thread-even depth-1 comment">
			<div class="row">
								
											
				<div class="comment-wrap col-md-12">
					
                        <ul class="comment-meta">
                <li class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/fa0b917cf6e17fedd059c21720428cbb?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fa0b917cf6e17fedd059c21720428cbb?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></li>
                <li class="comment-attr"><span class="comment-author">jd</span> on <span class="comment-date">November 18, 2015 <span class="time">at 11:00 am</span></span></li>
                <li class="single-comment-link"><a href="https://adsecurity.org/?p=2011#comment-9729">#</a></li>
            </ul>
    
					<div class="comment-entry">
												
													<p>In your examples, mimikatz&#8217;s &#8220;/rc4:&#8221; parameter refers to computer&#8217;s account NTLM hash ?<br />
That piece of information is essential for these attacks to succeed.<br />
Am I right ?</p>
												
											</div>
				</div>
			
							</div>
	<ol class="children">
		<li id="comment-9731" class="comment byuser comment-author-seanmetcalf bypostauthor odd alt depth-2 comment">
			<div class="row">
								
											
				<div class="comment-wrap col-md-12">
					
                        <ul class="comment-meta">
                <li class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/843fd885d49f892c4bc60ed0f9eef40b?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/843fd885d49f892c4bc60ed0f9eef40b?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></li>
                <li class="comment-attr"><span class="comment-author"><a href='http://ADSecurity.org' rel='external'>Sean Metcalf</a></span> on <span class="comment-date">November 19, 2015 <span class="time">at 7:21 pm</span></span><br /><span class="label label-primary author-cred">Author</span></li>
                <li class="single-comment-link"><a href="https://adsecurity.org/?p=2011#comment-9731">#</a></li>
            </ul>
    
					<div class="comment-entry">
												
													<p>Yes. Post updated to clarify.</p>
												
											</div>
				</div>
			
							</div>
	</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
        </ol>
       	
            </div>
        
        
    </div>


	<div id="respond">
		<h3 id="reply-title"><i class="fa fa-comment-o"></i> Comments have been disabled.</h3>
            </div>



            
  

                </div><!-- #content-main -->
        
            
<div id="sidebar1" class="sidebar sidebar-right widget-area col-md-4">

	
    
		<div id="recent-posts-4" class="sidebar-wrap widget_recent_entries">
		<h3>Recent Posts</h3>
		<ul>
											<li>
					<a href="https://adsecurity.org/?p=4367">Attacking Active Directory Group Managed Service Accounts (GMSAs)</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4277">From Azure AD to Active Directory (via Azure) &#8211; An Unanticipated Attack Path</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4211">What is Azure Active Directory?</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4179">Slides Posted for Black Hat USA 2019 Talk: Attacking &#038; Defending the Microsoft Cloud</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4187">AD Reading: Windows Server 2019 Active Directory Features</a>
									</li>
					</ul>

		</div><div id="text-3" class="sidebar-wrap widget_text"><h3>Trimarc Active Directory Security Services</h3>			<div class="textwidget">Have concerns about your Active Directory environment?

Trimarc helps enterprises improve their security posture. <p>
<a href="http://trimarcsecurity.com/security-services">Find out how...</a> 
TrimarcSecurity.com</div>
		</div><div id="widget_tptn_pop-4" class="sidebar-wrap tptn_posts_list_widget"><h3>Popular Posts</h3><div class="tptn_posts  tptn_posts_widget tptn_posts_widget4"><ul><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2362"     class="tptn_link"><span class="tptn_title">Attack Methods for Gaining Domain Admin Rights in&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=478"     class="tptn_link"><span class="tptn_title">PowerShell Encoding &#038; Decoding (Base64)</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=483"     class="tptn_link"><span class="tptn_title">Kerberos &#038; KRBTGT: Active Directory&#8217;s&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=3377"     class="tptn_link"><span class="tptn_title">Securing Domain Controllers to Improve Active&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2288"     class="tptn_link"><span class="tptn_title">Finding Passwords in SYSVOL &#038; Exploiting Group&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=3299"     class="tptn_link"><span class="tptn_title">Securing Windows Workstations: Developing a Secure Baseline</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1684"     class="tptn_link"><span class="tptn_title">The Most Common Active Directory Security Issues and&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2653"     class="tptn_link"><span class="tptn_title">Building an Effective Active Directory Lab&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1729"     class="tptn_link"><span class="tptn_title">Mimikatz DCSync Usage, Exploitation, and Detection</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1790"     class="tptn_link"><span class="tptn_title">Microsoft Local Administrator Password Solution (LAPS)</span></a></span></li></ul><div class="tptn_clear"></div></div></div><div id="categories-4" class="sidebar-wrap widget_categories"><h3>Categories</h3>
			<ul>
					<li class="cat-item cat-item-565"><a href="https://adsecurity.org/?cat=565">ActiveDirectorySecurity</a>
</li>
	<li class="cat-item cat-item-55"><a href="https://adsecurity.org/?cat=55">Apple Security</a>
</li>
	<li class="cat-item cat-item-431"><a href="https://adsecurity.org/?cat=431">Cloud Security</a>
</li>
	<li class="cat-item cat-item-17"><a href="https://adsecurity.org/?cat=17">Continuing Education</a>
</li>
	<li class="cat-item cat-item-396"><a href="https://adsecurity.org/?cat=396">Entertainment</a>
</li>
	<li class="cat-item cat-item-347"><a href="https://adsecurity.org/?cat=347">Exploit</a>
</li>
	<li class="cat-item cat-item-1039"><a href="https://adsecurity.org/?cat=1039">Hacking</a>
</li>
	<li class="cat-item cat-item-168"><a href="https://adsecurity.org/?cat=168">Hardware Security</a>
</li>
	<li class="cat-item cat-item-172"><a href="https://adsecurity.org/?cat=172">Hypervisor Security</a>
</li>
	<li class="cat-item cat-item-126"><a href="https://adsecurity.org/?cat=126">Linux/Unix Security</a>
</li>
	<li class="cat-item cat-item-343"><a href="https://adsecurity.org/?cat=343">Malware</a>
</li>
	<li class="cat-item cat-item-11"><a href="https://adsecurity.org/?cat=11">Microsoft Security</a>
</li>
	<li class="cat-item cat-item-819"><a href="https://adsecurity.org/?cat=819">Mitigation</a>
</li>
	<li class="cat-item cat-item-48"><a href="https://adsecurity.org/?cat=48">Network/System Security</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://adsecurity.org/?cat=7">PowerShell</a>
</li>
	<li class="cat-item cat-item-698"><a href="https://adsecurity.org/?cat=698">RealWorld</a>
</li>
	<li class="cat-item cat-item-21"><a href="https://adsecurity.org/?cat=21">Security</a>
</li>
	<li class="cat-item cat-item-234"><a href="https://adsecurity.org/?cat=234">Security Conference Presentation/Video</a>
</li>
	<li class="cat-item cat-item-1045"><a href="https://adsecurity.org/?cat=1045">Security Recommendation</a>
</li>
	<li class="cat-item cat-item-24"><a href="https://adsecurity.org/?cat=24">Technical Article</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://adsecurity.org/?cat=4">Technical Reading</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://adsecurity.org/?cat=2">Technical Reference</a>
</li>
	<li class="cat-item cat-item-156"><a href="https://adsecurity.org/?cat=156">TheCloud</a>
</li>
	<li class="cat-item cat-item-930"><a href="https://adsecurity.org/?cat=930">Vulnerability</a>
</li>
			</ul>

			</div><div id="tag_cloud-3" class="sidebar-wrap widget_tag_cloud"><h3>Tags</h3><div class="tagcloud"><a href="https://adsecurity.org/?tag=activedirectory" class="tag-cloud-link tag-link-20 tag-link-position-1" style="font-size: 22pt;" aria-label="ActiveDirectory (52 items)">ActiveDirectory</a>
<a href="https://adsecurity.org/?tag=active-directory" class="tag-cloud-link tag-link-75 tag-link-position-2" style="font-size: 10.531914893617pt;" aria-label="Active Directory (8 items)">Active Directory</a>
<a href="https://adsecurity.org/?tag=activedirectoryattack" class="tag-cloud-link tag-link-537 tag-link-position-3" style="font-size: 8pt;" aria-label="ActiveDirectoryAttack (5 items)">ActiveDirectoryAttack</a>
<a href="https://adsecurity.org/?tag=activedirectorysecurity" class="tag-cloud-link tag-link-113 tag-link-position-4" style="font-size: 13.957446808511pt;" aria-label="ActiveDirectorySecurity (14 items)">ActiveDirectorySecurity</a>
<a href="https://adsecurity.org/?tag=active-directory-security" class="tag-cloud-link tag-link-976 tag-link-position-5" style="font-size: 9.7872340425532pt;" aria-label="Active Directory Security (7 items)">Active Directory Security</a>
<a href="https://adsecurity.org/?tag=adreading" class="tag-cloud-link tag-link-5 tag-link-position-6" style="font-size: 13.510638297872pt;" aria-label="ADReading (13 items)">ADReading</a>
<a href="https://adsecurity.org/?tag=adsecurity" class="tag-cloud-link tag-link-86 tag-link-position-7" style="font-size: 10.531914893617pt;" aria-label="ADSecurity (8 items)">ADSecurity</a>
<a href="https://adsecurity.org/?tag=ad-security" class="tag-cloud-link tag-link-100 tag-link-position-8" style="font-size: 8pt;" aria-label="AD Security (5 items)">AD Security</a>
<a href="https://adsecurity.org/?tag=dcsync" class="tag-cloud-link tag-link-598 tag-link-position-9" style="font-size: 10.531914893617pt;" aria-label="DCSync (8 items)">DCSync</a>
<a href="https://adsecurity.org/?tag=defcon" class="tag-cloud-link tag-link-518 tag-link-position-10" style="font-size: 8pt;" aria-label="DEFCON (5 items)">DEFCON</a>
<a href="https://adsecurity.org/?tag=domaincontroller" class="tag-cloud-link tag-link-101 tag-link-position-11" style="font-size: 15.446808510638pt;" aria-label="DomainController (18 items)">DomainController</a>
<a href="https://adsecurity.org/?tag=emet5" class="tag-cloud-link tag-link-338 tag-link-position-12" style="font-size: 8pt;" aria-label="EMET5 (5 items)">EMET5</a>
<a href="https://adsecurity.org/?tag=goldenticket" class="tag-cloud-link tag-link-303 tag-link-position-13" style="font-size: 11.276595744681pt;" aria-label="GoldenTicket (9 items)">GoldenTicket</a>
<a href="https://adsecurity.org/?tag=hyperv" class="tag-cloud-link tag-link-3 tag-link-position-14" style="font-size: 8pt;" aria-label="HyperV (5 items)">HyperV</a>
<a href="https://adsecurity.org/?tag=invoke-mimikatz" class="tag-cloud-link tag-link-336 tag-link-position-15" style="font-size: 10.531914893617pt;" aria-label="Invoke-Mimikatz (8 items)">Invoke-Mimikatz</a>
<a href="https://adsecurity.org/?tag=kb3011780" class="tag-cloud-link tag-link-337 tag-link-position-16" style="font-size: 9.7872340425532pt;" aria-label="KB3011780 (7 items)">KB3011780</a>
<a href="https://adsecurity.org/?tag=kdc" class="tag-cloud-link tag-link-80 tag-link-position-17" style="font-size: 8pt;" aria-label="KDC (5 items)">KDC</a>
<a href="https://adsecurity.org/?tag=kerberos" class="tag-cloud-link tag-link-81 tag-link-position-18" style="font-size: 15.446808510638pt;" aria-label="Kerberos (18 items)">Kerberos</a>
<a href="https://adsecurity.org/?tag=kerberoshacking" class="tag-cloud-link tag-link-298 tag-link-position-19" style="font-size: 11.872340425532pt;" aria-label="KerberosHacking (10 items)">KerberosHacking</a>
<a href="https://adsecurity.org/?tag=krbtgt" class="tag-cloud-link tag-link-394 tag-link-position-20" style="font-size: 9.7872340425532pt;" aria-label="KRBTGT (7 items)">KRBTGT</a>
<a href="https://adsecurity.org/?tag=laps" class="tag-cloud-link tag-link-631 tag-link-position-21" style="font-size: 9.0425531914894pt;" aria-label="LAPS (6 items)">LAPS</a>
<a href="https://adsecurity.org/?tag=lsass" class="tag-cloud-link tag-link-71 tag-link-position-22" style="font-size: 11.276595744681pt;" aria-label="LSASS (9 items)">LSASS</a>
<a href="https://adsecurity.org/?tag=mcm" class="tag-cloud-link tag-link-6 tag-link-position-23" style="font-size: 14.255319148936pt;" aria-label="MCM (15 items)">MCM</a>
<a href="https://adsecurity.org/?tag=microsoftemet" class="tag-cloud-link tag-link-58 tag-link-position-24" style="font-size: 11.276595744681pt;" aria-label="MicrosoftEMET (9 items)">MicrosoftEMET</a>
<a href="https://adsecurity.org/?tag=microsoftwindows" class="tag-cloud-link tag-link-102 tag-link-position-25" style="font-size: 9.7872340425532pt;" aria-label="MicrosoftWindows (7 items)">MicrosoftWindows</a>
<a href="https://adsecurity.org/?tag=mimikatz" class="tag-cloud-link tag-link-207 tag-link-position-26" style="font-size: 18.425531914894pt;" aria-label="mimikatz (29 items)">mimikatz</a>
<a href="https://adsecurity.org/?tag=ms14068" class="tag-cloud-link tag-link-295 tag-link-position-27" style="font-size: 11.276595744681pt;" aria-label="MS14068 (9 items)">MS14068</a>
<a href="https://adsecurity.org/?tag=passthehash" class="tag-cloud-link tag-link-44 tag-link-position-28" style="font-size: 9.7872340425532pt;" aria-label="PassTheHash (7 items)">PassTheHash</a>
<a href="https://adsecurity.org/?tag=powershell" class="tag-cloud-link tag-link-575 tag-link-position-29" style="font-size: 18.872340425532pt;" aria-label="PowerShell (31 items)">PowerShell</a>
<a href="https://adsecurity.org/?tag=powershellcode" class="tag-cloud-link tag-link-22 tag-link-position-30" style="font-size: 15.148936170213pt;" aria-label="PowerShellCode (17 items)">PowerShellCode</a>
<a href="https://adsecurity.org/?tag=powershellhacking" class="tag-cloud-link tag-link-68 tag-link-position-31" style="font-size: 8pt;" aria-label="PowerShellHacking (5 items)">PowerShellHacking</a>
<a href="https://adsecurity.org/?tag=powershellv5" class="tag-cloud-link tag-link-69 tag-link-position-32" style="font-size: 8pt;" aria-label="PowerShellv5 (5 items)">PowerShellv5</a>
<a href="https://adsecurity.org/?tag=powersploit" class="tag-cloud-link tag-link-232 tag-link-position-33" style="font-size: 10.531914893617pt;" aria-label="PowerSploit (8 items)">PowerSploit</a>
<a href="https://adsecurity.org/?tag=presentation" class="tag-cloud-link tag-link-422 tag-link-position-34" style="font-size: 9.7872340425532pt;" aria-label="Presentation (7 items)">Presentation</a>
<a href="https://adsecurity.org/?tag=security" class="tag-cloud-link tag-link-576 tag-link-position-35" style="font-size: 8pt;" aria-label="Security (5 items)">Security</a>
<a href="https://adsecurity.org/?tag=sidhistory" class="tag-cloud-link tag-link-547 tag-link-position-36" style="font-size: 8pt;" aria-label="SIDHistory (5 items)">SIDHistory</a>
<a href="https://adsecurity.org/?tag=silverticket" class="tag-cloud-link tag-link-304 tag-link-position-37" style="font-size: 11.276595744681pt;" aria-label="SilverTicket (9 items)">SilverTicket</a>
<a href="https://adsecurity.org/?tag=sneakyadpersistence" class="tag-cloud-link tag-link-596 tag-link-position-38" style="font-size: 9.0425531914894pt;" aria-label="SneakyADPersistence (6 items)">SneakyADPersistence</a>
<a href="https://adsecurity.org/?tag=spn" class="tag-cloud-link tag-link-294 tag-link-position-39" style="font-size: 9.0425531914894pt;" aria-label="SPN (6 items)">SPN</a>
<a href="https://adsecurity.org/?tag=tgs" class="tag-cloud-link tag-link-528 tag-link-position-40" style="font-size: 9.0425531914894pt;" aria-label="TGS (6 items)">TGS</a>
<a href="https://adsecurity.org/?tag=tgt" class="tag-cloud-link tag-link-529 tag-link-position-41" style="font-size: 9.0425531914894pt;" aria-label="TGT (6 items)">TGT</a>
<a href="https://adsecurity.org/?tag=windows10" class="tag-cloud-link tag-link-494 tag-link-position-42" style="font-size: 10.531914893617pt;" aria-label="Windows10 (8 items)">Windows10</a>
<a href="https://adsecurity.org/?tag=windowsserver2008r2" class="tag-cloud-link tag-link-46 tag-link-position-43" style="font-size: 9.0425531914894pt;" aria-label="WindowsServer2008R2 (6 items)">WindowsServer2008R2</a>
<a href="https://adsecurity.org/?tag=windowsserver2012" class="tag-cloud-link tag-link-47 tag-link-position-44" style="font-size: 11.276595744681pt;" aria-label="WindowsServer2012 (9 items)">WindowsServer2012</a>
<a href="https://adsecurity.org/?tag=windowsserver2012r2" class="tag-cloud-link tag-link-54 tag-link-position-45" style="font-size: 9.7872340425532pt;" aria-label="WindowsServer2012R2 (7 items)">WindowsServer2012R2</a></div>
</div>    
        
    
</div><!-- #sidebar1 -->        
        
    </div><!-- #content -->


    
        
    <div id="sidebar_bottom" class="sidebar widget-area row footer-widget-col-3">
                    <div id="text-2" class="sidebar-wrap widget_text col-sm-4"><h3>Copyright</h3>			<div class="textwidget">Content Disclaimer: This blog and its contents are provided "AS IS" with no warranties, and they confer no rights. Script samples are provided for informational purposes only and no guarantee is provided as to functionality or suitability.
The views shared on this blog reflect those of the authors and do not represent the views of any companies mentioned.

Content Ownership: All content posted here is intellectual work and under the current law, the poster owns the copyright of the article. Terms of Use Copyright © 2011 - 2020.</div>
		</div>		
            </div>

	

<div id="footer" class="row default-footer">
    
        
            
            <div class="copyright-developer">
                                    <div id="copyright">
                        <p>Content Disclaimer: This blog and its contents are provided "AS IS" with no warranties, and they confer no rights. Script samples are provided for informational purposes only and no guarantee is provided as to functionality or suitability. The views shared on this blog reflect those of the authors and do not represent the views of any companies mentioned. </p>
                    </div>
                
                                    <div id="developer">
                        <p>
                                                        Made with <i class="fa fa-heart"></i> by <a href="https://www.graphene-theme.com/" rel="nofollow">Graphene Themes</a>.                        </p>

                                            </div>
                            </div>

        
                
    </div><!-- #footer -->


</div><!-- #container -->

		<!-- Start of StatCounter Code -->
		<script>
			<!--
			var sc_project=10100711;
			var sc_security="4b306538";
			      var sc_invisible=1;
			var scJsHost = (("https:" == document.location.protocol) ?
				"https://secure." : "http://www.");
			//-->
					</script>
		
<script type="text/javascript"
				src="https://secure.statcounter.com/counter/counter.js"
				async></script>		<noscript><div class="statcounter"><a title="web analytics" href="https://statcounter.com/"><img class="statcounter" src="https://c.statcounter.com/10100711/0/4b306538/1/" alt="web analytics" /></a></div></noscript>
		<!-- End of StatCounter Code -->
				<a href="#" id="back-to-top" title="Back to top"><i class="fa fa-chevron-up"></i></a>
	<script type='text/javascript' id='tptn_tracker-js-extra'>
/* <![CDATA[ */
var ajax_tptn_tracker = {"ajax_url":"https:\/\/adsecurity.org\/wp-admin\/admin-ajax.php","top_ten_id":"2011","top_ten_blog_id":"1","activate_counter":"11","top_ten_debug":"0","tptn_rnd":"623094981"};
/* ]]> */
</script>
<script type='text/javascript' src='https://adsecurity.org/wp-content/plugins/top-10/includes/js/top-10-tracker.min.js?ver=1.0' id='tptn_tracker-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-includes/js/comment-reply.min.js?ver=5.7.2' id='comment-reply-js'></script>
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/wp-embed.min.js?ver=5.7.2' id='wp-embed-js'></script>
</body>
</html>