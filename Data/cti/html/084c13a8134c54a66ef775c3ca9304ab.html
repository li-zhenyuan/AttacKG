<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">

<title>Roasting AS-REPs &#8211; harmj0y</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Feed" href="http://www.harmj0y.net/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Comments Feed" href="http://www.harmj0y.net/blog/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Roasting AS-REPs Comments Feed" href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/feed/" />
		<script>
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.harmj0y.net\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style>
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='crayon-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='astra-theme-css-css'  href='http://www.harmj0y.net/blog/wp-content/themes/astra/assets/css/minified/main.min.css?ver=3.4.2' media='all' />
<style id='astra-theme-css-inline-css'>
html{font-size:93.75%;}a,.page-title{color:#1d798b;}a:hover,a:focus{color:#f9f9f9;}body,button,input,select,textarea,.ast-button,.ast-custom-button{font-family:'Roboto',sans-serif;font-weight:400;font-size:15px;font-size:1rem;}blockquote{color:#000000;}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6,.site-title,.site-title a{font-family:'Oxanium',display;font-weight:400;}.site-title{font-size:35px;font-size:2.3333333333333rem;}header .custom-logo-link img{max-width:120px;}.astra-logo-svg{width:120px;}.ast-archive-description .ast-archive-title{font-size:40px;font-size:2.6666666666667rem;}.site-header .site-description{font-size:15px;font-size:1rem;}.entry-title{font-size:30px;font-size:2rem;}h1,.entry-content h1{font-size:40px;font-size:2.6666666666667rem;font-weight:400;font-family:'Oxanium',display;}h2,.entry-content h2{font-size:30px;font-size:2rem;font-weight:400;font-family:'Oxanium',display;}h3,.entry-content h3{font-size:25px;font-size:1.6666666666667rem;font-weight:400;font-family:'Oxanium',display;}h4,.entry-content h4{font-size:20px;font-size:1.3333333333333rem;}h5,.entry-content h5{font-size:18px;font-size:1.2rem;}h6,.entry-content h6{font-size:15px;font-size:1rem;}.ast-single-post .entry-title,.page-title{font-size:30px;font-size:2rem;}::selection{background-color:#33ccda;color:#000000;}body,h1,.entry-title a,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:#3a3a3a;}.tagcloud a:hover,.tagcloud a:focus,.tagcloud a.current-item{color:#ffffff;border-color:#1d798b;background-color:#1d798b;}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,textarea:focus{border-color:#1d798b;}input[type="radio"]:checked,input[type=reset],input[type="checkbox"]:checked,input[type="checkbox"]:hover:checked,input[type="checkbox"]:focus:checked,input[type=range]::-webkit-slider-thumb{border-color:#1d798b;background-color:#1d798b;box-shadow:none;}.site-footer a:hover + .post-count,.site-footer a:focus + .post-count{background:#1d798b;border-color:#1d798b;}.single .nav-links .nav-previous,.single .nav-links .nav-next{color:#1d798b;}.entry-meta,.entry-meta *{line-height:1.45;color:#1d798b;}.entry-meta a:hover,.entry-meta a:hover *,.entry-meta a:focus,.entry-meta a:focus *,.page-links > .page-link,.page-links .page-link:hover,.post-navigation a:hover{color:#f9f9f9;}.widget-title{font-size:21px;font-size:1.4rem;color:#3a3a3a;}#cat option,.secondary .calendar_wrap thead a,.secondary .calendar_wrap thead a:visited{color:#1d798b;}.secondary .calendar_wrap #today,.ast-progress-val span{background:#1d798b;}.secondary a:hover + .post-count,.secondary a:focus + .post-count{background:#1d798b;border-color:#1d798b;}.calendar_wrap #today > a{color:#ffffff;}.page-links .page-link,.single .post-navigation a{color:#1d798b;}#secondary,#secondary button,#secondary input,#secondary select,#secondary textarea{font-size:15px;font-size:1rem;}#secondary {margin: 4em 0 2.5em;word-break: break-word;line-height: 2;}#secondary li {margin-bottom: 0.25em;}#secondary li:last-child {margin-bottom: 0;}@media (max-width: 768px) {.js_active .ast-plain-container.ast-single-post #secondary {margin-top: 1.5em;}}.ast-separate-container.ast-two-container #secondary .widget {background-color: #fff;padding: 2em;margin-bottom: 2em;}@media (min-width: 993px) {.ast-left-sidebar #secondary {padding-right: 60px;}.ast-right-sidebar #secondary {padding-left: 60px;}}@media (max-width: 993px) {.ast-right-sidebar #secondary {padding-left: 30px;}.ast-left-sidebar #secondary {padding-right: 30px;}}.wp-block-buttons.aligncenter{justify-content:center;}@media (min-width:1200px){.ast-separate-container.ast-right-sidebar .entry-content .wp-block-image.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-image.alignfull,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignfull{margin-left:-6.67em;margin-right:-6.67em;max-width:unset;width:unset;}.ast-separate-container.ast-right-sidebar .entry-content .wp-block-image.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-image.alignwide,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignwide{margin-left:-20px;margin-right:-20px;max-width:unset;width:unset;}}@media (min-width:1200px){.wp-block-group .has-background{padding:20px;}}@media (min-width:1200px){.ast-separate-container.ast-right-sidebar .entry-content .wp-block-group.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-group.alignwide,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignwide{margin-left:-20px;margin-right:-20px;padding-left:20px;padding-right:20px;}.ast-separate-container.ast-right-sidebar .entry-content .wp-block-group.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-group.alignfull,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignfull{margin-left:-6.67em;margin-right:-6.67em;padding-left:6.67em;padding-right:6.67em;}}@media (min-width:1200px){.wp-block-cover-image.alignwide .wp-block-cover__inner-container,.wp-block-cover.alignwide .wp-block-cover__inner-container,.wp-block-cover-image.alignfull .wp-block-cover__inner-container,.wp-block-cover.alignfull .wp-block-cover__inner-container{width:100%;}}.ast-plain-container.ast-no-sidebar #primary{margin-top:0;margin-bottom:0;}@media (max-width:921px){.ast-theme-transparent-header #primary,.ast-theme-transparent-header #secondary{padding:0;}}.wp-block-columns{margin-bottom:unset;}.wp-block-image.size-full{margin:2rem 0;}.wp-block-separator.has-background{padding:0;}.wp-block-gallery{margin-bottom:1.6em;}.wp-block-group{padding-top:4em;padding-bottom:4em;}.wp-block-group__inner-container .wp-block-columns:last-child,.wp-block-group__inner-container :last-child,.wp-block-table table{margin-bottom:0;}.blocks-gallery-grid{width:100%;}.wp-block-navigation-link__content{padding:5px 0;}.wp-block-group .wp-block-group .has-text-align-center,.wp-block-group .wp-block-column .has-text-align-center{max-width:100%;}.has-text-align-center{margin:0 auto;}@media (min-width:1200px){.wp-block-cover__inner-container,.alignwide .wp-block-group__inner-container,.alignfull .wp-block-group__inner-container{max-width:1200px;margin:0 auto;}.wp-block-group.alignnone,.wp-block-group.aligncenter,.wp-block-group.alignleft,.wp-block-group.alignright,.wp-block-group.alignwide,.wp-block-columns.alignwide{margin:2rem 0 1rem 0;}}@media (max-width:1200px){.wp-block-group{padding:3em;}.wp-block-group .wp-block-group{padding:1.5em;}.wp-block-columns,.wp-block-column{margin:1rem 0;}}@media (min-width:921px){.wp-block-columns .wp-block-group{padding:2em;}}@media (max-width:544px){.wp-block-cover-image .wp-block-cover__inner-container,.wp-block-cover .wp-block-cover__inner-container{width:unset;}.wp-block-cover,.wp-block-cover-image{padding:2em 0;}.wp-block-group,.wp-block-cover{padding:2em;}.wp-block-media-text__media img,.wp-block-media-text__media video{width:unset;max-width:100%;}.wp-block-media-text.has-background .wp-block-media-text__content{padding:1em;}}@media (max-width:921px){.ast-plain-container.ast-no-sidebar #primary{padding:0;}}@media (min-width:544px){.entry-content .wp-block-media-text.has-media-on-the-right .wp-block-media-text__content{padding:0 8% 0 0;}.entry-content .wp-block-media-text .wp-block-media-text__content{padding:0 0 0 8%;}.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-bottom-left > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-bottom-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-top-left > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-top-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-center-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-center-left > *{margin:0;}}@media (max-width:544px){.entry-content .wp-block-media-text .wp-block-media-text__content{padding:8% 0;}.wp-block-media-text .wp-block-media-text__media img{width:auto;max-width:100%;}}.wp-block-button.is-style-outline .wp-block-button__link{border-color:#33ccda;border-top-width:2px;border-right-width:2px;border-bottom-width:2px;border-left-width:2px;}.wp-block-button.is-style-outline > .wp-block-button__link:not(.has-text-color),.wp-block-button.wp-block-button__link.is-style-outline:not(.has-text-color){color:#33ccda;}.wp-block-button.is-style-outline .wp-block-button__link:hover,.wp-block-button.is-style-outline .wp-block-button__link:focus{color:#000000 !important;background-color:#f9f9f9;border-color:#f9f9f9;}.post-page-numbers.current .page-link,.ast-pagination .page-numbers.current{color:#000000;border-color:#33ccda;background-color:#33ccda;border-radius:2px;}@media (max-width:921px){.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (max-width:544px){.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (min-width:544px){.entry-content > .alignleft{margin-right:20px;}.entry-content > .alignright{margin-left:20px;}.wp-block-group.has-background{padding:20px;}}@media (max-width:921px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single{padding:1.5em 2.14em;}.ast-separate-container #primary,.ast-separate-container #secondary{padding:1.5em 0;}#primary,#secondary{padding:1.5em 0;margin:0;}.ast-left-sidebar #content > .ast-container{display:flex;flex-direction:column-reverse;width:100%;}.ast-author-box img.avatar{margin:20px 0 0 0;}}@media (max-width:921px){#secondary.secondary{padding-top:0;}.ast-separate-container.ast-right-sidebar #secondary{padding-left:1em;padding-right:1em;}.ast-separate-container.ast-two-container #secondary{padding-left:0;padding-right:0;}.ast-page-builder-template .entry-header #secondary,.ast-page-builder-template #secondary{margin-top:1.5em;}}@media (max-width:921px){.ast-right-sidebar #primary{padding-right:0;}.ast-page-builder-template.ast-left-sidebar #secondary,.ast-page-builder-template.ast-right-sidebar #secondary{padding-right:20px;padding-left:20px;}.ast-right-sidebar #secondary,.ast-left-sidebar #primary{padding-left:0;}.ast-left-sidebar #secondary{padding-right:0;}}@media (min-width:922px){.ast-separate-container.ast-right-sidebar #primary,.ast-separate-container.ast-left-sidebar #primary{border:0;}.search-no-results.ast-separate-container #primary{margin-bottom:4em;}}@media (min-width:922px){.ast-right-sidebar #primary{border-right:1px solid #eee;}.ast-left-sidebar #primary{border-left:1px solid #eee;}.ast-right-sidebar #secondary{border-left:1px solid #eee;margin-left:-1px;}.ast-left-sidebar #secondary{border-right:1px solid #eee;margin-right:-1px;}.ast-separate-container.ast-two-container.ast-right-sidebar #secondary{padding-left:30px;padding-right:0;}.ast-separate-container.ast-two-container.ast-left-sidebar #secondary{padding-right:30px;padding-left:0;}.ast-separate-container.ast-right-sidebar #secondary,.ast-separate-container.ast-left-sidebar #secondary{border:0;margin-left:auto;margin-right:auto;}.ast-separate-container.ast-two-container #secondary .widget:last-child{margin-bottom:0;}}.wp-block-button .wp-block-button__link,{color:#000000;}.wp-block-button .wp-block-button__link:hover,.wp-block-button .wp-block-button__link:focus{color:#000000;background-color:#f9f9f9;border-color:#f9f9f9;}.wp-block-button .wp-block-button__link{border:none;background-color:#33ccda;color:#000000;font-family:inherit;font-weight:inherit;line-height:1;border-radius:2px;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{border-style:solid;border-top-width:2px;border-right-width:2px;border-left-width:2px;border-bottom-width:2px;border-color:#33ccda;padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}@media (max-width:921px){.wp-block-button .wp-block-button__link{border:none;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (max-width:544px){.wp-block-button .wp-block-button__link{border:none;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}.menu-toggle,button,.ast-button,.ast-custom-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"]{border-style:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;color:#000000;border-color:#33ccda;background-color:#33ccda;border-radius:2px;padding-top:10px;padding-right:40px;padding-bottom:10px;padding-left:40px;font-family:inherit;font-weight:inherit;line-height:1;}button:focus,.menu-toggle:hover,button:hover,.ast-button:hover,.ast-custom-button:hover .button:hover,.ast-custom-button:hover ,input[type=reset]:hover,input[type=reset]:focus,input#submit:hover,input#submit:focus,input[type="button"]:hover,input[type="button"]:focus,input[type="submit"]:hover,input[type="submit"]:focus{color:#000000;background-color:#f9f9f9;border-color:#f9f9f9;}@media (min-width:544px){.ast-container{max-width:100%;}}@media (max-width:544px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single,.ast-separate-container .comments-title,.ast-separate-container .ast-archive-description{padding:1.5em 1em;}.ast-separate-container #content .ast-container{padding-left:0.54em;padding-right:0.54em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-search-menu-icon.ast-dropdown-active .search-field{width:170px;}.ast-separate-container #secondary{padding-top:0;}.ast-separate-container.ast-two-container #secondary .widget{margin-bottom:1.5em;padding-left:1em;padding-right:1em;}}@media (max-width:544px){.ast-separate-container .comments-count-wrapper{padding:1.5em 1em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-separate-container .comment-respond{padding:1.5em 1em;}}@media (max-width:544px){.ast-comment-list .children{margin-left:0.66666em;}.ast-separate-container .ast-comment-list .bypostauthor li{padding:0 0 0 .5em;}}@media (max-width:921px){.ast-mobile-header-stack .main-header-bar .ast-search-menu-icon{display:inline-block;}.ast-header-break-point.ast-header-custom-item-outside .ast-mobile-header-stack .main-header-bar .ast-search-icon{margin:0;}.ast-comment-avatar-wrap img{max-width:2.5em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}}@media (max-width:921px){.ast-comment-avatar-wrap img{max-width:2.5em;}.comments-area{margin-top:1.5em;}.ast-separate-container .comments-count-wrapper{padding:2em 2.14em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}}@media (max-width:921px){.ast-comment-avatar-wrap{margin-right:0.5em;}}body,.ast-separate-container{background-color:#f9f9f9;;background-image:none;;}@media (max-width:921px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:30px;}}@media (max-width:544px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:30px;}}@media (max-width:921px){html{font-size:85.5%;}}@media (max-width:544px){html{font-size:85.5%;}}@media (min-width:922px){.ast-container{max-width:1240px;}}@media (min-width:922px){.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu:hover > .sub-menu,.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu.focus > .sub-menu{margin-left:-0px;}}.ast-breadcrumbs .trail-browse,.ast-breadcrumbs .trail-items,.ast-breadcrumbs .trail-items li{display:inline-block;margin:0;padding:0;border:none;background:inherit;text-indent:0;}.ast-breadcrumbs .trail-browse{font-size:inherit;font-style:inherit;font-weight:inherit;color:inherit;}.ast-breadcrumbs .trail-items{list-style:none;}.trail-items li::after{padding:0 0.3em;content:"\00bb";}.trail-items li:last-of-type::after{display:none;}@media (max-width:921px){.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}@media (max-width:544px){.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}.ast-builder-layout-element[data-section="title_tagline"]{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}.ast-builder-menu-1{font-family:'Oxanium',display;font-weight:inherit;text-transform:uppercase;}.ast-builder-menu-1 .menu-item > .menu-link{color:#33ccda;}.ast-builder-menu-1 .menu-item > .ast-menu-toggle{color:#33ccda;}.ast-builder-menu-1 .menu-item:hover > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:#ffffff;}.ast-builder-menu-1 .menu-item:hover > .ast-menu-toggle{color:#ffffff;}.ast-builder-menu-1 .sub-menu,.ast-builder-menu-1 .inline-on-mobile .sub-menu{border-top-width:2px;border-bottom-width:0;border-right-width:0;border-left-width:0;border-color:#33ccda;border-style:solid;border-radius:0;}.ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu,.ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper{margin-top:0;}.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu:before,.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper:before{height:calc( 0px + 5px );}.ast-desktop .ast-builder-menu-1 .menu-item .sub-menu .menu-link{border-style:none;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-1 .menu-item-has-children > .menu-link:after{content:unset;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-1{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}.site-below-footer-wrap[data-section="section-below-footer-builder"]{background-color:#eeeeee;;min-height:80px;}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row{max-width:1200px;margin-left:auto;margin-right:auto;}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row,.site-below-footer-wrap[data-section="section-below-footer-builder"] .site-footer-section{align-items:flex-start;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-full .ast-builder-grid-row{grid-template-columns:1fr;}@media (max-width:921px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-full .ast-builder-grid-row{grid-template-columns:1fr;}}@media (max-width:544px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}.ast-footer-copyright{text-align:center;}.ast-footer-copyright {color:#3a3a3a;}@media (max-width:921px){.ast-footer-copyright{text-align:center;}}@media (max-width:544px){.ast-footer-copyright{text-align:center;}}.ast-footer-copyright.ast-builder-layout-element{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}.site-footer{background-color:;;background-image:none;;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{background-color:#f9f9f9;;border-style:solid;border-width:0px;border-top-width:1px;border-top-color:#e6e6e6;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row{max-width:1200px;margin-left:auto;margin-right:auto;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row,.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .site-footer-section{align-items:flex-start;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}@media (max-width:921px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}}@media (max-width:544px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}.elementor-template-full-width .ast-container{display:block;}.ast-header-break-point .main-header-bar{border-bottom-width:1px;}@media (min-width:922px){.main-header-bar{border-bottom-width:1px;}}@media (min-width:922px){#primary{width:70%;}#secondary{width:30%;}}.ast-safari-browser-less-than-11 .main-header-menu .menu-item, .ast-safari-browser-less-than-11 .main-header-bar .ast-masthead-custom-menu-items{display:block;}.main-header-menu .menu-item, #astra-footer-menu .menu-item, .main-header-bar .ast-masthead-custom-menu-items{-js-display:flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;}.main-header-menu > .menu-item > .menu-link, #astra-footer-menu > .menu-item > .menu-link,{height:100%;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-js-display:flex;display:flex;}.ast-primary-menu-disabled .main-header-bar .ast-masthead-custom-menu-items{flex:unset;}.ast-header-break-point .main-navigation ul .menu-item .menu-link .icon-arrow:first-of-type svg{top:.2em;margin-top:0px;margin-left:0px;width:.65em;transform:translate(0, -2px) rotateZ(270deg);}.ast-mobile-popup-content .ast-submenu-expanded > .ast-menu-toggle{transform:rotateX(180deg);}.ast-mobile-header-content > *,.ast-desktop-header-content > * {padding: 10px 0;height: auto;}.ast-mobile-header-content > *:first-child,.ast-desktop-header-content > *:first-child {padding-top: 10px;}.ast-mobile-header-content > .ast-builder-menu,.ast-desktop-header-content > .ast-builder-menu {padding-top: 0;}.ast-mobile-header-content > *:last-child,.ast-desktop-header-content > *:last-child {padding-bottom: 0;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search label,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search label {width: 100%;}.ast-desktop-header-content .main-header-bar-navigation .ast-submenu-expanded > .ast-menu-toggle::before {transform: rotateX(180deg);}#ast-desktop-header .ast-desktop-header-content,.ast-mobile-header-content .ast-search-icon,.ast-desktop-header-content .ast-search-icon,.ast-off-canvas-active .ast-main-header-nav-open.ast-popup-nav-open .ast-mobile-header-wrap .ast-mobile-header-content,.ast-mobile-header-wrap .ast-mobile-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-mobile-header-wrap .ast-mobile-header-content,.ast-off-canvas-active .ast-main-header-nav-open.ast-popup-nav-open .ast-desktop-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-desktop-header-content {display: none;}.ast-main-header-nav-open.ast-header-break-point #ast-desktop-header .ast-desktop-header-content,.ast-main-header-nav-open.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content {display: block;}.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item .menu-item > .sub-menu {opacity: 1;visibility: visible;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation {width: unset;margin: unset;}.ast-mobile-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle,.ast-desktop-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle {left: calc( 20px - 0.907em);}.ast-mobile-header-content .ast-search-menu-icon,.ast-mobile-header-content .ast-search-menu-icon.slide-search,.ast-desktop-header-content .ast-search-menu-icon,.ast-desktop-header-content .ast-search-menu-icon.slide-search {width: 100%;position: relative;display: block;right: auto;transform: none;}.ast-mobile-header-content .ast-search-menu-icon.slide-search .search-form,.ast-mobile-header-content .ast-search-menu-icon .search-form,.ast-desktop-header-content .ast-search-menu-icon.slide-search .search-form,.ast-desktop-header-content .ast-search-menu-icon .search-form {right: 0;visibility: visible;opacity: 1;position: relative;top: auto;transform: none;padding: 0;display: block;overflow: hidden;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-mobile-header-content .ast-search-menu-icon .search-field,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-desktop-header-content .ast-search-menu-icon .search-field {width: 100%;padding-right: 5.5em;}.ast-mobile-header-content .ast-search-menu-icon .search-submit,.ast-desktop-header-content .ast-search-menu-icon .search-submit {display: block;position: absolute;height: 100%;top: 0;right: 0;padding: 0 1em;border-radius: 0;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation ul .sub-menu .menu-link {padding-left: 30px;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation .sub-menu .menu-item .menu-item .menu-link {padding-left: 40px;}.ast-mobile-popup-drawer.active .ast-mobile-popup-inner{background-color:#ffffff;;}.ast-mobile-header-wrap .ast-mobile-header-content, .ast-desktop-header-content{background-color:#ffffff;;}.ast-mobile-popup-content > *, .ast-mobile-header-content > *, .ast-desktop-popup-content > *, .ast-desktop-header-content > *{padding-top:0;padding-bottom:0;}.content-align-flex-start .ast-builder-layout-element{justify-content:flex-start;}.content-align-flex-start .main-header-menu{text-align:left;}.ast-mobile-popup-drawer.active .ast-mobile-popup-drawer.active .menu-toggle-close{color:#3a3a3a;}.ast-mobile-header-wrap .ast-primary-header-bar,.ast-primary-header-bar .site-primary-header-wrap{min-height:70px;}.ast-desktop .ast-primary-header-bar .main-header-menu > .menu-item{line-height:70px;}@media (max-width:921px){#masthead .ast-mobile-header-wrap .ast-above-header-bar,#masthead .ast-mobile-header-wrap .ast-primary-header-bar,#masthead .ast-mobile-header-wrap .ast-below-header-bar{padding-left:20px;padding-right:20px;}}.ast-header-break-point .ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:#eaeaea;border-bottom-style:solid;}@media (min-width:922px){.ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:#eaeaea;border-bottom-style:solid;}}.ast-primary-header-bar{background-color:#191919;;background-image:none;;}.ast-primary-header-bar{display:block;}@media (max-width:921px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}@media (max-width:544px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}[data-section="section-header-mobile-trigger"] .ast-button-wrap .ast-mobile-menu-trigger-minimal{color:#33ccda;border:none;background:transparent;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-toggle-icon .ast-mobile-svg{width:20px;height:20px;fill:#33ccda;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-wrap .mobile-menu{color:#33ccda;}.ast-builder-menu-mobile .main-navigation .menu-item > .menu-link{font-family:inherit;font-weight:inherit;}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}.ast-hfb-header .ast-builder-menu-mobile .main-header-menu, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .menu-link, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .sub-menu .menu-link{border-style:none;}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}@media (max-width:921px){.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}}@media (max-width:544px){.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-mobile .main-navigation{display:block;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-vertical-menu .menu-item{align-items:center;}@media (max-width:921px){.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-vertical-menu{display:grid;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-vertical-menu .menu-item{align-items:center;}#astra-footer-menu .menu-item > a{padding-left:20px;padding-right:20px;}}@media (max-width:544px){.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-vertical-menu{display:grid;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-vertical-menu .menu-item{align-items:center;}}.footer-widget-area[data-section="section-footer-menu"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="section-footer-menu"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="section-footer-menu"]{display:block;}}.comment-reply-title{font-size:24px;font-size:1.6rem;}.ast-comment-meta{line-height:1.666666667;color:#1d798b;font-size:12px;font-size:0.8rem;}.ast-comment-list #cancel-comment-reply-link{font-size:15px;font-size:1rem;}.comments-title {padding: 2em 0;}.comments-title {font-weight: normal;word-wrap: break-word;}.ast-comment-list {margin: 0;word-wrap: break-word;padding-bottom: 0.5em;list-style: none;}.ast-comment-list li {list-style: none;}.ast-comment-list .ast-comment-edit-reply-wrap {-js-display: flex;display: flex;justify-content: flex-end;}.ast-comment-list .ast-edit-link {flex: 1;}.ast-comment-list .comment-awaiting-moderation {margin-bottom: 0;}.ast-comment {padding: 1em 0;}.ast-comment-info img {border-radius: 50%;}.ast-comment-cite-wrap cite {font-style: normal;}.comment-reply-title {padding-top: 1em;font-weight: normal;line-height: 1.65;}.ast-comment-meta {margin-bottom: 0.5em;}.comments-area {border-top: 1px solid #eeeeee;margin-top: 2em;}.comments-area .comment-form-comment {width: 100%;border: none;margin: 0;padding: 0;}.comments-area .comment-notes,.comments-area .comment-textarea,.comments-area .form-allowed-tags {margin-bottom: 1.5em;}.comments-area .form-submit {margin-bottom: 0;}.comments-area textarea#comment,.comments-area .ast-comment-formwrap input[type="text"] {width: 100%;border-radius: 0;vertical-align: middle;margin-bottom: 10px;}.comments-area .no-comments {margin-top: 0.5em;margin-bottom: 0.5em;}.comments-area p.logged-in-as {margin-bottom: 1em;}.ast-separate-container .comments-title {background-color: #fff;padding: 1.2em 3.99em 0;}.ast-separate-container .comments-area {border-top: 0;}.ast-separate-container .ast-comment-list {padding-bottom: 0;}.ast-separate-container .ast-comment-list li {background-color: #fff;}.ast-separate-container .ast-comment-list li.depth-1 {padding: 4em 6.67em;margin-bottom: 2em;}@media (max-width: 1200px) {.ast-separate-container .ast-comment-list li.depth-1 {padding: 3em 3.34em;}}.ast-separate-container .ast-comment-list li.depth-1 .children li {padding-bottom: 0;padding-top: 0;margin-bottom: 0;}.ast-separate-container .ast-comment-list li.depth-1 .ast-comment,.ast-separate-container .ast-comment-list li.depth-2 .ast-comment {border-bottom: 0;}.ast-separate-container .ast-comment-list .comment-respond {padding-top: 0;padding-bottom: 1em;background-color: transparent;}.ast-separate-container .ast-comment-list .pingback p {margin-bottom: 0;}.ast-separate-container .ast-comment-list .bypostauthor {padding: 2em;margin-bottom: 1em;}.ast-separate-container .ast-comment-list .bypostauthor li {background: transparent;margin-bottom: 0;padding: 0 0 0 2em;}.ast-separate-container .comment-respond {background-color: #fff;padding: 4em 6.67em;border-bottom: 0;}@media (max-width: 1200px) {.ast-separate-container .comment-respond {padding: 3em 2.34em;}}.ast-separate-container .comment-reply-title {padding-top: 0;}.ast-comment-list .children {margin-left: 2em;}@media (max-width: 992px) {.ast-comment-list .children {margin-left: 1em;}}.ast-comment-list #cancel-comment-reply-link {white-space: nowrap;font-size: 15px;font-size: 1rem;margin-left: 1em;}.ast-comment-info {display: flex;position: relative;}.ast-comment-meta {justify-content: right;padding: 0 3.4em 1.60em;}.ast-comment-time .timendate{margin-right: 0.5em;}.comments-area #wp-comment-cookies-consent {margin-right: 10px;}.ast-page-builder-template .comments-area {padding-left: 20px;padding-right: 20px;margin-top: 2em;margin-bottom: 2em;}.ast-separate-container .ast-comment-list .bypostauthor .bypostauthor {background: transparent;margin-bottom: 0;padding-right: 0;padding-bottom: 0;padding-top: 0;}@media (min-width:922px){.ast-separate-container .ast-comment-list li .comment-respond{padding-left:2.66666em;padding-right:2.66666em;}}@media (max-width:544px){.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-separate-container .comment-respond{padding:1.5em 1em;}}@media (max-width:921px){.ast-comment-avatar-wrap img{max-width:2.5em;}.comments-area{margin-top:1.5em;}.ast-separate-container .comments-title{padding:1.43em 1.48em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}}
</style>
<link rel='stylesheet' id='astra-google-fonts-css'  href='//fonts.googleapis.com/css?family=Roboto%3A400%2C%7COxanium%3A400%2C&#038;display=fallback&#038;ver=3.4.2' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='http://www.harmj0y.net/blog/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='tablepress-default-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/tablepress/css/default.min.css?ver=1.13' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/jetpack/css/jetpack.css?ver=9.7' media='all' />
<script src='http://www.harmj0y.net/blog/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script src='http://www.harmj0y.net/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script id='crayon_js-js-extra'>
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.harmj0y.net\/blog\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta' id='crayon_js-js'></script>
<!--[if IE]>
<script src='http://www.harmj0y.net/blog/wp-content/themes/astra/assets/js/minified/flexibility.min.js?ver=3.4.2' id='astra-flexibility-js'></script>
<script id='astra-flexibility-js-after'>
flexibility(document.documentElement);
</script>
<![endif]-->
<link rel="https://api.w.org/" href="http://www.harmj0y.net/blog/wp-json/" /><link rel="alternate" type="application/json" href="http://www.harmj0y.net/blog/wp-json/wp/v2/posts/3680" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.harmj0y.net/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.harmj0y.net/blog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/" />
<link rel='shortlink' href='https://wp.me/p4qDDn-Xm' />
<link rel="alternate" type="application/json+oembed" href="http://www.harmj0y.net/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.harmj0y.net%2Fblog%2Factivedirectory%2Froasting-as-reps%2F" />
<link rel="alternate" type="text/xml+oembed" href="http://www.harmj0y.net/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.harmj0y.net%2Fblog%2Factivedirectory%2Froasting-as-reps%2F&#038;format=xml" />
<link rel="pingback" href="http://www.harmj0y.net/blog/xmlrpc.php">

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Roasting AS-REPs" />
<meta property="og:url" content="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/" />
<meta property="og:description" content="Last November, I published a post titled &#8220;Kerberoasting Without Mimikatz&#8221; that detailed new developments with PowerView and Tim Medin&#8217;s Kerberoasting attack. This started me down …" />
<meta property="article:published_time" content="2017-01-17T19:29:11+00:00" />
<meta property="article:modified_time" content="2017-08-07T06:40:05+00:00" />
<meta property="og:site_name" content="harmj0y" />
<meta property="og:image" content="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/malicious_asrep.png" />
<meta property="og:image:width" content="641" />
<meta property="og:image:height" content="542" />
<meta name="twitter:text:title" content="Roasting AS-REPs" />
<meta name="twitter:image" content="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/malicious_asrep.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-270x270.png" />
			<style type="text/css" id="wp-custom-css">
				.btn {
  text-decoration: none;
	font-size: 18px;
	padding: 1rem 3rem;
	color: #ffffff;
	text-transform:uppercase;
  border: 1px solid rgb(146, 148, 248);
  position: relative;
  overflow: hidden;
	display: fixed;
  justify-content: center;
  align-items: center;
}

.btn:hover {
  box-shadow: 1px 1px 25px 10px rgba(146, 148, 248, 0.4);
}

.btn:before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  transition: all 650ms;
}

.btn:hover:before {
  left: 100%;
}
			</style>
		</head>

<body itemtype='https://schema.org/Blog' itemscope='itemscope' class="post-template-default single single-post postid-3680 single-format-standard wp-custom-logo ast-blog-single-style-1 ast-single-post ast-inherit-site-logo-transparent ast-hfb-header ast-desktop ast-separate-container ast-right-sidebar astra-3.4.2 ast-normal-title-enabled elementor-default elementor-kit-5017">
<div 
class="hfeed site" id="page">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
			<header
		class="site-header header-main-layout-1 ast-primary-menu-enabled ast-logo-title-inline ast-hide-custom-menu-mobile ast-builder-menu-toggle-icon ast-mobile-header-inline" id="masthead" itemtype="https://schema.org/WPHeader" itemscope="itemscope" itemid="#masthead"		>
			<div id="ast-desktop-header" data-toggle-type="dropdown">
		<div class="ast-main-header-wrap main-header-bar-wrap ">
		<div class="ast-primary-header-bar ast-primary-header main-header-bar site-header-focus-item" data-section="section-primary-header-builder">
						<div class="site-primary-header-wrap ast-builder-grid-row-container site-header-focus-item ast-container" data-section="section-primary-header-builder">
				<div class="ast-builder-grid-row ast-builder-grid-row-has-sides ast-builder-grid-row-no-center">
											<div class="site-header-primary-section-left site-header-section ast-flex site-header-section-left">
									<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="title_tagline">
											<div
				class="site-branding ast-site-identity" itemtype="https://schema.org/Organization" itemscope="itemscope"				>
					<span class="site-logo-img"><a href="http://www.harmj0y.net/blog/" class="custom-logo-link" rel="home"><img width="120" height="38" src="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png" class="custom-logo" alt="harmj0y logo" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png 120w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-300x95.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-768x242.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union.png 904w" sizes="(max-width: 120px) 100vw, 120px" /></a></span>				</div>
			<!-- .site-branding -->
					</div>
								</div>
																									<div class="site-header-primary-section-right site-header-section ast-flex ast-grid-right-section">
										<div class="ast-builder-menu-1 ast-builder-menu ast-flex ast-builder-menu-1-focus-item ast-builder-layout-element site-header-focus-item" data-section="section-hb-menu-1">
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation ast-flex-1"><nav class="site-navigation" id="site-navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" class="ast-flex-grow-1 navigation-accessibility" aria-label="Site Navigation"><div id="ast-hf-menu-1" class="main-navigation ast-inline-flex"><ul class="main-header-menu ast-nav-menu ast-flex  submenu-with-border ast-menu-hover-style-overline  stack-on-mobile"><li class="page_item page-item-12 menu-item"><a href="http://www.harmj0y.net/blog/about/" class="menu-link">About</a></li><li class="page_item page-item-20 menu-item"><a href="http://www.harmj0y.net/blog/presentations/" class="menu-link">Presentations</a></li><li class="page_item page-item-10 menu-item"><a href="http://www.harmj0y.net/blog/projects/" class="menu-link">Projects</a></li></ul></div></nav></div></div>		</div>
									</div>
												</div>
					</div>
								</div>
			</div>
		<div class="ast-desktop-header-content content-align-flex-start ">
			</div>
</div> <!-- Main Header Bar Wrap -->
<div id="ast-mobile-header" class="ast-mobile-header-wrap " data-type="dropdown">
		<div class="ast-main-header-wrap main-header-bar-wrap" >
		<div class="ast-primary-header-bar ast-primary-header main-header-bar site-primary-header-wrap site-header-focus-item ast-builder-grid-row-layout-default ast-builder-grid-row-tablet-layout-default ast-builder-grid-row-mobile-layout-default" data-section="section-primary-header-builder">
									<div class="ast-builder-grid-row ast-builder-grid-row-has-sides ast-builder-grid-row-no-center">
													<div class="site-header-primary-section-left site-header-section ast-flex site-header-section-left">
										<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="title_tagline">
											<div
				class="site-branding ast-site-identity" itemtype="https://schema.org/Organization" itemscope="itemscope"				>
					<span class="site-logo-img"><a href="http://www.harmj0y.net/blog/" class="custom-logo-link" rel="home"><img width="120" height="38" src="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png" class="custom-logo" alt="harmj0y logo" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png 120w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-300x95.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-768x242.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union.png 904w" sizes="(max-width: 120px) 100vw, 120px" /></a></span>				</div>
			<!-- .site-branding -->
					</div>
									</div>
																									<div class="site-header-primary-section-right site-header-section ast-flex ast-grid-right-section">
										<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="section-header-mobile-trigger">
						<div class="ast-button-wrap">
				<button type="button" class="menu-toggle main-header-menu-toggle ast-mobile-menu-trigger-minimal"   aria-expanded="false">
					<span class="screen-reader-text">Main Menu</span>
					<span class="mobile-menu-toggle-icon">
						<span class="ahfb-svg-iconset ast-inline-flex svg-baseline"><svg role='img' class='ast-mobile-svg ast-menu-svg' fill='currentColor' version='1.1' xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path d='M3 13h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 7h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 19h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1z'></path></svg></span><span class="ahfb-svg-iconset ast-inline-flex svg-baseline"><svg class='ast-mobile-svg ast-close-svg' fill='currentColor' version='1.1' xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path d='M5.293 6.707l5.293 5.293-5.293 5.293c-0.391 0.391-0.391 1.024 0 1.414s1.024 0.391 1.414 0l5.293-5.293 5.293 5.293c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414l-5.293-5.293 5.293-5.293c0.391-0.391 0.391-1.024 0-1.414s-1.024-0.391-1.414 0l-5.293 5.293-5.293-5.293c-0.391-0.391-1.024-0.391-1.414 0s-0.391 1.024 0 1.414z'></path></svg></span>					</span>
									</button>
			</div>
					</div>
									</div>
											</div>
						</div>
	</div>
		<div class="ast-mobile-header-content content-align-flex-start ">
				<div class="ast-builder-menu-mobile ast-builder-menu ast-builder-menu-mobile-focus-item ast-builder-layout-element site-header-focus-item" data-section="section-header-mobile-menu">
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation"><nav class="site-navigation" id="site-navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" class="ast-flex-grow-1 navigation-accessibility" aria-label="Site Navigation"><div id="ast-hf-mobile-menu" class="main-navigation"><ul class="main-header-menu ast-nav-menu ast-flex  submenu-with-border astra-menu-animation-fade  stack-on-mobile"><li class="page_item page-item-12 menu-item"><a href="http://www.harmj0y.net/blog/about/" class="menu-link">About</a></li><li class="page_item page-item-20 menu-item"><a href="http://www.harmj0y.net/blog/presentations/" class="menu-link">Presentations</a></li><li class="page_item page-item-10 menu-item"><a href="http://www.harmj0y.net/blog/projects/" class="menu-link">Projects</a></li></ul></div></nav></div></div>		</div>
			</div>
</div>
		</header><!-- #masthead -->
			<div id="content" class="site-content">
		<div class="ast-container">
		

	<div id="primary" class="content-area primary">

		
					<main id="main" class="site-main">
				

<article
class="post-3680 post type-post status-publish format-standard hentry category-activedirectory tag-kerberos ast-article-single" id="post-3680" itemtype="https://schema.org/CreativeWork" itemscope="itemscope">

	
	
<div class="ast-post-format- ast-no-thumb single-layout-1">

	
	<header class="entry-header ast-no-thumbnail">

		
				<div class="ast-single-post-order">
			<h1 class="entry-title" itemprop="headline">Roasting AS-REPs</h1><div class="entry-meta">			<span class="comments-link">
				<a href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/#comments">6 Comments</a>			</span>

			 / <span class="cat-links"><a href="http://www.harmj0y.net/blog/category/activedirectory/" rel="category tag">ActiveDirectory</a></span> / By <span class="posted-by vcard author" itemtype="https://schema.org/Person" itemscope="itemscope" itemprop="author">			<a title="View all posts by harmj0y" 
				href="http://www.harmj0y.net/blog/author/harmj0y/" rel="author"
				class="url fn n" itemprop="url"				>
				<span 
				class="author-name" itemprop="name"				>harmj0y</span>
			</a>
		</span>

		</div>		</div>
		
		
	</header><!-- .entry-header -->

	
	<div class="entry-content clear" 
	itemprop="text"	>

		
		<p><span style="font-weight: 400;">Last November, I published a post titled &#8220;</span><a href="http://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/"><i><span style="font-weight: 400;">Kerberoasting Without Mimikatz</span></i></a><span style="font-weight: 400;">&#8221; that detailed new developments with </span><a href="https://github.com/PowerShellMafia/PowerSploit/blob/445f7b2510c4553dcd9451bc4daccb20c8e67cbb/Recon/PowerView.ps1"><span style="font-weight: 400;">PowerView</span></a><span style="font-weight: 400;"> and </span><a href="https://twitter.com/TimMedin"><span style="font-weight: 400;">Tim Medin</span></a><span style="font-weight: 400;">&#8216;s </span><a href="https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf"><span style="font-weight: 400;">Kerberoasting</span></a><span style="font-weight: 400;"> attack. This started me down the path of looking at Kerberos just a bit more closely. Then a few weeks ago, my coworker </span><a href="https://twitter.com/tifkin_"><span style="font-weight: 400;">Lee Christensen</span></a><span style="font-weight: 400;"> found an interesting presentation from Geoff Janjua of </span><a href="http://www.exumbraops.com/"><span style="font-weight: 400;">Exumbra Operations</span></a><span style="font-weight: 400;"> titled &#8220;</span><a href="http://www.exumbraops.com/blog/2016/6/1/kerberos-party-tricks-weaponizing-kerberos-protocol-flaws"><i><span style="font-weight: 400;">Kerberos Party Tricks: Weaponizing Kerberos Protocol Flaws</span></i></a><span style="font-weight: 400;">&#8220;, slides and toolkit </span><a href="http://www.exumbraops.com/layerone2016/party"><span style="font-weight: 400;">located here</span></a><span style="font-weight: 400;">. One of the interesting points that Geoff mentioned, and that his Python-based &#8220;Party Trick&#8221; toolkit executes, was abusing user accounts that don&#8217;t require Kerberos preauthentication.</span></p>
<p><span style="font-weight: 400;">I recently dove much deeper into this topic and wanted to share what I was able to learn and develop. This post will give some detailed background on the aspect of Kerberos we&#8217;re abusing, what the precise issue is, how to easily enumerate accounts that don&#8217;t need preauth, how to extract crackable hashes in these situations, and finally how to crack these retrieved hashes efficiently. There is also an associated PowerShell toolkit, </span><a href="https://github.com/HarmJ0y/ASREPRoast"><span style="font-weight: 400;">ASREPRoast</span></a><span style="font-weight: 400;">, that is now live on GitHub. </span></p>
<p><span style="font-weight: 400;"><strong>tl;dr</strong> &#8211; if you can enumerate any accounts in a Windows domain that don&#8217;t require Kerberos preauthentication, you can now easily request a piece of encrypted information for said accounts and efficiently crack the material offline, revealing the user&#8217;s password.</span></p>
<p><strong>Note:</strong> this isn&#8217;t anything revolutionary, and obviously isn&#8217;t as useful as Kerberoasting, as accounts have to have <a href="https://support.microsoft.com/en-us/kb/305144">DONT_REQ_PREAUTH</a> explicitly set for them to be vulnerable &#8211; you&#8217;re still reliant upon weak password complexity for the attack to work. However, this setting still exists on <em>some</em> accounts in <em>some</em> environments, we&#8217;re just not sure as to the frequency as it&#8217;s not something we normally looked for before. Our guess is that it&#8217;s likely enabled for older accounts, specifically Unix-related ones. If you happen to find it &#8220;in the wild&#8221;, we&#8217;d love to hear from you ;) (<a href="https://twitter.com/harmj0y">@harmj0y</a> or will [at] harmj0y.net).</p>
<p><strong>[Edit]</strong><em> if you have GenericWrite/GenericAll rights over a target user, you can maliciously modify their userAccountControl to not require preauth, use ASREPRoast, and then reset the value ;)</em></p>
<p><img loading="lazy" class="aligncenter size-full wp-image-3746" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/malicious_asrep.png" alt="" width="641" height="542" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/malicious_asrep.png 641w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/malicious_asrep-300x254.png 300w" sizes="(max-width: 641px) 100vw, 641px" /></p>
<h2>Background</h2>
<p>I&#8217;m not going to go through all aspects of Kerberos, as people like <a href="https://twitter.com/pyrotek3">Sean Metcalf</a> have already done a <a href="http://adsecurity.org/?p=227">great job of this</a>. If terms like AS-REQ and AS-REP are completely foreign to you, I would recommend reading <a href="http://adsecurity.org/?p=227">Sean&#8217;s post</a> for some basic background first. The aspect we care for the purposes of this post is something called <a href="https://technet.microsoft.com/en-us/library/cc961961.aspx">Kerberos preauthentication</a>.</p>
<p><span style="font-weight: 400;">Under normal operations in a Windows Kerberos environment, when you initiate a TGT request for a given user (Kerberos AS-REQ, message type 10) you have to supply a timestamp encrypted with that user&#8217;s key/password. This structure is PA-ENC-TIMESTAMP and is embedded in PA-DATA (preauthorization data) of the AS-REQ &#8211; both of these structure are described in detail </span><a href="https://tools.ietf.org/html/rfc4120#page-60"><span style="font-weight: 400;">on page 60 of RFC4120</span></a><span style="font-weight: 400;"> and were introduced in Kerberos Version 5. The KDC then decrypts the timestamp to verify if the subject making the AS-REQ really is that user, and then returns the AS-REP and continues with normal authentication procedures.</span></p>
<p><strong>Note:</strong> the KDC <em>does</em> increase the <strong>badpwdcount</strong> attribute for any incorrect PA-ENC-TIMESTAMP attempts, so we can&#8217;t use this as a method to online brute-force account passwords :(</p>
<p>The reason for Kerberos preauthentication is to prevent offline password guessing. While the AS-REP <em>ticket</em> itself is encrypted with the <em>service</em> key (in this case the krbtgt hash) the AS-REP &#8220;encrypted part&#8221; is signed with the <em>client</em> key, i.e. the key of the user we send an AS-REQ for. If preauthentication isn&#8217;t enabled, an attacker can send an AS-REQ for any user that doesn&#8217;t have preauth required and receive a bit of encrypted material back that can be cracked offline to reveal the target user&#8217;s password.</p>
<p><a href="http://windowsitpro.com/security/prevent-password-cracking-attacks-kerberos-preauthentication-data"><span style="font-weight: 400;">This is something</span></a><span style="font-weight: 400;"> that has been </span><a href="https://social.technet.microsoft.com/wiki/contents/articles/23559.kerberos-pre-authentication-why-it-should-not-be-disabled.aspx"><span style="font-weight: 400;">known for a long time</span></a><span style="font-weight: 400;">, after all, <a href="https://academiccommons.columbia.edu/catalog/ac%3A127106">it&#8217;s the reason</a> preauth was implemented in Kerberos! In modern Windows environments, all user accounts require Kerberos preauthentication, but interestingly enough, by default Windows attempts the AS-REQ/AS-REP exchange without preauthentication first, falling back to supplying the encrypted timestamp on the second submission:</span></p>
<p><img loading="lazy" class="aligncenter size-large wp-image-3683" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/normal_preauth_fail-1024x584.png" alt="" width="640" height="365" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/normal_preauth_fail-1024x584.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/normal_preauth_fail-300x171.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/normal_preauth_fail-768x438.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/normal_preauth_fail.png 1179w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><del>I have no idea why this behavior happens ¯\_(ツ)_/¯</del></p>
<p><strong>[Edit]</strong> <a href="https://twitter.com/munmap">@munmap</a> pointed <a href="https://twitter.com/munmap/status/821653238214787072">out on Twitter</a> that this behavior is due to the client not knowing the supported ETYPES ahead of time, something explicitly detailed in <a href="https://tools.ietf.org/html/rfc6113#section-2.2">section 2.2 of RFC6113</a>.</p>
<p>However, Windows offers a way to manually disable this protection for specific accounts through a <a href="https://msdn.microsoft.com/en-us/library/aa772300(v=vs.85).aspx">useraccountcontrol</a> modification:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-3690" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/ad_do_not_require_preauth_gui2.png" alt="" width="423" height="560" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/ad_do_not_require_preauth_gui2.png 423w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/ad_do_not_require_preauth_gui2-227x300.png 227w" sizes="(max-width: 423px) 100vw, 423px" /></p>
<p>If you&#8217;re already an authenticated (but otherwise unprivileged) user, you can easily enumerate what users in the domain have this setting with the LDAP filter <strong>(userAccountControl:1.2.840.113556.1.4.803:=4194304)</strong>. <a href="https://github.com/PowerShellMafia/PowerSploit/blob/445f7b2510c4553dcd9451bc4daccb20c8e67cbb/Recon/PowerView.ps1">PowerView</a>&#8216;s <strong>Get-DomainUser</strong> already has this implemented with the <a href="https://github.com/PowerShellMafia/PowerSploit/blob/445f7b2510c4553dcd9451bc4daccb20c8e67cbb/Recon/PowerView.ps1#L4767-L4770"><strong>-PreauthNotRequired</strong> </a>parameter:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-3691" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/powerview_preauth.png" alt="" width="902" height="311" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/powerview_preauth.png 902w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/powerview_preauth-300x103.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/powerview_preauth-768x265.png 768w" sizes="(max-width: 902px) 100vw, 902px" /></p>
<p>So now we know what the issue is and how to identify vulnerable users. While people have executed brute-forcing of the AS-REQ&#8217;s PA-ENC-TIMESTAMP component of Kerberos exchanges <a href="http://windowsitpro.com/security/prevent-password-cracking-attacks-kerberos-preauthentication-data">for well over a decade</a> (the hash format is even in Hashcat, <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">-m 7500/ &#8216;Kerberos 5 AS-REQ Pre-Auth&#8217;</a>) the only toolset I&#8217;ve seen that attacks RC4 AS-REPs is <a href="http://www.exumbraops.com/layerone2016/party">Geoff&#8217;s Python toolkit</a>. We wanted something that was Windows based that also didn&#8217;t need administrative privileges on a machine to allow us flexibility in our attack workflow. We also wanted a faster way to crack these hashes.</p>
<h2>ASREPRoast</h2>
<p><span style="font-weight: 400;">My first hope was to find something in .NET that exposed the raw bytes of the AS-REP similar to the </span><a href="http://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/"><span style="font-weight: 400;">Kerberoasting approach</span></a><span style="font-weight: 400;">. I spent a while searching for any .NET method that would allow access to the raw byte response of the AS-REP and unfortunately came up short. Though I can&#8217;t say definitively if this is impossible, my gut feeling is that it&#8217;s likely an abstraction level too deep for us to access easily through .NET. Even if there was, we would still have one complication, as modern Windows Kerberos environments default to the the AES256-CTS-HMAC-SHA1-96 encryption in the AS-REP instead of the much quicker ARCFOUR-HMAC-MD5/RC4 approach. RC4-HMAC is </span><i><span style="font-weight: 400;">significantly</span></i><span style="font-weight: 400;"> quicker to crack, so we prefer it if possible.</span></p>
<p><span style="font-weight: 400;">The approach I ended up taking was to construct the AS-REQ by hand in order to control the necessary parameters, and parsing the KDC&#8217;s AS-REP response in order to determine success/failure and extract the encrypted material. Here was another roadblock- Kerberos uses ASN.1 encoding for its structures, something that .NET does not have built in encoders or decoders for. Luckily, there is an </span><a href="https://github.com/bcgit/bc-csharp"><span style="font-weight: 400;">open source C# version</span></a><span style="font-weight: 400;"> of the </span><a href="https://www.bouncycastle.org/"><span style="font-weight: 400;">Bouncy Castle</span></a><span style="font-weight: 400;"> crypto library that features, among many, many other things, robust capability for ASN.1 encoding and decoding.</span></p>
<p><span style="font-weight: 400;">Unfortunately, I don&#8217;t have time to give a full ASN.1 tutorial, but I will share a few pointers that helped me while developing this tool. The specifications we care about for the AS-REQ are laid out on </span><a href="http://www.freesoft.org/CIE/RFC/1510/55.htm"><span style="font-weight: 400;">page 55 of RFC1510</span></a><span style="font-weight: 400;"> and </span><a href="https://tools.ietf.org/html/rfc4120#page-74"><span style="font-weight: 400;">page 74 of RFC4120</span></a><span style="font-weight: 400;">. </span><a href="https://twitter.com/gentilkiwi/"><span style="font-weight: 400;">Benjamin Delpy</span></a><span style="font-weight: 400;"> also documents all these ASN.1 structures amazingly in his </span><a href="https://github.com/gentilkiwi/kekeo/blob/master/modules/KerberosV5Spec2.asn"><span style="font-weight: 400;">Kekeo project</span></a><span style="font-weight: 400;">. Here&#8217;s the structure description:</span></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a95e9461631700688429" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
AS-REQ ::=         [APPLICATION 10] KDC-REQ

KDC-REQ ::=        SEQUENCE {
           pvno[1]               INTEGER,
           msg-type[2]           INTEGER,
           padata[3]             SEQUENCE OF PA-DATA OPTIONAL,
           req-body[4]           KDC-REQ-BODY
}

PA-DATA ::=        SEQUENCE {
           padata-type[1]        INTEGER,
           padata-value[2]       OCTET STRING,
                         -- might be encoded AP-REQ
}

KDC-REQ-BODY ::=   SEQUENCE {
            kdc-options[0]       KDCOptions,
            cname[1]             PrincipalName OPTIONAL,
                         -- Used only in AS-REQ
            realm[2]             Realm, -- Server's realm
                         -- Also client's in AS-REQ
            sname[3]             PrincipalName OPTIONAL,
            from[4]              KerberosTime OPTIONAL,
            till[5]              KerberosTime,
            rtime[6]             KerberosTime OPTIONAL,
            nonce[7]             INTEGER,
            etype[8]             SEQUENCE OF INTEGER, -- EncryptionType,
                         -- in preference order
            addresses[9]         HostAddresses OPTIONAL,
            enc-authorization-data[10]   EncryptedData OPTIONAL,
                         -- Encrypted AuthorizationData encoding
            additional-tickets[11]       SEQUENCE OF Ticket OPTIONAL
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a95e9461631700688429-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-2">2</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-4">4</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-6">6</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-8">8</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-10">10</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-12">12</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-14">14</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-16">16</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-18">18</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-20">20</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-22">22</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-24">24</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-26">26</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-28">28</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-30">30</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-60a95e9461631700688429-32">32</div><div class="crayon-num" data-line="crayon-60a95e9461631700688429-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a95e9461631700688429-1"><span class="crayon-st">AS</span><span class="crayon-o">-</span><span class="crayon-v">REQ</span><span class="crayon-h"> </span><span class="crayon-o">::</span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-i">APPLICATION</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">KDC</span><span class="crayon-o">-</span><span class="crayon-e">REQ</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-2">&nbsp;</div><div class="crayon-line" id="crayon-60a95e9461631700688429-3"><span class="crayon-v">KDC</span><span class="crayon-o">-</span><span class="crayon-v">REQ</span><span class="crayon-h"> </span><span class="crayon-o">::</span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">SEQUENCE</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">pvno</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">INTEGER</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">msg</span><span class="crayon-o">-</span><span class="crayon-v">type</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">INTEGER</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">padata</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">SEQUENCE </span><span class="crayon-e">OF </span><span class="crayon-v">PA</span><span class="crayon-o">-</span><span class="crayon-e">DATA </span><span class="crayon-v">OPTIONAL</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">req</span><span class="crayon-o">-</span><span class="crayon-v">body</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">KDC</span><span class="crayon-o">-</span><span class="crayon-v">REQ</span><span class="crayon-o">-</span><span class="crayon-i">BODY</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-8"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-10"><span class="crayon-v">PA</span><span class="crayon-o">-</span><span class="crayon-v">DATA</span><span class="crayon-h"> </span><span class="crayon-o">::</span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">SEQUENCE</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">padata</span><span class="crayon-o">-</span><span class="crayon-v">type</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">INTEGER</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">padata</span><span class="crayon-o">-</span><span class="crayon-v">value</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">OCTET </span><span class="crayon-t">STRING</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-e">might </span><span class="crayon-e">be </span><span class="crayon-e">encoded </span><span class="crayon-v">AP</span><span class="crayon-o">-</span><span class="crayon-i">REQ</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-14"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-16"><span class="crayon-v">KDC</span><span class="crayon-o">-</span><span class="crayon-v">REQ</span><span class="crayon-o">-</span><span class="crayon-v">BODY</span><span class="crayon-h"> </span><span class="crayon-o">::</span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">SEQUENCE</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">kdc</span><span class="crayon-o">-</span><span class="crayon-v">options</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">KDCOptions</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cname</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">PrincipalName </span><span class="crayon-v">OPTIONAL</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-e">Used </span><span class="crayon-e">only </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-o">-</span><span class="crayon-e">REQ</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-20"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">realm</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">Realm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-i">Server</span><span class="crayon-s">'s realm</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-21"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -- Also client'</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-o">-</span><span class="crayon-e">REQ</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-22"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sname</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">PrincipalName </span><span class="crayon-v">OPTIONAL</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">from</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">KerberosTime </span><span class="crayon-v">OPTIONAL</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">till</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">KerberosTime</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rtime</span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">KerberosTime </span><span class="crayon-v">OPTIONAL</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">nonce</span><span class="crayon-sy">[</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">INTEGER</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">etype</span><span class="crayon-sy">[</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">SEQUENCE </span><span class="crayon-e">OF </span><span class="crayon-t">INTEGER</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-v">EncryptionType</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">preference </span><span class="crayon-e">order</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-29"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">addresses</span><span class="crayon-sy">[</span><span class="crayon-cn">9</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">HostAddresses </span><span class="crayon-v">OPTIONAL</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">enc</span><span class="crayon-o">-</span><span class="crayon-v">authorization</span><span class="crayon-o">-</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">EncryptedData </span><span class="crayon-v">OPTIONAL</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-e">Encrypted </span><span class="crayon-e">AuthorizationData </span><span class="crayon-e">encoding</span></div><div class="crayon-line crayon-striped-line" id="crayon-60a95e9461631700688429-32"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">additional</span><span class="crayon-o">-</span><span class="crayon-v">tickets</span><span class="crayon-sy">[</span><span class="crayon-cn">11</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">SEQUENCE </span><span class="crayon-e">OF </span><span class="crayon-e">Ticket </span><span class="crayon-i">OPTIONAL</span></div><div class="crayon-line" id="crayon-60a95e9461631700688429-33"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0056 seconds] -->
<p>Another thing that helped me a lot was to Wireshark legitimate Kerberos exchanges, export the Kerberos packet bytes, and visualize the data using <a href="https://lapo.it/asn1js/">this JavaScript ASN.1 decoder</a>:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-3684" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/asn1_javascript_decoder-1024x576.png" alt="" width="640" height="360" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/asn1_javascript_decoder-1024x576.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/asn1_javascript_decoder-300x169.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/asn1_javascript_decoder-768x432.png 768w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><span style="font-weight: 400;">This particularly helped during the next part, which was learning how to use Bouncy Castle through PowerShell to construct a proper ASN.1 encoded AS-REQ. But after a few struggles with tagging and finding the correct data structures, I came up with </span><b>New-ASReq</b><span style="font-weight: 400;">, which </span><a href="https://github.com/adaptivethreat/ASREPRoast/blob/21c4ea5a0e2a70ea51a4763df8308ec8e4b233f0/ASREPRoast.ps1#L496-L571"><span style="font-weight: 400;">takes a user/domain name, builds the properly nested components, and returns the raw bytes for the request</span></a><span style="font-weight: 400;">.</span></p>
<p><span style="font-weight: 400;">And because we&#8217;re building this by hand, we can include or omit anything we want. So we can include </span><b>just </b><span style="font-weight: 400;">the ARCFOUR-HMAC-MD5 etype instead of all supported encryption etypes. This type and its use in Windows Kerberos auth is </span><a href="https://tools.ietf.org/html/rfc4757"><span style="font-weight: 400;">explained in detail in RFC4757</span></a><span style="font-weight: 400;">. What&#8217;s especially nice is </span><a href="https://tools.ietf.org/html/rfc4757#section-3"><span style="font-weight: 400;">that section 3</span></a><span style="font-weight: 400;"> includes the message types for different uses of the algorithm. While the AS-REP </span><b>ticket</b><span style="font-weight: 400;"> uses type 2 like a TGS-REP ticket (i.e. kerberoasting) this component of the response is encrypted with the service key, which in this case is the krbtgt hash and therefore not crackable. However, the AS-REP </span><b>encrypted part</b><span style="font-weight: 400;">, which is the section we can essentially &#8216;downgrade&#8217; to RC4-HMAC, is the same algorithm but of message type 8. This will come into play later during the cracking section.</span></p>
<p>A second function in <a href="https://github.com/adaptivethreat/ASREPRoast">ASREPRoast</a>, <strong>Get-ASREPHash</strong>, wraps <strong>New-ASReq</strong> to generate the appropriate AS-REQ for a specific user/domain, enumerates a domain controller for the passed domain, <a href="https://github.com/adaptivethreat/ASREPRoast/blob/21c4ea5a0e2a70ea51a4763df8308ec8e4b233f0/ASREPRoast.ps1#L745-L767">sends the crafted AS-REQ, and receives the response bytes</a>. Bouncy Castle is used to decode the response, checking whether it is a <a href="http://www.freesoft.org/CIE/RFC/1510/68.htm">KRB-ERROR</a> response or a proper <a href="http://www.freesoft.org/CIE/RFC/1510/56.htm">AS-REP</a>. If the request succeeded, we can <a href="https://github.com/adaptivethreat/ASREPRoast/blob/21c4ea5a0e2a70ea51a4763df8308ec8e4b233f0/ASREPRoast.ps1#L776-L781">extract out the enc-part section</a> that&#8217;s RC4-HMAC encrypted using the specified user&#8217;s hash and return it in a nice format:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-3692" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/get_asrephash.png" alt="" width="902" height="281" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/get_asrephash.png 902w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/get_asrephash-300x93.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/get_asrephash-768x239.png 768w" sizes="(max-width: 902px) 100vw, 902px" /></p>
<p>The final useful function in <a href="https://github.com/adaptivethreat/ASREPRoast">ASREPRoast</a> is <a href="https://github.com/adaptivethreat/ASREPRoast/blob/21c4ea5a0e2a70ea51a4763df8308ec8e4b233f0/ASREPRoast.ps1#L795-L910"><strong>Invoke-ASREPRoast</strong></a>. If run from a domain authenticated, but otherwise unprivileged, user context in a Windows Kerberos environment, this function will first enumerate all users who have &#8220;Do not require Kerberos preauthentication&#8221; set in their user account control settings by using the LDAP filter <strong>(userAccountControl:1.2.840.113556.1.4.803:=4194304)</strong>. For each user returned <strong>Get-ASREPHash</strong> is used to return a crackable hash:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-3693" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/invoke_asreproast.png" alt="" width="899" height="692" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/invoke_asreproast.png 899w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/invoke_asreproast-300x231.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/invoke_asreproast-768x591.png 768w" sizes="(max-width: 899px) 100vw, 899px" /></p>
<h2>Cracking The Hashes</h2>
<p>We now have a nice set hash representations of RC4-HMAC AS-REPs, each of which are encrypted with a user&#8217;s password. We should now be able to crack these offline à la Kerberosting (<strong>krb5tgs</strong> format in John the Ripper), but remember that despite using the same algorithm and approach as the existing TGS-REP format, the <a href="https://tools.ietf.org/html/rfc4757#section-3">message type here is 8 instead of 2</a>.</p>
<p>This unfortunately means that existing plugins won&#8217;t work, but luckily for us, all we have to do is change <a href="https://github.com/magnumripper/JohnTheRipper/blob/b06be900f357c8d594e1c4e38d54eb0db06a4e24/src/krb5_tgs_fmt_plug.c#L270">this line</a> to an 8 instead of a 2, remove some of the <a href="https://github.com/magnumripper/JohnTheRipper/blob/b06be900f357c8d594e1c4e38d54eb0db06a4e24/src/krb5_tgs_fmt_plug.c#L332-L334">specific TGS ASN.1 speedups</a>, and change the format naming. I have a included a tweaked version of this <a href="https://github.com/adaptivethreat/ASREPRoast/blob/master/krb5_asrep_fmt_plug.c">krb5_asrep_fmt_plug.c plugin with the ASREPRoast project</a>. Simply drop it into the source folder for <a href="https://github.com/magnumripper/JohnTheRipper/tree/bleeding-jumbo/src">Magnumripper</a>, run the normal build instructions, and you&#8217;d good to go for cracking the output of ASREPRoast.ps1:</p>
<p><img loading="lazy" class="aligncenter size-full wp-image-3694" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/john_asrep_crack.png" alt="" width="876" height="488" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/01/john_asrep_crack.png 876w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/john_asrep_crack-300x167.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2017/01/john_asrep_crack-768x428.png 768w" sizes="(max-width: 876px) 100vw, 876px" /></p>
<p>I believe that it should be simple to modify Hashcat&#8217;s existing TGS-REP format as well in a <a href="https://github.com/hashcat/hashcat/blob/master/OpenCL/m13100_a0.cl#L659">similar way</a>, but I haven&#8217;t attempted it yet. Also, because this is the same algorithm as the krb5tgs/Kerberoasting format, just with a tweak in key material, performance should be similar to the existing modules.</p>
<h2>Closing Thoughts</h2>
<p>As I mentioned at the beginning, this obviously isn&#8217;t as useful as the <a href="https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf">Kerberoasting</a> attack, as accounts have to have <a href="https://support.microsoft.com/en-us/kb/305144">DONT_REQ_PREAUTH</a> explicitly set for them to be vulnerable, and you&#8217;re still reliant upon weak password complexity for the attack to work. However, this setting is sometimes present in <em>some</em> environments, often on aging accounts for backwards compatibility reasons, and we feel that the toolset will be operationally useful in some situations at least.</p>
<p><span style="font-weight: 400;">Defensively, the same protections outlined for Kerberoasting apply here, specifically have really long passwords for these types of accounts and alert when abnormal hosts are sent an AS-REP for the account. Also, audit what accounts have this setting, which is easy with <a href="https://github.com/PowerShellMafia/PowerSploit/blob/445f7b2510c4553dcd9451bc4daccb20c8e67cbb/Recon/PowerView.ps1">PowerView</a> (</span><b>Get-DomainUser -PreauthNotRequired</b><span style="font-weight: 400;">) or other LDAP toolsets with the </span><b>(userAccountControl:1.2.840.113556.1.4.803:=4194304)</b><span style="font-weight: 400;"> filter. Carefully consider whether accounts with this setting truly are needed.</span></p>
<p><strong>[Edit] </strong>also for the defensive side, <a href="https://twitter.com/munmap">@munmap</a> suggested investigating <a href="https://tools.ietf.org/html/rfc6113#section-5.4">Kerberos FAST pre-authentication</a> and/or <a href="https://tools.ietf.org/html/rfc4556">Public Key Cryptography for Initial Authentication in Kerberos (PKINIT)</a>.</p>
<hr>
<p>
  <em>
  Also published on <a href="https://medium.com/@harmj0y/roasting-as-reps-e6179a65216b">Medium</a>.  </em>
</p>

		
		
			</div><!-- .entry-content .clear -->
</div>

	
</article><!-- #post-## -->


	<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="http://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/" rel="prev"><span class="ast-left-arrow">&larr;</span> Previous Post</a></div><div class="nav-next"><a href="http://www.harmj0y.net/blog/activedirectory/targeted-kerberoasting/" rel="next">Next Post <span class="ast-right-arrow">&rarr;</span></a></div></div>
	</nav>
<div id="comments" class="comments-area">

	
				<h3 class="comments-title">
				6 thoughts on &ldquo;Roasting AS-REPs&rdquo;			</h3>
		
		<ol class="ast-comment-list">
							<li class="pingback even thread-even depth-1" id="comment-37115">
					<p>Pingback: <a href='https://adsecurity.org/?p=3466' rel='external nofollow ugc' class='url'>Sneaky Persistence Active Directory Trick #18: Dropping SPNs on Admin Accounts for Later Kerberoasting &#187; Active Directory Security</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-37373">
					<p>Pingback: <a href='https://adsecurity.org/?p=3458' rel='external nofollow ugc' class='url'>Detecting Kerberoasting Activity &#187; Active Directory Security</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback even thread-even depth-1" id="comment-37565">
					<p>Pingback: <a href='https://adsecurity.org/?p=3513' rel='external nofollow ugc' class='url'>Detecting Kerberoasting Activity Part 2 &#8211; Creating a Kerberoast Service Account Honeypot &#187; Active Directory Security</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-41168">
					<p>Pingback: <a href='http://resources.infosecinstitute.com/advanced-techniques-attackers-use-crack-passwords/' rel='external nofollow ugc' class='url'>Advanced Techniques Attackers Use to Crack Passwords</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="comment even thread-even depth-1" id="li-comment-43794">

					<article id="comment-43794" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://0.gravatar.com/avatar/ffc228d39118709bb881fb285699de03?s=50&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/ffc228d39118709bb881fb285699de03?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">jane doe</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/#comment-43794"><time datetime="2017-08-06T16:57:37-05:00">August 6, 2017 at 4:57 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Part &#8220;Background&#8221;, second paragraph (in bold font), text &#8220;&#8230;and then returns the AS-REQ &#8230;&#8221; should be &#8220;&#8230;and then returns the AS-REP &#8230;&#8221; (i.e. AS-REP instead of AS-REQ).</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/?replytocom=43794#respond' data-commentid="43794" data-postid="3680" data-belowelement="comment-43794" data-respondelement="respond" data-replyto="Reply to jane doe" aria-label='Reply to jane doe'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor odd alt depth-2" id="li-comment-43808">

					<article id="comment-43808" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/#comment-43808"><time datetime="2017-08-07T01:39:39-05:00">August 7, 2017 at 1:39 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Good catch, thanks! Fixed.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/?replytocom=43808#respond' data-commentid="43808" data-postid="3680" data-belowelement="comment-43808" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .ast-comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/activedirectory/roasting-as-reps/#respond" style="display:none;">Cancel Reply</a></small></h3><form action="http://www.harmj0y.net/blog/wp-comments-post.php" method="post" id="ast-commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><div class="ast-row comment-textarea"><fieldset class="comment-form-comment"><div class="comment-form-textarea ast-grid-common-col"><label for="comment" class="screen-reader-text">Type here..</label><textarea id="comment" name="comment" placeholder="Type here.." cols="45" rows="8" aria-required="true"></textarea></div></fieldset></div><div class="ast-comment-formwrap ast-row"><p class="comment-form-author ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="author" class="screen-reader-text">Name*</label><input id="author" name="author" type="text" value="" placeholder="Name*" size="30" aria-required='true' /></p>
<p class="comment-form-email ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="email" class="screen-reader-text">Email*</label><input id="email" name="email" type="text" value="" placeholder="Email*" size="30" aria-required='true' /></p>
<p class="comment-form-url ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="url"><label for="url" class="screen-reader-text">Website</label><input id="url" name="url" type="text" value="" placeholder="Website" size="30" /></label></p></div>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment &raquo;" /> <input type='hidden' name='comment_post_ID' value='3680' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="295992dfbb" /></p><input type="hidden" id="ak_js" name="ak_js" value="248"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	<p class="akismet_comment_form_privacy_notice">This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" target="_blank" rel="nofollow noopener">Learn how your comment data is processed</a>.</p>
	
</div><!-- #comments -->
			</main><!-- #main -->
			
		
	</div><!-- #primary -->


	<div class="widget-area secondary" id="secondary" role="complementary" itemtype="https://schema.org/WPSideBar" itemscope="itemscope">
	<div class="sidebar-main" >
				<aside id="media_image-5" class="widget widget_media_image"><a href="https://specterops.io/" target="_blank" rel="noopener"><img width="751" height="786" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops.png" class="image wp-image-4177 alignleft attachment-full size-full" alt="" loading="lazy" style="max-width: 100%; height: auto;" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops.png 751w, http://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops-287x300.png 287w" sizes="(max-width: 751px) 100vw, 751px" /></a></aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h2 class="widget-title">Recent Posts</h2><nav role="navigation" aria-label="Recent Posts">
		<ul>
											<li>
					<a href="http://www.harmj0y.net/blog/activedirectory/a-case-study-in-wagging-the-dog-computer-takeover/">A Case Study in Wagging the Dog: Computer Takeover</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/kerberoasting-revisited/">Kerberoasting Revisited</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/not-a-security-boundary-breaking-forest-trusts/">Not A Security Boundary: Breaking Forest Trusts</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/another-word-on-delegation/">Another Word on Delegation</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/rubeus-now-with-more-kekeo/">Rubeus &#8211; Now With More Kekeo</a>
									</li>
					</ul>

		</nav></aside><aside id="archives-2" class="widget widget_archive"><h2 class="widget-title">Archives</h2>		<label class="screen-reader-text" for="archives-dropdown-2">Archives</label>
		<select id="archives-dropdown-2" name="archive-dropdown">
			
			<option value="">Select Month</option>
				<option value='http://www.harmj0y.net/blog/2019/02/'> February 2019 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2018/11/'> November 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2018/10/'> October 2018 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2018/09/'> September 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2018/08/'> August 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2018/07/'> July 2018 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2018/04/'> April 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/11/'> November 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/10/'> October 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/09/'> September 2017 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2017/08/'> August 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/07/'> July 2017 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2017/06/'> June 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/05/'> May 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/03/'> March 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/01/'> January 2017 &nbsp;(4)</option>
	<option value='http://www.harmj0y.net/blog/2016/12/'> December 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/11/'> November 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/10/'> October 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/09/'> September 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/08/'> August 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/07/'> July 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/06/'> June 2016 &nbsp;(3)</option>
	<option value='http://www.harmj0y.net/blog/2016/05/'> May 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/04/'> April 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/03/'> March 2016 &nbsp;(4)</option>
	<option value='http://www.harmj0y.net/blog/2016/02/'> February 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/01/'> January 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/12/'> December 2015 &nbsp;(4)</option>
	<option value='http://www.harmj0y.net/blog/2015/11/'> November 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/10/'> October 2015 &nbsp;(3)</option>
	<option value='http://www.harmj0y.net/blog/2015/09/'> September 2015 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2015/08/'> August 2015 &nbsp;(3)</option>
	<option value='http://www.harmj0y.net/blog/2015/07/'> July 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/06/'> June 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/05/'> May 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/04/'> April 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/03/'> March 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/01/'> January 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2014/12/'> December 2014 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2014/11/'> November 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/10/'> October 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/09/'> September 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/08/'> August 2014 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2014/07/'> July 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/06/'> June 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/05/'> May 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/04/'> April 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/03/'> March 2014 &nbsp;(1)</option>

		</select>

<script>
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "archives-dropdown-2" );
	function onSelectChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value !== '' ) {
			document.location.href = this.options[ this.selectedIndex ].value;
		}
	}
	dropdown.onchange = onSelectChange;
})();
/* ]]> */
</script>
			</aside><aside id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://www.harmj0y.net/blog/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
					<button class="search-submit">
				<span hidden>Search</span>
				<i><span class="ast-icon icon-search"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="-888 480 142 142" enable-background="new -888 480 142 142" xml:space="preserve">
				<title/>
				<desc/>
				<path id="Shape" d="M-787.4,568.7h-6.3l-2.4-2.4c7.9-8.7,12.6-20.5,12.6-33.1c0-28.4-22.9-51.3-51.3-51.3  c-28.4,0-51.3,22.9-51.3,51.3c0,28.4,22.9,51.3,51.3,51.3c12.6,0,24.4-4.7,33.1-12.6l2.4,2.4v6.3l39.4,39.4l11.8-11.8L-787.4,568.7  L-787.4,568.7z M-834.7,568.7c-19.7,0-35.5-15.8-35.5-35.5c0-19.7,15.8-35.5,35.5-35.5c19.7,0,35.5,15.8,35.5,35.5  C-799.3,553-815,568.7-834.7,568.7L-834.7,568.7z"/>
				</svg></span></i>
			</button>
			</label>
	<input type="submit" class="search-submit" value="Search">
</form>
</aside><aside id="categories-4" class="widget widget_categories"><h2 class="widget-title">Categories</h2><nav role="navigation" aria-label="Categories">
			<ul>
					<li class="cat-item cat-item-38"><a href="http://www.harmj0y.net/blog/category/activedirectory/">ActiveDirectory</a>
</li>
	<li class="cat-item cat-item-25"><a href="http://www.harmj0y.net/blog/category/defense/">Defense</a>
</li>
	<li class="cat-item cat-item-21"><a href="http://www.harmj0y.net/blog/category/empire/">Empire</a>
</li>
	<li class="cat-item cat-item-32"><a href="http://www.harmj0y.net/blog/category/empyre/">EmPyre</a>
</li>
	<li class="cat-item cat-item-12"><a href="http://www.harmj0y.net/blog/category/informational/">Informational</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://www.harmj0y.net/blog/category/penetesting/">Penetesting</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://www.harmj0y.net/blog/category/powershell/">Powershell</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://www.harmj0y.net/blog/category/python/">Python</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://www.harmj0y.net/blog/category/redteaming/">Red Teaming</a>
</li>
	<li class="cat-item cat-item-50"><a href="http://www.harmj0y.net/blog/category/top-posts/">Top Posts</a>
</li>
			</ul>

			</nav></aside><aside id="linkcat-2" class="widget widget_links"><h2 class="widget-title">Blogroll</h2>
	<ul class='xoxo blogroll'>
<li><a href="https://bluescreenofjeff.com/">bluescreenofjeff.com</a></li>
<li><a href="https://enigma0x3.net/">enigma0x3.net</a></li>
<li><a href="http://www.invoke-ir.com/">invoke-ir.com</a></li>
<li><a href="https://wald0.com/">wald0.com</a></li>

	</ul>
</aside>
<aside id="twitter_timeline-3" class="widget widget_twitter_timeline"><a class="twitter-timeline" data-width="220" data-theme="dark" data-border-color="#e8e8e8" data-tweet-limit="5" data-lang="EN" data-partner="jetpack" data-chrome="noscrollbar" href="https://twitter.com/harmj0y" href="https://twitter.com/harmj0y">My Tweets</a></aside>
	</div><!-- .sidebar-main -->
</div><!-- #secondary -->


	</div> <!-- ast-container -->
	</div><!-- #content -->
<footer
class="site-footer" id="colophon" itemtype="https://schema.org/WPFooter" itemscope="itemscope" itemid="#colophon">
			<div class="site-primary-footer-wrap ast-builder-grid-row-container site-footer-focus-item ast-builder-grid-row-3-equal ast-builder-grid-row-tablet-3-equal ast-builder-grid-row-mobile-full ast-footer-row-stack ast-footer-row-tablet-stack ast-footer-row-mobile-stack" data-section="section-primary-footer-builder">
	<div class="ast-builder-grid-row-container-inner">
					<div class="ast-builder-footer-grid-columns site-primary-footer-inner-wrap ast-builder-grid-row">
											<div class="site-footer-primary-section-1 site-footer-section site-footer-section-1">
								<div class="footer-widget-area widget-area site-footer-focus-item" data-section="section-footer-menu">
							</div>
							</div>
											<div class="site-footer-primary-section-2 site-footer-section site-footer-section-2">
									</div>
											<div class="site-footer-primary-section-3 site-footer-section site-footer-section-3">
									</div>
										</div>
			</div>

</div>
<div class="site-below-footer-wrap ast-builder-grid-row-container site-footer-focus-item ast-builder-grid-row-full ast-builder-grid-row-tablet-full ast-builder-grid-row-mobile-full ast-footer-row-stack ast-footer-row-tablet-stack ast-footer-row-mobile-stack" data-section="section-below-footer-builder">
	<div class="ast-builder-grid-row-container-inner">
					<div class="ast-builder-footer-grid-columns site-below-footer-inner-wrap ast-builder-grid-row">
											<div class="site-footer-below-section-1 site-footer-section site-footer-section-1">
								<div class="ast-builder-layout-element ast-flex site-footer-focus-item ast-footer-copyright" data-section="section-footer-builder">
				<div class="ast-footer-copyright"><p>Copyright &copy; 2021 harmj0y | Designed by <a href="http://felicitybrigham.com">Felicity Brigham Design</a></p>
</div>			</div>
						</div>
										</div>
			</div>

</div>
	</footer><!-- #colophon -->
	</div><!-- #page -->
	<div style="display:none">
	<div class="grofile-hash-map-ffc228d39118709bb881fb285699de03">
	</div>
	<div class="grofile-hash-map-a874809641a854ae50e959b608dadefc">
	</div>
	</div>
<script src='http://www.harmj0y.net/blog/wp-includes/js/comment-reply.min.js?ver=5.7.2' id='comment-reply-js'></script>
<script id='astra-theme-js-js-extra'>
var astra = {"break_point":"921","isRtl":""};
</script>
<script src='http://www.harmj0y.net/blog/wp-content/themes/astra/assets/js/minified/frontend.min.js?ver=3.4.2' id='astra-theme-js-js'></script>
<script src='https://secure.gravatar.com/js/gprofiles.js?ver=202120' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":""};
</script>
<script src='http://www.harmj0y.net/blog/wp-content/plugins/jetpack/modules/wpgroho.js?ver=9.7' id='wpgroho-js'></script>
<script src='http://www.harmj0y.net/blog/wp-content/plugins/jetpack/_inc/build/twitter-timeline.min.js?ver=4.0.0' id='jetpack-twitter-timeline-js'></script>
<script src='http://www.harmj0y.net/blog/wp-includes/js/wp-embed.min.js?ver=5.7.2' id='wp-embed-js'></script>
<script async="async" src='http://www.harmj0y.net/blog/wp-content/plugins/akismet/_inc/form.js?ver=4.1.9' id='akismet-form-js'></script>
			<script>
			/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
			</script>
			<script src='https://stats.wp.com/e-202120.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'65454229',post:'3680',tz:'-5',srv:'www.harmj0y.net'} ]);
	_stq.push([ 'clickTrackerInit', '65454229', '3680' ]);
</script>
	</body>
</html>

<!-- Page generated by LiteSpeed Cache 3.6.4 on 2021-05-22 14:42:12 -->