<!DOCTYPE html><!--[if IE 7]>
<html class="ie ie7" lang="en-US" prefix="og: http://ogp.me/ns#">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US" prefix="og: http://ogp.me/ns#">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<!--<![endif]-->
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Mimikatz and Active Directory Kerberos Attacks &#8211; Active Directory Security</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Feed" href="https://adsecurity.org/?feed=rss2" />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Comments Feed" href="https://adsecurity.org/?feed=comments-rss2" />
<link rel="alternate" type="application/rss+xml" title="Active Directory Security &raquo; Mimikatz and Active Directory Kerberos Attacks Comments Feed" href="https://adsecurity.org/?feed=rss2&#038;p=556" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/adsecurity.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css'  href='https://adsecurity.org/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css'  href='https://adsecurity.org/wp-content/themes/graphene/bootstrap/css/bootstrap.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://adsecurity.org/wp-content/themes/graphene/fonts/font-awesome/css/font-awesome.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='graphene-css'  href='https://adsecurity.org/wp-content/themes/graphene/style.css?ver=2.8.4' type='text/css' media='screen' />
<link rel='stylesheet' id='graphene-responsive-css'  href='https://adsecurity.org/wp-content/themes/graphene/responsive.css?ver=2.8.4' type='text/css' media='all' />
<link rel='stylesheet' id='graphene-blocks-css'  href='https://adsecurity.org/wp-content/themes/graphene/blocks.css?ver=2.8.4' type='text/css' media='all' />
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/bootstrap/js/bootstrap.min.js?ver=2.8.4' id='bootstrap-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js?ver=2.8.4' id='bootstrap-hover-dropdown-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/bootstrap-submenu/bootstrap-submenu.min.js?ver=2.8.4' id='bootstrap-submenu-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/jquery.infinitescroll.min.js?ver=2.8.4' id='infinite-scroll-js'></script>
<script type='text/javascript' id='graphene-js-extra'>
/* <![CDATA[ */
var grapheneJS = {"siteurl":"https:\/\/adsecurity.org","ajaxurl":"https:\/\/adsecurity.org\/wp-admin\/admin-ajax.php","templateUrl":"https:\/\/adsecurity.org\/wp-content\/themes\/graphene","isSingular":"1","enableStickyMenu":"","shouldShowComments":"1","commentsOrder":"newest","sliderDisable":"","sliderInterval":"7000","infScrollBtnLbl":"Load more","infScrollOn":"","infScrollCommentsOn":"","totalPosts":"1","postsPerPage":"10","isPageNavi":"","infScrollMsgText":"Fetching window.grapheneInfScrollItemsPerPage of window.grapheneInfScrollItemsLeft items left ...","infScrollMsgTextPlural":"Fetching window.grapheneInfScrollItemsPerPage of window.grapheneInfScrollItemsLeft items left ...","infScrollFinishedText":"All loaded!","commentsPerPage":"50","totalComments":"1","infScrollCommentsMsg":"Fetching window.grapheneInfScrollCommentsPerPage of window.grapheneInfScrollCommentsLeft comments left ...","infScrollCommentsMsgPlural":"Fetching window.grapheneInfScrollCommentsPerPage of window.grapheneInfScrollCommentsLeft comments left ...","infScrollCommentsFinishedMsg":"All comments loaded!","disableLiveSearch":"1","txtNoResult":"No result found.","isMasonry":""};
/* ]]> */
</script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-content/themes/graphene/js/graphene.js?ver=2.8.4' id='graphene-js'></script>
<link rel="https://api.w.org/" href="https://adsecurity.org/index.php?rest_route=/" /><link rel="alternate" type="application/json" href="https://adsecurity.org/index.php?rest_route=/wp/v2/posts/556" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://adsecurity.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://adsecurity.org/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="https://adsecurity.org/?p=556" />
<link rel='shortlink' href='https://adsecurity.org/?p=556' />
<link rel="alternate" type="application/json+oembed" href="https://adsecurity.org/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2Fadsecurity.org%2F%3Fp%3D556" />
<link rel="alternate" type="text/xml+oembed" href="https://adsecurity.org/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2Fadsecurity.org%2F%3Fp%3D556&#038;format=xml" />
		<script type="text/javascript">
			var _statcounter = _statcounter || [];
			_statcounter.push({"tags": {"author": "SeanMetcalf"}});
		</script>
				<script>
		   WebFontConfig = {
		      google: { 
		      	families: ["Lato:400,400i,700,700i&display=swap"]		      }
		   };

		   (function(d) {
		      var wf = d.createElement('script'), s = d.scripts[0];
		      wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
		      wf.async = true;
		      s.parentNode.insertBefore(wf, s);
		   })(document);
		</script>
	<style type="text/css">
.header_title, .header_title a, .header_title a:visited, .header_title a:hover, .header_desc {color:#000000}.carousel, .carousel .item{height:400px}@media (max-width: 991px) {.carousel, .carousel .item{height:250px}}#header{max-height:198px}@media (min-width: 1200px) {.container {width:1280px}}
</style>
		<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":"https:\/\/adsecurity.org\/?p=556","publisher":{"@type":"Organization","name":"Active Directory Security"},"headline":"Mimikatz and Active Directory Kerberos Attacks","datePublished":"2014-11-22T23:30:43+00:00","dateModified":"2015-12-29T15:07:34+00:00","description":"NOTE: While this page will remain, the majority of the Mimikatz information in this page is now in the \"Unofficial Mimikatz Guide &amp; Command Reference\" which will be updated on a regular basis. Mimikatz is the latest, and one of the best, tool to gather credential data from Windows systems. In fact I consider Mimikatz ...","author":{"@type":"Person","name":"Sean Metcalf"},"image":["https:\/\/adsecurity.org\/wp-content\/uploads\/2014\/11\/Mimikatz-PassTheCache.png","https:\/\/adsecurity.org\/wp-content\/uploads\/2014\/11\/Delpy-CredentialDataChart.png"]}</script>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><meta property="og:type" content="article" />
<meta property="og:title" content="Mimikatz and Active Directory Kerberos Attacks" />
<meta property="og:url" content="https://adsecurity.org/?p=556" />
<meta property="og:site_name" content="Active Directory Security" />
<meta property="og:description" content="NOTE: While this page will remain, the majority of the Mimikatz information in this page is now in the &quot;Unofficial Mimikatz Guide &amp; Command Reference&quot; which will be updated on a regular basis. Mimikatz is the latest, and one of the best, tool to gather credential data from Windows systems. In fact I consider Mimikatz ..." />
<meta property="og:updated_time" content="2015-12-29T15:07:34+00:00" />
<meta property="article:modified_time" content="2015-12-29T15:07:34+00:00" />
<meta property="article:published_time" content="2014-11-22T23:30:43+00:00" />
<meta property="og:image" content="https://adsecurity.org/wp-content/uploads/2014/11/Delpy-CredentialDataChart.png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="517" />
    </head>
    <body class="post-template-default single single-post postid-556 single-format-standard custom-background wp-embed-responsive layout-boxed two_col_left two-columns singular">
        
        <div class="container boxed-wrapper">
            
                            <div id="top-bar" class="row clearfix top-bar ">
                    
                                                    
                            <div class="col-md-12 top-bar-items">
                                
                                                                                                    	<ul class="social-profiles">
							
			            <li class="social-profile social-profile-rss">
			            	<a href="https://adsecurity.org/?feed=rss2" title="Subscribe to Tech, News, and Other Ideations&#039;s RSS feed" id="social-id-1" class="mysocial social-rss">
			            				                            <i class="fa fa-rss"></i>
		                        			            	</a>
			            </li>
		            
		    	    </ul>
                                    
                                                                    <button type="button" class="search-toggle navbar-toggle collapsed" data-toggle="collapse" data-target="#top_search">
                                        <span class="sr-only">Toggle search form</span>
                                        <i class="fa fa-search-plus"></i>
                                    </button>

                                    <div id="top_search" class="top-search-form">
                                        <form class="searchform" method="get" action="https://adsecurity.org">
	<div class="input-group">
		<div class="form-group live-search-input">
			<label for="s" class="screen-reader-text">Search for:</label>
		    <input type="text" id="s" name="s" class="form-control" placeholder="Search">
		    		</div>
	    <span class="input-group-btn">
	    	<button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button>
	    </span>
    </div>
    </form>                                                                            </div>
                                
                                                            </div>

                        
                                    </div>
            

            <div id="header" class="row">

                <img src="https://adsecurity.org/wp-content/themes/graphene/images/headers/fluid.jpg" alt="Active Directory Security" title="Active Directory Security" width="960" height="198" />                
                                                                </div>


                        <nav class="navbar row navbar-inverse">

                <div class="navbar-header align-center">
                		                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu-wrap, #secondary-menu-wrap">
	                        <span class="sr-only">Toggle navigation</span>
	                        <span class="icon-bar"></span>
	                        <span class="icon-bar"></span>
	                        <span class="icon-bar"></span>
	                    </button>
                	                    
                    
                                            <p class="header_title">
                            <a href="https://adsecurity.org" title="Go back to the front page">                                Active Directory Security                            </a>                        </p>
                    
                                                    <p class="header_desc">Active Directory &amp; Enterprise Security, Methods to Secure Active Directory, Attack Methods &amp; Effective Defenses, PowerShell, Tech Notes, &amp; Geek Trivia&#8230;</p>
                                            
                                    </div>

                                    <div class="collapse navbar-collapse" id="header-menu-wrap">

            			<ul class="nav navbar-nav flip"><li ><a href="https://adsecurity.org/">Home</a></li><li class="menu-item menu-item-8"><a href="https://adsecurity.org/?page_id=8" >About</a></li><li class="menu-item menu-item-41"><a href="https://adsecurity.org/?page_id=41" >AD Resources</a></li><li class="menu-item menu-item-4031"><a href="https://adsecurity.org/?page_id=4031" >Attack Defense &#038; Detection</a></li><li class="menu-item menu-item-293"><a href="https://adsecurity.org/?page_id=293" >Contact</a></li><li class="menu-item menu-item-1821"><a href="https://adsecurity.org/?page_id=1821" >Mimikatz</a></li><li class="menu-item menu-item-1352"><a href="https://adsecurity.org/?page_id=1352" >Presentations</a></li><li class="menu-item menu-item-195"><a href="https://adsecurity.org/?page_id=195" >Schema Versions</a></li><li class="menu-item menu-item-399"><a href="https://adsecurity.org/?page_id=399" >Security Resources</a></li><li class="menu-item menu-item-183"><a href="https://adsecurity.org/?page_id=183" >SPNs</a></li><li class="menu-item menu-item-2532"><a href="https://adsecurity.org/?page_id=2532" >Top Posts</a></li></ul>                        
            			                        
                                            </div>
                
                                    
                            </nav>

            
            <div id="content" class="clearfix hfeed row">
                
                    
                                        
                    <div id="content-main" class="clearfix content-main col-md-8">
                    
	
		<div class="post-nav post-nav-top clearfix">
			<p class="previous col-sm-6"><i class="fa fa-arrow-circle-left"></i> <a href="https://adsecurity.org/?p=574" rel="prev">MS14-068: Active Directory Kerberos Vulnerability Patch for Invalid Checksum</a></p>			<p class="next-post col-sm-6"><a href="https://adsecurity.org/?p=614" rel="next">Microsoft Consolidated Technology Conference: Microsoft Ignite</a> <i class="fa fa-arrow-circle-right"></i></p>					</div>
		        
<div id="post-556" class="clearfix post post-556 type-post status-publish format-standard hentry category-microsoft-security category-technical-reference tag-goldenticket tag-hackertool tag-invoke-mimikatz tag-kerberos tag-mimikatz tag-overpassthehash tag-passthecache tag-passthehash tag-passtheticket tag-silverticket tag-whatismimiatz tag-windows tag-windowshacking item-wrap">
		
	<div class="entry clearfix">
    	
                    	<div class="post-date date alpha with-year">
            <p class="default_date">
            	<span class="month">Nov</span>
                <span class="day">22</span>
                	                <span class="year">2014</span>
                            </p>
                    </div>
            
		        <h1 class="post-title entry-title">
			Mimikatz and Active Directory Kerberos Attacks			        </h1>
		
			    <ul class="post-meta entry-meta clearfix">
	    		        <li class="byline">
	        	By <span class="author"><a href="https://adsecurity.org/?author=2" rel="author">Sean Metcalf</a></span><span class="entry-cat"> in <span class="terms"><a class="term term-category term-11" href="https://adsecurity.org/?cat=11">Microsoft Security</a>, <a class="term term-category term-2" href="https://adsecurity.org/?cat=2">Technical Reference</a></span></span>	        </li>
	        	    </ul>
    
				
				<div class="entry-content clearfix">
							
										
						<h4><em><strong>NOTE:<br />
While this page will remain, the majority of the Mimikatz information in this page is now in the &#8220;<a href="https://adsecurity.org/?p=2207">Unofficial Mimikatz Guide &amp; Command Reference</a>&#8221; which will be updated on a regular basis.</strong></em></h4>
<p>Mimikatz is the latest, and one of the best, tool to gather credential data from Windows systems. In fact I consider Mimikatz to be the &#8220;swiss army knife&#8221; of Windows credentials &#8211; that one tool that can do everything. Since the author of Mimikatz, Benjamin Delpy, is French most of the resources describing Mimikatz usage is in French, at least on <a href="http://blog.gentilkiwi.com/">his blog</a>. The <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz GitHub repository</a> is in English and includes useful information on command usage.</p>
<p>Mimikatz is a Windows x32/x64 program coded in C by Benjamin Delpy (@gentilkiwi) in 2007 to learn more about Windows credentials (and as a Proof of Concept). There are two optional components that provide additional features, <em>mimidrv</em> (driver to interact with the Windows kernal) and <em>mimilib</em> (AppLocker bypass, Auth package/SSP, password filter, and sekurlsa for WinDBG). Mimikatz requires administrator or SYSTEM and often debug rights in order to perform certain actions and interact with the LSASS process (depending on the action requested).</p>
<p>After a user logs on, a variety of credentials are generated and stored in theÂ Local Security Authority Subsystem Service, <a href="http://en.wikipedia.org/wiki/Local_Security_Authority_Subsystem_Service">LSASS, </a>process in memory. This is meant to facilitate single sign-on (SSO) ensuring a user isn&#8217;t prompted each time resource access is requested. The credential data may include NTLM password hashes, LM password hashes (if the password is &lt;15 characters), and even clear-text passwords (to support WDigest and SSP authentication among others. While you can <a href="http://support.microsoft.com/kb/299656">prevent a Windows computer from creating the LM hash</a> in the local computer SAM database (and the AD database), though this doesn&#8217;t prevent the system from generating the LM hash in memory.</p>
<p>The majority of Mimikatz functionality is available in <a href="https://github.com/mattifestation/PowerSploit">PowerSploit </a>(PowerShell Post-Exploitation Framework) through the &#8220;<a href="https://github.com/mattifestation/PowerSploit/blob/master/Exfiltration/Invoke-Mimikatz.ps1">Invoke-Mimikatz</a>&#8221; PowerShell script which &#8220;leverages Mimikatz 2.0 and Invoke-ReflectivePEInjection to reflectively load Mimikatz completely in memory. This allows you to do things such as dump credentials without ever writing the mimikatz binary to disk.&#8221;Â  Mimikatz functionality supported by Invoke-Mimikatz is noted below.<br />
<span id="more-556"></span></p>
<p>Benjamin Delpy posted an<a href="https://onedrive.live.com/view.aspx?resid=A352EBC5934F0254!2074&amp;cid=a352ebc5934f0254&amp;app=Excel"> Excel chart on OneDrive</a> (shown below) that shows what type of credential data is available in memory (LSASS), including on Windows 8.1 and Windows 2012 R2 which have enhanced protection mechanisms reducing the amount and type of credentials kept in memory.<br />
<a href="https://adsecurity.org/wp-content/uploads/2014/11/Delpy-CredentialDataChart.png"><img loading="lazy" class="alignnone wp-image-583" src="https://adsecurity.org/wp-content/uploads/2014/11/Delpy-CredentialDataChart-300x129.png" alt="Delpy-CredentialDataChart" width="339" height="146" srcset="https://adsecurity.org/wp-content/uploads/2014/11/Delpy-CredentialDataChart-300x129.png 300w, https://adsecurity.org/wp-content/uploads/2014/11/Delpy-CredentialDataChart-1024x441.png 1024w, https://adsecurity.org/wp-content/uploads/2014/11/Delpy-CredentialDataChart.png 1610w" sizes="(max-width: 339px) 100vw, 339px" /></a><br />
<em>(Click image to embiggen)</em></p>
<p>One of the biggest security concerns with Windows today is &#8220;Pass the Hash.&#8221; Simply stated, Windows performs a one-way hash function on the user&#8217;s password and the result is referred to as a &#8220;hash.&#8221; The one-way hash algorithm changes the password in expected ways given the input data (the password) with the result being scrambled data that can&#8217;t be reverted back to the original input data, the password. Hashing a password into a hash is like putting a steak through a meat grinder to make ground beef &#8211; the ground beef can never be put together to be the same steak again. Pass the Hash has many variants, from Pass the Ticket to OverPass the Hash (aka pass the key).</p>
<p>The following quote is a <a href="https://translate.google.com/translate?sl=fr&amp;tl=en&amp;js=y&amp;prev=_t&amp;hl=en&amp;ie=UTF-8&amp;u=http%3A%2F%2Fblog.gentilkiwi.com%2F&amp;edit-text=">Google Translate English translated</a> version of the <a href="http://blog.gentilkiwi.com/">Mimikatz website</a> (which is in French).</p>
<blockquote><p><span class="notranslate">Contrary to what could easily be imagined, <strong>Windows does not use the password of the user as a shared secret,</strong> but non-reversible derivatives: LM hash, NTLM, DES keys, AES &#8230;</span><span class="notranslate"> According to the protocol, the secret and the algorithms used are different:</span></p>
<p>&nbsp;</p>
<table>
<tbody>
<tr>
<th><span class="notranslate"> Protocol</span></th>
<th><span class="notranslate"> Algorithm</span></th>
<th><span class="notranslate"> Secret used</span></th>
</tr>
<tr>
<td><span class="notranslate"> LM</span></td>
<td><span class="notranslate"> DES-ECB</span></td>
<td><span class="notranslate"> LM Hash</span></td>
</tr>
<tr>
<td><span class="notranslate"> NTLMv1</span></td>
<td><span class="notranslate"> DES-ECB</span></td>
<td><span class="notranslate"> NT Hash</span></td>
</tr>
<tr>
<td><span class="notranslate"> NTLMv2</span></td>
<td><span class="notranslate"> HMAC-MD5</span></td>
<td><span class="notranslate"> NT Hash</span></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p></blockquote>
<p><strong><span style="text-decoration: underline;"><br />
Mimikatz OS support:</span></strong></p>
<ul>
<li>Windows XP</li>
<li>Windows Vista</li>
<li>Windows 7</li>
<li>Windows 8</li>
<li>Windows Server 2003</li>
<li>Windows Server 2008 / 2008 R2</li>
<li>Windows Server 2012 / 2012 R2</li>
<li>Windows 10</li>
</ul>
<p>&nbsp;</p>
<blockquote><p>Since Windows encrypts most credentials in memory (LSASS), they should be protected, but it is a type of reversible encryption (though creds are in clear-text). Encrypt works with LsaProtectMemory and decrypt with LsaUnprotectMemory.</p>
<p>NT5 encryption types: RC4 &amp; DESx</p>
<p>NT6 encryption types: 3DES &amp; AES</p></blockquote>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>Mimikatz capabilities:</strong></span></p>
<ul>
<li><strong>Dump credentials from LSASS</strong> (Windows Local Security Account database) [sekurlsa module]
<ul>
<li>MSV1.0: hashes &amp; keys (dpapi)</li>
<li>Kerberos password, ekeys, tickets, &amp; PIN</li>
<li>TsPkg (password)</li>
<li>WDigest (clear-text password)</li>
<li>LiveSSP (clear-text password)</li>
<li>SSP (clear-text password)</li>
</ul>
</li>
<li>Generate Kerberos Golden Tickets (Kerberos TGT logon token ticket attack)</li>
<li>Generate Kerberos Silver Tickets (Kerberos TGS service ticket attack)</li>
<li><strong>Export certificates and keys</strong> (even those not normally exportable).</li>
<li>Dump cached credentials</li>
<li>Stop event monitoring.</li>
<li>Bypass Microsoft AppLocker / Software Restriction Polcies</li>
<li>Patch Terminal Server</li>
<li>Basic GPO bypass</li>
</ul>
<p><em>Items in <strong>bold</strong> denotes functionality provided by the PowerSploit Invoke-Mimikatz module with built-in parameters. Other mimikatz commands may work using the command parameter.<br />
</em></p>
<p><span style="text-decoration: underline;"><strong>Mimikatz Command Overview:</strong></span></p>
<p>The primary command components are sekurlsa, kerberos, crypto, vault, and lsadump.<br />
Sekurlsa interacts with the LSASS process in memory to gather credential data and provides enhanced capability over kerberos.</p>
<p>The <a href="https://github.com/gentilkiwi/mimikatz/wiki/module-~-kerberos#ptt">Mimikatz kerberos command set</a> enables modification of Kerberos tickets and interacts with the official Microsoft Kerberos API. This is the command that creates Golden Tickets. Pass the ticket is also possible with this command since it can inject Kerberos ticket(s) (TGT or TGS)Â  into the current session. External Kerberos tools may be used for session injection, but they must follow the Kerberos credential format (KRB_CRED).<br />
Mimikatz kerberos also enables the creation of Silver Tickets which are Kerberos tickets (TGT or TGS) with arbitrary data enabling AD user/ group impersonation.</p>
<p>The key required for ticket creation depends on the type of ticket being generated:</p>
<ul>
<li>Golden tickets require the KRBTGT account NTLM password hash.</li>
<li>Silver tickets require the computer or service account&#8217;s NTLM password hash.</li>
</ul>
<p>Crypto enables export of certificates on the system that are not marked exportable since it bypasses the standard export process.</p>
<p>Vault enables dumping data from the Windows vault.</p>
<p>Lsadump enables dumping credential data from the Security Account Manager (SAM) database which contains the NTLM (sometimes LM hash) and supports online and offline mode as well as dumping credential data from the LSASS process in memory. Lsadump can also be used to dump cached credentials. In a Windows domain, credentials are cached (up to 10) in case a Domain Controller is unavailable for authentication. However, these credentials are stored on the computer.</p>
<blockquote><p><span class="notranslate">These caches are located in the registry at the location <code>HKEY_LOCAL_MACHINE\SECURITY\Cache</code> (accessible SYSTEM).</span><br />
<span class="notranslate"> These entries are encrypted symmetrically, but we find some information about the user, as well as sufficient to verify the hash authentication.</span></p></blockquote>
<p>Further down is a more detailed list of mimikatz command functionality.</p>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>Common Kerberos Attacks:</strong></span></p>
<ul>
<li><strong>Pass The Hash</strong>
<ul>
<li>On Windows, a user provides the userid and password and the password is hashed, creating the password hash. When the user on one Windows system wants to access another, the user&#8217;s password hash is sent (passed) to the destination&#8217;s resource to authenticate. This means there is no need to crack the user&#8217;s password since the user&#8217;s password hash is all that&#8217;s needed to gain access.</li>
</ul>
</li>
</ul>
<blockquote><p><span class="notranslate">Contrary to what could easily be imagined, <strong>Windows does not use the password of the user as a shared secret,</strong> but non-reversible derivatives: LM hash, NTLM, DES keys, AES &#8230;</span></p></blockquote>
<p>&nbsp;</p>
<ul>
<li><strong><a href="http://blog.gentilkiwi.com/securite/mimikatz/pass-the-ticket-kerberos">Pass the Ticket</a>Â  (<a href="http://translate.google.com/translate?hl=en&amp;sl=fr&amp;u=http://blog.gentilkiwi.com/securite/mimikatz/pass-the-ticket-kerberos&amp;prev=search">Google Translation</a>)<br />
</strong></p>
<ul>
<li>Extract an existing, valid Kerberos ticket from one machine and pass it to another one to gain access to resoiurces as that user.</li>
</ul>
</li>
</ul>
<p>&nbsp;</p>
<ul>
<li><strong><a href="http://blog.gentilkiwi.com/securite/mimikatz/overpass-the-hash">Over-Pass The Hash</a> (aka Pass the Key)Â  (<a href="http://translate.google.com/translate?hl=en&amp;sl=fr&amp;u=http://blog.gentilkiwi.com/securite/mimikatz/overpass-the-hash&amp;prev=search">Google Translation</a>)</strong>
<ul>
<li>Use the NTLM hash to obtain a valid user Kerberos ticket request.</li>
<li>The user key (NTLM hash when using RC4) is used to encrypt the Pre-Authentication &amp; first data requests.</li>
<li>The followingÂ  quote is a <a href="https://translate.google.com/translate?sl=fr&amp;tl=en&amp;js=y&amp;prev=_t&amp;hl=en&amp;ie=UTF-8&amp;u=http%3A%2F%2Fblog.gentilkiwi.com%2F&amp;edit-text=">Google Translate English translated</a> version of the <a href="http://blog.gentilkiwi.com/">Mimikatz website</a> (which is in French):</li>
</ul>
</li>
</ul>
<blockquote><p><span class="notranslate"> Authentication via Kerberos is a tad different.</span> <span class="notranslate"> The client encrypts a <code>timestamp</code> from its user secret, possibly with parameters realm and iteration number sent from the server.</span><br />
<span class="notranslate"> If the secret is correct, the server can decrypt the <code>timestamp</code> (and the passage verify that the clocks are not too time-shifted).</span></p>
<table>
<tbody>
<tr>
<th><span class="notranslate"> Protocol</span></th>
<th><span class="notranslate"> Secret (key) used</span></th>
</tr>
<tr>
<td rowspan="4"><span class="notranslate"> Kerberos</span></td>
<td><span class="notranslate"> OF</span></td>
</tr>
<tr>
<td><span class="notranslate"> RC4 = <strong>NT Hash!</strong></span></td>
</tr>
<tr>
<td><span class="notranslate"> AES128</span></td>
</tr>
<tr>
<td><span class="notranslate"> AES256</span></td>
</tr>
</tbody>
</table>
<p><span class="notranslate"> Yes, the RC4 key type available and enabled by default in XP 8.1 is our <strong>NT hash!</strong></span></p></blockquote>
<p>&nbsp;</p>
<ul>
<li><a href="http://blog.gentilkiwi.com/securite/mimikatz/golden-ticket-kerberos"><strong>Kerberos Golden TicketÂ  (</strong></a><a href="https://translate.google.com/translate?sl=fr&amp;tl=en&amp;js=y&amp;prev=_t&amp;hl=en&amp;ie=UTF-8&amp;u=http%3A%2F%2Fblog.gentilkiwi.com%2Fsecurite%2Fmimikatz%2Fgolden-ticket-kerberos&amp;edit-text="><strong>Google Translation</strong></a><a href="http://blog.gentilkiwi.com/securite/mimikatz/golden-ticket-kerberos"><strong>)</strong></a>
<ul>
<li>The <strong>Kerberos Golden Ticket</strong> is a valid TGT Kerberos ticket since it is encrypted/signed by the <a href="https://adsecurity.org/?p=483">domain Kerberos account (KRBTGT)</a>. The TGT is only used to prove to the KDC service on the Domain Controller that the user was authenticated by another Domain Controller. The fact that the TGT is encrypted by the KRBTGT password hash and can be decrypted by any KDC service in the domain proves it is valid.</li>
<li><span style="text-decoration: underline;">Golden Ticket Requirements:</span><br />
* <strong>Domain Name</strong> [AD PowerShell module: (Get-ADDomain).DNSRoot]<br />
* <strong>Domain SID</strong>Â  [AD PowerShell module: (Get-ADDomain).DomainSID.Value]<br />
* <strong>Domain KRBTGT Account NTLM password hash</strong><br />
* <strong>UserID for impersonation</strong>.</li>
<li>The Domain Controller KDC service doesn&#8217;t perform validate the user account until the <a href="http://passing-the-hash.blogspot.com/2014/09/pac-validation-20-minute-rule-and.html">TGT is older than 20 minutes old, </a>which means the attacker can use a disabled/deleted user account or even a fictional user that doesn&#8217;t exist in AD!
<div><em>Microsoft&#8217;s MS-KILE specification (section 5.1.3 ):</em></div>
<div></div>
<div><i>&#8220;Kerberos V5 does not provide account revocation checking for TGS requests, which allows TGT renewals and service tickets to be issued as long as the TGT is valid even if the account has been revoked. KILE provides a check account policy (section 3.3.5.7.1) that limits the exposure to a shorter time. KILE KDCs in the account domain are required to check accounts when the TGT is older than 20 minutes. This limits the period that a client can get a ticket with a revoked account while limiting the performance cost for AD queries.&#8221;</i></div>
</li>
<li>Since the domain Kerberos policy is set on the ticket when generated by the KDC service on the Domain Controller, when the ticket is provided, systems trust the ticket validity. This means that even if the domain policy states a Kerberos logon ticket (TGT) is only valid for 10 hours, if the ticket states it is valid for 10 <em>years</em>, it is accepted as such.</li>
<li>The <a href="https://adsecurity.org/?p=483">KRBTGT</a> account password<a href="https://adsecurity.org/?p=483"> is never changed*</a> and the attacker can create Golden Tickets until the KRBTGT password is changed (twice). Note that a Golden Ticket created to impersonate a user persists even if the impersonated user changes their password.</li>
<li>This crafted TGT requires an attacker to have the Active Directory domainâ€™s KRBTGT password hash (<a href="https://adsecurity.org/?p=451">typically dumped from a Domain Controller</a>).</li>
<li>The KRBTGT NTLM hash can be used to generate a valid TGT (using RC4) to impersonate any user with access to any resource in Active Directory.</li>
<li>The Golden Ticket (TGT) be generated and used on any machine, even one not domain-joined. The created TGT can be used without requiring Debug rights.</li>
<li><strong>Mitigation</strong>: Limit Domain Admins from logging on to any other computers other than Domain Controllers and a handful of Admin servers (don&#8217;t let other admins log on to these servers) Delegate all other rights to custom admin groups. This greatly reduces the ability of an attacker to gain access to a Domain Controller&#8217;s Active Directory database. If the attacker can&#8217;t access the AD database (ntds.dit file), they can&#8217;t get the KRBTGT account NTLM password hash. Configuring Active Directory Kerberos to only allow AES may prevent Golden Tickets from being created. Another mitigation option is <a href="https://adsecurity.org/?p=559">Microsoft KB2871997 which back-ports some of the enhanced security in Windows 8.1 and Windows 2012 R2</a>.</li>
</ul>
</li>
</ul>
<p>&nbsp;</p>
<ul>
<li><strong>Kerberos Silver Ticket</strong>
<ul>
<li>The <strong>Kerberos Silver Ticket</strong> is a valid Ticket Granting Service (TGS) Kerberos ticket since it is encrypted/signed by the service account configured with a <a href="https://adsecurity.org/?p=230">Service Principal Name</a> for each server the Kerberos-authenticating service runs on.</li>
<li>While a Golden ticket is encrypted/signed with the <a href="https://adsecurity.org/?p=483">KRBTGT</a>, a Silver Ticket is encrypted/signed by the service account (computer account credential extracted from the computer&#8217;s local SAM or service account credential).</li>
<li>Most services don&#8217;t validate the PAC (by sending the PAC checksum to the Domain Controller for PAC validation), so a valid TGS generated with the service account password hash can include a PAC that is entirely fictitious &#8211; even claiming the user is a Domain Admin without challenge or correction.</li>
</ul>
</li>
</ul>
<blockquote><p>Since service tickets are identical in format to TGTs albeit with a different service name, all you need to do is specify a different service name and use the RC4 (NTLM hash) of the account password (either the computer account for default services or the actual account) and you can now issue service tickets for the requested service. Â Note: Â You can also use the AES keys if you happen to have them instead of the NTLM key and it will still work ðŸ˜‰</p>
<div></div>
<div>It is worth noting, that services like MSSQL, Sharepoint, etc will only allow you to play with those services. Â The computer account will allow access to CIFS, service creation, and a whole host of other activities on the targeted computer. Â You can leverage the computer account into a shell with PSEXEC and you will be running as system on that particular computer. Â Lateral movement is then a matter of doing whatever you need to do from there ðŸ™‚</div>
<div><a href="http://passing-the-hash.blogspot.com/2014/09/pac-validation-20-minute-rule-and.html%20">http://passing-the-hash.blogspot.com/2014/09/pac-validation-20-minute-rule-and.html </a></div>
</blockquote>
<p>&nbsp;</p>
<ul>
<li><strong>Service Account Password Cracking by attacking the Kerberos Session Ticket (TGS)<br />
</strong></p>
<ul>
<li>NOTE: This attack does NOT require hacking tools on the network since it can be performed offline.</li>
<li>The Kerberos session ticket (TGS) has a component that is encrypted with the service&#8217;s (either computer account or service account) password hash. The TGS for the service is generated and delivered to the user after the user&#8217;s TGT is presented to the KDC service on the Domain Controller.</li>
<li>Since the service account&#8217;s password hash is used to encrypt the server component, it is possible to request the service TGS and perform an offline password attack.</li>
<li>Only normal Kerberos traffic is observed on the wire: the TGT is delivered to the Domain Controller along with a TGS request and response. At this point, no further network traffic is required.</li>
<li>Service accounts typically have weak passwords and are rarely changed making these excellent targets. <a href="https://adsecurity.org/?p=280">Computer account passwords </a>are changed about every 30 days and are extremely complex making them virtually uncrackable.</li>
<li>Finding interesting service accounts is as simple as <a href="https://adsecurity.org/?p=230">sending a Service Principal Name query to the Global Catalog</a>.</li>
<li>Service accounts often have elevated rights in Active Directory and since only a Kerberos service ticket (TGS) is required to attack the service account&#8217;s password, getting a TGS and saving it to another system to crack the password means this is a difficult attack to stop.</li>
<li><strong>Mitigation</strong>: Ensure all service accounts have long (&gt;25 characters), complex passwords and only have the exact rights required (ensure the <a href="http://en.wikipedia.org/wiki/Principle_of_least_privilege">principle of least privilege</a>).</li>
<li>Tim Medin (<a class="twitter-atreply pretty-link" href="https://twitter.com/timmedin"><s>@</s>timmedin</a>) describes this attack at his &#8220;<a href="http://www.irongeek.com/i.php?page=videos/derbycon4/t120-attacking-microsoft-kerberos-kicking-the-guard-dog-of-hades-tim-medin">Attacking Microsoft Kerberos: Kicking the Guard Dog of Hades</a>&#8221; presentation at DerbyCon 2014. [Slides:Â <a href="https://www.dropbox.com/s/1j6v6zbtsdg1kam/Kerberoast.pdf?dl=0">https://www.dropbox.com/s/1j6v6zbtsdg1kam/Kerberoast.pdf?dl=0</a> ]</li>
<li>In his DerbyCon2014 presentation, Tim Medin provided PowerShell code examples for requesting a TGS. I have modified it slightly to add the $SPN variable.</li>
</ul>
</li>
</ul>
<blockquote><p>$SPN = &#8220;HTTP/sharepoint.adsecurity.org&#8221;<br />
Add-Type -AssemblyNAme System.IdentityModel<br />
New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList &#8220;$SPN&#8221;</p></blockquote>
<p>&nbsp;</p>
<ul>
<li><strong>Pass the Cache</strong> (*nix systems)
<ul>
<li>Linux/Unix systems (Mac OSX) store Kerberos credentials in a cache file. As of 11/23/2014, Mimikatz supports extracting the credential data for passing to Active Directory in a similar manner to the Pass the Hash/ Pass the Ticket method.</li>
</ul>
</li>
</ul>
<p><a href="https://adsecurity.org/wp-content/uploads/2014/11/Mimikatz-PassTheCache.png"><img loading="lazy" class="size-medium wp-image-589 aligncenter" src="https://adsecurity.org/wp-content/uploads/2014/11/Mimikatz-PassTheCache-292x300.png" alt="Mimikatz-PassTheCache" width="292" height="300" srcset="https://adsecurity.org/wp-content/uploads/2014/11/Mimikatz-PassTheCache-292x300.png 292w, https://adsecurity.org/wp-content/uploads/2014/11/Mimikatz-PassTheCache.png 763w" sizes="(max-width: 292px) 100vw, 292px" /></a></p>
<p><span style="text-decoration: underline;"><strong>Mimikatz Commands:</strong></span></p>
<ul>
<li><a href="https://github.com/gentilkiwi/mimikatz/wiki/module-~-sekurlsa#logonpasswords">logonpasswords</a>: <code>mimikatz # sekurlsa::logonpasswords</code>)
<ul>
<li>Extracts passwords in memory</li>
</ul>
</li>
<li><a href="https://github.com/gentilkiwi/mimikatz/wiki/module-~-sekurlsa#pth">pth</a> (pass the hash):
<pre><code>mimikatz # sekurlsa::pth /user:Administrateur /domain:chocolate.local /ntlm:cc36cf7a8514893efccd332446158b1a</code></pre>
<ul>
<li>A fake identity is created and the faske identitt&#8217;s NTLM hash is replaced with the real one.</li>
<li>&#8220;ntlm hash is mandatory on XP/2003/Vista/2008 and before 7/2008r2/8/2012 kb2871997 (AES not available or replaceable)&#8221;</li>
<li>&#8220;AES keys can be replaced only on 8.1/2012r2 or 7/2008r2/8/2012 with kb2871997, in this case you can avoid ntlm hash.&#8221;</li>
</ul>
</li>
<li>ptt (pass the ticket):
<pre><code>mimikatz # kerberos::ptt</code></pre>
<ul>
<li>Enables Kerberos ticket (TGT or TGS) injection into the current session.</li>
</ul>
</li>
<li>tickets:Â  <code>mimikatz # sekurlsa::tickets /export</code>
<ul>
<li>Identifies all session Kerberos tickets and lists/exports them.</li>
<li>sekurlsa pulls the Kerberos data from memory and can access all user session tickets on the computer.</li>
</ul>
</li>
<li>ekeys:Â  <code>mimikatz # sekurlsa::ekeys</code>
<ul>
<li>Extract the Kerberos ekeys from memory. Provides theft of a user account until the password is changed (which may be never for a Smartcard/PKI user).</li>
</ul>
</li>
<li>dpapi:Â  <code>mimikatz # sekurlsa::dpapi</code></li>
<li>minidump:
<pre><code>mimikatz # sekurlsa::minidump lsass.dmp</code></pre>
<ul>
<li>Perform a minidump of the LSASS process and extract credential data from the lsass.dmp. A minidump can be saved off the computer for credential extraction later, but the major version of Windows must match (you can&#8217;t open the dump file from Windows 2012 on a Windows 2008 system).</li>
</ul>
</li>
<li>kerberos:
<pre><code>mimikatz # sekurlsa::kerberos</code></pre>
<ul>
<li>
<pre>Â Extracts the smartcad/PIV PIN from memory (cached in LSASS when using a smartcard).</pre>
</li>
</ul>
</li>
<li><a href="https://github.com/gentilkiwi/mimikatz/wiki/module-~-privilege">debug:</a>
<pre class="brush: plain; highlight: [4,16,17,18,19,20,21,22]; title: ; notranslate" title="">mimikatz # privilege::debug</pre>
<ul>
<li>Sets debug mode for current mimikatz session enabling LSASS access.</li>
</ul>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;hl=en&amp;ie=UTF8&amp;prev=_t&amp;rurl=translate.google.com&amp;sl=fr&amp;tl=en&amp;u=http://blog.gentilkiwi.com/securite/mscache-v2-dcc2-iteration&amp;usg=ALkJrhjpLNpxdAk-QbYsP-iApIcsLGHdWA">lsadump cache</a>: (requires token::elevate to be SYSTEM)
<pre class="brush: plain; highlight: [14]; title: ; notranslate" title="">mimikatz # lsadump::cache</pre>
<ul>
<li>Dumps cached Windows domain credentials from HKEY_LOCAL_MACHINE\SECURITY\Cache (accessible SYSTEM).</li>
</ul>
</li>
</ul>
<p>&nbsp;</p>
<p><span style="text-decoration: underline;"><strong>References:</strong></span></p>
<ul>
<li><a href="http://blog.gentilkiwi.com/">Benjamin Delpy&#8217;s blog</a> (<a href="https://translate.google.com/translate?sl=fr&amp;tl=en&amp;js=y&amp;prev=_t&amp;hl=en&amp;ie=UTF-8&amp;u=http%3A%2F%2Fblog.gentilkiwi.com%2F&amp;edit-text=">Google Translate English translated</a> version)</li>
<li><a href="https://github.com/gentilkiwi/mimikatz">Mimikatz GitHub repository</a></li>
<li><a href="https://github.com/gentilkiwi/mimikatz/wiki">Mimikatz Github wiki</a></li>
<li><a href="http://blog.gentilkiwi.com/downloads/mimikatz-rmll.pdf">Mimikatz 2 Presentation Slides</a> (Benjamin Delpy, July 2014)</li>
<li><a href="http://blog.gentilkiwi.com/presentations">All Mimikatz Presentation resources on blog.gentilkiwi.com</a></li>
<li><a href="https://onedrive.live.com/view.aspx?resid=A352EBC5934F0254!2074&amp;cid=a352ebc5934f0254&amp;app=Excel"> Excel chart on OneDrive</a> that shows what type of credential data is available in memory (LSASS), including on Windows 8.1 and Windows 2012 R2 which have enhanced protection mechanisms.</li>
<li><a href="http://passing-the-hash.blogspot.com/2014/09/pac-validation-20-minute-rule-and.html">PAC Validation issue aka the Silver Ticket description from the Passing the Hash Blog</a></li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="tptn_counter" id="tptn_counter_556">(Visited 64,748 times, 15 visits today)</div>								</div>
		
			    <ul class="entry-footer">
	    		        <li class="post-tags col-sm-8"><i class="fa fa-tags" title="Tags"></i> <span class="terms"><a class="term term-tagpost_tag term-303" href="https://adsecurity.org/?tag=goldenticket">GoldenTicket</a>, <a class="term term-tagpost_tag term-301" href="https://adsecurity.org/?tag=hackertool">hackertool</a>, <a class="term term-tagpost_tag term-336" href="https://adsecurity.org/?tag=invoke-mimikatz">Invoke-Mimikatz</a>, <a class="term term-tagpost_tag term-81" href="https://adsecurity.org/?tag=kerberos">Kerberos</a>, <a class="term term-tagpost_tag term-207" href="https://adsecurity.org/?tag=mimikatz">mimikatz</a>, <a class="term term-tagpost_tag term-317" href="https://adsecurity.org/?tag=overpassthehash">OverPassTheHash</a>, <a class="term term-tagpost_tag term-318" href="https://adsecurity.org/?tag=passthecache">PassTheCache</a>, <a class="term term-tagpost_tag term-44" href="https://adsecurity.org/?tag=passthehash">PassTheHash</a>, <a class="term term-tagpost_tag term-316" href="https://adsecurity.org/?tag=passtheticket">PassTheTicket</a>, <a class="term term-tagpost_tag term-304" href="https://adsecurity.org/?tag=silverticket">SilverTicket</a>, <a class="term term-tagpost_tag term-300" href="https://adsecurity.org/?tag=whatismimiatz">whatismimiatz</a>, <a class="term term-tagpost_tag term-148" href="https://adsecurity.org/?tag=windows">Windows</a>, <a class="term term-tagpost_tag term-302" href="https://adsecurity.org/?tag=windowshacking">WindowsHacking</a></span></li>
	        	        <li class="addthis col-sm-8"><div class="add-this"></div></li>
	        	    </ul>
    	</div>

</div>

    <div class="entry-author">
        <div class="row">
            <div class="author-avatar col-sm-3">
            	<a href="https://adsecurity.org/?author=2" rel="author">
					<img alt='' src='https://secure.gravatar.com/avatar/1f3ad5e878e5d0e6096c5a33718a04d0?s=200&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1f3ad5e878e5d0e6096c5a33718a04d0?s=400&#038;d=mm&#038;r=g 2x' class='avatar avatar-200 photo' height='200' width='200' loading='lazy'/>                </a>
            </div>

            <div class="author-bio col-sm-9">
                <h3 class="section-title-sm">Sean Metcalf</h3>
                <p>I improve security for enterprises around the world working for TrimarcSecurity.com<br />
Read the About page (top left) for information about me. :)<br />
https://adsecurity.org/?page_id=8</p>
    <ul class="author-social">
    	        
			        <li><a href="mailto:sean@adsecurity.org"><i class="fa fa-envelope-o"></i></a></li>
            </ul>
                </div>
        </div>
    </div>
    









<div id="comments" class="clearfix no-ping">
        	<h4 class="comments current">
            <i class="fa fa-comments-o"></i> 1 comment        </h4>
	        
    
	
	    <div class="comments-list-wrapper">
        <ol class="clearfix comments-list" id="comments_list">
            		<li id="comment-8404" class="comment even thread-even depth-1 comment">
			<div class="row">
								
											
				<div class="comment-wrap col-md-12">
					
                        <ul class="comment-meta">
                <li class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/b12c2acefadc0263c14f2311ffc0bf5c?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b12c2acefadc0263c14f2311ffc0bf5c?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></li>
                <li class="comment-attr"><span class="comment-author">Paul</span> on <span class="comment-date">November 24, 2014 <span class="time">at 5:03 pm</span></span></li>
                <li class="single-comment-link"><a href="https://adsecurity.org/?p=556#comment-8404">#</a></li>
            </ul>
    
					<div class="comment-entry">
												
													<p>Great post that summarises the weaknesses in Kerberos and how pen testers as well as attackers can compromise AD either directly or using Mimikatz. Would like to hear how people are attempting to mitigate the risk as much as possible and detect compromise</p>
												
											</div>
				</div>
			
							</div>
	</li><!-- #comment-## -->
        </ol>
       	
            </div>
        
        
    </div>


	<div id="respond">
		<h3 id="reply-title"><i class="fa fa-comment-o"></i> Comments have been disabled.</h3>
            </div>



            
  

                </div><!-- #content-main -->
        
            
<div id="sidebar1" class="sidebar sidebar-right widget-area col-md-4">

	
    
		<div id="recent-posts-4" class="sidebar-wrap widget_recent_entries">
		<h3>Recent Posts</h3>
		<ul>
											<li>
					<a href="https://adsecurity.org/?p=4367">Attacking Active Directory Group Managed Service Accounts (GMSAs)</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4277">From Azure AD to Active Directory (via Azure) &#8211; An Unanticipated Attack Path</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4211">What is Azure Active Directory?</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4179">Slides Posted for Black Hat USA 2019 Talk: Attacking &#038; Defending the Microsoft Cloud</a>
									</li>
											<li>
					<a href="https://adsecurity.org/?p=4187">AD Reading: Windows Server 2019 Active Directory Features</a>
									</li>
					</ul>

		</div><div id="text-3" class="sidebar-wrap widget_text"><h3>Trimarc Active Directory Security Services</h3>			<div class="textwidget">Have concerns about your Active Directory environment?

Trimarc helps enterprises improve their security posture. <p>
<a href="http://trimarcsecurity.com/security-services">Find out how...</a> 
TrimarcSecurity.com</div>
		</div><div id="widget_tptn_pop-4" class="sidebar-wrap tptn_posts_list_widget"><h3>Popular Posts</h3><div class="tptn_posts  tptn_posts_widget tptn_posts_widget4"><ul><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2362"     class="tptn_link"><span class="tptn_title">Attack Methods for Gaining Domain Admin Rights in&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=478"     class="tptn_link"><span class="tptn_title">PowerShell Encoding &#038; Decoding (Base64)</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=483"     class="tptn_link"><span class="tptn_title">Kerberos &#038; KRBTGT: Active Directory&#8217;s&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=3377"     class="tptn_link"><span class="tptn_title">Securing Domain Controllers to Improve Active&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2288"     class="tptn_link"><span class="tptn_title">Finding Passwords in SYSVOL &#038; Exploiting Group&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=3299"     class="tptn_link"><span class="tptn_title">Securing Windows Workstations: Developing a Secure Baseline</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1684"     class="tptn_link"><span class="tptn_title">The Most Common Active Directory Security Issues and&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=2653"     class="tptn_link"><span class="tptn_title">Building an Effective Active Directory Lab&hellip;</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1729"     class="tptn_link"><span class="tptn_title">Mimikatz DCSync Usage, Exploitation, and Detection</span></a></span></li><li><span class="tptn_after_thumb"><a href="https://adsecurity.org/?p=1790"     class="tptn_link"><span class="tptn_title">Microsoft Local Administrator Password Solution (LAPS)</span></a></span></li></ul><div class="tptn_clear"></div></div></div><div id="categories-4" class="sidebar-wrap widget_categories"><h3>Categories</h3>
			<ul>
					<li class="cat-item cat-item-565"><a href="https://adsecurity.org/?cat=565">ActiveDirectorySecurity</a>
</li>
	<li class="cat-item cat-item-55"><a href="https://adsecurity.org/?cat=55">Apple Security</a>
</li>
	<li class="cat-item cat-item-431"><a href="https://adsecurity.org/?cat=431">Cloud Security</a>
</li>
	<li class="cat-item cat-item-17"><a href="https://adsecurity.org/?cat=17">Continuing Education</a>
</li>
	<li class="cat-item cat-item-396"><a href="https://adsecurity.org/?cat=396">Entertainment</a>
</li>
	<li class="cat-item cat-item-347"><a href="https://adsecurity.org/?cat=347">Exploit</a>
</li>
	<li class="cat-item cat-item-1039"><a href="https://adsecurity.org/?cat=1039">Hacking</a>
</li>
	<li class="cat-item cat-item-168"><a href="https://adsecurity.org/?cat=168">Hardware Security</a>
</li>
	<li class="cat-item cat-item-172"><a href="https://adsecurity.org/?cat=172">Hypervisor Security</a>
</li>
	<li class="cat-item cat-item-126"><a href="https://adsecurity.org/?cat=126">Linux/Unix Security</a>
</li>
	<li class="cat-item cat-item-343"><a href="https://adsecurity.org/?cat=343">Malware</a>
</li>
	<li class="cat-item cat-item-11"><a href="https://adsecurity.org/?cat=11">Microsoft Security</a>
</li>
	<li class="cat-item cat-item-819"><a href="https://adsecurity.org/?cat=819">Mitigation</a>
</li>
	<li class="cat-item cat-item-48"><a href="https://adsecurity.org/?cat=48">Network/System Security</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://adsecurity.org/?cat=7">PowerShell</a>
</li>
	<li class="cat-item cat-item-698"><a href="https://adsecurity.org/?cat=698">RealWorld</a>
</li>
	<li class="cat-item cat-item-21"><a href="https://adsecurity.org/?cat=21">Security</a>
</li>
	<li class="cat-item cat-item-234"><a href="https://adsecurity.org/?cat=234">Security Conference Presentation/Video</a>
</li>
	<li class="cat-item cat-item-1045"><a href="https://adsecurity.org/?cat=1045">Security Recommendation</a>
</li>
	<li class="cat-item cat-item-24"><a href="https://adsecurity.org/?cat=24">Technical Article</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://adsecurity.org/?cat=4">Technical Reading</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://adsecurity.org/?cat=2">Technical Reference</a>
</li>
	<li class="cat-item cat-item-156"><a href="https://adsecurity.org/?cat=156">TheCloud</a>
</li>
	<li class="cat-item cat-item-930"><a href="https://adsecurity.org/?cat=930">Vulnerability</a>
</li>
			</ul>

			</div><div id="tag_cloud-3" class="sidebar-wrap widget_tag_cloud"><h3>Tags</h3><div class="tagcloud"><a href="https://adsecurity.org/?tag=activedirectory" class="tag-cloud-link tag-link-20 tag-link-position-1" style="font-size: 22pt;" aria-label="ActiveDirectory (52 items)">ActiveDirectory</a>
<a href="https://adsecurity.org/?tag=active-directory" class="tag-cloud-link tag-link-75 tag-link-position-2" style="font-size: 10.531914893617pt;" aria-label="Active Directory (8 items)">Active Directory</a>
<a href="https://adsecurity.org/?tag=activedirectoryattack" class="tag-cloud-link tag-link-537 tag-link-position-3" style="font-size: 8pt;" aria-label="ActiveDirectoryAttack (5 items)">ActiveDirectoryAttack</a>
<a href="https://adsecurity.org/?tag=activedirectorysecurity" class="tag-cloud-link tag-link-113 tag-link-position-4" style="font-size: 13.957446808511pt;" aria-label="ActiveDirectorySecurity (14 items)">ActiveDirectorySecurity</a>
<a href="https://adsecurity.org/?tag=active-directory-security" class="tag-cloud-link tag-link-976 tag-link-position-5" style="font-size: 9.7872340425532pt;" aria-label="Active Directory Security (7 items)">Active Directory Security</a>
<a href="https://adsecurity.org/?tag=adreading" class="tag-cloud-link tag-link-5 tag-link-position-6" style="font-size: 13.510638297872pt;" aria-label="ADReading (13 items)">ADReading</a>
<a href="https://adsecurity.org/?tag=adsecurity" class="tag-cloud-link tag-link-86 tag-link-position-7" style="font-size: 10.531914893617pt;" aria-label="ADSecurity (8 items)">ADSecurity</a>
<a href="https://adsecurity.org/?tag=ad-security" class="tag-cloud-link tag-link-100 tag-link-position-8" style="font-size: 8pt;" aria-label="AD Security (5 items)">AD Security</a>
<a href="https://adsecurity.org/?tag=dcsync" class="tag-cloud-link tag-link-598 tag-link-position-9" style="font-size: 10.531914893617pt;" aria-label="DCSync (8 items)">DCSync</a>
<a href="https://adsecurity.org/?tag=defcon" class="tag-cloud-link tag-link-518 tag-link-position-10" style="font-size: 8pt;" aria-label="DEFCON (5 items)">DEFCON</a>
<a href="https://adsecurity.org/?tag=domaincontroller" class="tag-cloud-link tag-link-101 tag-link-position-11" style="font-size: 15.446808510638pt;" aria-label="DomainController (18 items)">DomainController</a>
<a href="https://adsecurity.org/?tag=emet5" class="tag-cloud-link tag-link-338 tag-link-position-12" style="font-size: 8pt;" aria-label="EMET5 (5 items)">EMET5</a>
<a href="https://adsecurity.org/?tag=goldenticket" class="tag-cloud-link tag-link-303 tag-link-position-13" style="font-size: 11.276595744681pt;" aria-label="GoldenTicket (9 items)">GoldenTicket</a>
<a href="https://adsecurity.org/?tag=hyperv" class="tag-cloud-link tag-link-3 tag-link-position-14" style="font-size: 8pt;" aria-label="HyperV (5 items)">HyperV</a>
<a href="https://adsecurity.org/?tag=invoke-mimikatz" class="tag-cloud-link tag-link-336 tag-link-position-15" style="font-size: 10.531914893617pt;" aria-label="Invoke-Mimikatz (8 items)">Invoke-Mimikatz</a>
<a href="https://adsecurity.org/?tag=kb3011780" class="tag-cloud-link tag-link-337 tag-link-position-16" style="font-size: 9.7872340425532pt;" aria-label="KB3011780 (7 items)">KB3011780</a>
<a href="https://adsecurity.org/?tag=kdc" class="tag-cloud-link tag-link-80 tag-link-position-17" style="font-size: 8pt;" aria-label="KDC (5 items)">KDC</a>
<a href="https://adsecurity.org/?tag=kerberos" class="tag-cloud-link tag-link-81 tag-link-position-18" style="font-size: 15.446808510638pt;" aria-label="Kerberos (18 items)">Kerberos</a>
<a href="https://adsecurity.org/?tag=kerberoshacking" class="tag-cloud-link tag-link-298 tag-link-position-19" style="font-size: 11.872340425532pt;" aria-label="KerberosHacking (10 items)">KerberosHacking</a>
<a href="https://adsecurity.org/?tag=krbtgt" class="tag-cloud-link tag-link-394 tag-link-position-20" style="font-size: 9.7872340425532pt;" aria-label="KRBTGT (7 items)">KRBTGT</a>
<a href="https://adsecurity.org/?tag=laps" class="tag-cloud-link tag-link-631 tag-link-position-21" style="font-size: 9.0425531914894pt;" aria-label="LAPS (6 items)">LAPS</a>
<a href="https://adsecurity.org/?tag=lsass" class="tag-cloud-link tag-link-71 tag-link-position-22" style="font-size: 11.276595744681pt;" aria-label="LSASS (9 items)">LSASS</a>
<a href="https://adsecurity.org/?tag=mcm" class="tag-cloud-link tag-link-6 tag-link-position-23" style="font-size: 14.255319148936pt;" aria-label="MCM (15 items)">MCM</a>
<a href="https://adsecurity.org/?tag=microsoftemet" class="tag-cloud-link tag-link-58 tag-link-position-24" style="font-size: 11.276595744681pt;" aria-label="MicrosoftEMET (9 items)">MicrosoftEMET</a>
<a href="https://adsecurity.org/?tag=microsoftwindows" class="tag-cloud-link tag-link-102 tag-link-position-25" style="font-size: 9.7872340425532pt;" aria-label="MicrosoftWindows (7 items)">MicrosoftWindows</a>
<a href="https://adsecurity.org/?tag=mimikatz" class="tag-cloud-link tag-link-207 tag-link-position-26" style="font-size: 18.425531914894pt;" aria-label="mimikatz (29 items)">mimikatz</a>
<a href="https://adsecurity.org/?tag=ms14068" class="tag-cloud-link tag-link-295 tag-link-position-27" style="font-size: 11.276595744681pt;" aria-label="MS14068 (9 items)">MS14068</a>
<a href="https://adsecurity.org/?tag=passthehash" class="tag-cloud-link tag-link-44 tag-link-position-28" style="font-size: 9.7872340425532pt;" aria-label="PassTheHash (7 items)">PassTheHash</a>
<a href="https://adsecurity.org/?tag=powershell" class="tag-cloud-link tag-link-575 tag-link-position-29" style="font-size: 18.872340425532pt;" aria-label="PowerShell (31 items)">PowerShell</a>
<a href="https://adsecurity.org/?tag=powershellcode" class="tag-cloud-link tag-link-22 tag-link-position-30" style="font-size: 15.148936170213pt;" aria-label="PowerShellCode (17 items)">PowerShellCode</a>
<a href="https://adsecurity.org/?tag=powershellhacking" class="tag-cloud-link tag-link-68 tag-link-position-31" style="font-size: 8pt;" aria-label="PowerShellHacking (5 items)">PowerShellHacking</a>
<a href="https://adsecurity.org/?tag=powershellv5" class="tag-cloud-link tag-link-69 tag-link-position-32" style="font-size: 8pt;" aria-label="PowerShellv5 (5 items)">PowerShellv5</a>
<a href="https://adsecurity.org/?tag=powersploit" class="tag-cloud-link tag-link-232 tag-link-position-33" style="font-size: 10.531914893617pt;" aria-label="PowerSploit (8 items)">PowerSploit</a>
<a href="https://adsecurity.org/?tag=presentation" class="tag-cloud-link tag-link-422 tag-link-position-34" style="font-size: 9.7872340425532pt;" aria-label="Presentation (7 items)">Presentation</a>
<a href="https://adsecurity.org/?tag=security" class="tag-cloud-link tag-link-576 tag-link-position-35" style="font-size: 8pt;" aria-label="Security (5 items)">Security</a>
<a href="https://adsecurity.org/?tag=sidhistory" class="tag-cloud-link tag-link-547 tag-link-position-36" style="font-size: 8pt;" aria-label="SIDHistory (5 items)">SIDHistory</a>
<a href="https://adsecurity.org/?tag=silverticket" class="tag-cloud-link tag-link-304 tag-link-position-37" style="font-size: 11.276595744681pt;" aria-label="SilverTicket (9 items)">SilverTicket</a>
<a href="https://adsecurity.org/?tag=sneakyadpersistence" class="tag-cloud-link tag-link-596 tag-link-position-38" style="font-size: 9.0425531914894pt;" aria-label="SneakyADPersistence (6 items)">SneakyADPersistence</a>
<a href="https://adsecurity.org/?tag=spn" class="tag-cloud-link tag-link-294 tag-link-position-39" style="font-size: 9.0425531914894pt;" aria-label="SPN (6 items)">SPN</a>
<a href="https://adsecurity.org/?tag=tgs" class="tag-cloud-link tag-link-528 tag-link-position-40" style="font-size: 9.0425531914894pt;" aria-label="TGS (6 items)">TGS</a>
<a href="https://adsecurity.org/?tag=tgt" class="tag-cloud-link tag-link-529 tag-link-position-41" style="font-size: 9.0425531914894pt;" aria-label="TGT (6 items)">TGT</a>
<a href="https://adsecurity.org/?tag=windows10" class="tag-cloud-link tag-link-494 tag-link-position-42" style="font-size: 10.531914893617pt;" aria-label="Windows10 (8 items)">Windows10</a>
<a href="https://adsecurity.org/?tag=windowsserver2008r2" class="tag-cloud-link tag-link-46 tag-link-position-43" style="font-size: 9.0425531914894pt;" aria-label="WindowsServer2008R2 (6 items)">WindowsServer2008R2</a>
<a href="https://adsecurity.org/?tag=windowsserver2012" class="tag-cloud-link tag-link-47 tag-link-position-44" style="font-size: 11.276595744681pt;" aria-label="WindowsServer2012 (9 items)">WindowsServer2012</a>
<a href="https://adsecurity.org/?tag=windowsserver2012r2" class="tag-cloud-link tag-link-54 tag-link-position-45" style="font-size: 9.7872340425532pt;" aria-label="WindowsServer2012R2 (7 items)">WindowsServer2012R2</a></div>
</div>    
        
    
</div><!-- #sidebar1 -->        
        
    </div><!-- #content -->


    
        
    <div id="sidebar_bottom" class="sidebar widget-area row footer-widget-col-3">
                    <div id="text-2" class="sidebar-wrap widget_text col-sm-4"><h3>Copyright</h3>			<div class="textwidget">Content Disclaimer: This blog and its contents are provided "AS IS" with no warranties, and they confer no rights. Script samples are provided for informational purposes only and no guarantee is provided as to functionality or suitability.
The views shared on this blog reflect those of the authors and do not represent the views of any companies mentioned.

Content Ownership: All content posted here is intellectual work and under the current law, the poster owns the copyright of the article. Terms of Use Copyright Â© 2011 - 2020.</div>
		</div>		
            </div>

	

<div id="footer" class="row default-footer">
    
        
            
            <div class="copyright-developer">
                                    <div id="copyright">
                        <p>Content Disclaimer: This blog and its contents are provided "AS IS" with no warranties, and they confer no rights. Script samples are provided for informational purposes only and no guarantee is provided as to functionality or suitability. The views shared on this blog reflect those of the authors and do not represent the views of any companies mentioned. </p>
                    </div>
                
                                    <div id="developer">
                        <p>
                                                        Made with <i class="fa fa-heart"></i> by <a href="https://www.graphene-theme.com/" rel="nofollow">Graphene Themes</a>.                        </p>

                                            </div>
                            </div>

        
                
    </div><!-- #footer -->


</div><!-- #container -->

		<!-- Start of StatCounter Code -->
		<script>
			<!--
			var sc_project=10100711;
			var sc_security="4b306538";
			      var sc_invisible=1;
			var scJsHost = (("https:" == document.location.protocol) ?
				"https://secure." : "http://www.");
			//-->
					</script>
		
<script type="text/javascript"
				src="https://secure.statcounter.com/counter/counter.js"
				async></script>		<noscript><div class="statcounter"><a title="web analytics" href="https://statcounter.com/"><img class="statcounter" src="https://c.statcounter.com/10100711/0/4b306538/1/" alt="web analytics" /></a></div></noscript>
		<!-- End of StatCounter Code -->
				<a href="#" id="back-to-top" title="Back to top"><i class="fa fa-chevron-up"></i></a>
	<script type='text/javascript' id='tptn_tracker-js-extra'>
/* <![CDATA[ */
var ajax_tptn_tracker = {"ajax_url":"https:\/\/adsecurity.org\/wp-admin\/admin-ajax.php","top_ten_id":"556","top_ten_blog_id":"1","activate_counter":"11","top_ten_debug":"0","tptn_rnd":"439670653"};
/* ]]> */
</script>
<script type='text/javascript' src='https://adsecurity.org/wp-content/plugins/top-10/includes/js/top-10-tracker.min.js?ver=1.0' id='tptn_tracker-js'></script>
<script defer type='text/javascript' src='https://adsecurity.org/wp-includes/js/comment-reply.min.js?ver=5.7.2' id='comment-reply-js'></script>
<script type='text/javascript' src='https://adsecurity.org/wp-includes/js/wp-embed.min.js?ver=5.7.2' id='wp-embed-js'></script>
</body>
</html>