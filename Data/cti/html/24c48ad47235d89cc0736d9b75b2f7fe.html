<!doctype html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="profile" href="https://gmpg.org/xfn/11">
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

<title>Ryuk Speed Run, 2 Hours to Ransom - The DFIR Report</title>
<link rel="canonical" href="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Ryuk Speed Run, 2 Hours to Ransom - The DFIR Report" />
<meta property="og:description" content="Intro Since the end of September Ryuk has been screaming back into the news. We&#8217;ve already covered 2 cases in that timeframe. We&#8217;ve seen major healthcare providers, managed service providers, &hellip; Read More" />
<meta property="og:url" content="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="article:published_time" content="2020-11-05T17:19:17+00:00" />
<meta property="article:modified_time" content="2021-01-24T23:23:51+00:00" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2020/11/r.png" />
<meta property="og:image:width" content="1299" />
<meta property="og:image:height" content="675" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="editor">
<meta name="twitter:label2" content="Est. reading time">
<meta name="twitter:data2" content="14 minutes">
<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://thedfirreport.com/#website","url":"https://thedfirreport.com/","name":"The DFIR Report","description":"Real Intrusions by Real Attackers, The Truth Behind the Intrusion","potentialAction":[{"@type":"SearchAction","target":"https://thedfirreport.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/#primaryimage","inLanguage":"en-US","url":"https://thedfirreport.com/wp-content/uploads/2020/11/r.png","contentUrl":"https://thedfirreport.com/wp-content/uploads/2020/11/r.png","width":1299,"height":675},{"@type":"WebPage","@id":"https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/#webpage","url":"https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/","name":"Ryuk Speed Run, 2 Hours to Ransom - The DFIR Report","isPartOf":{"@id":"https://thedfirreport.com/#website"},"primaryImageOfPage":{"@id":"https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/#primaryimage"},"datePublished":"2020-11-05T17:19:17+00:00","dateModified":"2021-01-24T23:23:51+00:00","author":{"@id":"https://thedfirreport.com/#/schema/person/b74bd4df805a2739b85903202f6b5838"},"breadcrumb":{"@id":"https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/"]}]},{"@type":"BreadcrumbList","@id":"https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://thedfirreport.com/","url":"https://thedfirreport.com/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/#webpage"}}]},{"@type":"Person","@id":"https://thedfirreport.com/#/schema/person/b74bd4df805a2739b85903202f6b5838","name":"editor","image":{"@type":"ImageObject","@id":"https://thedfirreport.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/9627d3871f13290c26ecf861f7715257?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/9627d3871f13290c26ecf861f7715257?s=96&d=mm&r=g","caption":"editor"},"sameAs":["https://thedfirreport.com"],"url":"https://thedfirreport.com/author/editor/"}]}</script>

<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/5.7.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='contact-form-7-css' href='https://thedfirreport.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=5.7.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/font-awesome.min.css?ver=5.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='//fonts.googleapis.com/css?family=Heebo:300,400,700|Arimo&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/9.7/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css' href='https://c0.wp.com/p/jetpack/9.7/css/jetpack.css' type='text/css' media='all' />
<script type='text/javascript' id='jetpack_related-posts-js-extra'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/related-posts/related-posts.min.js' id='jetpack_related-posts-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/jquery/jquery.min.js' id='jquery-core-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/jquery/jquery-migrate.min.js' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1' id='freenews-global-js'></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/1123" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://thedfirreport.com/wp-includes/wlwmanifest.xml" />
<meta name="generator" content="WordPress 5.7.2" />
<link rel='shortlink' href='https://thedfirreport.com/?p=1123' />
<link rel="alternate" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2020%2F11%2F05%2Fryuk-speed-run-2-hours-to-ransom%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2020%2F11%2F05%2Fryuk-speed-run-2-hours-to-ransom%2F&#038;format=xml" />

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1"></script>
<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>
<script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=2F5314D0AD7F8A9016EBFE250B42DA9B');
</script><script type="text/javascript" src="//thedfirreport.com/?wordfence_syncAttackData=1621733904.1862" async></script><style type='text/css'>img#wpstats{display:none}</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
<script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>
<body class="post-template-default single single-post postid-1123 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
<div id="page" class="site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header id="masthead" class="site-header">
<div id="main-header" class="main-header">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<div id="primary-menu" class="menu"><ul>
<li class="page_item page-item-24"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
<li class="page_item page-item-2160"><a href="https://thedfirreport.com/services/">Services</a></li>
</ul></div>
</nav>
</div>
</div>
</div>
<div class="main-header-brand">
<div class="header-brand">
<div class="wrap">
<div class="header-brand-content">
<div class="site-branding">
<div class="site-branding-text">
<p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
<p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
</div>
</div>
<div class="header-right">
<div class="header-banner">
</div>
</div>
</div>
</div>
</div>
<div id="nav-sticker">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<div id="primary-menu" class="menu"><ul>
<li class="page_item page-item-24"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
<li class="page_item page-item-2160"><a href="https://thedfirreport.com/services/">Services</a></li>
</ul></div>
</nav>
</div>
</div>
</div>
<div class="clock">
<div id="time"></div>
<div id="date">Sunday, May 23, 2021</div>
</div>
</div>
</div>
</div>
</header>
<div id="content" class="site-content">
<div class="site-content-cell">
<div class="wrap">
<div id="primary" class="content-area">
<main id="main" class="site-main">
<article id="post-1123" class="post-1123 post type-post status-publish format-standard hentry category-adfind category-bazar category-cobaltstrike category-ransomware category-ryuk tag-bazar tag-cobalt-strike tag-kegtap tag-ransomware tag-ryuk entry">
<div class="entry-content-holder">
<header class="entry-header">
<div class="entry-meta">
<span class="cat-links">
<a class="category-color-24" href="https://thedfirreport.com/category/adfind/">adfind</a>
<a class="category-color-27" href="https://thedfirreport.com/category/bazar/">bazar</a>
<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
<a class="category-color-25" href="https://thedfirreport.com/category/ryuk/">ryuk</a>
</span>
</div>
<h1 class="entry-title">Ryuk Speed Run, 2 Hours to Ransom</h1>
<div class="entry-meta">
<span class="posted-on"><a href="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/" rel="bookmark"><time class="entry-date published" datetime="2020-11-05T17:19:17+00:00">November 5, 2020</time></a></span> </div>
</header>
<div class="entry-content">
<h3>Intro</h3>
<p>Since the end of September Ryuk has been screaming back into the news. We&#8217;ve already covered 2 <a href="https://thedfirreport.com/2020/10/08/ryuks-return/" target="_blank" rel="noopener noreferrer">cases</a> in that <a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" target="_blank" rel="noopener noreferrer">timeframe</a>. We&#8217;ve seen major <a href="https://www.bleepingcomputer.com/news/security/uhs-hospitals-hit-by-reported-country-wide-ryuk-ransomware-attack/" target="_blank" rel="noopener noreferrer">healthcare</a> providers, managed <a href="https://www.soprasteria.com/newsroom/publications/details/cyberattack-information-update">service providers</a>, and <a href="https://www.infosecurity-magazine.com/news/furniture-giant-steelcase/" target="_blank" rel="noopener noreferrer">furniture manufactures</a> all reportedly being hit. The Cyber Security and Infrastructure Security Agency (CISA) released an <a href="https://us-cert.cisa.gov/ncas/alerts/aa20-302a" target="_blank" rel="noopener noreferrer">advisory</a> claiming that a mass Ryuk campaign against the United States healthcare system was an imminent threat.</p>
<p>FireEye released a <a href="https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html" target="_blank" rel="noopener noreferrer">post,</a> and hosted a <a href="https://www.youtube.com/watch?v=CgDtm05qApE" target="_blank" rel="noopener noreferrer">webinar</a> with SANS and <span class="css-901oao css-16my406 r-1qd0xha r-ad9z0x r-bcqeeo r-qvutc0"><a href="https://twitter.com/likethecoins" target="_blank" rel="noopener noreferrer">@likethecoins</a>,</span> detailing a group FireEye identifies as UNC 1878. In their report, they describe a threat actor&#8217;s TTPs that align with the activity we&#8217;ve previously reported on. They indicated in their investigations and responses of seeing the group take just 2 to 5 days from entry to full domain ransomware deployment. In our cases we&#8217;ve seen even faster action, with the threat actors seemly trying to speed-run their ransomware deployment. In this most recent case, ransomware was deployed in 2 hours with the actor completing all objectives in 3 hours.</p>
<p>Red Canary released a <a href="https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/" target="_blank" rel="noopener noreferrer">post</a> recently on how they, with the support of Kroll, stopped a Ryuk intrusion at a hospital. This report includes 10 detection ideas as well as a feel good story on how they stopped the intrusion. We need more reports like this, especially right now.</p>
<p>SCYTHE recently put out an adversary emulation plan and a post based on our previous Ryuk reports. You can check out the post <a href="https://www.scythe.io/library/threatthursday-ryuk" target="_blank" rel="noopener noreferrer">here</a> and the free emulation plan <a href="https://github.com/scythe-io/community-threats/tree/master/Ryuk" target="_blank" rel="noopener noreferrer">here</a>. Great job <a href="https://twitter.com/jorgeorchilles" target="_blank" rel="noopener noreferrer"><span class="css-901oao css-16my406 r-1qd0xha r-ad9z0x r-bcqeeo r-qvutc0">@jorgeorchilles</span></a>, <span class="r-18u37iz"><a class="css-4rbku5 css-18t94o4 css-901oao css-16my406 r-1n1174f r-1loqt21 r-1qd0xha r-ad9z0x r-bcqeeo r-qvutc0" dir="ltr" role="link" href="https://twitter.com/seanqsun" data-focusable="true">@seanqsun </a></span>and the rest of the SCYTHE team for sharing this with the community!</p>
<h3>Case Summary</h3>
<p>Like in our prior two reports of Ryuk campaigns, the initial access came from phishing emails containing links to google drive that when clicked, downloaded a Bazar Loader backdoor executable. In our prior cases we generally saw a lag time, ranging hours to days, from the initial click to Ryuk. In this case, the time from initial Bazar execution to domain recon was 5 minutes, and deployment of  Cobalt Strike beacons was within 10 minutes. This is by far the quickest we have seen them act.</p>
<p>After bringing in Cobalt Strike, we saw familiar TTP&#8217;s with using AdFind to continue domain discovery activity. In this case, we saw them deploy persistence on the beachhead host, an action we had not previously seen in our other cases. After establishing another C2 for an additional Cobalt Strike beacon, they employed the Zerologon exploit (CVE 2020-1472) and obtained domain admin level privileges. We also saw host process injection on the beachhead used for obfuscation and privilege escalation.</p>
<p>With domain administrator privileges obtained, the threat actors then moved laterally throughout the network using SMB and RDP to deploy Cobalt Strike beacons on the domain controllers around 1 hour after the initial execution of Bazar. On the domain controllers, some additional discovery was done using the PowerShell Active Directory module. From there, they targeted other severs in the environment; specifically, back up systems, file servers, and software deployment servers. After establishing Cobalt Strike beacons on those they felt ready to proceed to their final objectives.</p>
<p>At the 2 hour mark the threat actors made the move to deploy Ryuk ransomware by establishing RDP connections from the domain controllers to servers. This continued for the next hour until the entire domain had been encrypted, with that work completing just 3 hours after the first Bazar Loader was executed.</p>
<h3>Timeline</h3>
<p><img loading="lazy" class="alignnone wp-image-1228 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3.png" alt width="965" height="1631" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3.png 965w, https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3-177x300.png 177w, https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3-606x1024.png 606w, https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3-768x1298.png 768w, https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3-909x1536.png 909w" data-lazy-sizes="(max-width: 965px) 100vw, 965px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1228 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3.png" alt="" width="965" height="1631" srcset="https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3.png 965w, https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3-177x300.png 177w, https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3-606x1024.png 606w, https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3-768x1298.png 768w, https://thedfirreport.com/wp-content/uploads/2020/11/Ryuk-Speed-Run-2-Hours-to-Ransom-3-909x1536.png 909w" sizes="(max-width: 965px) 100vw, 965px" /></noscript></p>
<h3>MITRE ATT&amp;CK</h3>
<h3><a>Initial Access</a></h3>
<p>Initial access via a phishing email that linked to a google docs page that enticed the user to download a report, which was  a Bazar Loader executable file instead <a href="https://bazaar.abuse.ch/sample/cc92b3dfea935cc411dae5493eec0b0375ab35a3172b0143b1f8835a507c6995/" target="_blank" rel="noopener noreferrer">Report-Review20-10.exe</a>.</p>
<h3><a>Execution</a></h3>
<p>Execution of the initial Bazar Loader malware relies on user interaction.</p>
<p>Executables transferred over SMB during lateral movement were commonly executed via a service.</p>
<pre>Image: C:\Windows\system32\services.exe
TargetObject: HKLM\System\CurrentControlSet\Services\ff49429\ImagePath
Details: \\HOSTNAME\ADMIN$\ff49429.exe"</pre>
<h3>Persistence</h3>
<p>This time, unlike prior investigations, clear persistence was found setup on the beachhead host. Firefox.exe created these scheduled tasks as well as the run key.</p>
<pre>"C:\Windows\System32\schtasks.exe" /CREATE /SC ONSTART /TN jf0c /TR "'C:\Users\pagefilerpqy.exe'" /f
"C:\Windows\System32\schtasks.exe" /CREATE /SC ONSTART /TN jf0c /TR "'C:\Users\pagefilerpqy.exe'" /f /RL HIGHEST
"C:\Windows\System32\schtasks.exe" /CREATE /SC ONCE /ST 17:21:58 /TN 9T6ukfi6 /TR "'C:\Users\pagefilerpqy.exe'" /f
"C:\Windows\System32\schtasks.exe" /CREATE /SC ONCE /ST 17:21:58 /TN 9T6ukfi6 /TR "'C:\Users\pagefilerpqy.exe'" /f /RL HIGHEST
REG ADD "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /V \"microsoft update\" /t REG_SZ /F /D "SCHTASKS /run /tn 9T6ukfi6"
</pre>
<h3>Privilege Escalation</h3>
<p>The Zerologon vulnerability CVE 2020-1472 was again exploited to obtain domain admin level privileges.</p>
<p><img loading="lazy" class="alignnone wp-image-1163 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3.png" alt width="1072" height="742" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3.png 1072w, https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3-300x208.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3-1024x709.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3-768x532.png 768w" data-lazy-sizes="(max-width: 1072px) 100vw, 1072px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1163 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3.png" alt="" width="1072" height="742" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3.png 1072w, https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3-300x208.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3-1024x709.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/zerologinryuk3-768x532.png 768w" sizes="(max-width: 1072px) 100vw, 1072px" /></noscript></p>
<h3>Credential Access</h3>
<p><a href="https://github.com/GhostPack/Rubeus" target="_blank" rel="noopener noreferrer">Rubeus</a> was used to <a href="https://attack.mitre.org/techniques/T1558/003/" target="_blank" rel="noopener noreferrer">kerberoast</a> the environment.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1203 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/11/kerb1-1.png" alt width="838" height="90" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/11/kerb1-1.png 838w, https://thedfirreport.com/wp-content/uploads/2020/11/kerb1-1-300x32.png 300w, https://thedfirreport.com/wp-content/uploads/2020/11/kerb1-1-768x82.png 768w" data-lazy-sizes="(max-width: 838px) 100vw, 838px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/11/kerb1-1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1203" src="https://thedfirreport.com/wp-content/uploads/2020/11/kerb1-1.png" alt="" width="838" height="90" srcset="https://thedfirreport.com/wp-content/uploads/2020/11/kerb1-1.png 838w, https://thedfirreport.com/wp-content/uploads/2020/11/kerb1-1-300x32.png 300w, https://thedfirreport.com/wp-content/uploads/2020/11/kerb1-1-768x82.png 768w" sizes="(max-width: 838px) 100vw, 838px" /></noscript></p>
<p><img loading="lazy" class="alignnone size-full wp-image-1202 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/11/kerb2.png" alt width="792" height="132" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/11/kerb2.png 792w, https://thedfirreport.com/wp-content/uploads/2020/11/kerb2-300x50.png 300w, https://thedfirreport.com/wp-content/uploads/2020/11/kerb2-768x128.png 768w" data-lazy-sizes="(max-width: 792px) 100vw, 792px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/11/kerb2.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1202" src="https://thedfirreport.com/wp-content/uploads/2020/11/kerb2.png" alt="" width="792" height="132" srcset="https://thedfirreport.com/wp-content/uploads/2020/11/kerb2.png 792w, https://thedfirreport.com/wp-content/uploads/2020/11/kerb2-300x50.png 300w, https://thedfirreport.com/wp-content/uploads/2020/11/kerb2-768x128.png 768w" sizes="(max-width: 792px) 100vw, 792px" /></noscript></p>
<h3><a>Defense Evasion</a></h3>
<p>Process injection was used on the beachhead host to to inject into svchost.exe</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1165 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/procinjryuk3.png" alt width="539" height="230" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/procinjryuk3.png 539w, https://thedfirreport.com/wp-content/uploads/2020/10/procinjryuk3-300x128.png 300w" data-lazy-sizes="(max-width: 539px) 100vw, 539px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/procinjryuk3.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1165" src="https://thedfirreport.com/wp-content/uploads/2020/10/procinjryuk3.png" alt="" width="539" height="230" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/procinjryuk3.png 539w, https://thedfirreport.com/wp-content/uploads/2020/10/procinjryuk3-300x128.png 300w" sizes="(max-width: 539px) 100vw, 539px" /></noscript></p>
<p>The Bazar Loader malware was using a code signing certificate signed by Digicert under the organization <a title="Hunt for other samples" href="https://bazaar.abuse.ch/browse.php?search=NOSOV SP Z O O" target="_parent" rel="noopener noreferrer">NOSOV SP Z O O</a></p>
<p><img loading="lazy" class="alignnone wp-image-1137 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/codesign1.png" alt width="1284" height="371" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/codesign1.png 1284w, https://thedfirreport.com/wp-content/uploads/2020/10/codesign1-300x87.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/codesign1-1024x296.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/codesign1-768x222.png 768w" data-lazy-sizes="(max-width: 1284px) 100vw, 1284px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/codesign1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1137 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/codesign1.png" alt="" width="1284" height="371" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/codesign1.png 1284w, https://thedfirreport.com/wp-content/uploads/2020/10/codesign1-300x87.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/codesign1-1024x296.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/codesign1-768x222.png 768w" sizes="(max-width: 1284px) 100vw, 1284px" /></noscript></p>
<p>At the time of delivery, the executable had a detection rate of 1/69 in Virustotal.</p>
<p><img loading="lazy" class="alignnone size-large wp-image-1138 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/vt1-1024x180.png" alt width="1024" height="180" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/vt1-1024x180.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/vt1-300x53.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/vt1-768x135.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/vt1.png 1247w" data-lazy-sizes="(max-width: 1024px) 100vw, 1024px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/vt1-1024x180.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-large wp-image-1138" src="https://thedfirreport.com/wp-content/uploads/2020/10/vt1-1024x180.png" alt="" width="1024" height="180" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/vt1-1024x180.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/vt1-300x53.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/vt1-768x135.png 768w, https://thedfirreport.com/wp-content/uploads/2020/10/vt1.png 1247w" sizes="(max-width: 1024px) 100vw, 1024px" /></noscript></p>
<p>The Cobalt Strike beacons used in the environment used similar code signing certificates.</p>
<p><img loading="lazy" class="alignnone wp-image-1176 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/codesign-ryuk3-e1604420189854.png" alt width="444" height="267" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/codesign-ryuk3-e1604420189854.png 444w, https://thedfirreport.com/wp-content/uploads/2020/10/codesign-ryuk3-e1604420189854-300x180.png 300w" data-lazy-sizes="(max-width: 444px) 100vw, 444px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/codesign-ryuk3-e1604420189854.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1176 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/codesign-ryuk3-e1604420189854.png" alt="" width="444" height="267" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/codesign-ryuk3-e1604420189854.png 444w, https://thedfirreport.com/wp-content/uploads/2020/10/codesign-ryuk3-e1604420189854-300x180.png 300w" sizes="(max-width: 444px) 100vw, 444px" /></noscript></p>
<h3><a>Discovery</a></h3>
<p>In previous cases, we generally saw some lag time between infection and further actions but this time things moved much quicker, starting with initial discovery executed by Bazar less than 5 minutes after initial execution.</p>
<p>Discovery command run by Bazar:</p>
<pre>net view /all 
net view /all /domain 
nltest /domain_trusts /all_trusts 
net localgroup "administrator" 
net group "domain admins" /dom</pre>
<p>Seven minutes later, after launching a Cobalt Strike beacon, AdFind was used&#8211; running the same discovery pattern seen in previous reporting. This was started via a bat script. It appears that the threat actors are now piping these commands into a batch file one at a time instead of dropping adf.bat to disk.</p>
<pre>AdFind.exe -f "(objectcategory=person)"
AdFind.exe -f "(objectcategory=computer)"
AdFind.exe -f "(objectcategory=organizationalUnit)"
AdFind.exe -sc trustdmp
AdFind.exe -subnets -f "(objectCategory=subnet)"
AdFind.exe -f "(objectcategory=group)"
AdFind.exe -gcb -sc trustdmp</pre>
<p>Once on the domain controller the PowerShell Active Directory module was loaded.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1158 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/adps.png" alt width="954" height="105" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/adps.png 954w, https://thedfirreport.com/wp-content/uploads/2020/10/adps-300x33.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/adps-768x85.png 768w" data-lazy-sizes="(max-width: 954px) 100vw, 954px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/adps.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1158" src="https://thedfirreport.com/wp-content/uploads/2020/10/adps.png" alt="" width="954" height="105" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/adps.png 954w, https://thedfirreport.com/wp-content/uploads/2020/10/adps-300x33.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/adps-768x85.png 768w" sizes="(max-width: 954px) 100vw, 954px" /></noscript></p>
<h3 aria-describedby="cdk-describedby-message-28"><img loading="lazy" class="alignnone size-full wp-image-1207 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/11/ex.png" alt width="835" height="61" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/11/ex.png 835w, https://thedfirreport.com/wp-content/uploads/2020/11/ex-300x22.png 300w, https://thedfirreport.com/wp-content/uploads/2020/11/ex-768x56.png 768w" data-lazy-sizes="(max-width: 835px) 100vw, 835px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/11/ex.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1207" src="https://thedfirreport.com/wp-content/uploads/2020/11/ex.png" alt="" width="835" height="61" srcset="https://thedfirreport.com/wp-content/uploads/2020/11/ex.png 835w, https://thedfirreport.com/wp-content/uploads/2020/11/ex-300x22.png 300w, https://thedfirreport.com/wp-content/uploads/2020/11/ex-768x56.png 768w" sizes="(max-width: 835px) 100vw, 835px" /></noscript></h3>
<h3 class="tactic-cell" aria-describedby="cdk-describedby-message-28">Lateral Movement</h3>
<p>RDP connections were initiated from Cobalt Strike Beacons running on the beachhead host to two domain controllers and then Cobalt Strike executables were dropped by these connections.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1175 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/lat1-ryuk3.png" alt width="701" height="176" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/lat1-ryuk3.png 701w, https://thedfirreport.com/wp-content/uploads/2020/10/lat1-ryuk3-300x75.png 300w" data-lazy-sizes="(max-width: 701px) 100vw, 701px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/lat1-ryuk3.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1175" src="https://thedfirreport.com/wp-content/uploads/2020/10/lat1-ryuk3.png" alt="" width="701" height="176" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/lat1-ryuk3.png 701w, https://thedfirreport.com/wp-content/uploads/2020/10/lat1-ryuk3-300x75.png 300w" sizes="(max-width: 701px) 100vw, 701px" /></noscript></p>
<p>In addition to using RDP to move around the environment execuatables were also transferred over SMB to ADMIN$ shares and executed as a service.</p>
<pre>\\HOSTNAME\ADMIN$\ff49429.exe</pre>
<h3><img loading="lazy" class="alignnone size-full wp-image-1233 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/11/1.png" alt width="270" height="144" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/11/1.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1233" src="https://thedfirreport.com/wp-content/uploads/2020/11/1.png" alt="" width="270" height="144" /></noscript></h3>
<h3><a>Command and Control</a></h3>
<p><strong>Bazar Loader</strong>:</p>
<pre><a href="https://bazaar.abuse.ch/sample/cc92b3dfea935cc411dae5493eec0b0375ab35a3172b0143b1f8835a507c6995/" rel="noopener noreferrer">Report-Review20-10.exe</a>
<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">dghns.xyz</span></a></span></span>
34.222.33.48:443
Certificate[<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">0e:bb:b8:4f:04:fe:7a:fe:2f:b6:59:58:fc:bd:05:f8:2e:c6:1e:f8</span></a> </span></span>]
Not Before <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2020/10/20 01:55:40 </span></a></span></span>
Not After <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2021/01/18 00:55:40 </span></a></span></span>
Issuer Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">Let's Encrypt</span></a> </span></span>
Subject Common <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">dghns.xyz</span></a> </span></span>[<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">dghns.xyz</span></a> </span></span>,<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">www.dghns.xyz</span></a> </span></span>]
Public Algorithm <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">rsaEncryption</span></a></span></span>
JA3: 9e10692f1b7f78228b2d4e424db3a98c
JA3s: 2b33c1374db4ddf06942f92373c0b54b</pre>
<p><strong>Cobalt Strike (suspected)</strong>:</p>
<pre style="text-align: left;">rundll32.exe
<a data-v-6144aac9="">checktodrivers.com</a>
45.153.240.240:443
Certificate [<a data-v-6144aac9="">ac:67:f2:b1:b0:5a:bd:f4:9f:23:98:0e:a9:8c:fd:8c:0f:56:b2:58</a> ]
Not Before <a data-v-6144aac9="">2020/10/20 17:00:33 </a>
Not After <a data-v-6144aac9="">2021/10/20 17:00:33 </a> 
Issuer Org <a data-v-6144aac9="">lol</a> 
Subject Common <a data-v-6144aac9="">checktodrivers.com</a> 
Subject Org <a data-v-6144aac9="">lol</a> 
Public Algorithm <a data-v-6144aac9="">rsaEncryption</a>
JA3: 37f463bf4616ecd445d4a1937da06e19
JA3s: ae4edc6faf64d08308082ad26be60767</pre>
<pre>rundll32.exe
<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">topservicebooster.com</span></a></span></span>108.62.12.121:443
Certificate [<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">35:ef:11:c8:a5:2c:b9:44:37:1b:cf:fd:27:50:79:31:69:f7:da:a9</span></a> </span></span>]
Not Before <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2020/10/20 10:51:32 </span></a> </span></span>
Not After <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2021/10/20 10:51:32 </span></a></span></span>Issuer Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span>
Subject Common <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">topservicebooster.com</span></a> </span></span>
Subject Org <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">lol</span></a> </span></span>
Public Algorithm <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">rsaEncryption</span></a></span></span>JA3: 2c14bfb3f8a2067fbc88d8345e9f97f3
JA3s: 649d6810e8392f63dc311eecb6b7098b</pre>
<pre>pagefilerpqy.exe
chaseltd.top
161.117.191.245:80
<span data-v-19ab7c68=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">http://chaseltd[.]top/gate[.]php</span></a></span></span></pre>
<div><img loading="lazy" class="alignnone wp-image-1170 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/chaseltd-e1604420492845.png" alt width="946" height="468" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/chaseltd-e1604420492845.png 946w, https://thedfirreport.com/wp-content/uploads/2020/10/chaseltd-e1604420492845-300x148.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/chaseltd-e1604420492845-768x380.png 768w" data-lazy-sizes="(max-width: 946px) 100vw, 946px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/chaseltd-e1604420492845.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1170 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/chaseltd-e1604420492845.png" alt="" width="946" height="468" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/chaseltd-e1604420492845.png 946w, https://thedfirreport.com/wp-content/uploads/2020/10/chaseltd-e1604420492845-300x148.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/chaseltd-e1604420492845-768x380.png 768w" sizes="(max-width: 946px) 100vw, 946px" /></noscript></div>
<div></div>
<h3><a>Exfiltration</a></h3>
<p>Discovery data (AdFind and Rubeus outputs ) was exfiltrated out of the network via FTP.</p>
<p><span class="detail-field" data-v-6144aac9=""><span data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">5.2.70.149</span></a></span></span></span>:21</p>
<p><img loading="lazy" class="alignnone wp-image-1141 size-full jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/10/ftp20.png" alt width="1451" height="434" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/10/ftp20.png 1451w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp20-300x90.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp20-1024x306.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp20-768x230.png 768w" data-lazy-sizes="(max-width: 1451px) 100vw, 1451px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/10/ftp20.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone wp-image-1141 size-full" src="https://thedfirreport.com/wp-content/uploads/2020/10/ftp20.png" alt="" width="1451" height="434" srcset="https://thedfirreport.com/wp-content/uploads/2020/10/ftp20.png 1451w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp20-300x90.png 300w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp20-1024x306.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/10/ftp20-768x230.png 768w" sizes="(max-width: 1451px) 100vw, 1451px" /></noscript></p>
<h3><a>Impact</a></h3>
<p>At roughly the 2 hour mark, we saw the threat actors begin to act on their final objectives. RDP connections were initiated from one of the domain controllers and the Ryuk executables were deployed and executed over these RDP connections. Servers such as the backup systems, file servers, and automation tools were targeted first, followed by workstations.</p>
<p>Commands ran prior to ransom execution:</p>
<pre>"C:\Windows\system32\net1 stop ""samss"" /y"
"C:\Windows\system32\net1 stop ""veeamcatalogsvc"" /y"
"C:\Windows\system32\net1 stop ""veeamcloudsvc"" /y"
"C:\Windows\system32\net1 stop ""veeamdeploysvc"" /y"
"C:\Windows\System32\net.exe"" stop ""samss"" /y"
"C:\Windows\System32\net.exe"" stop ""veeamcatalogsvc"" /y"
"C:\Windows\System32\net.exe"" stop ""veeamcloudsvc"" /y"
"C:\Windows\System32\net.exe"" stop ""veeamdeploysvc"" /y"
"C:\Windows\System32\taskkill.exe"" /IM sqlbrowser.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM sqlceip.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM sqlservr.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM sqlwriter.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.agent.configurationservice.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.brokerservice.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.catalogdataservice.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.cloudservice.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.externalinfrastructure.dbprovider.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.manager.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.mountservice.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.service.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.uiserver.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.backup.wmiserver.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeamdeploymentsvc.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeamfilesysvsssvc.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeam.guest.interaction.proxy.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeamnfssvc.exe /F"
"C:\Windows\System32\taskkill.exe"" /IM veeamtransportsvc.exe /F"
"C:\Windows\system32\taskmgr.exe"" /4"
"C:\Windows\system32\wbem\wmiprvse.exe -Embedding"
"C:\Windows\system32\wbem\wmiprvse.exe -secured -Embedding"
"icacls ""C:\*"" /grant Everyone:F /T /C /Q"
"icacls ""D:\*"" /grant Everyone:F /T /C /Q"</pre>
<p>While encryption was started 2 hours into the attack, by the 3 hour mark the actors had completed ransom of the entire environment.</p>
<p><img loading="lazy" class="alignnone size-full wp-image-1205 jetpack-lazy-image" src="https://thedfirreport.com/wp-content/uploads/2020/11/r.png" alt width="1299" height="675" data-lazy-srcset="https://thedfirreport.com/wp-content/uploads/2020/11/r.png 1299w, https://thedfirreport.com/wp-content/uploads/2020/11/r-300x156.png 300w, https://thedfirreport.com/wp-content/uploads/2020/11/r-1024x532.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/11/r-768x399.png 768w" data-lazy-sizes="(max-width: 1299px) 100vw, 1299px" data-lazy-src="https://thedfirreport.com/wp-content/uploads/2020/11/r.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img loading="lazy" class="alignnone size-full wp-image-1205" src="https://thedfirreport.com/wp-content/uploads/2020/11/r.png" alt="" width="1299" height="675" srcset="https://thedfirreport.com/wp-content/uploads/2020/11/r.png 1299w, https://thedfirreport.com/wp-content/uploads/2020/11/r-300x156.png 300w, https://thedfirreport.com/wp-content/uploads/2020/11/r-1024x532.png 1024w, https://thedfirreport.com/wp-content/uploads/2020/11/r-768x399.png 768w" sizes="(max-width: 1299px) 100vw, 1299px" /></noscript></p>
<p>Enjoy our report? Please consider donating $1 or more to the project using <a href="https://www.patreon.com/thedfirreport" target="_blank" rel="noreferrer noopener">Patreon</a>. Thank you for your support!</p>
<p>We also have pcaps, files, memory images, and Kape packages available <a href="https://thedfirreport.com/services/" target="_blank" rel="noopener">here</a>.</p>
<h2>IOCs</h2>
<h3>Network</h3>
<pre>34.222.33.48:443
<span class="detail-field" data-v-6144aac9=""><span data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">dghns.xyz</span></a></span></span></span>
45.153.240.240:443
<span class="detail-field" data-v-6144aac9=""><span data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">checktodrivers.com</span></a></span></span></span>
108.62.12.121:443
<span class="detail-field" data-v-6144aac9=""><span data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">topservicebooster.com</span></a></span></span></span>
161.117.191.245:80
<span data-v-19ab7c68=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">chaseltd.top</span></a></span></span>
<span class="detail-field" data-v-6144aac9=""><span data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">5.2.70.149</span></a></span></span></span>:21</pre>
<h3>File</h3>
<pre>Report-Review20-10.exe.exe
8d35e058f5631c80b00dd695511878e3
8103299196efabec8ec0fc1d25f1332241b93220
0d468fc1b02bbc7c3050c67e0a80b580c69abd8eea5f8dad06c7d7ff396f7789
Firefox.exe
114057ad47a297e4092131386932456e
c9882d860e685869fcd8e997622d37d1ab43bcd6
3fc65b7e7967353f340ead51617558a23f14447ab91d974268f53ab0c17052e0
pagefilerpqy.exe
9b45c64d56523e21a268f8deb5cfa680
0a3f3bd9ae705af63779e8ca2be55d0db1253521
a4468c28e4830acf526209c0da25536ff0f682a0239ced1983a08d1ddd476963
pagefileU6Gl.sys
7f1de29e6da19d22b51c68001e7e0e54
40f7c01f4189510031adccd9c604a128adaf9b00
13671077b66a29874a2578b5240319092ef2a1043228e433e9b006b5e53e7513
pagefilerpqy.sys
92cc227532d17e56e07902b254dfad10
8ee51caaa2c2f4ee2e5b4b7ef5a89db7df1068d7
8241649609f88ccd2a0a5b233a07a538ec313ff6adf695aa44a969dbca39f67d
AdFind.exe
b3447ef9400d7f3f87ad24f89874f91a
75e3782ef880aa6eb9df135c3b3f23eece9a2af3
68d0f5659cf3cc1cf53519e1be482ca9a63f2deebdcd2cb7ee12515adc6db0a7
PL64.exe
c64266fd6142af402b1c7539be0ad02f
3f0471775bb22695f0ed112582c058a63dac0f07
a7514209db9d9c7c51927308d4f0b491464e11391af3c6ae31cb87d91fac995d
fx2-12_multi_for_crypt_x86.exe
fa24b3608c7f556424ec17c2265da994
357fbf27a30748812ce5aa3b298451c2eef88e6f
34007d53a8e64bf1dbbeace9e4878fb209878e6a6843251895d4dc9c2699056e</pre>
<h2>Detections</h2>
<h3>Network</h3>
<pre>2025194 ET INFO Observed Let's Encrypt Certificate for Suspicious TLD (.xyz)
2023882 ET INFO HTTP Request to a *.top domain
ET INFO Observed DNS Query for EmerDNS_TLD (.bazar)
ET NETBIOS DCERPC SVCCTL - Remote Service Control Manager Access</pre>
<h3>Sigma</h3>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/malware/win_mal_ryuk.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/malware/win_mal_ryuk.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_powershell_suspicious_parameter_variation.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_powershell_suspicious_parameter_variation.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_trust_discovery.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_trust_discovery.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml</a></p>
<p><a href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml" target="_blank" rel="noopener noreferrer">https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_net_execution.yml</a></p>
<p>Detects AdFind usage from a past case:</p>
<pre>title: AdFind Recon
description: Threat Actor using AdFind for reconnaissance. 
author: The DFIR Report
date: 2019/8/2
references:
    - https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/
tags:
    - attack.remote_system_discovery
    - attack.T1018
logsource:
    category: process_creation
    product: windows
detection:
    selection_1:
        CommandLine|contains:
            - adfind -f objectcategory=computer
    selection_2:
        CommandLine|contains:
            - adfind -gcb -sc trustdmp
    condition: selection_1 or selection_2 
falsepositives:
    - Legitimate Administrator using tool for Active Directory querying
level: medium
status: experimental</pre>
<h3>Yara</h3>
<pre>/*
YARA Rule Set
Author: The DFIR Report
Date: 2020-10-31
Identifier: files
Reference: https://thedfirreport.com
*/

/* Rule Set ----------------------------------------------------------------- */

import "pe"

rule ryuk_1007_fx2_12_multi_for_crypt_x86 {
meta:
description = "files - file fx2-12_multi_for_crypt_x86.exe"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-31"
hash1 = "34007d53a8e64bf1dbbeace9e4878fb209878e6a6843251895d4dc9c2699056e"
strings:
$s1 = "gOleAut32.dll" fullword wide
$s2 = "__ZN12_GLOBAL__N_110fake_mutexE" fullword ascii
$s3 = "__ZZN12_GLOBAL__N_116get_static_mutexEvE4once" fullword ascii
$s4 = "__gthread_mutex_t" fullword ascii
$s5 = "__gthread_recursive_mutex_t" fullword ascii
$s6 = "__ZNSt12__basic_fileIcEC2EP17__gthread_mutex_t" fullword ascii
$s7 = "__ZNSt12__basic_fileIcEC1EP17__gthread_mutex_t" fullword ascii
$s8 = "__ZGVZN12_GLOBAL__N_116get_locale_mutexEvE12locale_mutex" fullword ascii
$s9 = "__ZZN12_GLOBAL__N_116get_locale_mutexEvE12locale_mutex" fullword ascii
$s10 = "__ZN12_GLOBAL__N_116get_locale_mutexEv" fullword ascii
$s11 = "hmutex" fullword ascii
$s12 = "__ZGVZN12_GLOBAL__N_122get_locale_cache_mutexEvE18locale_cache_mutex" fullword ascii
$s13 = "__ZZN12_GLOBAL__N_122get_locale_cache_mutexEvE18locale_cache_mutex" fullword ascii
$s14 = "__gthr_win32_mutex_init_function" fullword ascii
$s15 = "___gthr_win32_recursive_mutex_init_function" fullword ascii
$s16 = "__gthr_win32_recursive_mutex_init_function" fullword ascii
$s17 = "___gthr_win32_mutex_init_function" fullword ascii
$s18 = "___gthr_win32_mutex_lock" fullword ascii
$s19 = "__gthr_win32_recursive_mutex_lock" fullword ascii
$s20 = "___gthr_win32_recursive_mutex_lock" fullword ascii
condition:
uint16(0) == 0x5a4d and filesize &lt; 4000KB and
( pe.imphash() == "d36627a0f5a150566b96bff0bfb0e763" or 8 of them )
}

rule ryuk3_1007_pagefilerpqy {
meta:
description = "files - file pagefilerpqy.exe"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-31"
hash1 = "a4468c28e4830acf526209c0da25536ff0f682a0239ced1983a08d1ddd476963"
strings:
$s1 = "youtube.com" fullword ascii
$s2 = "amazon.com" fullword ascii
$s3 = "ebay.com" fullword ascii
$s4 = "mymutex" fullword ascii
$s5 = "User-Agent: Mozilla/5.0 (Windows NT " fullword ascii
$s6 = "Accept-language: " fullword ascii
$s7 = "Agent, " fullword wide
$s8 = "TARAT d.o.o.1" fullword ascii
$s9 = "TARAT d.o.o.0" fullword ascii
$s10 = "; Trident/7.0; rv:11.0) like Gecko" fullword ascii
$s11 = ") AppleWebKit/537.36 (KHTML, like Gecko) Chrome/" fullword ascii
$s12 = ".0) Gecko/20100101 Firefox/" fullword ascii
$s13 = " /RL HIGHEST" fullword wide
$s14 = "/CREATE /SC ONSTART" fullword wide
$s15 = "Referer: https://www." fullword ascii
$s16 = "Bapi-ms-win-appmodel-runtime-l1-1-1" fullword wide
$s17 = " Agent" fullword wide
$s18 = "Badvapi32" fullword wide
$s19 = "Ljubljana1" fullword ascii
$s20 = "Mozilla" fullword ascii /* Goodware String - occured 26 times */
condition:
uint16(0) == 0x5a4d and filesize &lt; 800KB and
( pe.imphash() == "ee60dc6086fb4fce34e1e9ff4767a8b8" or 8 of them )
}

rule ryuk3_1007_Firefox {
meta:
description = "files - file Firefox.exe"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-31"
hash1 = "3fc65b7e7967353f340ead51617558a23f14447ab91d974268f53ab0c17052e0"
strings:
$s1 = "youtube.com" fullword ascii
$s2 = "amazon.com" fullword ascii
$s3 = "ebay.com" fullword ascii
$s4 = "mymutex" fullword ascii
$s5 = "User-Agent: Mozilla/5.0 (Windows NT " fullword ascii
$s6 = "Accept-language: " fullword ascii
$s7 = "Agent, " fullword wide
$s8 = "TARAT d.o.o.1" fullword ascii
$s9 = "TARAT d.o.o.0" fullword ascii
$s10 = "; Trident/7.0; rv:11.0) like Gecko" fullword ascii
$s11 = ") AppleWebKit/537.36 (KHTML, like Gecko) Chrome/" fullword ascii
$s12 = ".0) Gecko/20100101 Firefox/" fullword ascii
$s13 = " /RL HIGHEST" fullword wide
$s14 = "/CREATE /SC ONSTART" fullword wide
$s15 = "Referer: https://www." fullword ascii
$s16 = "Bapi-ms-win-appmodel-runtime-l1-1-1" fullword wide
$s17 = " Agent" fullword wide
$s18 = "Badvapi32" fullword wide
$s19 = "Ljubljana1" fullword ascii
$s20 = "Mozilla" fullword ascii /* Goodware String - occured 26 times */
condition:
uint16(0) == 0x5a4d and filesize &lt; 800KB and
( pe.imphash() == "ee60dc6086fb4fce34e1e9ff4767a8b8" or 8 of them )
}

rule ryuk3_1007_PL64 {
meta:
description = "files - file PL64.exe"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-31"
hash1 = "a7514209db9d9c7c51927308d4f0b491464e11391af3c6ae31cb87d91fac995d"
strings:
$s1 = "reindex &lt;command&gt; -? will give you the usage for each command" fullword wide
$s2 = "&lt;requestedExecutionLevel level='asInvoker' uiAccess='false'/&gt;" fullword ascii
$s3 = "AppPolicyGetProcessTerminationMethod" fullword ascii
$s4 = "Usage: %s %s%s" fullword wide
$s5 = "B:\\WindowsSDK7-Samples-master\\WindowsSDK7-Samples-master\\winui\\WindowsSearch\\ReindexMatchingUrls\\x64\\Release\\Reindex.pdb" ascii
$s6 = "Failed to reindex - %s" fullword wide
$s7 = "Supported commands:" fullword wide
$s8 = "SUBCOMMAND" fullword wide
$s9 = "&lt;WHERE_CLAUSE&gt; (EX. reindex where System.ItemNameDisplay = 'test.txt')" fullword wide
$s10 = "No command specified." fullword wide
$s11 = "Command not recognized: %s" fullword wide
$s12 = "Reindexing - %s" fullword wide
$s13 = "Reindexed - %s" fullword wide
$s14 = "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="755b4a34233627101c1b11100d381401161d1c1b12221d100710361914000610361a1818141b1135">[email&#160;protected]</a>@" fullword ascii
$s15 = "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b59b8af4e3f6e7d0dcdbd1d0cde2ddd0c7d0f6d9d4c0c6d0f6dad8d8d4dbd1f5">[email&#160;protected]</a>@" fullword ascii
$s16 = "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="dff1e09e899c92baabbe9cb0b2b2beb1bb9f">[email&#160;protected]</a>@" fullword ascii
$s17 = "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3f11007e697c6d5a56515b5a47725e4b5c575651587256525a6b464f5a7c5052525e515b7f">[email&#160;protected]</a>@" fullword ascii
$s18 = "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f9d7c6b8afbaab9c90979d9c81b4988d9a9190979ebf90959cad80899cba96949498979db9">[email&#160;protected]</a>@" fullword ascii
$s19 = "Unrecognized option: %s%s%s" fullword wide
$s20 = "OnItemsChanged(%s) failed with 0x%x" fullword wide
condition:
uint16(0) == 0x5a4d and filesize &lt; 2000KB and
( pe.imphash() == "102983d1d06c7d80b040d45e9425a96f" or 8 of them )
}

/* Super Rules ------------------------------------------------------------- */

rule ryuk3_1007_pagefilerpqy_Firefox_0 {
meta:
description = "files - from files pagefilerpqy.exe, Firefox.exe"
author = "The DFIR Report"
reference = "https://thedfirreport.com"
date = "2020-10-31"
hash1 = "a4468c28e4830acf526209c0da25536ff0f682a0239ced1983a08d1ddd476963"
hash2 = "3fc65b7e7967353f340ead51617558a23f14447ab91d974268f53ab0c17052e0"
strings:
$s1 = "youtube.com" fullword ascii
$s2 = "amazon.com" fullword ascii
$s3 = "ebay.com" fullword ascii
$s4 = "mymutex" fullword ascii
$s5 = "User-Agent: Mozilla/5.0 (Windows NT " fullword ascii
$s6 = "Accept-language: " fullword ascii
$s7 = "Agent, " fullword wide
$s8 = "TARAT d.o.o.1" fullword ascii
$s9 = "TARAT d.o.o.0" fullword ascii
$s10 = "; Trident/7.0; rv:11.0) like Gecko" fullword ascii
$s11 = ") AppleWebKit/537.36 (KHTML, like Gecko) Chrome/" fullword ascii
$s12 = ".0) Gecko/20100101 Firefox/" fullword ascii
$s13 = " /RL HIGHEST" fullword wide
$s14 = "/CREATE /SC ONSTART" fullword wide
$s15 = "Referer: https://www." fullword ascii
$s16 = "Bapi-ms-win-appmodel-runtime-l1-1-1" fullword wide
$s17 = " Agent" fullword wide
$s18 = "Badvapi32" fullword wide
$s19 = "Ljubljana1" fullword ascii
$s20 = "Mozilla" fullword ascii /* Goodware String - occured 26 times */
condition:
( uint16(0) == 0x5a4d and filesize &lt; 800KB and pe.imphash() == "ee60dc6086fb4fce34e1e9ff4767a8b8" and ( 8 of them )
) or ( all of them )
}</pre>
<h2>MITRE</h2>
<p>Spearphishing Link &#8211; T1566.002<br />
PowerShell &#8211; T1059.001<br />
Command-Line Interface &#8211; T1059<br />
User Execution &#8211; T1204<br />
Process Injection &#8211; T1055<br />
Exploitation for Privilege Escalation &#8211; T1068<br />
Domain Trust Discovery &#8211; T1482<br />
Domain Groups &#8211; T1069.002<br />
Domain Account &#8211; T1087.002<br />
Remote System Discovery &#8211; T1018<br />
SMB/Windows Admin Shares &#8211; T1021.002<br />
Remote Desktop Protocol &#8211; T1021.001<br />
Archive Collected Data &#8211; T1560<br />
Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol &#8211; T1048.003<br />
Standard Application Layer Protocol &#8211; T1071<br />
Commonly Used Port &#8211; T1043<br />
Data Encrypted for Impact &#8211; T1486<br />
Code Signing &#8211; T1553.002<br />
Service Execution &#8211; T1569.002<br />
Scheduled Task &#8211; T1053.005<br />
Registry Run Keys / Startup Folder &#8211; T1547.001<br />
Credential Access &#8211; T1558.003</p>
<h3>Indicators Linked to Threat Actor Group</h3>
<p>UNC 1878 Indicators released by FireEye:</p>
<p><a href="https://gist.github.com/aaronst/6aa7f61246f53a8dd4befea86e832456" target="_blank" rel="noopener noreferrer">https://gist.github.com/aaronst/6aa7f61246f53a8dd4befea86e832456</a></p>
<p>UNC 1878 Indicators from Threatconnect:</p>
<p><a href="https://github.com/ThreatConnect-Inc/research-team/blob/master/IOCs/WizardSpider-UNC1878-Ryuk.csv" target="_blank" rel="noopener noreferrer">https://github.com/ThreatConnect-Inc/research-team/blob/master/IOCs/WizardSpider-UNC1878-Ryuk.csv</a></p>
<h3>Internal Case 1007</h3>
<form id="showGalaxiesForm" accept-charset="utf-8" action="https://misppriv.circl.lu/galaxy_clusters/detach/80743/event/6272" method="post"></form>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-1123" class="share-twitter sd-button share-icon no-text" href="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/?share=twitter" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-1123" class="share-facebook sd-button share-icon no-text" href="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/?share=facebook" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-1123" class="share-linkedin sd-button share-icon no-text" href="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/?share=linkedin" target="_blank" title="Click to share on LinkedIn"><span></span><span class="sharing-screen-reader-text">Click to share on LinkedIn (Opens in new window)</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon no-text" href="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/?share=reddit" target="_blank" title="Click to share on Reddit"><span></span><span class="sharing-screen-reader-text">Click to share on Reddit (Opens in new window)</span></a></li><li class="share-telegram"><a rel="nofollow noopener noreferrer" data-shared="" class="share-telegram sd-button share-icon no-text" href="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/?share=telegram" target="_blank" title="Click to share on Telegram"><span></span><span class="sharing-screen-reader-text">Click to share on Telegram (Opens in new window)</span></a></li><li class="share-skype"><a rel="nofollow noopener noreferrer" data-shared="sharing-skype-1123" class="share-skype sd-button share-icon no-text" href="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/?share=skype" target="_blank" title="Click to share on Skype"><span></span><span class="sharing-screen-reader-text">Click to share on Skype (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts'>
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
</div>
<footer class="entry-footer">
<div class="entry-meta">
<span class="tag-links"><a href="https://thedfirreport.com/tag/bazar/" rel="tag">bazar</a><a href="https://thedfirreport.com/tag/cobalt-strike/" rel="tag">cobalt strike</a><a href="https://thedfirreport.com/tag/kegtap/" rel="tag">kegtap</a><a href="https://thedfirreport.com/tag/ransomware/" rel="tag">ransomware</a><a href="https://thedfirreport.com/tag/ryuk/" rel="tag">ryuk</a></span> </div>
</footer>
</div>
</article>
<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" rel="prev">Ryuk in 5 Hours</a></div><div class="nav-next"><a href="https://thedfirreport.com/2020/11/12/cryptominers-exploiting-weblogic-rce-cve-2020-14882/" rel="next">Cryptominers Exploiting WebLogic RCE CVE-2020-14882</a></div></div>
</nav>
</main>
</div>
<aside id="secondary" class="widget-area">
<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
</label>
<input type="submit" class="search-submit" value="Search" />
</form></section><section id="blog_subscription-2" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title">Subscribe to Blog via Email</h2>
<form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
<div id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
</div> <p id="subscribe-email">
<label id="jetpack-subscribe-label" class="screen-reader-text" for="subscribe-field-blog_subscription-2">
Email Address </label>
<input type="email" name="email" required="required" value="" id="subscribe-field-blog_subscription-2" placeholder="Email Address" />
</p>
<p id="subscribe-submit">
<input type="hidden" name="action" value="subscribe" />
<input type="hidden" name="source" value="https://thedfirreport.com/2020/11/05/ryuk-speed-run-2-hours-to-ransom/" />
<input type="hidden" name="sub-type" value="widget" />
<input type="hidden" name="redirect_fragment" value="blog_subscription-2" />
<button type="submit" name="jetpack_subscriptions_widget">
Subscribe </button>
</p>
</form>
</section><section id="twitter_timeline-3" class="widget widget_twitter_timeline"><h2 class="widget-title">Follow us on Twitter</h2><a class="twitter-timeline" data-width="220" data-theme="light" data-border-color="#e8e8e8" data-tweet-limit="5" data-lang="EN" data-partner="jetpack" data-chrome="noheader nofooter noborders transparent noscrollbar" href="https://twitter.com/@TheDFIRReport" href="https://twitter.com/@TheDFIRReport">My Tweets</a></section><section id="jetpack_display_posts_widget-2" class="widget widget_jetpack_display_posts_widget"><h2 class="widget-title">Recent Posts: The DFIR Report</h2><div class="jetpack-display-remote-posts"><h4><a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" target="_blank" rel="noopener">Ryuk in 5 Hours</a></h4>
<a title="Ryuk in 5 Hours" href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" target="_blank" rel="noopener"><img src="https://i2.wp.com/thedfirreport.com/wp-content/uploads/2020/10/ryuk.png?fit=1093%2C587&ssl=1" alt="Ryuk in 5 Hours" /></a><p>Intro The Ryuk threat actors went from a phishing email to domain wide ransomware in 5 hours. They escalated privileges using Zerologon (CVE-2020-1472), less than 2 hours after the initial &hellip; <a href="https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/" class="more-link">Read More</a></p>
<h4><a href="https://thedfirreport.com/2020/10/08/ryuks-return/" target="_blank" rel="noopener">Ryuk&#8217;s Return</a></h4>
<a title="Ryuk&#8217;s Return" href="https://thedfirreport.com/2020/10/08/ryuks-return/" target="_blank" rel="noopener"><img src="https://i2.wp.com/thedfirreport.com/wp-content/uploads/2020/10/ryuk.png?fit=1093%2C587&ssl=1" alt="Ryuk&#8217;s Return" /></a><p>Intro The Ryuk group went from an email to domain wide ransomware in 29 hours and asked for over $6 million to unlock our systems. They used tools such as &hellip; <a href="https://thedfirreport.com/2020/10/08/ryuks-return/" class="more-link">Read More</a></p>
<h4><a href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" target="_blank" rel="noopener">NetWalker Ransomware in 1 Hour</a></h4>
<a title="NetWalker Ransomware in 1 Hour" href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" target="_blank" rel="noopener"><img src="https://i2.wp.com/thedfirreport.com/wp-content/uploads/2020/08/image-42.png?fit=639%2C709&ssl=1" alt="NetWalker Ransomware in 1 Hour" /></a><p>The threat actor logged in through RDP, attempted to run a Cobalt Strike Beacon, and then dumped memory using ProcDump and Mimikatz. Next, they RDPed into a Domain Controller, minutes &hellip; <a href="https://thedfirreport.com/2020/08/31/netwalker-ransomware-in-1-hour/" class="more-link">Read More</a></p>
<h4><a href="https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/" target="_blank" rel="noopener">Dridex &#8211; From Word to Domain Dominance</a></h4>
<a title="Dridex &#8211; From Word to Domain Dominance" href="https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/" target="_blank" rel="noopener"><img src="https://i1.wp.com/thedfirreport.com/wp-content/uploads/2020/08/timeline.png?fit=544%2C608&ssl=1" alt="Dridex &#8211; From Word to Domain Dominance" /></a><h4><a href="https://thedfirreport.com/2020/07/13/ransomware-again-but-we-changed-the-rdp-port/" target="_blank" rel="noopener">Ransomware Again&#8230;But We Changed the RDP Port!?!?!</a></h4>
<a title="Ransomware Again&#8230;But We Changed the RDP Port!?!?!" href="https://thedfirreport.com/2020/07/13/ransomware-again-but-we-changed-the-rdp-port/" target="_blank" rel="noopener"><img src="https://i1.wp.com/thedfirreport.com/wp-content/uploads/2020/07/image-20.png?fit=1222%2C841&ssl=1" alt="Ransomware Again&#8230;But We Changed the RDP Port!?!?!" /></a><p>Here&#8217;s another example of threat actors brute forcing RDP to install ransomware, this time the brute forced system was not using the default RDP port. The threat actors installed ransomware &hellip; <a href="https://thedfirreport.com/2020/07/13/ransomware-again-but-we-changed-the-rdp-port/" class="more-link">Read More</a></p>
</div></section><section id="google_translate_widget-3" class="widget widget_google_translate_widget"><h2 class="widget-title">Translate</h2><div id="google_translate_element"></div></section></aside>
</div>
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="copyright-area">
<div class="wrap">
<div class="site-info">
<a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Theme: FreeNews <span class="sep"> | </span> By <a href="https://themespiral.com/">ThemeSpiral.com</a>. </div>
<div class="footer-right-info">
</div>
</div>
</div>
</footer>
<button href="#" class="back-to-top" type="button"><i class="fa fa-long-arrow-up"></i>Go Top</button>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2020\/11\/05\/ryuk-speed-run-2-hours-to-ransom\/":1123};
	</script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/dist/vendor/wp-polyfill.min.js' id='wp-polyfill-js'></script>
<script type='text/javascript' id='wp-polyfill-js-after'>
( 'fetch' in window ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-fetch.min.js?ver=3.0.0"></scr' + 'ipt>' );( document.contains ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-node-contains.min.js?ver=3.42.0"></scr' + 'ipt>' );( window.DOMRect ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-dom-rect.min.js?ver=3.42.0"></scr' + 'ipt>' );( window.URL && window.URL.prototype && window.URLSearchParams ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-url.min.js?ver=3.6.4"></scr' + 'ipt>' );( window.FormData && window.FormData.prototype.keys ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-formdata.min.js?ver=3.0.12"></scr' + 'ipt>' );( Element.prototype.matches && Element.prototype.closest ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-element-closest.min.js?ver=2.0.2"></scr' + 'ipt>' );( 'objectFit' in document.documentElement.style ) || document.write( '<script src="https://thedfirreport.com/wp-includes/js/dist/vendor/wp-polyfill-object-fit.min.js?ver=2.3.4"></scr' + 'ipt>' );
</script>
<script type='text/javascript' id='contact-form-7-js-extra'>
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/thedfirreport.com\/wp-json\/","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.4.1' id='contact-form-7-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=5.7.2' id='freenews-navigation-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=5.7.2' id='freenews-skip-link-focus-fix-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=5.7.2' id='ResizeSensor-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=5.7.2' id='theia-sticky-sidebar-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=5.7.2' id='slick-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=5.7.2' id='freenews-slick-settings-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=5.7.2' id='jquery-sticky-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=5.7.2' id='freenews-sticky-settings-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=5.7.2' id='marquee-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=5.7.2' id='freenews-marquee-settings-js'></script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/twitter-timeline.min.js' id='jetpack-twitter-timeline-js'></script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/src/js/intersectionobserver-polyfill.min.js?ver=1.1.2' id='jetpack-lazy-images-polyfill-intersectionobserver-js'></script>
<script type='text/javascript' id='jetpack-lazy-images-js-extra'>
/* <![CDATA[ */
var jetpackLazyImagesL10n = {"loading_warning":"Images are still loading. Please cancel your print and try again."};
/* ]]> */
</script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/src/js/lazy-images.min.js?ver=1.1.2' id='jetpack-lazy-images-js'></script>
<script type='text/javascript' id='wp_slimstat-js-extra'>
/* <![CDATA[ */
var SlimStatParams = {"ajaxurl":"https:\/\/thedfirreport.com\/wp-admin\/admin-ajax.php","baseurl":"\/","dnt":"noslimstat,ab-item","ci":"YTo0OntzOjEyOiJjb250ZW50X3R5cGUiO3M6NDoicG9zdCI7czo4OiJjYXRlZ29yeSI7czoyNzoiMjQsMjcsNiwyLDI1LDI4LDE0LDI5LDMzLDMwIjtzOjEwOiJjb250ZW50X2lkIjtpOjExMjM7czo2OiJhdXRob3IiO3M6NjoiZWRpdG9yIjt9.0c96c437e11e6de66a2029b3787ba94a"};
/* ]]> */
</script>
<script type='text/javascript' src='https://cdn.jsdelivr.net/wp/wp-slimstat/tags/4.8.8.1/wp-slimstat.min.js' id='wp_slimstat-js'></script>
<script type='text/javascript' src='https://www.google.com/recaptcha/api.js?render=6LdT96QZAAAAAPgYNKKHOXJj40TDn4FL6KFdhViu&#038;ver=3.0' id='google-recaptcha-js'></script>
<script type='text/javascript' id='wpcf7-recaptcha-js-extra'>
/* <![CDATA[ */
var wpcf7_recaptcha = {"sitekey":"6LdT96QZAAAAAPgYNKKHOXJj40TDn4FL6KFdhViu","actions":{"homepage":"homepage","contactform":"contactform"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://thedfirreport.com/wp-content/plugins/contact-form-7/modules/recaptcha/index.js?ver=5.4.1' id='wpcf7-recaptcha-js'></script>
<script type='text/javascript' src='https://c0.wp.com/c/5.7.2/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>
<script type='text/javascript' id='google-translate-init-js-extra'>
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/widgets/google-translate/google-translate.min.js' id='google-translate-init-js'></script>
<script type='text/javascript' src='//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&#038;ver=5.7.2' id='google-translate-js'></script>
<script type='text/javascript' id='sharing-js-js-extra'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://c0.wp.com/p/jetpack/9.7/_inc/build/sharedaddy/sharing.min.js' id='sharing-js-js'></script>
<script type='text/javascript' id='sharing-js-js-after'>
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-telegram' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-telegram' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtelegram', 'menubar=1,resizable=1,width=450,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-skype' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-skype' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomskype', 'menubar=1,resizable=1,width=305,height=665' );
						return false;
					}
				} );
			} )();
</script>
<script src='https://stats.wp.com/e-202120.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'175340963',post:'1123',tz:'0',srv:'thedfirreport.com'} ]);
	_stq.push([ 'clickTrackerInit', '175340963', '1123' ]);
</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"653a9082beac1d73","version":"2021.5.1","r":1,"token":"e6611380fbbe475a97dc9cf0a0e9fd2b","si":10}'></script>
</body>
</html>
