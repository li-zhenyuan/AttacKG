
<!DOCTYPE html>
<html>
<head>

<script>
    var companyDetails6Sense = localStorage.getItem('_6senseCompanyDetails');

    if(null != companyDetails6Sense || companyDetails6Sense != "" || companyDetails6Sense != undefined){
		var jsonVal = JSON.parse(companyDetails6Sense);

        var companyRevenueRange = jsonVal.company.revenue_range;
        var companyCountry = jsonVal.company.country;
        var companyIndustry = jsonVal.company.industry;
        var companyName = jsonVal.company.name;
        var companyRegion = jsonVal.company.region;
        var companyDomain = jsonVal.company.domain;
    	var segments = JSON.stringify(jsonVal.segments);
    	
        window.dataLayer=window.dataLayer ||[];
        window.dataLayer.push({
                "company_industry" : companyIndustry,
                "company_name" : companyName,
                "company_revenue" : companyRevenueRange,
                "company_country" : companyCountry,
                "company_region" : companyRegion,
            	"company_domain" : companyDomain,
            	"segments" : segments
        });
    }

</script>

<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{"GTM-5ZX7QTZ":true});</script>

<title>WannaCry Malware Profile | FireEye Inc</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="alternate" type="application/atom+xml" title="Atom Feed for &#39;WannaCry Malware Profile&#39;" href="/content/fireeye-www/en_US/blog/threat-research/2017/05/wannacry-malware-profile/_jcr_content.feed">
<link rel="canonical" href="https://www.fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html">
<meta name="language" content="en">
<meta name="locale" content="en_US">
<meta http-equiv="cleartype" content="on">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="description" content="See our full WannaCry (also known as WCry or WanaCryptor) malware profile, including in-depth file characteristics and MD5 hashes.
">

<meta itemprop="name" content="WannaCry Malware Profile">
<meta itemprop="description" content="See our full WannaCry (also known as WCry or WanaCryptor) malware profile, including in-depth file characteristics and MD5 hashes.
">
<meta itemprop="image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta name="twitter:site" content="@FireEye">
<meta name="twitter:title" content="WannaCry Malware Profile">
<meta name="twitter:description" content="See our full WannaCry (also known as WCry or WanaCryptor) malware profile, including in-depth file characteristics and MD5 hashes.
">
<meta name="twitter:creator" content="@FireEye">
<meta name="twitter:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">

<meta property="og:title" content="WannaCry Malware Profile">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html">
<meta property="og:image" content="https://www.fireeye.com/content/dam/fireeye-www/fw/images/fireeye-2-color-square.png">
<meta property="og:description" content="See our full WannaCry (also known as WCry or WanaCryptor) malware profile, including in-depth file characteristics and MD5 hashes.
">
<meta property="og:site_name" content="FireEye">
<meta property="fb:admins" content="45127269202">
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>

<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MVGC8KK');</script>


<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite/csrf.min.js"></script>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_nav.min.js"></script>
<script type="text/javascript">
var cookiesOK = $.cookie("ec-privacy");
var fdc =fdc || {};
var onAccept = function () {
	$.cookie("ec-privacy", "accept", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var onDecline = function () {
	$.cookie("ec-privacy", "decline", { path: "/", expires: 365 });
	jQuery("#cookie-privacy-banner").hide();
};

var ipLocation = (function () {
	var banner ="#cookie-privacy-banner";

	/* Show the privacy notification banner. */
	var showBanner = function (banner) {
		jQuery(banner).show();
	};

	/* Suppress the privacy notification banner. */
	var hideBanner = function (banner) {
		jQuery(banner).hide();
	};

	/* These are the country codes for the countries subject to EC privacy laws.
	 * We will check to see if a visitor is coming from one of these countries.
	 * If they are, we display a privacy notification banner. If not, we
	 * do nothing. */
	var countries = {
		"AT": true,"BE": true,"BG": true,"HR": true,"CY": true,"CZ": true,"DK": true,
		"EE": true,"FI": true,"FR": true,"DE": true,"GR": true,"HU": true,"IE": true,
		"IT": true,"LV": true,"LT": true,"LU": true,"MT": true,"NL": true,"PL": true,
		"PT": true,"RO": true,"SK": true,"SI": true,"ES": true,"SE": true,"GB": true
	};
	var defaultSite = "US";

	var onSuccess = function (geoipResponse) {
		fdc.geoipresponse=geoipResponse;
		/* There's no guarantee that a successful response object
		 * has any particular property, so we need to code defensively. */
		if (!geoipResponse.country.iso_code) {
			hideBanner(banner);
			return;
		}
		//
		if (location.host.indexOf("stage") >= 0 && geoipResponse.country.iso_code === "SG") {
            geoipResponse.country.iso_code = "ES"
        }
		/* ISO country codes are in upper case. */
		var code = geoipResponse.country.iso_code;
			
		
		if ((countries[code]) && (cookiesOK == undefined)) {
			showBanner(banner);
		}
		else {
			hideBanner(banner);
		}
	};

	/* We don't really care what the error is. */
	var onError = function (error) {
		hideBanner(banner);
	};

	return function () {
		geoip2.country( onSuccess, onError );
	};
}());
ipLocation();
</script>
<div class="htmlpassthru_836d htmlpassthru">

<script type="text/javascript">
    if (!String.prototype.includes) {
        String.prototype.includes = function() {
            return String.prototype.indexOf.apply(this, arguments) !== -1;
        };
    }
var userAgent = navigator.userAgent,
gomezAgent = userAgent.includes("GomezAgent"),
prtgAgent = userAgent.includes("PRTG Network Monitor");

if (gomezAgent || prtgAgent) {
    cookiesOK = "decline";
}

if (cookiesOK != "decline") {
    // Google Analytics was here. Now it's in Tealium and GTM.
}
// Temporary patch for AA issue.
if(typeof _satellite == "undefined") {
    _satellite = {};
    _satellite.track = function(){};
}
</script>
<style>
@media ( max-width : 959px) {
    .g04 .megamenu .n03-sub_table .n03-sub_cell, .g04 .megamenu .separator {
        display: block;
    }
    .g04 .megamenu .n03_list-item-sub>.megamenu-cta {
        padding: 0;
    }
    .g04 .megamenu .n03-sub_cell.n03-sub_cell-utility {
        padding: 11px 0 11px 10px;
    }
}

@media ( min-width : 48em) {
    .cta-bar .n01 .n01_cell {
        width: auto;
    }
}

/* styles for the CTA bar test */
.n01.n01v1 .n01_cell {
    background-color: #222;
    border: 1px solid #444;
}

.n01.n01v1 .n01_cell .ficon, .n01.n01v1 .n01_cell .n01_label, .n01.n01v1 .n01_text
    {
    color: #fff;
}

@media ( min-width : 48em) {
    .n01.n01v1 .n01_cell {
        background-color: transparent;
        border: none;
    }
    .n01.n01v1 .n01_link {
        background-color: #222;
        border: 1px solid #444;
        border-right: 0;
    }
}
/* fix for new footer */
.g03v1 .g03-s-i:after {
    left: -3px;
}
/* fix for tables */
span.nowrap {
    white-space: nowrap;
}
/* fix for blog cta */
.blog-cta {
    border: 1px solid #dadadb;
    background-color: #ebebed;
    margin-bottom: 10px;
    line-height: 0;
}
</style>
<link rel="stylesheet" type="text/css" href="https://cloud.typography.com/6746836/6977592/css/fonts.css" />
<link rel="stylesheet" type="text/css" href="/content/dam/fireeye-www/fw/css/patch.css?v=1" />
<script type="text/javascript">
var addthis_config = addthis_config||{};
    addthis_config.data_track_clickback = false;
var addthis_share = {
   url: window.location.href
};
</script>
<style>
/* fix for IE */
.uc-he01v1 .uc-he01_container .background {
    max-height: 470px;
    position: absolute;
}
.uc-he01v2 .uc-he01_container .background {
    position: absolute;
}
@media (max-width: 48em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 320px;
    }
}
@media (min-width: 54em) {
    .uc-he01v1 .uc-he01_container .background {
        max-height: 600px;
    }
}
</style>
<style>
/* Update the images used in the Table component. */
.c09v1 .tablesorter-default .header, .c09v1 .tablesorter-default .tablesorter-header {
background-position-x: calc(100% - 4px);
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjc2NDE0RUUyNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc2NDE0RUUzNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkY2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI1MDA2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz567IGQAAAApklEQVR42mL8//8/A0kApAELlgJiG2xyTDjMcQFiayDmRJfApkEbiJWgiq2J0eCCxLYBYkF8GjAUAIEvLg2C2JwAdZ42Ng022DyJ7kwmJFOM8YS+INRABkZSI45sDSAnxRFQuweIj8D8cA+Iz+JR/B6kGD2UQALf8ZiOEawgU45iUQyy/SqumD4C1YgMNhNKS3vwGYBNw1WoM75jdSKpGYjkiAMIMAAPu279CuYueAAAAABJRU5ErkJggg==)
}
.c09v1 .tablesorter-default thead .headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerSortUp,.c09v1 .tablesorter-default thead .tablesorter-headerAsc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEY5Njc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZBNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0Rjc2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0Rjg2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5TuQesAAAAp0lEQVR42mL8//8/A0kApAELNgbicmxyuDTsBuJ3QCxIjIbQ/wjQQYyGu/9RgRI+DeX/McFuXBqUoO7GBkKxaZj5Hze4i67B5T9hAA5mRlIjjmwNSkAcR0DtHiA+wgTl3APis3gUvwcpBjGYkARBAt/xmM6ArgFkylEsikG2X8WmAWbLezSxzcgcJnzWYzMAm4arUGd8x+pEHPlBCohtsMmRHHEAAQYAbP+KkOIl8zUAAAAASUVORK5CYII=)}
.c09v1 .tablesorter-default thead .headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerSortDown,.c09v1 .tablesorter-default thead .tablesorter-headerDesc{background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAUCAYAAAC58NwRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggTWFjaW50b3NoIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU4OTMyNEZENjc2QjExRThBNEFDQTFFRUMyNzIyRjM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU4OTMyNEZFNjc2QjExRThBNEFDQTFFRUMyNzIyRjM4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTg5MzI0RkI2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTg5MzI0RkM2NzZCMTFFOEE0QUNBMUVFQzI3MjJGMzgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6nOhWUAAAAqElEQVR42mL8//8/AymACYe4FBDbkKLBBYitgZiTGA3aQKwEVWxNjAYXJDbIWYL4NGAoAAJfXBoEsTkB6jxtbBpssHkS3ZlMSKYY4wl+QVgwM1Ir4ghqALnxPwFcDlYJchIUz/yPG9yFqUPWoATE73BoCMWmAYTLsSjejawGXQMD1HpkoERIQyiS4g50eWwaGKDOAPlHEF2OBUdwV0CD+j26BMkxDRBgALvSCpUQlZEGAAAAAElFTkSuQmCC)}
.c09v1 .tablesorter-default thead .sorter-false {
    background-image: none;
}
@media (max-width: 41.9125em){
    .c09.c09v1.has-data-label tr>:not(:first-child):before {
        width: auto; min-width: 35%;
    }
}
</style>
<script>
$(document).ready(function(){
    if(typeof(ipLocation) !== "undefined" && typeof fdc.geoipResponse === "undefined"){ipLocation();}
    if(typeof fdc.geoipResponse !== "undefined"){showCountryNotification(fdc.geoipResponse);}
    if(typeof fdc.geoipResponse !== "undefined" && typeof fdc.geoipResponse.country !== "undefined" && fdc.geoipResponse.country.is_in_european_union && ($.cookie("ec-privacy") == undefined)){jQuery("#cookie-privacy-banner").show();}
});
function showCountryNotification(geoipResponse) {
	if (!geoipResponse.country || !geoipResponse.country.iso_code) {
        return;
    }
	var code = geoipResponse.country.iso_code,
	    langIndex = code === "FR" ? 2 : code === "DE" ? 3 : code === "JP" ? 4 : code === "KR" ? 5 : 1;
	if (langIndex > 1) {
		$('.c08_modal.lang').addClass("is-open");
		$('.c08_modal.lang .col:nth-child(' + (langIndex - 1) + ')').show();
		$('.c08_modal.lang, .c08_modal.lang [data-behavior="dismiss-c08"]').click(function(){
		    $.cookie("country-notification", "decline", { path: "/", expires: 365 });
		    closec08();
		});
		$('.c08_modal.lang .c08').click(function(e){
		    e.stopPropagation();
		});
		if (($.cookie("country-notification") === "decline") || $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href").indexOf(".html") < 0) {
		    closec08();
		} else {
		    $(".c08_modal.lang .btn").eq(langIndex - 2).attr("href", $(".g01_options_list li:nth-child(" + langIndex + ") a").attr("href"));
		}
	}
}
</script>
<script>    
     var _6SenseJsonObj = localStorage.getItem('_6senseCompanyDetails'),
         _6SenseTime = localStorage.getItem('_6senseCompanyDetails-timestamp'),
         isJsonStale = _6SenseTime === null ? true : Date.now() - parseInt(_6SenseTime) > 86400000; // 86400000 = 1 day in ms
     
     window._6si = window._6si || [];
     window._6si.push(['enableEventTracking', true]);
     window._6si.push(['setToken', '1322340356018696d853e0ac6f7ce3a2']);
     window._6si.push(['setEndpoint', 'b.6sc.co']);
     if(_6SenseJsonObj === null || isJsonStale){
       window._6si.push(['enableCompanyDetails', true]);
       window._6si.push(['setEpsilonKey', '325d6d60e24c7cfc3a782839d85ce08c8d3bb27c']);
       localStorage.setItem('_6senseCompanyDetails-timestamp', Date.now());
     }  
    (function () {
          var gd = document.createElement('script');
      gd.type = 'text/javascript';
      gd.async = true;
      gd.src = '//j.6sc.co/6si.min.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gd, s);
     })();
</script>
<script>
    var jsonObj;

    function targetPageParams() { 
        jsonObj = localStorage.getItem('_6senseCompanyDetails');
        if(jsonObj) {
        	var jsonVal = JSON.parse(jsonObj);
            return { 
                "companyRevenueRange": jsonVal.company.revenue_range, 
                "companyCountry": jsonVal.company.country, 
                "companyIndustry": jsonVal.company.industry,
                "companyName": jsonVal.company.name,
                "companyRegion": jsonVal.company.region,
                "companyDomain": jsonVal.company.domain,
                "segments": JSON.stringify(jsonVal.segments)
            }; 
        }
     }; 
</script>
<script>
$(document).ready(function(){
    $(".loadmore").on("click", function(){$(".list.parbase").addClass("no-max-height");});
    // Don't show title text for textures.
    $(".texture img").attr("title", "");
});
</script>
<style>
.no-max-height .c11v9 h4{
    max-height: none !important;
}
.g04 #header-search .search-field_submit:after {
    font-size: 9px;
}
.c11v8.hideLinkText .btn {
    display: inline-block;
}
/* CTA fix */
.g04 .megamenu-tab .has-inner-cta .n03-sub_container {
    padding: 0;
    margin: 0 0 0 10px;
    max-width: 1210px;
}
.g04 .megamenu-tab .has-inner-cta .col-wrap {
    padding: 40px 0;
}
.g04 .n03-sub_container[data-columns="1"] .megamenu-cta {
    width: 50%;
}
.g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
    width: 33.9%;
}
.g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell {
    width: calc(50% - 60px);
}
.g04 .n03-sub_container[data-columns="3"] .megamenu-cta {
    width: 25%;
}
.g04 .n03-sub_container[data-columns="4"] .megamenu-cta {
    width: 20%;
}
.g04 .megamenu-cta h5 {
    line-height: 1.4;
}
html .g04 header .megamenu-cta h5 {
    font-weight: 500;
    font-size: 15px;
    color: #44474d;
}
html .g04 header .megamenu-cta p {
    font-weight: 300;
    color: #44474d;
}
.g04 .n03-sub_table > .megamenu-cta {
    background: none;
    padding: 0;
}
.g04 .megamenu-cta .n03_utility {
    border: none;
    height: 100%;
}
.g04 .megamenu-cta .n03_utility_cell {
    display: block;
    width: auto;
    margin-left: 30px;
}
/* Un/re-comment to add/remove in the line to the left of the CTA in the megamenu. */
.g04 .n03-sub_table .col-wrap:not(:last-child) .separator.disabled {
    border-right-color: #ebebed;
}

/* Put a grid over the texture from a neighboring grid. */
.force {
    z-index: 15;
    position: relative;
}
/* Remove the gradient above the tiles on blog pages and reduce the space there. */
.iparsys + .l_container>div.gradient-top {
    background-image: none;
}
.iparsys + .l_container>.gradient-top>div>.g {
    padding: 0;
}
@media (min-width: 35em) {
    .entries .highlightFirst .c11v9 .c11-image-div {
        border-left: 1px solid #dadadb;
        border-right: 1px solid #dadadb;
    }
}
@media (max-width: 1024px) {
    .uc-he01v2 .panel .asset .image img {
        max-height: 200px;
	max-width: 300px;
    }
}
/* mobile view for MegaMenu CTA. */
@media (max-width: 1024px) {
    .g04 .megamenu-tab.open .n03_list-item-sub.has-inner-cta {
        padding-bottom: 0;
    }
    .g04 .has-inner-cta > [data-columns="2"] .n03-sub_cell,
    .g04 .n03-sub_container[data-columns="2"] .megamenu-cta {
        width: 100%;
        display: block;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container {
        margin: 0;
    }
    .g04 .megamenu-tab .has-inner-cta .n03-sub_container .col-wrap {
        padding: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell {
        margin-left: 15px;
        margin-right: 22px;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(1) {
        padding-bottom: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell:nth-child(2) {
        padding-top: 0;
    }
    .g04 .megamenu-cta .n03_utility_cell h5,
    .g04 .megamenu-cta .n03_utility_cell p {
        font-size: 12px;
    }
    .content-2-par .megamenus .n03-sub_table .megamenu-cta {
        border-radius: 0;
    }
}
/* Training pages side design. */
  .training-side-box {background: url('/content/dam/fireeye-www/brand/homepage-banner-images/hpb-bg-testimonial-red.jpg') left no-repeat; background-size: cover; padding:30px; border: 1px solid #dadadb; margin-bottom: 20px;}
  .training-side-text {color: #ffffff;}
  .training-side-text a:hover {color: #ffffff; text-decoration: underline;}

/* Avoid column breaks in ordered lists. */
  .c00 ol > li {page-break-inside: avoid; margin-bottom: 15px;}

/* Safari needs this on html to stop side scrolling, not just on the body. */
html {overflow-x:hidden;}
/* Make sure the footer is above a texture that precedes it. */
#g03-footer {z-index: 725;}
/* Allow border for linked images. */
.border>a>img {border: 1px solid #dadadb;}
/* Allows for easy scrollable text boxes on blog pages right in the Blog Text component. */
table.limitedHeight td {
    height: 350px;
    display: block;
    overflow-y: scroll;
    overflow-x: hidden;
    padding-bottom: 0;
}
/* Fix for edge case in Safari where page title in breadcrumbs wraps when the title is just the right length. */
.g02_list_item:last-child span {
    min-width: 360px;
    display: block;
}
/* fix issue of hidden Event Spotlights having margin when used with .row-count-2 */
.parsys > .spotlight-event.section:empty {
    display: none;
}
@media (min-width: 60em) {
.row-count-2 .parsys>div:nth-child(even):not(:empty) {
    margin-right: 40px;
}
}
</style></div>

<link rel="stylesheet" href="/etc/designs/fireeye-www/clientlibs_fw-2019.min.css" type="text/css">
<link rel="stylesheet" href="/etc/clientlibs/fireeye-blog/clientlibs_base.min.css" type="text/css">
<link rel="icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/content/dam/fireeye-www/brand/logos/fireeye.ico">
</head>

<body itemscope itemtype="http://schema.org/WebPage" data-redesign="redesign-2019"><script type="text/javascript">window.Granite = window.Granite || {}; window.Granite.csrf = true;</script>


<div class="clientcontext parbase"><script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/utils.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/jquery/granite.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/jquery.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/foundation/clientlibs/shared.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/clientlibs/granite/lodash/modern.min.js"></script>
<script type="text/javascript" src="/etc.clientlibs/cq/personalization/clientlib/personalization/kernel.min.js"></script>
<script type="text/javascript">
    $CQ(function() {
        CQ_Analytics.SegmentMgr.loadSegments("\/etc\/segmentation");
        CQ_Analytics.ClientContextUtils.init("\/etc\/clientcontext\/default", "\/content\/fireeye\u002Dwww\/en_US\/blog\/threat\u002Dresearch\/2017\/05\/wannacry\u002Dmalware\u002Dprofile");

        
    });
</script>
</div>


<div class="masthead_v2 masthead-v2">
<div class="g04 masthead g04v1">


<div class="bottom-bar">
<div class="tab">
<span class="ficon ficon-warning"></span>
<p><a class="contact_bar" href="/company/incident-response.html">Report an Incident</a></p>
</div>
<div class="tab">
<span class="ficon ficon-phone2"></span>
<p><a class="contact_bar" href="/company/contact-us.html">Contact Us</a></p>
</div>
</div>
<div class="cta-bar">
<div class="content-well">
<ul>
<li>
<a class="contact_bar" href="/company/contact-us.html">
<span class="g04_label">Contact Us</span><span class="g04_icon"><span class="ficon ficon-phone3"></span></span>
</a>
</li>
<li style="display: none;" id="liveagent_button_online_573a00000008kP3">
<a class="contact_bar" href="javascript://Chat" onclick="liveagent.startChat('573a00000008kP3')">
<span class="g04_label">Chat with an Expert</span><span class="g04_icon"><span class="ficon ficon-chat"></span></span>
</a>
</li>
<li class="red">
<a class="contact_bar" href="/company/incident-response.html">
<span class="g04_label">Report an Incident</span><span class="g04_icon"><span class="ficon ficon-incident"></span></span>
</a>
</li>
</ul>
</div>
</div>

<script type="text/javascript">
    if (!window._laq) { window._laq = []; }
    window._laq.push(function(){
    	liveagent.showWhenOnline('573a00000008kP3', document.getElementById('liveagent_button_online_573a00000008kP3'));
    });
</script>
<script type="text/javascript" src="https://c.la2c2.salesforceliveagent.com/content/g/js/34.0/deployment.js"></script>
<script type="text/javascript">
    liveagent.init("https://d.la2c2.salesforceliveagent.com/chat", "572a0000000H8aJ", "00D3000000063LS");
</script><header role="banner" itemscope itemtype="http://schema.org/WPHeader">
<div class="language-and-search"> <div class="search">
<div class="content-searchbox searchbox">
<a class="g01_options-option option-search" href="#header-search" data-for="q" data-behavior="showHeaderMenu focusField">Search</a>
<div class="option-menu option-menu_search" id="header-search">
<form method="get" action="/search.html">
<fieldset class="search-field" title="Search FireEye.com">
<label class="search-field_label" for="q">Search FireEye.com</label>
<input class="input-text search-field_text" type="text" name="q" id="q" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-locale="en_US" placeholder="Search FireEye.com">
<div id="searchboxsuggestions"></div>
<button class="btn btn-secondary search-field_submit" type="submit">Go</button>
</fieldset>
</form>
</div>
</div>
</div>
</div>
<div class="logo-and-megamenu">
<div class="logo" itemscope itemtype="https://schema.org/Brand">
<a href="https://www.fireeye.com"><img src="/content/dam/fireeye-www/fw/images/fe-logo-color.svg" alt="FireEye" itemprop="logo" class="fireeye" /></a>
</div>
<nav class="megamenu">
<ul><li class="megamenu-tab" data-curry="/blog.html" data-link="/products.html">
<h4 class="megamenu-title">
<a href="/products.html" itemprop="url" class="MegaMenus">Products</a>
</h4>
<div class="content-0-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Enterprise Security</h4><ul><li itemprop="url"><a href="/products/helix.html" itemprop="name" class="MegaMenus">Helix Security Platform</a></li>
<li itemprop="url"><a href="/products/network-security.html" itemprop="name" class="MegaMenus">Network Security and Forensics</a></li>
<li itemprop="url"><a href="/products/endpoint-security.html" itemprop="name" class="MegaMenus">Endpoint Security</a></li>
<li itemprop="url"><a href="/products/email-security.html" itemprop="name" class="MegaMenus">Email Security</a></li>
<li itemprop="url"><a href="/products/cloudvisory.html" itemprop="name" class="MegaMenus">Cloudvisory</a></li>
<li itemprop="url"><a href="/products/detection-on-demand.html" itemprop="name" class="MegaMenus">Detection On Demand</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Security For:</h4><ul><li itemprop="url"><a href="/products/cloud-security.html" itemprop="name" class="MegaMenus">Cloud</a></li>
<li itemprop="url"><a href="/products/financial-services.html" itemprop="name" class="MegaMenus">Financial Services</a></li>
<li itemprop="url"><a href="/products/government.html" itemprop="name" class="MegaMenus">Government</a></li>
<li itemprop="url"><a href="/products/healthcare.html" itemprop="name" class="MegaMenus">Healthcare</a></li>
<li itemprop="url"><a href="/products/industrial-systems-and-critical-infrastructure-security.html" itemprop="name" class="MegaMenus">Industrial &amp; Critical Infrastructure</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  @media (max-width: 1024px) {
    .megamenu-tab .parsys .megamenus .megamenu-cta {
      display: none;
    }
  }
  .content-0-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-customers.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;
  }
  .content-0-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}
</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Customer Stories</h5>
<p>Explore some of the companies who are succeeding with&nbsp;FireEye.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/customers.html" id="learn-more-intel">Read the Stories</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
<div class="view-all-bar">
<a href="/products.html" class="MegaMenus">
VIEW ALL PRODUCTS</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/mandiant.html">
<h4 class="megamenu-title">
<a href="/mandiant.html" itemprop="url" class="MegaMenus">Mandiant</a>
</h4>
<div class="content-1-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub ">
<div class="n03-sub_container" data-columns="3">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title" itemprop="url"><a href="/mandiant/advantage.html" itemprop="name" class="MegaMenus">Mandiant Advantage</a></h4><ul><li itemprop="url"><a href="/mandiant/automated-defense.html" itemprop="name" class="MegaMenus">Automated Defense</a></li>
<li itemprop="url"><a href="/mandiant/security-validation.html" itemprop="name" class="MegaMenus">Security Validation</a></li>
<li itemprop="url"><a href="/mandiant/threat-intelligence.html" itemprop="name" class="MegaMenus">Threat Intelligence</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title" itemprop="url"><a href="/mandiant/cyber-security-consulting.html" itemprop="name" class="MegaMenus">Mandiant Consulting</a></h4><ul><li itemprop="url"><a href="/mandiant/incident-response.html" itemprop="name" class="MegaMenus">Incident Response</a></li>
<li itemprop="url"><a href="/mandiant/cyber-security-consulting.html" itemprop="name" class="MegaMenus">Cyber Security Consulting</a></li>
<li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Cyber Security Training</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-1-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-mandiant.jpg) center no-repeat;
    background-size: cover;
    background-position: bottom;
    border-radius: 60px 0 0 60px;
    border: 0 solid #ffffff;}
  .content-1-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Mandiant Managed Offerings</h4><ul><li itemprop="url"><a href="/mandiant/managed-detection-and-response.html" itemprop="name" class="MegaMenus">Managed Defense</a></li>
<li itemprop="url"><a href="/mandiant/expertise-on-demand.html" itemprop="name" class="MegaMenus">Expertise on Demand</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div></div>
</div>
<div class="view-all-bar">
<a href="/mandiant.html" class="MegaMenus">
VIEW ALL Mandiant</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/customers.html">
<h4 class="megamenu-title">
<a href="/company/customers.html" itemprop="url" class="MegaMenus">Customers</a>
</h4>
<div class="content-2-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Customers</h4><ul><li itemprop="url"><a href="/customers.html" itemprop="name" class="MegaMenus">Customer Stories</a></li>
<li itemprop="url"><a href="/company/customers.html" itemprop="name" class="MegaMenus">Customer Success</a></li>
<li itemprop="url"><a href="https://fireeyecommunity.force.com/CustomerCommunity/s/" target="_blank" itemprop="name" class="MegaMenus">Customer Portal</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Get Support</h4><ul><li itemprop="url"><a href="/support/contacts.html" itemprop="name" class="MegaMenus">Contact Support</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Find Answers</h4><ul><li itemprop="url"><a href="/support/programs.html" itemprop="name" class="MegaMenus">Support Programs</a></li>
<li itemprop="url"><a href="/support/notices.html" itemprop="name" class="MegaMenus">Support Notices</a></li>
<li itemprop="url"><a href="/support/products.html" itemprop="name" class="MegaMenus">Supported Products</a></li>
<li itemprop="url"><a href="https://community.fireeye.com/s/support-community" target="_blank" itemprop="name" class="MegaMenus">Communities</a></li>
<li itemprop="url"><a href="https://docs.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Documentation Portal</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-2-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-support.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-2-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Support</h5>
<p>A global network of support experts available 24x7. We offer simple and flexible support programs to maximize the value of your FireEye products and services.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-2E5799 compact" href="/support.html">Get Support</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/partners.html">
<h4 class="megamenu-title">
<a href="/partners.html" itemprop="url" class="MegaMenus">Partners</a>
</h4>
<div class="content-3-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Partners</h4><ul><li itemprop="url"><a href="/partners.html" itemprop="name" class="MegaMenus">Partners Overview</a></li>
<li itemprop="url"><a href="/partners/resellers.html" itemprop="name" class="MegaMenus">FireEye Affinity Resellers</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners.html" itemprop="name" class="MegaMenus">Technology Partners</a></li>
<li itemprop="url"><a href="/partners/strategic-technology-partners/cyber-risk-insurance.html" itemprop="name" class="MegaMenus">Cyber Risk Partners</a></li>
<li itemprop="url"><a href="/partners/global-solution-providers.html" itemprop="name" class="MegaMenus">Global Solution Providers</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Partner Resources</h4><ul><li itemprop="url"><a href="https://partners.fireeye.com/directory/" target="_blank" itemprop="name" class="MegaMenus">Partner Locator</a></li>
<li itemprop="url"><a href="http://training.fireeye.com/" target="_blank" itemprop="name" class="MegaMenus">Partner Education Center</a></li>
<li itemprop="url"><a href="/support.html" itemprop="name" class="MegaMenus">Support</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Partnering with FireEye</h4><ul><li itemprop="url"><a href="https://www2.fireeye.com/Partner-Request-LP-New.html" target="_blank" itemprop="name" class="MegaMenus">Become a Partner</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-3-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-partners.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-3-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>Partner Portal</h5>
<p>Access for our registered Partners to help you be successful with FireEye.
Collateral, deal registration, request for funds, training, enablement, and more.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-F99B1C compact mm-cta" href="https://partners.fireeye.com/" target="_blank">Partner Portal</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/current-threats.html">
<h4 class="megamenu-title">
<a href="/current-threats.html" itemprop="url" class="MegaMenus">Resources</a>
</h4>
<div class="content-4-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub " id="mandiant-mega-menu">
<div class="n03-sub_container" data-columns="3">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Intelligence Briefings and Bulletins</h4><ul><li itemprop="url"><a href="/current-threats/annual-threat-report.html" itemprop="name" class="MegaMenus">Annual Threat Reports</a></li>
<li itemprop="url"><a href="/current-threats/threat-intelligence-reports.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports</a></li>
<li itemprop="url"><a href="/current-threats/reports-by-industry.html" itemprop="name" class="MegaMenus">Threat Intelligence Reports by Industry</a></li>
<li itemprop="url"><a href="/current-threats/apt-groups.html" itemprop="name" class="MegaMenus">APT Groups</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">FireEye Blogs</h4><ul><li itemprop="url"><a href="/blog.html" itemprop="name" class="MegaMenus">Read the FireEye Blogs</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Cyber Security</h4><ul><li itemprop="url"><a href="/current-threats/what-is-cyber-security.html" itemprop="name" class="MegaMenus">What is Cyber Security?</a></li>
<li itemprop="url"><a href="/campaigns/security-effectiveness.html" itemprop="name" class="MegaMenus">Security Effectiveness and Validation</a></li>
<li itemprop="url"><a href="/campaigns/automated-defense.html" itemprop="name" class="MegaMenus">Simplify Security Operations</a></li>
<li itemprop="url"><a href="https://vision.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">The Vision – Digital Magazine</a></li>
<li itemprop="url"><a href="/company/webinars.html" itemprop="name" class="MegaMenus">Webinars</a></li>
</ul></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">Free Tools & Apps</h4><ul><li itemprop="url"><a href="/services/freeware.html" itemprop="name" class="MegaMenus">Free Software Downloads</a></li>
<li itemprop="url"><a href="https://fireeye.market" target="_blank" itemprop="name" class="MegaMenus">FireEye Market</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Training</h4><ul><li itemprop="url"><a href="/services/training.html" itemprop="name" class="MegaMenus">Education and Training</a></li>
</ul></div>
</div>
</div><div class="separator disabled"></div></div></div>
</div>
<div class="view-all-bar">
<a href="/current-threats.html" class="MegaMenus">
VIEW ALL RESOURCES</a>
</div></div>
</div>
</div>
</li><li class="megamenu-tab" data-curry="/blog.html" data-link="/company.html">
<h4 class="megamenu-title">
<a href="/company.html" itemprop="url" class="MegaMenus">Company</a>
</h4>
<div class="content-5-par parsys"><div class="megamenus section">

<div class="n03_list-item-sub has-inner-cta ">
<div class="n03-sub_container" data-columns="2">
<div class="n03-sub_table">
<div class="col-wrap">
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">About Us</h4><ul><li itemprop="url"><a href="/company.html" itemprop="name" class="MegaMenus">Why FireEye?</a></li>
<li itemprop="url"><a href="/company/awards.html" itemprop="name" class="MegaMenus">Awards and Honors</a></li>
<li itemprop="url"><a href="/company/leadership.html" itemprop="name" class="MegaMenus">Leadership</a></li>
<li itemprop="url"><a href="/company/board-of-directors.html" itemprop="name" class="MegaMenus">Board of Directors</a></li>
<li itemprop="url"><a href="http://investors.fireeye.com" target="_blank" itemprop="name" class="MegaMenus">Investor Relations</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Contact</h4><ul><li itemprop="url"><a href="/company/contact-us.html" itemprop="name" class="MegaMenus">Contact FireEye</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>.g04 .megamenu-list a{padding-right:38px;line-height:1.358;padding-bottom:2px}@media (min-width:60em){.g04 .n03-sub_container{padding-bottom:23px}}@media(min-width:64em) and (max-width:64.5em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:14px}}@media (min-width:68em) and (max-width:69em){.g04 .megamenu-tab:first-child .megamenu-title{padding-left:30px}}</style></div>
</div>
</div><div class="separator"></div>
<div class="n03-sub_cell">
<div class="parsys"><div class="megamenu-list section">
<h4 class="n03-sub_title">News and Events</h4><ul><li itemprop="url"><a href="/company/newsroom.html" itemprop="name" class="MegaMenus">Newsroom</a></li>
<li itemprop="url"><a href="/company/press-releases.html" itemprop="name" class="MegaMenus">Press Releases</a></li>
<li itemprop="url"><a href="/company/events.html" itemprop="name" class="MegaMenus">Events</a></li>
</ul></div>
<div class="megamenu-list section">
<h4 class="n03-sub_title">Careers</h4><ul><li itemprop="url"><a href="/company/jobs.html" itemprop="name" class="MegaMenus">Job Opportunities</a></li>
<li itemprop="url"><a href="/company/jobs/internships.html" itemprop="name" class="MegaMenus">Internships</a></li>
</ul></div>
<div class="htmlpassthru section">
<style>
  .content-5-par .megamenus .megamenu-cta {
    background: url(/content/dam/fireeye-www/global/en/nav/bg-nav-vision.jpg) center no-repeat;
    background-size: cover;
    border-radius: 60px 0 12px 60px;
    border: 0 solid #ffffff;}
  .content-5-par .n03_utility {background-color: transparent;}
  .n03_utility_cell {padding: 0 13px 0 0;}

</style></div>
</div>
</div><div class="separator disabled"></div></div><div class="megamenu-cta">

<div class="n03_utility">
<div class="n03_utility_container">
<div class="n03_utility_table">
<div class="n03_utility_cell">
<h5>The Vision</h5>
<p>Read our digital magazine providing expert-authored stories, information, unique insights, and advice on cyber security.</p>
</div>
<div class="n03_utility_cell"><div class="button"><div class="text-center"><a class="btn btn-B2282D compact" href="https://vision.fireeye.com/" target="_blank">Get Your Copy</a></div></div>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</div>
</li></ul>
</nav>
</div>
<span class="burger ficon ficon-menu"></span>
</header>
</div>
</div>


<div id="cookie-privacy-banner" style="display:none;">
<div class="l_container">
<div class="g">
<div class="g-u-1">
<div class="g-content">
<div class="cookie-banner">
<p class="cookie-text">
To give you the best possible experience, this site uses cookies.&nbsp; Find out more on <a href='/company/privacy.html' target='_blank'>how we use cookies</a>.<button type="button" class="cookie-button highlighted" onclick='javascript:onAccept();'>Accept</button>
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="breadcrumbs breadcrumb">
<div class="l_container is-full">
<div class="g02 g02v0" id="g02-breadcrumbs">
<div class="g02_container">
<div class="g02_content">
<ul class="list-inline g02_list" itemscope itemtype="http://schema.org/BreadcrumbList">
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog.html"><span itemprop="name">FireEye Blogs</span></a><meta itemprop="position" content="2" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemprop="item" class="BreadCrumb" href="/blog/threat-research.html"><span itemprop="name">Threat Research</span></a><meta itemprop="position" content="3" /></li>
<li class="g02_list_item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><span itemprop="name">WannaCry Malware Profile<meta itemprop="position" content="6" /></span>
</ul>
</div>
</div>
</div>
</div>
</div>
<main class="l_main" role="main">
<div class="l_container">
<div class="g g-alt ">
<div class="g-u-17-24 l_g-u-1">
<div class="g-content">
<div class="blog main"><div itemscope itemtype="http://schema.org/BlogPosting">
<div class="summary entrytextteaser">
</div>
<div class="title entrytitle">
<h2 class="category-name">Threat Research</h2>
<h1 class="blogpostlanding red" itemprop="headline">WannaCry Malware Profile</h1>
<div class="c00 c00v0 entry-meta-block selfClear">
<time class="entry-date" itemprop="datePublished" content="2017-05-23T17:30:00Z">May 23, 2017</time>
<span class="sep"> | </span>
<span class="by-author" itemscope itemptype="http://schema.org/Person">by <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/alex-berry" title="View all entries filed under 'Fireeye - Authors : Alex Berry'">Alex Berry</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/cap-josh-homan" title="View all entries filed under 'Fireeye - Authors : Josh Homan'">Josh Homan</a>, <a href="/blog/threat-research.html/category/etc/tags/fireeye-blog-authors/randi-eitzman" title="View all entries filed under 'Fireeye - Authors : Randi Eitzman'">Randi Eitzman</a><meta itemprop="author" content="Alex Berry" /><meta itemprop="contributor" content="Josh Homan" /><meta itemprop="contributor" content="Randi Eitzman" /></span>
<div class="tags-section">
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/ransomware"> <span class="tagbutton">Ransomware</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/malware-analysis"> <span class="tagbutton">Malware Analysis</span></a><br class="on-mobile" />
<a class="tagList" href="/blog/threat-research.html/category/etc/tags/fireeye-blog-tags/wannacry-ransomware"> <span class="tagbutton">WannaCry Ransomware</span></a><br class="on-mobile" />
</div>
</div>
</div>
<div class="par parsys"><div class="entrytext section"><div class="c00 c00v0" itemprop="articleBody">
<p>WannaCry (also known as WCry or WanaCryptor) malware is a self-propagating (worm-like) ransomware that spreads through internal networks and over the public internet by exploiting a vulnerability in Microsoft’s Server Message Block (SMB) protocol, MS17-010. The <a href="https://www.fireeye.com/blog/products-and-services/2017/05/wannacry-ransomware-campaign.html">WannaCry</a> malware consists of two distinct components, one that provides ransomware functionality and a component used for propagation, which contains functionality to enable SMB exploitation capabilities.</p>
<p>The malware leverages an exploit, codenamed “EternalBlue”, that was released by the Shadow Brokers on April 14, 2017.</p>
<p>The malware appends encrypted data files with the .WCRY extension, drops and executes a decryptor tool, and demands $300 or $600 USD (via Bitcoin) to decrypt the data.</p>
<p>The malware uses encrypted Tor channels for command and control (C2) communications.</p>
<h3>File Characteristics</h3>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="81"><p><b>Filename</b></p>
</td>
<td width="126"><p><b>MD5 Hash</b></p>
</td>
<td width="57"><p><b>Size (bytes)</b></p>
</td>
<td width="66"><p><b>Compile Time</b></p>
</td>
<td width="84"><p><b>Description</b></p>
</td>
<td width="54"><p><b>Filetype</b></p>
</td>
</tr><tr><td width="81"><p>mssecsvc.exe</p>
</td>
<td width="126"><p>db349b97c37d22f5ea1d1841e3c89eb4</p>
</td>
<td width="57"><p>3723264</p>
</td>
<td width="66"><p>2010-11-20T09:03:08Z</p>
</td>
<td width="84"><p>Loader + Worm Component</p>
</td>
<td width="54"><p>EXE</p>
</td>
</tr><tr><td width="81"><p>tasksche.exe</p>
</td>
<td width="126"><p>84c82835a5d21bbcf75a61706d8ab549</p>
</td>
<td width="57"><p>3514368</p>
</td>
<td width="66"><p>2010-11-20T09:05:05Z</p>
</td>
<td width="84"><p>Loader</p>
</td>
<td width="54"><p>EXE</p>
</td>
</tr><tr><td width="81"><p>Unavailable</p>
</td>
<td width="126"><p>f351e1fcca0c4ea05fc44d15a17f8b36</p>
</td>
<td width="57"><p>65536</p>
</td>
<td width="66"><p>2009-07-14 01:12:55Z</p>
</td>
<td width="84"><p>Encryptor</p>
</td>
<td width="54"><p>DLL</p>
</td>
</tr><tr><td width="81"><p>@WanaDecryptor@.exe</p>
</td>
<td width="126"><p>7bf2b57f2a205768755c07f238fb32cc</p>
</td>
<td width="57"><p>245760</p>
</td>
<td width="66"><p>2009-07-13 23:19:35Z</p>
</td>
<td width="84"><p>Decryptor</p>
</td>
<td width="54"><p>EXE</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 1: File characteristics</span></p>
<h3>Persistence Mechanism</h3>
<p>The malware creates the following two registry run keys to ensure persistence:</p>
<ul>
<li>Key: HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\&lt;<i>Random</i>&gt;</li>
</ul>
<p>Value: &lt;<i>Full_path</i>&gt;\tasksche.exe</p>
<ul>
<li>Key: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\&lt;<i>Random</i>&gt;</li>
</ul>
<p>Value: &lt;<i>Full_path</i>&gt;\tasksche.exe</p>
<p>The malware creates the following service to ensure persistence of mssecsvc.exe:</p>
<ul>
<li>ServiceName: mssecsvc2.0</li>
<li>DisplayName: Microsoft Security Center (2.0) Service</li>
<li>BinaryPath: &lt;path to mssecsvc&gt; -m security</li>
</ul>
<p>The malware creates the following service to ensure persistence of tasksche.exe</p>
<ul>
<li>ServiceName: &lt;8-15lower&gt;&lt;3number&gt;</li>
<li>DisplayName: &lt;Same as Service Name&gt;</li>
<li>BinaryPath &lt;path to tashsche.exe&gt;</li>
</ul>
<h3>Host-Based Signatures</h3>
<h4>File System Artifacts</h4>
<h5>Checksum</h5>
<ul>
<li>Actual: 0x00018AF7</li>
<li>Header: 0x00000000</li>
</ul>
<h5>Dropped Files</h5>
<p><u>Loader Files</u></p>
<ul>
<li>Name:&nbsp;tasksche.exe<br>
Path:&nbsp;C:\WINDOWS\<br>
Path: &lt;<i>system_drive</i>&gt;\ProgamData\&lt;<i>sys_id</i>&gt;<br>
Path: &lt;<i>system_drive</i>&gt;\Intel\&lt;<i>sys_id</i>&gt;<br>
MD5: 84c82835a5d21bbcf75a61706d8ab549</li>
</ul>
<ul>
<li>Name:&nbsp;qeriuwjhrf<br>
Path:&nbsp;C:\WINDOWS\</li>
</ul>
<ul>
<li>Name: m_bulgarian.wnry<br>
Path: %CD%\msg\<br>
MD5: 95673b0f968c0f55b32204361940d184</li>
</ul>
<ul>
<li>Name: m_chinese (simplified).wnry<br>
Path: %CD%\msg\<br>
MD5: 0252d45ca21c8e43c9742285c48e91ad</li>
</ul>
<ul>
<li>Name: m_chinese (traditional).wnry<br>
Path: %CD%\msg\<br>
MD5: 2efc3690d67cd073a9406a25005f7cea</li>
</ul>
<ul>
<li>Name: m_croatian.wnry<br>
Path: %CD%\msg\<br>
MD5: 17194003fa70ce477326ce2f6deeb270</li>
</ul>
<ul>
<li>Name: m_czech.wnry<br>
Path: %CD%\msg\<br>
MD5: 537efeecdfa94cc421e58fd82a58ba9e</li>
</ul>
<ul>
<li>Name: m_danish.wnry<br>
Path: %CD%\msg\<br>
MD5: 2c5a3b81d5c4715b7bea01033367fcb5</li>
</ul>
<ul>
<li>Name: m_dutch.wnry<br>
Path: %CD%\msg\<br>
MD5: 7a8d499407c6a647c03c4471a67eaad7</li>
</ul>
<ul>
<li>Name: m_english.wnry<br>
Path: %CD%\msg\<br>
MD5: fe68c2dc0d2419b38f44d83f2fcf232e</li>
</ul>
<ul>
<li>Name: m_filipino.wnry<br>
Path: %CD%\msg\<br>
MD5: 08b9e69b57e4c9b966664f8e1c27ab09</li>
</ul>
<ul>
<li>Name: m_finnish.wnry<br>
Path: %CD%\msg\<br>
MD5: 35c2f97eea8819b1caebd23fee732d8f</li>
</ul>
<ul>
<li>Name: m_french.wnry<br>
Path: %CD%\msg\<br>
MD5: 4e57113a6bf6b88fdd32782a4a381274</li>
</ul>
<ul>
<li>Name: m_german.wnry<br>
Path: %CD%\msg\<br>
MD5: 3d59bbb5553fe03a89f817819540f469</li>
</ul>
<ul>
<li>Name: m_greek.wnry<br>
Path: %CD%\msg\<br>
MD5: fb4e8718fea95bb7479727fde80cb424</li>
</ul>
<ul>
<li>Name: m_indonesian.wnry<br>
Path: %CD%\msg\<br>
MD5: 3788f91c694dfc48e12417ce93356b0f</li>
</ul>
<ul>
<li>Name: m_italian.wnry<br>
Path: %CD%\msg\<br>
MD5: 30a200f78498990095b36f574b6e8690</li>
</ul>
<ul>
<li>Name: m_japanese.wnry<br>
Path: %CD%\msg\<br>
MD5: b77e1221f7ecd0b5d696cb66cda1609e</li>
</ul>
<ul>
<li>Name: m_korean.wnry<br>
Path: %CD%\msg\<br>
MD5: 6735cb43fe44832b061eeb3f5956b099</li>
</ul>
<ul>
<li>Name: m_latvian.wnry<br>
Path: %CD%\msg\<br>
MD5: c33afb4ecc04ee1bcc6975bea49abe40</li>
</ul>
<ul>
<li>Name: m_norwegian.wnry<br>
Path: %CD%\msg\<br>
MD5: ff70cc7c00951084175d12128ce02399</li>
</ul>
<ul>
<li>Name: m_polish.wnry<br>
Path: %CD%\msg\<br>
MD5: e79d7f2833a9c2e2553c7fe04a1b63f4</li>
</ul>
<ul>
<li>Name: m_portuguese.wnry<br>
Path: %CD%\msg\<br>
MD5: fa948f7d8dfb21ceddd6794f2d56b44f</li>
</ul>
<ul>
<li>Name: m_romanian.wnry<br>
Path: %CD%\msg\<br>
MD5: 313e0ececd24f4fa1504118a11bc7986</li>
</ul>
<ul>
<li>Name: m_russian.wnry<br>
Path: %CD%\msg\<br>
MD5: 452615db2336d60af7e2057481e4cab5</li>
</ul>
<ul>
<li>Name: m_slovak.wnry<br>
Path: %CD%\msg\<br>
MD5: c911aba4ab1da6c28cf86338ab2ab6cc</li>
</ul>
<ul>
<li>Name: m_spanish.wnry<br>
Path: %CD%\msg\<br>
MD5: 8d61648d34cba8ae9d1e2a219019add1</li>
</ul>
<ul>
<li>Name: m_swedish.wnry<br>
Path: %CD%\msg\<br>
MD5: c7a19984eb9f37198652eaf2fd1ee25c</li>
</ul>
<ul>
<li>Name: m_turkish.wnry<br>
Path: %CD%\msg\<br>
MD5: 531ba6b1a5460fc9446946f91cc8c94b</li>
</ul>
<ul>
<li>Name: m_vietnamese.wnr<br>
Path: %CD%\msg\<br>
MD5: 8419be28a0dcec3f55823620922b00fa</li>
</ul>
<ul>
<li>Name: t.wnry<br>
Path: %CD%<br>
MD5: 5dcaac857e695a65f5c3ef1441a73a8f<br>
<b>Description</b>: Encrypted Encryption Tool</li>
</ul>
<ul>
<li>Name: taskdl.exe<br>
Path: %CD%<br>
MD5: 4fef5e34143e646dbf9907c4374276f5<br>
<b>Description: </b>Support tool for removing temporary files</li>
</ul>
<ul>
<li>Name: taskse.exe<br>
Path: %CD%<br>
MD5: 8495400f199ac77853c53b5a3f278f3e<br>
<b>Description: </b>Support tool for launch Decryption Tool</li>
</ul>
<ul>
<li>Name: u.wnry<br>
Path: %CD%<br>
MD5: 7bf2b57f2a205768755c07f238fb32cc<br>
<b>Description</b>: Decryption Tool</li>
</ul>
<ul>
<li>File: b.wnry<br>
Path: %CD%<br>
MD5: c17170262312f3be7027bc2ca825bf0c<br>
<b>Description</b>: Ransom Image (BMP)</li>
</ul>
<ul>
<li>Name: c.wnry<br>
Path: %CD%<br>
MD5: ae08f79a0d800b82fcbe1b43cdbdbefc<br>
<b>Description</b>: Config Data</li>
</ul>
<p><u>Encryptor Files</u></p>
<ul>
<li>00000000.res</li>
<li>00000000.pky</li>
<li>00000000.eky</li>
<li>00000000.dky</li>
</ul>
<p><u>Decryptor Files</u></p>
<ul>
<li>c.wnry</li>
<li>File: taskhsvc.exe<br>
Path: TaskData\Tor\</li>
</ul>
<p>The following artifact can be found on remotely exploited systems:</p>
<ul>
<li>Name:&nbsp;mssecsvc.exe<br>
Path:&nbsp;C:\WINDOWS\<br>
MD5:&nbsp;db349b97c37d22f5ea1d1841e3c89eb4<br>
<b>Description</b>: Dropper + worm component</li>
</ul>
<h5>Registry Artifacts</h5>
<ul>
<li>ServiceName:&nbsp;mssecsvc2.0<br>
DisplayName:&nbsp;Microsoft Security Center (2.0) Service<br>
BinaryPath:&nbsp;&lt;<i>GetModuleFileName</i>&gt; -m security</li>
</ul>
<ul>
<li>HKLM\Software\WanaCrypt0r\wd</li>
</ul>
<ul>
<li>HKCU\Software\WanaCrypt0r\wd</li>
</ul>
<h5>Exports</h5>
<ul>
<li>0x00005AE0&nbsp;TaskStart</li>
</ul>
<h5>Mutex</h5>
<ul>
<li>MsWinZonesCacheCounterMutexA</li>
</ul>
<h5>Process Arguments</h5>
<ul>
<li>icacls . /grant Everyone:F /T /C /Q</li>
<li>attrib +h +s &lt;Drive_Letter&gt;:\$RECYCLE</li>
<li>taskkill.exe /f /im Microsoft.Exchange.\*</li>
<li>taskkill.exe /f /im MSExchange\*</li>
<li>taskkill.exe /f /im sqlserver.exe</li>
<li>taskkill.exe /f /im sqlwriter.exe</li>
<li>taskkill.exe /f /im mysqld.exe</li>
<li>cmd.exe /c start /b @WanaDecryptor@.exe vs</li>
<li>cmd.exe /c vssadmin delete shadows /all /quiet &amp; wmic shadowcopy delete &amp; bcdedit /set {default} bootstatuspolicy ignoreallfailures &amp; bcdedit /set {default} recoveryenabled no &amp; wbadmin delete catalog -q</li>
<li>-m security</li>
<li>cmd /c &lt;15 digits&gt;.bat</li>
<li>cscript.exe //nologo &lt;1 character&gt;.vbs</li>
</ul>
<h3>Network-Based Signatures</h3>
<h4>DNS</h4>
<ul>
<li>www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com (sinkholed)</li>
</ul>
<h4>Connections</h4>
<ul>
<li>&lt;<i>random_ip</i>&gt;:445&nbsp;</li>
<li>&lt;<i>subnet_ip</i>&gt;:445</li>
</ul>
<h3>WannaCry Analysis</h3>
<h4>Startup</h4>
<p>The malware starts by attempting to connect to&nbsp;the following domain with&nbsp;InternetOpenUrl:</p>
<ul>
<li>www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com</li>
</ul>
<p>NOTE: If this succeeds, the malware immediately exits. For a list of observed killswitch domains, see Appendix A.</p>
<p>If the connection fails, however, the malware checks the number of arguments passed to the program. If zero, the malware continues with installation; otherwise it enters service mode.</p>
<p>Note: Network proxies and other enterprise network security features may prevent the malware from contacting its killswitch domain and inadvertently trigger encryption. Organizations may wish to adjust their proxy configurations or other network configurations to avoid this problem.</p>
<h4>Service Mode</h4>
<p>In service mode, the malware first updates the service config so that failure actions occur if the service exits without entering a&nbsp;SERVICE_STOPPED&nbsp;state. The malware then executes the service function, which registers the service handlers and attempts exploitation of MS17-010 against identified SMB services. This allows remote code execution and enables spreading across the network. This execution is performed in a thread, and the service exits after 24 hours regardless of the status of the thread.</p>
<p>The spreader begins by setting up the Windows socket APIs and generating a RSA crypto context. This crypto context is later used to generate random numbers. The malware then builds two DLLs in memory – they are 32 and 64-bit DLLs that have identical functionality. Each one contains a single export named&nbsp;<i>PlayGame</i>&nbsp;that loads the&nbsp;W&nbsp;resource, writes it to&nbsp;C:\WINDOWS\mssecsvc.exe,&nbsp;and executes it. The&nbsp;W&nbsp;resource in each case has been populated with a copy of the running binary (MD5: db349b97c37d22f5ea1d1841e3c89eb4).</p>
<p>The malware continues by spawning two threads, the first thread enumerates the network adapters and determines which subnets the system is on. The malware then generates a thread for each IP on the subnet. Each of these threads attempts to connect to the IP on port&nbsp;445&nbsp;and, if successful, attempts exploitation of the service via a vulnerability described in MS17-010. An example of an attempt to exploit&nbsp;MS17-010&nbsp;on a remote system can be seen in Figure 1.</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/image1.png"><span class="type-XS">Figure 1: WannaCry network traffic attempting SMB exploit</span></p>
<p>One of the unique features of this traffic is an&nbsp;SMB Tree Connect AndX Request&nbsp;containing the following UNICODE string: &nbsp;</p>
<ul>
<li>\\192.168.56.20\IPC$</li>
</ul>
<p>This packet is hand-crafted and hard-coded into the malware.</p>
<p>The second thread generates random IPs and attempts to connect to them on port&nbsp;445. If the connection is successful, the malware then attempts to perform the&nbsp;SMB attack on the system.&nbsp;128&nbsp;instances of the second thread area created with two seconds separating each thread creations.</p>
<h4>Installation</h4>
<p>The malware continues by creating a service named&nbsp;<i>mssecsvc2.0</i>&nbsp;with a binary path pointing to the running module with the arguments &quot;-m security&quot;. Once created, the malware starts the service. The malware then locates its&nbsp;R&nbsp;resource and loads it into memory. The malware then writes the R resource data to the file&nbsp;C:\WINDOWS\<i>tasksche.exe</i>. The malware executes C:\WINDOWS\tasksche.exe /i with the&nbsp;CreateProcess&nbsp;API. The malware then attempts to move&nbsp;C:\WINDOWS\<i>tasksche.exe&nbsp;</i>to&nbsp;C:\WINDOWS\<i>qeriuwjhrf</i>, replacing the original file if it exists.</p>
<p>The malware begins by generating a unique identifier based on the computer name. The identifier,&nbsp;&lt;<i>sys_id</i>&gt;, has the form of 8-15 random lowercase characters followed by 3 numbers. The malware then checks to see if it was passed the&nbsp;/i&nbsp;argument.</p>
<h5>Run with /i Command</h5>
<p>The /i command copies the running binary to &lt;system_drive&gt;\ProgamData\&lt;<i>sys_id</i>&gt;\<i>tasksche.exe&nbsp;</i>if&nbsp;&lt;<i>system_drive</i>&gt;\ProgamData&nbsp;exists, otherwise it will be copied to&nbsp;&lt;<i>system_drive</i>&gt;\Intel\&lt;<i>sys_id</i>&gt;\<i>tasksche</i>.<i>exe</i>.&nbsp;&lt;<i>system_drive</i>&gt;is the drive letter on which Windows was installed (C:\&nbsp;for&nbsp;C:\Windows). The malware then updates its&nbsp;current directory to the created directory.</p>
<p>The malware then attempts to open the service named&nbsp;&lt;<i>sys_id</i>&gt;. If it does not exist, the malware creates it with a DisplayName of&nbsp;&lt;<i>sys_id</i>&gt;&nbsp;and a BinaryPath of&nbsp;cmd /c &lt;<i>path_to_copied tasksche.exe</i>&gt;. The malware then starts the service. The malware attempts to open the mutex&nbsp;Global\MsWinZonesCacheCounterMutexA0. If the mutex is not created within 60 seconds, the malware re-lauches itself from the new installation directory with no arguments. The malware then waits 60 seconds for the mutex to be created. If the mutex is created in either instance, the initial executable exits. If the mutex fails to be created, the malware continues as if it was run without the&nbsp;/i&nbsp;argument.</p>
<h5>Run without /i Command</h5>
<p>The malware updates&nbsp;%CD%&nbsp;to the path of the running module and sets&nbsp;HKLM\Software\WanaCrypt0r\wd&nbsp;to&nbsp;%CD%. The malware then loads the XIA resource and decompresses numerous files (see&nbsp;Table 3) to&nbsp;%CD%. The malware then opens&nbsp;%CD%\<i>c.wnry</i> (the configuration data) and loads it into memory. It expects the file to be of size 0x30C. The malware then chooses randomly between the three strings&nbsp;13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94,&nbsp;12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw, and&nbsp;115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn; writes it to offset 0xB2 in the configuration file; and writes the updated configuration data back to&nbsp;%CD%\<i>c.wnry</i>.</p>
<p>The malware then sets the hidden attribute for&nbsp;%CD%&nbsp;by executing the following command with CreateProcess:</p>
<ul>
<li>attrib +h</li>
</ul>
<p>The malware then executes the following command – granting all users permissions to&nbsp;%CD%&nbsp;and all of its subdirectories:</p>
<ul>
<li>icacls . /grant Everyone:F /T /C /Q</li>
</ul>
<p>The malware then imports the hard-coded RSA Private key, shown in Figure 2.</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/image2.png"></p>
<p><span class="type-XS">Figure 2: Imported private key</span></p>
<p>The malware then opens and reads&nbsp;%CD%\<i>t.wnry</i>. The first 8 bytes of the file are checked to match the magic value&nbsp;WANACRY!. The file has the following structure:</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/Struct.png"></p>
<p>The encrypted key decrypts to the 128-bit AES key&nbsp;BEE19B98D2E5B12211CE211EECB13DE6. This key can then be used to decrypt the enc_data. The decrypted data is saved as&nbsp;a DLL (MD5: f351e1fcca0c4ea05fc44d15a17f8b36). This DLL is then manually loaded into memory and the&nbsp;<i>TaskStart&nbsp;</i>export is called. The&nbsp;TaskStart&nbsp;export of the decrypted DLL is the encryption component of the ransomware.</p>
<h5>XIA Resource Contents</h5>
<p>The files shown in Table 2 are extracted from the XIA resource. They are dropped into the %CD% of the running malware.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="85" valign="top"><p><b>Filename</b></p>
</td>
<td width="212" valign="top"><p><b>MD5 Hash</b></p>
</td>
<td width="171" valign="top"><p><b>Description</b></p>
</td>
</tr><tr><td width="85" valign="top"><p>r.wnry</p>
</td>
<td width="212" valign="top"><p>3e0020fc529b1c2a061016dd2469ba96</p>
</td>
<td width="171" valign="top"><p>Text ransom note</p>
</td>
</tr><tr><td width="85" valign="top"><p>s.wnry</p>
</td>
<td width="212" valign="top"><p>ad4c9de7c8c40813f200ba1c2fa33083</p>
</td>
<td width="171" valign="top"><p>Zip file containing Tor files</p>
</td>
</tr><tr><td width="85" valign="top"><p>t.wnry</p>
</td>
<td width="212" valign="top"><p>5dcaac857e695a65f5c3ef1441a73a8f</p>
</td>
<td width="171" valign="top"><p>Encrypted encryption tool</p>
</td>
</tr><tr><td width="85" valign="top"><p>taskdl.exe</p>
</td>
<td width="212" valign="top"><p>4fef5e34143e646dbf9907c4374276f5</p>
</td>
<td width="171" valign="top"><p>*.WNCRYT file deletion tool</p>
</td>
</tr><tr><td width="85" valign="top"><p>taskse.exe</p>
</td>
<td width="212" valign="top"><p>8495400f199ac77853c53b5a3f278f3e</p>
</td>
<td width="171" valign="top"><p>Utility used to launch decryption tool</p>
</td>
</tr><tr><td width="85" valign="top"><p>u.wnry</p>
</td>
<td width="212" valign="top"><p>7bf2b57f2a205768755c07f238fb32cc</p>
</td>
<td width="171" valign="top"><p>Decryption tool</p>
</td>
</tr><tr><td width="85" valign="top"><p>b.wnry</p>
</td>
<td width="212" valign="top"><p>c17170262312f3be7027bc2ca825bf0c</p>
</td>
<td width="171" valign="top"><p>Ransom image (BMP)</p>
</td>
</tr><tr><td width="85" valign="top"><p>c.wnry</p>
</td>
<td width="212" valign="top"><p>ae08f79a0d800b82fcbe1b43cdbdbefc</p>
</td>
<td width="171" valign="top"><p>Configuration data</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 2: XIA extracted resources</span></p>
<p>Table 3 shows RTF documents containing the ransom note in various languages.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="157" valign="top"><p><b>Filename</b></p>
</td>
<td width="225" valign="top"><p><b>MD5 Hash</b></p>
</td>
</tr><tr><td width="157" valign="top"><p>m_bulgarian.wnry</p>
</td>
<td width="225" valign="top"><p>95673b0f968c0f55b32204361940d184</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_chinese (simplified).wnry</p>
</td>
<td width="225" valign="top"><p>0252d45ca21c8e43c9742285c48e91ad</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_chinese (traditional).wnry</p>
</td>
<td width="225" valign="top"><p>2efc3690d67cd073a9406a25005f7cea</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_croatian.wnry</p>
</td>
<td width="225" valign="top"><p>17194003fa70ce477326ce2f6deeb270</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_czech.wnry</p>
</td>
<td width="225" valign="top"><p>537efeecdfa94cc421e58fd82a58ba9e</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_danish.wnry</p>
</td>
<td width="225" valign="top"><p>2c5a3b81d5c4715b7bea01033367fcb5</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_dutch.wnry</p>
</td>
<td width="225" valign="top"><p>7a8d499407c6a647c03c4471a67eaad7</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_english.wnry</p>
</td>
<td width="225" valign="top"><p>fe68c2dc0d2419b38f44d83f2fcf232e</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_filipino.wnry</p>
</td>
<td width="225" valign="top"><p>08b9e69b57e4c9b966664f8e1c27ab09</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_finnish.wnry</p>
</td>
<td width="225" valign="top"><p>35c2f97eea8819b1caebd23fee732d8f</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_french.wnry</p>
</td>
<td width="225" valign="top"><p>4e57113a6bf6b88fdd32782a4a381274</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_german.wnry</p>
</td>
<td width="225" valign="top"><p>3d59bbb5553fe03a89f817819540f469</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_greek.wnry</p>
</td>
<td width="225" valign="top"><p>fb4e8718fea95bb7479727fde80cb424</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_indonesian.wnry</p>
</td>
<td width="225" valign="top"><p>3788f91c694dfc48e12417ce93356b0f</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_italian.wnry</p>
</td>
<td width="225" valign="top"><p>30a200f78498990095b36f574b6e8690</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_japanese.wnry</p>
</td>
<td width="225" valign="top"><p>b77e1221f7ecd0b5d696cb66cda1609e</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_korean.wnry</p>
</td>
<td width="225" valign="top"><p>6735cb43fe44832b061eeb3f5956b099</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_latvian.wnry</p>
</td>
<td width="225" valign="top"><p>c33afb4ecc04ee1bcc6975bea49abe40</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_norwegian.wnry</p>
</td>
<td width="225" valign="top"><p>ff70cc7c00951084175d12128ce02399</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_polish.wnry</p>
</td>
<td width="225" valign="top"><p>e79d7f2833a9c2e2553c7fe04a1b63f4</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_portuguese.wnry</p>
</td>
<td width="225" valign="top"><p>fa948f7d8dfb21ceddd6794f2d56b44f</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_romanian.wnry</p>
</td>
<td width="225" valign="top"><p>313e0ececd24f4fa1504118a11bc7986</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_russian.wnry</p>
</td>
<td width="225" valign="top"><p>452615db2336d60af7e2057481e4cab5</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_slovak.wnry</p>
</td>
<td width="225" valign="top"><p>c911aba4ab1da6c28cf86338ab2ab6cc</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_spanish.wnry</p>
</td>
<td width="225" valign="top"><p>8d61648d34cba8ae9d1e2a219019add1</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_swedish.wnry</p>
</td>
<td width="225" valign="top"><p>c7a19984eb9f37198652eaf2fd1ee25c</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_turkish.wnry</p>
</td>
<td width="225" valign="top"><p>531ba6b1a5460fc9446946f91cc8c94b</p>
</td>
</tr><tr><td width="157" valign="top"><p>m_vietnamese.wnry</p>
</td>
<td width="225" valign="top"><p>8419be28a0dcec3f55823620922b00fa</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 3: Ransom notes in various languages</span></p>
<h4>Encryption Component</h4>
<p>The <i>TaskStart</i> export takes two arguments; the handle to the module and an integer that must be zero. <i>TaskStart</i> first creates a mutex named &quot;MsWinZonesCacheCounterMutexA&quot; and reads the contents of <i>c.wnry</i> from the current directory. If the mutex exists or <i>c.wnry</i> is not present, the malware exits. The malware creates another mutex named &quot;Global\MsWinZonesCacheCounterMutexA0&quot;.</p>
<p>The malware then loads and verifies a key from the file <i>00000000.dky</i>. The malware then attempts to load a key <i>00000000.pky</i>. If the key does not exist, the malware imports a public RSA key (seen in Figure 3), generates a new 2048-bit RSA key and saves the public key to <i>00000000.pky</i>. The malware then saves the generated private key to <i>00000000.eky</i>, encrypted with the embedded public key.</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/image3.png"></p>
<p><span class="type-XS">Figure 3: Public RSA key</span></p>
<p>The <i>00000000.eky</i> starts with the number of bytes in little endian (0x500) followed by the encrypted key.</p>
<p>The malware launches a thread that writes 136 bytes to <i>00000000.res</i> every 25 seconds. The buffer written includes the current time of the system. If the file <i>00000000.res</i> does not exist while the malware is initializing, it creates the file. The initial contents begins with eight randomly generated bytes followed by 128 zero bytes.</p>
<p>The malware launches another thread that verifies it can encrypt and decrypt using the keys contained in <i>00000000.dky</i> and <i>00000000.pky</i> every 25 seconds. If the decryption is successful, the malware sets a global flag that stops the encryption process.</p>
<p>The malware launches another thread that scans for new drives attached to the system every three seconds. If a new drive is attached to the system and is not identified as a type CDROM drive, the malware begins the encryption process on the new drive. On new drives attached to the system, the malware may create the directory &lt;<i>Drive_letter</i>&gt;:\$RECYCLE and execute the following command:</p>
<ul>
<li>attrib +h +s &lt;<i>Drive_Letter</i>&gt;:\$RECYCLE</li>
</ul>
<p>The malware creates a thread that executes the process <i>taskdl.exe</i> every 30 seconds.</p>
<p>and creates another thread that executes either of the following two binaries (depending on administrator permissions and if the malware is running at system level):</p>
<ul>
<li>@WanaDecryptor@.exe</li>
<li>taskse.exe &lt;<i>Full_Path</i>&gt;\@WanaDecryptor@.exe</li>
</ul>
<p>A registry key name starting with 8 to 15 characters between 'a' and 'z' followed by three random values between '0' and '9' is then generated by the malware. It may then create the following registry paths with the generated key name:</p>
<ul>
<li>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\&lt;Key&gt;</li>
<li>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\&lt;Key&gt;</li>
</ul>
<p>To create the registry key, the malware executes the following command:</p>
<ul>
<li>cmd.exe /c reg add &lt;<i>Registry_Ru_Path</i>&gt; /v &quot;&lt;<i>Random</i>&gt;&quot; /t REG_SZ /d &quot;\&quot;&lt;<i>Full_Path</i>&gt;\tasksche.exe\&quot;&quot; /f</li>
</ul>
<h5>User File Encryption</h5>
<p>The malware loads another embedded RSA public key shown in Figure 4.</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/image4.png"></p>
<p><span class="type-XS">Figure 4: Additional embedded RSA public key</span></p>
<p>The malware executes the file <i>@WanaDecryptor@.exe </i>with the argument &quot;fi&quot;. This appears to be an initial check-in with the server and the response may contain an updated bitcoin address. The malware updates <i>c.wnry</i> with the current time at offset 0x60.</p>
<p>The malware then copies <i>u.wrny</i> to <i>@WanaDecryptor@.exe</i> and executes the script shown in Figure 5 to create <i>@WanaDecryptor@.exe.lnk</i>. The script is saved to a randomly generated filename based on the current time and a random value using characters from '0' to '9'. Example filename: &quot;188391494652743.bat&quot;.</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/image5.png"><span class="type-XS">Figure 5: WannaCry internal script for moving and deleting files</span></p>
<p>The malware then writes either &quot;$&lt;<i>Value</i>&gt;worth of bitcoin&quot; or &quot;%.&lt;<i>Value</i>&gt; BTC&quot; depending on the configuration – followed by the contents of the file <i>r.wnry</i> to <i>@Please_Read_Me@.txt</i>, which reads as follows:</p>
<p style="margin-left: 40px;">Q: What's wrong with my files?</p>
<p style="margin-left: 40px;">A: Ooops, your important files are encrypted. It means you will not be able to access them anymore until they are decrypted.<br>
&nbsp; &nbsp; If you follow our instructions, we guarantee that you can decrypt all your files quickly and safely!<br>
&nbsp; &nbsp; Let's start decrypting!</p>
<p style="margin-left: 40px;">Q: What do I do?</p>
<p style="margin-left: 40px;">A: First, you need to pay service fees for the decryption.<br>
&nbsp; &nbsp; Please send &lt;<i>Ransom Amount</i>&gt; to this bitcoin address: &lt;<i>Bitcoin_address</i>&gt;</p>
<p style="margin-left: 40px;">&nbsp; &nbsp; Next, please find an application file named &quot;@WanaDecryptor@.exe&quot;. It is the decrypt software.<br>
&nbsp; &nbsp; Run and follow the instructions! (You may need to disable your antivirus for a while.)</p>
<p style="margin-left: 40px;">Q: How can I trust?</p>
<p style="margin-left: 40px;">A: Don't worry about decryption.<br>
&nbsp; &nbsp; We will decrypt your files surely because nobody will trust us if we cheat users.</p>
<p style="margin-left: 40px;">*&nbsp;&nbsp; If you need our assistance, send a message by clicking &lt;Contact Us&gt; on the decryptor window.</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/image6.png"><span class="type-XS">Figure 6: Encryption warning displayed to user</span></p>
<p>The malware then targets files on the user's desktop and documents folders. When the malware starts scanning a directory it creates a temporary file with the prefix &quot;~SD&quot;, and deletes it if successful.</p>
<p>When selecting which files to encrypt, the malware skips over files with .exe, .dll, and .wncry extensions. The files with the extensions shown in Figure 7 are selected for encryption. Files larger than 209,715,200 bytes may also be encrypted.</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/image7.png"><span class="type-XS">Figure 7: Files targeted for encryption</span></p>
<p>The malware may ignore folders with the following names:</p>
<ul>
<li>\\</li>
<li>$\</li>
<li>Intel</li>
<li>ProgramData</li>
<li>WINDOWS</li>
<li>Program Files</li>
<li>Program Files (x86)</li>
<li>AppData\Local\Temp</li>
<li>Local Settings\Temp</li>
<li>Temporary Internet Files</li>
<li>Content.IE5</li>
</ul>
<p>The malware will also compare folder names with the following string, and avoid encryption if identified:</p>
<ul>
<li>&quot; This folder protects against ransomware. Modifying it will reduce protection&quot;</li>
</ul>
<p>Note: The string contains a leading whitespace. This particular check is likely included for testing/development purposes.</p>
<p>When a directory contains a file that will be encrypted, the malware copies <i>@Please_Read_Me@.txt</i> and <i>@WanaDecryptor@.exe</i> to the directory. It verifies that the first eight bytes do not contain the string <i>WANACRY!</i> and performs additional checks on the header to verify the file is not already encrypted.</p>
<p>The files are encrypted with a randomly generated 128-bit AES key in CBC mode with a NULL initialization vector. The key is generated per file, is encrypted with the generated RSA public key, and included in the encrypted file header. Each file encrypted by the malware starts with the string <i>WANACRY!</i> and has the <i>WNCRY</i> extension. Depending on the file properties, the malware may also stage files in a <i>WNCRYT</i> extension.</p>
<p>Table 4 shows the file format of encrypted files.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="58" valign="top"><p><b>Offset</b></p>
</td>
<td width="234" valign="top"><p><b>Value</b></p>
</td>
</tr><tr><td width="58" valign="top"><p>0x0000</p>
</td>
<td width="234" valign="top"><p>WANACRY!</p>
</td>
</tr><tr><td width="58" valign="top"><p>0x0008</p>
</td>
<td width="234" valign="top"><p>Length of RSA encrypted data</p>
</td>
</tr><tr><td width="58" valign="top"><p>0x000C</p>
</td>
<td width="234" valign="top"><p>RSA encrypted AES file encryption key</p>
</td>
</tr><tr><td width="58" valign="top"><p>0x010C</p>
</td>
<td width="234" valign="top"><p>File type internal to WannaCry</p>
</td>
</tr><tr><td width="58" valign="top"><p>0x0110</p>
</td>
<td width="234" valign="top"><p>Original file size</p>
</td>
</tr><tr><td width="58" valign="top"><p>0x0118</p>
</td>
<td width="234" valign="top"><p>Encrypted file contents&nbsp; (AES-128 CBC)</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 4: Encrypted file format</span></p>
<p>When encrypting the AES key with RSA, the malware may use the embedded RSA key or a key randomly generated. If the file <i>f.wnry</i> does not exist during initilazation, the malware generates a random number if the file size is less than 209,715,200 bytes. If the number is a multiple of 100, the malware uses the embedded RSA key to encrypt the AES key. A maximum of ten files can be encrypted with this key. When an AES key is encrypted with this RSA key, the malware writes the file path to the file <i>f.wnry</i>. If the random number is not a multiple of 100 or the file <i>f.wnry</i> already exists on the system, the malware will encrypt the AES key with the randomly generated RSA key.</p>
<p>Once the malware completes encrypting the desktop and documents folders, it executes the following commands:</p>
<ul>
<li>taskkill.exe /f /im Microsoft.Exchange.\*</li>
<li>taskkill.exe /f /im MSExchange\*</li>
<li>taskkill.exe /f /im sqlserver.exe</li>
<li>taskkill.exe /f /im sqlwriter.exe</li>
<li>taskkill.exe /f /im mysqld.exe</li>
</ul>
<p>The malware then encrypts files found on logical drives attached to the system that are not type DRIVE_CDROM.</p>
<p>The malware may execute the command:</p>
<ul>
<li>@WanaDecryptor@.exe co</li>
</ul>
<p>The malware executes the command:</p>
<ul>
<li>cmd.exe /c start /b @WanaDecryptor@.exe vs</li>
</ul>
<p>The malware will copy <i>b.wnry </i>to <i>@WanaDecryptor@.bmp</i> and place it in each user’s desktop folder, as well as a copy of <i>@WanaDecryptor@.exe</i>.</p>
<h4>Decryptor Component</h4>
<p>The malware communicates with an Onion server using a Tor server running on local host TCP port 9050. The malware registers the system with the Onion server, transferring encryption keys and deleting volume shadows. Once the ransom is paid, the malware obtains the decrypted RSA private key from the Onion server and decrypts ransomed files.</p>
<p>It first attempts to read the contents of the registry path HKLM\Software\WanaCrypt0r\wd. If this fails, the malware attempts to read the contents from a similar registry path within the HKCU registry hive. If one of the registry paths exists, the malware sets the current directory to value read from the registry.</p>
<p>The malware attempts to open <i>c.wnry</i> from the current directory and read 780 bytes if it exists. If the file does not exist, the file is created with the contents shown in Figure 8.</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/image8.png"></p>
<p><span class="type-XS">Figure 8: Contents of c.wnry</span></p>
<p>The value at offset 0x6c (0x59140342) in <i>c.wnry</i> is the timestamp the file was created. The remaining values are hardcoded within the binary.</p>
<h5>Accepted Commands</h5>
<p>The decryptor component accepts the command line arguments shown in Table 5.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="92"><p><b>Argument</b></p>
</td>
<td width="335"><p><b>Description</b></p>
</td>
</tr><tr><td width="92"><p>fi</p>
</td>
<td width="335"><p>Connects to an Onion server sending details from the system including the host name, user name and eight bytes from 00000000.res. The response may include a Bitcoin address that is updated in <i>c.wnry</i>.</p>
</td>
</tr><tr><td width="92"><p>co</p>
</td>
<td width="335"><p>Appears to be an initial check-in with the ransom server without displaying the ransom interface.</p>
</td>
</tr><tr><td width="92"><p>vs</p>
</td>
<td width="335"><p>Deletes volume shadow copies using the vssadmin utility.</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 5: Accepted commands</span></p>
<p><u>fi Argument</u></p>
<p>The malware reads 136 bytes from the file &quot;00000000.res&quot; in the current path. If the file does not exist the malware exits. The malware reads two URLs from&nbsp;<i>c.wnry</i>&nbsp;at offsets 0x242 and 0x1DE.</p>
<p>The first URL at offset 0x1DE in <i>c.wnry</i> is:</p>
<ul>
<li><i>https://dist.torproject.org/torbrowser/6.5.1/tor-win32-0.2.9.10.zip</i></li>
</ul>
<p>The alternate URL at offset 0x242 is not configured.</p>
<p>The malware then binds a TCP socket to the localhost (127.0.0.1) and connects to port 9050 on the localhost.</p>
<p>The malware then checks if the path &quot;TaskData\Tor\<i>taskhsvc.exe</i>&quot; exists. If the file does not exist it is extracted from the archive <i>s.wnry</i>. If <i>s.wnry</i> does not exist, the malware downloads the first URL in the configuration – and if this fails it attempts the second.</p>
<p>When downloading from a URL, the downloaded file is first saved to a filename generated with GetTempFileNameA with a &quot;t&quot; prefix within the TaskData folder. The downloaded file is a Zip archive that is extracted to the &quot;TaskData&quot; folder.</p>
<p>Once extracted, the malware copies &quot;TaskData\Tor\<i>tor.exe</i>&quot; to &quot;TaskData\Tor\<i>taskhsvc.exe</i>&quot; and executes it.</p>
<p>The malware parses the string obtained at offset 0xE4 in the configuration file <i>c.wnry</i> for Onion servers to connect to. The Onion servers listed in the configuration file are as follows:</p>
<ul>
<li>gx7ekbenv2riucmf.onion</li>
<li>57g7spgrzlojinas.onion</li>
<li>xxlvbrloxvriy2c5.onion</li>
<li>76jdd2ir2embyv47.onion</li>
<li>cwwnhwhlz52maqm7.onion</li>
</ul>
<p>The malware sends the first eight bytes of the file <i>00000000.res</i>, the host name, user name and the string &quot;+++&quot; to the Onion server. The command and control protocol appears to be custom and XOR encoded with a randomly generated buffer.</p>
<p>The response from the server is added to <i>c.wnry</i> if the string is 30 to 50 characters in length. The following is an example message sent to the server:</p>
<ul>
<li>&lt;<i>8 bytes from 00000000.res</i>&gt;&lt;<i>Host name</i>&gt;\x00&lt;<i>Unknown Byte</i>&gt;&lt;<i>User name</i>&gt;\x00+++</li>
</ul>
<p><u>co Argument</u></p>
<p>This argument the malware scans for file names in the format &lt;<i>8_Uppercase_Hex</i>&gt;.res. The file the malware is likely looking for is <i>00000000.res</i> that is created by the encryption DLL. &nbsp;The malware then generates a C2 message containing four values (Table 6) obtained from the &quot;.res&quot; file in the following format:</p>
<ul>
<li>--- &lt;<i>Time0</i>&gt; &lt;<i>Time1</i>&gt; &lt;<i>Unknown_int0</i>&gt; &lt;<i>Unknown_long</i>&gt; &lt;<i>Index</i>&gt;</li>
</ul>
<p>Note: In the aforementioned example, the values are separated with a TAB character.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="90"><p><b>Value</b></p>
</td>
<td width="347"><p><b>Description</b></p>
</td>
</tr><tr><td width="90"><p>---</p>
</td>
<td width="347"><p>Hard-coded string likely intended to identify the command</p>
</td>
</tr><tr><td width="90"><p>Time0</p>
</td>
<td width="347"><p>Time value obtained from offset 0x60</p>
</td>
</tr><tr><td width="90"><p>Time1</p>
</td>
<td width="347"><p>Time value obtained from offset 0x78</p>
</td>
</tr><tr><td width="90"><p>Unknown int0</p>
</td>
<td width="347"><p>Integer obtained from offset 0x7C</p>
</td>
</tr><tr><td width="90"><p>Unknown long</p>
</td>
<td width="347"><p>64-bit Integer obtained from offset 0x80</p>
</td>
</tr><tr><td width="90"><p>Index</p>
</td>
<td width="347"><p>Count of the current file when scanning for files in the format &lt;<i>8_Uppercase_Hex</i>&gt;.res</p>
</td>
</tr></tbody></table>
<p><span class="type-XS">Table 6: C2 message values</span></p>
<p>Figure 9 shows an example of a message.</p>
<p><img src="/content/dam/fireeye-www/blog/images/WannaCry%20malware%20profile/image9.png"></p>
<p><span class="type-XS">Figure 9: Sample C2 message</span></p>
<p>After sending the message, the malware exits.</p>
<p><u>vs Argument</u></p>
<p>The malware sleeps for 10 seconds and then executes the following command using CreateProcess or RunAs (depending on group membership):</p>
<ul>
<li>cmd.exe /c vssadmin delete shadows /all /quiet &amp; wmic shadowcopy delete &amp; bcdedit /set {default} bootstatuspolicy ignoreallfailures &amp; bcdedit /set {default} recoveryenabled no &amp; wbadmin delete catalog -q</li>
</ul>
<p><u>No Argument</u></p>
<p>The malware copies <i>b.wnry</i> from the current directory to the desktop with the filename <i>@WanaDecryptor@.bmp</i>. The desktop wallpaper is then set to the path of the bitmap and the dialog shown in Figure 6 is then displayed.</p>
<p>When the user clicks on the &quot;Contact us&quot; link, the malware sends the message to the Onion server using the following format:</p>
<ul>
<li>&lt;<i>8 bytes from 00000000.res</i>&gt;&lt;<i>Host name</i>&gt;\x00&lt;<i>Unknown Byte</i>&gt;&lt;<i>User name</i>&gt;\x00***&lt;<i>Tab</i>&gt;&lt;<i>Message contents</i>&gt;</li>
</ul>
<p>Depending on the response from the server, the malware may display a message box with one of the following values:</p>
<ol>
<li>Your message has been sent successfully!</li>
<li>Failed to send your message!<br>
Please make sure that your computer is connected to the Internet and<br>
your Internet Service Provider (ISP) does not block connections to the TOR Network!</li>
<li>You are sending too many mails! Please try again &lt;Integer value&gt; minutes later.</li>
</ol>
<p>When the user clicks on &quot;Check Payment&quot;. The malware first check if the file <i>00000000.dky</i> is present on the system. If the file is present, it attempts to verify the key by encrypting a file with the key obtained from <i>00000000.pky</i> and decrypting it with the key obtained from <i>00000000.dky</i>.</p>
<p>If the file is not present, the malware sends the contents of <i>00000000.eky</i> to the Onion server. The response from the server is saved to <i>00000000.dky</i>. If the key cannot be validated, the malware displays a message box with the contents:</p>
<p style="margin-left: 40px;">You did not pay or we did not confirmed your payment!<br>
Pay now if you didn't and check again after 2 hours.<br>
Best time to check: 9:00am - 11:00am GMT from Monday to Friday.</p>
<p>When the decrypt button is clicked without the ransom being paid, the malware decrypts the files listed in <i>f.wnry</i>. The files listed in <i>f.wnry</i> are those randomly selected to be encrypted with the embedded public key. This process is covered in the Encryption component section above.</p>
<h4>Unique Strings</h4>
<h5>mssecsvc.exe</h5>
<p>(MD5: db349b97c37d22f5ea1d1841e3c89eb4)</p>
<ul>
<li>SMBr</li>
<li>PC NETWORK PROGRAM 1.0</li>
<li>LANMAN1.0</li>
<li>Windows for Workgroups 3.1a</li>
<li>LM1.2X002</li>
<li>LANMAN2.1</li>
<li>NT LM 0.12</li>
<li>SMBs</li>
<li>Windows 2000 2195</li>
<li>Windows 2000 5.0</li>
<li>SMBu</li>
<li>__USERID__PLACEHOLDER__@</li>
<li>\\172.16.99.5\IPC$</li>
<li>__TREEID__PLACEHOLDER__</li>
<li>__USERID__PLACEHOLDER__@</li>
<li>SMB3</li>
<li>__TREEID__PLACEHOLDER__</li>
<li>__USERID__PLACEHOLDER__@</li>
<li>\t</li>
<li>h6agLCqPqVyXi2VSQ8O6Yb9ijBX54jY6KM+sz33NmS6TK8XlOk920s0E0aajOV++wrR92ds1FOLBO+evLPj4sIvAjLvaLdgk8+BlNZs8PMa9bQ33+0hNXMjbyjXwB40Q4KiDbip/d7N0CmRT1gLy+n2Rp/EYO5Fkapa4Y4kqDhPvLuOfGUvjN4BNdBk23r0/8cbGhUqHrML0az1LCeE3BqKLCL3gP10fExyMnFGtbq3rBd+5eKxSXYVD4fBKtFYI47YYbjYxxF76O9LNZEpPP9SiCEo9qRYLDcYzGu81JRU7/PJA1t1skDj8abBEOqAOXimo54/eZzGmLJ92xLwDIl8rHuZsUywgeZH/tSPXYQi0Pswy57TYZ/0/P7qyy18UVuiwGaf989u6seK2ER1R+aoJtvES8V0Zsx6slbdWrGxe4P62uwFxXStC/+qpCauvw/qpZvZo9wb458ezftwsbuOUYNlMWgBno/C5cT5tZZvDw9cBmHGcaVuvs+JAbsWoEsUaZd3R3Mn/1c1xYAumA/0VVaASNuohaU+8CmGSpny9/6ngCdejX4X//JeRJeLSP1f2AtrbAR8jSk5UgNllJcWnf+EM/Gyz</li>
<li>h5DH0RqsyNfEbXNTxRzla1zNfWz0bB4fqzrdNNfNXvtTv9FWqyXCEHLhOz9p7JXzJBBUd0OR9rg8DFXIyNXMHCfeX5v/YjDkYmaBrFWuOKpwLyotORDEi1GMahE7btGFTN2IMgml2b9wZvqSuc7aAciGNkl7+NgmkG9r323QqSJrjCgp+DJ9URAkHRp/sBsr1o2YKlVmsY6mPAOnlmaEwFLrPTm5WIYnd0yOc3abTlt6R1RfwenXgqn5K1K6Uq5o7T+KblzWV1TXo0zTIBD/CwnKbkITPd7GkK+fG//5Oj2ESIrNTwBRdIGzDYcK1VTlSYl0RMsMMZvWqZAhNBs9xfpyBgzAn+5NpIUwKnm6HS2UbNab6SQIQF53r0+Rx8w7xZkOEayDuGvPQ32Y7zfHtj911mdZeLmlXULTazhCdl+lYNd6aoUthPLUew6ng+vSLSxqF1N7+/bFkcWd5vuCPigEKxEg+X3d+JviOJaI9GJ2HWIT8ehFzv6JP7ymkH0XaHYKLPxR8Htcc2E35+8q074yiBdThfaOMI18K65supem5lEgTe2lQdQurhhNhgbmYPpmWsSerB8R4CiDHQg6B1xxN9lpUnCWCn37Ib9vdQ2V90almoOJi/+5PD+F/rT0hmgD1lUoqZ9KfEAB/D3JVZFHKCPtFO1LWNuXu9DHS0cChPvbPTNgL1fuz3hWniAOjJxyXhilxEmUKoCuaHrjL7/mCwA8mUTF8nZfDOYFw/Rqr70SWFUVy18</li>
<li>SMB3</li>
<li>__TREEID__PLACEHOLDER__</li>
<li>__USERID__PLACEHOLDER__@</li>
<li>userid</li>
<li>treeid</li>
<li>__TREEPATH_REPLACE__</li>
<li>\\%s\IPC$</li>
<li>Microsoft Base Cryptographic Provider v1.0</li>
<li>%d.%d.%d.%d</li>
<li>mssecsvc2.0</li>
<li>Microsoft Security Center (2.0) Service</li>
<li>%s -m security</li>
<li>C:\%s\qeriuwjhrf</li>
<li>C:\%s\%s</li>
<li>WINDOWS</li>
<li>tasksche.exe</li>
<li>CloseHandle</li>
<li>WriteFile</li>
<li>CreateFileA</li>
<li>CreateProcessA</li>
<li>32.dll</li>
<li>http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com</li>
</ul>
<h5>tasksche.exe</h5>
<p>(MD5: 84c82835a5d21bbcf75a61706d8ab549)</p>
<ul>
<li>.der .pfx .key .crt .csr .p12 .pem .odt .ott .sxw .stw .uot .3ds .max .3dm .ods .ots .sxc .stc .dif .slk .wb2 .odp .otp .sxd .std .uop .odg .otg .sxm .mml .lay .lay6 .asc .sqlite3 .sqlitedb .sql .accdb .mdb .db .dbf .odb .frm .myd .myi .ibd .mdf .ldf .sln .suo .cs .c .cpp .pas .h .asm .js .cmd .bat .ps1 .vbs .vb .pl .dip .dch .sch .brd .jsp .php .asp .rb .java .jar .class .sh .mp3 .wav .swf .fla .wmv .mpg .vob .mpeg .asf .avi .mov .mp4 .3gp .mkv .3g2 .flv .wma .mid .m3u .m4u .djvu .svg .ai .psd .nef .tiff .tif .cgm .raw .gif .png .bmp .jpg .jpeg .vcd .iso .backup .zip .rar .7z .gz .tgz .tar .bak .tbk .bz2 .PAQ .ARC .aes .gpg .vmx .vmdk .vdi .sldm .sldx .sti .sxi .602 .hwp .snt .onetoc2 .dwg .pdf .wk1 .wks .123 .rtf .csv .txt .vsdx .vsd .edb .eml .msg .ost .pst .potm .potx .ppam .ppsx .ppsm .pps .pot .pptm .pptx .ppt .xltm .xltx .xlc .xlm .xlt .xlw .xlsb .xlsm .xlsx .xls .dotx .dotm .dot .docm .docb .docx .doc</li>
<li>WANACRY!</li>
<li>%s\\%s</li>
<li>%s\\Intel</li>
<li>%s\\ProgramData</li>
<li>cmd.exe /c \&quot;%s\&quot;</li>
<li>XIA</li>
<li>115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn</li>
<li>12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw</li>
<li>13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94</li>
<li>%s%d</li>
<li>Global\\MsWinZonesCacheCounterMutexA</li>
<li>tasksche.exe</li>
<li>TaskStart</li>
<li>t.wnry</li>
<li>icacls . /grant Everyone:F /T /C /Q</li>
<li>attrib +h .</li>
<li>WNcry@2ol7</li>
</ul>
<h5>Encryptor</h5>
<p>(MD5: f351e1fcca0c4ea05fc44d15a17f8b36)</p>
<ul>
<li>kgptbeilcq</li>
<li>TaskStart</li>
<li>c.wnry</li>
<li>%s</li>
<li>del /a %%0</li>
<li>%d%d.bat</li>
<li>ConvertSidToStringSidW</li>
<li>advapi32.dll</li>
<li>SYSTEM</li>
<li>S-1-5-18</li>
<li>EVERYONE</li>
<li>%s\%d%s</li>
<li>.WNCRYT</li>
<li>WANACRY!</li>
<li>.WNCRY</li>
<li>.WNCYR</li>
<li>\\</li>
<li>@WanaDecryptor@.bmp</li>
<li>@WanaDecryptor@.exe.lnk</li>
<li>@Please_Read_Me@.txt</li>
<li>%s\%s</li>
<li>..</li>
<li>%s\*</li>
<li>.dll</li>
<li>.exe</li>
<li>~SD</li>
<li>@WanaDecryptor@.exe</li>
<li>Content.IE5</li>
<li>Temporary Internet Files</li>
<li>This folder protects against ransomware. Modifying it will reduce protection</li>
<li>\Local Settings\Temp</li>
<li>\AppData\Local\Temp</li>
<li>\Program Files (x86)</li>
<li>\Program Files</li>
<li>\WINDOWS</li>
<li>\ProgramData</li>
<li>\Intel</li>
<li>$\</li>
<li>TESTDATA</li>
<li>%08X.dky</li>
<li>Global\MsWinZonesCacheCounterMutexA</li>
<li>Global\MsWinZonesCacheCounterMutexW</li>
<li>cmd.exe /c reg add %s /v &quot;%s&quot; /t REG_SZ /d &quot;\&quot;%s\&quot;&quot; /f</li>
<li>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</li>
<li>%s %s</li>
<li>taskse.exe</li>
<li>@WanaDecryptor@.exe</li>
<li>tasksche.exe</li>
<li>%s\%s\%s</li>
<li>%s\*.*</li>
<li>@WanaDecryptor@.exe.lnk</li>
<li>@echo off</li>
<li>echo SET ow = WScript.CreateObject(&quot;WScript.Shell&quot;)&gt; m.vbs</li>
<li>echo SET om = ow.CreateShortcut(&quot;%s%s&quot;)&gt;&gt; m.vbs</li>
<li>echo om.TargetPath = &quot;%s%s&quot;&gt;&gt; m.vbs</li>
<li>echo om.Save&gt;&gt; m.vbs</li>
<li>cscript.exe //nologo m.vbs</li>
<li>del m.vbs</li>
<li>u.wnry</li>
<li>%.1f BTC</li>
<li>$%d worth of bitcoin</li>
<li>wb</li>
<li>r.wnry</li>
<li>b.wnry</li>
<li>attrib +h +s %C:\%s</li>
<li>$RECYCLE</li>
<li>%C:\%s</li>
<li>$RECYCLE</li>
<li>%s\hibsys%s</li>
<li>taskdl.exe</li>
<li>f.wnry</li>
<li>cmd.exe /c start /b %s vs</li>
<li>%s co</li>
<li>taskkill.exe /f /im mysqld.exe</li>
<li>taskkill.exe /f /im sqlwriter.exe</li>
<li>taskkill.exe /f /im sqlserver.exe</li>
<li>taskkill.exe /f /im MSExchange*</li>
<li>taskkill.exe /f /im Microsoft.Exchange.*</li>
<li>%s fi</li>
<li>%08X.eky</li>
<li>%08X.pky</li>
<li>%08X.res</li>
</ul>
<h5>Decryptor</h5>
<p>(MD5: 7bf2b57f2a205768755c07f238fb32cc)</p>
<ul>
<li>Connecting to server...</li>
<li>s.wnry</li>
<li>%08X.eky</li>
<li>%08X.res</li>
<li>00000000.res</li>
<li>%08X.dky</li>
<li>%08X.pky</li>
<li>Connected</li>
<li>Sent request</li>
<li>Succeed</li>
<li>Received response</li>
<li>Congratulations! Your payment has been checked!</li>
<li>Start decrypting now!</li>
<li>Failed to check your payment!</li>
<li>Please make sure that your computer is connected to the Internet and</li>
<li>your Internet Service Provider (ISP) does not block connections to the TOR Network!</li>
<li>You did not pay or we did not confirmed your payment!</li>
<li>Pay now if you didn't and check again after 2 hours.</li>
<li>Best time to check: 9:00am - 11:00am GMT from Monday to Friday.</li>
<li>You have a new message:</li>
<li>c.wnry</li>
<li>runas</li>
<li>WanaCrypt0r</li>
<li>Software\</li>
<li>%04d-%02d-%02d %02d:%02d:%02d</li>
<li>WANACRY!</li>
<li>.org</li>
<li>.WNCYR</li>
<li>.WNCRY</li>
<li>@WanaDecryptor@.bmp</li>
<li>@WanaDecryptor@.exe.lnk</li>
<li>@Please_Read_Me@.txt</li>
<li>%s\%s</li>
<li>..</li>
<li>%s\*</li>
<li>Content.IE5</li>
<li>Temporary Internet Files</li>
<li>This folder protects against ransomware. Modifying it will reduce protection</li>
<li>\Local Settings\Temp</li>
<li>ppData\Local\Temp</li>
<li>\Program Files (x86)</li>
<li>\Program Files</li>
<li>\WINDOWS</li>
<li>\ProgramData</li>
<li>\Intel</li>
<li>Please select a host to decrypt.</li>
<li>All your files have been decrypted!</li>
<li>Pay now, if you want to decrypt ALL your files!</li>
<li>f.wnry</li>
<li>My Computer</li>
<li>*.res</li>
<li>open</li>
<li>mailto:</li>
<li>Wana Decrypt0r 2.0</li>
<li>%s %s</li>
<li>cmd.exe</li>
<li>/c vssadmin delete shadows /all /quiet &amp; wmic shadowcopy delete &amp; bcdedit /set {default} bootstatuspolicy ignoreallfailures &amp; bcdedit /set {default} recoveryenabled no &amp; wbadmin delete catalog -quiet</li>
<li>13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94</li>
<li>English</li>
<li>m_%s.wnry</li>
<li>msg\</li>
<li>&lt;https://</li>
<li>&lt;http://</li>
<li>%d/%d/%d %02d:%02d:%02d</li>
<li>00;00;00;00</li>
<li>http://www.btcfrog.com/qr/bitcoinPNG.php?address=%s</li>
<li>mailto:%s</li>
<li>https://www.google.com/search?q=how+to+buy+bitcoin</li>
<li>https://en.wikipedia.org/wiki/Bitcoin</li>
<li>Send %.1f BTC to this address:</li>
<li>%.1f BTC</li>
<li>Send $%d worth of bitcoin to this address:</li>
<li>%02d;%02d;%02d;%02d</li>
<li>b.wnry</li>
<li>---&nbsp;&nbsp;&nbsp; %s&nbsp;&nbsp;&nbsp; %s&nbsp;&nbsp;&nbsp; %d&nbsp;&nbsp;&nbsp; %I64d&nbsp;&nbsp;&nbsp; %d</li>
<li>Failed to send your message!</li>
<li>Please make sure that your computer is connected to the Internet and</li>
<li>your Internet Service Provider (ISP) does not block connections to the TOR Network!</li>
<li>Your message has been sent successfully!</li>
<li>You are sending too many mails! Please try again %d minutes later.</li>
<li>Too short message!</li>
<li>%d%%</li>
<li>%s\%s</li>
<li>tor.exe</li>
<li>%s\%s\%s</li>
<li>TaskData</li>
<li>taskhsvc.exe</li>
<li>127.0.0.1</li>
</ul>
<h3>Appendix A</h3>
<h4>Observed Killswitch Domains</h4>
<p>The following table contains observed killswitch domains and their associated sample hash.</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="264"><p><b>Domain</b></p>
</td>
<td width="215"><p><b>Associated Sample MD5 Hash</b></p>
</td>
</tr><tr><td width="264" valign="top"><p>iuqssfsodp9ifjaposdfjhgosurijfaewrwergwea.com</p>
</td>
<td width="215" valign="top"><p>c2559b51cfd37bdbd5fdb978061c6c16</p>
</td>
</tr><tr><td width="264" valign="top"><p>ayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf.com (This domain matches the format of WannaCry-associated domains, but has not yet been clearly linked to a specific sample. Organizations wish to maintain awareness of this domain in the event that it is associated with WannaCry activity.)</p>
</td>
<td width="215" valign="top"><p>a44964a7be94072cdfe085bc43e7dc95</p>
</td>
</tr><tr><td width="264" valign="top"><p>ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.com</p>
</td>
<td width="215" valign="top"><p>80ce983d22c6213f35867053bec1c293</p>
</td>
</tr><tr><td width="264" valign="top"><p>iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com</p>
</td>
<td width="215" valign="top"><p>db349b97c37d22f5ea1d1841e3c89eb4</p>
</td>
</tr><tr><td width="264" valign="top"><p>iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.test</p>
</td>
<td width="215" valign="top"><p>96dff36b5275c67e35097d77a120d0d4</p>
</td>
</tr></tbody></table>
<h3>Appendix B</h3>
<h4>Yara Rules</h4>
<p>FireEye has developed the following Yara rules for WannaCry detection:</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="600" valign="top"><p><span class="code">rule FE_RANSOMWARE_WANNACRY {<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; meta:version=&quot;.4&quot;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; filetype=&quot;PE&quot;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; author=&quot;Ian.Ahl@fireeye.com @TekDefense&quot;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; date=&quot;2017-05-12&quot;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; description=&quot;Generic detection for most WannaCry variants&quot;<br>
strings:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Bitcoin URLs<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $bcURL1 = &quot;http://www.btcfrog.com/qr/bitcoinPNG.php?address=%&quot; ascii wide nocase<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $bcURL2 = &quot;https://www.google.com/search?q=how+to+buy+bitcoin&quot; ascii wide nocase</span></p>
<p><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Ransom Message<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $msg1 = &quot;Congratulations! Succeed to check your payment!&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $msg2 = &quot;Start decrypting now!&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $msg3 = &quot;All your files have been decrypted!&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $msg4 = &quot;Pay now, if you want to decrypt ALL your files!&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $msg5 = &quot;Send $%d worth of bitcoin to this address:&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $msg6 = &quot;Ooops, your files have been encrypted!&quot; ascii wide</span></p>
<p><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // WANNA Strings<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wanna1 = &quot;Wanna Decryptor 1.0&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wanna2 = &quot;Wana Decrypt0r&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wanna3 = &quot;Wana Decryptor&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wanna4 = &quot;WANNACRY&quot; ascii wide nocase<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wanna5 = &quot;WanaCrypt0r&quot; ascii wide nocase<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wanna6 = &quot;WANACRY!&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wanna7 = &quot;WNcry@2ol7&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wanna8 = &quot;wcry@123&quot;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wanna9 = &quot;wcry@2016&quot;</span></p>
<p><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // File references<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fileA1 = &quot;!WannaCryptor!.bmp&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fileA2 = &quot;!WannaDecryptor!.exe.lnk&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fileA3 = &quot;!Please Read Me!.txt&quot; ascii wide</span></p>
<p><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $fileB1 = &quot;@WanaDecryptor@.bmp&quot; ascii wide<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fileB2 = &quot;@WanaDecryptor@.exe.lnk&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fileB3 = &quot;@Please_Read_Me@.txt&quot; ascii wide</span></p>
<p><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // CMDS<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $cmd1 = &quot;cmd.exe /c start /b vssadmin.exe Delete Shadows /All /Quiet&quot; ascii wide nocase<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $cmd2 = &quot;wmic shadowcopy delete&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $cmd3 = &quot;bcdedit /set {default} bootstatuspolicy ignoreallfailures&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $cmd4 = &quot;bcdedit /set {default} recoveryenabled no&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $cmd5 = &quot;wbadmin delete catalog -quiet&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $cmd6 = &quot;icacls . /grant Everyone:F /T /C /Q&quot; ascii wide</span></p>
<p><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // MISC<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $misc1 = &quot;StartTask&quot; wide ascii<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $misc2 = &quot;b.wry&quot; wide ascii<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $misc3 = &quot;c.wry&quot; wide ascii<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $misc4 = &quot;m.wry&quot; wide ascii<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $misc5 = &quot;inflate 1.1.3 Copyright 1995-1998 Mark Adler&quot; wide ascii<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $misc6 = &quot;?AVtype_info@@&quot; wide ascii</span></p>
<p><span class="code">condition:<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (uint16(0) == 0x5A4D)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all of ($fileA*)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all of ($fileB*)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (4 of ($msg*) and 2 of ($bcURL*))<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 of ($wanna*)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (2 of ($msg*) and 1 of ($cmd*))<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4 of ($cmd*)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (1 of ($wanna*) and 1 of ($cmd*))<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (1 of ($wanna*) and 3 of ($misc*))<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>
}</span></p>
</td>
</tr></tbody></table>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="600" valign="top"><p><span class="code">rule FE_RANSOMWARE_WANNACRY_EB {<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;meta:version=&quot;.1&quot;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;filetype=&quot;PE&quot;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;author=&quot;Ian.Ahl@fireeye.com @TekDefense&quot;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;date=&quot;2017-05-12&quot;<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;description=&quot;Focusing on the WannaCry variants with worm capabilities&quot;<br>
strings:</span></p>
<p><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // EB related strings in WANNACRY<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $eb1 = &quot;__USERID__PLACEHOLDER__@&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $eb2 = &quot;__TREEID__PLACEHOLDER__&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $eb3 = &quot;LANMAN1.0&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $eb4 = &quot;LANMAN2.1&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $eb5 = &quot;\\PIPE\\&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $eb6 = &quot;\\\\%s\\IPC$&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $eb7 = &quot;__TREEPATH_REPLACE__&quot; ascii wide<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $eb8 = &quot;/K__USERID__PLACEHOLDER__&quot; ascii wide</span></p>
<p><span class="code">condition:<br>
</span><span style="background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (uint16(0) == 0x5A4D)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all of ($eb*)<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>
}</span></p>
</td>
</tr></tbody></table>
<p>&nbsp;</p>
</div>
<div class="clear-all"></div></div>
</div>
<div class="par prevnextbutton">
<div class="prevnext">
<div class="button">
<a id="leftBtnId" class="btn btn-B2282D" href="#"><span>Previous</span> <span>Post</span></a>
</div>
<div class="button">
 <a id="rightBtnId" class="btn btn-B2282D" href="#"><span>Next</span> <span>Post</span></a>
</div>
</div>
<input type="hidden" value="/content/fireeye-www/en_US/blog/threat-research" id="categoryPathVal" name="categoryPath" />
<script>
    $(document).ready(function(){

         var prevenextHtml = $('.prevnext').html();	
         var categoryPathVal = $("#categoryPathVal").val();
            var blogsDetails;
        
            if(undefined == blogsDetails){
                    blogsDetails = [];
            }
        
        
            if(undefined != prevenextHtml){
                if(blogsDetails.length <= 0){
                     $.ajax({
                        type: "GET",
                        url: "/bin/www-blogs/read-blogentries",
                        dataType: "json",
                        data: { categoryPath: categoryPathVal} ,
                        async: false,
                        success : function(data) {
                            var totalFoundRes = data.blogs.length;
                            blogsDetails = data.blogs;
                            var currentPagePath = window.location.pathname;
                            currentPagePath = currentPagePath.split(".")[0]
                            console.log("currentPagePath :: "+currentPagePath);
        
                            for (var i = 0; i < blogsDetails.length; i++) {
                                var currentItrPath = blogsDetails[i].path;
        
                                if (currentItrPath.indexOf(currentPagePath) > -1) {
                                    console.log(blogsDetails[i-1]);
                                    console.log(blogsDetails[i+1]);

                                    if(undefined != blogsDetails[i-1] ){
										var prevPagePath = blogsDetails[i-1].path;
                                        $("#leftBtnId").attr("href",prevPagePath+".html");
                                        $("#leftBtnId").show();
                                    }else{
										$("#leftBtnId").hide();
                                    }
                                    if(undefined != blogsDetails[i+1] ){
										var nextPagePath = blogsDetails[i+1].path;  
                                    	$("#rightBtnId").attr("href",nextPagePath+".html");
                                        $("#rightBtnId").show();
                                    }else{
										$("#rightBtnId").hide();
                                    }
                                }
                            }
        
                        },
                        error : function(response){
                            console.log("Error: while connecting to servlet.");
                        }
                    });
                 }else{
                     alert("Blogs from global object :: "+blogsDetails);
                 }
            }else{
                alert("prevenextHtml :: "+prevenextHtml);
            }
    });
</script></div>
</div></div>
</div>
</div>
<div id="sidebar" class="g-u-7-24 l_g-u-1 blog-sidebar">
<div class="g-content">
<div class="sidebar reuse-blog-resources">
<div class="blog-resources">
<div class="grid-33-left parsys"><div class="rightrail section">
<div class="blog-right-rail">
<div class="bottom-bar"><div class="tab">
<span class="ficon ficon-star"></span>
<p>Promotion</p></div><div class="tab">
<span class="ficon ficon-checkbox-checked"></span>
<p>Subscribe</p></div>
<div class="tab">
<span class="ficon ficon-share"></span>
<p>Share</p></div>
<div class="tab">
<span class="ficon ficon-history2"></span>
<p>Recent</p></div>
<div class="tab">
<span class="ficon ficon-feed"></span>
<p>RSS</p></div>
</div><div class="section cta">
<div id="cq-image-jsp-/content/fireeye-www/site-content/en_US/blog-right-threat-research/jcr:content/grid-33-left/rightrail/image"><a href="/mandiant/advantage.html"><img src="/content/dam/fireeye-www/services/images/bnr-mandiant-advantage-v3-315x315.png" alt="bnr-mandiant-advantage-v3-315x315" title="bnr-mandiant-advantage-v3-315x315" class="cq-dd-image"></a></div></div><div class="section email">
<script src="https://www2.fireeye.com/js/forms2/js/forms2.min.js"></script>
<div id="mktoWrapper_3353" class="a08 bg-f2f2f2"><div class="c00 c00v0"><h3>Subscribe to Blogs</h3><p>Get email updates as new blog posts are added.</p></div><form id="mktoForm_3353"></form> <script type="text/javascript">
		if(typeof digitalData=="undefined"){digitalData={}}
        //alert(https://www2.fireeye.com+":"+848-DID-242)
        //alert("false");
		MktoForms2.loadForm("https://www2.fireeye.com", "848-DID-242", 3353,
		function(form) {
			
            if(typeof fdc.blog.initCheckboxes === "function") {
                fdc.blog.initCheckboxes(form);
            } 
			digitalData.form = {id: form.getId(),name: document.title,url: window.location.href};
			//if(typeof marketoFormViewTealiumEvent !== "undefined" && typeof utag!=="undefined"){marketoFormViewTealiumEvent(form);}
			if(typeof marketoFormViewGtmEvent !== "undefined") {
				marketoFormViewGtmEvent(form);
			}
			form.onSubmit(function(values){
                //Check if GA fields are present
                if(($("input[name='GACLIENTID__c']").length>0)&&($("input[name='GAUSERID__c']").length>0)&&($("input[name='GATRACKID__c']").length>0)&&(typeof ga!=="undefined"))
                {
                      ga(function(){ 
                          //Get tracking ID and Client ID
                           var tracker = ga.getAll()[0];
                           var trackingId = tracker.get('trackingId');
                           var clientId = tracker.get('clientId');
                           var userId = tracker.get('userId');
                           $("input[name='GACLIENTID__c'").val(clientId);
                           $("input[name='GATRACKID__c'").val(trackingId);
                           $("input[name='GAUSERID__c'").val(userId);
                       });
                 }
            
        	});
			form.onSuccess(function(values, followUpUrl) {
				//if(typeof marketoFormSubmitTealiumEvent !== "undefined"){marketoFormSubmitTealiumEvent(values);}
				if(typeof marketoFormSubmitGTMEvent !== "undefined") {
					marketoFormSubmitGTMEvent(values);
				}
				
				if(typeof fdc.blog.replaceFormWithThankYou === "function") {
					var result = fdc.blog.replaceFormWithThankYou(form,values,followUpUrl);
					if (result === false) {
						return false;
					}
				} 
				return true;
			});
			
			var adrC = typeof addMissingUTMsFromCookies !== "undefined" ? addMissingUTMsFromCookies(document.URL) : document.URL;
			form.addHiddenFields({ ADR__c: adrC,ADR_Credit__c_account: document.title,ADR_Credit__c: document.referrer });
			if(($("input[name='GACLIENTID__c']").length==0)&&($("input[name='GAUSERID__c']").length==0)&&($("input[name='GATRACKID__c']").length==0)){
				form.addHiddenFields({ GACLIENTID__c:"",GAUSERID__c:"",GATRACKID__c:""});				
			}
			
		});
	</script>
</div></div>
<div class="section share">
<h6><small>Share</small></h6>

<div class="addthis_inline_share_toolbox_7uq8"></div>
</div>
<div class="section recent">
<h6>Recent Posts</h6>

<div class="c05 c05v0"><ul>
<li class="c05_item"><p class="c05_date">11 May 2021</p><a class="c05_link" href="/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html" title="Shining a Light on DARKSIDE Ransomware Operations">Shining a Light on DARKSIDE Ransomware Operations</a></li>

<li class="c05_item"><p class="c05_date">04 May 2021</p><a class="c05_link" href="/blog/threat-research/2021/05/unc2529-triple-double-trifecta-phishing-campaign.html" title="The UNC2529 Triple Double: A Trifecta Phishing Campaign">The UNC2529 Triple Double: A Trifecta Phishing Campaign</a></li>

<li class="c05_item"><p class="c05_date">29 Apr 2021</p><a class="c05_link" href="/blog/threat-research/2021/04/unc2447-sombrat-and-fivehands-ransomware-sophisticated-financial-threat.html" title="UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat">UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat</a></li>
</ul></div>
</div>
<a href="/content/fireeye-www/en_US/blog/threat-research/_jcr_content.feed" target="_blank">
<div class="section rss">
<h6><small>RSS Feed: </small><small>Stay Connected</small></h6>
<span class="ficon ficon-feed"></span>
</div>
</a>
</div>
</div>
</div>
</div></div>
</div>
</div>
</div>
</div>
</main>

<div class="footer_f635 footer">

<footer id="g03-footer" class="l_footer g03 g03v0 g03v2 g03-5col">
<div class="main-footer-wrapper">

<div class="g03_list g03_list_1">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Company</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company.html" class="Footer">Why FireEye?</a></li>
<li class="g03_item"><a href="/customers.html" class="Footer">Customer Stories</a></li>
<li class="g03_item"><a href="/company/jobs.html" class="Footer">Careers</a></li>
<li class="g03_item"><a href="/company/compliance-certification.html" class="Footer">Certifications and Compliance</a></li>
<li class="g03_item"><a href="http://investors.fireeye.com/" target="_blank" class="Footer">Investor Relations</a></li>
<li class="g03_item"><a href="/company/supplier.html" class="Footer">Supplier Documents</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_2">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>News and Events</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/newsroom.html" class="Footer">Newsroom</a></li>
<li class="g03_item"><a href="/company/press-releases.html" class="Footer">Press Releases</a></li>
<li class="g03_item"><a href="/company/webinars.html" class="Footer">Webinars</a></li>
<li class="g03_item"><a href="/company/events.html" class="Footer">Events</a></li>
<li class="g03_item"><a href="/company/awards.html" class="Footer">Awards and Honors</a></li>
<li class="g03_item"><a href="/company/contact-us/manage-your-communication-preference.html" class="Footer">Email Preferences</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_3">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Technical Support</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/company/incident-response.html" class="Footer">Incident?</a></li>
<li class="g03_item"><a href="/company/security.html" class="Footer">Report Security Issue</a></li>
<li class="g03_item"><a href="/support/contacts.html" class="Footer">Contact Support</a></li>
<li class="g03_item"><a href="https://csportal.fireeye.com/secur/login_portal.jsp?orgId=00D3000000063LS&portalId=06030000000pSNE" target="_blank" class="Footer">Customer Portal</a></li>
<li class="g03_item"><a href="https://community.fireeye.com/s/support-community" target="_blank" class="Footer">Communities</a></li>
<li class="g03_item"><a href="https://docs.fireeye.com" target="_blank" class="Footer">Documentation Portal</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_4">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>FireEye Blogs</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/blog/threat-research.html" class="Footer">Threat Research</a></li>
<li class="g03_item"><a href="/blog/products-and-services.html" class="Footer">FireEye Stories</a></li>
<li class="g03_item"><a href="/blog/executive-perspective.html" class="Footer">Industry Perspectives</a></li>
</ul></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Threat Map</strong></p></div>
<div class="footer-list section">
<ul class="g03_block"><li class="g03_item"><a href="/cyber-map/threat-map.html" class="Footer">View the Latest Threats</a></li>
</ul></div>
</div>
</div>
<div class="g03_list g03_list_5">
<div class="parsys"><div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Contact Us</strong><br>
<div class="footer-list section">
<ul class="g03_block">
<li class="g03_item"><a href="tel:+1 877-347-3393" class="contactlinks">+1 877-347-3393</a><br>&nbsp;</li>
</ul>
</div></div>
<div class="htmlpassthru section">
<p style="margin-bottom:6px"><strong>Stay Connected</strong></p></div>
<div class="followus-footer section"><h4 class="g03_title" id="g03-followus-title"> </h4><ul class="g03_block g03-s" id="g03-followus-list"><li class="g03_item g03_item-s">
<a href="https://www.linkedin.com/company/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-li ficon-linkedin"></span>
<span class="g03-s_label">LinkedIn</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://twitter.com/fireeye" target="_blank">
<span class="g03-s-i ficon g03-s-i-tw ficon-twitter2"></span>
<span class="g03-s_label">Twitter</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.facebook.com/FireEye" target="_blank">
<span class="g03-s-i ficon g03-s-i-fb ficon-facebook2"></span>
<span class="g03-s_label">Facebook</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://www.youtube.com/user/FireEyeInc" target="_blank">
<span class="g03-s-i ficon g03-s-i-yt ficon-youtube2"></span>
<span class="g03-s_label">YouTube</span>
</a>
</li><li class="g03_item g03_item-s">
<a href="https://itunes.apple.com/us/podcast/eye-on-security/id1073779629?mt=2" target="_blank">
<span class="g03-s-i ficon g03-s-i-pc ficon-podcast"></span>
<span class="g03-s_label">Podcast</span>
</a>
</li></ul>
</div>
<div class="htmlpassthru section">
<div class="country-notification">
<div id="c08_modal-lang" class="c08_modal lang">
<div class="c08 c08v1">
<div class="c08_header">
<a href="#dismiss-lightbox" class="ficon ficon-close c08_dismiss" data-behavior="dismiss-c08"></a>
</div>
<div class="c08_content">
<div class="c08_body">
<div class="col FR">
<p class="type-ML">Cette page est également disponible en français.</p>
<div class="button section"><a class="btn" href="/index.html">Version française</a></div>
</div>
<div class="col DE">
<p class="type-ML">Diese Seite ist auch auf Deutsch verfügbar</p>
<div class="button section"><a class="btn" href="/index.html">Zur deutschen Seite wechseln</a></div>
</div>
<div class="col JP">
<p class="type-ML">日本語ページを</p>
<div class="button section"><a class="btn" href="/index.html">見る</a></div>
</div>
<div class="col KR">
<p class="type-ML">해당 페이지는 한글 버전으로 보실 수 있습니다</p>
<div class="button section"><a class="btn" href="/index.html">바로 가기</a></div>
</div>
<hr>
<div class="col">
<p><a class="dismiss" href="#dismiss-lightbox" data-behavior="dismiss-c08">Continue viewing this page in English</a></p>
</div>
</div>
</div>
</div>
</div>
<style>
.c08_modal.lang {
    background: rgba(255,255,255,0.8);
}
.c08_modal.lang .c08_header {
    background: transparent;
    border-left: none;
}
.c08_modal.lang .c08 {
    top: 20%;
    width: 600px;
    border-radius: 12px;
    box-shadow: rgba(0, 0, 0, 0.37) 0 0 15px;
    border: 1px solid #b4b5b8;
    background-image: url("/content/dam/fireeye-www/fw/images/bg-language-select.jpg");
    background-position: right bottom;
    margin: 0 auto;
    position: relative;
    max-width: 90%;
}
.c08_modal.lang .c08_dismiss {
    color: #222;
}
.c08_modal.lang .c08_body {
    padding: 12px 50px 60px;
}
.c08_modal.lang .col {
    display: none;
}
.c08_modal.lang .col:last-child {
    display: block;
}
.c08_modal.lang .btn {
    margin-bottom: 0;
}
.c08_modal.lang hr {
    margin: 30px 80px;
}
.c08_modal.lang hr:before {
    border-bottom: none;
}
</style>
</div></div>
</div>
</div></div>
<div class="legal-footer-wrapper">
<div class="legal-footer">
<div class="g03_copyright">
<p class="g03_copyright_p">
Copyright&nbsp;&copy;&nbsp;2021&nbsp;FireEye, Inc.&nbsp;All rights reserved.&nbsp;<span class="g03-legal"><a href="/company/privacy.html">Privacy &amp; Cookies Policy</a> | <a href="/company/privacy-shield-commitment.html">Privacy Shield</a> | <a href="/company/legal.html">Legal Documentation</a></span>
</p>
</div><div class="g03_languages">
<a class="g01_options-option" href="#footer-worldwide">
<span>Site Language</span>
<span>English<span class="ficon ficon-globe"></span></span>
</a>
<div class="option-menu" id="footer-worldwide">
<p><strong>My preferred language:</strong></p>
<ul class="g01_options_list"><li><a href="https://www.fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html" target="_blank">English (English)</a></li>
<li><a href="https://www.fireeye.fr" target="_blank">French (Français)</a></li>
<li><a href="https://www.fireeye.de" target="_blank">German (Deutsch)</a></li>
<li><a href="https://www.fireeye.jp" target="_blank">Japanese (日本語)</a></li>
<li><a href="https://www.fireeye.kr" target="_blank">Korean (한국어)</a></li>
<li><a href="/products/international-literature.html">More languages</a></li>
</ul>
</div>
</div> </div>
</div>
</footer>
</div>
<script type="text/javascript" src="/etc/designs/fireeye-www/clientlibs_fw.min.js"></script>


<div class="htmlpassthru_c66c htmlpassthru">

<script>
function changeSlide(a) {
    if(isNaN(a)){console.log("updating i");i=2;a=2;}
	$('#uc-he01_carousel').removeClass('uc-he01_s-1 uc-he01_s-2 uc-he01_s-3 uc-he01_s-4 uc-he01_s-5');
	$('.uc-he01_sc_s, .uc-he01_c_btn').removeClass('is-active');
	$('#uc-he01_sc_s-'+(a)+', [data-target="'+(a)+'"]').addClass('is-active animate');
	window.setTimeout(function() {$('.uc-he01_sc_s, .uc-he01_c_btn').not('#uc-he01_sc_s-'+(a)).removeClass('animate');}, 1000);
	$('#uc-he01_carousel').addClass('uc-he01_s-'+(a));
}
</script></div>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=fewebadmin"></script>
</body>
</html>
