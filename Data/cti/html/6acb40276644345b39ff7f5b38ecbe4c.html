<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="https://gmpg.org/xfn/11">

<title>Abusing GPO Permissions &#8211; harmj0y</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Feed" href="http://www.harmj0y.net/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Comments Feed" href="http://www.harmj0y.net/blog/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="harmj0y &raquo; Abusing GPO Permissions Comments Feed" href="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/feed/" />
		<script>
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.harmj0y.net\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style>
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='crayon-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='astra-theme-css-css'  href='http://www.harmj0y.net/blog/wp-content/themes/astra/assets/css/minified/main.min.css?ver=3.4.2' media='all' />
<style id='astra-theme-css-inline-css'>
html{font-size:93.75%;}a,.page-title{color:#1d798b;}a:hover,a:focus{color:#f9f9f9;}body,button,input,select,textarea,.ast-button,.ast-custom-button{font-family:'Roboto',sans-serif;font-weight:400;font-size:15px;font-size:1rem;}blockquote{color:#000000;}h1,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6,.site-title,.site-title a{font-family:'Oxanium',display;font-weight:400;}.site-title{font-size:35px;font-size:2.3333333333333rem;}header .custom-logo-link img{max-width:120px;}.astra-logo-svg{width:120px;}.ast-archive-description .ast-archive-title{font-size:40px;font-size:2.6666666666667rem;}.site-header .site-description{font-size:15px;font-size:1rem;}.entry-title{font-size:30px;font-size:2rem;}h1,.entry-content h1{font-size:40px;font-size:2.6666666666667rem;font-weight:400;font-family:'Oxanium',display;}h2,.entry-content h2{font-size:30px;font-size:2rem;font-weight:400;font-family:'Oxanium',display;}h3,.entry-content h3{font-size:25px;font-size:1.6666666666667rem;font-weight:400;font-family:'Oxanium',display;}h4,.entry-content h4{font-size:20px;font-size:1.3333333333333rem;}h5,.entry-content h5{font-size:18px;font-size:1.2rem;}h6,.entry-content h6{font-size:15px;font-size:1rem;}.ast-single-post .entry-title,.page-title{font-size:30px;font-size:2rem;}::selection{background-color:#33ccda;color:#000000;}body,h1,.entry-title a,.entry-content h1,h2,.entry-content h2,h3,.entry-content h3,h4,.entry-content h4,h5,.entry-content h5,h6,.entry-content h6{color:#3a3a3a;}.tagcloud a:hover,.tagcloud a:focus,.tagcloud a.current-item{color:#ffffff;border-color:#1d798b;background-color:#1d798b;}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,textarea:focus{border-color:#1d798b;}input[type="radio"]:checked,input[type=reset],input[type="checkbox"]:checked,input[type="checkbox"]:hover:checked,input[type="checkbox"]:focus:checked,input[type=range]::-webkit-slider-thumb{border-color:#1d798b;background-color:#1d798b;box-shadow:none;}.site-footer a:hover + .post-count,.site-footer a:focus + .post-count{background:#1d798b;border-color:#1d798b;}.single .nav-links .nav-previous,.single .nav-links .nav-next{color:#1d798b;}.entry-meta,.entry-meta *{line-height:1.45;color:#1d798b;}.entry-meta a:hover,.entry-meta a:hover *,.entry-meta a:focus,.entry-meta a:focus *,.page-links > .page-link,.page-links .page-link:hover,.post-navigation a:hover{color:#f9f9f9;}.widget-title{font-size:21px;font-size:1.4rem;color:#3a3a3a;}#cat option,.secondary .calendar_wrap thead a,.secondary .calendar_wrap thead a:visited{color:#1d798b;}.secondary .calendar_wrap #today,.ast-progress-val span{background:#1d798b;}.secondary a:hover + .post-count,.secondary a:focus + .post-count{background:#1d798b;border-color:#1d798b;}.calendar_wrap #today > a{color:#ffffff;}.page-links .page-link,.single .post-navigation a{color:#1d798b;}#secondary,#secondary button,#secondary input,#secondary select,#secondary textarea{font-size:15px;font-size:1rem;}#secondary {margin: 4em 0 2.5em;word-break: break-word;line-height: 2;}#secondary li {margin-bottom: 0.25em;}#secondary li:last-child {margin-bottom: 0;}@media (max-width: 768px) {.js_active .ast-plain-container.ast-single-post #secondary {margin-top: 1.5em;}}.ast-separate-container.ast-two-container #secondary .widget {background-color: #fff;padding: 2em;margin-bottom: 2em;}@media (min-width: 993px) {.ast-left-sidebar #secondary {padding-right: 60px;}.ast-right-sidebar #secondary {padding-left: 60px;}}@media (max-width: 993px) {.ast-right-sidebar #secondary {padding-left: 30px;}.ast-left-sidebar #secondary {padding-right: 30px;}}.wp-block-buttons.aligncenter{justify-content:center;}@media (min-width:1200px){.ast-separate-container.ast-right-sidebar .entry-content .wp-block-image.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-image.alignfull,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignfull{margin-left:-6.67em;margin-right:-6.67em;max-width:unset;width:unset;}.ast-separate-container.ast-right-sidebar .entry-content .wp-block-image.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-image.alignwide,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignwide{margin-left:-20px;margin-right:-20px;max-width:unset;width:unset;}}@media (min-width:1200px){.wp-block-group .has-background{padding:20px;}}@media (min-width:1200px){.ast-separate-container.ast-right-sidebar .entry-content .wp-block-group.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-group.alignwide,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignwide,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignwide{margin-left:-20px;margin-right:-20px;padding-left:20px;padding-right:20px;}.ast-separate-container.ast-right-sidebar .entry-content .wp-block-group.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-group.alignfull,.ast-separate-container.ast-right-sidebar .entry-content .wp-block-cover.alignfull,.ast-separate-container.ast-left-sidebar .entry-content .wp-block-cover.alignfull{margin-left:-6.67em;margin-right:-6.67em;padding-left:6.67em;padding-right:6.67em;}}@media (min-width:1200px){.wp-block-cover-image.alignwide .wp-block-cover__inner-container,.wp-block-cover.alignwide .wp-block-cover__inner-container,.wp-block-cover-image.alignfull .wp-block-cover__inner-container,.wp-block-cover.alignfull .wp-block-cover__inner-container{width:100%;}}.ast-plain-container.ast-no-sidebar #primary{margin-top:0;margin-bottom:0;}@media (max-width:921px){.ast-theme-transparent-header #primary,.ast-theme-transparent-header #secondary{padding:0;}}.wp-block-columns{margin-bottom:unset;}.wp-block-image.size-full{margin:2rem 0;}.wp-block-separator.has-background{padding:0;}.wp-block-gallery{margin-bottom:1.6em;}.wp-block-group{padding-top:4em;padding-bottom:4em;}.wp-block-group__inner-container .wp-block-columns:last-child,.wp-block-group__inner-container :last-child,.wp-block-table table{margin-bottom:0;}.blocks-gallery-grid{width:100%;}.wp-block-navigation-link__content{padding:5px 0;}.wp-block-group .wp-block-group .has-text-align-center,.wp-block-group .wp-block-column .has-text-align-center{max-width:100%;}.has-text-align-center{margin:0 auto;}@media (min-width:1200px){.wp-block-cover__inner-container,.alignwide .wp-block-group__inner-container,.alignfull .wp-block-group__inner-container{max-width:1200px;margin:0 auto;}.wp-block-group.alignnone,.wp-block-group.aligncenter,.wp-block-group.alignleft,.wp-block-group.alignright,.wp-block-group.alignwide,.wp-block-columns.alignwide{margin:2rem 0 1rem 0;}}@media (max-width:1200px){.wp-block-group{padding:3em;}.wp-block-group .wp-block-group{padding:1.5em;}.wp-block-columns,.wp-block-column{margin:1rem 0;}}@media (min-width:921px){.wp-block-columns .wp-block-group{padding:2em;}}@media (max-width:544px){.wp-block-cover-image .wp-block-cover__inner-container,.wp-block-cover .wp-block-cover__inner-container{width:unset;}.wp-block-cover,.wp-block-cover-image{padding:2em 0;}.wp-block-group,.wp-block-cover{padding:2em;}.wp-block-media-text__media img,.wp-block-media-text__media video{width:unset;max-width:100%;}.wp-block-media-text.has-background .wp-block-media-text__content{padding:1em;}}@media (max-width:921px){.ast-plain-container.ast-no-sidebar #primary{padding:0;}}@media (min-width:544px){.entry-content .wp-block-media-text.has-media-on-the-right .wp-block-media-text__content{padding:0 8% 0 0;}.entry-content .wp-block-media-text .wp-block-media-text__content{padding:0 0 0 8%;}.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-bottom-left > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-bottom-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-top-left > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-top-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-center-right > *,.ast-plain-container .site-content .entry-content .has-custom-content-position.is-position-center-left > *{margin:0;}}@media (max-width:544px){.entry-content .wp-block-media-text .wp-block-media-text__content{padding:8% 0;}.wp-block-media-text .wp-block-media-text__media img{width:auto;max-width:100%;}}.wp-block-button.is-style-outline .wp-block-button__link{border-color:#33ccda;border-top-width:2px;border-right-width:2px;border-bottom-width:2px;border-left-width:2px;}.wp-block-button.is-style-outline > .wp-block-button__link:not(.has-text-color),.wp-block-button.wp-block-button__link.is-style-outline:not(.has-text-color){color:#33ccda;}.wp-block-button.is-style-outline .wp-block-button__link:hover,.wp-block-button.is-style-outline .wp-block-button__link:focus{color:#000000 !important;background-color:#f9f9f9;border-color:#f9f9f9;}.post-page-numbers.current .page-link,.ast-pagination .page-numbers.current{color:#000000;border-color:#33ccda;background-color:#33ccda;border-radius:2px;}@media (max-width:921px){.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (max-width:544px){.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (min-width:544px){.entry-content > .alignleft{margin-right:20px;}.entry-content > .alignright{margin-left:20px;}.wp-block-group.has-background{padding:20px;}}@media (max-width:921px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single{padding:1.5em 2.14em;}.ast-separate-container #primary,.ast-separate-container #secondary{padding:1.5em 0;}#primary,#secondary{padding:1.5em 0;margin:0;}.ast-left-sidebar #content > .ast-container{display:flex;flex-direction:column-reverse;width:100%;}.ast-author-box img.avatar{margin:20px 0 0 0;}}@media (max-width:921px){#secondary.secondary{padding-top:0;}.ast-separate-container.ast-right-sidebar #secondary{padding-left:1em;padding-right:1em;}.ast-separate-container.ast-two-container #secondary{padding-left:0;padding-right:0;}.ast-page-builder-template .entry-header #secondary,.ast-page-builder-template #secondary{margin-top:1.5em;}}@media (max-width:921px){.ast-right-sidebar #primary{padding-right:0;}.ast-page-builder-template.ast-left-sidebar #secondary,.ast-page-builder-template.ast-right-sidebar #secondary{padding-right:20px;padding-left:20px;}.ast-right-sidebar #secondary,.ast-left-sidebar #primary{padding-left:0;}.ast-left-sidebar #secondary{padding-right:0;}}@media (min-width:922px){.ast-separate-container.ast-right-sidebar #primary,.ast-separate-container.ast-left-sidebar #primary{border:0;}.search-no-results.ast-separate-container #primary{margin-bottom:4em;}}@media (min-width:922px){.ast-right-sidebar #primary{border-right:1px solid #eee;}.ast-left-sidebar #primary{border-left:1px solid #eee;}.ast-right-sidebar #secondary{border-left:1px solid #eee;margin-left:-1px;}.ast-left-sidebar #secondary{border-right:1px solid #eee;margin-right:-1px;}.ast-separate-container.ast-two-container.ast-right-sidebar #secondary{padding-left:30px;padding-right:0;}.ast-separate-container.ast-two-container.ast-left-sidebar #secondary{padding-right:30px;padding-left:0;}.ast-separate-container.ast-right-sidebar #secondary,.ast-separate-container.ast-left-sidebar #secondary{border:0;margin-left:auto;margin-right:auto;}.ast-separate-container.ast-two-container #secondary .widget:last-child{margin-bottom:0;}}.wp-block-button .wp-block-button__link,{color:#000000;}.wp-block-button .wp-block-button__link:hover,.wp-block-button .wp-block-button__link:focus{color:#000000;background-color:#f9f9f9;border-color:#f9f9f9;}.wp-block-button .wp-block-button__link{border:none;background-color:#33ccda;color:#000000;font-family:inherit;font-weight:inherit;line-height:1;border-radius:2px;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{border-style:solid;border-top-width:2px;border-right-width:2px;border-left-width:2px;border-bottom-width:2px;border-color:#33ccda;padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}@media (max-width:921px){.wp-block-button .wp-block-button__link{border:none;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}@media (max-width:544px){.wp-block-button .wp-block-button__link{border:none;padding:15px 30px;}.wp-block-button.is-style-outline .wp-block-button__link{padding-top:calc(15px - 2px);padding-right:calc(30px - 2px);padding-bottom:calc(15px - 2px);padding-left:calc(30px - 2px);}}.menu-toggle,button,.ast-button,.ast-custom-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"]{border-style:solid;border-top-width:0;border-right-width:0;border-left-width:0;border-bottom-width:0;color:#000000;border-color:#33ccda;background-color:#33ccda;border-radius:2px;padding-top:10px;padding-right:40px;padding-bottom:10px;padding-left:40px;font-family:inherit;font-weight:inherit;line-height:1;}button:focus,.menu-toggle:hover,button:hover,.ast-button:hover,.ast-custom-button:hover .button:hover,.ast-custom-button:hover ,input[type=reset]:hover,input[type=reset]:focus,input#submit:hover,input#submit:focus,input[type="button"]:hover,input[type="button"]:focus,input[type="submit"]:hover,input[type="submit"]:focus{color:#000000;background-color:#f9f9f9;border-color:#f9f9f9;}@media (min-width:544px){.ast-container{max-width:100%;}}@media (max-width:544px){.ast-separate-container .ast-article-post,.ast-separate-container .ast-article-single,.ast-separate-container .comments-title,.ast-separate-container .ast-archive-description{padding:1.5em 1em;}.ast-separate-container #content .ast-container{padding-left:0.54em;padding-right:0.54em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-search-menu-icon.ast-dropdown-active .search-field{width:170px;}.ast-separate-container #secondary{padding-top:0;}.ast-separate-container.ast-two-container #secondary .widget{margin-bottom:1.5em;padding-left:1em;padding-right:1em;}}@media (max-width:544px){.ast-separate-container .comments-count-wrapper{padding:1.5em 1em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-separate-container .comment-respond{padding:1.5em 1em;}}@media (max-width:544px){.ast-comment-list .children{margin-left:0.66666em;}.ast-separate-container .ast-comment-list .bypostauthor li{padding:0 0 0 .5em;}}@media (max-width:921px){.ast-mobile-header-stack .main-header-bar .ast-search-menu-icon{display:inline-block;}.ast-header-break-point.ast-header-custom-item-outside .ast-mobile-header-stack .main-header-bar .ast-search-icon{margin:0;}.ast-comment-avatar-wrap img{max-width:2.5em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}}@media (max-width:921px){.ast-comment-avatar-wrap img{max-width:2.5em;}.comments-area{margin-top:1.5em;}.ast-separate-container .comments-count-wrapper{padding:2em 2.14em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}}@media (max-width:921px){.ast-comment-avatar-wrap{margin-right:0.5em;}}body,.ast-separate-container{background-color:#f9f9f9;;background-image:none;;}@media (max-width:921px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:30px;}}@media (max-width:544px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1{font-size:30px;}h2,.entry-content h2{font-size:25px;}h3,.entry-content h3{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:30px;}}@media (max-width:921px){html{font-size:85.5%;}}@media (max-width:544px){html{font-size:85.5%;}}@media (min-width:922px){.ast-container{max-width:1240px;}}@media (min-width:922px){.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu:hover > .sub-menu,.main-header-menu .sub-menu .menu-item.ast-left-align-sub-menu.focus > .sub-menu{margin-left:-0px;}}.ast-breadcrumbs .trail-browse,.ast-breadcrumbs .trail-items,.ast-breadcrumbs .trail-items li{display:inline-block;margin:0;padding:0;border:none;background:inherit;text-indent:0;}.ast-breadcrumbs .trail-browse{font-size:inherit;font-style:inherit;font-weight:inherit;color:inherit;}.ast-breadcrumbs .trail-items{list-style:none;}.trail-items li::after{padding:0 0.3em;content:"\00bb";}.trail-items li:last-of-type::after{display:none;}@media (max-width:921px){.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}@media (max-width:544px){.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-firstrow .ast-builder-grid-row > *:first-child,.ast-builder-grid-row-container.ast-builder-grid-row-mobile-3-lastrow .ast-builder-grid-row > *:last-child{grid-column:1 / -1;}}.ast-builder-layout-element[data-section="title_tagline"]{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-layout-element[data-section="title_tagline"]{display:flex;}}.ast-builder-menu-1{font-family:'Oxanium',display;font-weight:inherit;text-transform:uppercase;}.ast-builder-menu-1 .menu-item > .menu-link{color:#33ccda;}.ast-builder-menu-1 .menu-item > .ast-menu-toggle{color:#33ccda;}.ast-builder-menu-1 .menu-item:hover > .menu-link,.ast-builder-menu-1 .inline-on-mobile .menu-item:hover > .ast-menu-toggle{color:#ffffff;}.ast-builder-menu-1 .menu-item:hover > .ast-menu-toggle{color:#ffffff;}.ast-builder-menu-1 .sub-menu,.ast-builder-menu-1 .inline-on-mobile .sub-menu{border-top-width:2px;border-bottom-width:0;border-right-width:0;border-left-width:0;border-color:#33ccda;border-style:solid;border-radius:0;}.ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu,.ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper{margin-top:0;}.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .sub-menu:before,.ast-desktop .ast-builder-menu-1 .main-header-menu > .menu-item > .astra-full-megamenu-wrapper:before{height:calc( 0px + 5px );}.ast-desktop .ast-builder-menu-1 .menu-item .sub-menu .menu-link{border-style:none;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-1 .menu-item-has-children > .menu-link:after{content:unset;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1 .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-1{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-1{display:flex;}}.site-below-footer-wrap[data-section="section-below-footer-builder"]{background-color:#eeeeee;;min-height:80px;}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row{max-width:1200px;margin-left:auto;margin-right:auto;}.site-below-footer-wrap[data-section="section-below-footer-builder"] .ast-builder-grid-row,.site-below-footer-wrap[data-section="section-below-footer-builder"] .site-footer-section{align-items:flex-start;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-full .ast-builder-grid-row{grid-template-columns:1fr;}@media (max-width:921px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-full .ast-builder-grid-row{grid-template-columns:1fr;}}@media (max-width:544px){.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-below-footer-wrap[data-section="section-below-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-below-footer-wrap[data-section="section-below-footer-builder"]{display:grid;}}.ast-footer-copyright{text-align:center;}.ast-footer-copyright {color:#3a3a3a;}@media (max-width:921px){.ast-footer-copyright{text-align:center;}}@media (max-width:544px){.ast-footer-copyright{text-align:center;}}.ast-footer-copyright.ast-builder-layout-element{display:flex;}@media (max-width:921px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}@media (max-width:544px){.ast-header-break-point .ast-footer-copyright.ast-builder-layout-element{display:flex;}}.site-footer{background-color:;;background-image:none;;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{background-color:#f9f9f9;;border-style:solid;border-width:0px;border-top-width:1px;border-top-color:#e6e6e6;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row{max-width:1200px;margin-left:auto;margin-right:auto;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .ast-builder-grid-row,.site-primary-footer-wrap[data-section="section-primary-footer-builder"] .site-footer-section{align-items:flex-start;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-inline .site-footer-section{display:flex;margin-bottom:0;}.ast-builder-grid-row-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}@media (max-width:921px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-tablet-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-tablet-3-equal .ast-builder-grid-row{grid-template-columns:repeat( 3,1fr );}}@media (max-width:544px){.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-inline .site-footer-section{display:flex;margin-bottom:0;}.site-primary-footer-wrap[data-section="section-primary-footer-builder"].ast-footer-row-mobile-stack .site-footer-section{display:block;margin-bottom:10px;}.ast-builder-grid-row-container.ast-builder-grid-row-mobile-full .ast-builder-grid-row{grid-template-columns:1fr;}}.site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}@media (max-width:921px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}@media (max-width:544px){.ast-header-break-point .site-primary-footer-wrap[data-section="section-primary-footer-builder"]{display:grid;}}.elementor-template-full-width .ast-container{display:block;}.ast-header-break-point .main-header-bar{border-bottom-width:1px;}@media (min-width:922px){.main-header-bar{border-bottom-width:1px;}}@media (min-width:922px){#primary{width:70%;}#secondary{width:30%;}}.ast-safari-browser-less-than-11 .main-header-menu .menu-item, .ast-safari-browser-less-than-11 .main-header-bar .ast-masthead-custom-menu-items{display:block;}.main-header-menu .menu-item, #astra-footer-menu .menu-item, .main-header-bar .ast-masthead-custom-menu-items{-js-display:flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;}.main-header-menu > .menu-item > .menu-link, #astra-footer-menu > .menu-item > .menu-link,{height:100%;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-js-display:flex;display:flex;}.ast-primary-menu-disabled .main-header-bar .ast-masthead-custom-menu-items{flex:unset;}.ast-header-break-point .main-navigation ul .menu-item .menu-link .icon-arrow:first-of-type svg{top:.2em;margin-top:0px;margin-left:0px;width:.65em;transform:translate(0, -2px) rotateZ(270deg);}.ast-mobile-popup-content .ast-submenu-expanded > .ast-menu-toggle{transform:rotateX(180deg);}.ast-mobile-header-content > *,.ast-desktop-header-content > * {padding: 10px 0;height: auto;}.ast-mobile-header-content > *:first-child,.ast-desktop-header-content > *:first-child {padding-top: 10px;}.ast-mobile-header-content > .ast-builder-menu,.ast-desktop-header-content > .ast-builder-menu {padding-top: 0;}.ast-mobile-header-content > *:last-child,.ast-desktop-header-content > *:last-child {padding-bottom: 0;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search label,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search label {width: 100%;}.ast-desktop-header-content .main-header-bar-navigation .ast-submenu-expanded > .ast-menu-toggle::before {transform: rotateX(180deg);}#ast-desktop-header .ast-desktop-header-content,.ast-mobile-header-content .ast-search-icon,.ast-desktop-header-content .ast-search-icon,.ast-off-canvas-active .ast-main-header-nav-open.ast-popup-nav-open .ast-mobile-header-wrap .ast-mobile-header-content,.ast-mobile-header-wrap .ast-mobile-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-mobile-header-wrap .ast-mobile-header-content,.ast-off-canvas-active .ast-main-header-nav-open.ast-popup-nav-open .ast-desktop-header-content,.ast-main-header-nav-open.ast-popup-nav-open .ast-desktop-header-content {display: none;}.ast-main-header-nav-open.ast-header-break-point #ast-desktop-header .ast-desktop-header-content,.ast-main-header-nav-open.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content {display: block;}.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-up > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-slide-down > .menu-item .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item > .sub-menu,.ast-desktop .ast-desktop-header-content .astra-menu-animation-fade > .menu-item .menu-item > .sub-menu {opacity: 1;visibility: visible;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation {width: unset;margin: unset;}.ast-mobile-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle,.ast-desktop-header-content.content-align-flex-end .main-header-bar-navigation .menu-item-has-children > .ast-menu-toggle {left: calc( 20px - 0.907em);}.ast-mobile-header-content .ast-search-menu-icon,.ast-mobile-header-content .ast-search-menu-icon.slide-search,.ast-desktop-header-content .ast-search-menu-icon,.ast-desktop-header-content .ast-search-menu-icon.slide-search {width: 100%;position: relative;display: block;right: auto;transform: none;}.ast-mobile-header-content .ast-search-menu-icon.slide-search .search-form,.ast-mobile-header-content .ast-search-menu-icon .search-form,.ast-desktop-header-content .ast-search-menu-icon.slide-search .search-form,.ast-desktop-header-content .ast-search-menu-icon .search-form {right: 0;visibility: visible;opacity: 1;position: relative;top: auto;transform: none;padding: 0;display: block;overflow: hidden;}.ast-mobile-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-mobile-header-content .ast-search-menu-icon .search-field,.ast-desktop-header-content .ast-search-menu-icon.ast-inline-search .search-field,.ast-desktop-header-content .ast-search-menu-icon .search-field {width: 100%;padding-right: 5.5em;}.ast-mobile-header-content .ast-search-menu-icon .search-submit,.ast-desktop-header-content .ast-search-menu-icon .search-submit {display: block;position: absolute;height: 100%;top: 0;right: 0;padding: 0 1em;border-radius: 0;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation ul .sub-menu .menu-link {padding-left: 30px;}.ast-hfb-header.ast-default-menu-enable.ast-header-break-point .ast-mobile-header-wrap .ast-mobile-header-content .main-header-bar-navigation .sub-menu .menu-item .menu-item .menu-link {padding-left: 40px;}.ast-mobile-popup-drawer.active .ast-mobile-popup-inner{background-color:#ffffff;;}.ast-mobile-header-wrap .ast-mobile-header-content, .ast-desktop-header-content{background-color:#ffffff;;}.ast-mobile-popup-content > *, .ast-mobile-header-content > *, .ast-desktop-popup-content > *, .ast-desktop-header-content > *{padding-top:0;padding-bottom:0;}.content-align-flex-start .ast-builder-layout-element{justify-content:flex-start;}.content-align-flex-start .main-header-menu{text-align:left;}.ast-mobile-popup-drawer.active .ast-mobile-popup-drawer.active .menu-toggle-close{color:#3a3a3a;}.ast-mobile-header-wrap .ast-primary-header-bar,.ast-primary-header-bar .site-primary-header-wrap{min-height:70px;}.ast-desktop .ast-primary-header-bar .main-header-menu > .menu-item{line-height:70px;}@media (max-width:921px){#masthead .ast-mobile-header-wrap .ast-above-header-bar,#masthead .ast-mobile-header-wrap .ast-primary-header-bar,#masthead .ast-mobile-header-wrap .ast-below-header-bar{padding-left:20px;padding-right:20px;}}.ast-header-break-point .ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:#eaeaea;border-bottom-style:solid;}@media (min-width:922px){.ast-primary-header-bar{border-bottom-width:1px;border-bottom-color:#eaeaea;border-bottom-style:solid;}}.ast-primary-header-bar{background-color:#191919;;background-image:none;;}.ast-primary-header-bar{display:block;}@media (max-width:921px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}@media (max-width:544px){.ast-header-break-point .ast-primary-header-bar{display:grid;}}[data-section="section-header-mobile-trigger"] .ast-button-wrap .ast-mobile-menu-trigger-minimal{color:#33ccda;border:none;background:transparent;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-toggle-icon .ast-mobile-svg{width:20px;height:20px;fill:#33ccda;}[data-section="section-header-mobile-trigger"] .ast-button-wrap .mobile-menu-wrap .mobile-menu{color:#33ccda;}.ast-builder-menu-mobile .main-navigation .menu-item > .menu-link{font-family:inherit;font-weight:inherit;}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}.ast-hfb-header .ast-builder-menu-mobile .main-header-menu, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .menu-link, .ast-hfb-header .ast-builder-menu-mobile .main-navigation .menu-item .sub-menu .menu-link{border-style:none;}.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}@media (max-width:921px){.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}.ast-builder-menu-mobile .main-navigation .menu-item-has-children > .menu-link:after{content:unset;}}@media (max-width:544px){.ast-builder-menu-mobile .main-navigation .menu-item.menu-item-has-children > .ast-menu-toggle{top:0;}}.ast-builder-menu-mobile .main-navigation{display:block;}@media (max-width:921px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}@media (max-width:544px){.ast-header-break-point .ast-builder-menu-mobile .main-navigation{display:block;}}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-vertical-menu .menu-item{align-items:center;}@media (max-width:921px){.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-vertical-menu{display:grid;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-tablet-vertical-menu .menu-item{align-items:center;}#astra-footer-menu .menu-item > a{padding-left:20px;padding-right:20px;}}@media (max-width:544px){.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-horizontal-menu{justify-content:center;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-vertical-menu{display:grid;}.footer-widget-area[data-section="section-footer-menu"] .astra-footer-mobile-vertical-menu .menu-item{align-items:center;}}.footer-widget-area[data-section="section-footer-menu"]{display:block;}@media (max-width:921px){.ast-header-break-point .footer-widget-area[data-section="section-footer-menu"]{display:block;}}@media (max-width:544px){.ast-header-break-point .footer-widget-area[data-section="section-footer-menu"]{display:block;}}.comment-reply-title{font-size:24px;font-size:1.6rem;}.ast-comment-meta{line-height:1.666666667;color:#1d798b;font-size:12px;font-size:0.8rem;}.ast-comment-list #cancel-comment-reply-link{font-size:15px;font-size:1rem;}.comments-title {padding: 2em 0;}.comments-title {font-weight: normal;word-wrap: break-word;}.ast-comment-list {margin: 0;word-wrap: break-word;padding-bottom: 0.5em;list-style: none;}.ast-comment-list li {list-style: none;}.ast-comment-list .ast-comment-edit-reply-wrap {-js-display: flex;display: flex;justify-content: flex-end;}.ast-comment-list .ast-edit-link {flex: 1;}.ast-comment-list .comment-awaiting-moderation {margin-bottom: 0;}.ast-comment {padding: 1em 0;}.ast-comment-info img {border-radius: 50%;}.ast-comment-cite-wrap cite {font-style: normal;}.comment-reply-title {padding-top: 1em;font-weight: normal;line-height: 1.65;}.ast-comment-meta {margin-bottom: 0.5em;}.comments-area {border-top: 1px solid #eeeeee;margin-top: 2em;}.comments-area .comment-form-comment {width: 100%;border: none;margin: 0;padding: 0;}.comments-area .comment-notes,.comments-area .comment-textarea,.comments-area .form-allowed-tags {margin-bottom: 1.5em;}.comments-area .form-submit {margin-bottom: 0;}.comments-area textarea#comment,.comments-area .ast-comment-formwrap input[type="text"] {width: 100%;border-radius: 0;vertical-align: middle;margin-bottom: 10px;}.comments-area .no-comments {margin-top: 0.5em;margin-bottom: 0.5em;}.comments-area p.logged-in-as {margin-bottom: 1em;}.ast-separate-container .comments-title {background-color: #fff;padding: 1.2em 3.99em 0;}.ast-separate-container .comments-area {border-top: 0;}.ast-separate-container .ast-comment-list {padding-bottom: 0;}.ast-separate-container .ast-comment-list li {background-color: #fff;}.ast-separate-container .ast-comment-list li.depth-1 {padding: 4em 6.67em;margin-bottom: 2em;}@media (max-width: 1200px) {.ast-separate-container .ast-comment-list li.depth-1 {padding: 3em 3.34em;}}.ast-separate-container .ast-comment-list li.depth-1 .children li {padding-bottom: 0;padding-top: 0;margin-bottom: 0;}.ast-separate-container .ast-comment-list li.depth-1 .ast-comment,.ast-separate-container .ast-comment-list li.depth-2 .ast-comment {border-bottom: 0;}.ast-separate-container .ast-comment-list .comment-respond {padding-top: 0;padding-bottom: 1em;background-color: transparent;}.ast-separate-container .ast-comment-list .pingback p {margin-bottom: 0;}.ast-separate-container .ast-comment-list .bypostauthor {padding: 2em;margin-bottom: 1em;}.ast-separate-container .ast-comment-list .bypostauthor li {background: transparent;margin-bottom: 0;padding: 0 0 0 2em;}.ast-separate-container .comment-respond {background-color: #fff;padding: 4em 6.67em;border-bottom: 0;}@media (max-width: 1200px) {.ast-separate-container .comment-respond {padding: 3em 2.34em;}}.ast-separate-container .comment-reply-title {padding-top: 0;}.ast-comment-list .children {margin-left: 2em;}@media (max-width: 992px) {.ast-comment-list .children {margin-left: 1em;}}.ast-comment-list #cancel-comment-reply-link {white-space: nowrap;font-size: 15px;font-size: 1rem;margin-left: 1em;}.ast-comment-info {display: flex;position: relative;}.ast-comment-meta {justify-content: right;padding: 0 3.4em 1.60em;}.ast-comment-time .timendate{margin-right: 0.5em;}.comments-area #wp-comment-cookies-consent {margin-right: 10px;}.ast-page-builder-template .comments-area {padding-left: 20px;padding-right: 20px;margin-top: 2em;margin-bottom: 2em;}.ast-separate-container .ast-comment-list .bypostauthor .bypostauthor {background: transparent;margin-bottom: 0;padding-right: 0;padding-bottom: 0;padding-top: 0;}@media (min-width:922px){.ast-separate-container .ast-comment-list li .comment-respond{padding-left:2.66666em;padding-right:2.66666em;}}@media (max-width:544px){.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 1em;margin-bottom:1.5em;}.ast-separate-container .ast-comment-list .bypostauthor{padding:.5em;}.ast-separate-container .comment-respond{padding:1.5em 1em;}}@media (max-width:921px){.ast-comment-avatar-wrap img{max-width:2.5em;}.comments-area{margin-top:1.5em;}.ast-separate-container .comments-title{padding:1.43em 1.48em;}.ast-comment-meta{padding:0 1.8888em 1.3333em;}.ast-separate-container .ast-comment-list li.depth-1{padding:1.5em 2.14em;}.ast-separate-container .comment-respond{padding:2em 2.14em;}}
</style>
<link rel='stylesheet' id='astra-google-fonts-css'  href='//fonts.googleapis.com/css?family=Roboto%3A400%2C%7COxanium%3A400%2C&#038;display=fallback&#038;ver=3.4.2' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='http://www.harmj0y.net/blog/wp-includes/css/dist/block-library/style.min.css?ver=5.7.2' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='tablepress-default-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/tablepress/css/default.min.css?ver=1.13' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='http://www.harmj0y.net/blog/wp-content/plugins/jetpack/css/jetpack.css?ver=9.7' media='all' />
<script src='http://www.harmj0y.net/blog/wp-includes/js/jquery/jquery.min.js?ver=3.5.1' id='jquery-core-js'></script>
<script src='http://www.harmj0y.net/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script id='crayon_js-js-extra'>
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.harmj0y.net\/blog\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src='http://www.harmj0y.net/blog/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta' id='crayon_js-js'></script>
<!--[if IE]>
<script src='http://www.harmj0y.net/blog/wp-content/themes/astra/assets/js/minified/flexibility.min.js?ver=3.4.2' id='astra-flexibility-js'></script>
<script id='astra-flexibility-js-after'>
flexibility(document.documentElement);
</script>
<![endif]-->
<link rel="https://api.w.org/" href="http://www.harmj0y.net/blog/wp-json/" /><link rel="alternate" type="application/json" href="http://www.harmj0y.net/blog/wp-json/wp/v2/posts/2450" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.harmj0y.net/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.harmj0y.net/blog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<link rel="canonical" href="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/" />
<link rel='shortlink' href='https://wp.me/p4qDDn-Dw' />
<link rel="alternate" type="application/json+oembed" href="http://www.harmj0y.net/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.harmj0y.net%2Fblog%2Fredteaming%2Fabusing-gpo-permissions%2F" />
<link rel="alternate" type="text/xml+oembed" href="http://www.harmj0y.net/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.harmj0y.net%2Fblog%2Fredteaming%2Fabusing-gpo-permissions%2F&#038;format=xml" />
<link rel="pingback" href="http://www.harmj0y.net/blog/xmlrpc.php">

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Abusing GPO Permissions" />
<meta property="og:url" content="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/" />
<meta property="og:description" content="A friend (@piffd0s) recently ran into a specific situation I hadn&#8217;t encountered before: the domain controllers and domain admins of the environment he was assessing were extremely locked down…" />
<meta property="article:published_time" content="2016-03-17T11:16:20+00:00" />
<meta property="article:modified_time" content="2016-03-17T15:42:38+00:00" />
<meta property="og:site_name" content="harmj0y" />
<meta property="og:image" content="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/get_netgpo_computer-1024x530.png" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="331" />
<meta property="og:image:alt" content="get_netgpo_computer" />
<meta name="twitter:text:title" content="Abusing GPO Permissions" />
<meta name="twitter:image" content="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/get_netgpo_computer-1024x530.png?w=640" />
<meta name="twitter:image:alt" content="get_netgpo_computer" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-32x32.png" sizes="32x32" />
<link rel="icon" href="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-180x180.png" />
<meta name="msapplication-TileImage" content="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/cropped-Favicon-1-270x270.png" />
			<style type="text/css" id="wp-custom-css">
				.btn {
  text-decoration: none;
	font-size: 18px;
	padding: 1rem 3rem;
	color: #ffffff;
	text-transform:uppercase;
  border: 1px solid rgb(146, 148, 248);
  position: relative;
  overflow: hidden;
	display: fixed;
  justify-content: center;
  align-items: center;
}

.btn:hover {
  box-shadow: 1px 1px 25px 10px rgba(146, 148, 248, 0.4);
}

.btn:before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  transition: all 650ms;
}

.btn:hover:before {
  left: 100%;
}
			</style>
		</head>

<body itemtype='https://schema.org/Blog' itemscope='itemscope' class="post-template-default single single-post postid-2450 single-format-standard wp-custom-logo ast-blog-single-style-1 ast-single-post ast-inherit-site-logo-transparent ast-hfb-header ast-desktop ast-separate-container ast-right-sidebar astra-3.4.2 ast-normal-title-enabled elementor-default elementor-kit-5017">
<div 
class="hfeed site" id="page">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
			<header
		class="site-header header-main-layout-1 ast-primary-menu-enabled ast-logo-title-inline ast-hide-custom-menu-mobile ast-builder-menu-toggle-icon ast-mobile-header-inline" id="masthead" itemtype="https://schema.org/WPHeader" itemscope="itemscope" itemid="#masthead"		>
			<div id="ast-desktop-header" data-toggle-type="dropdown">
		<div class="ast-main-header-wrap main-header-bar-wrap ">
		<div class="ast-primary-header-bar ast-primary-header main-header-bar site-header-focus-item" data-section="section-primary-header-builder">
						<div class="site-primary-header-wrap ast-builder-grid-row-container site-header-focus-item ast-container" data-section="section-primary-header-builder">
				<div class="ast-builder-grid-row ast-builder-grid-row-has-sides ast-builder-grid-row-no-center">
											<div class="site-header-primary-section-left site-header-section ast-flex site-header-section-left">
									<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="title_tagline">
											<div
				class="site-branding ast-site-identity" itemtype="https://schema.org/Organization" itemscope="itemscope"				>
					<span class="site-logo-img"><a href="http://www.harmj0y.net/blog/" class="custom-logo-link" rel="home"><img width="120" height="38" src="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png" class="custom-logo" alt="harmj0y logo" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png 120w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-300x95.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-768x242.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union.png 904w" sizes="(max-width: 120px) 100vw, 120px" /></a></span>				</div>
			<!-- .site-branding -->
					</div>
								</div>
																									<div class="site-header-primary-section-right site-header-section ast-flex ast-grid-right-section">
										<div class="ast-builder-menu-1 ast-builder-menu ast-flex ast-builder-menu-1-focus-item ast-builder-layout-element site-header-focus-item" data-section="section-hb-menu-1">
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation ast-flex-1"><nav class="site-navigation" id="site-navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" class="ast-flex-grow-1 navigation-accessibility" aria-label="Site Navigation"><div id="ast-hf-menu-1" class="main-navigation ast-inline-flex"><ul class="main-header-menu ast-nav-menu ast-flex  submenu-with-border ast-menu-hover-style-overline  stack-on-mobile"><li class="page_item page-item-12 menu-item"><a href="http://www.harmj0y.net/blog/about/" class="menu-link">About</a></li><li class="page_item page-item-20 menu-item"><a href="http://www.harmj0y.net/blog/presentations/" class="menu-link">Presentations</a></li><li class="page_item page-item-10 menu-item"><a href="http://www.harmj0y.net/blog/projects/" class="menu-link">Projects</a></li></ul></div></nav></div></div>		</div>
									</div>
												</div>
					</div>
								</div>
			</div>
		<div class="ast-desktop-header-content content-align-flex-start ">
			</div>
</div> <!-- Main Header Bar Wrap -->
<div id="ast-mobile-header" class="ast-mobile-header-wrap " data-type="dropdown">
		<div class="ast-main-header-wrap main-header-bar-wrap" >
		<div class="ast-primary-header-bar ast-primary-header main-header-bar site-primary-header-wrap site-header-focus-item ast-builder-grid-row-layout-default ast-builder-grid-row-tablet-layout-default ast-builder-grid-row-mobile-layout-default" data-section="section-primary-header-builder">
									<div class="ast-builder-grid-row ast-builder-grid-row-has-sides ast-builder-grid-row-no-center">
													<div class="site-header-primary-section-left site-header-section ast-flex site-header-section-left">
										<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="title_tagline">
											<div
				class="site-branding ast-site-identity" itemtype="https://schema.org/Organization" itemscope="itemscope"				>
					<span class="site-logo-img"><a href="http://www.harmj0y.net/blog/" class="custom-logo-link" rel="home"><img width="120" height="38" src="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png" class="custom-logo" alt="harmj0y logo" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-120x38.png 120w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-300x95.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union-768x242.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2021/05/Union.png 904w" sizes="(max-width: 120px) 100vw, 120px" /></a></span>				</div>
			<!-- .site-branding -->
					</div>
									</div>
																									<div class="site-header-primary-section-right site-header-section ast-flex ast-grid-right-section">
										<div class="ast-builder-layout-element ast-flex site-header-focus-item" data-section="section-header-mobile-trigger">
						<div class="ast-button-wrap">
				<button type="button" class="menu-toggle main-header-menu-toggle ast-mobile-menu-trigger-minimal"   aria-expanded="false">
					<span class="screen-reader-text">Main Menu</span>
					<span class="mobile-menu-toggle-icon">
						<span class="ahfb-svg-iconset ast-inline-flex svg-baseline"><svg role='img' class='ast-mobile-svg ast-menu-svg' fill='currentColor' version='1.1' xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path d='M3 13h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 7h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1zM3 19h18c0.552 0 1-0.448 1-1s-0.448-1-1-1h-18c-0.552 0-1 0.448-1 1s0.448 1 1 1z'></path></svg></span><span class="ahfb-svg-iconset ast-inline-flex svg-baseline"><svg class='ast-mobile-svg ast-close-svg' fill='currentColor' version='1.1' xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path d='M5.293 6.707l5.293 5.293-5.293 5.293c-0.391 0.391-0.391 1.024 0 1.414s1.024 0.391 1.414 0l5.293-5.293 5.293 5.293c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414l-5.293-5.293 5.293-5.293c0.391-0.391 0.391-1.024 0-1.414s-1.024-0.391-1.414 0l-5.293 5.293-5.293-5.293c-0.391-0.391-1.024-0.391-1.414 0s-0.391 1.024 0 1.414z'></path></svg></span>					</span>
									</button>
			</div>
					</div>
									</div>
											</div>
						</div>
	</div>
		<div class="ast-mobile-header-content content-align-flex-start ">
				<div class="ast-builder-menu-mobile ast-builder-menu ast-builder-menu-mobile-focus-item ast-builder-layout-element site-header-focus-item" data-section="section-header-mobile-menu">
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation"><nav class="site-navigation" id="site-navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" class="ast-flex-grow-1 navigation-accessibility" aria-label="Site Navigation"><div id="ast-hf-mobile-menu" class="main-navigation"><ul class="main-header-menu ast-nav-menu ast-flex  submenu-with-border astra-menu-animation-fade  stack-on-mobile"><li class="page_item page-item-12 menu-item"><a href="http://www.harmj0y.net/blog/about/" class="menu-link">About</a></li><li class="page_item page-item-20 menu-item"><a href="http://www.harmj0y.net/blog/presentations/" class="menu-link">Presentations</a></li><li class="page_item page-item-10 menu-item"><a href="http://www.harmj0y.net/blog/projects/" class="menu-link">Projects</a></li></ul></div></nav></div></div>		</div>
			</div>
</div>
		</header><!-- #masthead -->
			<div id="content" class="site-content">
		<div class="ast-container">
		

	<div id="primary" class="content-area primary">

		
					<main id="main" class="site-main">
				

<article
class="post-2450 post type-post status-publish format-standard hentry category-redteaming tag-powerview ast-article-single" id="post-2450" itemtype="https://schema.org/CreativeWork" itemscope="itemscope">

	
	
<div class="ast-post-format- ast-no-thumb single-layout-1">

	
	<header class="entry-header ast-no-thumbnail">

		
				<div class="ast-single-post-order">
			<h1 class="entry-title" itemprop="headline">Abusing GPO Permissions</h1><div class="entry-meta">			<span class="comments-link">
				<a href="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/#comments">8 Comments</a>			</span>

			 / <span class="cat-links"><a href="http://www.harmj0y.net/blog/category/redteaming/" rel="category tag">Red Teaming</a></span> / By <span class="posted-by vcard author" itemtype="https://schema.org/Person" itemscope="itemscope" itemprop="author">			<a title="View all posts by harmj0y" 
				href="http://www.harmj0y.net/blog/author/harmj0y/" rel="author"
				class="url fn n" itemprop="url"				>
				<span 
				class="author-name" itemprop="name"				>harmj0y</span>
			</a>
		</span>

		</div>		</div>
		
		
	</header><!-- .entry-header -->

	
	<div class="entry-content clear" 
	itemprop="text"	>

		
		<p>A friend (<a href="https://twitter.com/piffd0s">@piffd0s</a>) recently ran into a specific situation I hadn&#8217;t encountered before: the domain controllers and domain admins of the environment he was assessing were extremely locked down, but he was able to determine that a few users had edit rights on a few specific group policy objects (GPOs). After a bit of back and forth, he was able to abuse this to take down his target, and we were able to integrate some new functionality into <a href="https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1">PowerView</a> that facilitates this process.</p>
<p>This post will cover these new features and demonstrate how to enumerate and abuse misconfigured GPOs in case you encounter a similar situation. I also covered a bit of this material in my recent Troopers16 presentation &#8220;<a href="http://www.slideshare.net/harmj0y/i-have-the-powerview">I Have the Power(View): Offensive Active Directory with PowerShell</a>&#8220;. <strong>Sidenote</strong>: I can&#8217;t say enough good things about <a href="https://www.troopers.de/">Troopers</a>&#8211; if you haven&#8217;t been I definitely recommend checking it out! Also, this new functionality is in the <a href="https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1">development branch of PowerSploit</a> and should be merged into master soon(ish).</p>
<h2>GPO Background</h2>
<p><a href="https://technet.microsoft.com/en-us/windowsserver/bb310732.aspx">Group Policy Objects</a> are Active Directory containers used to store groupings of policy settings. These objects are then linked to specific sites, domains, or most commonly specific organizational units (OUs). According to Microsoft, &#8220;<em><a href="https://technet.microsoft.com/en-us/library/cc940895.aspx">By default, computer Group Policy is updated in the background every 90 minutes, with a random offset of 0 to 30 minutes.</a></em>&#8220;, which forces the application of specific settings to any machines in an OU/site where the GPO is linked. <a href="https://twitter.com/pyrotek3">Sean Metcalf</a> also just posted a great article <a href="https://adsecurity.org/?p=2716">explaining GPOs from an offensive perspective</a>, which I highly recommend reading.</p>
<p>With PowerView, the <strong>Get-NetGPO</strong> cmdlet allows for the easy enumeration of all current GPOs in a given domain. We can also easily figure out what OUs a policy is applied to by searching for a the GPO GUID in the <a href="https://msdn.microsoft.com/en-us/library/cc219956.aspx">gPLink attribute</a> of any OU objects (this also works with <strong>Get-NetSite</strong>). We can then track this back to specific computers, as the &#8220;<a href="http://www.harmj0y.net/blog/powershell/gpp-and-powerview/">GPP and PowerView</a>&#8221; post demonstrated. If we want to go the opposite direction and determine what GPOs a specific computer has applied, we can feed <strong>Get-NetGPO</strong> the <strong>-ComputerName</strong> <strong>COMPUTER</strong> argument, and all GPOs for the target system (applied by OU or site) will be returned:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-2475" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/get_netgpo_computer-1024x530.png" alt="get_netgpo_computer" width="640" height="331" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/get_netgpo_computer-1024x530.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/get_netgpo_computer-300x155.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/get_netgpo_computer-768x398.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/get_netgpo_computer.png 1607w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>The <strong>gpcfilesyspath</strong> field shows you where the configuration for the policy resides. All of this will matter shortly- the key here is to be able to quickly find the GPOs that apply to specific machines (starting from either the GPO name or the machine name) and where the actual GPO configuration files reside.</p>
<h2>Enumerating GPO Permissions</h2>
<p>I covered some similar information in my &#8220;<a href="http://www.harmj0y.net/blog/redteaming/abusing-active-directory-permissions-with-powerview/">Abusing Active Directory Permissions with PowerView</a>&#8221; post, but I&#8217;ll reiterate a bit here. Active Directory objects (like files) have permissions associated with them. These can sometimes be misconfigured, and can also be backdoored for persistence (as shown in the abuse post). This includes GPOs. The key PowerView function we can use here for enumeration is <strong>Get-ObjectAcl</strong>.</p>
<p>Let&#8217;s enumerate all the permissions for all GPOs in the current domain:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b820de4df685060114" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Get-NetGPO | %{Get-ObjectAcl -ResolveGUIDs -Name $_.Name}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b820de4df685060114-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b820de4df685060114-1"><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">NetGPO</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">{</span><span class="crayon-v">Get</span><span class="crayon-o">-</span><span class="crayon-v">ObjectAcl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">ResolveGUIDs</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">Name</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_</span><span class="crayon-sy">.</span><span class="crayon-v">Name</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p><strong>Note:</strong> you can also use PowerView&#8217;s <strong>Invoke-ACLScanner</strong> to speed up your search. This will search the ACLs for ALL domain objects, and returns results where the IdentityReference RID is -1000 or above and also has some times of modification rights on the given object.</p>
<p>Either way, you will get a big chunk of data, with most of the entries likely being groups like Enterprise and Domain Admins. Here&#8217;s what a misconfiguration might look like:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-2452" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/acl_misconfiguration-1024x390.png" alt="acl_misconfiguration" width="640" height="244" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/acl_misconfiguration-1024x390.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/acl_misconfiguration-300x114.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/acl_misconfiguration-768x292.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/acl_misconfiguration.png 1395w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>And here&#8217;s how that misconfiguration looks through the Group Policy Management console:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-2493" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpmc-1024x401.png" alt="gpmc" width="640" height="251" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpmc-1024x401.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpmc-300x118.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpmc-768x301.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpmc.png 1177w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>So the &#8216;TESTLAB\will&#8217; user has modification rights on the GPO with the GUID of &#8220;{3EE4BE4E-7397-4433-A9F1-3A5AE2F56EA2}&#8221; and display name of &#8220;SecurePolicy&#8221;. Let&#8217;s track this back and see what systems this GPO is applied to:</p>
<p><img loading="lazy" class="aligncenter size-large wp-image-2453" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/ou_gpo_link-1024x109.png" alt="ou_gpo_link" width="640" height="68" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/ou_gpo_link-1024x109.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/ou_gpo_link-300x32.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/ou_gpo_link-768x82.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/ou_gpo_link.png 1403w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>So now we now know the specific policy our user can edit and the machines this policy is applied to. And with edit rights to the GPO, we can force code execution on these machines!</p>
<h2>Weaponizing GPO Edit Rights</h2>
<p>Group Policy has a huge number of settings to manipulate, giving you a few ways to go about compromising machines/users touched by a compromised GPO. You could push out specific startup scripts, backdoor Internet Explorer settings, push out a .MSI under &#8216;Software installation&#8217;, add your domain account to the local administrators/RDP group, force the mounting of a network share (where you control the endpoint and can relay any specific credentials), or several other approaches I&#8217;m sure I&#8217;m not realizing.</p>
<p>My preference for immediate code execution would be to push out an <a href="https://technet.microsoft.com/en-us/library/dd851779.aspx">&#8216;Immediate&#8217; Scheduled task</a>, which instantly runs and then removes itself, every time group policy refreshes. This part is pretty simple- we just need to build a schtask .XML template to substitute in our appropriate configuration/commands and then copy it to &lt;GPO_PATH&gt;\Machine\Preferences\ScheduledTasks\ScheduledTasks.xml of the GPO we can edit. After waiting 1-2 hours for the group policy refresh cycle, we can remove the .xml to minimize our footprint.</p>
<p>PowerView&#8217;s new <strong><a href="https://github.com/PowerShellMafia/PowerSploit/blob/26a0757612e5654b4f792b012ab8f10f95d391c9/Recon/PowerView.ps1#L5907-L6122">New-GPOImmediateTask</a></strong> function should take care of all this for you. The <strong>-TaskName</strong> argument is required, <strong>-Command</strong> specified the command to run (which defaults to powershell.exe), and <strong>-CommandArguments</strong> specifies the arguments for the given binary. The task description, author, and modification date can also optionally be modified with the appropriate parameters. A schtask .xml is built according to your specifications and is copied to the appropriate location determined by the <strong>-GPOname</strong> or <strong>-GPODisplayname</strong> arguments. By default the function will prompt you before copying, but this can be suppressed with <strong>-Force</strong>.</p>
<p>For example, let&#8217;s use <strong>New-GPOImmediateTask</strong> to push an Empire stager out to machines where this &#8216;{3EE4BE4E-7397-4433-A9F1-3A5AE2F56EA2}&#8217; GPO (display name of &#8216;SecurePolicy&#8217;) is applied:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b820de50c707580960" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
New-GPOImmediateTask -TaskName Debugging -GPODisplayName SecurePolicy -CommandArguments '-NoP -NonI -W Hidden -Enc JABXAGMAPQBO...' -Force</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b820de50c707580960-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b820de50c707580960-1"><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-v">GPOImmediateTask</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">TaskName </span><span class="crayon-v">Debugging</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">GPODisplayName </span><span class="crayon-v">SecurePolicy</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">CommandArguments</span><span class="crayon-h"> </span><span class="crayon-s">'-NoP -NonI -W Hidden -Enc JABXAGMAPQBO...'</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">Force</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><img loading="lazy" class="aligncenter size-large wp-image-2481" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/new_gpoimmediatetask_empire-1024x397.png" alt="new_gpoimmediatetask_empire" width="640" height="248" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/new_gpoimmediatetask_empire-1024x397.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/new_gpoimmediatetask_empire-300x116.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/new_gpoimmediatetask_empire-768x298.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/new_gpoimmediatetask_empire.png 1601w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p><img loading="lazy" class="aligncenter size-large wp-image-2482" src="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpo_task_empire_agent-1024x689.png" alt="gpo_task_empire_agent" width="640" height="431" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpo_task_empire_agent-1024x689.png 1024w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpo_task_empire_agent-300x202.png 300w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpo_task_empire_agent-768x517.png 768w, http://www.harmj0y.net/blog/wp-content/uploads/2016/03/gpo_task_empire_agent.png 2029w" sizes="(max-width: 640px) 100vw, 640px" /></p>
<p>You can remove the schtask .xml after you get execution by supplying the <strong>-Remove</strong> flag:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60a9b820de516396068847" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
New-GPOImmediateTask -Remove -Force -GPODisplayName SecurePolicy</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60a9b820de516396068847-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60a9b820de516396068847-1"><span class="crayon-r">New</span><span class="crayon-o">-</span><span class="crayon-v">GPOImmediateTask</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">Remove</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">Force</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">GPODisplayName </span><span class="crayon-v">SecurePolicy</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Have fun!</p>

		
		
			</div><!-- .entry-content .clear -->
</div>

	
</article><!-- #post-## -->


	<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="http://www.harmj0y.net/blog/redteaming/local-group-enumeration/" rel="prev"><span class="ast-left-arrow">&larr;</span> Previous Post</a></div><div class="nav-next"><a href="http://www.harmj0y.net/blog/empire/empire-1-5/" rel="next">Next Post <span class="ast-right-arrow">&rarr;</span></a></div></div>
	</nav>
<div id="comments" class="comments-area">

	
				<h3 class="comments-title">
				8 thoughts on &ldquo;Abusing GPO Permissions&rdquo;			</h3>
		
		<ol class="ast-comment-list">
							<li class="comment even thread-even depth-1" id="li-comment-26244">

					<article id="comment-26244" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://2.gravatar.com/avatar/e8034a5c758f9dca4d0fda21cfddcb38?s=50&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e8034a5c758f9dca4d0fda21cfddcb38?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">Teek</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/#comment-26244"><time datetime="2016-03-17T17:58:06-05:00">March 17, 2016 at 5:58 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>I was just wondering what size environments you run this against? When I’ve tried using this for some of my engagements the length of time for it to complete stretches to hours or days and the volume of output is … high.<br />
When you are dealing with environments with hundreds of thousands of endpoints what do you do differently?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/?replytocom=26244#respond' data-commentid="26244" data-postid="2450" data-belowelement="comment-26244" data-respondelement="respond" data-replyto="Reply to Teek" aria-label='Reply to Teek'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor odd alt depth-2" id="li-comment-26269">

					<article id="comment-26269" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/#comment-26269"><time datetime="2016-03-18T04:57:43-05:00">March 18, 2016 at 4:57 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Which exact function and syntax are you referring to, Invoke-ACLScanner or something like Get-NetGPO | %{Get-ObjectAcl -ResolveGUIDs -Name $_.Name} ?</p>
<p>As these functions are relatively new, I haven&#8217;t tested them in networks with hundreds of thousands of endpoints. Unfortunately, I can&#8217;t think of ways off the top of my head to really speed up Get-ObjectACL as it&#8217;s more or less a modified LDAP query.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/?replytocom=26269#respond' data-commentid="26269" data-postid="2450" data-belowelement="comment-26269" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="pingback even thread-odd thread-alt depth-1" id="comment-42246">
					<p>Pingback: <a href='https://adsecurity.org/?p=3658' rel='external nofollow ugc' class='url'>Scanning for Active Directory Privileges &#038; Privileged Accounts &#187; Active Directory Security</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="comment odd alt thread-even depth-1" id="li-comment-42372">

					<article id="comment-42372" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://1.gravatar.com/avatar/7e9af19a1b58842202bcb45d6b84f3ef?s=50&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7e9af19a1b58842202bcb45d6b84f3ef?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">Cyraxe</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/#comment-42372"><time datetime="2017-06-19T20:25:38-05:00">June 19, 2017 at 8:25 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>I&#8217;ve been trying to deploy the scheduled task as a starting point for my test deployment on deploying a file to a domain. I can&#8217;t seem to get it to work on Windows Server 2012 R2. </p>
<p>It seems if i run New-GPOImmediateTask against the &#8220;Default Domain Controllers Policy&#8221; as an example or on a brand new GPO nothing seems to happen.<br />
However when I navigate in the GPO MMC it will appear as a setting ONLY if i navigate into the GPM editor window, double click the scheduled task and click ok. It seems that behind the scenes something is changing something in registry or on disk somewhere but i can&#8217;t seem to find it (api monitor crashes :( ).</p>
<p> Is New-GPOImmediateTask meant to work off the bat without changes made in the GUI? just CLI only?</p>
<p>This is the exact command that i ran: <code>New-GPOImmediateTask -TaskName Testsched -GPODisplayName "Default Domain Controllers Policy" -CommandArguments '-c "testoutput | Out-File C:\test.txt"' -Force</code></p>
<p>My end goal is to deploy a file instead of a scheduled task, but this is my starting point.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/?replytocom=42372#respond' data-commentid="42372" data-postid="2450" data-belowelement="comment-42372" data-respondelement="respond" data-replyto="Reply to Cyraxe" aria-label='Reply to Cyraxe'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment byuser comment-author-harmj0y bypostauthor even depth-2" id="li-comment-42375">

					<article id="comment-42375" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=50&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a874809641a854ae50e959b608dadefc?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">harmj0y</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/#comment-42375"><time datetime="2017-06-19T22:10:24-05:00">June 19, 2017 at 10:10 pm</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>So I removed <code>New-GPOImmediateTask</code> because of its inconsistencies- it ended up only really working as a PoC. Your best bet is likely to manually create the scheduled task in your lab, and editing the resulting XML that&#8217;s stored off in SYSVOL.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/?replytocom=42375#respond' data-commentid="42375" data-postid="2450" data-belowelement="comment-42375" data-respondelement="respond" data-replyto="Reply to harmj0y" aria-label='Reply to harmj0y'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				<ol class="children">
				<li class="comment odd alt depth-3" id="li-comment-44719">

					<article id="comment-44719" class="ast-comment">
					<div class= 'ast-comment-info'>
						<div class='ast-comment-avatar-wrap'><img alt='' src='http://2.gravatar.com/avatar/bb1a2595f131dd1f54e9509d10edbfca?s=50&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/bb1a2595f131dd1f54e9509d10edbfca?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' loading='lazy'/></div><!-- Remove 1px Space
						-->
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize"><div class="ast-comment-cite-wrap"><cite><b class="fn">flux</b> </cite></div><div class="ast-comment-time"><span  class="timendate"><a href="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/#comment-44719"><time datetime="2017-09-06T07:48:39-05:00">September 6, 2017 at 7:48 am</time></a></span></div>																</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>From what I see in the labs, this only works if I can edit a already existing task (irrespective of its type as a standard or an immediate scheduled task).<br />
I had no success in creating the folder structure and dropping a task xml with regenerated CLSIDs and UIDs in there. It doesn&#8217;t get executed. The logs point me in the direction that the CLSIDs are not valid  which causes the client to decline the policy.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel='nofollow' class='comment-reply-link' href='http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/?replytocom=44719#respond' data-commentid="44719" data-postid="2450" data-belowelement="comment-44719" data-respondelement="respond" data-replyto="Reply to flux" aria-label='Reply to flux'>Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
												</article><!-- #comment-## -->

				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="pingback even thread-odd thread-alt depth-1" id="comment-50234">
					<p>Pingback: <a href='https://wald0.com/?p=179' rel='external nofollow ugc' class='url'>A Red Teamer’s Guide to GPOs and OUs &#8211; wald0.com</a> </p>
				</li>
				</li><!-- #comment-## -->
				<li class="pingback odd alt thread-even depth-1" id="comment-51350">
					<p>Pingback: <a href='https://securesignal.nyc/wp/blog/2018/07/24/abusing-gpo-permissions-2/' rel='external nofollow ugc' class='url'>Abusing GPO Permissions - Secure Signal NYC</a> </p>
				</li>
				</li><!-- #comment-## -->
		</ol><!-- .ast-comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/redteaming/abusing-gpo-permissions/#respond" style="display:none;">Cancel Reply</a></small></h3><form action="http://www.harmj0y.net/blog/wp-comments-post.php" method="post" id="ast-commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><div class="ast-row comment-textarea"><fieldset class="comment-form-comment"><div class="comment-form-textarea ast-grid-common-col"><label for="comment" class="screen-reader-text">Type here..</label><textarea id="comment" name="comment" placeholder="Type here.." cols="45" rows="8" aria-required="true"></textarea></div></fieldset></div><div class="ast-comment-formwrap ast-row"><p class="comment-form-author ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="author" class="screen-reader-text">Name*</label><input id="author" name="author" type="text" value="" placeholder="Name*" size="30" aria-required='true' /></p>
<p class="comment-form-email ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="email" class="screen-reader-text">Email*</label><input id="email" name="email" type="text" value="" placeholder="Email*" size="30" aria-required='true' /></p>
<p class="comment-form-url ast-grid-common-col ast-width-lg-33 ast-width-md-4 ast-float"><label for="url"><label for="url" class="screen-reader-text">Website</label><input id="url" name="url" type="text" value="" placeholder="Website" size="30" /></label></p></div>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment &raquo;" /> <input type='hidden' name='comment_post_ID' value='2450' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="021580f8e3" /></p><input type="hidden" id="ak_js" name="ak_js" value="179"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	<p class="akismet_comment_form_privacy_notice">This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" target="_blank" rel="nofollow noopener">Learn how your comment data is processed</a>.</p>
	
</div><!-- #comments -->
			</main><!-- #main -->
			
		
	</div><!-- #primary -->


	<div class="widget-area secondary" id="secondary" role="complementary" itemtype="https://schema.org/WPSideBar" itemscope="itemscope">
	<div class="sidebar-main" >
				<aside id="media_image-5" class="widget widget_media_image"><a href="https://specterops.io/" target="_blank" rel="noopener"><img width="751" height="786" src="http://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops.png" class="image wp-image-4177 alignleft attachment-full size-full" alt="" loading="lazy" style="max-width: 100%; height: auto;" srcset="http://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops.png 751w, http://www.harmj0y.net/blog/wp-content/uploads/2017/07/specterops-287x300.png 287w" sizes="(max-width: 751px) 100vw, 751px" /></a></aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h2 class="widget-title">Recent Posts</h2><nav role="navigation" aria-label="Recent Posts">
		<ul>
											<li>
					<a href="http://www.harmj0y.net/blog/activedirectory/a-case-study-in-wagging-the-dog-computer-takeover/">A Case Study in Wagging the Dog: Computer Takeover</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/kerberoasting-revisited/">Kerberoasting Revisited</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/not-a-security-boundary-breaking-forest-trusts/">Not A Security Boundary: Breaking Forest Trusts</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/another-word-on-delegation/">Another Word on Delegation</a>
									</li>
											<li>
					<a href="http://www.harmj0y.net/blog/redteaming/rubeus-now-with-more-kekeo/">Rubeus &#8211; Now With More Kekeo</a>
									</li>
					</ul>

		</nav></aside><aside id="archives-2" class="widget widget_archive"><h2 class="widget-title">Archives</h2>		<label class="screen-reader-text" for="archives-dropdown-2">Archives</label>
		<select id="archives-dropdown-2" name="archive-dropdown">
			
			<option value="">Select Month</option>
				<option value='http://www.harmj0y.net/blog/2019/02/'> February 2019 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2018/11/'> November 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2018/10/'> October 2018 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2018/09/'> September 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2018/08/'> August 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2018/07/'> July 2018 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2018/04/'> April 2018 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/11/'> November 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/10/'> October 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/09/'> September 2017 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2017/08/'> August 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/07/'> July 2017 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2017/06/'> June 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/05/'> May 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/03/'> March 2017 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2017/01/'> January 2017 &nbsp;(4)</option>
	<option value='http://www.harmj0y.net/blog/2016/12/'> December 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/11/'> November 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/10/'> October 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/09/'> September 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/08/'> August 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2016/07/'> July 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/06/'> June 2016 &nbsp;(3)</option>
	<option value='http://www.harmj0y.net/blog/2016/05/'> May 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/04/'> April 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/03/'> March 2016 &nbsp;(4)</option>
	<option value='http://www.harmj0y.net/blog/2016/02/'> February 2016 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2016/01/'> January 2016 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/12/'> December 2015 &nbsp;(4)</option>
	<option value='http://www.harmj0y.net/blog/2015/11/'> November 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/10/'> October 2015 &nbsp;(3)</option>
	<option value='http://www.harmj0y.net/blog/2015/09/'> September 2015 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2015/08/'> August 2015 &nbsp;(3)</option>
	<option value='http://www.harmj0y.net/blog/2015/07/'> July 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/06/'> June 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/05/'> May 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/04/'> April 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/03/'> March 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2015/01/'> January 2015 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2014/12/'> December 2014 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2014/11/'> November 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/10/'> October 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/09/'> September 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/08/'> August 2014 &nbsp;(1)</option>
	<option value='http://www.harmj0y.net/blog/2014/07/'> July 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/06/'> June 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/05/'> May 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/04/'> April 2014 &nbsp;(2)</option>
	<option value='http://www.harmj0y.net/blog/2014/03/'> March 2014 &nbsp;(1)</option>

		</select>

<script>
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "archives-dropdown-2" );
	function onSelectChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value !== '' ) {
			document.location.href = this.options[ this.selectedIndex ].value;
		}
	}
	dropdown.onchange = onSelectChange;
})();
/* ]]> */
</script>
			</aside><aside id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://www.harmj0y.net/blog/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
					<button class="search-submit">
				<span hidden>Search</span>
				<i><span class="ast-icon icon-search"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="-888 480 142 142" enable-background="new -888 480 142 142" xml:space="preserve">
				<title/>
				<desc/>
				<path id="Shape" d="M-787.4,568.7h-6.3l-2.4-2.4c7.9-8.7,12.6-20.5,12.6-33.1c0-28.4-22.9-51.3-51.3-51.3  c-28.4,0-51.3,22.9-51.3,51.3c0,28.4,22.9,51.3,51.3,51.3c12.6,0,24.4-4.7,33.1-12.6l2.4,2.4v6.3l39.4,39.4l11.8-11.8L-787.4,568.7  L-787.4,568.7z M-834.7,568.7c-19.7,0-35.5-15.8-35.5-35.5c0-19.7,15.8-35.5,35.5-35.5c19.7,0,35.5,15.8,35.5,35.5  C-799.3,553-815,568.7-834.7,568.7L-834.7,568.7z"/>
				</svg></span></i>
			</button>
			</label>
	<input type="submit" class="search-submit" value="Search">
</form>
</aside><aside id="categories-4" class="widget widget_categories"><h2 class="widget-title">Categories</h2><nav role="navigation" aria-label="Categories">
			<ul>
					<li class="cat-item cat-item-38"><a href="http://www.harmj0y.net/blog/category/activedirectory/">ActiveDirectory</a>
</li>
	<li class="cat-item cat-item-25"><a href="http://www.harmj0y.net/blog/category/defense/">Defense</a>
</li>
	<li class="cat-item cat-item-21"><a href="http://www.harmj0y.net/blog/category/empire/">Empire</a>
</li>
	<li class="cat-item cat-item-32"><a href="http://www.harmj0y.net/blog/category/empyre/">EmPyre</a>
</li>
	<li class="cat-item cat-item-12"><a href="http://www.harmj0y.net/blog/category/informational/">Informational</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://www.harmj0y.net/blog/category/penetesting/">Penetesting</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://www.harmj0y.net/blog/category/powershell/">Powershell</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://www.harmj0y.net/blog/category/python/">Python</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://www.harmj0y.net/blog/category/redteaming/">Red Teaming</a>
</li>
	<li class="cat-item cat-item-50"><a href="http://www.harmj0y.net/blog/category/top-posts/">Top Posts</a>
</li>
			</ul>

			</nav></aside><aside id="linkcat-2" class="widget widget_links"><h2 class="widget-title">Blogroll</h2>
	<ul class='xoxo blogroll'>
<li><a href="https://bluescreenofjeff.com/">bluescreenofjeff.com</a></li>
<li><a href="https://enigma0x3.net/">enigma0x3.net</a></li>
<li><a href="http://www.invoke-ir.com/">invoke-ir.com</a></li>
<li><a href="https://wald0.com/">wald0.com</a></li>

	</ul>
</aside>
<aside id="twitter_timeline-3" class="widget widget_twitter_timeline"><a class="twitter-timeline" data-width="220" data-theme="dark" data-border-color="#e8e8e8" data-tweet-limit="5" data-lang="EN" data-partner="jetpack" data-chrome="noscrollbar" href="https://twitter.com/harmj0y" href="https://twitter.com/harmj0y">My Tweets</a></aside>
	</div><!-- .sidebar-main -->
</div><!-- #secondary -->


	</div> <!-- ast-container -->
	</div><!-- #content -->
<footer
class="site-footer" id="colophon" itemtype="https://schema.org/WPFooter" itemscope="itemscope" itemid="#colophon">
			<div class="site-primary-footer-wrap ast-builder-grid-row-container site-footer-focus-item ast-builder-grid-row-3-equal ast-builder-grid-row-tablet-3-equal ast-builder-grid-row-mobile-full ast-footer-row-stack ast-footer-row-tablet-stack ast-footer-row-mobile-stack" data-section="section-primary-footer-builder">
	<div class="ast-builder-grid-row-container-inner">
					<div class="ast-builder-footer-grid-columns site-primary-footer-inner-wrap ast-builder-grid-row">
											<div class="site-footer-primary-section-1 site-footer-section site-footer-section-1">
								<div class="footer-widget-area widget-area site-footer-focus-item" data-section="section-footer-menu">
							</div>
							</div>
											<div class="site-footer-primary-section-2 site-footer-section site-footer-section-2">
									</div>
											<div class="site-footer-primary-section-3 site-footer-section site-footer-section-3">
									</div>
										</div>
			</div>

</div>
<div class="site-below-footer-wrap ast-builder-grid-row-container site-footer-focus-item ast-builder-grid-row-full ast-builder-grid-row-tablet-full ast-builder-grid-row-mobile-full ast-footer-row-stack ast-footer-row-tablet-stack ast-footer-row-mobile-stack" data-section="section-below-footer-builder">
	<div class="ast-builder-grid-row-container-inner">
					<div class="ast-builder-footer-grid-columns site-below-footer-inner-wrap ast-builder-grid-row">
											<div class="site-footer-below-section-1 site-footer-section site-footer-section-1">
								<div class="ast-builder-layout-element ast-flex site-footer-focus-item ast-footer-copyright" data-section="section-footer-builder">
				<div class="ast-footer-copyright"><p>Copyright &copy; 2021 harmj0y | Designed by <a href="http://felicitybrigham.com">Felicity Brigham Design</a></p>
</div>			</div>
						</div>
										</div>
			</div>

</div>
	</footer><!-- #colophon -->
	</div><!-- #page -->
	<div style="display:none">
	<div class="grofile-hash-map-e8034a5c758f9dca4d0fda21cfddcb38">
	</div>
	<div class="grofile-hash-map-a874809641a854ae50e959b608dadefc">
	</div>
	<div class="grofile-hash-map-7e9af19a1b58842202bcb45d6b84f3ef">
	</div>
	<div class="grofile-hash-map-bb1a2595f131dd1f54e9509d10edbfca">
	</div>
	</div>
<script src='http://www.harmj0y.net/blog/wp-includes/js/comment-reply.min.js?ver=5.7.2' id='comment-reply-js'></script>
<script id='astra-theme-js-js-extra'>
var astra = {"break_point":"921","isRtl":""};
</script>
<script src='http://www.harmj0y.net/blog/wp-content/themes/astra/assets/js/minified/frontend.min.js?ver=3.4.2' id='astra-theme-js-js'></script>
<script src='https://secure.gravatar.com/js/gprofiles.js?ver=202120' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":""};
</script>
<script src='http://www.harmj0y.net/blog/wp-content/plugins/jetpack/modules/wpgroho.js?ver=9.7' id='wpgroho-js'></script>
<script src='http://www.harmj0y.net/blog/wp-content/plugins/jetpack/_inc/build/twitter-timeline.min.js?ver=4.0.0' id='jetpack-twitter-timeline-js'></script>
<script src='http://www.harmj0y.net/blog/wp-includes/js/wp-embed.min.js?ver=5.7.2' id='wp-embed-js'></script>
<script async="async" src='http://www.harmj0y.net/blog/wp-content/plugins/akismet/_inc/form.js?ver=4.1.9' id='akismet-form-js'></script>
			<script>
			/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
			</script>
			<script src='https://stats.wp.com/e-202120.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.7',blog:'65454229',post:'2450',tz:'-5',srv:'www.harmj0y.net'} ]);
	_stq.push([ 'clickTrackerInit', '65454229', '2450' ]);
</script>
	</body>
</html>

<!-- Page generated by LiteSpeed Cache 3.6.4 on 2021-05-22 21:04:17 -->