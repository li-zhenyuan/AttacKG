<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML LANG="en">
    <HEAD PROFILE="https://www.w3.org/2005/10/profile">
        <BASE TARGET="_top">
        <LINK REL="Author" HREF="mailto:?To=stefan%2Ekanthak%40nexgo%2Ede">
        <LINK REL="Canonical" HREF="https://skanthak.homepage.t-online.de/sentinel.html">
        <LINK REL="Contents" HREF="index.html" TITLE="Table of Contents">
        <LINK REL="Copyright" HREF="mailto:?Subject=Vulnerability%20and%20Exploit%20Detector&amp;To=Stefan%20Kanthak%20%3Cstefan%2Ekanthak%40nexgo%2Ede%3E">
        <LINK REL="Home" HREF="home.html" TITLE="Homepage">
        <LINK REL="Icon" HREF="favicon.svg" TYPE="image/svg+xml">
        <LINK REL="Index" HREF="index.html" TITLE="Table of Contents">
        <LINK REL="License" HREF="license.html" TITLE="Terms and Conditions">
        <LINK REL="Next" HREF="verifier.html" TITLE="Application Verifier Provider">
        <LINK REL="Policy" HREF="policy.html" TITLE="Notification and Disclosure Policy">
        <LINK REL="Preload" HREF="data:application/octet-stream,X5O!P%25%40AP%5B4%5CPZX54%28P%5E%297CC%297%7D%24EICAR-STANDARD-ANTIVIRUS-TEST-FILE!%24H%2BH*" TYPE="application/octet-stream">
        <LINK REL="Previous" HREF="!execute.html" TITLE="Executable Installers Considered Harmful">
        <LINK REL="Publisher" HREF="mailto:?To=stefan%2Ekanthak%40nexgo%2Ede">
        <LINK REL="Related" HREF="cwe-428.html" TITLE="Protection Against Exploitation of CWE-428">
        <LINK REL="Related" HREF="detour.html" TITLE="&ldquo;Unknown&rdquo; DLLs, API Sets and Forwarded Exports &ndash; when Compatibility means Vulnerability">
        <LINK REL="Related" HREF="drive-by.html" TITLE="Demonstration of Drive-by Downloads">
        <LINK REL="Related" HREF="guardian.html" TITLE="Guardian for CWE-428">
        <LINK REL="Related" HREF="minesweeper.html" TITLE="DLL Minesweeper &ndash; not just a Game only for Software Developers, (Penetration) Testers and Administrators">
        <LINK REL="Related" HREF="msicd.html" TITLE="Internet Component Download">
        <LINK REL="Related" HREF="nomsvcrt.html" TITLE="Minimalist Runtime Library for Microsoft C Compiler">
        <LINK REL="Related" HREF="snafu.html" TITLE="Bugs in Module Loader of Windows 10 and LINK.EXE Version 14.*">
        <LINK REL="Related" HREF="SAFER.html" TITLE="Stop Mal(icious Soft)ware with Software Restriction Policies alias SAFER">
        <LINK REL="Related" HREF="tempest.html" TITLE="Tempest in the &lsquo;TEMP&rsquo; Directory">
        <LINK REL="Shortcut icon" HREF="favicon.ico" TYPE="image/vnd.microsoft.icon">
        <LINK REL="Sitemap" HREF="sitemap.xml" TYPE="application/xml">
        <LINK REL="Start" HREF="index.html" TITLE="Table of Contents">
    <!-- LINK REL="Stylesheet" HREF="default.css" MEDIA="all" TYPE="text/css" -->
        <LINK REV="Made" HREF="mailto:?Subject=Vulnerability%20and%20Exploit%20Detector&amp;To=Stefan%20Kanthak%20%3Cstefan%2Ekanthak%40nexgo%2Ede%3E">
        <LINK REV="Referer" HREF="https://hackerone.com/reports/272221">
        <LINK REV="Referer" HREF="https://insights.sei.cmu.edu/cert/2016/06/bypassing-application-whitelisting.html">
        <LINK REV="Referer" HREF="https://seclists.org/fulldisclosure/2017/Feb/20">
        <LINK REV="Referer" HREF="https://seclists.org/fulldisclosure/2017/Mar/68">
        <LINK REV="Referer" HREF="https://seclists.org/fulldisclosure/2017/May/21">
        <LINK REV="Referer" HREF="https://seclists.org/fulldisclosure/2017/May/107">
        <LINK REV="Referer" HREF="https://seclists.org/fulldisclosure/2017/Aug/30">
        <LINK REV="Referer" HREF="https://seclists.org/fulldisclosure/2017/Oct/24">
        <LINK REV="Referer" HREF="https://www.hexacorn.com/blog/2019/05/29/msiexec-exe-as-a-lolbin/">
        <LINK REV="Referer" HREF="https://www.securityfocus.com/archive/1/540650">
        <META HTTP-EQUIV="Content-Script-Type" CONTENT="text/javascript; charset=us-ascii">
        <META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css; charset=us-ascii">
        <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii">
        <META HTTP-EQUIV="X-Content-Type-Options" CONTENT="nosniff">
        <META HTTP-EQUIV="X-Frame-Options" CONTENT="DENY">
        <META HTTP-EQUIV="X-XSS-Protection" CONTENT="1; mode=block">
        <META NAME="Author" CONTENT="Stefan Kanthak" LANG="de">
        <META NAME="Date" CONTENT="2021-05-22">
        <META NAME="Description" CONTENT="Vulnerability and Exploit Detector">
        <META NAME="Generator" CONTENT="None">
        <META NAME="Keywords" CONTENT="Sentinel,Vulnerability,Weakness,Exploit,Detector,CVE-2000-0854,CVE-2006-3443,CVE-2014-0315,CVE-2016-0014,CWE-426,CWE-427,CWE-428,CAPEC-471,Unquoted,Untrusted,Path,Bogus,Rogue,Binary,Executable,Program,DLL,Planting,Hijacking,Preloading,Sideloading,Spoofing,Carpet,Bombing,Directory,Poisoning,Microsoft,Windows,MSKB,2269637,2389418,2533623">
        <META NAME="Language" CONTENT="en">
        <META NAME="Publisher" CONTENT="Stefan Kanthak" LANG="de">
        <META NAME="Robots" CONTENT="follow, index">
        <META NAME="Viewport" CONTENT="initial-scale=1.0, user-scalable=yes, width=device-width">
        <OBJECT CLASSID="CLSID:CC83D544-C725-11EE-8688-26B699B123B5"
                CODEBASE="download/SENTINEL.CAB#Version:1,0,15,0"
                CODETYPE="application/vnd.ms-cab-compressed"
                HEIGHT="0"
                WIDTH="0">
        </OBJECT>
        <STYLE MEDIA="all" TYPE="text/css">
            @media print { PRE { white-space: pre-wrap }}
            .hidden { display: none }
            A { text-decoration: none }
            ACRONYM[TITLE] { cursor: help }
            BLOCKQUOTE { background-color: lightgrey;
                         border-radius: 3px;
                         padding: 1em }
            BODY { font-family: sans-serif;
                   margin: 2em;
                   quotes: "\201C" "\201D" "\2018" "\2019" }
            CODE { white-space: pre }
            H2 { background-color: lightblue }
            H3 { background-color: khaki }
            H4 { background-color: darkseagreen }
            H2,
            H3,
            H4 { border-radius: 3px;
                 margin-left: -1ex;
                 margin-right: -1ex;
                 padding: 3px;
                 padding-left: 1ex;
                 padding-right: 1ex }
            PRE > CODE,
            PRE > KBD,
            PRE > SAMP { border-color: darkgrey;
                         border-radius: 3px;
                         border-style: solid;
                         border-width: 1px;
                         display: block;
                         overflow: auto;
                         padding: 1em }
            SPAN.button { background-color: whitesmoke;
                          background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(127, 127, 127, 0.2));
                          border-color: gainsboro darkgrey grey silver;
                          border-radius: 2px;
                          border-style: solid;
                          border-width: 1px;
                          font-family: inherit;
                          padding-left: 1ex;
                          padding-right: 1ex;
                          text-shadow: 0 1px rgba(255, 255, 255, 0.5);
                          white-space: pre }
        </STYLE>
        <TITLE>Vulnerability and Exploit Detector</TITLE>
    </HEAD>
    <BODY ONLOAD="javascript:document.getElementById('upload').textContent='Last upload '+document.lastModified">
        <A HREF="https://validator.w3.org/check/referer" TITLE="The W3C Markup Validation Service">
            <IMG ALIGN="Right"
                 ALT="Valid HTML 4.01 Transitional"
                 BORDER="0"
                 HEIGHT="31"
                 HSPACE="5"
                 ONMOUSEOUT="javascript:this.src='https://www.w3.org/Icons/valid-html401.png'"
                 ONMOUSEOVER="javascript:this.src='https://www.w3.org/Icons/valid-html401-blue.png'"
                 SRC="https://www.w3.org/Icons/valid-html401.png"
                 WIDTH="88">
        </A>
        <A HREF="https://jigsaw.w3.org/css-validator/check/referer" TITLE="The W3C CSS Validation Service">
            <IMG ALIGN="Right"
                 ALT="Valid CSS"
                 BORDER="0"
                 HEIGHT="31"
                 HSPACE="5"
                 ONMOUSEOUT="javascript:this.src='https://jigsaw.w3.org/css-validator/images/vcss-blue.png'"
                 ONMOUSEOVER="javascript:this.src='https://jigsaw.w3.org/css-validator/images/vcss.png'"
                 SRC="https://jigsaw.w3.org/css-validator/images/vcss-blue.png"
                 WIDTH="88">
        </A>
        <A HREF="https://validator.w3.org/check/referer" TITLE="The W3C Markup Validation Service">
            <IMG ALIGN="Right"
                 ALT="Valid SVG 1.0"
                 BORDER="0"
                 HEIGHT="31"
                 HSPACE="5"
                 ONMOUSEOUT="javascript:this.src='https://www.w3.org/Icons/valid-svg10.png'"
                 ONMOUSEOVER="javascript:this.src='https://www.w3.org/Icons/valid-svg10-blue.png'"
                 SRC="https://www.w3.org/Icons/valid-svg10.png"
                 WIDTH="88">
        </A>
        <H1><A HREF="home.html" TITLE="Homepage of Stefan Kanthak">Me, myself &amp; IT</A></H1>
            <SPAN ID="upload"></SPAN>
        <H2>Vulnerability and Exploit Detector</H2>
        <DL>
        <DT><A HREF="#purpose">Purpose</A></DT>
        <DT><A HREF="#reason">Reason</A></DT>
        <DT><A HREF="#operation">Operation</A></DT>
        <DT><A HREF="#limitation">Limitation</A></DT>
        <DT><A HREF="#background">Background Information</A></DT>
        <DD>Execution of bogus or rogue programs</DD>
        <DD>Execution of bogus or rogue <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s</DD>
        <DT><A HREF="#vulnerabilities">Known Vulnerabilities</A></DT>
        <DT><A HREF="#weaknesses">Known Weaknesses</A></DT>
        <DT><A HREF="#implementation">Implementation and Build Details</A></DT>
        <DT><A HREF="#authenticity">Authenticity and Integrity</A></DT>
        <DT><A HREF="#download">Download</A></DT>
        <DT><A HREF="#makefile">Makefile and Build Instructions</A></DT>
        <DT><A HREF="#demonstration">Demonstration</A></DT>
        <DT><A HREF="#installation">Installation</A></DT>
        <DD>Automatic online installation</DD>
        <DD>Manual offline installation</DD>
        <DT><A HREF="#update">Update</A></DT>
        <DT><A HREF="#deinstallation">Deinstallation</A></DT>
        </DL>
        <H3 ID="purpose">Purpose</H3>
            The <EM>Vulnerability and Exploit Detector</EM> for
            <A HREF="https://www.microsoft.com/default.aspx"><CITE>Microsoft<SUP>&reg;</SUP></CITE></A>
            <CITE>Windows<SUP>&reg;</SUP> NT</CITE> consists of the independent
            executable files
            <A HREF="download/SENTINEL.DLL" TYPE="application/vnd.microsoft.portable-executable"><CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE></A>
            and
            <A HREF="download/SENTINEL.EXE" TYPE="application/vnd.microsoft.portable-executable"><CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE></A>.
        <BR>They are used as <Q>canaries</Q> to indicate the execution of bogus
            or rogue applications and
            <A HREF="https://support.microsoft.com/en-us/kb/815065" TITLE="What is a DLL?"><ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s</A>
            from unintended or unwanted locations, typically in order to detect
            and demonstrate programming errors which lead to weaknesses and
            vulnerabilities, or to catch and detect (malicious) code which
            exploits such weaknesses and vulnerabilities.
        <BR>When placed in trusted locations of the search path, before
            untrusted locations like the
            <ACRONYM TITLE="Current Working Directory">CWD</ACRONYM>, they
            additionally act as <Q>sentinels</Q> and prevent the execution of
            bogus or rogue applications and
            <A HREF="https://support.microsoft.com/en-us/kb/815065" TITLE="What is a DLL?"><ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s</A>.
        <H3 ID="reason">Reason</H3>
            Way too many <CITE>Windows</CITE>
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s and programs,
            especially setup programs which typically have to be run with
            administrative privileges, suffer from <DEL>poor</DEL>
            <INS>insecure</INS> search path handling, resulting in well-known
            weaknesses like
            <A HREF="https://cwe.mitre.org/data/definitions/426.html" TITLE="CWE-426: Untrusted Search Path"><ACRONYM TITLE="Common Weakness Enumeration">CWE</ACRONYM>-426: Untrusted Search Path</A>,
            <A HREF="https://cwe.mitre.org/data/definitions/427.html" TITLE="CWE-427: Uncontrolled Search Path Element"><ACRONYM TITLE="Common Weakness Enumeration">CWE</ACRONYM>-427: Uncontrolled Search Path Element</A>
            and
            <A HREF="https://cwe.mitre.org/data/definitions/428.html" TITLE="CWE-428: Unquoted Search Path or Element"><ACRONYM TITLE="Common Weakness Enumeration">CWE</ACRONYM>-428: Unquoted Search Path or Element</A>
            documented in the
            <ACRONYM TITLE="Common Weakness Enumeration">CWE</ACRONYM><SUP>&trade;</SUP>,
            and allowing well-known attacks like
            <A HREF="https://capec.mitre.org/data/definitions/471.html" TITLE="CAPEC-471: Search Order Hijacking"><ACRONYM TITLE="Common Attack Pattern Enumeration and Classification">CAPEC</ACRONYM>-471: Search Order Hijacking</A>
            documented in the
            <ACRONYM TITLE="Common Attack Pattern Enumeration and Classification">CAPEC</ACRONYM><SUP>&trade;</SUP>.
        <PRE CLASS="hidden"><KBD TITLE="Console Input">REM Copyright &copy; 2004-2021, Stefan Kanthak &lt;&zwj;stefan&zwj;.&zwj;kanthak&zwj;@&zwj;nexgo&zwj;.&zwj;de&zwj;&gt;

IF DEFINED NoDefaultCurrentDirectoryInExePath SET NoDefaultCurrentDirectoryInExePath
ECHO ECHO %CD% 1&gt;CWE-426.CMD &amp;&amp; (
CALL CWE-426.CMD
ERASE CWE-426.CMD)

PATH
SET PATH
FOR %? IN (&quot;%PATH:;=&quot; &quot;%&quot;) DO @(
ECHO ECHO %~? 1&gt;&quot;%~?\CWE-426.CMD&quot; 2&gt;NUL: &amp;&amp; (
CALL &quot;%~?\CWE-426.CMD&quot;
ERASE &quot;%~?\CWE-426.CMD&quot;))</KBD></PRE>
        <H3 ID="operation">Operation</H3>
            <IMG ALIGN="Right"
                 ALT="[Screen shot of SENTINEL.DLL loaded on Windows 10]"
                 BORDER="0"
                 HSPACE="5"
                 SRC="https://insights.sei.cmu.edu/cert/2016/06/29/hijacked.png"
                 TITLE="Screen shot of SENTINEL.DLL loaded on Windows 10"
                 VSPACE="5">
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            is placed in the <Q>application directory</Q> and/or the
            <ACRONYM TITLE="Current Working Directory">CWD</ACRONYM> of
            programs which load
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s during
            <A HREF="https://msdn.microsoft.com/en-us/library/ms684184.aspx" TITLE="Load-Time Dynamic Linking">load-time</A>
            and/or
            <A HREF="https://msdn.microsoft.com/en-us/library/ms685090.aspx" TITLE="Run-Time Dynamic Linking">run-time</A>,
            using the filename of one or more
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s loaded by the
            respective program or any (other)
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM> loaded by it.
        <P> <STRONG>Note:</STRONG> on systems with <CITE>AMD64</CITE> alias
            <CITE>x64</CITE> processor architecture,
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            is <DEL>loaded</DEL> <INS>executed</INS> only if its execution
            environment matches that of the calling process!
        <P> <STRONG>Note:</STRONG> while searching for
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s specified
            without absolute (fully qualified) pathname,
            <CITE>Windows&rsquo;</CITE> module loader maps
            <ACRONYM TITLE="Portable Executable">PE32/PE32+</ACRONYM> modules
            with matching filenames into memory, independent of their target
            execution environment. Upon mismatch of the execution environments
            it discards and unloads the modules, then continues searching.
        <P> <STRONG>Note:</STRONG> the
            <A CLASS="hidden" HREF="https://support.microsoft.com/en-us/kb/177917" TITLE="Initializing a DLL Using DLLMain Optional Entry Point"><CODE>DllMain()</CODE></A>
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682596.aspx" TITLE="Dynamic-Link Library Entry-Point Function"><CODE>_DllMainCRTStartup()</CODE></A>
            entry point of every
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM> loaded during
            <A HREF="https://msdn.microsoft.com/en-us/library/ms684184.aspx" TITLE="Load-Time Dynamic Linking">load-time</A>
            of an application or
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM> is called before
            the entry point of this (dependent) application or
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>!
        <P> When
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            runs in an interactive user session it displays one or more message
            boxes like that shown to the right.
        <BR><STRONG>Note:</STRONG> the message box displayed during the initial
            call of
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            (<A HREF="https://msdn.microsoft.com/en-us/library/ms682583.aspx" TITLE="DllMain entry point"><CODE>DLL_PROCESS_ATTACH</CODE></A>)
            offers the choice to return <Q>success</Q> (via the
            <SPAN CLASS="button">OK</SPAN> button) or <Q>failure</Q> (via the
            <SPAN CLASS="button">Cancel</SPAN> button) to the calling process.
            The <CITE>Win32</CITE> functions
            <A HREF="https://msdn.microsoft.com/en-us/library/ms684175.aspx" TITLE="LoadLibrary function"><CODE>LoadLibrary()</CODE></A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/ms684179.aspx" TITLE="LoadLibraryEx function"><CODE>LoadLibraryEx()</CODE></A>
            yield error 1114 alias
            <A HREF="https://msdn.microsoft.com/en-us/library/ms681383.aspx#ERROR_DLL_INIT_FAILED" TITLE="System Error Codes (1000-1299)"><CODE>ERROR_DLL_INIT_FAILED</CODE></A>
            for <Q>failure</Q>, while <CITE>Windows&rsquo;</CITE> module loader
            yields
            <A HREF="https://msdn.microsoft.com/en-us/library/cc231200.aspx" TITLE="NTSTATUS"><CODE>NTSTATUS</CODE></A>
            0xC0000142 alias
            <A HREF="https://msdn.microsoft.com/en-us/library/cc704588.aspx" TITLE="NTSTATUS values"><CODE>STATUS_DLL_INIT_FAILED</CODE></A>.
        <BR CLEAR="All">
        <P> To test the proper function of
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>,
            start the <CITE TITLE="Cmd.exe">Command Processor</CITE> and run
            (one of) the following command lines:
        <PRE><KBD TITLE="Console Input">REM Copyright &copy; 2004-2021, Stefan Kanthak &lt;&zwj;stefan&zwj;.&zwj;kanthak&zwj;@&zwj;nexgo&zwj;.&zwj;de&zwj;&gt;

&quot;%SystemRoot%\System32\MSIExec.exe&quot; /Y &quot;&lsaquo;path&rsaquo;\SENTINEL.DLL&quot;
&quot;%SystemRoot%\System32\RegSvr32.exe&quot; /I /N /S &quot;&lsaquo;path&rsaquo;\SENTINEL.DLL&quot;
&quot;%SystemRoot%\System32\RegSvr32.exe&quot; /S &quot;&lsaquo;path&rsaquo;\SENTINEL.DLL&quot;
&quot;%SystemRoot%\System32\RegSvr32.exe&quot; /S /U &quot;&lsaquo;path&rsaquo;\SENTINEL.DLL&quot;
&quot;%SystemRoot%\System32\RunDLL32.exe&quot; &quot;&lsaquo;path&rsaquo;\SENTINEL.DLL&quot;,RunDLL</KBD></PRE>
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            is typically placed as <CODE>PROGRAM</CODE> and/or
            <CODE>PROGRAM.EXE</CODE> in the root directory of
            <CITE>Windows&rsquo;</CITE> <Q>system drive</Q>
            <CODE>%SystemDrive%</CODE>; if creation of <Q>short</Q> 8.3
            filenames is enabled,
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            can be copied as is and a <Q>short</Q> 8.3 filename
            <CODE>PROGRAM</CODE> or <CODE>PROGRAM.EXE</CODE> set:
        <PRE><KBD TITLE="Console Input">&quot;%SystemRoot%\System32\FSUtil.exe&quot; File SetShortName &quot;%SystemDrive%\SENTINEL.EXE&quot; PROGRAM.EXE</KBD></PRE>
            To list other locations (i.e. directories with a space in their
            name) where
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            may be placed, start the
            <CITE TITLE="Cmd.exe">Command Processor</CITE> and run the following
            command lines:
        <PRE><KBD TITLE="Console Input">REM Copyright &copy; 2004-2021, Stefan Kanthak &lt;&zwj;stefan&zwj;.&zwj;kanthak&zwj;@&zwj;nexgo&zwj;.&zwj;de&zwj;&gt;

FOR /D /R &quot;%SystemRoot%&quot; %? IN (&quot;* *&quot;) DO @ECHO %?
FOR /D /R &quot;%ProgramFiles%&quot; %? IN (&quot;* *&quot;) DO @ECHO %?
IF DEFINED ProgramFiles(x86) IF NOT &quot;%ProgramFiles(x86)%&quot; == &quot;%ProgramFiles%&quot; FOR /D /R &quot;%ProgramFiles(x86)%&quot; %? IN (&quot;* *&quot;) DO @ECHO %?
FOR /D /R &quot;%USERPROFILE%&quot; %? IN (&quot;* *&quot;) DO @ECHO %?</KBD></PRE>
            <IMG ALIGN="Right"
                 ALT="[Screen shot of SENTINEL.EXE started on Windows XP by defective scanner software]"
                 BORDER="0"
                 HSPACE="5"
                 SRC="download/SENTINEL.PNG"
                 TITLE="Screen shot of SENTINEL.EXE started on Windows XP by defective scanner software"
                 VSPACE="5">
            When <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            runs in an interactive user session it displays a message box like
            that shown to the right.
        <BR><STRONG>Note:</STRONG>
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            can determine the calling process only if it still exists and it
            runs in the same (unprivileged) security context, on systems with
            <CITE>AMD64</CITE> alias <CITE>x64</CITE> processor architecture
            also in the same (32- or 64-bit) execution environment!
        <BR CLEAR="All">
        <P> To test the proper function of
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>,
            execute it per double-click from
            <CITE TITLE="Explorer.exe">Windows Explorer</CITE> or call it from
            the <CITE TITLE="Cmd.exe">Command Processor</CITE>.
        <P> When executed, both
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            write a message similar to that shown in the message boxes to
            <CITE>Windows&rsquo;</CITE> <CITE>Event Log</CITE>, using the source
            <CODE>Vulnerability and Exploit Detector</CODE>.
        <BR>To retrieve these messages from the <CITE>Event Log</CITE>, start
            the <CITE TITLE="Cmd.exe">Command Processor</CITE> and run the
            following command line:
        <PRE><KBD TITLE="Console Input">&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; NTEvent Where &quot;SourceName='Vulnerability and Exploit Detector'&quot; Get /Value</KBD></PRE>
            For a typical output of this command line see
            <A HREF="download/SENTINEL.TXT" TYPE="text/plain"><CODE>SENTINEL.TXT</CODE></A>.
        <H3 ID="limitation">Limitation</H3>
            When
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            is (renamed and) used as
            <A HREF="https://msdn.microsoft.com/en-us/library/ms684184.aspx" TITLE="Load-Time Dynamic Linking">static (load-time) dependency</A>
            of an arbitrary executable (a program or another
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>), loading of
            this executable usually fails due to unresolved external symbols or
            ordinals, and
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            is not run:
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            does not
            <A HREF="https://msdn.microsoft.com/en-us/library/z4zxe9k8.aspx" TITLE="Exporting from a DLL">export</A>
            the symbols and ordinals of the <Q>original</Q>
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>.
        <P> This limitation can be overcome by forwarding the missing
            <A HREF="https://msdn.microsoft.com/en-us/library/hyx1zcd3.aspx" TITLE="EXPORTS">exports</A>
            to the <Q>original</Q>
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM> using a
            <A HREF="https://msdn.microsoft.com/en-us/library/28d6s79h.aspx" TITLE="Module-Definition (.Def) Files"><CODE>.def</CODE></A>
            file when linking
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>:
        <PRE><CODE TITLE="Module Definition File">; Copyright &copy; 2004-2021, Stefan Kanthak &lt;&zwj;stefan&zwj;.&zwj;kanthak&zwj;@&zwj;nexgo&zwj;.&zwj;de&zwj;&gt;

LIBRARY &lsaquo;module&rsaquo;

EXPORTS
        &lsaquo;symbol&rsaquo;=[C:\Windows\]System32\&lsaquo;filename&rsaquo;.&lsaquo;symbol&rsaquo; @&lsaquo;ordinal&rsaquo; PRIVATE
        &hellip;
        @&lsaquo;ordinal&rsaquo;=[C:\Windows\]System32\&lsaquo;filename&rsaquo;.#&lsaquo;ordinal&rsaquo; @&lsaquo;ordinal&rsaquo; NONAME PRIVATE
        &hellip;</CODE></PRE>
            <STRONG>Caveat:</STRONG> export forwarding is limited to target
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s with extension
            <CODE>.dll</CODE>!
        <P> <STRONG>Note:</STRONG> <Q>original</Q>
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s located in
            <CITE>Windows&rsquo;</CITE>
            <A HREF="https://msdn.microsoft.com/en-us/library/ms724373.aspx" TITLE="GetSystemDirectory function"><Q>system directory</Q></A>
            <CODE>%SystemRoot%\System32\</CODE> can be referenced with their
            relative pathname <CODE>System32\&lsaquo;filename&rsaquo;</CODE>
            since the
            <A HREF="https://msdn.microsoft.com/en-us/library/ms724454.aspx" TITLE="GetWindowsDirectory function"><Q>windows directory</Q></A>
            <CODE>%SystemRoot%\</CODE> is in the search path too:
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ms684175.aspx" TITLE="LoadLibrary function">
            [&hellip;] If a relative path is specified, the entire relative path
            is appended to every token in the DLL search path list.
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ms684179.aspx" TITLE="LoadLibraryEx function">
            [&hellip;] If <EM>lpFileName</EM> specifies a relative path, the
            entire relative path is appended to every token in the DLL search
            path.
        </BLOCKQUOTE>
            <STRONG>Note:</STRONG> <CODE>.def</CODE> files can be created with a
            simple batch script (<CODE>.cmd</CODE>) from the output of the
            following command line:
        <PRE><KBD TITLE="Console Input">LINK.EXE /DUMP /HEADERS &lsaquo;module&rsaquo;.dll</KBD></PRE>
            A complete set of 32-bit forwarder
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s for all
            <Q>system</Q> <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s
            of <CITE>Windows XP</CITE> and <CITE>Windows 7</CITE> is available
            on
            <A HREF="mailto:?Subject=Request%20for%20forwarder%20DLLs&amp;To=Stefan%20Kanthak%20%3Cstefan%2Ekanthak%40nexgo%2Ede%3E">request</A>.
        <H3 ID="background">Background Information</H3>
        <H4>Execution of bogus or rogue programs</H4>
            The most <DEL>prominent</DEL> <INS>notorious</INS>, well-known and
            well-documented example is the unintended execution of
        <BR><CODE>%SystemDrive%\Program.exe</CODE> or (for example)
        <BR><CODE>&quot;%SystemDrive%\Program Files\Internet.exe&quot;</CODE>
            alias
        <BR><CODE>&quot;%ProgramFiles%\Internet.exe&quot;</CODE>
            instead of the intended execution of (again for example)
        <BR><CODE>&quot;%SystemDrive%\Program Files\Internet Explorer\IExplore.exe&quot;</CODE>
            alias
        <BR><CODE>&quot;%ProgramFiles%\Internet Explorer\IExplore.exe&quot;</CODE>
            due to missing quotes around the <Q>long</Q> filename or pathname of
            an executable file that contains spaces when used in a command line
            like
        <BR><CODE>%SystemDrive%\Program Files\Internet Explorer\IExplore.exe -nohome</CODE>
            alias
        <BR><CODE>%ProgramFiles%\Internet Explorer\IExplore.exe -nohome</CODE>.
        <P> The resulting weakness is listed as
            <A HREF="https://cwe.mitre.org/data/definitions/428.html" TITLE="CWE-428: Unquoted Search Path or Element"><ACRONYM TITLE="Common Weakness Enumeration">CWE</ACRONYM>-428: Unquoted Search Path or Element</A>
            in the
            <ACRONYM TITLE="Common Weakness Enumeration">CWE</ACRONYM><SUP>&trade;</SUP>.
        <P> This (unfortunately way too) common <DEL>programmer&rsquo;s</DEL>
            <INS>beginner&rsquo;s</INS> error is documented in the
            <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM> articles
            for the <CITE>Win32</CITE> functions
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682425.aspx" TITLE="CreateProcess function"><CODE>CreateProcess()</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682429.aspx" TITLE="CreateProcessAsUser function"><CODE>CreateProcessAsUser()</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682431.aspx" TITLE="CreateProcessWithLogonW function"><CODE>CreateProcessWithLogonW()</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682434.aspx" TITLE="CreateProcessWithTokenW function"><CODE>CreateProcessWithTokenW()</CODE></A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/ms687393.aspx" TITLE="WinExec function"><CODE>WinExec()</CODE></A>
            under the heading
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682425.aspx#security-remarks" TITLE="CreateProcess function&#13;&#10;Security Remarks"><Q>Security Remarks</Q></A>,
            for the <CITE>Win32</CITE> function
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682450.aspx" TITLE="CreateService function"><CODE>CreateService()</CODE></A>,
            and (for example) in the
            <ACRONYM TITLE="Microsoft Support Knowledge Base">MSKB</ACRONYM>
            articles
            <A HREF="https://support.microsoft.com/en-us/kb/134425" TITLE="Event ID 7000: %1 Not A Valid Windows NT Application">134425</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/139427" TITLE="Using Long Filenames with the Run Command">139427</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/140724" TITLE="PRB: FindExecutable() Truncates Result at First Space in LFN">140724</A>
            and
            <A HREF="https://support.microsoft.com/en-us/kb/812486" TITLE="Event ID 7000 and &quot;%1 Is Not a Valid Win32 Application&quot; Error Message When You Start a Service">812486</A>.
        <P> The (to say the very least) <DEL>weird</DEL> <INS>braindead</INS>
            behaviour of these <CITE>Win32</CITE> functions which lets this
            beginner&rsquo;s error go undetected (without a properly named
            <Q>sentinel</Q> placed aside all executable files with a space in
            their name and all directories with a space in their name which
            contain executable files) is documented in the
            <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM> articles
            referenced above under the heading <Q>Parameters</Q> and exists
            since the introduction of <Q>long</Q> filenames with
            <CITE>Win32</CITE> in <CITE>Windows NT 3.1</CITE> (and of course
            <CITE>Windows 95</CITE> too) more than 20 years ago:
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ms682425.aspx" TITLE="CreateProcess function">
            [&hellip;] the module name must be the first white space-delimited
            token in the <EM>lpCommandLine</EM> string. If you are using a long
            file name that contains a space, use quoted strings to indicate
            where the file name ends and the arguments begin; otherwise, the
            file name is ambiguous. For example, consider the string
            &quot;c:\program&nbsp;files\sub&nbsp;dir\program&nbsp;name&quot;.
            This string can be interpreted in a number of ways. The system tries
            to interpret the possibilities in the following order:
        <DL>
        <DD><STRONG>c:\program.exe</STRONG>&nbsp;files\sub&nbsp;dir\program&nbsp;name</DD>
        <DD><STRONG>c:\program&nbsp;files\sub.exe</STRONG>&nbsp;dir\program&nbsp;name</DD>
        <DD><STRONG>c:\program&nbsp;files\sub&nbsp;dir\program.exe</STRONG>&nbsp;name</DD>
        <DD><STRONG>c:\program&nbsp;files\sub&nbsp;dir\program&nbsp;name.exe</STRONG></DD>
        </DL>
        </BLOCKQUOTE>
            These <CITE>Win32</CITE> functions play
            <STRONG>try&thinsp;&amp;&thinsp;error</STRONG> where they should but
            fail and return an error to their caller!
        <P> <STRONG>Note:</STRONG> the following rules of interpretation are
            missing in the documentation:
        <UL>
        <LI>all possibilities are tried without the extension <CODE>.exe</CODE>
            first (executable files don&rsquo;t need to have an extension at
            all);
        </LI>
        <LI>all possibilities where both a matching file with extension
            <CODE>.exe</CODE> and a matching directory without extension exist
            are discarded;
        </LI>
        <LI>except for the last possibility matching directories are discarded.
        </LI>
        </UL>
        <P> To perform a quick (but non-exhaustive) check whether your
            <CITE>Windows</CITE> installation is affected, start the
            <CITE TITLE="Cmd.exe">Command Processor</CITE>, run the following
            command lines and inspect their output:
        <PRE><KBD TITLE="Console Input">REM Copyright &copy; 2004-2021, Stefan Kanthak &lt;&zwj;stefan&zwj;.&zwj;kanthak&zwj;@&zwj;nexgo&zwj;.&zwj;de&zwj;&gt;

FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%ProgramFiles%&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%ProgramFiles&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%CommonProgramFiles&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=!USERPROFILE:\%USERNAME%=\!&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot; %ProgramFiles%&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot; %ProgramFiles&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot; %CommonProgramFiles&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot; !USERPROFILE:\%USERNAME%=\!&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; Service Get PathName /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;\Windows &quot; | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;PathName=&quot;&quot;&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; Service Get PathName /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%ProgramFiles%&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; Service Get PathName /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=!USERPROFILE:\%USERNAME%=\!&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;LocalServer Is Not NULL&quot; Get LocalServer /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%ProgramFiles%&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;LocalServer Is Not NULL&quot; Get LocalServer /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%ProgramFiles&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;LocalServer Is Not NULL&quot; Get LocalServer /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%CommonProgramFiles&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;LocalServer Is Not NULL&quot; Get LocalServer /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=!USERPROFILE:\%USERNAME%=\!&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;LocalServer32 Is Not NULL&quot; Get LocalServer32 /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%ProgramFiles%&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;LocalServer32 Is Not NULL&quot; Get LocalServer32 /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%ProgramFiles&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;LocalServer32 Is Not NULL&quot; Get LocalServer32 /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=%CommonProgramFiles&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;LocalServer32 Is Not NULL&quot; Get LocalServer32 /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot;=!USERPROFILE:\%USERNAME%=\!&quot;</KBD></PRE>
            <STRONG>Note:</STRONG> the command lines can be copied and pasted as
            block into a <CITE TITLE="Cmd.exe">Command Processor</CITE> window!
        <P> Use the batch script
            <A HREF="download/SLOPPY.CMD" TYPE="text/plain"><CODE>SLOPPY.CMD</CODE></A>
            to perform all the checks listed here and below.
        <BR>Download, read and run the batch scripts
            <A HREF="download/SLOPPY7X.CMD" TYPE="text/plain"><CODE>SLOPPY7X.CMD</CODE></A>
            and
            <A HREF="download/SLOPPY7D.CMD" TYPE="text/plain"><CODE>SLOPPY7D.CMD</CODE></A>
            to conduct a more thorough check.
        <P> If you detect an unquoted <Q>long</Q> filename or pathname
            containing spaces in a command line, direct the author(s) of the
            defective software (for example) to the
            <ACRONYM TITLE="Microsoft Support Knowledge Base">MSKB</ACRONYM>
            articles
            <A HREF="https://support.microsoft.com/en-us/kb/102739" TITLE="Long Filenames or Paths with Spaces Require Quotation Marks">102739</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/166827" TITLE="Native MS-DOS Commands and the Space Character">166827</A>
            and
            <A HREF="https://support.microsoft.com/en-us/kb/170669" TITLE="Creating C:\Program Folder Causes Add/Remove Program to Fail">170669</A>,
            the <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM>
            articles
            <A HREF="https://msdn.microsoft.com/en-us/library/cc144101.aspx" TITLE="Extending Shortcut Menus">Extending Shortcut Menus</A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/cc144175.aspx" TITLE="Verbs and File Associations">Verbs and File Associations</A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/cc144156.aspx" TITLE="Best Practices for File Associations">Best Practices for File Associations</A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/cc144109.aspx" TITLE="Registering Programs with Client Types">Registering Programs with Client Types</A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/dd203067.aspx" TITLE="How to Register an Internet Browser or Email Client With the Windows Start Menu">How to Register an Internet Browser or Email Client With the Windows Start Menu</A>,
            plus the
            <ACRONYM TITLE="Microsoft Technician Network">TechNet</ACRONYM>
            article
            <A HREF="https://technet.microsoft.com/en-us/library/cc976806.aspx" TITLE="Using Long File Names">Using Long File Names</A>
            and request a fix for this well-known vulnerability!
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/cc144175.aspx" TITLE="Verbs and File Associations">
            If any element of the command string contains or might contain
            spaces, it must be enclosed in quotation marks. Otherwise, if the
            element contains a space, it will not parse correctly. For instance,
            <STRONG>&quot;My Program.exe&quot;</STRONG> starts the application
            properly. If you use <STRONG>My Program.exe</STRONG> without
            quotation marks, then the system attempts to launch
            <STRONG>My</STRONG> with <STRONG>Program.exe</STRONG> as its first
            first command line argument. You should always use quotation marks
            with arguments such as <STRONG>%1</STRONG> that are expanded to
            strings by the Shell, because you cannot be certain that the string
            will not contain a space.
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/cc144109.aspx" TITLE="Registering Programs with Client Types">
            The command line must specify a fully qualified absolute path to the
            file, followed by optional command-line options. Use quotation marks
            appropriately to ensure that spaces in the command line are not
            misinterpreted.
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ms682450.aspx" TITLE="CreateService function">
        <DL>
        <DT><EM>lpBinaryPathName</EM> [in, optional]</DT>
        <DD>The fully qualified path to the service binary file. If the path
            contains a space, it must be quoted so that it is correctly
            interpreted. For example, &quot;d:\\my share\\myservice.exe&quot;
            should be specified as
            &quot;\&quot;d:\\my share\\myservice.exe\&quot;&quot;.
        </DD>
        </DL>
        </BLOCKQUOTE>
            To perform a quick (but non-exhaustive) check whether your
            <CITE>Windows</CITE> installation is affected by both aforementioned
            bugs, start the <CITE TITLE="Cmd.exe">Command Processor</CITE>, run
            the following command lines and inspect their output:
        <PRE><KBD TITLE="Console Input">REM Copyright &copy; 2004-2021, Stefan Kanthak &lt;&zwj;stefan&zwj;.&zwj;kanthak&zwj;@&zwj;nexgo&zwj;.&zwj;de&zwj;&gt;

FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;.&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;\&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot; %L&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; &quot; %1&quot;</KBD></PRE>
            <STRONG>Note:</STRONG> the command lines can be copied and pasted as
            block into a <CITE TITLE="Cmd.exe">Command Processor</CITE> window!
        <P> Use the batch script
            <A HREF="download/SLOPPY.CMD" TYPE="text/plain"><CODE>SLOPPY.CMD</CODE></A>
            to perform all the checks listed here, above and below.
        <BR>Download, read and run the batch scripts
            <A HREF="download/SLOPPY7X.CMD" TYPE="text/plain"><CODE>SLOPPY7X.CMD</CODE></A>
            and
            <A HREF="download/SLOPPY7D.CMD" TYPE="text/plain"><CODE>SLOPPY7D.CMD</CODE></A>
            to conduct a more thorough check.
        <P> If you detect a simple filename or a partial (relative) pathname
            instead of a full (absolute) pathname or an unquoted argument
            (<STRONG>anywhere</STRONG>, not only) in the command lines printed
            by <CODE>FTYPE</CODE>, direct the author(s) of the vulnerable
            software (for example) to the
            <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM> articles
            referenced above and request a fix for this well-known
            vulnerability!
        <P> Also ask the author(s) of the defective software why they
            don&rsquo;t use
            <A HREF="https://msdn.microsoft.com/en-us/library/aa480483.aspx" TITLE="Using Application Verifier Within Your Software Development Lifecycle"><CITE>Application Verifier</CITE></A>
            to test their software!
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/aa480483.aspx" TITLE="Using Application Verifier Within Your Software Development Lifecycle">
            Calls to the CreateProcess
            <ACRONYM TITLE="Application Program Interface">API</ACRONYM>
            function are subject to attack if parameters are not specified
            correctly. AppVerifier generates an error if CreateProcess (or other
            related <ACRONYM TITLE="Application Program Interface">API</ACRONYM>
            functions) are called with a NULL <EM>lpApplicationName</EM>
            parameter and an <EM>lpCommandLine</EM> parameter that contains
            spaces. For example, it does not allow the following as the command
            line parameter:
        <PRE>
            c:\program files\sample.exe -t -g c:\program files\sample\test
        </PRE>
            Using this command line, an application can inadvertently execute
            unwanted code if a malicious user installs his program to
            C:\Program.
        </BLOCKQUOTE>
        <H4>Execution of bogus or rogue <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s</H4>
            The other <DEL>prominent</DEL> <INS>infamous</INS> and well-known
            example, first reported on September&nbsp;18,&nbsp;2000 as
            <A HREF="http://www.guninski.com/officedll.html" TITLE="Double clicking on MS Office documents from Windows Explorer may execute arbitrary programs in some cases">Georgi Guninski security advisory #21, 2000</A>
            and listed as
            <A HREF="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0854"><ACRONYM TITLE="Common Vulnerabilities and Exposures">CVE</ACRONYM>-2000-0854</A>
            in the
            <ACRONYM TITLE="Common Vulnerabilities and Exposures">CVE</ACRONYM><SUP>&reg;</SUP>,
            is the unintended execution of bogus or rogue
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s (and programs)
            with the well-known filename of a system
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>
            (or a system program) from (usually) the
            <ACRONYM TITLE="Current Working Directory">CWD</ACRONYM> or the
            <Q>application directory</Q> instead of <CITE>Windows&rsquo;</CITE>
            <A HREF="https://msdn.microsoft.com/en-us/library/ms724373.aspx" TITLE="GetSystemDirectory function"><Q>system directory</Q></A>
            <CODE>%SystemRoot%\System32\</CODE> due to insecure search path
            handling and the use of a simple filename or a relative (partial)
            pathname instead of an absolute (full) pathname, known as
            <A HREF="http://www.blacksheepnetworks.com/security/info/nt/ntintrotosec.htm" TITLE="An Intro to... Windows NT Security">DLL spoofing</A>
            alias
            <A HREF="https://blogs.msdn.microsoft.com/david_leblanc/2008/02/20/dll-preloading-attacks/" TITLE="DLL Preloading Attacks">DLL preloading</A>,
            <A HREF="https://insights.sei.cmu.edu/cert/2008/09/carpet-bombing-and-directory-poisoning.html" TITLE="Carpet Bombing and Directory Poisoning">directory poisoning</A>,
            <A HREF="http://www.binaryplanting.com/index.htm">binary planting</A>,
            <A HREF="https://www.corelan.be/index.php/2010/08/25/dll-hijacking-kb-2269637-the-unofficial-list/">DLL hijacking</A>
            and
            <A HREF="https://attack.mitre.org/wiki/Technique/T1073" TITLE="DLL Side-Loading &ndash; ATT&amp;CK">DLL side-loading</A>.
        <P> The resulting weaknesses are listed as
            <A HREF="https://cwe.mitre.org/data/definitions/426.html" TITLE="CWE-426: Untrusted Search Path"><ACRONYM TITLE="Common Weakness Enumeration">CWE</ACRONYM>-426: Untrusted Search Path</A>
            and
            <A HREF="https://cwe.mitre.org/data/definitions/427.html" TITLE="CWE-427: Uncontrolled Search Path Element"><ACRONYM TITLE="Common Weakness Enumeration">CWE</ACRONYM>-427: Uncontrolled Search Path Element</A>
            in the
            <ACRONYM TITLE="Common Weakness Enumeration">CWE</ACRONYM><SUP>&trade;</SUP>.
        <P> The posts
            <A HREF="https://blogs.technet.microsoft.com/srd/2009/04/14/ms09-014-addressing-the-safari-carpet-bomb-vulnerability/" TITLE="MS09-014: Addressing the Safari Carpet Bomb vulnerability">MS09-014: Addressing the Safari Carpet Bomb vulnerability</A>,
            <A HREF="https://blogs.technet.microsoft.com/srd/2010/08/23/more-information-about-the-dll-preloading-remote-attack-vector/" TITLE="More information about the DLL Preloading remote attack vector">More information about the DLL Preloading remote attack vector</A>,
            <A HREF="https://blogs.technet.microsoft.com/srd/2010/08/31/an-update-on-the-dll-preloading-remote-attack-vector/" TITLE="An update on the DLL-preloading remote attack vector">An update on the DLL-preloading remote attack vector</A>
            and
            <A HREF="https://blogs.technet.microsoft.com/srd/2018/04/04/triaging-a-dll-planting-vulnerability/" TITLE="Triaging a DLL planting vulnerability">Triaging a DLL planting vulnerability</A>
            on <CITE>Microsoft</CITE>&rsquo;s
            <A HREF="https://blogs.technet.microsoft.com/srd/default.aspx" TITLE="Security Research and Defense Blog"><CITE>Security Research and Defense Blog</CITE></A>
            give additional information.
        <P> For loading of <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s
            the proper and secure search path handling is documented in the
            <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM> articles
            <A HREF="https://msdn.microsoft.com/en-us/library/ff919712.aspx" TITLE="Dynamic-Link Library Security">Dynamic-Link Library Security</A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682586.aspx" TITLE="Dynamic-Link Library Search Order">Dynamic-Link Library Search Order</A>,
            the <CITE>Security Advisory</CITE>
            <A HREF="https://technet.microsoft.com/en-us/library/2269637.aspx" TITLE="Insecure Library Loading Could Allow Remote Code Execution">2269637</A>,
            the <ACRONYM TITLE="Microsoft Support Knowledge Base">MSKB</ACRONYM>
            articles
            <A HREF="https://support.microsoft.com/en-us/kb/2389418" TITLE="Secure loading of libraries to prevent DLL preloading attacks">2389418</A>
            and
            <A HREF="https://support.microsoft.com/en-us/kb/2533623" TITLE="Microsoft Security Advisory: Insecure library loading could allow remote code execution">2533623</A>,
            plus the post
            <A HREF="https://blogs.technet.microsoft.com/srd/2014/05/13/load-library-safely/" TITLE="Load Library Safely">Load Library Safely</A>:
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ms682586.aspx" TITLE="Dynamic-Link Library Search Order">
            Applications can control the location from which a DLL is loaded by
            specifying a full path or using another mechanism such as a manifest.
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ff919712.aspx" TITLE="Dynamic-Link Library Security">
            Wherever possible, specify a fully qualified path when using the
            <STRONG>LoadLibrary</STRONG>, <STRONG>LoadLibraryEx</STRONG>,
            <STRONG>CreateProcess</STRONG>, or <STRONG>ShellExecute</STRONG>
            functions.
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://support.microsoft.com/en-us/kb/2389418" TITLE="Secure loading of libraries to prevent DLL preloading attacks">
            Use fully qualified paths for all calls to
            <STRONG>LoadLibrary</STRONG>, <STRONG>CreateProcess</STRONG>, and
            <STRONG>ShellExecute</STRONG> where you can.
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://technet.microsoft.com/en-us/library/2269637.aspx" TITLE="Insecure Library Loading Could Allow Remote Code Execution">
            This exploit may occur when applications do not directly specify the
            fully qualified path to a library it intends to load.
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://blogs.technet.microsoft.com/srd/2014/05/13/load-library-safely/" TITLE="Load Library Safely">
            Always specify the fully qualified path when the library location is
            constant.
        </BLOCKQUOTE>
            Additionally see the
            <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM> articles
            <A HREF="https://msdn.microsoft.com/en-us/library/ms694515.aspx" TITLE="Self-Registration">Self-Registration</A>
            as well as
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682212.aspx" TITLE="DefaultIcon"><CODE>DefaultIcon</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms686595.aspx" TITLE="LocalServer"><CODE>LocalServer</CODE></A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/ms683844.aspx" TITLE="LocalServer32"><CODE>LocalServer32</CODE></A>:
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ms694515.aspx" TITLE="Self-Registration">
            The server must register the full path to the installation location
            of the DLL or EXE module for their respective
            <STRONG>InprocServer32</STRONG>, <STRONG>InprocHandler32</STRONG>,
            and <STRONG>LocalServer32</STRONG> keys in the registry.
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ms682212.aspx" TITLE="DefaultIcon">
            This is a <STRONG>REG_SZ</STRONG> value that specifies the full path
            to the executable name [&hellip;]
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ms686595.aspx" TITLE="LocalServer">
            Specifies the full path to a 16-bit local server application.
        </BLOCKQUOTE>
        <BLOCKQUOTE CITE="https://msdn.microsoft.com/en-us/library/ms683844.aspx" TITLE="LocalServer32">
            Specifies the full path to a 32-bit local server application.
        <BR>[&hellip;]
        <BR>The <STRONG>ServerExecutable</STRONG> value, which is of type
            <STRONG>REG_SZ</STRONG> and is supported starting with Windows
            Server&nbsp;2003, works in conjunction with the
            <STRONG>LocalServer32</STRONG> subkey to prevent any ambiguity when
            using the
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682425.aspx" TITLE="CreateProcess function"><STRONG>CreateProcess</STRONG></A>
            function. <STRONG>LocalServer32</STRONG> specifies the location of
            the COM server application to launch, and this information is passed
            as the first parameter <EM>lpApplicationName</EM> for
            <STRONG>CreateProcess</STRONG>. Depending on the implementation of
            <STRONG>CreateProcess</STRONG>, this information might be ambiguous.
            For this reason, if <STRONG>ServerExecutable</STRONG> is specified,
            COM passes the <STRONG>ServerExecutable</STRONG> named value to the
            <EM>lpApplicationName</EM> parameter of
            <STRONG>CreateProcess</STRONG>. If <STRONG>ServerExecutable</STRONG> is not specified, COM passes
            <STRONG>NULL</STRONG> as the value for the first parameter of
            <STRONG>CreateProcess</STRONG>.
        <P> To help provide system security, use quoted strings in the path to
            indicate where the executable filename ends and the arguments begin.
        </BLOCKQUOTE>
            <STRONG>Note:</STRONG> the
            <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM> articles
            <A HREF="https://msdn.microsoft.com/en-us/library/ms691354.aspx" TITLE="InprocHandler"><CODE>InprocHandler</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms693485.aspx" TITLE="InprocHandler32"><CODE>InprocHandler32</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms694328.aspx" TITLE="InprocServer"><CODE>InprocServer</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682390.aspx" TITLE="InprocServer32"><CODE>InprocServer32</CODE></A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/ms687316.aspx" TITLE="ToolBoxBitmap32"><CODE>ToolBoxBitmap32</CODE></A>
            fail to specify the use of full (absolute) pathnames and need to be
            corrected!
        <P> To perform a quick (but non-exhaustive) check whether your
            <CITE>Windows</CITE> installation is affected, start the
            <CITE TITLE="Cmd.exe">Command Processor</CITE>, run the following
            command lines and inspect their output:
        <PRE><KBD TITLE="Console Input">REM Copyright &copy; 2004-2021, Stefan Kanthak &lt;&zwj;stefan&zwj;.&zwj;kanthak&zwj;@&zwj;nexgo&zwj;.&zwj;de&zwj;&gt;

FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot; %ProgramFiles%&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot; %ProgramFiles&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot; %CommonProgramFiles&quot;
FTYPE | &quot;%SystemRoot%\System32\Find.exe&quot; /I &quot; !USERPROFILE:\%USERNAME%=\!&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;InProcHandler Is Not NULL&quot; Get InProcHandler /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;.&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;InProcHandler Is Not NULL&quot; Get InProcHandler /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;\&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;InProcHandler32 Is Not NULL&quot; Get InProcHandler32 /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;.&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;InProcHandler32 Is Not NULL&quot; Get InProcHandler32 /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;\&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;InProcServer Is Not NULL&quot; Get InProcServer /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;.&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;InProcServer Is Not NULL&quot; Get InProcServer /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;\&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;InProcServer32 Is Not NULL&quot; Get InProcServer32 /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;.&quot;
&quot;%SystemRoot%\System32\WBEM\WMIC.exe&quot; PATH Win32_ClassicCOMClassSetting Where &quot;InProcServer32 Is Not NULL&quot; Get InProcServer32 /Value | &quot;%SystemRoot%\System32\Find.exe&quot; /V &quot;\&quot;</KBD></PRE>
            <STRONG>Note:</STRONG> the command lines can be copied and pasted as
            block into a <CITE TITLE="Cmd.exe">Command Processor</CITE> window!
        <P> Use the batch script
            <A HREF="download/SLOPPY.CMD" TYPE="text/plain"><CODE>SLOPPY.CMD</CODE></A>
            to perform all the checks listed here and above.
        <BR>Download, read and run the batch scripts
            <A HREF="download/SLOPPY7X.CMD" TYPE="text/plain"><CODE>SLOPPY7X.CMD</CODE></A>
            and
            <A HREF="download/SLOPPY7D.CMD" TYPE="text/plain"><CODE>SLOPPY7D.CMD</CODE></A>
            to conduct a more thorough check.
        <P> <STRONG>Again:</STRONG> if you detect a simple filename or a
            partial (relative) pathname instead of a full (absolute) pathname
            in a call of a <CITE>Win32</CITE> function that loads an executable
            file, in a command line, in a shortcut (<CODE>.lnk</CODE>), in the
            <A HREF="https://support.microsoft.com/en-us/kb/256986" TITLE="Windows registry information for advanced users"><CITE>Registry</CITE></A>,
            in a
            <A HREF="https://msdn.microsoft.com/en-us/library/cc144102.aspx" TITLE="How to Customize Folders with Desktop.ini"><CODE>DESKTOP.INI</CODE></A>
            file etc. as well as an unquoted argument in a command line, direct
            the author(s) of the vulnerable software (for example) to the
            <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM> articles
            referenced above as well as
            <A HREF="http://www.binaryplanting.com/guidelinesDevelopers.htm">Guidelines For Developers</A>
            and request a fix for this well-known vulnerability!
        <H3 ID="vulnerabilities">Known Vulnerabilities</H3>
            Some, but not all (now fixed) individual vulnerabilities due to
            insecure search path handling only in <CITE>Microsoft</CITE>
            products are documented in the
            <ACRONYM TITLE="Microsoft Support Knowledge Base">MSKB</ACRONYM>
            articles
            <A HREF="https://support.microsoft.com/en-us/kb/306850" TITLE="Programs start slowly or slow logon if the network connection to your home folder is slow">306850</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/819125" TITLE="&quot;Application Name Is Not a Valid Win32 Application&quot; Error Message When You Try to Start ISA Services">819125</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/905890" TITLE="A program may run very slowly if the network connection to your home folder is slow in Windows Server 2003 or in Windows XP">905890</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/959426" TITLE="MS09-015: Blended threat vulnerability in SearchPath could allow elevation of privilege">959426</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2264107" TITLE="A new CWDIllegalInDllSearch registry entry is available to control the DLL search path algorithm">2264107</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2385678" TITLE="MS10-095: Vulnerability in Microsoft Windows could allow remote code execution">2385678</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2423089" TITLE="MS10-096: Vulnerability in Windows Address Book could allow remote code execution">2423089</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2423930" TITLE="MS10-087: Vulnerabilities in Microsoft Office could allow remote code execution">2423930</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2424434" TITLE="MS10-093: Vulnerability in Windows Movie Maker could allow remote code execution">2424434</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2443105" TITLE="MS10-097: Insecure Library Loading in Internet Connection Signup Wizard could allow remote code execution">2443105</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2447961" TITLE="MS10-094: Vulnerability in Windows Media Encoder could allow remote code execution">2447961</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2478935" TITLE="MS11-001: Vulnerability in Windows Backup Manager could allow remote code execution">2478935</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2482017" TITLE="MS11-003: Cumulative security update for Internet Explorer">2482017</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2489293" TITLE="MS11-023: Vulnerabilities in Microsoft Office could allow remote code execution: April 12, 2011">2489293</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2494047" TITLE="MS11-016: Vulnerabilities in Microsoft Office Groove 2007 could allow remote code execution: March 8, 2011">2494047</A>
            <A HREF="https://support.microsoft.com/en-us/kb/2500212" TITLE="MS11-025: Vulnerability in Microsoft Foundation Class (MFC) Library could allow remote code execution: April 12, 2011">2500212</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2508062" TITLE="MS11-017: Vulnerability in Remote Desktop client could allow remote code execution: March 8, 2011">2508062</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2510030" TITLE="MS11-015: Vulnerability in Microsoft DirectShow could allow remote code execution: March 8, 2011">2510030</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2533623" TITLE="Microsoft Security Advisory: Insecure library loading could allow remote code execution">2533623</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2560656" TITLE="MS11-059: Vulnerability in Data Access Components could allow remote code execution: August 9, 2011">2560656</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2560847" TITLE="MS11-055: Vulnerability in Microsoft Visio could allow remote code execution: July 12, 2011">2560847</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2570947" TITLE="MS11-071: Vulnerability in Windows Components could allow remote code execution: September 13, 2011">2570947</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2587634" TITLE="MS11-073: Vulnerability in Microsoft Office could allow remote code execution: September 13, 2011">2587634</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2603381" TITLE="MS12-002: Vulnerability in Windows Object Packager could allow remote code execution: January 10, 2012">2603381</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2604926" TITLE="MS11-076: Vulnerability in Windows Media Center could allow remote code execution: October 11, 2011">2604926</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2618444" TITLE="MS11-099: Cumulative Security Update for Internet Explorer: December 13, 2011">2618444</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2620704" TITLE="MS11-085: Vulnerability in Windows Mail and Windows Meeting Space could allow remote code execution: November 8, 2011">2620704</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2623699" TITLE="MS11-075: Vulnerability in Microsoft Active Accessibility could allow remote code execution: October 11, 2011">2623699</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2639142" TITLE="MS11-094: Vulnerabilities in Microsoft PowerPoint could allow remote code execution: December 13, 2011">2639142</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2643719" TITLE="MS12-012: Vulnerability in Color Control Panel could allow remote code execution: February 14, 2012">2643719</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2651018" TITLE="MS12-022: Vulnerability in Expression Design could allow remote code execution: March 13, 2012">2651018</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2651019" TITLE="MS12-021: Vulnerability in Visual Studio could allow elevation of privilege: March 13, 2012">2651019</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2661637" TITLE="MS12-014: Vulnerability in Indeo Codec could allow remote code execution: February 14, 2012">2661637</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2686509" TITLE="MS12-034: Description of the security update for CVE-2012-0181 in Windows XP and Windows Server 2003: May 8, 2012">2686509</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2707956" TITLE="MS12-039: Vulnerabilities in Lync could allow remote code execution: June 12, 2012">2707956</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2707960" TITLE="MS12-046: Vulnerability in Visual Basic for Applications could allow remote code execution: July 10, 2012">2707960</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2719662" TITLE="Microsoft Security Advisory: Vulnerabilities in Gadgets could allow remote code execution">2719662</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2745030" TITLE="MS12-074: Vulnerabilities in .NET Framework could allow remote code execution: November 13, 2012">2745030</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2961037" TITLE="MS14-023: Vulnerability in Microsoft Office could allow remote code execution">2961037</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3063858" TITLE="MS15-063: Vulnerability in Windows kernel could allow elevation of privilege: June 9, 2015">3063858</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3072620" TITLE="MS15-070: Vulnerabilities in Microsoft Office could allow remote code execution: July 14, 2015">3072620</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3072631" TITLE="MS15-069: Vulnerabilities in Windows could allow remote code execution: July 14, 2015">3072631</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3074162" TITLE="Microsoft security advisory: Vulnerability in Microsoft Malicious Software Removal Tool could allow elevation of privilege: July 14, 2015">3074162</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3080348" TITLE="MS15-082: Vulnerabilities in RDP could allow remote code execution: August 11, 2015">3080348</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3108347" TITLE="MS15-132: Description of the security update for Windows: December 8, 2015">3108347</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3108371" TITLE="MS15-132: Description of the security update for Windows: December 8, 2015">3108371</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3108381" TITLE="MS15-132: Description of the security update for Windows: December 8, 2015">3108381</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3108664" TITLE="MS16-007: Description of the security update for Windows: January 12, 2016">3108664</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3110329" TITLE="MS16-007: Description of the security update for Windows: January 12, 2016">3110329</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3116162" TITLE="MS15-132: Security update for Windows to address remote code execution: December 8, 2015">3116162</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3121461" TITLE="MS16-007: Description of the security update for Windows: January 12, 2016">3121461</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3121918" TITLE="MS16-007: Description of the security update for Windows: January 12, 2016">3121918</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3134228" TITLE="MS16-014: Security update for Microsoft Windows to address remote code execution: February 9, 2016">3134228</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3140709" TITLE="MS16-025: Security update for Windows library loading to address remote code execution: March 8, 2016">3140709</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3148531" TITLE="MS16-037: Cumulative security update for Internet Explorer: April 12, 2016">3148531</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3148789" TITLE="MS16-041: Security update for the .NET Framework: April 12, 2016">3148789</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3163610" TITLE="MS16-070: Security Update for Office: June 14, 2016">3163610</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3199172" TITLE="MS16-130: Security update for Microsoft Windows: November 8, 2016">3199172</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3204068" TITLE="MS16-148: Security Update for Microsoft Office to Address Remote Code Execution: December 13, 2016">3204068</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/3205655" TITLE="MS16-149: Security update for Microsoft Windows: December 13, 2016">3205655</A>
            and
            <A HREF="https://support.microsoft.com/en-us/kb/4013078" TITLE="MS17-012: Security update for Microsoft Windows: March 14, 2017">4013078</A>,
            the <CITE>Security Bulletins</CITE>
            <A HREF="https://technet.microsoft.com/en-us/library/ms06-051.aspx" TITLE="Vulnerability in Windows Kernel Could Result in Remote Code Execution (917422)">MS06-051</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms09-014.aspx" TITLE="Cumulative Security Update for Internet Explorer (963027)">MS09-014</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms09-015.aspx" TITLE="Blended Threat Vulnerability in SearchPath Could Allow Elevation of Privilege (959426)">MS09-015</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms10-087.aspx" TITLE="Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2423930)">MS10-087</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms10-093.aspx" TITLE="Vulnerability in Windows Movie Maker Could Allow Remote Code Execution (2424434)">MS10-093</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms10-094.aspx" TITLE="Vulnerability in Windows Media Encoder Could Allow Remote Code Execution (2447961)">MS10-094</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms10-095.aspx" TITLE="Vulnerability in Microsoft Windows Could Allow Remote Code Execution (2385678)">MS10-095</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms10-096.aspx" TITLE="Vulnerability in Windows Address Book Could Allow Remote Code Execution (2423089)">MS10-096</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms10-097.aspx" TITLE="Insecure Library Loading in Internet Connection Signup Wizard Could Allow Remote Code Execution (2443105)">MS10-097</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-001.aspx" TITLE="Vulnerability in Windows Backup Manager Could Allow Remote Code Execution (2478935)">MS11-001</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-003.aspx" TITLE="Cumulative Security Update for Internet Explorer (2482017)">MS11-003</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-015.aspx" TITLE="Vulnerabilities in Windows Media Could Allow Remote Code Execution (2510030)">MS11-015</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-016.aspx" TITLE="Vulnerability in Microsoft Groove Could Allow Remote Code Execution (2494047)">MS11-016</A>.
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-017.aspx" TITLE="Vulnerability in Remote Desktop Client Could Allow Remote Code Execution (2508062)">MS11-017</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-023.aspx" TITLE="Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2489293)">MS11-023</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-025.aspx" TITLE="Vulnerability in Microsoft Foundation Class (MFC) Library Could Allow Remote Code Execution (2500212)">MS11-025</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-055.aspx" TITLE="Vulnerability in Microsoft Visio Could Allow Remote Code Execution (2560847)">MS11-055</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-059.aspx" TITLE="Vulnerability in Data Access Components Could Allow Remote Code Execution (2560656)">MS11-059</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-071.aspx" TITLE="Vulnerability in Windows Components Could Allow Remote Code Execution (2570947)">MS11-071</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-073.aspx" TITLE="Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2587634)">MS11-073</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-075.aspx" TITLE="Vulnerability in Microsoft Active Accessibility Could Allow Remote Code Execution (2623699)">MS11-075</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-076.aspx" TITLE="Vulnerability in Windows Media Center Could Allow Remote Code Execution (2604926)">MS11-076</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-085.aspx" TITLE="Vulnerability in Windows Mail and Windows Meeting Space Could Allow Remote Code Execution (2620704)">MS11-085</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-094.aspx" TITLE="Vulnerabilities in Microsoft PowerPoint Could Allow Remote Code Execution (2639142)">MS11-094</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms11-099.aspx" TITLE="Cumulative Security Update for Internet Explorer (2618444)">MS11-099</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms12-002.aspx" TITLE="Vulnerability in Windows Object Packager Could Allow Remote Code Execution (2603381)">MS12-002</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms12-012.aspx" TITLE="Vulnerability in Color Control Panel Could Allow Remote Code Execution (2643719)">MS12-012</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms12-014.aspx" TITLE="Vulnerability in Indeo Codec Could Allow Remote Code Execution (2661637)">MS12-014</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms12-021.aspx" TITLE="Vulnerability in Visual Studio Could Allow Elevation of Privilege (2651019)">MS12-021</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms12-022.aspx" TITLE="Vulnerability in Expression Design Could Allow Remote Code Execution (2651018)">MS12-022</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms12-034.aspx" TITLE="Combined Security Update for Microsoft Office, Windows, .NET Framework, and Silverlight (2681578)">MS12-034</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms12-039.aspx" TITLE="Vulnerabilities in Lync Could Allow Remote Code Execution (2707956)">MS12-039</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms12-046.aspx" TITLE="Vulnerability in Visual Basic for Applications Could Allow Remote Code Execution (2707960)">MS12-046</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms12-074.aspx" TITLE="Vulnerabilities in .NET Framework Could Allow Remote Code Execution (2745030)">MS12-074</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms14-023.aspx" TITLE="Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2961037)">MS14-023</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms15-063.aspx" TITLE="Vulnerability in Windows Kernel Could Allow Elevation of Privilege (3063858)">MS15-063</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms15-069.aspx" TITLE="Vulnerabilities in Windows Could Allow Remote Code Execution (3072631)">MS15-069</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms15-070.aspx" TITLE="Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (3072620)">MS15-070</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms15-082.aspx" TITLE="Vulnerabilities in RDP Could Allow Remote Code Execution (3080348)">MS15-082</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms15-132.aspx" TITLE="Security Update for Microsoft Windows to Address Remote Code Execution (3116162)">MS15-132</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-007.aspx" TITLE="Security Update for Microsoft Windows to Address Remote Code Execution (3124901)">MS16-007</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-014.aspx" TITLE="Security Update for Microsoft Windows to Address Remote Code Execution (3134228)">MS16-014</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-025.aspx" TITLE="Security Update for Windows Library Loading to Address Remote Code Execution (3140709)">MS16-025</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-037.aspx" TITLE="Cumulative Security Update for Internet Explorer (3148531)">MS16-037</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-041.aspx" TITLE="Security Update for .NET Framework (3148789)">MS16-041</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-070.aspx" TITLE="Security Update for Microsoft Office (3163610)">MS16-070</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-130.aspx" TITLE="Security Update for Microsoft Windows (3199172)">MS16-130</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-148.aspx" TITLE="Security Update for Microsoft Office (3204068)">MS16-148</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-149.aspx" TITLE="Security Update for Microsoft Windows (3205655)">MS16-149</A>
            and
            <A HREF="https://technet.microsoft.com/en-us/library/ms17-012.aspx" TITLE="Security Update for Microsoft Windows (4013078)">MS17-012</A>,
            plus the <CITE>Security Advisories</CITE>
            <A HREF="https://technet.microsoft.com/en-us/library/953818.aspx" TITLE="Blended Threat from Combined Attack Using Apple's Safari on the Windows Platform">953818</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/2269637.aspx" TITLE="Insecure Library Loading Could Allow Remote Code Execution">2269637</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/2719662.aspx" TITLE="Vulnerabilities in Gadgets Could Allow Remote Code Execution">2719662</A>
            and
            <A HREF="https://technet.microsoft.com/en-us/library/3074162.aspx" TITLE="Vulnerability in Microsoft Malicious Software Removal Tool Could Allow Elevation of Privilege">3074162</A>.
        <BR>At the time of writing the <CITE>Security Advisory</CITE>
            <A HREF="https://technet.microsoft.com/en-us/library/2269637.aspx" TITLE="Insecure Library Loading Could Allow Remote Code Execution">2269637</A>
            lists 29 additional <CITE>Security Bulletins</CITE>!
        <P> The vulnerability fixed with
            <A HREF="https://support.microsoft.com/en-us/kb/3121918" TITLE="MS16-007: Description of the security update for Windows: January 12, 2016">3121918</A>
            alias
            <A HREF="https://technet.microsoft.com/en-us/library/ms16-007.aspx" TITLE="Security Update for Microsoft Windows to Address Remote Code Execution (3124901)">MS16-007</A>
            is listed as
            <A HREF="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0014"><ACRONYM TITLE="Common Vulnerabilities and Exposures">CVE</ACRONYM>-2016-0014</A>
            in the
            <ACRONYM TITLE="Common Vulnerabilities and Exposures">CVE</ACRONYM><SUP>&reg;</SUP>:
            whenever an application used <CITE>Win32</CITE> functions involving
            the
            <A HREF="https://technet.microsoft.com/en-us/library/cc781588.aspx" TITLE="How Encrypting File System Works"><CITE>Encrypting File System</CITE></A>,
            <CODE TITLE="Windows NT File Encryption Client Interfaces">FEClient.dll</CODE>
            was loaded using its simple filename instead of its fully qualified
            (absolute) pathname
            <CODE>%SystemRoot%\System32\FEClient.dll</CODE>.
        <BR>Please notice the entries for January 2016 on
            <A HREF="https://technet.microsoft.com/en-us/library/mt674627.aspx" TITLE="Acknowledgments &ndash; 2016">Acknowledgments &ndash; 2016</A>.
        <P> A variant of this programming error is documented in the
            <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM> articles
            for the <CITE>Win32</CITE> functions
            <A HREF="https://msdn.microsoft.com/en-us/library/ms684175.aspx" TITLE="LoadLibrary function"><CODE>LoadLibrary()</CODE></A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/ms684179.aspx" TITLE="LoadLibraryEx function"><CODE>LoadLibraryEx()</CODE></A>
            under the heading
            <A HREF="https://msdn.microsoft.com/en-us/library/ms684175.aspx#security-remarks" TITLE="LoadLibrary function&#13;&#10;Security Remarks"><Q>Security Remarks</Q></A>.
        <P> For the execution of programs some, but not all (now fixed)
            individual vulnerabilities due to insecure search path handling
            only in <CITE>Microsoft</CITE> products are documented in the
            <ACRONYM TITLE="Microsoft Support Knowledge Base">MSKB</ACRONYM>
            articles
            <A HREF="https://support.microsoft.com/en-us/kb/264061" TITLE="Home Folder Is Searched First When You Try to Run a Program">264061</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/269049" TITLE="MS00-052: Registry-Invoked Programs Use Standard Search Path">269049</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/303628" TITLE="Relative Path Issue Can Allow Program to Be Run Under the System Context">303628</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/327522" TITLE="MS02-064: Windows 2000 default permissions may permit Trojan horse attack">327522</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2781197" TITLE="Anti-malware platform update for Windows Defender is available in Windows 8">2781197</A>,
            <A HREF="https://support.microsoft.com/en-us/kb/2823482" TITLE="MS13-034: Vulnerability in Microsoft Antimalware Client could allow elevation of privilege: April 9, 2013">2823482</A>
            and
            <A HREF="https://support.microsoft.com/en-us/kb/2847927" TITLE="MS13-058: Vulnerability in Windows Defender could allow elevation of privilege: July 9, 2013">2847927</A>,
            plus the <CITE>Security Bulletins</CITE>
            <A HREF="https://technet.microsoft.com/en-us/library/ms00-052.aspx" TITLE="Patch Available for 'Relative Shell Path' Vulnerability">MS00-052</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms02-064.aspx" TITLE="Windows 2000 Default Permissions Could Allow Trojan Horse Program (Q327522)">MS02-064</A>,
            <A HREF="https://technet.microsoft.com/en-us/library/ms13-034.aspx" TITLE="Vulnerability in Microsoft Antimalware Client Could Allow Elevation of Privilege (2823482)">MS13-034</A>
            and
            <A HREF="https://technet.microsoft.com/en-us/library/ms13-058.aspx" TITLE="Vulnerability in Windows Defender Could Allow Elevation of Privilege (2847927)">MS13-058</A>.
        <P> The <ACRONYM TITLE="Microsoft Support Knowledge Base">MSKB</ACRONYM>
            article
            <A HREF="https://support.microsoft.com/en-us/kb/249321" TITLE="Unable to log on if the boot partition drive letter has changed">249321</A>
            but proposes to replace an absolute (full) pathname with a simple
            filename which introduces this vulnerability!
        <BR><STRONG>Note:</STRONG> a <CITE>Registry</CITE> entry of type
            <CODE>REG_EXPAND_SZ</CODE> with value
            <CODE>%SystemRoot%\System32\UserInit.exe</CODE> avoids both errors!
        <P> For the <CITE>Win32</CITE> functions
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682425.aspx" TITLE="CreateProcess function"><CODE>CreateProcess()</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682429.aspx" TITLE="CreateProcessAsUser function"><CODE>CreateProcessAsUser()</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682431.aspx" TITLE="CreateProcessWithLogonW function"><CODE>CreateProcessWithLogonW()</CODE></A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682434.aspx" TITLE="CreateProcessWithTokenW function"><CODE>CreateProcessWithTokenW()</CODE></A>
            another (now fixed) individual vulnerability where the command
            processor was called using the simple filename <CODE>CMD</CODE>
            instead of its fully qualified (absolute) pathname
            <CODE>%ComSpec%</CODE> alias
            <CODE>%SystemRoot%\System32\Cmd.exe</CODE> is documented in the
            <ACRONYM TITLE="Microsoft Support Knowledge Base">MSKB</ACRONYM>
            article
            <A HREF="https://support.microsoft.com/en-us/kb/2922229" TITLE="MS14-019 Vulnerability in Windows file handling component could allow remote code execution April 8, 2014">2922229</A>
            and the <CITE>Security Bulletin</CITE>
            <A HREF="https://technet.microsoft.com/en-us/library/ms14-019.aspx" TITLE="Vulnerability in Windows File Handling Component Could Allow Remote Code Execution (2922229)">MS14-019</A>.
        <BR>Please notice its
            <A HREF="https://technet.microsoft.com/en-us/library/ms14-019.aspx#ID0EKIAG" TITLE="Vulnerability in Windows File Handling Component Could Allow Remote Code Execution (2922229)&#13;&#10;Acknowledgements"><Q>Acknowledgements</Q></A>
            section, or see the entries for April on
            <A HREF="https://technet.microsoft.com/en-us/library/dn820091.aspx" TITLE="Acknowledgments &ndash; 2014">Acknowledgments &ndash; 2014</A>.
        <P> The post
            <A HREF="https://blogs.technet.microsoft.com/srd/2014/04/08/ms14-019-fixing-a-binary-hijacking-via-cmd-or-bat-file/" TITLE="MS14-019 &ndash; Fixing a binary hijacking via .cmd or .bat file">MS14-019 &ndash; Fixing a binary hijacking via .cmd or .bat file</A>
            on <CITE>Microsoft</CITE>&rsquo;s
            <A HREF="https://blogs.technet.microsoft.com/srd/default.aspx" TITLE="Security Research and Defense Blog"><CITE>Security Research and Defense Blog</CITE></A>
            provides additional information.
        <P> This vulnerability is listed as
            <A HREF="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0315"><ACRONYM TITLE="Common Vulnerabilities and Exposures">CVE</ACRONYM>-2014-0315</A>
            in the
            <ACRONYM TITLE="Common Vulnerabilities and Exposures">CVE</ACRONYM><SUP>&reg;</SUP>.
        <P> <IMG ALIGN="Right"
                 ALT="[Screen shot from german MSKB article 2647300: REGEDIT.EXE showing command lines with unquoted 'long' pathnames and a simple filename]"
                 BORDER="0"
                 HSPACE="5"
                 SRC="https://support.microsoft.com/library/images/2647325.png"
                 TITLE="Screen shot from german MSKB article 2647300: REGEDIT.EXE showing command lines with unquoted 'long' pathnames and a simple filename"
                 VSPACE="5">
            <STRONG>Many</STRONG>
            <A HREF="https://msdn.microsoft.com/en-us/library/aa376858.aspx" TITLE="About INF Files">setup scripts</A>
            for device drivers of <STRONG>many</STRONG> vendors (including
            <STRONG>many</STRONG>
            <ACRONYM TITLE="Windows Hardware Quality Lab">WHQL</ACRONYM>
            certified device drivers available from
            <A HREF="https://www.update.microsoft.com/windowsupdate/v6/default.aspx" TITLE="Windows Update"><CITE>Windows Update</CITE></A>
            and the
            <A HREF="https://catalog.update.microsoft.com/v7/site/home.aspx" TITLE="Microsoft Update Catalog"><CITE>Microsoft Update Catalog</CITE></A>)
            suffer from both beginner&rsquo;s errors too!
        <P> See the screen shot on the right for some examples of command lines
            with unquoted <Q>long</Q> pathnames and a simple filename.
        <P> Please notice the entries for
            <A HREF="https://technet.microsoft.com/en-us/security/cc308575.aspx#0514" TITLE="Security Researcher Acknowledgments Online Services &ndash; Prior Months | TechNet&#13;&#10;May 2014 Security Researchers">May 2014</A>
            and
            <A HREF="https://technet.microsoft.com/en-us/security/cc308575.aspx#0615" TITLE="Security Researcher Acknowledgments Online Services &ndash; Prior Months | TechNet&#13;&#10;June &amp; July 2015 Security Researchers">June 2015</A>
            on
            <A HREF="https://technet.microsoft.com/en-us/security/cc308575.aspx" TITLE="Security Researcher Acknowledgments Online Services &ndash; Prior Months | TechNet"><CITE>Security Researcher Acknowledgments Microsoft Online Services &ndash; Prior Months</CITE></A>.
        <BR CLEAR="Right">
        <P> Programs that are run from the user&rsquo;s <Q>Downloads</Q>
            directory <CODE>%USERPROFILE%\Downloads\</CODE>, the <Q>Temp</Q>
            directory <CODE>%TMP%\</CODE> alias
            <CODE>%USERPROFILE%\AppData\Local\Temp\</CODE> or
            <CODE>%SystemRoot%\Temp\</CODE> respectively, as well as the
            user&rsquo;s <Q>Desktop</Q> directory
            <CODE>%USERPROFILE%\Desktop\</CODE>, typically and especially
            (self-extracting or self-unpacking) installers, almost always load
            some <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s from these
            directories (which are their <Q>application directory</Q>), and
            typically also execute their <Q>payload</Q> from there.
        <P> <A HREF="https://technet.microsoft.com/en-us/library/dd346760.aspx" TITLE="IExpress Technology and the IExpress Wizard"><CITE>IExpress</CITE></A>
            installers like
            <CODE TITLE="Security Update Package">CAPICOM-KB931906-v2102.exe</CODE>,
            a security (<STRONG>sic!</STRONG>) update documented in the
            <ACRONYM TITLE="Microsoft Support Knowledge Base">MSKB</ACRONYM>
            article
            <A HREF="https://support.microsoft.com/en-us/kb/931906" TITLE="MS07-028: Vulnerability in CAPICOM could allow remote code execution">931906</A>
            and the <CITE>Security Bulletin</CITE>
            <A HREF="https://technet.microsoft.com/en-us/library/ms07-028.aspx" TITLE="Vulnerability in CAPICOM Could Allow Remote Code Execution (931906)">MS07-028</A>,
            <CODE TITLE="IExpress Setup">DotNETFX.exe</CODE> and
            <CODE TITLE="IExpress Setup">LangPack.exe</CODE> for the
            <A HREF="https://msdn.microsoft.com/en-us/library/aa480242.aspx" TITLE="Redistributing the .NET Framework 2.0"><CITE>.NET Framework</CITE></A>
            versions 1.0, 1.1 and 2.0, and <STRONG>many more</STRONG> are
            well-known examples for <CITE>arbitrary code execution</CITE>
            vulnerabilities, and since
            <CITE>Windows Vista<SUP>&reg;</SUP></CITE> due to
            <A HREF="https://support.microsoft.com/en-us/kb/2526083" TITLE="Disabling User Account Control (UAC) on Windows Server"><ACRONYM TITLE="User Account Control">UAC</ACRONYM>s</A>
            <A HREF="https://technet.microsoft.com/en-us/library/dd835540.aspx#installer-detection-technology" TITLE="UAC Architecture&#13;&#10;Installer detection technology"><Q>installer detection</Q></A>
            <CITE>privilege escalation</CITE> vulnerabilities too!
        <DL>
        <DT><STRONG>All</STRONG> executable installers built with</DT>
        <DD><CITE>InnoSetup</CITE> load and execute
            <CODE TITLE="Microsoft Desktop Window Manager API">DWMAPI.dll</CODE>
            or <CODE TITLE="Microsoft UxTheme Library">UXTheme.dll</CODE>,
            &hellip;;
        </DD>
        <DD><CITE>InstallShield</CITE> load and execute
            <CODE TITLE="Wrapper Dll for Richedit 1.0">RichEd32.dll</CODE>,
            &hellip;;
        </DD>
        <DD><ACRONYM TITLE="Nullsoft Scriptable Install System">NSIS</ACRONYM>
            before version 2.50 and 3.0b5 load and execute
            <CODE TITLE="Shell Folder Service">ShFolder.dll</CODE>,
            <CODE TITLE="Microsoft Desktop Window Manager API">DWMAPI.dll</CODE>
            or <CODE TITLE="Microsoft UxTheme Library">UXTheme.dll</CODE>,
            <CODE TITLE="Windows Setup API">SetupAPI.dll</CODE>,
            &hellip;;
        </DD>
        <DD><ACRONYM TITLE="Windows Installer XML">WiX</ACRONYM> toolset before
            version 3.10.2 load and execute
            <CODE TITLE="Windows Installer">MSI.dll</CODE>,
            <CODE TITLE="Version Checking and File Installation Libraries">Version.dll</CODE>,
            &hellip;;
        </DD>
        <DD>&hellip;</DD>
        </DL>
        <DL>
        <DT><STRONG>All</STRONG> self-extracting executable archives built with
        </DT>
        <DD><CITE>7-Zip</CITE> load and execute
            <CODE TITLE="Microsoft Desktop Window Manager API">DWMAPI.dll</CODE>
            or <CODE TITLE="Microsoft UxTheme Library">UXTheme.dll</CODE>,
            &hellip;;
        </DD>
        <DD><CITE>WinRAR</CITE> before version 5.31 load and execute
            <CODE TITLE="Microsoft Desktop Window Manager API">DWMAPI.dll</CODE>
            or <CODE TITLE="Microsoft UxTheme Library">UXTheme.dll</CODE>,
            <CODE TITLE="Rich Text Edit Control, v3.0">RichEd20.dll</CODE>,
            <CODE TITLE="Wrapper Dll for Richedit 1.0">RichEd32.dll</CODE>,
            &hellip;;
        </DD>
        <DD>&hellip;</DD>
        </DL>
        <H3 ID="weaknesses">Known Weaknesses</H3>
            Each and every program not installed in <CITE>Windows&rsquo;</CITE>
            <A HREF="https://msdn.microsoft.com/en-us/library/ms724373.aspx" TITLE="GetSystemDirectory function"><Q>system directory</Q></A>
            <CODE>%SystemRoot%\System32\</CODE> (see
            <A HREF="https://blogs.msdn.microsoft.com/oldnewthing/" TITLE="The Old New Thing">Raymond Chen&rsquo;s</A>
            <ACRONYM TITLE="Microsoft Technician Network">TechNet</ACRONYM>
            magazine article
            <A HREF="https://technet.microsoft.com/en-us/magazine/ff955767.aspx" TITLE="Windows Confidential: History&mdash;the Long Way Through"><CITE>Windows Confidential: History&mdash;the Long Way Through</CITE></A>
            for some hindsight) that is statically linked against
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s which are
            neither installed in the program&rsquo;s
            <Q>application directory</Q> nor listed as
            <A HREF="https://support.microsoft.com/en-us/kb/164501" TITLE="INFO: Windows NT/2000/XP Uses KnownDLLs Registry Entry to Find DLLs"><Q>known DLLs</Q></A>
            (see but
            <A HREF="https://technet.microsoft.com/en-us/magazine/2007.09.windowsconfidential.aspx" TITLE="Windows Confidential: The Known DLLs Balancing Act"><CITE>Windows Confidential: The Known DLLs Balancing Act</CITE></A>)
            or that (delay-)loads
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s which are not
            installed in the program&rsquo;s <Q>application directory</Q>
            without using their full (absolute) pathname is susceptible to
            <Q>DLL hijacking</Q>.
        <P> This attack is listed as
            <A HREF="https://capec.mitre.org/data/definitions/471.html" TITLE="CAPEC-471: Search Order Hijacking"><ACRONYM TITLE="Common Attack Pattern Enumeration and Classification">CAPEC</ACRONYM>-471: Search Order Hijacking</A>
            in the
            <ACRONYM TITLE="Common Attack Pattern Enumeration and Classification">CAPEC</ACRONYM><SUP>&trade;</SUP>.
        <P> Well-known examples of such programs are
        <DL>
        <DT><CODE TITLE="Windows Explorer">%SystemRoot%\Explorer.exe</CODE>:</DT>
        <DD>loads and executes <CODE>%SystemRoot%\ACLUI.dll</CODE> instead of
            <CODE TITLE="Security Descriptor Editor">%SystemRoot%\System32\ACLUI.dll</CODE>;
        </DD>
        <DT><CODE TITLE="Registry Editor">%SystemRoot%\RegEdit.exe</CODE>:</DT>
        <DD>as above;</DD>
        <DT><CODE TITLE="Windows Write">%SystemRoot%\Write.exe</CODE>;</DT>
        <DT><CODE TITLE="Dism Host Servicing Process">%SystemRoot%\System32\DISM\DISMHost.exe</CODE>:</DT>
        <DD>loads and executes
            <CODE TITLE="DISM PE Provider">%SystemRoot%\System32\DISM\PEProvider.dll</CODE>;
        <DT><CODE TITLE="System Preparation Utility">%SystemRoot%\System32\SysPrep\SysPrep.exe</CODE>:</DT>
        <DD>loads and executes
            <CODE>%SystemRoot%\System32\SysPrep\CryptBase.dll</CODE> instead of
            <CODE TITLE="Base cryptographic API DLL">%SystemRoot%\System32\CryptBase.dll</CODE>,
            &hellip;;</DD>
        <DT><CODE TITLE="WMI Commandline Utility">%SystemRoot%\System32\WBEM\WMIC.exe</CODE>;</DT>
        <DT>&hellip;</DT>
        </DL>
            Programs like
            <CODE TITLE="System Preparation Utility">%SystemRoot%\System32\SysPrep\SysPrep.exe</CODE>
            which silently gain full administrative privileges per
            <ACRONYM TITLE="User Account Control">UAC</ACRONYM>s
            <Q>auto-elevation</Q> (mis)feature in
            <Q>protected administrator</Q> accounts and request administrative
            privileges in standard user accounts, or programs like
            <CODE TITLE="Registry Editor">%SystemRoot%\RegEdit.exe</CODE> which request full
            administrative privileges in <Q>protected administrator</Q>
            accounts, execute these bogus or rogue
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s with full
            administrative privileges too.
        <P> <STRONG>Note:</STRONG> since creating (or replacing) files in
            <CODE>%SystemRoot%\System32\SysPrep\</CODE> or the
            <A HREF="https://msdn.microsoft.com/en-us/library/ms724454.aspx" TITLE="GetWindowsDirectory function"><Q>windows directory</Q></A>
            <CODE>%SystemRoot%\</CODE> needs administrative privileges, this
            weakness alone does not allow <CITE>privilege escalation</CITE>;
            together with <ACRONYM TITLE="User Account Control">UAC</ACRONYM>s
            <Q>auto-elevation</Q> (mis)feature for
            <Q>protected administrators</Q>, which can be (ab)used to create (or
            replace) arbitrary files in <CODE>%SystemRoot%\</CODE> and below
            using (for example) the command line
        <PRE><KBD TITLE="Console Input">&quot;%SystemRoot%\System32\WUSA.exe&quot; &quot;&lsaquo;cabinet file&rsaquo;&quot; /Extract:&quot;&lsaquo;target directory&rsaquo;&quot;</KBD></PRE>
            it but becomes an exploitable vulnerability!
        <H3 ID="implementation">Implementation and Build Details</H3>
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            are pure <CITE>Win32</CITE> binary executables, written in
            <CITE><ACRONYM TITLE="American National Standards Institute">ANSI</ACRONYM>&nbsp;C</CITE>,
            built with the <DEL><CITE>Platform
            <ACRONYM TITLE="Software Development Kit">SDK</ACRONYM></CITE> for
            <CITE>Windows Server 2003 R2</CITE></DEL>
            <INS><CITE>Microsoft Visual C++ Compiler 2010 SP1</CITE> from update
            <A HREF="https://support.microsoft.com/en-us/kb/2519277" TITLE="FIX: Visual C++ compilers are removed when you upgrade Visual Studio 2010 Professional or Visual Studio 2010 Express to Visual Studio 2010 SP1 if Windows SDK v7.1 is installed">2519277</A></INS>,
            but without the
            <ACRONYM TITLE="Microsoft Visual C Runtime">MSVCRT</ACRONYM>
            libraries, for use on
            <CITE>Windows <DEL>2000</DEL> <INS>XP</INS></CITE> and newer
            versions of <CITE>Windows NT</CITE> as well as
            <CITE TITLE="Windows Preinstallation Environment">Windows PE</CITE>.
        <P> <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            exports
            <A HREF="https://msdn.microsoft.com/en-us/library/ms690368.aspx" TITLE="DllCanUnloadNow entry point"><CODE>DllCanUnloadNow</CODE></A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/ms680760.aspx" TITLE="DllGetClassObject entry point"><CODE>DllGetClassObject</CODE></A>
            to support calls from
            <A HREF="https://msdn.microsoft.com/en-us/library/ms680573.aspx" TITLE="Component Object Model (COM)"><ACRONYM TITLE="Component Object Model">COM</ACRONYM></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/bb759846.aspx" TITLE="DllInstall function"><CODE>DllInstall</CODE></A>,
            <A HREF="https://msdn.microsoft.com/en-us/library/ms682162.aspx" TITLE="DllRegisterServer entry point"><CODE>DllRegisterServer</CODE></A>
            and
            <A HREF="https://msdn.microsoft.com/en-us/library/ms691457.aspx" TITLE="DllUnregisterServer entry point"><CODE>DllUnregisterServer</CODE></A>
            to support calls from
            <A HREF="https://support.microsoft.com/en-us/kb/249873" TITLE="How to use the Regsvr32 tool and troubleshoot Regsvr32 error messages"><CODE TITLE="Microsoft(C) Register Server">RegSvr32.exe</CODE></A>,
            plus <CODE>RunDLLA</CODE> and <CODE>RunDLLW</CODE> to support calls
            from
            <A HREF="https://support.microsoft.com/en-us/kb/164787" TITLE="INFO: Windows Rundll and Rundll32 Interface"><CODE TITLE="Run a DLL as an App">RunDLL32.exe</CODE></A>.
        <P> <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            are available for the <CITE>I386</CITE> alias <CITE>x86</CITE>,
            <CITE>AMD64</CITE> alias <CITE>x64</CITE> and <CITE>IA64</CITE>
            processor architectures of <CITE>Windows NT</CITE>, localised for
            English and German.
        <H3 ID="authenticity">Authenticity and Integrity</H3>
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>,
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and the cabinet file <CODE>SENTINEL.CAB</CODE> are
            <A HREF="https://technet.microsoft.com/en-us/library/cc962021.aspx" TITLE="Digital Signatures">digitally signed</A>
            using an
            <A HREF="https://msdn.microsoft.com/en-us/library/bb540819.aspx" TITLE="X.509 Public Key Certificates"><CITE>X.509</CITE></A>
            <A HREF="download/FREEMAIL.DER" TITLE="E = stefan&zwj;.&zwj;kanthak&zwj;@&zwj;web&zwj;.&zwj;de&#13;&#10;CN = Stefan Kanthak&#13;&#10;L = M&uuml;nchen&#13;&#10;C = DE" TYPE="application/pkix-cert">certificate</A>
            issued by
            <CITE TITLE="E = trust&zwj;@&zwj;web&zwj;.&zwj;de&#13;&#10;CN = WEB.DE TrustCenter E-Mail Certification Authority&#13;&#10;OU = Trust Center&#13;&#10;O = 1&amp;1 Mail &amp; Media GmbH&#13;&#10;L = D-76135 Karlsruhe&#13;&#10;S = Baden-Wuerttemberg&#13;&#10;C = DE">WEB.DE TrustCenter E-Mail Certification Authority</CITE>.
        <DL>
        <DT>Serial number of the certificate</DT>
        <DD>73633199</DD>
        <DD>0x04638DAF</DD>
        <DT>Fingerprint of the certificate</DT>
        <DD><ACRONYM TITLE="Message Digest 5">MD5</ACRONYM>:&nbsp;25&nbsp;a0&nbsp;d6&nbsp;b0&nbsp;bc&nbsp;37&nbsp;fe&nbsp;49&nbsp;42&nbsp;d1&nbsp;64&nbsp;ca&nbsp;e6&nbsp;7a&nbsp;f5&nbsp;7f</DD>
        <DD><ACRONYM TITLE="Secure Hash Algorithm 1">SHA-1</ACRONYM>:&nbsp;47&nbsp;79&nbsp;b5&nbsp;28&nbsp;f0&nbsp;84&nbsp;e6&nbsp;ce&nbsp;f8&nbsp;77&nbsp;7b&nbsp;62&nbsp;dc&nbsp;c4&nbsp;b3&nbsp;1f&nbsp;fe&nbsp;de&nbsp;07&nbsp;14</DD>
        </DL>
        <PRE><CODE TITLE="RSA Public Key">-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAxSwxNrFPXXn6y5Abl+0pH7faIK0xVAh70reOBrwSykab/0kIwz0QJldXNTLl
ZaSb4T7A5il2oqhiHUS53owsguXrDaJ+l+iTuCR/NrOVBJ0Xi+1Kv+ni/jb3cLvTS/BQJtFm
fVW3HHtYrQQcYCpd/AVzg1k2p46BEbGfFpjfFREdM589UDSzaiIOWSEBec8RI3HVqIMiG2qL
seuQot9shOcNcV2Y2AgTKHBUrWz10kbCWf8g5QA2hjmSMRvRtBOovCgvSF0nDFk4Odrn9nLB
PVq763s2vh/riO9cheTeg4N/ldbnAywdjLAwwJ1qynh2p/s/V5cnsoav7SZRGDyAoQIDAQAB
-----END RSA PUBLIC KEY-----</CODE></PRE>
            Download and install the
            <A HREF="https://trust.web.de/?t=ca&amp;i=webde"><CITE TITLE="E = trust&zwj;@&zwj;web&zwj;.&zwj;de&#13;&#10;CN = WEB.DE TrustCenter E-Mail Certification Authority&#13;&#10;OU = Trust Center&#13;&#10;O = 1&amp;1 Mail &amp; Media GmbH&#13;&#10;L = D-76135 Karlsruhe&#13;&#10;S = Baden-Wuerttemberg&#13;&#10;C = DE">CA</CITE></A>
            and
            <A HREF="https://trust.web.de/?t=r&amp;i=webde"><CITE TITLE="E = trust&zwj;@&zwj;web&zwj;.&zwj;de&#13;&#10;CN = WEB.DE TrustCenter&#13;&#10;OU = Trust Center&#13;&#10;O = 1&amp;1 Mail &amp; Media GmbH&#13;&#10;S = Baden-Wuerttemberg&#13;&#10;C = DE">root</CITE></A>
            <CITE>X.509</CITE> certificates of
            <A HREF="https://trust.web.de/" TITLE="WEB.DE TrustCenter"><CITE>WEB.DE</CITE></A>
            to validate and verify the digital signature.
        <P> <STRONG>Note:</STRONG> due to its counter signature alias
            <A HREF="https://msdn.microsoft.com/en-us/library/bb931395.aspx" TITLE="Time Stamping Authenticode Signatures">timestamp</A>
            the digital signature remains valid past the <CITE>X.509</CITE>
            <A HREF="https://msdn.microsoft.com/en-us/library/aa388452.aspx" TITLE="X.509 Digital Certification">certificates</A>
            expiration date!
        <H3 ID="download">Download</H3>
            <CODE>AMD64\SENTINEL.DLL</CODE>, <CODE>AMD64\SENTINEL.EXE</CODE>,
            <A HREF="download/SENTINEL.DLL" TYPE="application/vnd.microsoft.portable-executable"><CODE>I386\SENTINEL.DLL</CODE></A>,
            <A HREF="download/SENTINEL.EXE" TYPE="application/vnd.microsoft.portable-executable"><CODE>I386\SENTINEL.EXE</CODE></A>,
            <CODE>IA64\SENTINEL.DLL</CODE>, <CODE>IA64\SENTINEL.EXE</CODE> and
            the
            <A HREF="https://msdn.microsoft.com/en-us/library/aa376858.aspx" TITLE="About INF Files">setup script</A>
            <A HREF="download/SENTINEL.INF" TYPE="application/x-setupscript"><CODE>SENTINEL.INF</CODE></A>
            are packaged in the (compressed and
            <A HREF="https://support.microsoft.com/en-us/kb/247257" TITLE="Steps for signing a .cab file">digitally signed</A>)
            <A HREF="https://support.microsoft.com/en-us/kb/310435" TITLE="Description and Explanation of a Cabinet File"><CITE>cabinet</CITE></A>
            file
            <A HREF="download/SENTINEL.CAB" TYPE="application/vnd.ms-cab-compressed"><CODE>SENTINEL.CAB</CODE></A>.
        <PRE><SAMP TITLE="Console Output">Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

X:\&gt;EXTRACT.EXE /D SENTINEL.CAB
Microsoft (R) Cabinet Extraction Tool - Version 5.1.2600.5512
Copyright (c) Microsoft Corporation. All rights reserved..

 Cabinet SENTINEL.CAB

07-07-2017  2:04:02p A---        40,688 SENTINEL.INF
02-06-2017  3:12:28p A---        43,704 AMD64\SENTINEL.DLL
02-06-2017  3:12:30p A---        43,192 AMD64\SENTINEL.EXE
02-06-2017  3:12:20p A---        42,680 I386\SENTINEL.DLL
02-06-2017  3:12:22p A---        42,680 I386\SENTINEL.EXE
02-06-2017  3:12:38p A---        53,432 IA64\SENTINEL.DLL
02-06-2017  3:12:38p A---        53,432 IA64\SENTINEL.EXE
                 7 Files        319,808 bytes

X:\&gt;DIR SENTINEL.CAB
 Volume in drive X has no label.
 Volume Serial Number is 1957-0427

 Directory of X:\

07/07/2017   2:35 PM            47,453 SENTINEL.CAB
               1 File(s)         47,453 bytes
               0 Dir(s)     987,654,321 bytes free

X:\&gt;SIGNTOOL.EXE Verify /V SENTINEL.CAB

Verifying: SENTINEL.CAB
SHA1 hash of file: (not calculated)
Signing Certificate Chain:
    Issued to: WEB.DE TrustCenter
    Issued by: WEB.DE TrustCenter
    Expires:   30.08.2024 09:49:34
    SHA1 hash: C8301016951187E6320569B3ED54F34845B51638

        Issued to: WEB.DE TrustCenter E-Mail Certification Authority
        Issued by: WEB.DE TrustCenter
        Expires:   30.08.2024 09:50:51
        SHA1 hash: 8946380C6E370988FB587257A9F9A5CD323045F0

            Issued to: Stefan Kanthak
            Issued by: WEB.DE TrustCenter E-Mail Certification Authority
            Expires:   14.09.2017 15:14:26
            SHA1 hash: 4779B528F084E6CEF8777B62DCC4B31FFEDE0714

The signature is timestamped: 07.07.2017 14:35:26
Timestamp Verified by:
    Issued to: Thawte Timestamping CA
    Issued by: Thawte Timestamping CA
    Expires:   01.01.2021 01:59:59
    SHA1 hash: BE36A4562FB2EE05DBB3D32323ADF445084ED656

        Issued to: Symantec Time Stamping Services CA - G2
        Issued by: Thawte Timestamping CA
        Expires:   31.12.2020 01:59:59
        SHA1 hash: 6C07453FFDDA08B83707C09B82FB3D15F35336B1

            Issued to: Symantec Time Stamping Services Signer - G4
            Issued by: Symantec Time Stamping Services CA - G2
            Expires:   30.12.2020 01:59:59
            SHA1 hash: 65439929B67973EB192D6FF243E6767ADF0834E4

Successfully verified: SENTINEL.CAB

Number of files successfully Verified: 1
Number of warnings: 0
Number of errors: 0

X:\&gt;</SAMP></PRE>
            Run the command line
        <PRE><KBD TITLE="Console Input">&quot;%SystemRoot%\System32\Expand.exe&quot; SENTINEL.CAB /F:* &quot;&lsaquo;target directory&rsaquo;&quot;</KBD></PRE>
            on <CITE>Windows Vista</CITE> and newer versions of
            <CITE>Windows NT</CITE> to extract all files into the specified
            directory, preserving their paths.
        <P> <STRONG>Note:</STRONG>
            <CODE TITLE="LZ Expansion Utility">Expand.exe</CODE> from prior
            versions of <CITE>Windows NT</CITE> ignore the paths and junk them;
            use <CODE TITLE="Cabinet Extraction Tool">Extract.exe</CODE> from
            the <CITE>Support Tools</CITE> on <CITE>Windows XP</CITE> and
            <CITE>Windows Server 2003</CITE> instead!
        <P> <STRONG>Note:</STRONG> switch to <Q>Details</Q> view and turn on the
            <Q>Path</Q> column when you open <CODE>SENTINEL.CAB</CODE> in
            <CITE TITLE="Explorer.exe">Windows Explorer</CITE>!
        <H3 ID="makefile">Makefile and Build Instructions</H3>
            Optionally perform the following 3 simple steps to build
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            from their sources and sign them with your own
            <A HREF="https://msdn.microsoft.com/en-us/library/bb540819.aspx" TITLE="X.509 Public Key Certificates"><CITE>X.509</CITE></A>
            certificate.
        <OL>
        <LI>
        <P> Download the <Q>makefile</Q>
            <A HREF="download/SENTINEL.MAK" TYPE="text/plain"><CODE>SENTINEL.MAK</CODE></A>
            and save it in an arbitrary, preferable empty directory.
        </LI>
        <LI>
        <P> Download the <Q>icon</Q>
            <A HREF="download/SENTINEL.ICO" TYPE="image/vnd.microsoft.icon"><CODE>SENTINEL.ICO</CODE></A>
            and save it in the directory used in step&nbsp;1.
        </LI>
        <LI>
        <P> Run the following command line to build both
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>:
        <PRE><KBD TITLE="Console Input">NMAKE.EXE /R /F SENTINEL.MAK</KBD></PRE>
            <STRONG>Note:</STRONG> if necessary, see the
            <ACRONYM TITLE="Microsoft Developer Network">MSDN</ACRONYM> article
            <A HREF="https://msdn.microsoft.com/en-us/library/f35ctcxw.aspx" TITLE="Use the Microsoft C++ toolset from the command line"><Q>Use the Microsoft C++ toolset from the command line</Q></A>
            for an introduction.
        </LI>
        </OL>
            <STRONG>Note:</STRONG> translations of the
            <CODE>MESSAGETABLE</CODE> and <CODE>STRINGTABLE</CODE> resources
            into other languages are welcome!
        <H3 ID="demonstration">Demonstration</H3>
            Perform the following 11 (plus 1 optional) steps to experience the
            full capability of the <EM>Vulnerability and Exploit Detector</EM>:
        <OL>
        <LI>
        <P> Download the <Q>makefile</Q>
            <A HREF="download/SENTINEL.MAK" TYPE="text/plain"><CODE>SENTINEL.MAK</CODE></A>
            and the <Q>icon</Q>
            <A HREF="download/SENTINEL.ICO" TYPE="image/vnd.microsoft.icon"><CODE>SENTINEL.ICO</CODE></A>
            into your <Q>Temp</Q> directory <CODE>%TMP%\</CODE>:
        <PRE><KBD TITLE="Console Input">BITSADMIN.EXE /TRANSFER Sentinel /DOWNLOAD /PRIORITY FOREGROUND http://skanthak.homepage.t-online.de/download/SENTINEL.MAK &quot;%TMP%\SENTINEL.MAK&quot; http://skanthak.homepage.t-online.de/download/SENTINEL.ICO &quot;%TMP%\SENTINEL.ICO&quot;</KBD></PRE>
        </LI>
        <LI>
        <P> Create a new directory with an arbitrary name, for example
            <CODE>SystemRoot\</CODE>, in the root directory of the
            <CITE>Windows</CITE> drive:
        <PRE><KBD TITLE="Console Input">MKDIR &quot;%SystemDrive%\SystemRoot&quot;</KBD></PRE>
        </LI>
        <LI>
        <P> Create the subdirectory
            <CODE>%SystemDrive%\SystemRoot\System32\</CODE> in the empty
            directory created in step&nbsp;2., then copy the <Q>makefile</Q>
            <CODE>SENTINEL.MAK</CODE> and the <Q>icon</Q>
            <CODE>SENTINEL.ICO</CODE> downloaded in step&nbsp;1. into the new
            subdirectory:
        <PRE><KBD TITLE="Console Input">MKDIR &quot;%SystemDrive%\SystemRoot\System32&quot;
COPY &quot;%TMP%\SENTINEL.MAK&quot; &quot;%SystemDrive%\SystemRoot\System32&quot;
COPY &quot;%TMP%\SENTINEL.ICO&quot; &quot;%SystemDrive%\SystemRoot\System32&quot;</KBD></PRE>
        <PRE><SAMP TITLE="Console Output">        1 file(s) copied.
        1 file(s) copied.</SAMP></PRE>
        </LI>
        <LI>
        <P> Start the 32-bit build environment for 32-bit targets in the
            subdirectory <CODE>%SystemDrive%\SystemRoot\System32\</CODE> created
            in step&nbsp;3., then build a <Q>minefield</Q> of 32-bit forwarder
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s in this
            subdirectory and clean up:
        <PRE><KBD TITLE="Console Input">NMAKE.EXE /R /F SENTINEL.MAK all clean
ERASE SENTINEL.MAK SENTINEL.ICO</KBD></PRE>
        <PRE><SAMP TITLE="Console Output">Microsoft (R) Program Maintenance Utility Version 14.25.28614.0
Copyright (C) Microsoft Corporation.  All rights reserved.

	MC.EXE /b /c /n /u /v /z SENTINEL /U nm54B1.tmp
MC: Compiling nm54B1.tmp
nm54B1.tmp(3) : warning : Redefining value of English
Writing .\SENTINEL_ENU.bin
    [a0000001 .. a0000004] - 2900 bytes
    Total of 4 messages, 2916 bytes
Writing .\SENTINEL_GER.bin
    [a0000001 .. a0000004] - 3216 bytes
    Total of 4 messages, 3232 bytes
	RC.EXE /DUNICODE /FoSENTINEL_DLL.RES /L 0 /N /R /V nm54B4.tmp
Microsoft (R) Windows (R) Resource Compiler Version 10.0.10011.16384
Copyright (C) Microsoft Corporation.  All rights reserved.

Using codepage 1252 as default
Creating SENTINEL_DLL.RES

nm54B4.tmp.
Writing MESSAGETABLE:1, lang:0x9,       size 2916.
Writing MESSAGETABLE:1, lang:0x7,       size 3232...
Writing ICON:1, lang:0x0,       size 9640
Writing ICON:2, lang:0x0,       size 4264
Writing ICON:3, lang:0x0,       size 1128
Writing GROUP_ICON:1,   lang:0x0,       size 48.
Writing 24:1,   lang:0x0,       size 959.
Writing VERSION:1,      lang:0x0,       size 2288
Writing STRING:1,       lang:0x7,       size 470
Writing STRING:1,       lang:0x9,       size 376
	CVTRES.EXE /BREPRO /NOLOGO /OUT:SENTINEL_DLL.CVT /READONLY SENTINEL_DLL.RES
CVTRES : warning CVT4001: machine type not specified; assumed X86
	CL.EXE /Brepro /c /DCALLER /DEVENTLOG /DGSCOOKIE /DSOUND /DTHREAD /DUSERICON /FoSENTINEL_DLL.OBJ /GA /GF /GS /Gw /Gy /nologo /O1 /Os /Oy- /Tcnm5551.tmp /W4 /wd4090 /wd4100 /wd4201 /we4013 /Zl
nm5551.tmp
	CL.EXE /Brepro /c /FoSENTINEL.OBJ /GA /GF /GS /Gw /Gy /nologo /O1 /Os /Oy- /Tcnm560E.tmp /W4 /wd4047 /we4013 /Zl
nm560E.tmp
nm560E.tmp(52): warning C4142: '__security_cookie': benign redefinition of type
C:\Program Files\Microsoft Visual Studio\2019\Community\VC\Tools\MSVC\14.25.28610\include\vcruntime.h(349): note: see declaration of '__security_cookie'
nm560E.tmp(214): warning C4028: formal parameter 1 different from declaration
	CERTUTIL.EXE /DecodeHex /F /V nm568C.tmp SENTINEL.DOS
Input Length = 730
Output Length = 160
CertUtil: -decodehex command completed successfully.
	LINK.EXE /LINK /ALLOWBIND:NO /BREPRO /DEF:nm568D.tmp /DLL /DYNAMICBASE /ENTRY:_DllMainCRTStartup /LARGEADDRESSAWARE /NOCOFFGRPINFO /NODEFAULTLIB /NOLOGO /NXCOMPAT /OPT:REF /OSVERSION:5.1 /OUT:SENTINEL.DLL /RELEASE /STUB:SENTINEL.DOS /SUBSYSTEM:WINDOWS /SWAPRUN:CD,NET /TEST /VERSION:1.0 SENTINEL.OBJ SENTINEL_DLL.OBJ SENTINEL_DLL.CVT ADVAPI32.LIB KERNEL32.LIB USER32.LIB
LINK : file alignment: 512, section alignment: 4096
LINK : section '.xdata' (40000040) merged into '.rdata' (40000040)
LINK : section '.gfids' (40000040) merged into '.rdata' (40000040)
LINK : section '.giats' (40000040) merged into '.rdata' (40000040)
LINK : section '.gljmp' (40000040) merged into '.rdata' (40000040)
LINK : section '.gehcont' (40000040) merged into '.rdata' (40000040)
LINK : section '.gids' (40000040) merged into '.rdata' (40000040)
Total (unused) space reserved for emitting COFF contribution: 236 (0) bytes
	RC.EXE /DUNICODE /FoSENTINEL_EXE.RES /L 0 /N /R /V nm631B.tmp
Microsoft (R) Windows (R) Resource Compiler Version 10.0.10011.16384
Copyright (C) Microsoft Corporation.  All rights reserved.

Using codepage 1252 as default
Creating SENTINEL_EXE.RES

nm631B.tmp.
Writing MESSAGETABLE:1, lang:0x9,       size 2916.
Writing MESSAGETABLE:1, lang:0x7,       size 3232...
Writing ICON:1, lang:0x0,       size 9640
Writing ICON:2, lang:0x0,       size 4264
Writing ICON:3, lang:0x0,       size 1128
Writing GROUP_ICON:1,   lang:0x0,       size 48.
Writing 24:1,   lang:0x0,       size 1335.
Writing VERSION:1,      lang:0x0,       size 2304
Writing STRING:1,       lang:0x7,       size 282
Writing STRING:1,       lang:0x9,       size 240
	CVTRES.EXE /BREPRO /NOLOGO /OUT:SENTINEL_EXE.CVT /READONLY SENTINEL_EXE.RES
CVTRES : warning CVT4001: machine type not specified; assumed X86
	CL.EXE /Brepro /c /DCALLER /DEVENTLOG /DGSCOOKIE /DPARENT /DPRIVILEGE /DSOUND /DUSERICON /FoSENTINEL_EXE.OBJ /GA /GF /GS /Gw /Gy /nologo /O1 /Os /Oy- /Tcnm63D8.tmp /W4 /wd4090 /wd4100 /wd4201 /we4013 /Zl
nm63D8.tmp
	LINK.EXE /LINK /BREPRO /DYNAMICBASE /ENTRY:wWinMainCRTStartup /FIXED:NO /LARGEADDRESSAWARE /NOCOFFGRPINFO /NODEFAULTLIB /NOLOGO /NXCOMPAT /OPT:REF /OSVERSION:5.1 /OUT:SENTINEL.EXE /RELEASE /STUB:SENTINEL.DOS /SUBSYSTEM:WINDOWS /SWAPRUN:CD,NET /TEST /VERSION:1.0 SENTINEL.OBJ SENTINEL_EXE.OBJ SENTINEL_EXE.CVT ADVAPI32.LIB KERNEL32.LIB USER32.LIB
LINK : file alignment: 512, section alignment: 4096
LINK : section '.xdata' (40000040) merged into '.rdata' (40000040)
LINK : section '.gfids' (40000040) merged into '.rdata' (40000040)
LINK : section '.giats' (40000040) merged into '.rdata' (40000040)
LINK : section '.gljmp' (40000040) merged into '.rdata' (40000040)
LINK : section '.gehcont' (40000040) merged into '.rdata' (40000040)
LINK : section '.gids' (40000040) merged into '.rdata' (40000040)
Total (unused) space reserved for emitting COFF contribution: 236 (0) bytes
	Call SENTINEL.CMD
accessibilitycpl
&hellip;
wmiutils
	Erase SENTINEL.OBJ SENTINEL.LIB SENTINEL.EXP
	Erase SENTINEL.DOS
	Erase SENTINEL_EXE.OBJ SENTINEL_DLL.OBJ
	Erase SENTINEL_EXE.CVT SENTINEL_DLL.CVT
	Erase SENTINEL_EXE.RES SENTINEL_DLL.RES
	Erase SENTINEL.RC SENTINEL.H SENTINEL_???.BIN</SAMP></PRE>
        </LI>
        <LI CLASS="hidden">
        <P> Optionally on a 32-bit installation, create hardlinks to the 32-bit
            <CODE>%SystemDrive%\SystemRoot\System32\SENTINEL.EXE</CODE> built
            in step&nbsp;4. in the subdirectory
            <CODE>%SystemDrive%\SystemRoot\System32\</CODE> for all programs
            <CODE>%SystemRoot%\System32\*.com</CODE> and
            <CODE>%SystemRoot%\System32\*.exe</CODE>, and in the directory
            <CODE>%SystemDrive%\SystemRoot\</CODE> for all programs
            <CODE>%SystemRoot%\*.exe</CODE>:
        <PRE><KBD TITLE="Console Input">FOR %? IN (&quot;%SystemRoot%\System32\*.com&quot; &quot;%SystemRoot%\System32\*.exe&quot;) DO @MKLINK /H &quot;%SystemDrive%\SystemRoot\System32\%~nx?&quot; &quot;%SystemDrive%\SystemRoot\System32\SENTINEL.EXE&quot;
FOR %? IN (&quot;%SystemRoot%\*.exe&quot;) DO @MKLINK /H &quot;%SystemDrive%\SystemRoot\%~nx?&quot; &quot;%SystemDrive%\SystemRoot\System32\SENTINEL.EXE&quot;</KBD></PRE>
        <PRE><SAMP TITLE="Console Output">Hardlink created for C:\SystemRoot\System32\&hellip;.com &lt;&lt;===&gt;&gt; C:\SystemRoot\System32\SENTINEL.EXE
&hellip;
Hardlink created for C:\SystemRoot\System32\&hellip;.exe &lt;&lt;===&gt;&gt; C:\SystemRoot\System32\SENTINEL.EXE
Hardlink created for C:\SystemRoot\&hellip;.exe &lt;&lt;===&gt;&gt; C:\SystemRoot\System32\SENTINEL.EXE
&hellip;
Hardlink created for C:\SystemRoot\&hellip;.exe &lt;&lt;===&gt;&gt; C:\SystemRoot\System32\SENTINEL.EXE</SAMP></PRE>
        </LI>
        <LI>
        <P> On a 64-bit installation, rename the subdirectory
            <CODE>%SystemDrive%\SystemRoot\System32\</CODE> created in
            step&nbsp;3. to <CODE>%SystemDrive%\SystemRoot\SysWoW64\</CODE>,
            then create the subdirectory
            <CODE>%SystemDrive%\SystemRoot\System32\</CODE> and copy the
            <Q>makefile</Q> <CODE>SENTINEL.MAK</CODE> plus the <Q>icon</Q>
            <CODE>SENTINEL.ICO</CODE> downloaded in step&nbsp;1. into the new
            subdirectory:
        <PRE><KBD TITLE="Console Input">MOVE &quot;%SystemDrive%\SystemRoot\System32&quot; SysWoW64
MKDIR &quot;%SystemDrive%\SystemRoot\System32&quot;
COPY &quot;%TMP%\SENTINEL.MAK&quot; &quot;%SystemDrive%\SystemRoot\System32&quot;
COPY &quot;%TMP%\SENTINEL.ICO&quot; &quot;%SystemDrive%\SystemRoot\System32&quot;</KBD></PRE>
        <PRE><SAMP TITLE="Console Output">        1 file(s) copied.
        1 file(s) copied.</SAMP></PRE>
        </LI>
        <LI>
        <P> On a 64-bit installation, start the 64-bit build environment for
            64-bit targets in the subdirectory
            <CODE>%SystemDrive%\SystemRoot\System32\</CODE> created in
            step&nbsp;5., then build a <Q>minefield</Q> of 64-bit forwarder
            <ACRONYM TITLE="Dynamic-Link Library">DLL</ACRONYM>s in this
            subdirectory and clean up:
        <PRE><KBD TITLE="Console Input">NMAKE.EXE /R /F SENTINEL.MAK all clean
ERASE SENTINEL.MAK SENTINEL.ICO</KBD></PRE>
        </LI>
        <LI CLASS="hidden">
        <P> Optionally on a 64-bit installation, create hardlinks to the 32-bit
            <CODE>%SystemDrive%\SystemRoot\SysWoW64\SENTINEL.EXE</CODE> built
            in step&nbsp;4. in the subdirectory
            <CODE>%SystemDrive%\SystemRoot\SysWoW64\</CODE> for all programs
            <CODE>%SystemRoot%\SysWoW64\*.com</CODE> and
            <CODE>%SystemRoot%\SysWoW64\*.exe</CODE>, then create hardlinks
            to the 64-bit
            <CODE>%SystemDrive%\SystemRoot\System32\SENTINEL.EXE</CODE> built
            in step&nbsp;7. in the subdirectory
            <CODE>%SystemDrive%\SystemRoot\System32\</CODE> for all programs
            <CODE>%SystemRoot%\System32\*.com</CODE> and
            <CODE>%SystemRoot%\System32\*.exe</CODE>, and in the directory
            <CODE>%SystemDrive%\SystemRoot\</CODE> for all programs
            <CODE>%SystemRoot%\*.exe</CODE>:
        <PRE><KBD TITLE="Console Input">FOR %? IN (&quot;%SystemRoot%\SysWoW64\*.com&quot; &quot;%SystemRoot%\SysWoW64\*.exe&quot;) DO @MKLINK /H &quot;%SystemDrive%\SystemRoot\SysWoW64\%~nx?&quot; &quot;%SystemDrive%\SystemRoot\SysWoW64\SENTINEL.EXE&quot;
FOR %? IN (&quot;%SystemRoot%\System32\*.com&quot; &quot;%SystemRoot%\System32\*.exe&quot;) DO @MKLINK /H &quot;%SystemDrive%\SystemRoot\System32\%~nx?&quot; &quot;%SystemDrive%\SystemRoot\System32\SENTINEL.EXE&quot;
FOR %? IN (&quot;%SystemRoot%\*.exe&quot;) DO @MKLINK /H &quot;%SystemDrive%\SystemRoot\%~nx?&quot; &quot;%SystemDrive%\SystemRoot\System32\SENTINEL.EXE&quot;</KBD></PRE>
        <PRE><SAMP TITLE="Console Output">Hardlink created for C:\SystemRoot\SysWoW64\&hellip;.com &lt;&lt;===&gt;&gt; C:\SystemRoot\SysWoW64\SENTINEL.EXE
&hellip;
Hardlink created for C:\SystemRoot\SysWoW64\&hellip;.exe &lt;&lt;===&gt;&gt; C:\SystemRoot\SysWoW64\SENTINEL.EXE
Hardlink created for C:\SystemRoot\System32\&hellip;.com &lt;&lt;===&gt;&gt; C:\SystemRoot\System32\SENTINEL.EXE
&hellip;
Hardlink created for C:\SystemRoot\System32\&hellip;.exe &lt;&lt;===&gt;&gt; C:\SystemRoot\System32\SENTINEL.EXE
Hardlink created for C:\SystemRoot\&hellip;.exe &lt;&lt;===&gt;&gt; C:\SystemRoot\System32\SENTINEL.EXE
&hellip;
Hardlink created for C:\SystemRoot\&hellip;.exe &lt;&lt;===&gt;&gt; C:\SystemRoot\System32\SENTINEL.EXE</SAMP></PRE>
        </LI>
        <LI>
        <P> Copy all programs <CODE>%SystemRoot%\*.exe</CODE> into the
            subdirectory <CODE>%SystemDrive%\SystemRoot\System32\</CODE>:
        <PRE><KBD TITLE="Console Input">COPY &quot;%SystemRoot%\*.exe&quot; &quot;%SystemDrive%\SystemRoot\System32&quot;</KBD></PRE>
        <PRE><SAMP TITLE="Console Output">       13 file(s) copied.</SAMP></PRE>
        </LI>
        <LI>
        <P> On a 64-bit installation, <DEL>create hardlinks of</DEL>
            <INS>copy</INS> all files <CODE>%SystemRoot%\SysWoW64\*</CODE> which
            are missing in the subdirectory
            <CODE>%SystemDrive%\SystemRoot\SysWoW64\</CODE>, and create
            junctions to all subdirectories <CODE>%SystemRoot%\SysWoW64\*</CODE>
            in the subdirectory <CODE>%SystemDrive%\SystemRoot\SysWoW64\</CODE>:
        <PRE><KBD TITLE="Console Input">FOR %? IN (&quot;%SystemRoot%\SysWoW64\*&quot;) DO @IF NOT EXIST &quot;%SystemDrive%\SystemRoot\SysWoW64\%~nx?&quot; MKLINK /H &quot;%SystemDrive%\SystemRoot\SysWoW64\%~nx?&quot; &quot;%~?&quot; 2&gt;NUL: || COPY &quot;%~?&quot; &quot;%SystemDrive%\SystemRoot\SysWoW64\%~nx?&quot;
FOR /D %? IN (&quot;%SystemRoot%\SysWoW64\*&quot;) DO @MKLINK /J &quot;%SystemDrive%\SystemRoot\SysWoW64\%~nx?&quot; &quot;%~?&quot;</KBD></PRE>
        <PRE><SAMP TITLE="Console Output">        1 file(s) copied.
&hellip;
        1 file(s) copied.
Junction created for C:\SystemRoot\SysWoW64\&hellip; &lt;&lt;===&gt;&gt; C:\Windows\SysWoW64\&hellip;
&hellip;
Junction created for C:\SystemRoot\SysWoW64\&hellip; &lt;&lt;===&gt;&gt; C:\Windows\SysWoW64\&hellip;</SAMP></PRE>
        </LI>
        <LI>
        <P> <DEL>Create hardlinks of</DEL> <INS>Copy</INS> all files
            <CODE>%SystemRoot%\System32\*</CODE> which are missing in the
            subdirectory <CODE>%SystemDrive%\SystemRoot\System32\</CODE>, and
            create junctions to all subdirectories
            <CODE>%SystemRoot%\System32\*</CODE> in the subdirectory
            <CODE>%SystemDrive%\SystemRoot\System32\</CODE>:
        <PRE><KBD TITLE="Console Input">FOR %? IN (&quot;%SystemRoot%\System32\*&quot;) DO @IF NOT EXIST &quot;%SystemDrive%\SystemRoot\System32\%~nx?&quot; MKLINK /H &quot;%SystemDrive%\SystemRoot\System32\%~nx?&quot; &quot;%~?&quot; 2&gt;NUL: || COPY &quot;%~?&quot; &quot;%SystemDrive%\SystemRoot\System32\%~nx?&quot;
FOR /D %? IN (&quot;%SystemRoot%\System32\*&quot;) DO @MKLINK /J &quot;%SystemDrive%\SystemRoot\System32\%~nx?&quot; &quot;%~?&quot;</KBD></PRE>
        <PRE><SAMP TITLE="Console Output">        1 file(s) copied.
&hellip;
        1 file(s) copied.
Junction created for C:\SystemRoot\System32\&hellip; &lt;&lt;===&gt;&gt; C:\Windows\System32\&hellip;
&hellip;Junction created for C:\SystemRoot\System32\&hellip; &lt;&lt;===&gt;&gt; C:\Windows\System32\&hellip;</SAMP></PRE>
        </LI>
        <LI>
        <P> <DEL>Create hardlinks of</DEL> <INS>Copy</INS> all files
            <CODE>%SystemRoot%\*</CODE> which are missing in the directory
            <CODE>%SystemDrive%\SystemRoot\</CODE>, and create junctions to all
            subdirectories <CODE>%SystemRoot%\*</CODE> which are missing in the
            directory <CODE>%SystemDrive%\SystemRoot\</CODE>:
        <PRE><KBD TITLE="Console Input">FOR %? IN (&quot;%SystemRoot%\*&quot;) DO @IF NOT EXIST &quot;%SystemDrive%\SystemRoot\%~nx?&quot; MKLINK /H &quot;%SystemDrive%\SystemRoot\%~nx?&quot; &quot;%~?&quot; 2&gt;NUL: || COPY &quot;%~?&quot; &quot;%SystemDrive%\SystemRoot\%~nx?&quot;
FOR /D %? IN (&quot;%SystemRoot%\*&quot;) DO @IF NOT EXIST &quot;%SystemDrive%\SystemRoot\%~nx?&quot; MKLINK /J &quot;%SystemDrive%\SystemRoot\%~nx?&quot; &quot;%~?&quot;</KBD></PRE>
        <PRE><SAMP TITLE="Console Output">        1 file(s) copied.
&hellip;
        1 file(s) copied.
Junction created for C:\SystemRoot\&hellip; &lt;&lt;===&gt;&gt; C:\Windows\&hellip;
&hellip;
Junction created for C:\SystemRoot\&hellip; &lt;&lt;===&gt;&gt; C:\Windows\&hellip;</SAMP></PRE>
        </LI>
        <LI>
        <P> Start arbitrary programs, especially those copied from the
            subdirectories <CODE>%SystemRoot%\System32\</CODE> and
            <CODE>%SystemRoot%\SysWoW64\</CODE> plus the directory
            <CODE>%SystemRoot%\</CODE> into the subdirectories
            <CODE>%SystemDrive%\SystemRoot\System32\</CODE> and
            <CODE>%SystemDrive%\SystemRoot\SysWoW64\</CODE> plus the directory
            <CODE>%SystemDrive%\SystemRoot\</CODE>, those registered in the
            <Q>Start Menu</Q> and those which request elevation, perform
            arbitrary actions like &hellip;, and notice which programs or
            actions yield the message box shown above!
        </LI>
        <LI>
        <P> Optionally set the user environment variable
            <CODE>SystemRoot</CODE> to the value
            <CODE>%SystemDrive%\SystemRoot</CODE> and repeat the previous
            step&nbsp;11.:
        <PRE><KBD TITLE="Console Input">&quot;%SystemRoot%\System32\SetX.exe&quot; SystemRoot &quot;%SystemDrive%\SystemRoot&quot;</KBD></PRE>
        </LI>
        </OL>
        <H3 ID="installation">Installation</H3>
            Installation requires administrative privileges and access rights.
        <P> The setup script
            <A HREF="download/SENTINEL.INF" TYPE="application/x-setupscript"><CODE>SENTINEL.INF</CODE></A>
            copies
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            as <CODE>%SystemRoot%\System32\.dll</CODE>
            and <CODE>%SystemRoot%\System32\.exe</CODE>,
            as <CODE>%SystemDrive%\Program.dll</CODE>
            and <CODE>%SystemDrive%\Program.exe</CODE>,
            as <CODE>&quot;%ProgramFiles%\Common.dll&quot;</CODE>
            and <CODE>&quot;%ProgramFiles%\Common.exe&quot;</CODE>,
            as <CODE>&quot;%ProgramFiles%\Internet.dll&quot;</CODE>
            and <CODE>&quot;%ProgramFiles%\Internet.exe&quot;</CODE>,
            as <CODE>&quot;%ProgramFiles%\Microsoft.dll&quot;</CODE>
            and <CODE>&quot;%ProgramFiles%\Microsoft.exe&quot;</CODE>,
            as <CODE>&quot;%ProgramFiles%\Windows.dll&quot;</CODE>
            and <CODE>&quot;%ProgramFiles%\Windows.exe&quot;</CODE>,
            as <CODE>&quot;%CommonProgramFiles%\Microsoft.dll&quot;</CODE>
            and <CODE>&quot;%CommonProgramFiles%\Microsoft.exe&quot;</CODE>,
            with various filenames into the user&rsquo;s <Q>Downloads</Q>
            directory <CODE>&quot;%USERPROFILE%\Downloads\&quot;</CODE> and the
            system&rsquo;s <Q>Temp</Q> directory
            <CODE>%SystemRoot%\Temp\</CODE>, creates
            <A HREF="https://support.microsoft.com/en-us/kb/310791" TITLE="Description of the Software Restriction Policies in Windows XP"><CITE>Software Restriction Policies</CITE></A>
            alias
            <A HREF="https://support.microsoft.com/en-us/kb/324036" TITLE="How To use Software Restriction Policies in Windows Server 2003"><CITE>SAFER</CITE></A>
            hash rules to allow execution of both
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            from any path, defines the message source for the
            <CITE>Event Log</CITE> in the <CITE>Registry</CITE>, creates an
            entry <Q>Vulnerability and Exploit Detector</Q> under
            <CITE>Installed Updates</CITE>, and finally executes both
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            from the installation directory to demonstrate and verify their
            proper function.
        <P> <STRONG>Note:</STRONG> on systems with <CITE>AMD64</CITE> alias
            <CITE>x64</CITE> processor architecture, the installation
            <STRONG>must</STRONG> be run in the native (64-bit) execution
            environment to install
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            for both processor architectures!
        <P CLASS="hidden">
            <A HREF="download/SENTINEL.CMD" TYPE="text/plain"><CODE>SENTINEL.CMD</CODE></A>
            copies both
            <CODE TITLE="Vulnerability and Exploit Detector Module">SENTINEL.DLL</CODE>
            and
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            as <CODE>%SystemDrive%\Program.dll</CODE> and
            <CODE>%SystemDrive%\Program.exe</CODE>, optionally creates the
            hardlinks <CODE>%SystemDrive%\Documents.dll</CODE> and
            <CODE>%SystemDrive%\Documents.exe</CODE> to the copied files if
            <CODE>&quot;%SystemDrive%\Documents and Settings&quot;\</CODE>
            exists, creates hardlinks aside to some or all subdirectories which
            contain a space in their name beneath the directories
            <CODE>%SystemRoot%\</CODE>,
            <CODE>&quot;%ProgramFiles%\&quot;</CODE> and (if it exists)
            <CODE>&quot;%ProgramFiles(x86)%\&quot;</CODE> as well as
            <CODE>&quot;%USERPROFILE%\&quot;</CODE>, and imports
            <A HREF="download/SENTINEL.REG" TYPE="text/plain"><CODE>SENTINEL.REG</CODE></A>
            into the <CITE>Registry</CITE>.
        <H4>Automatic online installation</H4>
            When visited with
            <CITE TITLE="IExplore.exe">Internet Explorer</CITE>, this web page
            will prompt to install (the contents of) the package using
            <A HREF="https://msdn.microsoft.com/en-us/library/aa768009.aspx" TITLE="Introduction to Internet Component Download"><CITE>Internet Component Download</CITE></A>.
        <P> <STRONG>Note:</STRONG> on systems with <CITE>AMD64</CITE> alias
            <CITE>x64</CITE> processor architecture,
            <CITE TITLE="IExplore.exe">Internet Explorer (x64)</CITE>
            <STRONG>must</STRONG> be used!
        <H4>Manual offline installation</H4>
            Download the package
            <A HREF="download/SENTINEL.CAB" TYPE="application/vnd.ms-cab-compressed"><CODE>SENTINEL.CAB</CODE></A>
            and verify its digital signature, then open it in
            <CITE TITLE="Explorer.exe">Windows Explorer</CITE>, extract its
            contents preserving the directory structure, right-click the
            extracted setup script
            <A HREF="download/SENTINEL.INF" TYPE="application/x-setupscript"><CODE>SENTINEL.INF</CODE></A>
            to display its context menu and click <Q>Install</Q> to run the
            installation.
        <BR><STRONG>Note:</STRONG>
            <CODE TITLE="Vulnerability and Exploit Detector Application">SENTINEL.EXE</CODE>
            is run during installation for every processor architecture and
            displays the message box shown on top!
        <H3 ID="update">Update</H3>
            The setup script supports the update from any previous version:
            just install the current version!
        <H3 ID="deinstallation">Deinstallation</H3>
            Not provided.
    <!--    Deinstallation requires administrative privileges and access rights.
        <P> On <CITE>Windows XP</CITE> and <CITE>Windows Server 2003</CITE>,
            open the <CITE>Add/Remove Programs</CITE> applet of the
            <A HREF="https://support.microsoft.com/en-us/kb/313808" TITLE="Description of Control Panel Files in Windows XP"><CITE>Control Panel</CITE></A>,
            tick the checkbox <Q>Updates</Q>, select the entry
            <Q>Vulnerability and Exploit Detector</Q> underneath
            <Q LANG="de">Systemkonfiguration</Q> and click the
            <SPAN CLASS="button">Remove</SPAN> button.
        <P> On <CITE>Windows Vista</CITE> and newer versions of
            <CITE>Windows NT</CITE>, open the <CITE>Control Panel</CITE> and
            click the entry <CITE>View installed updates</CITE> underneath the
            <CITE>Programs and Features</CITE> or <CITE>Programs</CITE>
            category.
        <BR>In <CITE>Installed Updates</CITE> select the entry
            <Q>Vulnerability and Exploit Detector</Q> underneath
            <Q LANG="de">Systemkonfiguration</Q> and click the <Q>Uninstall</Q>
            menu entry.
     -->
        <H2>Contact</H2>
            If you miss anything here, have additions, comments, corrections,
            criticism or questions, want to give feedback, hints or tipps,
            report broken links, bugs, deficiencies, errors, inaccuracies,
            misrepresentations, omissions, shortcomings, vulnerabilities or
            weaknesses, &hellip;: don&rsquo;t hesitate to
            <A HREF="mailto:?Subject=eSKamation%20homepage&amp;To=Stefan%20Kanthak%20%3Cstefan%2Ekanthak%40nexgo%2Ede%3E"><STRONG>contact me</STRONG></A>
            and feel free to ask, comment, criticise, flame, notify or report!
        <P> Use the <CITE>X.509</CITE>
            <A HREF="download/KANTHAK.CER" TITLE="CN = Stefan Kanthak&#13;&#10;G = Stefan&#13;&#10;SN = Kanthak&#13;&#10;T = System Administrator&#13;&#10;OU = Software Engineering&#13;&#10;O = eSKamation Information Technology&#13;&#10;L = M&uuml;nchen&#13;&#10;S = Bayern&#13;&#10;C = DE&#13;&#10;E = stefan&zwj;.&zwj;kanthak&zwj;@&zwj;nexgo&zwj;.&zwj;de" TYPE="application/pkix-cert">certificate</A>
            to send
            <ACRONYM TITLE="Secure/Multipurpose Internet Mail Extensions">S/MIME</ACRONYM>
            encrypted mail.
        <P> <STRONG>Note:</STRONG> email in weird format and without a proper
            sender name is likely to be discarded!
        <P> I dislike
            <ACRONYM TITLE="HyperText Markup Language">HTML</ACRONYM> (and even
            weirder formats too) in email, I prefer to receive plain text.
        <BR>I also expect to see your full (real) name as sender, not your
            nickname.
        <BR>I abhor top posts and expect inline quotes in replies.
        <H2>Terms and Conditions</H2>
            By using this site, you signify your agreement to these terms and
            conditions. If you do not agree to these terms and conditions, do
            not use this site!
        <UL>
        <LI>The software and the documentation on this site are provided
            <Q>as&nbsp;is</Q> without any warranty, neither express nor implied.
        <BR>In no event will the author be held liable for any damage(s) arising
            from the use of the software or the documentation.
        </LI>
        <LI>Permission is granted to use the <STRONG>current</STRONG> version of
            the software and the <STRONG>current</STRONG> version of the
            documentation solely for personal private and non-commercial
            purposes.
        <BR>An individuals use of the software or the documentation in his or
            her capacity or function as an agent, (independent) contractor,
            employee, member or officer of a business, corporation or
            organisation (commercial or non-commercial) does not qualify as
            personal private and non-commercial purpose.
        </LI>
        <LI>Without written approval from the author the software or the
            documentation <STRONG>must not</STRONG> be used for a business, for
            commercial, corporate, governmental, military or organisational
            purposes of any kind, or in a commercial, corporate, governmental,
            military or organisational environment of any kind.
        </LI>
        <LI>Redistribution of the software and the documentation is allowed only
            in unmodified form of its <STRONG>current</STRONG> version and free
            of charge.
        </LI>
        </UL>
        <H2>Data Protection Declaration</H2>
            This web page records no (personal) data and stores no
            <Q>cookies</Q> in the web browser.
        <P> The web service is operated and provided by
        <ADDRESS>
            Telekom Deutschland GmbH
        <BR>Business Center
        <BR>D-64306 Darmstadt
        <BR>Germany
        <BR><A HREF="mailto:?To=hosting%40telekom.de">&lt;&zwj;hosting&zwj;@&zwj;telekom&zwj;.&zwj;de&zwj;&gt;</A>
        <BR><A HREF="tel:++49-800-5252033">+49&nbsp;800&nbsp;5252033</A>
        </ADDRESS>
        <P> The web service provider stores a <Q>session cookie</Q> in the web
            browser and records every visit of this web site with the following
            data in an access log on their server(s):
        <UL>
        <LI>the (pseudonymised)
            <ACRONYM TITLE="Internet Protocol">IP</ACRONYM> address;
        </LI>
        <LI>the date and time of the request;
        </LI>
        <LI>the <ACRONYM TITLE="Uniform Resource Locator">URL</ACRONYM> of
            the requested web page or file;
        </LI>
        <LI>the <CITE>Referer</CITE> and <CITE>User-Agent</CITE>
            <ACRONYM TITLE="HyperText Transfer Protocol">HTTP</ACRONYM>
            headers sent by the web browser;
        </LI>
        <LI>the result (success or failure) of the request;
        </LI>
        <LI>the amount of data received and sent.
        </LI>
        </UL>
        <HR>
        <ADDRESS>
            Copyright &copy; 1995&ndash;2021 &bull; Stefan Kanthak &bull;
            <A HREF="mailto:?Subject=Vulnerability%20and%20Exploit%20Detector&amp;To=Stefan%20Kanthak%20%3Cstefan%2Ekanthak%40nexgo%2Ede%3E">&lt;&zwj;stefan&zwj;.&zwj;kanthak&zwj;@&zwj;nexgo&zwj;.&zwj;de&zwj;&gt;</A>
        </ADDRESS>
    </BODY>
</HTML>
