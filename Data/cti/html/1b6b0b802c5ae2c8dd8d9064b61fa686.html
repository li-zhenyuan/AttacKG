<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>
Process Doppelgänging &#8211; a new way to impersonate a process | hasherezade&#039;s 1001 nights</title>
<link rel="profile" href="https://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="https://s2.wp.com/wp-content/themes/pub/twentyten/style.css?ver=20190507" />
<link rel="pingback" href="https://hshrzd.wordpress.com/xmlrpc.php">
<script type="text/javascript">
  WebFontConfig = {"google":{"families":["Roboto+Slab:r:latin,latin-ext","Karla:r,i,b,bi:latin,latin-ext"]}};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active #site-title{font-family:"Roboto Slab",serif;font-style:normal;font-weight:400}.wf-active #site-title{font-style:normal;font-weight:400}.wf-active #site-title a{font-weight:400;font-style:normal}.wf-active .pingback a.url, .wf-active body{font-family:"Karla",sans-serif}.wf-active #cancel-comment-reply-link, .wf-active #site-info, .wf-active #wp-calendar, .wf-active .comment-body thead th, .wf-active .comment-body tr th, .wf-active .comment-meta, .wf-active .entry-content label, .wf-active .entry-content thead th, .wf-active .entry-content tr th, .wf-active .entry-meta, .wf-active .entry-utility, .wf-active .form-allowed-tags, .wf-active .pingback p, .wf-active .reply, .wf-active .wp-caption-text{font-family:"Karla",sans-serif}.wf-active h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6{font-weight:400;font-family:"Roboto Slab",serif;font-style:normal}.wf-active .page-title span{font-family:"Roboto Slab",serif;font-style:normal;font-weight:400}.wf-active #access .menu, .wf-active #access div.menu ul, .wf-active #respond label, .wf-active .entry-title, .wf-active .navigation, .wf-active .page-title, .wf-active .widget-title, .wf-active h3#comments-title, .wf-active h3#reply-title{font-family:"Roboto Slab",serif;font-style:normal;font-weight:400}.wf-active #access .menu-header, .wf-active div.menu{font-style:normal;font-weight:400}.wf-active .page-title{font-weight:400;font-style:normal}.wf-active .page-title span{font-style:normal;font-weight:400}.wf-active #content .entry-title{font-weight:400;font-style:normal}.wf-active .navigation{font-style:normal;font-weight:400}.wf-active h3#comments-title, .wf-active h3#reply-title{font-weight:400;font-style:normal}.wf-active #respond label{font-style:normal;font-weight:400}.wf-active .widget-title{font-weight:400;font-style:normal}</style>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="hasherezade&#039;s 1001 nights &raquo; Feed" href="https://hshrzd.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="hasherezade&#039;s 1001 nights &raquo; Comments Feed" href="https://hshrzd.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="hasherezade&#039;s 1001 nights &raquo; Process Doppelgänging &#8211; a new way to impersonate a&nbsp;process Comments Feed" href="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1612197847h&ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0-1' href='https://s0.wp.com/_static/??-eJytUV1PwzAM/EOkpmwD7QHxW5LWhGz5UuJQ5d/jpkIqG1R94CXKOXcXnw1TFEPwhJ7AFRFt0cZnmOIQnMjOWKw3qBtyfoDfZdZcMcMFKcrhKhq6o39zdWGoMGl+SQif/WN36o6girEjKBuagUoyVchULf6HEX2g22PUVKsgsoZCQicz7u7lxiJJMl7nP+SrEc4ZuO6ipJnhcDQSLbftaUu2rEipmDBnwaczxYmW934FSxliUUATFypXl0nt5LYUov251ZTGINiVowf/A4h3K03akibkfjRfNTBrBWfRm3vtn/vz8elwejlfvgCAMwnR?cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
</style>
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel='stylesheet' id='all-css-2-1' href='https://s1.wp.com/_static/??-eJxti0EKgCAQAD+ULUaJl+gtJqbG6opr9P3o0CHqNAzMwFmEpdxcbpAOUfDwMTMU4iY2NLECB1Nj9g97y9zB/8Vko0GB5Oktn6kFlxxDGMEjrQbvYEmzVHIclNZy2i9lFDfR?cssminify=yes' type='text/css' media='all' />
<script id='wpcom-actionbar-placeholder-js-extra'>
var actionbardata = {"siteID":"35018075","siteName":"hasherezade's 1001 nights","siteURL":"http:\/\/hshrzd.wordpress.com","icon":"<img alt='' src='https:\/\/secure.gravatar.com\/blavatar\/d90f3e8396fcba0c10c535b639092316?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/twentyten","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fhshrzd.wordpress.com%2F2017%2F12%2F18%2Fprocess-doppelganging-a-new-way-to-impersonate-a-process%2F&signup_flow=account","themeURL":"","xhrURL":"https:\/\/hshrzd.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"a09c78b47f","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"756a76767c\" \/>","referer":"https:\/\/hshrzd.wordpress.com\/2017\/12\/18\/process-doppelganging-a-new-way-to-impersonate-a-process\/","canFollow":"1","feedID":"2657455","statusMessage":"","customizeLink":"https:\/\/hshrzd.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fhshrzd.wordpress.com%2F2017%2F12%2F18%2Fprocess-doppelganging-a-new-way-to-impersonate-a-process%2F","postID":"5074","shortlink":"https:\/\/wp.me\/p2mVNF-1jQ","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/hshrzd.wordpress.com\/5074","statsLink":"https:\/\/wordpress.com\/stats\/post\/5074\/hshrzd.wordpress.com","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Twenty Ten","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 107 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fhshrzd.wordpress.com%2F2017%2F12%2F18%2Fprocess-doppelganging-a-new-way-to-impersonate-a-process%2F&signup_flow=account\">Log in now.<\/a>","stats":"Stats"}};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s2.wp.com/_static/??-eJyFzUEKwkAMheELmQ5DocWFeJZaY8kwyYxJBu3traBQV67e4v/ghUeFuYijeEgWajFnNJsW7JIdwm/lcqGM0Ax1A+JAcitfRzLndkV7w3RvqOtnOib5i4Bp0clxj3fPmh2qlue6tTOf4hDHPvbDeEwvhOVG7A=='></script>
<script type='text/javascript'>
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
</script>
<link rel='stylesheet' id='all-css-0-2' href='https://s0.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1530132353h&cssminify=yes' type='text/css' media='all' />
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s2.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://hshrzd.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/" />
<link rel='shortlink' href='https://wp.me/p2mVNF-1jQ' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fhshrzd.wordpress.com%2F2017%2F12%2F18%2Fprocess-doppelganging-a-new-way-to-impersonate-a-process%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fhshrzd.wordpress.com%2F2017%2F12%2F18%2Fprocess-doppelganging-a-new-way-to-impersonate-a-process%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Process Doppelgänging &#8211; a new way to impersonate a process" />
<meta property="og:url" content="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/" />
<meta property="og:description" content="Recently at Black Hat Europe conference, Tal Liberman and Eugene Kogan form enSilo lab presented a new technique called Process Doppelgänging. The video from the talk is available here. (Also, it i…" />
<meta property="article:published_time" content="2017-12-18T21:04:16+00:00" />
<meta property="article:modified_time" content="2018-04-04T18:31:10+00:00" />
<meta property="og:site_name" content="hasherezade&#039;s 1001 nights" />
<meta property="og:image" content="https://blog.malwarebytes.com/wp-content/uploads/2017/12/create_process.png" />
<meta property="og:image:width" content="403" />
<meta property="og:image:height" content="185" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:creator" content="@hasherezade" />
<meta name="twitter:site" content="@hasherezade" />
<meta name="twitter:text:title" content="Process Doppelgänging &#8211; a new way to impersonate a&nbsp;process" />
<meta name="twitter:image" content="https://blog.malwarebytes.com/wp-content/uploads/2017/12/create_process.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/d90f3e8396fcba0c10c535b639092316?s=32" sizes="16x16" />
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/d90f3e8396fcba0c10c535b639092316?s=32" sizes="16x16" />
<link rel="apple-touch-icon" href="https://secure.gravatar.com/blavatar/d90f3e8396fcba0c10c535b639092316?s=114" />
<link rel='openid.server' href='https://hshrzd.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://hshrzd.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://hshrzd.wordpress.com/osd.xml" title="hasherezade&#039;s 1001 nights" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<meta name="theme-color" content="#d8dbe2" />
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="hasherezade&#039;s 1001 nights" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="projects and tasks that I do in my free time" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://hshrzd.wordpress.com/feed/;icon-uri=https://secure.gravatar.com/blavatar/d90f3e8396fcba0c10c535b639092316?s=16" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="description" content="Recently at Black Hat Europe conference, Tal Liberman and Eugene Kogan form enSilo lab presented a new technique called Process Doppelgänging. The video from the talk is available here. (Also, it is worth mentioning that Tal Liberman is an author of the AtomBombing injection). This technique is a possible substituent of the well-known Process Hollowing&hellip;" />
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #d8dbe2; }
</style>
	<link rel="amphtml" href="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/amp/"><style type="text/css" id="custom-colors-css">#access ul li.current_page_item > a, #access ul li.current_page_parent > a, #access ul li.current-menu-ancestor > a, #access ul li.current-menu-item > a, #access ul li.current-menu-parent > a { color: #FFFFFF;}
#access li:hover > a, #access ul ul *:hover > a { fg2: #ffffff;}
#access a { color: #AAAAAA;}
.entry-meta a:link, .entry-utility a:link { color: #888888;}
body { background-color: #d8dbe2;}
#access, #access ul ul a { background-color: #000000;}
#access li:hover > a, #access ul ul *:hover > a { background-color: #333333;}
a:link, a:visited, .jetpack_widget_social_icons a:visited, .widget_wpcom_social_media_icons_widget a:visited { color: #0066CC;}
.home .sticky { background-color: #0066cc;}
.home .sticky { background-color: rgba( 0, 102, 204, 0.05 );}
.home .sticky .page-link a { background-color: #0066cc;}
.home .sticky .page-link a { background-color: rgba( 0, 102, 204, 0.2 );}
a:hover, a:focus, a:active { color: #D91B02;}
.entry-title a:active, .entry-title a:hover { color: #D91B02;}
.page-title a:active, .page-title a:hover { color: #D91B02;}
.entry-meta a:hover, .entry-utility a:hover { color: #D91B02;}
.navigation a:active, .navigation a:hover { color: #D91B02;}
.comment-meta a:active, .comment-meta a:hover { color: #D91B02;}
.reply a:hover, a.comment-edit-link:hover { color: #D91B02;}
.page-link a:active, .page-link a:hover { color: #D91B02;}
</style>
</head>

<body class="post-template-default single single-post postid-5074 single-format-standard custom-background customizer-styles-applied single-author highlander-enabled highlander-light">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			<div id="branding" role="banner">
								<div id="site-title">
					<span>
						<a href="https://hshrzd.wordpress.com/" title="hasherezade&#039;s 1001 nights" rel="home">hasherezade&#039;s 1001 nights</a>
					</span>
				</div>
				<div id="site-description">projects and tasks that I do in my free time</div>

									<a class="home-link" href="https://hshrzd.wordpress.com/" title="hasherezade&#039;s 1001 nights" rel="home">
						<img src="https://hshrzd.files.wordpress.com/2013/12/cropped-sky31.jpg" width="940" height="198" alt="" />
					</a>
								</div><!-- #branding -->

			<div id="access" role="navigation">
								<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
				<div class="menu-header"><ul id="menu-home" class="menu"><li id="menu-item-5738" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-5738"><a href="https://hshrzd.wordpress.com">Home</a></li>
<li id="menu-item-25" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-25"><a href="https://hshrzd.wordpress.com/about/">About</a></li>
<li id="menu-item-162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-162"><a href="https://hshrzd.wordpress.com/mycode/">Projects</a>
<ul class="sub-menu">
	<li id="menu-item-5140" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5140"><a href="https://hshrzd.wordpress.com/pe-sieve/">PE-sieve</a></li>
	<li id="menu-item-4236" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4236"><a href="https://hshrzd.wordpress.com/pe_unmapper/">PE_unmapper</a></li>
	<li id="menu-item-4234" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4234"><a href="https://hshrzd.wordpress.com/iat-patcher/">IAT Patcher</a></li>
	<li id="menu-item-728" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-728"><a href="https://hshrzd.wordpress.com/pe-bear/">PE-bear</a></li>
	<li id="menu-item-1448" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1448"><a href="https://hshrzd.wordpress.com/vidi-visual-disassembler/">ViDi</a></li>
	<li id="menu-item-1601" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1601"><a href="https://hshrzd.wordpress.com/mycode/dma-unlocker/">DMA Unlocker</a></li>
</ul>
</li>
<li id="menu-item-5674" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5674"><a href="https://hshrzd.wordpress.com/how-to-start/">How to start RE/malware analysis?</a></li>
</ul></div>			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">

			

				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="https://hshrzd.wordpress.com/2017/12/01/hook-the-planet-solving-flareon4-challenge6-with-libpeconv/" rel="prev"><span class="meta-nav">&larr;</span> Hook the planet! Solving FlareOn4 Challenge6 with&nbsp;libPeConv</a></div>
					<div class="nav-next"><a href="https://hshrzd.wordpress.com/2018/01/26/solving-a-pyinstaller-compiled-crackme/" rel="next">Solving a PyInstaller-compiled crackme <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-above -->

				<div id="post-5074" class="post-5074 post type-post status-publish format-standard hentry category-malware category-programming category-techniques tag-pe tag-process-doppelganging">
											<h2 class="entry-title"><a href="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/" rel="bookmark">Process Doppelgänging &#8211; a new way to impersonate a&nbsp;process</a></h2>					
					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted on</span> <a href="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/" title="11:04 pm" rel="bookmark"><span class="entry-date">December 18, 2017</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="https://hshrzd.wordpress.com/author/hshrzd/" title="View all posts by hasherezade">hasherezade</a></span>					</div><!-- .entry-meta -->

					<div class="entry-content">
						<p>Recently <a href="https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf" target="_blank" rel="noopener">at Black Hat Europe conference</a>, <a href="https://twitter.com/tal_liberman" target="_blank" rel="noopener">Tal Liberman</a> and <a href="https://twitter.com/EuKogan" target="_blank" rel="noopener">Eugene Kogan</a> form enSilo lab presented a new technique called Process Doppelgänging. The video from the talk is available <a href="https://www.youtube.com/watch?v=Cch8dvp836w" target="_blank" rel="noopener">here</a>. (Also, it is worth mentioning that Tal Liberman is an author of <a href="https://blog.ensilo.com/atombombing-brand-new-code-injection-for-windows" target="_blank" rel="noopener">the AtomBombing injection</a>).</p>
<p>This technique is a possible substituent of the well-known Process Hollowing (RunPE), that is commonly used in malware. Both, Process Doppelgänging and Process Hollowing, gives an ability to run a malicious executable under the cover of a legitimate one. Although they both serve the same goal of process impersonation, they differ in implementation and make use of different API functions. This is why, most of the current antivirus solutions struggled in detecting Process Doppelgänging. In this post we will take a closer look on how the Process Doppelgänging works and compare it with the popular RunPE.</p>
<p><em>WARNING: Running this PoC on Windows 10 may cause a BSOD &#8211; the reason is a bug in Windows 10. Details <a href="https://youtu.be/Cch8dvp836w?t=2382" target="_blank" rel="noopener">here</a>.</em></p>
<h3>Process Doppelgänging vs Process Hollowing (aka RunPE)</h3>
<p>The popular RunPE technique substitutes the PE content after the process is created (suspended), but before it is fully initialized. In order to implement this technique, we need to do by our own the step that WindowsLoader took so far: converting the PE file from it&#8217;s raw form into a virtual form, relocating it to the base where it is going to be loaded, and pasting into the process&#8217; memory. Then, we can awake the process from the suspended state, and the WindowsLoader will continue loading our (potentially malicious) payload. You can find a commented implementation <a href="https://github.com/hasherezade/libpeconv/tree/master/run_pe" target="_blank" rel="noopener">here</a>.</p>
<p>The Process Doppleganging, in contrary, substitutes the PE content before even the process is created. We overwrite the file image <span style="text-decoration:underline;">before</span> the loading starts &#8211; so, WindowsLoader automatically takes care of the fore-mentioned steps. My sample implementation of this technique can be found <a href="https://github.com/hasherezade/process_doppelganging" target="_blank" rel="noopener">here</a>.</p>
<h3>NTFS transactions</h3>
<p>On the way to it&#8217;s goal, Process Doppelgänging uses a very little known API for NTFS transactions.</p>
<p>Transactions is a mechanism commonly used while operating on databases &#8211; however, in a similar way it exists in the NTFS file system. It allows to encapsulate a series of operations into a single unit. Thanks to this, multiple operations can be treated as a whole: they can either succeed as a whole &#8211; and be committed, or fail as a whole &#8211; and be rolled back. Outside of our transaction, the result of the operations is not visible. It starts to be noticeable after the transaction is closed.</p>
<p>Windows API makes several functions available for the purpose of transactions:</p>
<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa366011(v=vs.85).aspx" target="_blank" rel="noopener">CreateTransaction</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa366001(v=vs.85).aspx" target="_blank" rel="noopener">CommitTransaction</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa366366(v=vs.85).aspx" target="_blank" rel="noopener">RollbackTransaction</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa363859(v=vs.85).aspx" target="_blank" rel="noopener">CreateFileTransacted</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365241(v=vs.85).aspx" target="_blank" rel="noopener">MoveFileTransacted</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa363916(v=vs.85).aspx" target="_blank" rel="noopener">DeleteFileTransacted</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa363857(v=vs.85).aspx" target="_blank" rel="noopener">CreateDirectoryTransacted</a></li>
<li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365490(v=vs.85).aspx" target="_blank" rel="noopener">RemoveDirectoryTransacted</a></li>
<li>etc<a href="https://social.msdn.microsoft.com/search/en-US/windows?query=Transacted%20function" target="_blank" rel="noopener">&#8230;</a></li>
</ul>
<p>Briefly speaking, we can create a file inside a transaction, and for no other process this file is visible, as long as our transaction is not committed. It can be used to drop and run malicious payloads in an unnoticed way. If we roll back the transaction in an appropriate moment, the operating system behaves like our file was never created.</p>
<h3>The steps taken</h3>
<h5>Usage of NTFS transactions</h5>
<p>Firstly, we need to create a new transaction, using the API <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa366011(v=vs.85).aspx" target="_blank" rel="noopener">CreateTransaction</a>.</p>
<p><a href="https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L144" target="_blank" rel="noopener">https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L144</a></p>
<p>Then, inside of this transaction we will create a dummy file to store our payload (using <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa363859(v=vs.85).aspx" target="_blank" rel="noopener">CreateFileTransacted</a>).</p>
<p><a href="https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L149" target="_blank" rel="noopener">https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L149</a></p>
<p>This dummy file will be then used to create a section (a buffer in a special format), which makes a base for our new process.</p>
<p><a href="https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L173" target="_blank" rel="noopener">https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L173</a></p>
<p>After we created the section, we no longer need the dummy file &#8211; we can close it and roll back the transaction (using <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa366366(v=vs.85).aspx" target="_blank" rel="noopener">RollbackTransaction</a>).</p>
<p><a href="https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L188" target="_blank" rel="noopener">https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L188</a></p>
<h5>Usage of undocumented process creation API</h5>
<p>So far we created a section containing our payload, loaded from the dummy file. You may ask &#8211; how are we going to create a process out of this? The well known API functions for creating processes on Windows require file path to be given. However, if we look deeper inside those functions, we will find that they are just wrappers for other, undocumented functions. There is a function <code>Zw</code>/<code>NtCreateProcessEx</code> which, rather than the path to the raw PE file, requires a section with a PE content to be given. If we use this function, we can create a new process in a &#8220;fileless&#8221; way.</p>
<p>Definition of the NtCreateProcessEx:</p>
<p><img loading="lazy" class="alignnone size-full wp-image-20930" src="https://blog.malwarebytes.com/wp-content/uploads/2017/12/create_process.png" alt="" width="403" height="185" /></p>
<p><a href="https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L196" target="_blank" rel="noopener">https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L196</a></p>
<p>Creation of process by this way requires more steps to be taken &#8211; there are some structures that we have to fill and setup manually &#8211; such as process parameters (<code>RTL_USER_PROCESS_PARAMETERS</code>). After filling them and wring into the space of the remote process, we need to link them to the PEB. Mistake in doing it will cause the process to not run.</p>
<p><a href="https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L76" target="_blank" rel="noopener">https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L76</a></p>
<p>After setting everything up, we can run the process by creating a new thread starting from it&#8217;s Entry Point.</p>
<p><a href="https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L246" target="_blank" rel="noopener">https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L246</a></p>
<p>Despite some inconveniences, <span class="pl-c1">creating the process by a low-level API </span>gives also interesting advantages. <span class="pl-c1">For example, we can <a href="https://github.com/hasherezade/process_doppelganging/blob/master/main.cpp#L96" target="_blank" rel="noopener">set manually the file path</a> &#8211; making an illusion, that this is the file that has been loaded, even if it was not. By this way, we can impersonate any windows executable, but also we can make an illusion, that the PE file runs from a non-existing file, or a file of a non-executable format.<br />
</span></p>
<p>Below you can see an example where the illusion was created, that the PE file runs from a TXT file:</p>
<p><span class="embed-youtube" style="text-align:center; display: block;"><iframe class='youtube-player' width='640' height='360' src='https://www.youtube.com/embed/Qllw8rxhbO4?version=3&#038;rel=1&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;fs=1&#038;hl=en&#038;autohide=2&#038;wmode=transparent' allowfullscreen='true' style='border:0;' sandbox='allow-scripts allow-same-origin allow-popups allow-presentation'></iframe></span></p>
<h3>How to detect?</h3>
<p>Although this technique may look dangerous, it can be easily detected with the help of any tool that compares if the image loaded in the memory matches the corresponding file on the disk. Example: detection with <a href="https://hshrzd.wordpress.com/pe-sieve/" target="_blank" rel="noopener">PE-sieve</a> (former hook_finder):</p>
<p><span class="embed-youtube" style="text-align:center; display: block;"><iframe class='youtube-player' width='640' height='360' src='https://www.youtube.com/embed/T9pWqYGHqLM?version=3&#038;rel=1&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;fs=1&#038;hl=en&#038;autohide=2&#038;wmode=transparent' allowfullscreen='true' style='border:0;' sandbox='allow-scripts allow-same-origin allow-popups allow-presentation'></iframe></span></p>
<p>The process of injection is also not fully stealthy. It still requires writing into the memory (including PEB) of the newly created process, as well as creating a remote thread. Such operations may trigger alerts.</p>
<p>In addition, the mechanism of NTFS  transactions is very rarely used &#8211; so, if any executable call the related APIs, it should become an object of a closer examination.</p>
<p>So far this technique is new, that&#8217;s why it is not broadly recognized by AV products &#8211; but once we are aware of it&#8217;s existence, implementing detection should not be difficult.</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-5074" class="share-twitter sd-button share-icon" href="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-5074" class="share-facebook sd-button share-icon" href="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/?share=facebook" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-35018075-5074-60a9b850711b0' data-src='//widgets.wp.com/likes/index.html?ver=20210413#blog_id=35018075&amp;post_id=5074&amp;origin=hshrzd.wordpress.com&amp;obj_id=35018075-5074-60a9b850711b0' data-name='like-post-frame-35018075-5074-60a9b850711b0'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>											</div><!-- .entry-content -->

							<div id="entry-author-info">
						<div id="author-avatar">
							<img alt='' src='https://0.gravatar.com/avatar/c6762d36ab89eb4f376f18b09a964a38?s=60&#038;d=identicon&#038;r=G' class='avatar avatar-60' height='60' width='60' />						</div><!-- #author-avatar -->
						<div id="author-description">
							<h2>
							About hasherezade							</h2>
							Programmer and researcher, interested in InfoSec.							<div id="author-link">
								<a href="https://hshrzd.wordpress.com/author/hshrzd/" rel="author">
									View all posts by hasherezade <span class="meta-nav">&rarr;</span>								</a>
							</div><!-- #author-link	-->
						</div><!-- #author-description -->
					</div><!-- #entry-author-info -->

						<div class="entry-utility">
							This entry was posted in <a href="https://hshrzd.wordpress.com/category/malware/" rel="category tag">Malware</a>, <a href="https://hshrzd.wordpress.com/category/programming/" rel="category tag">Programming</a>, <a href="https://hshrzd.wordpress.com/category/techniques/" rel="category tag">Techniques</a> and tagged <a href="https://hshrzd.wordpress.com/tag/pe/" rel="tag">PE</a>, <a href="https://hshrzd.wordpress.com/tag/process-doppelganging/" rel="tag">Process Doppelgänging</a>. Bookmark the <a href="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/" title="Permalink to Process Doppelgänging &#8211; a new way to impersonate a&nbsp;process" rel="bookmark">permalink</a>.													</div><!-- .entry-utility -->
					</div><!-- #post-5074 -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="https://hshrzd.wordpress.com/2017/12/01/hook-the-planet-solving-flareon4-challenge6-with-libpeconv/" rel="prev"><span class="meta-nav">&larr;</span> Hook the planet! Solving FlareOn4 Challenge6 with&nbsp;libPeConv</a></div>
					<div class="nav-next"><a href="https://hshrzd.wordpress.com/2018/01/26/solving-a-pyinstaller-compiled-crackme/" rel="next">Solving a PyInstaller-compiled crackme <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
			<div id="comments">


			<h3 id="comments-title">
			7 Responses to <em>Process Doppelgänging &#8211; a new way to impersonate a&nbsp;process</em>			</h3>


			<ol class="commentlist">
						<li class="comment byuser comment-author-lallousx86 even thread-even depth-1 highlander-comment" id="li-comment-1854">
		<div id="comment-1854">
			<div class="comment-author vcard">
				<img alt='' src='https://0.gravatar.com/avatar/3aad807b3d3ce5ddb90a21649fdec492?s=40&#038;d=identicon&#038;r=G' class='avatar avatar-40' height='40' width='40' />				<cite class="fn"><a href='http://lallousx86.wordpress.com/' rel='external nofollow ugc' class='url'>lallouslab</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->

				
				
			<div class="comment-meta commentmetadata"><a href="https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/#comment-1854">
				December 31, 2017 at 3:17 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Informative and straight to the point, thanks!</p>
</div>

			<div class="reply">
				<a rel='nofollow' class='comment-reply-link' href='https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/?replytocom=1854#respond' data-commentid="1854" data-postid="5074" data-belowelement="comment-1854" data-respondelement="respond" data-replyto="Reply to lallouslab" aria-label='Reply to lallouslab'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

				</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href='https://sivapremv.wordpress.com/2018/02/01/process-doppelganging/' rel='external nofollow ugc' class='url'>PROCESS DOPPELGANGING | Security and its occultism</a></p>
				</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href='http://blog.correlationx.com/doppelganging-malware-evasion-technique/' rel='external nofollow ugc' class='url'>Examining and Detecting the Doppelganging Malware Evasion Technique - CorrelationX Blog</a></p>
				</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href='https://www.sploitkit.com/loki-loki-simple-ioc-and-incident-response-scanner/' rel='external nofollow ugc' class='url'>Loki Loki &#8211; Simple IOC and Incident Response Scanner &#8211; Sploitkit</a></p>
				</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href='https://blarrow.tech/bazarbackdoor-trickbot-gangs-new-network-hacking-malware/' rel='external nofollow ugc' class='url'>Bazar Backdoor: TrickBot gang’s new network-hacking malware | %</a></p>
				</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href='https://geekscripts.guru/loki-ioc-incident-response-scanner/' rel='external nofollow ugc' class='url'>▷ Loki: Simple IOC and Incident Response Scanner » GeekScripts</a></p>
				</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href='https://bkd00r.wordpress.com/2021/01/10/red-teaming_final-attck/' rel='external nofollow ugc' class='url'>RED TEAMING_Final Att&amp;ck &#8211; B4cKD00₹</a></p>
				</li><!-- #comment-## -->
			</ol>


	

	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://hshrzd.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="a24c1ed278" /><input type="hidden" name="_wp_http_referer" value="/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/" />
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest" />

<div class="comment-form-field comment-textarea">
	<label for="comment">Enter your comment here...</label>
	<div id="comment-form-comment"><textarea id="comment" name="comment" title="Enter your comment here..."></textarea></div>
</div>

<div id="comment-form-identity">
	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" class="nascar-signin-link"
                   title="Login via Guest">
									</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" class="nascar-signin-link"
                   title="Login via WordPress.com">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"/></g></svg>				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="https://public-api.wordpress.com/connect/?googleplus-sign-in=https%3A%2F%2Fhshrzd.wordpress.com&#038;color_scheme=light" width="24" height="24" scrolling="no" allowtransparency="true" seamless="seamless" frameborder="0"></iframe>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" class="nascar-signin-link"
                   title="Login via Twitter">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"/></g></svg>				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" class="nascar-signin-link"
                   title="Login via Facebook">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"/></g></svg>				</a>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Gravatar" width="25" class="no-grav" />
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="url" value="" /></div>
				</div>
			</div>
			
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="WordPress.com Logo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="" />
						<p class="comment-form-posting-as pa-wordpress">
			<strong></strong>
			You are commenting using your WordPress.com account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"/></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Google photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="" />
						<p class="comment-form-posting-as pa-googleplus">
			<strong></strong>
			You are commenting using your Google account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" x="0px" y="0px" viewBox="0 0 60 60" ><path fill="#519bf7" d="M56.3,30c0,-1.6 -0.2,-3.4 -0.6,-5h-3.1H42.2H30v10.6h14.8C44,39.3 42,42 39.1,43.9l8.8,6.8C53,46 56.3,39 56.3,30z" /><path fill="#3db366" d="M30,57.5c6.7,0 13.1,-2.4 17.9,-6.8l-8.8,-6.8c-2.5,1.6 -5.6,2.4 -9.1,2.4c-7.2,0 -13.3,-4.7 -15.4,-11.2l-9.3,7.1C9.8,51.3 19.1,57.5 30,57.5z" /><path fill="#fdc600" d="M5.3,42.2l9.3,-7.1c-0.5,-1.6 -0.8,-3.3 -0.8,-5.1s0.3,-3.5 0.8,-5.1l-9.3,-7.1C3.5,21.5 2.5,25.6 2.5,30S3.5,38.5 5.3,42.2z" /><path fill="#f15b44" d="M40.1,17.4l8,-8C43.3,5.1 37,2.5 30,2.5C19.1,2.5 9.8,8.7 5.3,17.8l9.3,7.1c2.1,-6.5 8.2,-11.1 15.4,-11.1C33.9,13.7 37.4,15.1 40.1,17.4z" /></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Twitter picture" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" />
						<p class="comment-form-posting-as pa-twitter">
			<strong></strong>
			You are commenting using your Twitter account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"/></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Facebook photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" />
						<p class="comment-form-posting-as pa-facebook">
			<strong></strong>
			You are commenting using your Facebook account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24" ><rect x="0" fill="none" width="24" height="24"/><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"/></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function () {

	function hide( sel ) {
		var el = document.querySelector( sel );
		if ( el ) {
			el.style.setProperty( 'display', 'none' );
		}
	}

	function show( sel ) {
		var el = document.querySelector( sel );
		if ( el ) {
			el.style.removeProperty( 'display' );
		}
	}

	var input = document.createElement( 'input' );
	var comment = document.querySelector( '#comment' );

	if ( input && comment && 'placeholder' in input ) {
		var label = document.querySelector( '.comment-textarea label' );
		if ( label ) {
			var text = label.textContent;
			label.parentNode.removeChild( label );
			comment.setAttribute( 'placeholder', text );
		}
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	hide( '#comment-form-identity' );
	hide( '#comment-form-subscribe' );
	hide( '#commentform .form-submit' );

	if ( comment ) {
		comment.style.height = '10px';

		var handler = function () {
			comment.style.height = HighlanderComments.initialHeight + 'px';
			show( '#comment-form-identity' );
			show( '#comment-form-subscribe' );
			show( '#commentform .form-submit' );
			HighlanderComments.resizeCallback();

			comment.removeEventListener( 'focus', handler );
		};

		comment.addEventListener( 'focus', handler );
	}
}

if ( document.readyState !== 'loading' ) {
	highlander_expando_javascript();
} else {
	if ( typeof window.jQuery === 'function' ) {
		// Use jQuery's `ready` if available.
		// This solves some scheduling issues between this script and the main highlander script.
		jQuery( document ).ready( highlander_expando_javascript );
	} else {
		// If not available, add a vanilla event listener.
		document.addEventListener( 'DOMContentLoaded', highlander_expando_javascript );
	}
}

</script>

<div id="comment-form-subscribe">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"/> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p><p class="post-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;"/> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog"  style="display: inline;">Notify me of new posts via email.</label></p></div>




<p class="form-submit"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='5074' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="81a9fe1d41" /></p>
<input type="hidden" name="genseq" value="1621735504" />
<input type="hidden" id="ak_js" name="ak_js" value="45"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	<div style="clear: both"></div>
</div><!-- #comments -->

	
			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
						<ul class="xoxo">

<li id="search-2" class="widget-container widget_search"><form role="search" method="get" id="searchform" class="searchform" action="https://hshrzd.wordpress.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></li>
		<li id="recent-posts-2" class="widget-container widget_recent_entries">
		<h3 class="widget-title">Recent Posts</h3>
		<ul>
											<li>
					<a href="https://hshrzd.wordpress.com/2021/01/05/flare-on-7-task-10/">Flare-On 7 – Task&nbsp;10</a>
									</li>
											<li>
					<a href="https://hshrzd.wordpress.com/2020/12/12/flareon-7-task-9/">Flare-On 7 &#8211; Task&nbsp;9</a>
									</li>
											<li>
					<a href="https://hshrzd.wordpress.com/2019/09/30/flare-on-6-tasks-10-12/">Flare-On 6 (tasks&nbsp;10-12)</a>
									</li>
											<li>
					<a href="https://hshrzd.wordpress.com/2019/06/27/application-shimming-vs-import-table-recovery/">Application shimming vs Import Table&nbsp;recovery</a>
									</li>
											<li>
					<a href="https://hshrzd.wordpress.com/2019/01/13/pe-bear-version-0-3-9-available/">PE-bear – version 0.3.9&nbsp;available</a>
									</li>
					</ul>

		</li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>
			<ul>
					<li><a href='https://hshrzd.wordpress.com/2021/01/'>January 2021</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2020/12/'>December 2020</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2019/09/'>September 2019</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2019/06/'>June 2019</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2019/01/'>January 2019</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2018/07/'>July 2018</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2018/04/'>April 2018</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2018/02/'>February 2018</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2018/01/'>January 2018</a>&nbsp;(2)</li>
	<li><a href='https://hshrzd.wordpress.com/2017/12/'>December 2017</a>&nbsp;(2)</li>
	<li><a href='https://hshrzd.wordpress.com/2017/11/'>November 2017</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2017/06/'>June 2017</a>&nbsp;(4)</li>
	<li><a href='https://hshrzd.wordpress.com/2017/05/'>May 2017</a>&nbsp;(2)</li>
	<li><a href='https://hshrzd.wordpress.com/2016/12/'>December 2016</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2016/11/'>November 2016</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2016/07/'>July 2016</a>&nbsp;(3)</li>
	<li><a href='https://hshrzd.wordpress.com/2016/06/'>June 2016</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2016/04/'>April 2016</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2016/03/'>March 2016</a>&nbsp;(2)</li>
	<li><a href='https://hshrzd.wordpress.com/2016/02/'>February 2016</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2014/10/'>October 2014</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2014/03/'>March 2014</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2014/02/'>February 2014</a>&nbsp;(2)</li>
	<li><a href='https://hshrzd.wordpress.com/2014/01/'>January 2014</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2013/11/'>November 2013</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2013/10/'>October 2013</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2013/09/'>September 2013</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2013/08/'>August 2013</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2013/07/'>July 2013</a>&nbsp;(3)</li>
	<li><a href='https://hshrzd.wordpress.com/2012/07/'>July 2012</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2012/05/'>May 2012</a>&nbsp;(1)</li>
	<li><a href='https://hshrzd.wordpress.com/2012/04/'>April 2012</a>&nbsp;(1)</li>
			</ul>

			</li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>
			<ul>
					<li class="cat-item cat-item-6904"><a href="https://hshrzd.wordpress.com/category/confidence/">CONfidence</a> (3)
</li>
	<li class="cat-item cat-item-571800"><a href="https://hshrzd.wordpress.com/category/crackme/">CrackMe</a> (14)
</li>
	<li class="cat-item cat-item-6724658"><a href="https://hshrzd.wordpress.com/category/kernelmode/">KernelMode</a> (4)
</li>
	<li class="cat-item cat-item-15593"><a href="https://hshrzd.wordpress.com/category/malware/">Malware</a> (13)
</li>
	<li class="cat-item cat-item-505351122"><a href="https://hshrzd.wordpress.com/category/malware-decryptor/">Malware Decryptor</a> (5)
</li>
	<li class="cat-item cat-item-182358898"><a href="https://hshrzd.wordpress.com/category/pe-bear/">PE-bear</a> (12)
</li>
	<li class="cat-item cat-item-196"><a href="https://hshrzd.wordpress.com/category/programming/">Programming</a> (5)
</li>
	<li class="cat-item cat-item-317"><a href="https://hshrzd.wordpress.com/category/techniques/">Techniques</a> (4)
</li>
	<li class="cat-item cat-item-1981"><a href="https://hshrzd.wordpress.com/category/tools/">Tools</a> (8)
</li>
	<li class="cat-item cat-item-2932"><a href="https://hshrzd.wordpress.com/category/tutorial/">Tutorial</a> (12)
</li>
	<li class="cat-item cat-item-1"><a href="https://hshrzd.wordpress.com/category/uncategorized/">Uncategorized</a> (1)
</li>
	<li class="cat-item cat-item-18909089"><a href="https://hshrzd.wordpress.com/category/wke/">WKE</a> (3)
</li>
			</ul>

			</li><li id="blog-stats-2" class="widget-container widget_blog-stats"><h3 class="widget-title">Blog Stats</h3>		<ul>
			<li>403,781 hits</li>
		</ul>
		</li><li id="media_image-3" class="widget-container widget_media_image"><h3 class="widget-title">All my works included here are licensed under:</h3><style>.widget.widget_media_image { overflow: hidden; }.widget.widget_media_image img { height: auto; max-width: 100%; }</style><a href="http://creativecommons.org/licenses/by-sa/3.0/"><img class="image alignnone" src="https://licensebuttons.net/l/by-sa/3.0/88x31.png" alt="Creative Commons Attribution-ShareAlike 3.0 Unported License" width="88" height="31" /></a></li>			</ul>
		</div><!-- #primary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="site-info">
				<a href="https://hshrzd.wordpress.com/" title="hasherezade&#039;s 1001 nights" rel="home">
					hasherezade&#039;s 1001 nights				</a>
							</div><!-- #site-info -->

			<div id="site-generator">
								<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->

<!--  -->
<script src='//0.gravatar.com/js/gprofiles.js?ver=202120y' id='grofiles-cards-js'></script>
<script id='wpgroho-js-extra'>
var WPGroHo = {"my_hash":""};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240h'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init( 'body', '#wp-admin-bar-my-account' );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-c6762d36ab89eb4f376f18b09a964a38">
	</div>
	<div class="grofile-hash-map-3aad807b3d3ce5ddb90a21649fdec492">
	</div>
	</div>
<script id='highlander-comments-js-extra'>
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/hshrzd.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/hshrzd.wordpress.com\/wp-login.php?action=logout&_wpnonce=605197e367","homeURL":"https:\/\/hshrzd.wordpress.com\/","postID":"5074","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"0","userIsLoggedIn":"","isJetpack":"","text_direction":"ltr"};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s0.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1573483029j'></script>

<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20201002";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20201002";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

	
		<div
			class="jp-carousel-wrap jp-carousel-transitions"
			itemscope
			itemtype="https://schema.org/ImageGallery"
			style="display: none;">
			<div class="jp-carousel-overlay"></div>
			<div class="jp-carousel"></div>
			<div class="jp-carousel-fadeaway"></div>
			<div class="jp-carousel-info">
				<div class="jp-carousel-photo-info">
					<h2 class="jp-carousel-caption" itemprop="caption description"></h2>
				</div>
				<div class="jp-carousel-info-columns">
					<div class="jp-carousel-left-column-wrapper">
						<div class="jp-carousel-titleanddesc"></div>
						<!-- Intentional duplicate -->
						<div class="jp-carousel-photo-info">
							<h2 class="jp-carousel-caption" itemprop="caption description"></h2>
						</div>
													<div id="jp-carousel-comment-form-container">
																											<form id="jp-carousel-comment-form">
											<textarea
												name="comment"
												class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
												id="jp-carousel-comment-form-comment-field"
												placeholder="Write a Comment..."
											></textarea>
											<div id="jp-carousel-comment-form-submit-and-info-wrapper">
												<div id="jp-carousel-comment-form-commenting-as">
																											<fieldset>
															<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
															<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
														</fieldset>
														<fieldset>
															<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
															<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
														</fieldset>
														<fieldset>
															<label for="jp-carousel-comment-form-url-field">Website</label>
															<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
														</fieldset>
																									</div>
												<input
													type="submit"
													name="submit"
													class="jp-carousel-comment-form-button"
													id="jp-carousel-comment-form-button-submit"
													value="Post Comment" />
												<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
												<div id="jp-carousel-comment-post-results"></div>
											</div>
										</form>
																								</div>
							<div class="jp-carousel-comments"></div>
							<div id="jp-carousel-comments-loading">
								<span>Loading Comments...</span>
							</div>
											</div>
					<div class="jp-carousel-image-meta">
						<div class="jp-carousel-buttons">
														<a class="jp-carousel-commentlink" href="#">Comment</a>
																				</div>
						<ul class="jp-carousel-image-exif" style="display: none;"></ul>
						<a class="jp-carousel-image-download" style="display: none;"></a>
						<div class="jp-carousel-image-map" style="display: none;"></div>
					</div>
				</div>
			</div>
			<div class="jp-carousel-next-button" style="display: none;">
				<span></span>
			</div>
			<div class="jp-carousel-previous-button" style="display: none;">
				<span></span>
			</div>
			<div class="jp-carousel-close-hint"><span>&times;</span></div>
		</div>

		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/hshrzd.wordpress.com\/2017\/12\/18\/process-doppelganging-a-new-way-to-impersonate-a-process\/":5074};
	</script>
				<link rel='stylesheet' id='all-css-0-3' href='https://s1.wp.com/_static/??/wp-content/mu-plugins/carousel/jetpack-carousel.css,/wp-content/mu-plugins/related-posts/related-posts.css?m=1620034463j&cssminify=yes' type='text/css' media='all' />
<script id='jetpack-carousel-js-extra'>
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/hshrzd.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"1adfd72456","display_exif":"1","display_comments":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/hshrzd.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fhshrzd.wordpress.com%2F2017%2F12%2F18%2Fprocess-doppelganging-a-new-way-to-impersonate-a-process%2F","blog_id":"35018075","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=35018075&v=wpcom&tz=2&user_id=0&subd=hshrzd","is_public":"1"};
</script>
<script id='jetpack_related-posts-js-extra'>
var related_posts_js_options = {"post_heading":"h4"};
</script>
<script id='sharing-js-js-extra'>
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
</script>
<script crossorigin='anonymous' type='text/javascript' src='https://s0.wp.com/_static/??-eJyNUFtOAzEMvBBZlyIe/UAcBaWJ2zqbV+2kSzk9RmI/WKEtX/ZkHpoYpmpcyQ1zgyDg8UIO68cQ5A5+U+Hcka8/Y6B8IZxuygK2at1oGIU+cSlP3dTYj5QFIo0ooKaOJ5t9RJ7FlF3sXkkNdyUlNWpcjdchUV5JtF55s7cMyUpD1s001jLyV7JCTHv0N0Kd5dIFI8wfmx9WPIzRNvSmFmkLtFZ/JEnYzMOwgXdtCofC6R/NzFT1Sgu44vvuYQ7REoOcLFM+zlNNb+n1/mm72b3sHrfP4QsnT8/T'></script>
<script type='text/javascript'>
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src='https://widgets.wp.com/likes/master.html?ver=20210413#ver=20210413&amp;origin=https://hshrzd.wordpress.com' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars'>
		<div class="likes-text">
			<span>%d</span> bloggers like this:		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>
	
		<script src="//stats.wp.com/w.js?61" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'35018075','blog_tz':'2','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'35018075','v':'wpcom','tz':'2','user_id':'0','post':'5074','subd':'hshrzd'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29+Smw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8/MkNtblkvY1dzK3YrWW16RTB3dWZLL1ZyVmRMRGFdNVlnZTF8TnxsJUJMTTZaNmJ6flFbLz8vSjk2RS13NHFIJld6UX56ZFEvMHRNfmlzanc4eVIzLk5RNC9Tdm1PLjBkPVU0bTE2ekZZcy1ERWE/SFhPQm5Ydl8tMzhBOE0zLGxdVk16R2Y/dUZ2QUQ1N0F+MGRIX2QyT3loWHhTZ3xDS2o9cFI3SEZVVHdpdDZYSmE5dD9acmEzeUJZQi89elNtLS9SfEczK3N2QlFRSTY9anV8NXkuQjRyRUM2NXNMNm1Z'}]);
_stq.push([ 'clickTrackerInit', '35018075', '5074' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script></body>
</html>
